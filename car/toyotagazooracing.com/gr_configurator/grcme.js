!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports.grcme=t():e.grcme=t()}(this,function(){return function(e){function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=58)}([function(e,t,a){"use strict";function r(e){return"[object Array]"===y.call(e)}function n(e){return"[object ArrayBuffer]"===y.call(e)}function o(e){return"undefined"!==typeof FormData&&e instanceof FormData}function i(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function _(e){return"string"===typeof e}function s(e){return"number"===typeof e}function c(e){return"undefined"===typeof e}function l(e){return null!==e&&"object"===typeof e}function f(e){return"[object Date]"===y.call(e)}function u(e){return"[object File]"===y.call(e)}function d(e){return"[object Blob]"===y.call(e)}function p(e){return"[object Function]"===y.call(e)}function m(e){return l(e)&&p(e.pipe)}function g(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams}function h(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function b(e,t){if(null!==e&&"undefined"!==typeof e)if("object"===typeof e||r(e)||(e=[e]),r(e))for(var a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function E(){function e(e,a){"object"===typeof t[a]&&"object"===typeof e?t[a]=E(t[a],e):t[a]=e}for(var t={},a=0,r=arguments.length;a<r;a++)b(arguments[a],e);return t}function A(e,t,a){return b(t,function(t,r){e[r]=a&&"function"===typeof t?x(t,a):t}),e}var x=a(9),T=a(47),y=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:n,isBuffer:T,isFormData:o,isArrayBufferView:i,isString:_,isNumber:s,isObject:l,isUndefined:c,isDate:f,isFile:u,isBlob:d,isFunction:p,isStream:m,isURLSearchParams:g,isStandardBrowserEnv:v,forEach:b,merge:E,extend:A,trim:h}},function(e,t){var a="object"===typeof a?a:function(e){var t={};e.module=t;var a={};return e.cleanup=function(e,r){var n=t[e];n&&(n.cn=null),a[r||"__b4w_default"]=null},e.register=function(e,a){t[e]||(t[e]=a)},e.require=function(e,r){if(!t[e])throw Error('Module "'+e+'" not found');return r=r||"__b4w_default",a[r]||(a[r]=function(e){return function(r){var n=t[r];if(!n)throw Error('Module "'+r+'" not found');return n.cn||(n.cn={}),n.cn[e]||(n.cn[e]={},n(n.cn[e],a[e])),n.cn[e]}}(r)),a[r](e)},e.module_check=function(e){return!!t[e]},e.get_namespace=function(e){for(var t in a)if(a[t]==e)return t;return""},e.worker_listeners=[],e.worker_namespaces=[],e}({});a.module.__version=function(e){var t=new Date(2017,7,18,17,14,15),a=[17,6,3];e.version=function(){return a},e.version_str=function(){for(var e="",t=0;t<a.length;t++)e=1==t?e+(10>a[t]?"0"+a[t]:a[t]):e+a[t],t!=a.length-1&&(e+=".");return e},e.type=function(){return"RELEASE"},e.date=function(){return t},e.date_str=function(){var e=t.getDate(),e=10>e?"0"+String(e):String(e),a=t.getMonth()+1,a=10>a?"0"+String(a):String(a),r=String(t.getFullYear()),n=t.getHours(),n=10>n?"0"+String(n):String(n),o=t.getMinutes(),o=10>o?"0"+String(o):String(o),i=t.getSeconds(),i=10>i?"0"+String(i):String(i);return e+"."+a+"."+r+" "+n+":"+o+":"+i},e.timestamp=function(){return"?v=_b4w_ver_17_06_3_"}},a.module.__config=function(e,t){function r(){return a.module_check(e.Ie.it)}function n(){for(var t=e.Ie,a=null,r=document.getElementsByTagName("script"),n=0;n<r.length;n++){for(var i=r[n].src,_=0;_<t.vF.length;_++)if(0<=i.indexOf(t.vF[_])){a=i;break}if(null!==a)break}return a||(o.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),a=document.location.href),t=a.indexOf("?"),0<=t&&(a=a.substring(0,t)),a.substring(0,a.lastIndexOf("/"))}var o=t("__print"),i=t("__util");e.P_LOW=1,e.P_HIGH=2,e.P_ULTRA=3,e.P_CUSTOM=4,e.P_AUTO=5,e.context={alpha:!0,antialias:!1,premultipliedAlpha:!0},e.FD=i.P(e.context),e.H={alpha_sort:!0,alpha_sort_threshold:.1,lm:[6,2],max_fps:1e4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,mE:1,VO:5,background_color:[0,0,0,0],canvas_resolution_factor:1,Ej:3,allow_cors:!1,lE:!1,Jx:!0,anisotropic_filtering:!0,dB:!1,show_hud_debug_info:!1,Nt:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,LI:!1,Jn:!0,Hv:!0,Dc:!0,water_dynamic:!0,shore_smoothing:!0,Do:!0,oI:!0,precision:"highp",quality:e.P_HIGH,Ns:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,IR:!1,JA:!1,yy:!1,CI:!1,is_mobile_device:!1,lz:!1,ey:!1,GY:!1,Jr:!1,allow_hidpi:!1,qH:!1,Mz:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,Tn:!1,iE:!1,Az:[0,0],xG:!0,fw:!1,url_params:null,Ab:!0,Rb:4,jq:!1,NG:!1,RS:!1,Er:!1,IG:!1,nD:!1,cF:!1,bF:!1,media_auto_activation:!0,QF:4,iv:!1,gl_debug:!1,hD:!1,xC:!1,Gx:!1,Cl:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",Qu:!1,Fr:!1,debug_loading:!1,hE:!1,NF:!1},e.VD=i.P(e.H),e.sl={hu:-1,nE:!1,Rl:1},e.controls={CR:1/120},e.Od={path:"",WR:"B4W_ASSETS_PATH=__JS__/../../assets/",lS:"B4W_PROJ_ASSETS_PATH=__JS__/../../../projects/__NAME__/assets/",wR:15,prevent_caching:!0,Lz:!1,vy:!1,Rv:!1},e.CC=i.P(e.Od),e.Ie={shaders_path:"",HT:"../shaders/",oH:"include/",EY:"postprocessing/",it:"built_in_data",vF:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js B4W_MAIN_MODULE".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"},e.$E={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{$D:.8,kh:.064,Kh:.035,Gr:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],il:.11,bi:.062,Lh:.004}},e.I={enabled:!0,max_fps:60,gs:"",Pw:"",Qw:"B4W_URANIUM_PATH=./",BC:"uranium.js",KI:"uranium_wasm.js",TF:"uranium.js.mem",JI:"uranium_wasm.wasm",nI:"../deploy/apps/common/",Wx:!1,ping:!1,Om:!0,Tw:!1},e.oG=i.P(e.I),e.Co={Pq:1024,Ht:256,ND:32,cO:128,bO:256,qG:.25,dS:.5,cS:1},e.RG=i.P(e.Co),e.Z={AB:!0,pv:!1,GC:!1,qD:!1,YD:!1},e.mH=i.P(e.Z),e.Oc={outlining_overview_mode:!1,rh:[1,.4,.05],Bk:.2,Ck:3.8,Dk:1},e.Jl={enabled:!1,Ur:39,hU:0,KT:"COLOR"},e.TD=i.P(e.Jl),e.Zg={vR:8,Ez:64,Iz:8,lv:8,Jz:15,SF:0,mv:128,Wf:1024,Fz:4096,Qb:4096,Kz:[4096,4096],xn:24},e.ED=i.P(e.Zg),e.apply_quality=function(){var t=e.H,a=e.I,r=e.Co;switch(t.quality){case e.P_ULTRA:t.shadows=!0,t.shore_smoothing=!0,t.ssao=!0,t.dof=!0,t.god_rays=!0,t.bloom=!0,t.reflections=!0,t.refractions=!0,t.Jn=!0,t.Hv=!0,t.Dc=!0,r.Pq=2048,r.Ht=512,t.Ej=3,t.anisotropic_filtering=!0,t.use_min50=!1,t.water_dynamic=!0,t.Do=!0,t.antialiasing=!0,t.smaa=!1,t.compositing=!0,t.motion_blur=!0,t.allow_hidpi=!0,t.enable_outlining=!0,t.glow_materials=!0,t.Rb=16,t.srgb_type="SRGB_PROPER",a.max_fps=120,t.lod_smooth_transitions=!0;break;case e.P_HIGH:t.shadows=!0,t.shore_smoothing=!0,t.ssao=!0,t.dof=!0,t.god_rays=!0,t.bloom=!0,t.reflections=!0,t.refractions=!0,t.Jn=!0,t.Hv=!0,t.Dc=!0,r.Pq=1024,r.Ht=256,t.Ej=3,t.anisotropic_filtering=!0,t.use_min50=!1,t.water_dynamic=!0,t.Do=!0,t.antialiasing=!0,t.smaa=!1,t.compositing=!0,t.motion_blur=!0,t.allow_hidpi=!1,t.enable_outlining=!0,t.glow_materials=!0,t.srgb_type="SRGB_SIMPLE",t.Rb=4,a.max_fps=60,t.lod_smooth_transitions=!0;break;case e.P_LOW:t.shadows=!1,t.shore_smoothing=!1,t.ssao=!1,t.dof=!1,t.god_rays=!1,t.bloom=!1,t.reflections=!1,t.refractions=!1,t.Jn=!1,t.Hv=!1,t.Dc=!1,r.Pq=512,r.Ht=256,t.Ej=2,t.anisotropic_filtering=!1,t.use_min50=!0,t.water_dynamic=!1,t.Do=!1,t.antialiasing=!1,t.smaa=!1,t.compositing=!1,t.motion_blur=!1,t.allow_hidpi=!1,t.enable_outlining=!1,t.glow_materials=!1,t.srgb_type="SRGB_SIMPLE",t.Rb=1,a.max_fps=60,t.lod_smooth_transitions=!1;break;case e.P_AUTO:i.F("Direct AUTO quality profile setting is forbidden")}},e.set=function(t,a){switch(t){case"allow_cors":e.H.allow_cors=a;break;case"allow_hidpi":e.H.allow_hidpi=a;break;case"alpha":e.context.alpha=a;break;case"alpha_sort":e.H.alpha_sort=a;break;case"alpha_sort_threshold":e.H.alpha_sort_threshold=a;break;case"anaglyph_use":o.Xt("anaglyph_use","stereo"),e.H.stereo=a?"ANAGLYPH":e.H.stereo;break;case"animation_framerate":e.sl.hu=a;break;case"anisotropic_filtering":e.H.anisotropic_filtering=a;break;case"antialiasing":e.H.antialiasing=a;break;case"assets_dir":case"assets_path":e.Od.path=a;break;case"assets_dds_available":e.Od.vy=a;break;case"assets_pvr_available":e.Od.Rv=a;break;case"assets_min50_available":e.Od.Lz=a;break;case"audio":e.Z.AB=a;break;case"background_color":e.H.background_color=a;break;case"bloom":e.H.bloom=a;break;case"built_in_module_name":e.Ie.it=a;break;case"canvas_resolution_factor":e.H.canvas_resolution_factor=a;break;case"console_verbose":e.H.console_verbose=a;break;case"compositing":e.H.compositing=a;break;case"dof":e.H.dof=a;break;case"do_not_load_resources":e.H.do_not_load_resources=a;break;case"god_rays":e.H.god_rays=a;break;case"stereo":e.H.stereo=a;break;case"lod_leap_smooth_threshold":e.H.lod_leap_smooth_threshold=a;break;case"lod_smooth_transitions":e.H.lod_smooth_transitions=a;break;case"max_fps":e.H.max_fps=a;break;case"max_fps_physics":e.I.max_fps=a;break;case"media_auto_activation":e.H.media_auto_activation=a;break;case"motion_blur":e.H.motion_blur=a;break;case"physics_enabled":e.I.enabled=a;break;case"physics_uranium_path":e.I.Tw&&window.Cx?(e.I.gs=a+e.I.KI,e.I.Pw=a+e.I.JI):(e.I.gs=a+e.I.BC,e.I.Pw=a+e.I.TF),e.I.nI=a;break;case"physics_use_wasm":e.I.Tw=a;break;case"physics_calc_fps":e.I.Wx=a;break;case"physics_use_workers":e.I.Om=a;break;case"precision":e.H.precision=a;break;case"prevent_caching":e.Od.prevent_caching=a;break;case"quality":e.H.quality=a;break;case"reflections":e.H.reflections=a;break;case"refractions":e.H.refractions=a;break;case"sfx_mix_mode":e.Z.pv=a;break;case"shaders_dir":case"shaders_path":e.Ie.shaders_path=a;break;case"shadows":e.H.shadows=a;break;case"show_hud_debug_info":e.H.show_hud_debug_info=a;break;case"smaa":o.Xt("smaa"),e.H.smaa=a;break;case"smaa_search_texture_path":o.Xt("smaa_search_texture_path"),e.Ie.smaa_search_texture_path=a;break;case"smaa_area_texture_path":o.Xt("smaa_area_texture_path"),e.Ie.smaa_area_texture_path=a;break;case"ssao":e.H.ssao=a;break;case"debug_view":e.H.debug_view=a;break;case"enable_selectable":e.H.enable_selectable=a;break;case"enable_outlining":e.H.enable_outlining=a;break;case"outlining_overview_mode":e.Oc.outlining_overview_mode=a;break;case"glow_materials":e.H.glow_materials=a;break;case"url_params":e.H.url_params=a;break;case"use_min50":e.H.use_min50=a;break;case"enable_texture_cache":e.H.enable_texture_cache=a;break;case"gl_debug":e.H.gl_debug=a;break;case"srgb_type":e.H.srgb_type=a;break;case"shadow_blur_samples":e.H.shadow_blur_samples=a;break;case"reflection_quality":e.H.reflection_quality=a;break;case"assets_gzip_available":e.H.assets_gzip_available=a;break;case"debug_loading":e.H.debug_loading=a;break;case"msaa_samples":e.H.Rb=a;break;default:o.error("Unknown config property: "+t)}},e.get=function(t){switch(t){case"allow_cors":return e.H.allow_cors;case"allow_hidpi":return e.H.allow_hidpi;case"alpha":return e.context.alpha;case"alpha_sort":return e.H.alpha_sort;case"alpha_sort_threshold":return e.H.alpha_sort_threshold;case"anaglyph_use":return"ANAGLYPH"==e.H.stereo;case"animation_framerate":return e.sl.hu;case"anisotropic_filtering":return e.H.anisotropic_filtering;case"antialiasing":return e.H.antialiasing;case"assets_dir":case"assets_path":return e.Od.path;case"assets_dds_available":return e.Od.vy;case"assets_pvr_available":return e.Od.Rv;case"assets_min50_available":return e.Od.Lz;case"audio":return e.Z.AB;case"background_color":return e.H.background_color;case"bloom":return e.H.bloom;case"built_in_module_name":return e.Ie.it;case"canvas_resolution_factor":return e.H.canvas_resolution_factor;case"console_verbose":return e.H.console_verbose;case"compositing":return e.H.compositing;case"dof":return e.H.dof;case"do_not_load_resources":return e.H.do_not_load_resources;case"is_mobile_device":return e.H.is_mobile_device;case"god_rays":return e.H.god_rays;case"stereo":return e.H.stereo;case"lod_leap_smooth_threshold":return e.H.lod_leap_smooth_threshold;case"lod_smooth_transitions":return e.H.lod_smooth_transitions;case"max_fps":return e.H.max_fps;case"max_fps_physics":return e.I.max_fps;case"media_auto_activation":return e.H.media_auto_activation;case"motion_blur":return e.H.motion_blur;case"physics_enabled":return e.I.enabled;case"physics_uranium_path":return e.I.nI;case"physics_uranium_bin":return e.I.Pw;case"physics_use_wasm":return e.I.Tw;case"physics_calc_fps":return e.I.Wx;case"physics_use_workers":return e.I.Om;case"precision":return e.H.precision;case"prevent_caching":return e.Od.prevent_caching;case"quality":return e.H.quality;case"reflections":return e.H.reflections;case"refractions":return e.H.refractions;case"sfx_mix_mode":return e.Z.pv;case"shaders_dir":case"shaders_path":return e.Ie.shaders_path;case"shadows":return e.H.shadows;case"show_hud_debug_info":return e.H.show_hud_debug_info;case"smaa":return e.H.smaa;case"smaa_search_texture_path":return e.Ie.smaa_search_texture_path;case"smaa_area_texture_path":return e.Ie.smaa_area_texture_path;case"ssao":return e.H.ssao;case"debug_view":return e.H.debug_view;case"enable_selectable":return e.H.enable_selectable;case"enable_outlining":return e.H.enable_outlining;case"outlining_overview_mode":return e.Oc.outlining_overview_mode;case"glow_materials":return e.H.glow_materials;case"url_params":return e.H.url_params;case"use_min50":return e.H.use_min50;case"enable_texture_cache":return e.H.enable_texture_cache;case"gl_debug":return e.H.gl_debug;case"srgb_type":return e.H.srgb_type;case"shadow_blur_samples":return e.H.shadow_blur_samples;case"reflection_quality":return e.H.reflection_quality;case"assets_gzip_available":return e.H.assets_gzip_available;case"debug_loading":return e.H.debug_loading;case"msaa_samples":return e.H.Rb;default:o.error("Unknown config property: "+t)}},e.reset=function(){for(var t in e.FD)e.context[t]=e.FD[t];for(t in e.VD)e.H[t]=e.VD[t];for(t in e.CC)e.Od[t]=e.CC[t];for(t in e.oG)e.I[t]=e.oG[t];for(t in e.RG)e.Co[t]=e.RG[t];for(t in e.mH)e.Z[t]=e.mH[t];for(t in e.TD)e.Jl[t]=e.TD[t]},e.reset_limits=function(){var t,a=e.Zg.xn;for(t in e.ED)e.Zg[t]=e.ED[t];e.Zg.xn=a},e.kF=r,e.rT=function(){var t=e.Ie,a=e.I;if(r()||""!=t.shaders_path||(t.shaders_path=n()+"/"+t.HT),e.I.Tw&&window.Cx)var t=a.Qw+a.KI,o=a.Qw+a.JI;else t=a.Qw+a.BC,o=a.Qw+a.TF;a.enabled&&""==a.gs&&(a.gs=n()+"/"+t.replace("B4W_URANIUM_PATH=",""),a.Pw=n()+"/"+o.replace("B4W_URANIUM_PATH=",""))},e.get_assets_path=function(t){var a=e.Od;if(a.path)return a.path;var r=a.WR,o="B4W_ASSETS_PATH=";return t&&(r=a.lS,o="B4W_PROJ_ASSETS_PATH=",r=r.replace("__NAME__",t)),r=r.replace(o,""),r=r.replace("__JS__",n())}},a.module.__anchors=function(e,t){function a(){if(!N&&!w){var e=R;if(e)if("visible"==e.lastElementChild.style.visibility)r(),R=null;else if(1==e.style.opacity){var t=e.lastElementChild,e=e.firstElementChild,a=t.firstElementChild,n=Math.ceil(t.getBoundingClientRect().width),o=Math.ceil(t.getBoundingClientRect().height),i=Math.ceil(e.getBoundingClientRect().width),_=Math.ceil(e.getBoundingClientRect().height);t.style.position="absolute",t.style.visibility="visible";var s=!0,c=!0;e.style.display="none",N=!0,i!=n?A.animate(i,n,200,function(e){e==n&&(s=!1,c||(N=!1,a.style.visibility="visible")),t.style.width=e+"px"}):(s=!1,c||(N=!1)),_!=o?A.animate(_,o,200,function(e){e==o&&(c=!1,s||(N=!1,a.style.visibility="visible")),t.style.height=e+"px"}):(c=!1,s||(N=!1))}}}function r(){var e=R.lastElementChild;R.firstElementChild.style.display="",e.style.visibility="hidden",e.style.position="relative",e.firstElementChild.style.visibility="hidden"}function n(e){e.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}function o(e,t,a){var o=document.createElement("div"),i=document.createElement("span");a&&(o.style.maxWidth=a+"px"),o.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;",n(i),i.innerHTML=e,o.style.visibility="hidden",i.style.visibility="hidden",o.appendChild(i),t.appendChild(o),p.add_click_listener(t,function(){N||t==R||1!=t.style.opacity||w||(R&&"visible"==R.lastElementChild.style.visibility&&r(),R=t)})}function i(){for(var e=0,t=0;t<O.length;t++)O[t].yn&&e++;I=new Float32Array(3*e)}function _(e,t){return t.depth-e.depth}function s(e,t,a){e=e.element,S.cF&&(t=Math.floor(t),a=Math.floor(a)),"transform"in e.style?e.style.transform="translate3d("+t+"px, "+a+"px, 0px)":"webkitTransform"in e.style?e.style.webkitTransform="translate3d("+t+"px, "+a+"px, 0px)":(e.style.left=t+"px",e.style.top=a+"px")}function c(e){for(var t=0;t<O.length;t++)if(O[t].obj==e)return!0;return!1}var l=t("__batch"),f=t("__camera"),u=t("__config"),d=t("__container"),p=t("__input"),m=t("__objects"),g=t("__obj_util"),h=t("__print"),v=t("__renderer"),b=t("__scenes"),E=t("__subscene"),A=t("__time"),x=t("__transform"),T=t("__tsr"),y=t("__vec3"),S=u.H,O=[],w=!1,R=null,L=!1,N=!1,I=new Float32Array(0),M=new Uint8Array(16),C=new Float32Array(2),D=new Float32Array(3),U=new Float32Array(3);e.append=function(e){if(!c(e)){var t=e.anchor.yn&&!!b.Ib(b.jh(),E.Xm),t={type:e.anchor.type,obj:e,x:0,y:0,depth:0,tl:"out",yn:t,element:null,fo:null,fL:e.anchor.xR,bk:e.anchor.bk};switch(t.type){case"ANNOTATION":var r=t.obj;e=d.get_container();var _=m.get_meta_tags(r),r=r.name,s="",l=document.createElement("div"),f=l.cloneNode(!1),u=document.createElement("span");l.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;",f.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;",l.style.visibility="hidden",_&&(s=_.description||s,r=_.title||r),u.innerHTML=r,u.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;",n(u),u.style.whiteSpace="nowrap",f.appendChild(u),l.appendChild(f),s&&o(s,l,t.fL),e.appendChild(l),t.element=l;break;case"ELEMENT":if(t.element=document.getElementById(e.anchor.bk),t.element)for(_=0;_<O.length;_++)"ELEMENT"==O[_].type&&O[_].bk==e.anchor.bk&&(h.warn("Anchor with the id '"+e.anchor.bk+"' already exists, making the new anchor generic."),t.type="GENERIC");else h.warn("Anchor HTML element with the id '"+e.anchor.bk+"' was not found, making it generic."),t.type="GENERIC"}O.push(t),i(),L||(L=!0,d.get_container().addEventListener("mouseup",a))}},e.remove=function(e){for(var t=0;t<O.length;t++){var a=O[t];if(a.obj==e){"ANNOTATION"==a.type&&(e=a,d.get_container().removeChild(e.element)),O.splice(t,1),i();break}}},e.update=function(e){for(var t=0,a=O.length;a--;){var r=O[a];if(r.yn){var n=T.get_trans_view(r.obj.o.v);I.set(n,3*t++)}var o;o=r;var n=D,i=b.gk(b.jh());if(o=T.get_trans_view(o.obj.o.v),f.project_point(i,o,n),o=n,n=o[0],i=o[1],o=o[2],e||n!=r.x||i!=r.y||o!=r.depth){switch(r.type){case"ANNOTATION":var c=n,u=i;s(r,c,u);break;case"ELEMENT":u=r.element.getBoundingClientRect(),c=n-u.width/2,u=i-u.height/2,s(r,c,u)}r.x=n,r.y=i,r.depth=o,r.fo&&r.fo(n,i,r.tl,r.obj,r.element)}}for(O.sort(_),a=0;a<O.length;a++)r=O[a],"GENERIC"!=r.type&&(r.element.style.zIndex=R==r.element?O.length:a);0<t&&(e=b.Ib(b.jh(),E.Xm),t=e.Pa[0].Ca[0],l.tU(t.ra,I),E.Ic(e,t))},e.lI=function(){for(var e=d.get_container(),t=b.get_active(),t=b.Ib(t,E.jg),t=!(!t||!t.enable_hmd_stereo),a=O.length;a--;){var n=O[a],o=n.obj,i=o.o,_=n.x,s=n.y,c=n.depth,l=b.gk(b.jh()),f=x.get_translation(o,D),l=x.get_translation(l,U),f=y.dist(f,l);if((c=0>_||0>s||0>c||1<c||b.is_hidden(o)||_>=e.clientWidth||s>=e.clientHeight)||(i.cj?(c=i.Uf,i=!(f<i.Vf)&&(c==g.vx||f<c)):i=!0,c=!i),i=c?"out":"visible",n.yn&&"out"!=i&&(i=n,c=b.Ib(b.jh(),E.Xm).B,f=d.Tp(i.x,i.y,C,c),v.Uv(c.Ee,f[0],c.height-f[1],2,2,M),i=255<=M[0]+M[4]+M[8]+M[12]?"visible":"out"!=i.tl&&M[0]+M[4]+M[8]+M[12]?i.tl:"covered"),t&&(i="out"),i!=n.tl){switch(n.type){case"ANNOTATION":case"ELEMENT":var u=n.element;u&&("out"==i?(u.style.visibility="hidden",u.children.length&&(u.children[0].style.visibility="hidden")):"visible"==i?(u.style.visibility="visible",u.children.length&&(u.children[0].style.visibility="visible"),u.style.opacity=1):(u.style.visibility="visible",u.style.opacity=.1,u.children.length&&(u.children[0].style.visibility="visible"),"ANNOTATION"==n.type&&1<u.children.length&&"visible"==u.lastElementChild.style.visibility&&(r(),u==R&&(R=null))))}n.tl=i,n.fo&&n.fo(_,s,n.tl,o,u)}}},e.attach_move_cb=function(e,t){for(var a=0;a<O.length;a++)O[a].obj==e&&(O[a].fo=t)},e.detach_move_cb=function(e){for(var t=0;t<O.length;t++)O[t].obj==e&&(O[t].fo=null)},e.cleanup=function(){for(var e=0;e<O.length;e++){var t=O[e];"ANNOTATION"==t.type&&d.get_container().removeChild(t.element)}O.length=0},e.is_anchor=c,e.get_element_id=function(e){for(var t=0;t<O.length;t++)if(O[t].obj==e)return O[t].bk;return!1},e.pause=function(){w=!0},e.resume=function(){w=!1},e.XR=function(e,t){for(var a=-1,r=0;r<O.length;r++){var n;if(n="visible"==O[r].tl){var o=O[r];if(o.element){n=Math.round(o.element.offsetWidth)||0;var i=Math.round(o.element.offsetHeight)||0}else i=n=0;var _=o.x,o=o.y;n=e>=_&&e<=_+n&&t<o&&t>=o-i}if(n)if(0>a)var s=O[r].depth,a=r;else O[r].depth<s&&(a=r,s=O[r].depth)}return 0>a?null:O[a].obj}},a.module.__armature=function(e,t){function a(e){e=e.o;for(var t=e.Go,a=e.nv,r=0;r<t.length;r++){for(var n=t[r],o=a[r],i=0;i<o.length;i+=2)for(var _=o[i],s=o[i+1],c=0;4>c;c++)n.Bd[_+c]=e.Bd[s+c],n.oe[_+c]=e.oe[s+c],n.Jd[_+c]=e.Jd[s+c],n.te[_+c]=e.te[s+c];n.gf=e.gf}}function r(e,t,a,n){var i=e.pB,_=e.Dh,s=e.bs,f=e.tm;for(f?(f=f.bs,t?o.multiply(f,i,s):(t=l,o.invert(f,t),o.multiply(t,s,i))):t?o.copy(i,s):o.copy(s,i),i=c,o.invert(_,i),o.multiply(s,i,i),_=e.Nh,a[4*_]=i[0],a[4*_+1]=i[1],a[4*_+2]=i[2],a[4*_+3]=i[3],n[4*_]=i[4],n[4*_+1]=i[5],n[4*_+2]=i[6],n[4*_+3]=i[7],e=e.Ot,_=0;_<e.length;_++)s=e[_],s.ic||r(s,!0,a,n)}var n=t("__util"),o=t("__tsr"),i=t("__quat"),_=t("__mat4"),s=t("__vec3"),c=o.create(),l=o.create(),f=new Float32Array(4),u=new Float32Array(4),d=new Float32Array(4);e.$k=function(e,t){for(var a=e.data.bones,r=e.pose.bones,i={},l=0;l<r.length;l++){var f=r[l],u=f.bone,d=u.name,p=i[d]={Nh:0,DI:-1,tm:null,Ot:[],ot:[],ic:null,Yo:o.create(),pB:o.create(),Dh:o.create(),rB:o.create(),bs:o.create(),Mw:o.create(),Lw:o.create(),as:o.create(),qB:o.create(),Kw:!1,NH:new Float32Array(3)},d=new Float32Array(u.matrix_local),m=new Float32Array(16);_.invert(d,m);var f=new Float32Array(f.matrix_basis),g=p.NH;s.subtract(n.f32(u.tail_local),n.f32(u.head_local),g),n.oV(g,m,g),o.from_mat4(d,p.Dh),o.from_mat4(f,p.as),o.copy(p.Dh,p.bs),o.invert(p.Dh,p.rB)}for(l=0;l<a.length;l++){for(d=a[l].name,f=n.keysearch("name",d,r),p=i[d],u=f.parent_recursive,p.ot.push(p),m=0;m<u.length;m++)f=u[m],f=f.name,f=i[f],p.ot.push(f);u.length?(f=u[0],f=f.name,f=i[f],p.tm=f,o.invert(f.Dh,c),o.multiply(c,p.Dh,p.Yo),f.Ot.push(p)):o.copy(p.Dh,p.Yo),p.Nh=l,p.name=d,o.multiply(p.Yo,p.as,p.pB)}t.o.qg=i},e.get_bone_tsr=function(e,t,a,r,n){var _=e.o,s=_.gf;t=_.qg[t];var p=t.Nh;e=t.Dh;var m=_.Jd,g=_.te,h=_.Bd,_=_.oe,v=m[4*p+1],b=m[4*p+2],E=m[4*p+3],A=g[4*p+1],x=g[4*p+2],T=g[4*p+3];f[0]=(1-s)*m[4*p]+s*g[4*p],f[1]=(1-s)*v+s*A,f[2]=(1-s)*b+s*x,f[3]=(1-s)*E+s*T,u[0]=h[4*p],u[1]=h[4*p+1],u[2]=h[4*p+2],u[3]=h[4*p+3],d[0]=_[4*p],d[1]=_[4*p+1],d[2]=_[4*p+2],d[3]=_[4*p+3],i.slerp(u,d,s,u),s=c,o.set_transcale(f,s),o.set_quat(u,s),a?(a=l,o.translate(e,t.NH,a),o.multiply(s,a,s)):o.multiply(s,e,s),r&&((r=t.tm)&&(a=l,o.invert(r.bs,a),o.multiply(a,s,s)),r=l,o.invert(t.Yo,r),o.multiply(r,s,s)),o.copy(s,n)},e.set_bone_tsr=function(e,t,n,i){var _=e.o;t=_.qg[t];var s=_.Jd,c=_.Bd;i?o.multiply(t.Yo,n,t.pB):o.copy(n,t.bs),r(t,i,s,c),_.gf=0,a(e)},e.YU=a,e.AU=r,e.pt=function(e,t){return t in e.o.qg}},a.module.__boundings=function(e,t){function a(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function r(e,t){return t.min_x=e.min_x,t.max_x=e.max_x,t.min_y=e.min_y,t.max_y=e.max_y,t.min_z=e.min_z,t.max_z=e.max_z,t}function n(){return{N:new Float32Array(3),Ia:new Float32Array(3),Ja:new Float32Array(3),Ka:new Float32Array(3)}}function o(e,t){var a=e.max_y,r=e.max_z,n=e.min_x,o=e.min_y,i=e.min_z;return e.max_x=Math.max(t.max_x,e.max_x),e.max_y=Math.max(t.max_y,a),e.max_z=Math.max(t.max_z,r),e.min_x=Math.min(t.min_x,n),e.min_y=Math.min(t.min_y,o),e.min_z=Math.min(t.min_z,i),e}function i(e,t,a,r){var n=e[t],o=e[t+1],i=e[t+2],_=e[t],s=e[t+1],c=e[t+2];for(t+=3;t<a;t+=3)var l=e[t],f=e[t+1],u=e[t+2],n=Math.max(n,l),o=Math.max(o,f),i=Math.max(i,u),_=Math.min(_,l),s=Math.min(s,f),c=Math.min(c,u);return r.max_x=n,r.max_y=o,r.max_z=i,r.min_x=_,r.min_y=s,r.min_z=c,r}function _(e,t){t||(t=new Float32Array(24));var a=e.max_x,r=e.max_y,n=e.max_z,o=e.min_x,i=e.min_y,_=e.min_z;return t[0]=o,t[1]=i,t[2]=_,t[3]=a,t[4]=i,t[5]=_,t[6]=a,t[7]=r,t[8]=_,t[9]=o,t[10]=r,t[11]=_,t[12]=o,t[13]=i,t[14]=n,t[15]=a,t[16]=i,t[17]=n,t[18]=a,t[19]=r,t[20]=n,t[21]=o,t[22]=r,t[23]=n,t}function s(){return{N:new Float32Array(3),ab:0}}function c(e,t){return t.N[0]=e.N[0],t.N[1]=e.N[1],t.N[2]=e.N[2],t.ab=e.ab,t}function l(){return{Ia:new Float32Array(3),Ja:new Float32Array(3),Ka:new Float32Array(3),N:new Float32Array(3)}}function f(e,t){return v.copy(e.Ia,t.Ia),v.copy(e.Ja,t.Ja),v.copy(e.Ka,t.Ka),v.copy(e.N,t.N),t}function u(e,t,a,r){return{Ia:new Float32Array(e),Ja:new Float32Array(t),Ka:new Float32Array(a),N:new Float32Array([r[0],r[1],r[2]])}}function d(e,t){var a=b.gM(e,S),a=t?b.dM(e,a,w):E.identity(w),a=b.NO(a,O);v.copy(e,x),v.transformMat3(x,a,x);for(var r,n,o,i,_=x[0],s=_,c=x[1],l=c,f=x[2],d=f,p=3;p<e.length;p+=3)x[0]=e[p],x[1]=e[p+1],x[2]=e[p+2],v.transformMat3(x,a,x),r=x[0],n=x[1],o=x[2],r>_&&(_=r),r<s&&(s=r),n>c&&(c=n),n<l&&(l=n),o>f&&(f=o),o<d&&(d=o);for(_=Math.max(_-s,1e-9),c=Math.max(c-l,1e-9),f=Math.max(f-d,1e-9),d=E.identity(w),d[0]=_?1/_:1e8,d[4]=c?1/c:1e8,d[8]=f?1/f:1e8,E.transpose(a,R),x[0]=e[0],x[1]=e[1],x[2]=e[2],v.transformMat3(x,a,x),v.transformMat3(x,d,x),v.transformMat3(x,R,x),l=x[0],s=x[0],r=x[1],n=x[1],o=x[2],i=x[2],p=3;p<e.length;p+=3)x[0]=e[p],x[1]=e[p+1],x[2]=e[p+2],v.transformMat3(x,a,x),v.transformMat3(x,d,x),v.transformMat3(x,R,x),l=Math.max(l,x[0]),s=Math.min(s,x[0]),r=Math.max(r,x[1]),n=Math.min(n,x[1]),o=Math.max(o,x[2]),i=Math.min(i,x[2]);return p=Math.sqrt((l-s)*(l-s)+(r-n)*(r-n)+(o-i)*(o-i))/2,p=Math.min(p,1),y[0]=(l+s)/2,y[1]=(r+n)/2,y[2]=(o+i)/2,l=y,d=E.identity(w),d[0]=_,d[4]=c,d[8]=f,v.transformMat3(l,a,l),v.transformMat3(l,d,l),v.transformMat3(l,R,l),d=[a[0],a[3],a[6]],s=[a[1],a[4],a[7]],a=[a[2],a[5],a[8]],v.scale(d,_*p,d),v.scale(s,c*p,s),v.scale(a,f*p,a),u(d,s,a,l)}function p(){return{ab:0,height:0,N:new Float32Array(3)}}function m(e,t,a){return v.add(t,a,e.N),v.scale(e.N,.5,e.N),e.ab=v.distance(e.N,t),e}var g=t("__tsr"),h=t("__util"),v=t("__vec3"),b=t("__math"),E=t("__mat3"),A=new Float32Array(24),x=new Float32Array(3),T=new Float32Array(3),y=new Float32Array(3),S=new Float32Array(3),O=new Float32Array(9),w=new Float32Array(9),R=new Float32Array(9);e.eF=function(){return{ee:a(),ye:l(),ze:s()}},e.GD=function(e,t){r(e.ee,t.ee),f(e.ye,t.ye),c(e.ze,t.ze)},e.Be=a,e.$g=r,e.Et=n,e.SM=function(e,t){v.copy(e.N,t.N),v.copy(e.Ia,t.Ia),v.copy(e.Ja,t.Ja),v.copy(e.Ka,t.Ka)},e.MW=function(){return{max_x:1e12,min_x:-1e12,max_y:1e12,min_y:-1e12,max_z:1e12,min_z:-1e12}},e.EV=function(e){e.max_x=0,e.min_x=0,e.max_y=0,e.min_y=0,e.max_z=0,e.min_z=0},e.rt=function(e){var t=a();return r(e,t),t},e.eM=function(e){var t=e.max_x-e.min_x,a=e.max_y-e.min_y;return a<t&&(t=a),e=e.max_z-e.min_z,e<t&&(t=e),t},e.Yt=o,e.Nx=i,e.nn=function(e,t,r){return r||(r=a()),e=_(e,A),g.transform_vectors(e,t,e),i(e,0,e.length,r)},e.fE=_,e.FY=function(e,t,r){r||(r=a());var n=t.min_x,o=t.max_x,i=t.min_y,_=t.max_y,s=t.min_z;return t=t.max_z,n>=e.max_x||o<=e.min_x||i>=e.max_y||_<=e.min_y||s>=e.max_z||t<=e.min_z?(r.min_x=-.1,r.max_x=.1,r.min_y=-.1,r.max_y=.1,r.min_z=-.2,r.max_z=-.1,r):(r.min_x=Math.max(e.min_x,n),r.max_x=Math.min(e.max_x,o),r.min_y=Math.max(e.min_y,i),r.max_y=Math.min(e.max_y,_),r.min_z=Math.max(e.min_z,s),r.max_z=Math.min(e.max_z,t),r)},e.KY=function(e,t,r){r||(r=a());var n=e.max_x-e.min_x,o=e.max_y-e.min_y,i=e.max_z-e.min_z;return r.min_x=e.min_x-.5*(t-1)*n,r.max_x=e.max_x+.5*(t-1)*n,r.min_y=e.min_y-.5*(t-1)*o,r.max_y=e.max_y+.5*(t-1)*o,r.min_z=e.min_z-.5*(t-1)*i,r.max_z=e.max_z+.5*(t-1)*i,r},e.et=function(e,t,a){return a||(a=s()),g.transform_vec3(e.N,t,a.N),t=g.get_scale(t),a.ab=e.ab*(0>t?-t:t),a},e.Ux=function(e,t,a){return a||(a=l()),g.transform_vec3(e.N,t,a.N),v.copy(e.Ia,a.Ia),v.copy(e.Ja,a.Ja),v.copy(e.Ka,a.Ka),g.transform_dir_vec3(a.Ia,t,a.Ia),g.transform_dir_vec3(a.Ja,t,a.Ja),g.transform_dir_vec3(a.Ka,t,a.Ka),a},e.Vx=function(e,t,a){return a||(a=n()),g.transform_vec3(e.N,t,a.N),v.copy(e.Ia,a.Ia),v.copy(e.Ja,a.Ja),v.copy(e.Ka,a.Ka),g.transform_dir_vec3(a.Ia,t,a.Ia),g.transform_dir_vec3(a.Ja,t,a.Ja),g.transform_dir_vec3(a.Ka,t,a.Ka),a},e.XC=function(e,t){var a=s();return v.copy(t,a.N),a.ab=e,a},e.KS=function(e,t,a,r,o){var i=n();return v.copy(e,i.N),v.copy(t,i.Ia),v.copy(a,i.Ja),v.copy(r,i.Ka),v.scale(i.Ia,o[0],i.Ia),v.scale(i.Ja,o[1],i.Ja),v.scale(i.Ka,o[2],i.Ka),i},e.At=s,e.Pi=c,e.oq=l,e.El=f,e.UW=function(e){var t=l();return f(e,t),t},e.VW=function(e){var t=s();return c(e,t),t},e.Ox=u,e.OL=function(){var e;return e||(e=s()),v.set(0,0,0,e.N),e.ab=1e12,e},e.CO=function(e,t){var a=v.subtract(t.N,e.N,v.create());0==v.length(a)&&v.set(1,0,0,a);var r=v.normalize(a,v.create()),a=v.scale(r,e.ab,v.create());v.add(a,e.N,a);var n=v.scale(r,-e.ab,v.create());v.add(n,e.N,n);var o=v.scale(r,t.ab,v.create());v.add(o,t.N,o);var i=v.scale(r,-t.ab,v.create());for(v.add(i,t.N,i),a=[a,n,o,i],r=v.normalize(r,v.create()),n=a[0],o=a[0],i=1;i<a.length;i++){var _=v.dot(a[i],r);_<v.dot(n,r)&&(n=a[i]),_>v.dot(o,r)&&(o=a[i])}r=[n,o],a=r[0],r=r[1],e.N=v.scale(v.add(a,r,v.create()),.5,v.create()),e.ab=v.length(v.subtract(r,a,v.create()))/2},e.Hy=function(e,t){v.add(e.N,e.Ja,x),v.add(x,e.Ia,x),v.add(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.add(e.N,e.Ja,x),v.add(x,e.Ia,x),v.subtract(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.add(e.N,e.Ja,x),v.subtract(x,e.Ia,x),v.add(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.add(e.N,e.Ja,x),v.subtract(x,e.Ia,x),v.subtract(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.subtract(e.N,e.Ja,x),v.add(x,e.Ia,x),v.add(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.subtract(e.N,e.Ja,x),v.add(x,e.Ia,x),v.subtract(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.subtract(e.N,e.Ja,x),v.subtract(x,e.Ia,x),v.add(x,e.Ka,x),t.push(x[0],x[1],x[2]),v.subtract(e.N,e.Ja,x),v.subtract(x,e.Ia,x),v.subtract(x,e.Ka,x),t.push(x[0],x[1],x[2])},e.zt=d,e.YM=function(e){var t=n();return v.copy(e.Ia,t.Ia),v.copy(e.Ja,t.Ja),v.copy(e.Ka,t.Ka),v.copy(e.N,t.N),t},e.Bt=function(e){var t,a=s();t=v.length(e.Ia);var r=v.length(e.Ja),n=v.length(e.Ka);return t=t>r?t:r,a.N=e.N,a.ab=n>t?n:t,a},e.hF=function(e,t){var a=v.length(e.Ia),r=v.length(e.Ja),n=v.length(e.Ka);return.75*t.ab*t.ab*t.ab>a*r*n},e.sQ=e.uQ=e.tQ=p,e.KC=function(e,t){var a=t.max_z,r=t.min_z,n=Math.max(0,a-r-2*e),o=p();return o.ab=e,o.height=n,o.N[0]=0,o.N[1]=0,o.N[2]=(a+r)/2,o},e.MC=function(e,t){var a=t.max_z,r=t.min_z,n=Math.max(0,a-r),o=p();return o.ab=e,o.height=n,o.N[0]=0,o.N[1]=0,o.N[2]=(a+r)/2,o},e.LC=function(e,t){var a=t.max_z,r=t.min_z,n=Math.max(0,a-r),o=p();return o.ab=e,o.height=n,o.N[0]=0,o.N[1]=0,o.N[2]=(a+r)/2,o},e.PM=e.RM=e.QM=function(e,t){return t.ab=e.ab,t.height=e.height,t.N.set(e.N),t},e.RW=function(e,t){return!(e.min_x>t.max_x||e.max_x<t.min_x)&&(!(e.min_y>t.max_y||e.max_y<t.min_y)&&!(e.min_z>t.max_z||e.max_z<t.min_z))},e.pS=function(e){for(var t=0,n=0,s=a(),c=0;c<e.submeshes.length;c++){for(var l=e.submeshes[c],f=l.position,u=0;u<f.length/3;u++)var p=f[3*u],m=f[3*u+1],g=f[3*u+2],t=Math.max(Math.sqrt(p*p+m*m+g*g),t),n=Math.max(Math.sqrt(p*p+m*m),n);u=l.boundings.bb,f=i(f,0,f.length,a()),u.max_x=f.max_x,u.min_x=f.min_x,u.max_y=f.max_y,u.min_y=f.min_y,u.max_z=f.max_z,u.min_z=f.min_z,u=_(f,A),u=d(u,!1),l.boundings.be_cen=u.N,l.boundings.be_ax=[u.Ia[0],u.Ja[1],u.Ka[2]],c?o(s,f):r(f,s)}c=e.b4w_boundings.bb,c.max_x=s.max_x,c.min_x=s.min_x,c.max_y=s.max_y,c.min_y=s.min_y,c.max_z=s.max_z,c.min_z=s.min_z,c=e.b4w_boundings.bb_src,c.max_x=s.max_x,c.min_x=s.min_x,c.max_y=s.max_y,c.min_y=s.min_y,c.max_z=s.max_z,c.min_z=s.min_z,e.b4w_boundings.bs_rad=t,e.b4w_boundings.bc_rad=n,u=_(s,A),u=d(u,!1),e.b4w_boundings.be_cen=u.N,e.b4w_boundings.be_ax=[u.Ia[0],u.Ja[1],u.Ka[2]]},e.MP=function(e){var t=e.subarray(0,3),a=e.subarray(6,9),r=e.subarray(12,15),n=e.subarray(18,21);e=v.subtract(a,t,x),v.normalize(e,e);var o=h.YP(t,a,r,T),o=v.cross(o,e,o);v.normalize(o,o);var i=v.create(),_=v.create();for(v.subtract(a,t,y),_[0]=v.dot(y,e),_[1]=v.dot(y,o),a=v.create(),v.subtract(r,t,y),a[0]=v.dot(y,e),a[1]=v.dot(y,o),r=v.create(),v.subtract(n,t,y),r[0]=v.dot(y,e),r[1]=v.dot(y,o),n=s(),r=[i,_,a,r],i=m(n,r[0],r[1]),n=2;n<r.length;n++)if(v.distance(i.N,r[n])>i.ab){for(var c=i,i=r,_=r[n],a=n-1,c=m(c,_,i[0]),l=1;l<=a;l++)if(v.distance(c.N,i[l])>c.ab){for(var f=c,c=i,u=_,d=i[l],p=l-1,f=m(f,u,d),g=0;g<=p;g++)if(v.distance(f.N,c[g])>f.ab){var b=u,E=d,A=c[g],S=v.subtract(E,A,y),S=v.squaredLength(S),O=v.subtract(b,A,y),w=v.squaredLength(O),O=v.subtract(b,E,y),R=v.squaredLength(O),O=S*(w+R-S),L=w*(R+S-w),S=R*(S+w-R),w=O+L+S;v.copy(b,f.N),v.scale(f.N,O/w,f.N),v.scaleAndAdd(f.N,E,L/w,f.N),v.scaleAndAdd(f.N,A,S/w,f.N),f.ab=v.distance(f.N,b)}c=f}i=c}return n=i,e=v.scale(e,n.N[0],y),v.scaleAndAdd(e,o,n.N[1],e),v.add(e,t,n.N),n}},a.module.__compat=function(e,t){function a(e){return-1<navigator.userAgent.indexOf(e)}function r(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function n(){return!window.ActiveXObject&&"ActiveXObject"in window}var o=t("__config"),i=t("__debug"),_=t("__extensions"),s=t("__print"),c=t("__renderer"),l="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");e.$B=256;var f=o.sl,u=o.H,d=o.Jl,p=o.context,m=o.Zg,g=o.Z,h=o.I,v=o.Od;e.kO=function(e){e.getError()==e.INVALID_ENUM&&s.warn("Possible Tegra invalid enum issue detected, ignoring")},e.aH=function(t,b){function E(e){b&&s.warn(e)}m.vR=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),m.Ez=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),m.Iz=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),m.lv=t.getParameter(t.MAX_VARYING_VECTORS),m.Jz=t.getParameter(t.MAX_VERTEX_ATTRIBS),m.SF=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m.mv=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m.Wf=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),m.Fz=t.getParameter(t.MAX_RENDERBUFFER_SIZE),m.Qb=t.getParameter(t.MAX_TEXTURE_SIZE),m.Kz=t.getParameter(t.MAX_VIEWPORT_DIMS);var A=_.get_renderer_info();if(A){var x=t.getParameter(A.UNMASKED_VENDOR_WEBGL),T=t.getParameter(A.UNMASKED_RENDERER_WEBGL);-1<x.indexOf("Qualcomm")&&-1<T.indexOf("330")&&a("Chrome")&&(E("Chrome and Qualcomm 330 detected, force enable WebGL 1."),u.Ab=!1)}m.xn=u.Ab?24:16,u.Ab&&!d.enabled&&(u.jq=!0),u.Ab?(u.Rb=Math.min(u.Rb,t.getParameter(t.MAX_SAMPLES)),a("Firefox")&&(E("Firefox and WebGL 2 detected, applying framebuffer hack."),u.hD=!0),a("Windows")&&a("Chrome")&&(E("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),u.Rb=1)):u.Rb=1,a("Firefox")&&"NONE"!==u.stereo&&(E("Firefox and Stereo rendering detected, disable texture reusage"),u.iE=!0),(u.Ab&&i.yM()||a("Firefox"))&&(E("Firefox detected, disabling multisample"),u.Rb=1),a("Mac OS X")&&a("Chrome/60")&&(E("macOS and Chrome 60 detected, disabling multisample"),u.Rb=1),c.gT();var y=!!_.DP();if(a("Firefox/28.0")&&(a("Linux")||a("Macintosh"))&&(E("Firefox 28 detected, applying depth hack"),y=!1),a("Windows Phone")||(a("iPad")||a("iPhone")?(E("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),p.alpha||(u.background_color[3]=1),u.Qu=!0,u.CI=!0,u.smaa=!1,u.ssao=!1,u.lz=!0,_.IE()&&v.Rv&&(u.Cl="pvr")):a("Mac OS X")&&a("Safari")&&!a("Chrome")&&(E("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),u.NG=!0,g.GC=!0,g.qD=!0)),a("Windows")&&(a("Chrome/40")||a("Firefox/33")||a("Firefox/34")||a("Firefox/35")||a("Firefox/36"))&&(E("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),u.ey=!0),a("Chrome")&&!r()&&o.kF()&&(E('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),u.nD=!0),a("Mac OS X")&&(u.iv=!0,E("OS X detected, applying shadows hack.")),r()&&(E("Mobile detected, applying various hacks for video textures."),u.is_mobile_device=!0,a("iPad")||a("iPhone")||a("Windows Phone")||(E("Mobile (not iOS) detected, disable playback rate for video textures."),g.YD=!0)),(a("Firefox/35.0")||a("Firefox/36.0"))&&a("Windows")&&(E("Windows/Firefox 35/36 detected, applying shadows slink hack"),u.qH=!0),(a("iPhone")||n())&&(E("iPhone or IE11 detected. Enable sequential video fallback for video textures."),u.Jr=!0),10>m.lv&&(E("Not enough varyings, disable shadows on blend objects"),u.yy=!0),a("Windows Phone")&&(E("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),u.debug_view=!1,u.glow_materials=!1,u.ssao=!1,u.smaa=!1,u.shadows=!1,u.reflections=!1,u.refractions=!1,u.xG=!1),(a("UCBrowser")||a("Chrome")&&a("Nexus")&&u.is_mobile_device)&&(E("Mobile Nexus Chrome or UCBrowser detected, disable workers."),h.Om=!1),a("Firefox")&&(E("Firefox detected, disabling workers, applying compositing hack for transparent node materials."),h.Om=!1,u.hE=!0),(n()||a("Edge"))&&(E("IE11 or Edge detected, disabling workers"),h.Om=!1),A){for(x=t.getParameter(A.UNMASKED_VENDOR_WEBGL),T=t.getParameter(A.UNMASKED_RENDERER_WEBGL),A=/\b4\d{2}\b/,a("Chrome")&&-1<T.indexOf("Mali-T720")&&(E('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),u.NF=!0),-1<T.indexOf("AMD")&&a("Windows")&&a("Firefox")&&(E("AMD, Windows and Firefox detected, disabling depth textures."),y=!1),-1<x.indexOf("ARM")&&A.test(T)&&(E("ARM Mali-400 series detected, applying depth and frames blending hacks"),y=!1,f.nE=!0),-1<x.indexOf("ARM")&&-1<T.indexOf("Mali-T604")&&(E("ARM Mali-T604 detected, disabling shadows."),u.shadows=!1),-1<x.indexOf("ARM")&&-1<T.indexOf("Mali-T760")&&(E("ARM Mali-T760 detected, disabling SSAO."),u.ssao=!1,u.fw=!0,u.Ab&&(u.Rb=1,E("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1."))),-1<x.indexOf("ARM")&&-1<T.indexOf("Mali-T720")&&(E("ARM Mali-T720 detected, disabling depth textures."),y=!1,u.Ab&&(u.Rb=1,E("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1."))),-1<x.indexOf("Qualcomm")&&-1<T.indexOf("Adreno")&&(E("Qualcomm Adreno detected, applying shader constants hack."),u.JA=!0,-1<T.indexOf("420")&&(E("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),m.Qb=Math.min(m.Qb,4096),m.Wf=Math.min(m.Wf,4096)),a("Chrome")&&(T.match(/4../)||T.match(/5../))&&(E("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),u.Rb=1)),-1<x.indexOf("NVIDIA")&&-1<T.indexOf("Tegra 3")&&(E("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),u.lE=!0),a("Windows")&&a("Chrome")&&!a("Edge")&&(T.match(/NVIDIA GeForce 8..0/)||T.match(/NVIDIA GeForce 9..0/)||T.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(E("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),m.Wf=e.$B,u.Er=!0),-1<T.indexOf("PowerVR")&&-1<T.indexOf("SGX")&&(E("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),u.Er=!0,u.fw=!0,u.shadows=!1),a("Windows")&&-1<T.indexOf("Direct3D9")&&(E("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),u.QD=!0,u.Er=!0,u.IG=!0),x="",A=0;A<l.length;A++)if(-1<T.indexOf(l[A])){x=l[A];break}x&&(E("Architecture "+x+" detected. Blending between frames and shadows on blend objects will be disabled."),u.fw=!0,u.yy=!0)}if(0==m.SF&&(E("Vertex textures are not allowed. Disabling vertex textures"),u.Ns=!1),y||(u.Jn=!1,u.Dc=!1,u.water_dynamic=!1,u.shore_smoothing=!1,u.Do=!1,u.smaa=!1,u.ssao=!1,u.Fr=!0),u.oI=!!_.JE()||"pvr"==u.Cl,u.Nt=y,t.getShaderPrecisionFormat)var S=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);t.getShaderPrecisionFormat&&0!==S.precision||(u.precision="mediump"),(n()&&a("Touch")||a("Edge"))&&(E("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),u.Tn=!0),(n()||a("Edge"))&&(u.cF=!0,u.bF=!0,u.Er=!0),r()&&a("Firefox")&&(s.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),u.Mz=!0,m.Qb=Math.min(m.Qb,4096),m.Wf=Math.min(m.Wf,4096)),T=!!_.Ny(),u.Jx=T,T=!!_.LE(),u.dB=T},e.cy=a,e.detect_mobile=r,e.yL=function(){a("Firefox/35.0")&&a("Windows")&&(s.warn("Windows/Firefox 35 detected, forcing context's alpha"),o.context.alpha=!0)},e.is_ie11=n},a.module.__constraints=function(e,t){function a(e){return{type:e,Ga:null,target:null,Sw:!1,ed:null,za:null,Yh:null,axes:null,SH:null,Zd:null,wI:!1,influence:0,Sj:"",vH:0,pD:0,rD:0,sD:0,oD:0,zy:0,dist_max:0,bv:!1,$q:0,Hw:!1,Yr:0,distance:0,hor_units:"",vert_units:""}}function r(e,t){if(e.ic&&e.ic.Ga&&n(e.ic.Ga,e),t.Ga){var a=t.Ga;-1==a.Ze.indexOf(e)?a.Ze.push(e):v.F("Descendant object override is forbidden")}e.ic=t}function n(e,t){var a=e.Ze.indexOf(t);-1!=a?e.Ze.splice(a,1):v.F("No descendant object")}function o(e,t,n,o,i,_){var s=a(3);s.Ga=t,s.SH=new Float32Array(n),s.Zd=new Float32Array(o),s.wI=i,s.ed=new Float32Array(e.o.v),s.influence=_,r(e,s),u(e,s,0)}function i(e,t,n,o,i,_){var s=a(8);s.Ga=t,s.za=h.create(),h.set_trans(n,s.za),s.axes=new Float32Array(o),s.influence=_,s.Sw=i,s.ed=new Float32Array(e.o.v),r(e,s),u(e,s,0)}function _(e,t,n,o,i){var _=a(9);_.Ga=t,t=h.mb(e.o.v,w),_.Yh=new Float32Array(3),_.Yh[0]=v.QE(t),_.Yh[1]=v.RE(t),_.Yh[2]=v.SE(t),_.axes=new Float32Array(n),_.influence=i,_.Sw=o,_.ed=new Float32Array(e.o.v),r(e,_),u(e,_,0)}function s(e,t,n){var o=a(11);o.Ga=t,o.za=h.create(),h.copy(e.o.v,o.za),o.ed=new Float32Array(e.o.v),o.influence=n,r(e,o),u(e,o,0)}function c(e,t,n){var o=a(13);o.Ga=t,o.za=new Float32Array(n),r(e,o),u(e,o,0)}function l(e,t,n,o){var i=a(14);i.Ga=t,i.Sj=n,i.za=new Float32Array(o),r(e,i),u(e,i,0)}function f(e,t,n){var o=a(17);o.Ga=t,o.ed=new Float32Array(e.o.v),o.za=h.create(),v.Ud(n.right)?(o.bv=!1,o.$q=n.right):v.Ud(n.left)?(o.bv=!0,o.$q=n.left):(o.bv=!0,o.$q=0),v.Ud(n.bottom)?(o.Hw=!1,o.Yr=n.bottom):v.Ud(n.top)?(o.Hw=!0,o.Yr=n.top):(o.Hw=!0,o.Yr=0),v.Ud(n.distance)?o.distance=n.distance:o.distance=0,t=v.Ud(n.rotation)?new Float32Array(n.rotation):b.create(),h.set_quat(t,o.za),v.Ud(n.hor_units)?o.hor_units=n.hor_units:o.hor_units="widths",v.Ud(n.vert_units)?o.vert_units=n.vert_units:o.vert_units="heights",r(e,o),u(e,o,0)}function u(e,t,a){switch(t.type){case 1:h.multiply(t.Ga.o.v,t.za,e.o.v);break;case 12:var r=h.get_trans_view(e.o.v),n=h.get_quat_view(e.o.v),o=h.Cb(t.za,T),i=t.Ga.o.v;a=h.get_quat_view(t.Ga.o.v),b.multiply(b.invert(t.gA,t.gA),n,n),b.multiply(a,n,n),h.transform_vec3(o,i,r),b.copy(a,t.gA),r=h.get_quat_view(e.o.v),n=h.get_quat_view(t.Ga.o.v),o=h.mb(t.za,w),n=b.multiply(n,o,O),n=g.Oy(n,A),o=g.Oy(r,x),v.NS(r,e.o.Zd,v.zl(o[0],n[0]+t.rD,n[0]+t.pD),v.zl(o[1],n[1]+t.oD,n[1]+t.sD),r);break;case 15:var r=h.get_trans_view(e.o.v),n=h.get_quat_view(e.o.v),i=t.Ga.o.v,_=h.get_trans_view(i),s=t.vH,c=T,l=b.copy(n,O),o=h.Cb(t.za,y);h.transform_vec3(o,i,c),v.smooth_v(c,r,a,s,r),v.Tv(r,l,_,v.AXIS_MZ),v.uH(l,n,a,.16*s,n);break;case 2:n=h.get_quat_view(e.o.v),i=R,o=h.Cb(t.za,y),_=h.get_scale(t.za),r=h.mb(t.za,O),m.get_bone_tsr(t.Ga,t.Sj,!0,!1,i),h.multiply(t.Ga.o.v,i,i),n[0]=i[4],n[1]=i[5],n[2]=i[6],n[3]=i[7],b.multiply(n,r,n),h.set_scale(_*i[3],e.o.v),r=h.get_trans_view(e.o.v),h.transform_vec3(o,i,r);break;case 3:r=h.get_trans_view(e.o.v),n=h.get_quat_view(e.o.v),o=h.get_trans_view(t.Ga.o.v),i=t.influence,t.wI?(_=h.mb(t.Ga.o.v,O),_=E.transformQuat(v.AXIS_Z,_,T)):_=v.AXIS_Z,v.Tv(r,n,o,t.SH),o=E.subtract(o,r,y),E.normalize(o,o),v.mS(n,t.Zd,_,o),o=h.mb(t.ed,O),b.slerp(o,n,i,n),h.set_trans(r,t.ed);break;case 5:r=h.get_trans_view(e.o.v),n=h.get_quat_view(e.o.v),o=h.get_trans_view(t.Ga.o.v),v.Tv(r,n,o,v.AXIS_MZ),n=E.dist(r,o),(n=n>t.dist_max?n-t.dist_max:n<t.zy?n-t.zy:0)&&(E.sub(o,r,T),E.normalize(T,T),E.scale(T,n,T),E.add(r,T,r));break;case 7:i=t.Ga.o.v,r=h.get_trans_view(e.o.v),o=h.Cb(t.za,T),h.transform_vec3(o,i,r),h.set_quat(h.get_quat_view(e.o.v),t.ed);break;case 8:_=h.get_trans_view(t.Ga.o.v),r=h.get_trans_view(e.o.v),n=t.axes,a=h.Cb(t.za,T),o=E.set(0,0,0,y),t.Sw&&E.add(o,a,o),i=t.influence,n[0]&&(r[0]=(1-i)*a[0]+i*(v.sign(n[0])*_[0]+o[0])),n[1]&&(r[1]=(1-i)*a[1]+i*(v.sign(n[1])*_[1]+o[1])),n[2]&&(r[2]=(1-i)*a[2]+i*(v.sign(n[2])*_[2]+o[2])),h.set_quat(h.get_quat_view(e.o.v),t.ed);break;case 9:n=t.axes,o=E.set(0,0,0,T),r=E.copy(t.Yh,S),t.Sw&&E.add(o,t.Yh,o),a=h.get_quat_view(t.Ga.o.v),i=y,i[0]=v.QE(a),i[1]=v.RE(a),i[2]=v.SE(a),r[0]=n[0]?v.sign(n[0])*(i[0]+o[0]):t.Yh[0],r[1]=n[1]?v.sign(n[1])*(i[1]+o[1]):t.Yh[1],r[2]=n[2]?v.sign(n[2])*(i[2]+o[2]):t.Yh[2],v.OM(r,t.Yh),i=t.influence,r=v.euler_to_quat(r,O),o=h.mb(t.ed,w),b.slerp(o,r,i,h.get_quat_view(e.o.v)),h.set_trans(h.get_trans_view(e.o.v),t.ed);break;case 11:i=t.influence,_=h.Cb(t.Ga.o.v,T),a=h.mb(t.Ga.o.v,O),r=h.Cb(t.za,y),o=h.mb(t.za,w),v.at(r,_,i,h.get_trans_view(e.o.v)),b.slerp(o,a,i,h.get_quat_view(e.o.v)),h.set_trans(h.get_trans_view(e.o.v),t.ed);break;case 16:n=h.get_quat_view(e.o.v),i=t.Ga.o.v,a=h.get_quat_view(t.Ga.o.v),o=h.Cb(t.za,y),r=h.mb(t.za,O),b.multiply(a,r,n),r=h.get_trans_view(e.o.v),h.transform_vec3(o,i,r);break;case 13:h.multiply(t.Ga.o.v,t.za,e.o.v);break;case 14:r=t.za,i=R,m.get_bone_tsr(t.Ga,t.Sj,!0,!1,i),h.multiply(t.Ga.o.v,i,i),h.multiply(i,r,e.o.v);break;case 17:n=t.Ga,o=g.GP(n),r=h.get_trans_view(e.o.v),a=g.nu(o,"LEFT"),s=g.nu(o,"RIGHT"),i=g.nu(o,"TOP"),_=g.nu(o,"BOTTOM"),c="heights"==t.hor_units?i-_:s-a,r[0]=t.bv?a+c*t.$q:s-c*t.$q,a="heights"==t.vert_units?i-_:s-a,r[1]=t.Hw?i-a*t.Yr:_+a*t.Yr,g.JQ(o)?r[2]=-t.distance:(r[2]=-1,E.normalize(r,r),E.scale(r,t.distance/Math.abs(r[2]),r)),h.transform_dir_vec3(r,n.o.v,r),o=h.get_trans_view(n.o.v),E.add(o,r,r),o=h.get_quat_view(e.o.v),n=h.get_quat_view(n.o.v),r=h.mb(t.za,w),b.multiply(n,r,o)}"CAMERA"==e.o.type&&e.o.hb!=g.MS_STATIC&&(r=e.o.Zd,12==t.type&&(a=h.get_quat_view(t.Ga.o.v),r=E.transformQuat(r,a,L)),g.cI(e),g.correct_up(e,r))}function d(e,t){switch(t.type){case 18:var a=t.target.o.v,r=R;h.invert(e.o.v,r),h.multiply(r,a,r),m.set_bone_tsr(e,t.Sj,r,!1)}e.Vz=!0}var p=t("__physics"),m=t("__armature"),g=t("__camera"),h=t("__tsr"),v=t("__util"),b=t("__quat"),E=t("__vec3");e.NV=1,e.MV=2,e.RV=3,e.JV=5,e.OV=7,e.IV=8,e.LV=12,e.GV=13,e.HV=14,e.KV=15,e.PV=16,e.QV=17,e.FV=18;var A=new Float32Array(2),x=new Float32Array(2),T=new Float32Array(3),y=new Float32Array(3),S=new Float32Array(3),O=new Float32Array(4),w=new Float32Array(4),R=h.create(),L=new Float32Array(3);e.zC=function(e,t,n,o,i){var _=a(1);_.Ga=t,_.za=h.create(),o=o||b.create(),h.set_trans(n,_.za),h.set_scale(i,_.za),h.set_quat(o,_.za),_.ed=new Float32Array(e.o.v),r(e,_),u(e,_,0)},e.sL=function(e,t,n,o,i,_){var s=a(2);s.Ga=t,s.Sj=n,s.ed=new Float32Array(e.o.v),s.za=h.create(),h.set_trans(new Float32Array(o),s.za),h.set_quat(new Float32Array(i),s.za),h.set_scale(_,s.za),r(e,s),u(e,s,0)},e.qL=function(e,t,n,o,i,_,s,c){var l=a(12),f=h.get_quat_view(e.o.v),d=h.get_quat_view(t.o.v);o?(b.copy(o,f),b.multiply(d,f,f)):o=b.create(),l.Ga=t,l.za=h.create(),h.set_trans(n,l.za),h.set_quat(o,l.za),l.gA=new Float32Array(d),l.pD=v.angle_wrap_0_2pi(i),l.rD=v.angle_wrap_0_2pi(_),l.sD=v.angle_wrap_periodic(s,-Math.PI,Math.PI),l.oD=v.angle_wrap_periodic(c,-Math.PI,Math.PI),l.ed=new Float32Array(e.o.v),r(e,l),u(e,l,0)},e.pL=function(e,t,n,o){var i=a(15);i.Ga=t,i.vH=o,i.ed=new Float32Array(e.o.v),i.za=h.create(),h.set_trans(new Float32Array(n),i.za),r(e,i),u(e,i,0)},e.uL=function(e,t,n,o){var i=a(16);i.Ga=t,i.ed=new Float32Array(e.o.v),i.za=h.create(),h.set_trans(new Float32Array(n),i.za),h.set_quat(new Float32Array(o),i.za),h.set_scale(1,i.za),r(e,i),u(e,i,0)},e.pY=n,e.vL=o,e.mL=function(e,t,n,o){var i=a(5);i.Ga=t,i.zy=n,i.dist_max=o,i.ed=new Float32Array(e.o.v),r(e,i),u(e,i,0)},e.tL=function(e,t,n){var o=a(7);o.Ga=t,o.za=h.create(),o.ed=new Float32Array(e.o.v),h.set_trans(new Float32Array(n),o.za),r(e,o),u(e,o,0)},e.hL=i,e.iL=_,e.jL=s,e.BW=c,e.DW=l,e.append_stiff_viewport=f,e.EU=function(e,t){e.ic&&u(e,e.ic,t)},e.zU=function(e,t){var a=e.o.qg[t];a.ic&&d(e,a.ic)},e.sM=function(e){return!!e.ic},e.remove=function(e,t){e.ic.Ga&&n(e.ic.Ga,e),t&&h.copy(e.ic.ed,e.o.v),e.ic=null},e.GX=function(e){return e.ic?e.ic.type:null},e.zg=function(e){return!(!(e=e.ic)||13!=e.type&&14!=e.type)},e.mu=function(e){if((e=e.ic)&&13==e.type)return e.Ga.o.v;if(e&&14==e.type){var t=R;return m.get_bone_tsr(e.Ga,e.Sj,!0,!1,t),h.multiply(e.Ga.o.v,t,t),t}return null},e.xg=function(e){return e=e.ic,!e||13!=e.type&&14!=e.type?null:e.za},e.iS=function(e,t){for(var r=t.o,n=0;n<e.constraints.length;n++){var u=e.constraints[n],m=u.type;if(u.target){var g=u.target.Xa;if("COPY_LOCATION"==m){var m=new Float32Array(h.get_trans_view(t.o.v)),b=new Float32Array(u.axes);i(t,g,m,b,u.use_offset,u.influence)}else if("COPY_ROTATION"==m)b=new Float32Array(u.axes),_(t,g,b,u.use_offset,u.influence);else if("COPY_TRANSFORMS"==m)s(t,g,u.influence);else if("TRACK_TO"==m){if("TRACK_Y"==(m=u.track_axis))var E=v.AXIS_Y;else"TRACK_NEGATIVE_Y"==m?E=v.AXIS_MY:"TRACK_X"==m?E=v.AXIS_X:"TRACK_NEGATIVE_X"==m?E=v.AXIS_MX:"TRACK_Z"==m?E=v.AXIS_Z:"TRACK_NEGATIVE_Z"==m&&(E=v.AXIS_MZ);if("UP_X"==(m=u.up_axis))var A=v.AXIS_X;else"UP_Y"==m?A=v.AXIS_Y:"UP_Z"==m&&(A=v.AXIS_Z);o(t,g,E,A,u.use_target_z,u.influence)}}}if(t.parent){for(!t.Fk&&t.uh.hs&&t.parent.uh.hs&&(t.$o=!1),u=!1,n=0;n<t.K.length;n++)if(t.K[n].eb.pc){u=!0;break}if(u&&p.kQ(t))n=t.Fk?h.copy(r.v,h.create()):r.v,h.multiply(t.parent.o.v,n,r.v);else if(t.Fk||!t.lr)if(n=h.copy(r.v,h.create()),t.bx&&"CAMERA"==t.parent.type){switch(n={distance:t.bx.distance,rotation:h.get_quat_view(n)},t.bx.cL){case"TOP_LEFT":n.top=0,n.left=0;break;case"TOP":n.top=0,n.left=.5;break;case"TOP_RIGHT":n.top=0,n.right=0;break;case"LEFT":n.top=.5,n.left=0;break;case"CENTER":n.top=.5,n.left=.5;break;case"RIGHT":n.top=.5,n.right=0;break;case"BOTTOM_LEFT":n.bottom=0,n.left=0;break;case"BOTTOM":n.bottom=0,n.left=.5;break;case"BOTTOM_RIGHT":n.bottom=0,n.right=0}f(t,t.parent,n)}else c(t,t.parent,n);else n=h.copy(r.v,h.create()),l(t,t.parent,t.lr,n)}if("ARMATURE"==t.type)for(r=e.pose.bones,n=0;n<r.length;n++)if(u=r[n],E=u.constraints)for(A=0;A<E.length;A++)if(m=E[A],"COPY_TRANSFORMS"==m.type&&!m.subtarget&&!m.mute){var g=m.target.Xa,m=t,b=g,x=v.Ax,T=v.zs,g=a(18);g.Sj=u.name,g.target=b,g.za=h.create(),h.set_trans(new Float32Array(x),g.za),h.set_quat(new Float32Array(T),g.za),h.set_scale(1,g.za);for(var b=m,x=g,T=x.target,y=x.Sj,S=b.o.qg[y],O=T.ky,w=0;w<O;w++){var R=O[w];if(R[0]==b&&R[1]==y){O.splice(w,1);break}}T.ky.push([b,y]),S.ic=x,d(m,g)}}},a.module.__container=function(e,t){function a(){x.getBoundingClientRect()}function r(e,t,a,r){return b.bF?(r[0]=e,r[1]=t):(S.clientX=e,S.clientY=t,S.view=window,e=new MouseEvent("b4w_convert",S),a.dispatchEvent(e),r[0]=e.offsetX,r[1]=e.offsetY),r}function n(e,t,a,r){e.style.width=a+"px",e.style.height=r+"px",t&&(t.style.width=a+"px",t.style.height=r+"px")}function o(e,t,a){var r=x,o=T;a&&n(r,o,e,t),o&&(o.width=e,o.height=t,u.Hm()),a=e*b.canvas_resolution_factor,t*=b.canvas_resolution_factor,r.width=a,r.height=t;var o=Math.min(A.drawingBufferWidth,E.Fz,E.Kz[0]),i=Math.min(A.drawingBufferHeight,E.Fz,E.Kz[1]);(a>o||t>i)&&(d.warn("Canvas size exceeds platform limits, downscaling"),o=Math.min(o/a,o/t),a*=o,t*=o),r.width=Math.floor(a),r.height=Math.floor(t),p.iH(r.width,r.height,e?a/e:1),p.Fa()&&h.O(p.get_active().Bi),f.MU(r.width,r.height),f.is_primary_loaded()&&(c.update(),p.update(g.get_timeline(),0),c.lI())}var i,_,s,c=t("__anchors"),l=t("__config"),f=t("__data"),u=t("__hud"),d=t("__print"),p=t("__scenes"),m=t("__subscene"),g=t("__time"),h=t("__transform"),v=t("__util"),b=l.H,E=l.Zg,A=null,x=null,T=null,y=null,S={clientX:0,clientY:0};_=i=0,s=1,e.bg=function(e){A=e},e.get_canvas=function(){return x},e.get_canvas_hud=function(){return T},e.get_container=function(){return y},e.init=function(e,t){e&&e.parentNode?(x=e,T=t,y=e.parentNode):v.F("canvas container is not available")},e.insert_to_container=function(e,t){switch(t=t||"LAST"){case"FIRST":y.insertBefore(e,y.firstElementChild);break;case"JUST_BEFORE_CANVAS":y.insertBefore(e,x);break;case"JUST_AFTER_CANVAS":x.nextElementSibling?y.insertBefore(e,x.nextElementSibling):y.appendChild(e,x);break;case"LAST":y.appendChild(e,x);break;default:d.error(t+" invalid stack order")}},e.OE=function(){return i},e.NE=function(){return _},e.set_canvas_offsets=function(){},e.update_canvas_offsets=a,e.FT=function(e,t,r){i=e,_=t,s=r,a()},e.force_offsets_updating=function(){},e.client_to_canvas_coords=function(e,t,a){return r(e,t,x,a)},e.client_to_element_coords=r,e.Tp=function(e,t,a,r){return a||(a=new Float32Array(2)),a[0]=e*s,a[1]=t*s,r&&(e=r.width/i,a[0]*=e,a[1]*=e),a},e.sV=function(e,t,a,r){a||(a=new Float32Array(2)),a[0]=e/s,a[1]=t/s,r&&(e=r.width/i,a[0]/=e,a[1]/=e)},e.lF=function(t){return!(!t||!t.parentNode)&&(t.parentNode==y||e.lF(t.parentNode))},e.qF=function(){return!!(b.allow_hidpi&&2<=window.devicePixelRatio)},e.QO=function(e){var t=document.getElementsByTagName("script");e=v.ji(e);for(var a=0;a<t.length;a++)if(t[a].src==e)return t[a];return null},e.resize=o,e.resize_to_container=function(e){var t=y,a=x,r=t.clientWidth,t=t.clientHeight;if(e||r!=a.clientWidth||t!=a.clientHeight){if(e=a.width,a=a.height,n(x,T,r,t),p.Fa()){var i=p.get_active();if((i=p.Ib(i,m.jg))&&i.enable_hmd_stereo)return void o(e,a,!1)}o(r,t,!1)}},e.reset=function(){y=T=x=A=null}},a.module.__controls=function(e,t){function a(e,t){return t||(t=d.get_container()),{type:e,value:0,W:null,element:t,La:!1,key:0,Zb:"",Qh:!1,iy:null,hy:function(){},gy:null,xD:function(){},pi:null,from:new Float32Array(3),to:new Float32Array(3),iF:!1,Nu:!1,zr:0,AG:function(){},axis:"",gg:0,Xo:new Float32Array(3),Sv:new Float32Array(4),threshold:0,yG:new Float32Array(4),Ws:0,Vs:0,LG:0,Xs:0,$f:0,repeat:!1,cE:!1,gamepad_id:0,position:x.create(),orientation:v.create(),callback:function(){}}}function r(e){function t(){return{Xj:new Float32Array(2),fm:!0,obj:null,identifier:-1,Vu:!0}}e||(e=d.get_container());for(var a=0;a<L.length;a++){var r=L[a];if(e==r.element)return r}for(r={element:e,Vq:!0,Ge:0,Wu:!0,rv:0,sv:0,nm:0,om:0,qr:0,rr:0,Bh:new Float32Array(2),se:new Float32Array(2),Ch:new Float32Array(2),Ke:new Float32Array(2),Iw:0,nB:0,RH:0,ef:new Uint8Array(256),hx:0,$y:null,hi:t(),Fm:Array(10),rz:!1,TE:v.create(),Eu:0,Du:0,Cu:0,cz:0,bz:0,Bu:1/0,cA:null,bA:null,Rz:null,Nz:null,Pz:null,lB:null,kB:null,Qz:null,Oz:null,lA:null,eY:null,mB:null,jB:null,iB:null,sj:{}},a=0;10>a;++a)r.Fm[a]=t();return r.cA=function(e){r.rz||(p.gQ(e,r.TE),r.rz=!0)},r.bA=function(e){e=x.copy(e,M),r.Cu=e[0],r.Du=e[1],r.Eu=e[2],1/0==r.Bu&&(r.Bu=e[0],r.bz=e[1],r.cz=e[2])},r.Rz=function(e){r.hx+=e*T.CR},r.Nz=function(e){var t=p.get_device_by_type_element(p.DEVICE_MOUSE,r.element),t=p.get_vector_param(t,p.MOUSE_LOCATION,N);r.rv=t[0],r.sv=t[1],r.nm=t[0],r.om=t[1],3!=r.Ge&&0!=r.Ge||(r.Ge=1),r.which=e},r.Pz=function(){var e=p.get_device_by_type_element(p.DEVICE_MOUSE,r.element),e=p.get_vector_param(e,p.MOUSE_LOCATION,N),e=d.client_to_canvas_coords(e[0],e[1],N);r.hi.fm=!1,r.hi.Xj[0]=e[0],r.hi.Xj[1]=e[1]},r.lB=function(e){for(var t=0;t<e.length;++t){for(var a=e[t],n=null,o=null,i=0;i<r.Fm.length;i++){var _=r.Fm[i];if(_.identifier==a.identifier){_.Vu&&(o=_);break}!n&&_.Vu&&(n=_,n.identifier=a.identifier)}(a=o||n)&&(n=d.client_to_canvas_coords(e[t].clientX,e[t].clientY,N),a.fm=!1,a.Vu=!1,a.Xj[0]=n[0],a.Xj[1]=n[1])}},r.kB=function(e){for(var t=0;t<r.Fm.length;++t){for(var a=r.Fm[t],n=!1,o=0;o<e.length;++o)if(e[o].identifier==a.identifier){n=!0;break}n||(a.fm=!0,a.Vu=!0,a.obj=null)}},r.Qz=function(e){var t=p.get_device_by_type_element(p.DEVICE_MOUSE,r.element),t=p.get_vector_param(t,p.MOUSE_LOCATION,N);r.rv=t[0],r.sv=t[1],r.nm=t[0],r.om=t[1],0<r.Ge&&(r.Ge=3),r.which=e},r.Oz=function(e){y.Tn&&!r.Ge||(r.nm=e[0],r.om=e[1])},r.lA=function(e){y.Tn&&!r.Ge||(r.qr+=e[0],r.rr+=e[1])},r.wF=function(e){2!=r.ef[e]&&(r.ef[e]=1,r.Vq=!1)},r.yF=function(){for(var e=0;e<r.ef.length;e++)0!=r.ef[e]&&(r.ef[e]=3,r.Vq=!1)},r.zF=function(e){r.Vq=!1,r.ef[e]=3},r.mB=function(e){if(r.Wu=!1,1==e.length)r.Bh[0]=e[0].clientX,r.Bh[1]=-1,r.Ch[0]=e[0].clientY,r.Ch[1]=-1;else if(1<e.length){r.Iw=r.nB=l(e),r.Bh[0]=e[0].clientX,r.Bh[1]=e[1].clientX,r.Ch[0]=e[0].clientY,r.Ch[1]=e[1].clientY;var t=e[0];e=e[1],r.RH=Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)}r.se.set(r.Bh),r.Ke.set(r.Ch)},r.jB=function(e){1===e.length?(r.se[0]=e[0].clientX,r.se[1]=-1,r.Ke[0]=e[0].clientY,r.Ke[1]=-1):1<e.length&&(r.se[0]=e[0].clientX,r.se[1]=e[1].clientX,r.Ke[0]=e[0].clientY,r.Ke[1]=e[1].clientY,r.Iw=l(e))},r.iB=function(e){0==e.length&&(r.Wu=!0)},L.push(r),r}function n(e,t){if(t in e.sj&&0<e.sj[t])e.sj[t]+=1;else switch(e.sj[t]=1,t){case"orientation_quat":var a=p.get_device_by_type_element(p.DEVICE_GYRO);a&&p.attach_param_cb(a,p.GYRO_ORIENTATION_ANGLES,e.cA);break;case"orientation_angles":(a=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.attach_param_cb(a,p.GYRO_ORIENTATION_ANGLES,e.bA);break;case"mouse_wheel":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.MOUSE_WHEEL,e.Rz);break;case"mouse_down_which":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.MOUSE_DOWN_WHICH,e.Nz);break;case"mouse_select":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.MOUSE_DOWN_WHICH,e.Pz);break;case"touch_select":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&(p.attach_param_cb(a,p.TOUCH_START,e.lB),p.attach_param_cb(a,p.TOUCH_END,e.kB));break;case"mouse_up_which":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.MOUSE_UP_WHICH,e.Qz);break;case"mouse_location":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.MOUSE_LOCATION,e.Oz);break;case"mouse_pointerlock":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.attach_param_cb(a,p.TB,e.lA);break;case"keyboard_downed_keys":(a=p.get_device_by_type_element(p.DEVICE_KEYBOARD,e.element))&&(p.attach_param_cb(a,p.KEYBOARD_DOWN,e.wF),p.attach_param_cb(a,p.SB,e.yF),p.attach_param_cb(a,p.KEYBOARD_UP,e.zF));break;case"touch_start":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.attach_param_cb(a,p.TOUCH_START,e.mB);break;case"touch_move":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.attach_param_cb(a,p.TOUCH_MOVE,e.jB);break;case"touch_end":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.attach_param_cb(a,p.TOUCH_END,e.iB)}}function o(e,t){if(t in e.sj&&0<e.sj[t]&&!--e.sj[t])switch(t){case"orientation_quat":var a=p.get_device_by_type_element(p.DEVICE_GYRO);a&&p.detach_param_cb(a,p.GYRO_ORIENTATION_QUAT,e.cA);break;case"orientation_angles":(a=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.detach_param_cb(a,p.GYRO_ORIENTATION_ANGLES,e.bA);break;case"mouse_wheel":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.MOUSE_WHEEL,e.Rz);break;case"mouse_down_which":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.MOUSE_DOWN_WHICH,e.Nz);break;case"mouse_select":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.MOUSE_DOWN_WHICH,e.Pz);break;case"touch_select":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&(p.detach_param_cb(a,p.TOUCH_START,e.lB),p.detach_param_cb(a,p.TOUCH_END,e.kB));break;case"mouse_up_which":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.MOUSE_UP_WHICH,e.Qz);break;case"mouse_location":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.MOUSE_LOCATION,e.Oz);break;case"mouse_pointerlock":(a=p.get_device_by_type_element(p.DEVICE_MOUSE,e.element))&&p.detach_param_cb(a,p.TB,e.lA);break;case"keyboard_downed_keys":(a=p.get_device_by_type_element(p.DEVICE_KEYBOARD,e.element))&&(p.detach_param_cb(a,p.KEYBOARD_DOWN,e.wF),p.detach_param_cb(a,p.SB,e.yF),p.detach_param_cb(a,p.KEYBOARD_UP,e.zF));break;case"touch_start":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.detach_param_cb(a,p.TOUCH_START,e.mB);break;case"touch_move":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.detach_param_cb(a,p.TOUCH_MOVE,e.jB);break;case"touch_end":(a=p.get_device_by_type_element(p.DEVICE_TOUCH,e.element))&&p.detach_param_cb(a,p.TOUCH_END,e.iB)}}function i(e,t){e.value=Number(t)}function _(e){for(var t=e.uj,a=e.WS,r=0;r<t.length;r++)a[r]=t[r].value;return e.pR(a)}function s(e,t){e=e||O;var a=e.Ah;if(a){var r=e.zm;if(t){var n=a[t];if(n){for(var o=n.uj,i=0;i<o.length;i++){var _,l=o[i];_=w.indexOf(l),_=-1<_?R[_]:[],1==_.length?(c(l),l=w.indexOf(l),-1<l?(w.splice(l,1),R.splice(l,1)):A.F("Sensors cache is corrupted")):1<_.length&&_.splice(_.indexOf(n),1)}delete a[t],i=r.indexOf(n),-1<i?r.splice(i,1):A.F("Incorrect manifolds array"),Object.getOwnPropertyNames(a).length||(a=S.indexOf(e),-1<a?S.splice(a,1):g.error("Wrong object"))}}else{r=[];for(i in a)r.push(i);for(i=0;i<r.length;i++)s(e,r[i])}D=!0}}function c(e){switch(e.type){case 90:h.remove_collision_test(e.iy,e.Zb,e.hy),e.La=!0;break;case 100:h.clear_collision_impulse_test(e.gy),e.La=!0;break;case 110:h.remove_ray_test(e.zr),e.La=!0;break;case 140:e.La=!0;break;case 20:var t=r(e.element);o(t,"keyboard_downed_keys"),e.La=!0;break;case 30:t=r(e.element),o(t,"mouse_wheel"),e.La=!0;break;case 40:t=r(e.element),o(t,"mouse_down_which"),o(t,"mouse_up_which"),o(t,"mouse_location"),e.La=!0;break;case 280:t=r(e.element),o(t,"mouse_pointerlock"),e.La=!0;break;case 50:t=r(e.element),o(t,"mouse_down_which"),o(t,"mouse_up_which"),e.La=!0;break;case 60:t=r(e.element),o(t,"touch_start"),o(t,"touch_move"),o(t,"touch_end"),e.La=!0;break;case 70:case 75:t=r(e.element),o(t,"touch_start"),o(t,"touch_move"),e.La=!0;break;case 80:t=r(e.element),o(t,"touch_start"),o(t,"touch_end"),e.La=!0;break;case 170:t=r(e.element),o(t,"mouse_select"),o(t,"touch_select"),o(t,"touch_start"),o(t,"touch_end"),o(t,"mouse_down_which"),o(t,"mouse_up_which"),e.La=!0;break;case 180:case 190:t=r(e.element),o(t,"orientation_angles"),e.La=!0;break;case 200:t=r(e.element),o(t,"orientation_quat"),e.La=!0;break;case 210:case 220:e.La=!0}}function l(e){var t=e[0],a=e[1];return e=t.clientX-a.clientX,t=t.clientY-a.clientY,Math.sqrt(e*e+t*t)}function f(e){return 0==e?p.get_device_by_type_element(p.vs):1==e?p.get_device_by_type_element(p.px):2==e?p.get_device_by_type_element(p.qx):p.get_device_by_type_element(p.rx)}var u=t("__config"),d=t("__container"),p=t("__input"),m=t("__objects"),g=t("__print"),h=t("__physics"),v=t("__quat"),b=t("__time"),E=t("__tsr"),A=t("__util"),x=t("__vec3"),T=u.controls,y=u.H,S=[],O={},w=[],R=[],L=[],N=new Float32Array(2),I=new Float32Array(2),M=x.create(),C=v.create(),D=!1,U=0;e.CT_POSITIVE=10,e.CT_CONTINUOUS=20,e.CT_TRIGGER=30,e.CT_SHOT=40,e.CT_LEVEL=50,e.CT_CHANGE=60,e.PL_SINGLE_TOUCH_MOVE=0,e.PL_MULTITOUCH_MOVE_ZOOM=1,e.PL_MULTITOUCH_MOVE_PAN=2,e.PL_MULTITOUCH_MOVE_ROTATE=3;var k=1;e.update=function(t,a){for(var n=0;n<L.length;n++){var o=L[n];o.hi.fm||(o.hi.obj=m.pick_object(o.hi.Xj[0],o.hi.Xj[1]),o.hi.fm=!0,o.$y=o.hi.obj);for(var s=0;10>s;++s){var c=o.Fm[s];c.fm||(c.obj=m.pick_object(c.Xj[0],c.Xj[1]),c.fm=!0,o.$y=c.obj)}}for(n=0;n<w.length;n++)if(o=w[n],c=t,s=a)switch(o.type){case 120:var l=o.pi,u=E.Cb(l.o.v,M),l=E.mb(l.o.v,C),d=x.dist(o.Xo,u),g=o.yG;v.invert(o.Sv,g),v.multiply(l,g,g),v.normalize(g,g),g=Math.abs(2*Math.acos(g[3])),d/=s,o.Ws=A.smooth(d,o.Ws,s,.3),o.W[0]=d,d=g/s,o.Vs=A.smooth(d,o.Vs,s,.3),o.W[1]=d,o.Ws>=o.threshold||o.Vs>=o.LG?i(o,1):i(o,0),x.copy(u,o.Xo),v.copy(l,o.Sv),o.gg=c;break;case 130:l=o.pi,u=E.Cb(l.o.v,M),l=Math.abs(u[1]-o.Xo[1])/s,o.Xs=A.smooth(l,o.Xs,s,.3),o.W=l,o.Xs>=o.threshold?i(o,1):i(o,0),x.copy(u,o.Xo),o.gg=c;break;case 140:!o.La&&0<=o.$f&&c-o.gg>=o.$f&&(i(o,1),o.repeat?o.gg=c:o.$f=-o.$f);break;case 150:o.gg||(o.gg=c),i(o,c-o.gg),o.gg=c;break;case 160:i(o,c);break;case 180:c=r(o.element),o.W[0]=c.Eu-c.cz,o.W[1]=c.Du-c.bz,o.W[2]=c.Cu-c.Bu;break;case 190:c=r(o.element),o.W[0]=c.Eu,o.W[1]=c.Du,o.W[2]=c.Cu;break;case 200:c=r(o.element),v.copy(c.TE,o.W);break;case 210:s=p.get_device_by_type_element(p.DEVICE_HMD),p.get_vector_param(s,p.HMD_ORIENTATION_QUAT,o.W);break;case 220:s=p.get_device_by_type_element(p.DEVICE_HMD),p.get_vector_param(s,p.HMD_POSITION,o.W);break;case 240:s=f(o.gamepad_id),o.value=p.OP(s,o.key);break;case 250:s=f(o.gamepad_id),o.value=p.NP(s,o.key);break;case 260:s=f(o.gamepad_id),p.get_gamepad_position(s,o.W),i(o,1);break;case 270:s=f(o.gamepad_id),p.get_gamepad_orientation(s,o.W),i(o,1);break;case 230:i(o,o.callback());break;case 30:c=r(o.element),i(o,c.hx);break;case 40:if(c=r(o.element),!y.Tn||1==c.Ge||2==c.Ge)switch(u=c.nm-c.rv,l=c.om-c.sv,o.W.coords[0]=c.nm,o.W.coords[1]=c.om,o.axis){case"X":i(o,u);break;case"Y":i(o,l);break;case"XY":s=Math.sqrt(u*u+l*l),i(o,s)}break;case 280:c=r(o.element),y.Tn||(u=c.qr,l=c.rr,d=A.smooth(u,0,s,.1*k),s=A.smooth(l,0,s,.1*k),.01<Math.abs(u)||.01<Math.abs(l)?(c.qr-=d,c.rr-=s,o.W.coords[0]=d,o.W.coords[1]=s):(o.W.coords[0]=0,o.W.coords[1]=0),i(o,Math.sqrt(u*u+l*l)));break;case 50:c=r(o.element),i(o,0<c.Ge|0),o.W.which=c.which,o.W.coords[0]=c.nm,o.W.coords[1]=c.om;break;case 170:if(c=r(o.element),i(o,0),o.cE)c.$y==o.pi&&i(o,1);else if(c.Ge&&c.hi.obj==o.pi)i(o,1);else if(!c.Wu)for(s=0;10>s;++s)if(c.Fm[s].obj==o.pi){i(o,1);break}break;case 20:c=r(o.element),o.W=c.ef[o.key],1==o.W||c.ef[0]&&16==o.key?i(o,1):o.W||i(o,0);break;case 60:if(c=r(o.element),-1==c.se[1]&&-1==c.Ke[1]){if(u=c.se[0]-c.Bh[0],l=c.Ke[0]-c.Ch[0],s=Math.sqrt(u*u+l*l),-1!=c.Bh[1]&&-1!=c.Ch[1]){var d=c.se[0]-c.Bh[1],g=c.Ke[0]-c.Ch[1],h=Math.sqrt(d*d+g*g);h<s&&(u=d,l=g,s=h)}o.W.gesture=e.PL_SINGLE_TOUCH_MOVE}else s=N,s[0]=(c.se[0]+c.se[1])/2,s[1]=(c.Ke[0]+c.Ke[1])/2,l=I,l[0]=(c.Bh[0]+c.Bh[1])/2,l[1]=(c.Ch[0]+c.Ch[1])/2,u=s[0]-l[0],l=s[1]-l[1],s=Math.sqrt(u*u+l*l),o.W.gesture=e.PL_MULTITOUCH_MOVE_PAN;switch(o.W.coords[0]=c.se[0],o.W.coords[1]=c.Ke[0],o.axis){case"X":i(o,u);break;case"Y":i(o,l);break;case"XY":i(o,s)}break;case 70:c=r(o.element),s=c.Iw-c.nB,o.W=e.PL_MULTITOUCH_MOVE_ZOOM,i(o,s);break;case 75:c=r(o.element),-1!=c.se[1]&&(s=Math.atan2(c.Ke[0]-c.Ke[1],c.se[0]-c.se[1]),o.W=e.PL_MULTITOUCH_MOVE_ROTATE,i(o,s-c.RH));break;case 80:c=r(o.element),o.W.coords[0]=c.se[0],o.W.coords[1]=c.Ke[0],c.Wu?i(o,0):i(o,1)}for(n=0;n<S.length;n++)for(c=S[n],o=c.zm,s=0;s<o.length;s++)if(u=o[s],u.Zk!=U){switch(u.Zk=U,g=u,l=0,g.type){case e.CT_POSITIVE:l=(d=_(g))?1:0;break;case e.CT_CONTINUOUS:l=g.gj,(d=_(g))?(l=1,g.gj=1):1==l?(l=-1,g.gj=-1):l=0;break;case e.CT_TRIGGER:l=g.gj,(d=_(g))&&-1==l?(l=1,g.gj=1):d||1!=l?l=0:(l=-1,g.gj=-1);break;case e.CT_SHOT:l=g.gj,(d=_(g))&&-1==l?(l=1,g.gj=1):d||1!=l?l=0:(l=0,g.gj=-1);break;case e.CT_LEVEL:d=_(g),g.BF!=d?(l=1,g.BF=d):l=0;break;case e.CT_CHANGE:for(d=g.uj,g=g.RQ,h=0;h<d.length;h++){var b=d[h].value;l||b==g[h]||(l=1),g[h]=b}break;default:A.F("Wrong sensor manifold type: "+g.type)}if(l&&(d=c==O?null:c,D=!1,u.callback(d,u.id,l,u.hM),D)){n=-1;break}}for(n=0;n<S.length;n++)for(c=S[n],o=c.zm,s=0;s<o.length;s++)for(u=o[s],c=u.uj,u=0;u<c.length;u++)switch(l=c[u],l.type){case 30:case 40:case 60:case 70:case 75:case 80:i(l,0);break;case 140:i(l,0)}for(n=0;n<L.length;n++){if(o=L[n],!o.Vq){for(s=0;s<o.ef.length;s++)1==o.ef[s]?o.ef[s]=2:3==o.ef[s]&&(o.ef[s]=0);o.Vq=!0}1==o.Ge?o.Ge=2:3==o.Ge&&(o.Ge=0),o.hx=0,o.rv=o.nm,o.sv=o.om,o.ef[0]=0,o.Bh.set(o.se),o.Ch.set(o.Ke),o.nB=o.Iw,o.cz=o.Eu,o.bz=o.Du,o.Bu=o.Cu,o.rz=!1}U++},e.create_custom_sensor=function(e){var t=a(10);return i(t,e),t},e.create_keyboard_sensor=function(e){var t=a(20,document);return t.key=e,t.La=!0,t},e.create_gamepad_btn_sensor=function(e,t){var r=a(240,document);return t=t||p.pu(),r.gamepad_id=t,r.key=e,r.La=!0,r},e.create_gamepad_axis_sensor=function(e,t){var r=a(250,document);return t=void 0==t?p.pu():t,r.gamepad_id=t,r.key=e,r.La=!0,r},e.create_gamepad_position_sensor=function(e){var t=a(260,document);return e=void 0===e?p.pu():e,t.gamepad_id=e,t.La=!0,t.W=x.create(),t},e.create_gamepad_orientation_sensor=function(e){var t=a(270,document);return e=void 0===e?p.pu():e,t.gamepad_id=e,t.La=!0,t.W=v.create(),t},e.create_collision_sensor=function(e,t,r){if(!e||!h.na(e))return g.error("Wrong collision object"),null;var n=a(90);return n.iy=e,n.Zb=t,n.Qh=r,n.W={coll_obj:null,coll_pos:r?new Float32Array(3):null,coll_norm:r?new Float32Array(3):null,coll_dist:0},n.hy=function(e,t,a,r,o){i(n,e),e=n.W,e.coll_obj=t,n.Qh&&(e.coll_pos.set(a),e.coll_norm.set(r),e.coll_dist=o)},n.La=!0,n},e.create_collision_impulse_sensor=function(e){if(!e||!e.I)return g.error("Wrong collision impulse object"),null;var t=a(100);return t.gy=e,t.xD=function(e){i(t,e)},t.La=!0,t},e.create_ray_sensor=function(e,t,r,n,o,_,s){var c=a(110);return c.pi=e,c.from=t,c.to=r,c.Zb=n,c.iF=o,c.Qh=_,c.Nu=s,c.W={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),zr:0},c.AG=function(e,t,a,r,n,o){c.iF?i(c,-1==t?0:1):i(c,t),c.W.hit_fract=t,c.W.obj_hit=a,c.W.hit_time=r,c.Qh&&(c.W.hit_pos.set(n),c.W.hit_norm.set(o))},c.La=!0,c},e.create_mouse_click_sensor=function(e){return e=a(50,e),e.La=!0,e.W={coords:new Float32Array(2),which:null},e},e.create_mouse_wheel_sensor=function(e){return e=a(30,e),e.La=!0,e},e.create_mouse_move_sensor=function(e,t){var r=a(40,t);return r.axis=e||"XY",r.W={coords:new Float32Array(2)},r.La=!0,r},e.create_touch_move_sensor=function(e,t){var r=a(60,t);return r.axis=e||"XY",r.W={coords:new Float32Array(2),gesture:0},r.La=!0,r},e.create_touch_zoom_sensor=function(e){return e=a(70,e),e.W=0,e.La=!0,e},e.create_touch_rotate_sensor=function(e){return e=a(75,e),e.W=0,e.La=!0,e},e.create_touch_click_sensor=function(e){return e=a(80,e),e.W={coords:new Float32Array(2)},e.La=!0,e},e.create_motion_sensor=function(e,t,r){if(!e)return g.error("Wrong collision object"),null;var n=a(120);n.pi=e;var o=E.get_trans_view(e.o.v);return e=E.get_quat_view(e.o.v),n.yG=new Float32Array(4),n.Xo=new Float32Array(o),n.Sv=new Float32Array(e),n.Ws=0,n.Vs=0,n.threshold=t||.1,n.LG=r||.1,n.gg=0,n.W=new Float32Array([0,0]),n},e.create_vertical_velocity_sensor=function(e,t){if(!e)return g.error("Wrong collision object"),null;var r=a(130);r.pi=e;var n=E.get_trans_view(e.o.v),o=E.get_quat_view(e.o.v);return r.Xo=new Float32Array(n),r.Sv=new Float32Array(o),r.Xs=0,r.threshold=t||1,r.gg=0,r.W=0,r},e.create_timer_sensor=function(e,t){var r=a(140);return r.$f=e,r.repeat=t,r.La=!0,r},e.reset_timer_sensor=function(e,t,a,r){return e=e||O,(e=e.Ah)&&e[t]?(t=e[t].uj[a])?(t.gg=b.get_timeline(),void(t.$f=r)):(g.error("reset_timer_sensor(): sensor not found"),null):(g.error("reset_timer_sensor(): wrong object"),null)},e.create_elapsed_sensor=function(){var e=a(150);return e.gg=0,e},e.create_gyro_delta_sensor=function(){var e=a(180,window);return e.W=new Float32Array(3),p.get_device_by_type_element(p.DEVICE_GYRO)?i(e,1):i(e,0),e.La=!0,e},e.create_gyro_angles_sensor=function(){var e=a(190,window);return e.W=new Float32Array(3),p.get_device_by_type_element(p.DEVICE_GYRO)?i(e,1):i(e,0),e.La=!0,e},e.create_gyro_quat_sensor=function(){var e=a(200,window);return e.W=v.create(),p.get_device_by_type_element(p.DEVICE_GYRO)?i(e,1):i(e,0),e.La=!0,e},e.create_hmd_quat_sensor=function(){var e=a(210,window);return e.W=v.create(),p.get_device_by_type_element(p.DEVICE_HMD)?i(e,1):i(e,0),e.La=!0,e},e.create_hmd_position_sensor=function(){var e=a(220,window);return e.W=x.create(),p.get_device_by_type_element(p.DEVICE_HMD)?i(e,1):i(e,0),e.La=!0,e},e.create_timeline_sensor=function(){return a(160)},e.create_selection_sensor=function(e,t){var r=a(170);return r.pi=e,r.cE=t,r.La=!0,r},e.create_callback_sensor=function(e,t){var r=a(230);return r.callback=e,i(r,t),r},e.create_plock_mouse_sensor=function(e){return e=a(280,e),e.W={coords:new Float32Array(2)},e.La=!0,e},e.create_plock_sensor=function(e){return e=a(290,e),e.La=!0,e},e.VS=i,e.get_sensor_value=function(e,t,a){return e=e||O,(e=e.Ah)&&e[t]?(t=e[t].uj[a],t?t.value:(g.error("get_sensor_value(): sensor not found"),null)):(g.error("get_sensor_value(): wrong object"),null)},e.get_sensor_payload=function(e,t,a){return e=e||O,(e=e.Ah)&&e[t]?(t=e[t].uj[a],t?t.W:(g.error("get_sensor_payload(): sensor not found"),null)):(g.error("get_sensor_payload(): wrong object"),null)},e.cleanup=function(){S=[],O={};for(var e=0;e<w.length;e++)c(w[e]);w.length=0,R.length=0},e.check_sensor_manifold=function(e,t){if(e=e||O,!e.Ah)return!1;if(t&&e.Ah[t])return!0;if(!t)for(var a in e.Ah)return!0;return!1},e.create_sensor_manifold=function(e,t,a,o,i,_,c){e=e||O,e.zm=e.zm||[],e.Ah=e.Ah||{};var l=e.Ah,f=e.zm;for(l[t]&&s(e,t),a={id:t,type:a,uj:o.slice(0),pR:i,WS:Array(o.length),callback:_,hM:c,gj:-1,BF:0,RQ:Array(o.length),Zk:-1},l[t]=a,f.push(a),-1==S.indexOf(e)&&S.push(e),e=0;e<a.uj.length;e++){if(l=t=a.uj[e],l.La){switch(l.type){case 90:h.append_collision_test(l.iy,l.Zb,l.hy,l.Qh);break;case 100:h.apply_collision_impulse_test(l.gy,l.xD);break;case 110:l.zr=h.append_ray_test(l.pi,l.from,l.to,l.Zb,l.AG,!1,!1,l.Qh,l.Nu),l.W.zr=l.zr;break;case 140:l.gg=b.get_timeline(),0>l.$f&&(l.$f=-l.$f);break;case 20:f=r(l.element),n(f,"keyboard_downed_keys");break;case 30:f=r(l.element),n(f,"mouse_wheel");break;case 40:f=r(l.element),n(f,"mouse_down_which"),n(f,"mouse_up_which"),n(f,"mouse_location");break;case 280:f=r(l.element),n(f,"mouse_pointerlock");break;case 290:p.bL(l);break;case 50:f=r(l.element),n(f,"mouse_down_which"),n(f,"mouse_up_which");break;case 60:f=r(l.element),n(f,"touch_start"),n(f,"touch_move"),n(f,"touch_end");break;case 70:case 75:f=r(l.element),n(f,"touch_start"),n(f,"touch_move");break;case 80:f=r(l.element),n(f,"touch_start"),n(f,"touch_end");break;case 170:f=r(l.element),n(f,"mouse_select"),n(f,"touch_select"),n(f,"touch_start"),n(f,"touch_end"),n(f,"mouse_down_which"),n(f,"mouse_up_which");break;case 180:case 190:f=r(l.element),n(f,"orientation_angles");break;case 200:f=r(l.element),n(f,"orientation_quat");break;case 240:case 260:case 270:0==l.gamepad_id?p.get_device_by_type_element(p.vs):1==l.gamepad_id?p.get_device_by_type_element(p.px):2==l.gamepad_id?p.get_device_by_type_element(p.qx):p.get_device_by_type_element(p.rx)}l.La=!1}l=w.indexOf(t),-1==l?(w.push(t),R.push([a])):R[l].push(a)}D=!0},e.default_AND_logic_fun=function(e){for(var t=0;t<e.length;t++)if(!e[t])return e[t];return e[e.length-1]},e.default_OR_logic_fun=function(e){for(var t=0;t<e.length;t++)if(e[t])return e[t];return e[e.length-1]},e.remove_sensor_manifold=s,e.reset=function(){for(var e=0;e<S.length;e++){var t,a=S[e],r=a.Ah,a=a.zm;for(t in r)delete r[t];a.length=0}for(e=0;e<w.length;e++)c(w[e]);S.length=0,w.length=0,R.length=0},e.debug=function(){g.log(String(S.length)+" objects with manifolds",S),g.log(String(w.length)+" sensors",w);for(var e=[],t=[],a=0;a<w.length;a++){var r=w[a];90==r.type&&e.push(r),110==r.type&&t.push(r)}g.log(String(e.length)+" collision sensors",e),g.log(String(t.length)+" ray sensors",t)},e.set_plock_smooth_factor=function(e){k=e}},a.module.__curve=function(e,t){function a(e,t,a,r,n){var o=r.length;n||(n=new Float32Array(o));for(var i=o+e,_=new Float32Array(i),s=1;s<=i-1;s++)_[s-1]=t>=a[s-1]&&t<a[s+1-1]?1:0;for(var c=2;c<=e;c++)for(s=1;s<=i-c;s++)_[s-1]=(_[s-1]?(t-a[s-1])*_[s-1]/(a[s+c-1-1]-a[s-1]):0)+(_[s+1-1]?(a[s+c-1]-t)*_[s+1-1]/(a[s+c-1]-a[s+1-1]):0);for(t==a[i-1]&&(_[o-1]=1),e=0,s=1;s<=o;s++)e+=_[s-1]*r[s-1];for(s=1;s<=o;s++)n[s-1]=e?_[s-1]*r[s-1]/e:0;return n}function r(e){return e=e.Zu,e[e.length-1]}function n(e){return e=e.OD,e[e.length-1]}function o(e,t,a,r,n,_,s,c){var l=e+(t-e)/2,f=i(l,r,n,_,s)-a;return c=c||.01,Math.abs(f)<c?l:0<f?o(e,l,a,r,n,_,s,c):o(l,t,a,r,n,_,s,c)}function i(e,t,a,r,n){var o=1-e;return t*o*o*o+3*a*o*o*e+3*r*o*e*e+n*e*e*e}var _=t("__util"),s=t("__vec3");e.xN=function(e){var t={},r=e.data;if(!(e=r.splines[0])||"NURBS"!=e.type||!e.use_endpoint_u)return null;var n=e.order_u;t.order=n,e=e.points;var o=e.length/5,i=[],s=o+n,o=o+2;i[0]=0;for(var c=2;c<=s;c++)i[c-1]=c>n&&c<o?i[c-2]+1:i[c-2];for(t.Zu=i,"2D"==r.dimensions?t.mk=!1:"3D"==r.dimensions?t.mk=!0:_.F("Wrong curve dimensions"),n=[],i=[],r=0;r<e.length;r+=5)n.push(e[r]),n.push(e[r+1]),n.push(e[r+2]),t.mk&&n.push(e[r+3]),i.push(e[r+4]);t.ly=n,t.BB=i,e=[];for(var r=t.ly,n=t.mk?4:3,i=t.BB,s=t.Zu,o=t.order,c=r.length/n,l=c+o,f=0,u=s[l-1]/999,d=0;1e3>d;d++){5e-6>s[l-1]-f&&(f=s[l-1]);for(var p=a(o,f,s,i),m=0;m<n;m++)for(var g=e[n*d+m]=0;g<c;g++)e[n*d+m]+=p[g]*r[n*g+m];f+=u}for(n=t.mk?4:3,i=new Float32Array(1e3),i[0]=0,r=1;1e3>r;r+=1)s=e[(r-1)*n],o=e[(r-1)*n+1],c=e[(r-1)*n+2],l=e[r*n],f=e[r*n+1],u=e[r*n+2],i[r]=i[r-1]+Math.sqrt((l-s)*(l-s)+(f-o)*(f-o)+(u-c)*(u-c));return t.OD=i,t},e.ZT=function(e,t,n){n||(n=[]),t=Math.min(t,r(e));var o=e.ly,i=e.mk?4:3,_=e.BB,s=e.Zu,c=e.order;e=o.length/i;var l=e+c;for(5e-6>s[l-1]-t&&(t=s[l-1]),l=new Float32Array(e),a(c,t,s,_,l),t=0;t<i;t++)for(_=n[t]=0;_<e;_++)n[t]+=l[_]*o[i*_+t]},e.WT=function(e,t,a){a||(a=[]);var r=e.ly,n=e.mk?4:3,o=e.BB,i=e.Zu,_=e.order;e=r.length/n;var s=e+_;5e-6>i[s-1]-t&&(t=i[s-1]);var s=new Float32Array(e),c=t;t=s;var l=o.length;t||(t=new Float32Array(l));var f=new Float32Array(l),u=new Float32Array(l),d=f,p=u;d||(d=new Float32Array(l)),p||(p=new Float32Array(l));for(var m=l+_,g=new Float32Array(m),h=new Float32Array(m),v=1;v<=m-1;v++)g[v-1]=c>=i[v-1]&&c<i[v+1-1]?1:0;c==i[m-1]&&(g[l-1]=1);for(var b=2;b<=_;b++)for(v=1;v<=m-b;v++){var E=g[v-1]?g[v-1]/(i[v+b-1-1]-i[v-1]):0,A=g[v+1-1]?-g[v+1-1]/(i[v+b-1]-i[v+1-1]):0,x=h[v-1]?(c-i[v-1])*h[v-1]/(i[v+b-1-1]-i[v-1]):0,T=h[v+1-1]?(i[v+b-1]-c)*h[v+1-1]/(i[v+b-1]-i[v+1-1]):0;g[v-1]=(g[v-1]?(c-i[v-1])*g[v-1]/(i[v+b-1-1]-i[v-1]):0)+(g[v+1-1]?(i[v+b-1]-c)*g[v+1-1]/(i[v+b-1]-i[v+1-1]):0),h[v-1]=E+A+x+T}for(v=1;v<=l;v++)d[v-1]=g[v-1],p[v-1]=h[v-1];for(i=0,_=1;_<=l;_++)i+=f[_-1]*o[_-1];for(c=0,_=1;_<=l;_++)c+=u[_-1]*o[_-1];for(_=1;_<=l;_++)t[_-1]=i?u[_-1]*o[_-1]/i+f[_-1]*o[_-1]*c/(i*i):0;for(o=0;o<n;o++)for(i=a[o]=0;i<e;i++)a[o]+=s[i]*r[n*i+o]},e.HY=r,e.YT=n,e.XT=function(e,t){if(0>=t)return 0;var a=r(e);if(t>=n(e))return a;var o=e.OD,i=_.$s(o,t,0,o.length-1);return a*(i+(t-o[i])/(o[i+1]-o[i]))/1e3},e.dv=function(e,t,a,r,n){return a+(n-r)*(e-a)/(t-r)},e.EF=function(e,t,a){var r=t[0];return t=t[1],(a=(a[1]-t)/(a[0]-r))*e+(t-a*r)},e.NC=function(e,t,a,r,n,_){return i(o(0,1,e,t[0],a[0],r[0],n[0],_),t[1],a[1],r[1],n[1])},e.Zx=function(e,t,a,r,n){var o=new Float32Array(3),i=new Float32Array(3),_=new Float32Array(3),c=new Float32Array(3),l=new Float32Array(3),f=new Float32Array(3);s.copy(e[1],i),null==t?(s.copy(a[1],_),o[0]=2*i[0]-_[0],o[1]=2*i[1]-_[1]):s.copy(t[1],o),null==a?(s.copy(t[1],o),_[0]=2*i[0]-o[0],_[1]=2*i[1]-o[1]):s.copy(a[1],_),s.subtract(i,o,c),s.subtract(_,i,l),t=s.length(c),a=s.length(l),0==t&&(t=1),0==a&&(a=1),"AUTO"!=r&&"AUTO"!=n||(f[0]=l[0]/a+c[0]/t,f[1]=l[1]/a+c[1]/t,(o=2.5614*s.length(f))&&("AUTO"==r&&s.scaleAndAdd(i,f,-t/o,e[0]),"AUTO"==n&&s.scaleAndAdd(i,f,a/o,e[2]))),"VECTOR"==r&&s.scaleAndAdd(i,c,-1/3,e[0]),"VECTOR"==n&&s.scaleAndAdd(i,l,1/3,e[2])},e.TM=function(e,t,a,r){var n,o,i,_=[],s=[];_[0]=e[0]-t[0],_[1]=e[1]-t[1],s[0]=r[0]-a[0],s[1]=r[1]-a[1],i=r[0]-e[0],n=Math.abs(_[0]),o=Math.abs(s[0]),n+o&&n+o>i&&(n=i/(n+o),t[0]=e[0]-n*_[0],t[1]=e[1]-n*_[1],a[0]=r[0]-n*s[0],a[1]=r[1]-n*s[1])}},a.module.__debug=function(e,t){function a(e,t,a){var n,o=[];for(n in e)1<x.$i(e[n])&&o.push([n,e[n]]);if(o.sort(function(e,t){var a=x.$i(e[1]),r=x.$i(t[1]);return r!=a?r-a:e<t?-1:t<e?1:0}),o.length){for(h.groupCollapsed(t+" "+a),h.cd("Property different variants (>1) | Property name"),e=0;e<o.length;e++)h.groupCollapsed(x.$i(o[e][1]),o[e][0]),r(o[e][1]);h.groupEnd()}}function r(e){h.cd("Batches count for this property value | Property value");var t,a=[];for(t in e)a.push([t,e[t]]);for(a.sort(function(e,t){return t[1]!=e[1]?t[1]-e[1]:e[0]<t[0]?-1:t[0]<e[0]?1:0}),e=0;e<a.length;e++)h.cd(a[e][1],a[e][0]);h.groupEnd()}function n(e){e=e.split("\n");for(var t=0;t<e.length;t++)e[t]=t+1+" "+e[t];return e=e.join("\n")}function o(){var e=p.Ry();if(e){var t=e.createQuery();e.beginQuery(t)}else t=performance.now();return t}function i(){var t=N;return t&&t.debug_view_mode==e.DV_RENDER_TIME}function _(e,t,a){var r=p.Ry(),n=0;if(r)for(a&&r.endQuery(),a=0;a<e.length;a++){var o=e[a],i=r.yE(o),_=S.getParameter(r.xE());i&&!_&&(n=r.zE(o)/1e6,t&&(n=x.smooth(n,t,1,10)),e.splice(a,1),a--)}else n=performance.now()-e.pop(),t&&(n=x.smooth(n,t,1,10));return n}function s(e,t){if(c(e)||x.F("Structure assertion failed: invalid first object value"),c(t)||x.F("Structure assertion failed: invalid second object value"),l(e,t)||x.F("Structure assertion failed: incompatible types"),!(null==e||null==t||"object"!=typeof e||x.pz(e)||e instanceof Array)){for(var a in e)c(e[a])||x.F("Structure assertion failed: invalid value for key in the first object: "+a),a in t||x.F("Structure assertion failed: missing key in the first object: "+a);for(a in t)c(t[a])||x.F("Structure assertion failed: invalid value for key in the second object: "+a),a in e||x.F("Structure assertion failed: missing key in the second object: "+a),l(e[a],t[a])||x.F("Structure assertion failed: incompatible types for key "+a)}}function c(e){return"undefined"!=typeof e&&("number"!=typeof e||!isNaN(e))}function l(e,t){if(typeof e!=typeof t)return!1;if(null!=e&&null!=t&&"object"==typeof e){var a=e instanceof Array,r=t instanceof Array;if(a&&!r||!a&&r)return!1;if(a=x.pz(e),r=x.pz(t),a&&!r||!a&&r)return!1}return!0}var f=t("__batch"),u=t("__compat"),d=t("__config"),p=t("__extensions"),m=t("__graph"),g=t("__objects"),h=t("__print"),v=t("__scenes"),b=t("__subscene"),E=t("__textures"),A=t("__time"),x=t("__util"),T=d.H,y={},S=null,O={},w=[],R=-1,L=-1,N=null,I=null,M=!1,C={};e.DV_NONE=0,e.DV_OPAQUE_WIREFRAME=1,e.DV_TRANSPARENT_WIREFRAME=2,e.DV_FRONT_BACK_VIEW=3,e.DV_BOUNDINGS=4,e.DV_CLUSTERS_VIEW=5,e.DV_BATCHES_VIEW=6,e.DV_RENDER_TIME=7,e.bg=function(e){for(var t="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),a=0;a<t.length;a++){var r=t[a];r in e&&(y[e[r]]=r)}S=e},e.dT=function(e){N=e},e.yX=function(){return N},e.MO=function(e,t,a,r,n){C[e]||(C[e]={GT:t,Ve:{}}),a in C[e].Ve||(C[e].Ve[a]=r),n&&(C[e].Ve[a]=0)},e.calc_vbo_garbage_byte_size=function(){var e,t=0;for(e in C)for(var a in C[e].Ve)t+=C[e].Ve[a];return t},e.show_vbo_garbage_info=function(){var e,t={};for(e in C)for(var a in C[e].Ve){var r=C[e].Ve[a];if(r){var n=C[e].GT;n in t||(t[n]={hB:0,Ve:{}}),a in t[n].Ve||(t[n].Ve[a]=0),t[n].Ve[a]+=r,t[n].hB+=r}}for(n in t){h.groupCollapsed(n,t[n].hB);for(a in t[n].Ve)h.cd(a,t[n].Ve[a]);h.groupEnd()}},e.print_batches_stat=function(){for(var e={},t="bounds_local bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),r=0,n=0,o=g.Hb(v.jh(),"MESH",g.DATA_ID_ALL),i=0;i<o.length;i++)for(var _=0;_<o[i].K.length;_++)for(var s=0;s<o[i].K[_].U.length;s++){var c=f.IM(o[i].K[_].U[s]),l=c.Ra.uf+"/"+c.Ra.ge;c["shaders_info.directives"]=c.Ra.ah,c["shaders_info.node_elements"]=c.Ra.He,delete c.Ra;for(var u=0;u<t.length;u++)delete c[t[u]];if(o[i].is_dynamic)n++;else{r++,c.type in e||(e[c.type]={}),l in e[c.type]||(e[c.type][l]={});for(var d in c)d in e[c.type][l]||(e[c.type][l][d]={}),u=JSON.stringify(c[d]),u in e[c.type][l][d]||(e[c.type][l][d][u]=0),e[c.type][l][d][u]++}}h.group("Batches statistics:"),h.cd("STATIC/DYNAMIC count:",r+"/"+n),h.group("STATIC batches diversity:");for(var p in e)for(l in e[p])a(e[p][l],p,l);h.groupEnd(),h.groupEnd()},e.by=function(e){if(T.gl_debug){var t=S.getError();t!=S.NO_ERROR&&(t in y?x.F("GL Error: "+t+", gl."+y[t]+" ("+e+")"):x.F("Unknown GL error: "+t+" ("+e+")"))}},e.pM=function(){if(T.gl_debug||T.hD)switch(S.checkFramebufferStatus(S.FRAMEBUFFER)){case S.FRAMEBUFFER_COMPLETE:break;case S.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case S.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case S.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case S.FRAMEBUFFER_UNSUPPORTED:h.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case S.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:h.error("FRAMEBUFFER CHECK FAILED")}},e.tM=function(){if(-1!=R)return R;var e=S.createFramebuffer();S.bindFramebuffer(S.FRAMEBUFFER,e);var t=E.Zj(E.ll,!1);return E.resize(t,1,1),S.framebufferTexture2D(S.FRAMEBUFFER,S.DEPTH_ATTACHMENT,t.lb,t.zb,0),S.checkFramebufferStatus(S.FRAMEBUFFER)!=S.FRAMEBUFFER_COMPLETE?(R=!0,h.warn("depth-only issue was found")):R=!1,S.bindFramebuffer(S.FRAMEBUFFER,null),S.deleteFramebuffer(e),R},e.yM=function(){if(1==T.Rb)return!1;if(-1!=L)return L;S.bindRenderbuffer(S.RENDERBUFFER,S.createRenderbuffer()),S.renderbufferStorageMultisample(S.RENDERBUFFER,T.Rb,S.RGBA8,1,1);var e=S.getRenderbufferParameter(S.RENDERBUFFER,S.RENDERBUFFER_SAMPLES);return e!=T.Rb?(L=!0,h.warn("multisample issue was found: requested "+T.Rb+", got "+e),S.getError()==S.INVALID_OPERATION&&h.warn("the error from multisample issue detected, ignoring")):L=!1,S.bindRenderbuffer(S.RENDERBUFFER,null),L},e.vM=function(){return!(!u.cy("Firefox")||S.getError()!=S.OUT_OF_MEMORY)&&(h.warn("Firefox/old GPUs cubemap issue was found."),!0)},e.GG=function(e,t,a){T.gl_debug&&(a=n(a),h.error("shader compilation failed:\n"+a+"\n"+S.getShaderInfoLog(e)+" ("+t+")"))},e.DS=function(e,t,a,r){T.gl_debug&&(a=n(a),r=n(r),h.error("shader linking failed:\n"+a+"\n\n\n"+r+"\n"+S.getProgramInfoLog(e)+" ("+t+")"))},e.tA=function(e){(T.show_hud_debug_info||e.type==b.sp)&&(e.xq||e.ak.push(o()))},e.yS=function(e){"MAIN"==e.type&&i()&&e.ak.push(o())},e.uA=function(e){if((T.show_hud_debug_info||e.type==b.sp)&&!e.xq){var t=_(e.ak,e.af,!0);t&&(e.af=t)}},e.zS=function(e){if("MAIN"==e.type&&i()){var t=_(e.ak,e.af,!0);t&&(e.af=t)}},e.oF=i,e.kS=function(e){var t=_(e.ak,e.af,!1);t&&(e.af=t)},e.iX=function(e){O[e]=e in O?O[e]+1:1},e.update=function(){for(var e in O)h.log(e,O[e]),O[e]=0},e.fbmsg=function(){for(var e=[performance.now()],t=0;t<arguments.length;t++){var a=arguments[t];if(x.is_vector(a))for(var r=0;r<a.length;r++)e.push(a[r]);else e.push(arguments[t])}w.push(e)},e.msg=function(){for(var e=1,t=0;t<w.length;t++){var a=w[t];a[1]==arguments[0]&&e++}for(a=[e],t=0;t<arguments.length;t++)if(e=arguments[t],x.is_vector(e))for(var r=0;r<e.length;r++)a.push(e[r]);else a.push(arguments[t]);w.push(a)};var D=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];e.print_telemetry=function(e){e||(e=1);for(var t=0,a={},r=Math.max(0,performance.now()-1e3*e),n=0;n<w.length;n++){var o=w[n];if(!((e=o[0])<r)){var i=String(o[1]);for(a[i]||(a[i]=D[t++%D.length]),e=["%c"+(e/1e3).toFixed(6),a[i],i],i=2;i<o.length;i++)e.push(o[i]);h.log.apply(this,e)}}w.splice(0)},e.plot_telemetry=function(e){e||(e=1);for(var t={},a=Math.max(0,performance.now()-1e3*e),r=0;r<w.length;r++){var n=w[r];if(!((e=n[0])<a))for(var o=2;o<n.length;o++){var i=String(n[1]);3<n.length&&(i+="_"+String(o-2)),t[i]||(t[i]=i+"\n"),t[i]+=String(e)+" "+n[o]+"\n"}}e="";for(i in t)e+=t[i]+"\n\n";h.log(e),w.splice(0)},e.SW=function(e){function t(e){return-1<a.indexOf(e)}var a=navigator.userAgent.toLowerCase();switch(e.toLowerCase()){case"chrome":return t("mozilla")&&t("applewebkit")&&t("chrome");case"firefox":return t("mozilla")&&t("gecko")&&t("firefox");case"msie":return t("mozilla")&&t("trident")&&t("msie");case"opera":return t("opera")&&t("presto");case"safari":return t("mozilla")&&t("applewebkit")&&t("safari")&&!t("chrome");default:return!1}},e.check_finite=function(e){if(x.is_vector(e)){for(var t=0;t<e.length;t++)if(!isFinite(e[t]))return!1;return!!e.length}return!!isFinite(e)},e.HW=function(e,t){e.constructor!=t&&x.F("Type assertion failed: value <"+e+"> has type <"+e.constructor+">, required <"+t+">")},e.IW=s,e.JW=function(e){M?s(e,I):M=!0,I=null!=e&&"object"==typeof e?x.aq(e):e},e.fake_load=function(e,t,a,r,n){(e=e||null)||x.F("Stage load callback is undefined"),t=t||5e3,a=a||0,r=r||100,100<r&&x.F("Max percentage must be less than 100"),0>a&&x.F("Min percentage must be greater than 0"),a>r&&x.F("Max percentage must be greater than min percentage");var o=A.animate(a,r,t,function(t){t=t.toFixed(),e(t),100==t&&(A.clear_animation(o),n&&n())})},e.LR=function(e){return m.SD(e,function(e,t){var a=t.type+"("+t.name+")",r=t.inputs,a=a+"\n\nINPUTS:";if(r.length)for(var n=0;n<r.length;n++)a+="\n"+r[n].identifier+": ",a=r[n].Da?a+"linked":a+r[n].Aa;else a+="\n---";if(r=t.outputs,a+="\n\nOUTPUTS:",r.length)for(n=0;n<r.length;n++)a+="\n"+r[n].identifier+": ",a=r[n].Da?a+"linked(default "+r[n].Aa+")":a+"not used";else a+="\n---";switch(n="",t.type){case"GEOMETRY_UV":n="\nuv_layer: "+t.data.value;break;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":n="\ntexture: "+t.data.value.name+"\n("+t.data.value.Un+")"}return""==n&&(n="\n---"),a+"\n\nDATA:"+n},function(t,a,r){return t=m.Qa(e,t),a=m.Qa(e,a),t.outputs[r[0]].identifier+"\n==>\n"+a.inputs[r[1]].identifier})},e.qu=function(){return S},e.cleanup=function(){N=null,C={}},e.reset=function(){S=null}},a.module.__extensions=function(e,t){function a(e){if(e in s)return s[e];var t=_.getExtension(e)||null;return s[e]=t,o.log("%cGET EXTENSION","color: #"+(t?"0a0":"a00"),e),t}function r(e){if(e in s)return s[e];switch(e){case"WEBGL_depth_texture":case"OES_element_index_uint":case"OES_standard_derivatives":case"EXT_shader_texture_lod":var t={};break;case"ANGLE_instanced_arrays":case"OES_vertex_array_object":t=_;break;default:t=_.getExtension(e)||null}return s[e]=t,o.log("%cGET EXTENSION (WebGL 2)","color: #"+(t?"0a0":"a00"),e),t}var n=t("__config"),o=t("__print"),i=n.H,_=null,s={};e.bg=function(e){_=e},e.JE=function(){return a("WEBGL_compressed_texture_s3tc")||a("WEBKIT_WEBGL_compressed_texture_s3tc")},e.IE=function(){return a("WEBKIT_WEBGL_compressed_texture_pvrtc")||a("WEBGL_compressed_texture_pvrtc")},e.DP=function(){return i.Ab?r("WEBGL_depth_texture"):a("WEBGL_depth_texture")||a("WEBKIT_WEBGL_depth_texture")},e.Ny=function(){return a("EXT_texture_filter_anisotropic")||a("WEBKIT_EXT_texture_filter_anisotropic")},e.LE=function(){return i.Ab?r("EXT_shader_texture_lod"):a("EXT_shader_texture_lod")},e.BP=function(){return a("WEBGL_debug_shaders")},e.get_renderer_info=function(){return a("WEBGL_debug_renderer_info")},e.EE=function(){return i.Ab?r("OES_element_index_uint"):a("OES_element_index_uint")},e.Vy=function(){return i.Ab?r("OES_standard_derivatives"):a("OES_standard_derivatives")},e.Ry=function(){var e=i.Ab?r("EXT_disjoint_timer_query_webgl2"):a("EXT_disjoint_timer_query");return null==e?e:e.createQueryEXT?{createQuery:function(){return e.createQueryEXT()},beginQuery:function(t){e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)},endQuery:function(){e.endQueryEXT(e.TIME_ELAPSED_EXT)},yE:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT)},zE:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)},xE:function(){return e.GPU_DISJOINT_EXT}}:{createQuery:function(){return _.createQuery()},beginQuery:function(t){_.beginQuery(e.TIME_ELAPSED_EXT,t)},endQuery:function(){_.endQuery(e.TIME_ELAPSED_EXT)},yE:function(e){return _.getQueryParameter(e,_.QUERY_RESULT_AVAILABLE)},zE:function(e){return _.getQueryParameter(e,_.QUERY_RESULT)},xE:function(){return e.GPU_DISJOINT_EXT}}},e.SP=function(){if(i.Ab)return r("ANGLE_instanced_arrays");var e=a("ANGLE_instanced_arrays");return null==e?e:{drawElementsInstanced:function(t,a,r,n,o){e.drawElementsInstancedANGLE(t,a,r,n,o)},vertexAttribDivisor:function(t,a){e.vertexAttribDivisorANGLE(t,a)},drawArraysInstanced:function(t,a,r,n){e.drawArraysInstancedANGLE(t,a,r,n)}}},e.Yy=function(){if(i.Ab)return r("OES_vertex_array_object");var e=a("OES_vertex_array_object");return null==e?e:{bindVertexArray:function(t){e.bindVertexArrayOES(t)},createVertexArray:function(){return e.createVertexArrayOES()},deleteVertexArray:function(t){e.deleteVertexArrayOES(t)},isVertexArray:function(t){return e.isVertexArrayOES(t)}}},e.cleanup=function(){s={}},e.reset=function(){_=null}},a.module.__graph=function(e,t){function a(e,t,a){a||(a=null),r(e,t)?L.F("Graph already has node with given ID"):e.V.push(t,a)}function r(e,t){for(var a=e.V,r=0;r<a.length;r+=2)if(a[r]==t)return!0;return!1}function n(e,t,a,n){n||(n=null),r(e,t)&&r(e,a)?e.xa.push(t,a,n):L.F("Wrong node IDs")}function o(e,t){r(e,t)||L.F("Node not found");for(var a=e.V,n=0;n<a.length;n+=2)a[n]==t&&(a.splice(n,2),n-=2)}function i(e,t,a,r){S(e,t,a)||L.F("Edge not found"),e=e.xa;for(var n=0,o=0;o<e.length;o+=3)if(e[o]==t&&e[o+1]==a){if(-1==r)e.splice(o,3);else{if(r==n){e.splice(o,3);break}n++}o-=3}}function _(e){e=e.V;for(var t=-1,a=0;a<e.length;a+=2)t=Math.max(t,e[a]);return++t}function s(e,t){for(var a=e.V,r=0;r<a.length;r+=2)if(a[r+1]==t)return a[r];return-1}function c(e){var t=[],a={};l(e,a);for(var r=e.V,n=0;n<r.length;n+=2)0==x(e,r[n])&&f(e,r[n],a,t);return{V:t,xa:e.xa.slice(0)}}function l(e,t){for(var a=e.V,r=0;r<a.length;r+=2)t[a[r]]=!1}function f(e,t,a,r){if(!a[t]){a[t]=!0;for(var n=0;n<A(e,t);n++)f(e,T(e,t,n),a,r);r.unshift(t,E(e,t))}}function u(e,t,a,r){if(!a[t]){if(a[t]=!0,10==r||30==r)for(var n=0;n<A(e,t);n++){var o=T(e,t,n);u(e,o,a,r)}if(20==r||30==r)for(n=0;n<x(e,t);n++)o=y(e,t,n),u(e,o,a,r)}}function d(e){for(var t=e.xa,a=0;a<t.length;a+=3){var n=t[a+1];r(e,t[a])&&r(e,n)||(t.splice(a,3),a-=3)}}function p(e){for(var t=[],a=e.V,r=0;r<a.length;r+=2){var n=a[r];A(e,n)||t.push(n)}return t}function m(e){var t=e.V;e=e.xa;for(var a=[],r=[],n=[],o=0;o<t.length;o++)n[t[2*o]]=o,a.push(o,t[2*o+1]);for(o=0;o<e.length;o+=3)r.push(n[e[o]],n[e[o+1]],e[o+2]);return{V:a,xa:r}}function g(e,t,a){if(a.Rh==a.wk){for(var r=0,n=0;r<a.wk;r++)-1!=a.Qi[r]&&(e[n]=r,t[n]=a.Qi[r],n++);return!0}if(a.wk>a.ho||a.Tk>a.Uk||a.Uo>a.Wo||a.To>a.Vo)return!1;for(var n=r=-1,o=!1;!o&&h(a,N,r,n);)if(r=N[0],n=N[1],v(a,r,n)){var i;i=a,o={},o.Jq=i.Jq,o.Kq=i.Kq,o.Wz=i.Wz,o.Tt=i.Tt,o.wk=i.wk,o.ho=i.ho,o.order=i.order,o.Rh=o.Av=i.Rh,o.To=i.To,o.Uo=i.Uo,o.Tk=i.Tk,o.Vo=i.Vo,o.Wo=i.Wo,o.Uk=i.Uk,o.zp=-1,o.Qi=i.Qi,o.Fl=i.Fl,o.Zl=i.Zl,o.$l=i.$l,o.qm=i.qm,o.rm=i.rm,o.dw=i.dw,i.dw[0]+=1;var o=i=o,_=r,s=n,c=o.Jq,l=o.Kq,f=o.wk,u=o.ho,d=o.Qi,p=o.Fl,m=o.Zl,E=o.$l,S=o.qm,O=o.rm;for(b(_<f),b(s<u),b(o.Rh<f),b(o.Rh<u),f=++o.Rh,o.zp=_,m[_]||(m[_]=f,o.To++,S[_]&&o.Tk++),S[_]||(S[_]=f,o.Uo++,m[_]&&o.Tk++),E[s]||(E[s]=f,o.Vo++,O[s]&&o.Uk++),O[s]||(O[s]=f,o.Wo++,E[s]&&o.Uk++),d[_]=s,p[s]=_,d=0;d<x(c,_);d++)p=y(c,_,d),m[p]||(m[p]=f,o.To++,S[p]&&o.Tk++);for(d=0;d<A(c,_);d++)p=T(c,_,d),S[p]||(S[p]=f,o.Uo++,m[p]&&o.Tk++);for(d=0;d<x(l,s);d++)p=y(l,s,d),E[p]||(E[p]=f,o.Vo++,O[p]&&o.Uk++);for(d=0;d<A(l,s);d++)p=T(l,s,d),O[p]||(O[p]=f,o.Wo++,E[p]&&o.Uk++);if(o=g(e,t,i),b(1>=i.Rh-i.Av),b(-1!=i.zp),p=i.Jq,_=i.Kq,s=i.Rh,c=i.zp,l=i.Qi,m=i.Fl,f=i.Zl,E=i.$l,u=i.qm,S=i.rm,i.Av<s){for(f[c]==s&&(f[c]=0),O=0;O<x(p,c);O++)d=y(p,c,O),f[d]==s&&(f[d]=0);for(u[c]==s&&(u[c]=0),O=0;O<A(p,c);O++)d=T(p,c,O),u[d]==s&&(u[d]=0);for(p=l[c],E[p]==s&&(E[p]=0),O=0;O<x(_,p);O++)d=y(_,p,O),E[d]==s&&(E[d]=0);for(S[p]==s&&(S[p]=0),O=0;O<A(_,p);O++)d=T(_,p,O),S[d]==s&&(S[d]=0);l[c]=-1,m[p]=-1,i.Rh=i.Av,i.zp=-1}}return o}function h(e,t,a,r){-1==a&&(a=0),-1==r?r=0:r++;var n=e.Tk,o=e.Uk,i=e.Uo,_=e.Wo,s=e.To,c=e.Vo,l=e.Rh,f=e.wk,u=e.ho,d=e.Qi,p=e.Fl,m=e.Zl,g=e.$l,h=e.qm,v=e.rm;if(n>l&&o>l)for(;a<f&&(-1!=d[a]||0==h[a]||0==m[a]);)a++,r=0;else if(i>l&&_>l)for(;a<f&&(-1!=d[a]||0==h[a]);)a++,r=0;else if(s>l&&c>l)for(;a<f&&(-1!=d[a]||0==m[a]);)a++,r=0;else if(0==a&&0!=e.order){for(m=0;m<f&&-1!=d[a=e.order[m]];)m++;m==f&&(a=f)}else for(;a<f&&-1!=d[a];)a++,r=0;if(n>l&&o>l)for(;r<u&&(-1!=p[r]||0==v[r]||0==g[r]);)r++;else if(i>l&&_>l)for(;r<u&&(-1!=p[r]||0==v[r]);)r++;else if(s>l&&c>l)for(;r<u&&(-1!=p[r]||0==g[r]);)r++;else for(;r<u&&-1!=p[r];)r++;return a<f&&r<u&&(t[0]=a,t[1]=r,!0)}function v(e,t,a){var r=e.Jq,n=e.Kq,o=e.ho,i=e.Qi,_=e.Fl,s=e.Zl,c=e.$l,l=e.qm,f=e.rm;if(b(t<e.wk),b(a<o),b(-1==i[t]),b(-1==_[a]),!(0,e.Wz)(E(r,t),E(n,a)))return!1;for(var u=o=0,d=0,p=0,m=0,g=0,h=0;h<A(r,t);h++){var v=T(r,t,h);if(-1!=i[v]){var w=i[v];if(!S(n,a,w)||!O(e.Tt,r,t,v,n,a,w))return!1}else s[v]&&d++,l[v]&&o++,s[v]||l[v]||m++}for(h=0;h<x(r,t);h++)if(v=y(r,t,h),-1!=i[v]){if(w=i[v],!S(n,w,a)||!O(e.Tt,r,v,t,n,w,a))return!1}else s[v]&&d++,l[v]&&o++,s[v]||l[v]||m++;for(h=0;h<A(n,a);h++)if(w=T(n,a,h),-1!=_[w]){if(v=_[w],!S(r,t,v))return!1}else c[w]&&p++,f[w]&&u++,c[w]||f[w]||g++;for(h=0;h<x(n,a);h++)if(w=y(n,a,h),-1!=_[w]){if(v=_[w],!S(r,v,t))return!1}else c[w]&&p++,f[w]&&u++,c[w]||f[w]||g++;return d<=p&&o<=u&&m<=g}function b(e){e||L.F("Assertion failed")}function E(e,t){for(var a=e.V,r=0;r<a.length;r+=2)if(a[r]==t)return a[r+1];return null}function A(e,t){for(var a=e.xa,r=0,n=0;n<a.length;n+=3)a[n]==t&&r++;return r}function x(e,t){for(var a=e.xa,r=0,n=0;n<a.length;n+=3)a[n+1]==t&&r++;return r}function T(e,t,a){e=e.xa;for(var r=0,n=0;n<e.length;n+=3)if(e[n]==t){if(r==a)return e[n+1];r++}return-1}function y(e,t,a){e=e.xa;for(var r=0,n=0;n<e.length;n+=3)if(e[n+1]==t){if(r==a)return e[n];r++}return-1}function S(e,t,a){e=e.xa;for(var r=0;r<e.length;r+=3)if(e[r]==t&&e[r+1]==a)return!0;return!1}function O(e,t,a,r,n,o,i){for(var _=w(t,a,r),s=w(n,o,i),c=0;c<_;c++){for(var l=!1,f=0;f<s;f++)if(e(R(t,a,r,c),R(n,o,i,f))){l=!0;break}if(!l)return!1}return!0}function w(e,t,a){var r=0;e=e.xa;for(var n=0;n<e.length;n+=3)e[n]==t&&e[n+1]==a&&r++;return r}function R(e,t,a,r){e=e.xa;for(var n=0,o=0;o<e.length;o+=3)if(e[o]==t&&e[o+1]==a){if(n==r)return e[o+2];n++}return null}var L=t("__util"),N=[-1,-1];e.wx=-1,e.SV=10,e.Pj=20,e.aW=30,e.create=function(){for(var e=arguments,t=[],a=[],r=0;r<e.length;r++){var n=e[r];switch(n.length){case 2:t.push(n[0],n[1]);break;case 3:a.push(n[0],n[1],n[2]);break;default:L.F("Wrong graph constructor params")}}return{V:t,xa:a}},e.clone=function(e,t,a){if(t)for(var r=Array(e.V.length),n=0;n<e.V.length;n+=2)r[n]=e.V[n],r[n+1]=t(e.V[n+1]);else r=L.P(e.V);if(a)for(t=Array(e.xa.length),n=0;n<e.xa.length;n+=3)t[n]=e.xa[n],t[n+1]=e.xa[n+1],t[n+2]=a(e.xa[n+2]);else t=L.P(e.xa);return e={V:r,xa:t}},e.aX=function(e,t){for(var a=[],r=[],n=0;n<e.length;n++)a.push(e[n][0],e[n][1]);for(n=0;n<t.length;n++)r.push(t[n][0],t[n][1],t[n][2]);return{V:a,xa:r}},e.Yg=a,e.LX=r,e.vc=n,e.nf=o,e.Jk=i,e.yh=function(e,t,a,r){S(e,t,a)||L.F("Edge not found"),e=e.xa;for(var n=0;n<e.length;n+=3)if(e[n]==t&&e[n+1]==a&&e[n+2][0]==r[0]&&e[n+2][1]==r[1]){e.splice(n,3);break}},e.T=function(e,t){if(-1==s(e,t)){var r=_(e);return a(e,r,t),r}L.F("Non-unique attribute")},e.BS=function(e,t,a,r,n){e=e.xa;for(var o=0;o<e.length;o+=3)e[o]==t&&e[o+1]==a&&e[o+2]==r&&(e[o+2]=n)},e.AC=function(e,t,r,o){r=r||[],o=o||[];for(var i={},s=0;s<e.V.length;s+=2){var c=e.V[s],l=_(t);a(t,l,e.V[s+1]),i[c]=l}for(s=0;s<e.xa.length;s+=3){var l=i[e.xa[s]],f=i[e.xa[s+1]],c=e.xa[s+2];n(t,l,f,c)}for(s=0;s<r.length;s+=3)l=i[r[s]],e=r[s+1],c=r[s+2],n(t,l,e,c);for(s=0;s<o.length;s+=3)r=o[s],f=i[o[s+1]],c=o[s+2],n(t,r,f,c)},e.Zi=_,e.oj=s,e.D=function(e,t,a,r){t=s(e,t),a=s(e,a),-1!=t&&-1!=a?n(e,t,a,r):L.F("Attributes not found")},e.X=function(e,t){for(var a=e.V,r=0;r<a.length&&!t(a[r],a[r+1]);r+=2);},e.Pg=function(e,t){for(var a=e.xa,r=0;r<a.length&&!t(a[r],a[r+1],a[r+2]);r+=3);},e.Ij=function(e,t,a){for(var r=e.xa,n=0;n<r.length;n+=3)if(r[n+1]==t){var o=r[n];if(a(o,E(e,o),r[n+2]))break}},e.Wk=function(e,t,a){for(var r=e.xa,n=0;n<r.length;n+=3)if(r[n]==t){var o=r[n+1];if(a(o,E(e,o),r[n+2]))break}},e.fB=c,e.kU=function(e){e=c(e).V;for(var t=[],a=0;a<e.length;a+=2)t.push(e[a+1]);return t},e.ZX=function(){},e.Rk=function(e,t,a){r(e,t)||L.F("No such node");var n={};l(e,n),u(e,t,n,a),t=[];for(var o in n)n[o]&&(o=Number(o),t.push(o,E(e,o)));return e={V:t,xa:e.xa.slice(0)},d(e),e},e.dy=d,e.ZP=function(e){for(var t=[],a=e.V,r=0;r<a.length;r+=2){var n=a[r];x(e,n)||t.push(n)}return t},e.Nq=p,e.match=function(e,t,a,r){var n={};n.Jq=m(e),n.Kq=m(t),n.Wz=a||function(e,t){return e==t},n.Tt=r||function(e,t){return e==t},r=e.V.length/2;var o=t.V.length/2;for(n.wk=r,n.ho=o,n.order=0,n.Rh=n.Av=0,n.Tk=n.To=n.Uo=0,n.Uk=n.Vo=n.Wo=0,n.zp=-1,n.Qi=Array(r),n.Fl=Array(o),n.Zl=Array(r),n.$l=Array(o),n.qm=Array(r),n.rm=Array(o),n.dw=[1],a=0;a<r;a++)n.Qi[a]=-1,n.Zl[a]=0,n.qm[a]=0;for(a=0;a<o;a++)n.Fl[a]=-1,n.$l[a]=0,n.rm[a]=0;if(o=Array(r),r=Array(r),g(o,r,n)){for(a=0;a<o.length;a++)o[a]=e.V[2*o[a]],r[a]=t.V[2*r[a]];return[o,r]}return null},e.VP=function(e,t){for(var a=e.V,r=1;r<a.length;r+=2)if(a[r]==t)return a[r-1];return null},e.Qa=E,e.Zf=A,e.ci=x,e.yg=T,e.Rf=y,e.zX=w,e.Ec=R,e.replace=function(e,t,r){for(var n=e.xa,i=_(e),s=0;s<t.length;s++){var c=t[s];o(e,c);for(var l=0;l<n.length;l+=3)n[l]==c&&(n[l]=i),n[l+1]==c&&(n[l+1]=i),n[l]==n[l+1]&&(n.splice(l,3),l-=3)}a(e,i,r)},e.qS=function(e,t,a,r,n){S(e,t,a)||L.F("Edge not found"),e=e.xa;for(var o=0;o<e.length;o+=3)e[o]==t&&e[o+1]==a&&(e[o]=r,e[o+1]=n)},e.AO=function(e,t){function a(e,t){if(-1!=s.indexOf(e)){var r=s.slice(s.indexOf(e));if(-1!=n[r[r.length-1]].indexOf(r[0]))return void c.push([e,r[r.length-1]])}for(s.push(e),r=0;r<t.length;r++)t[r]in n&&a(t[r],n[t[r]])}t||(t=p(e)[0]);var r=e.xa;if(r.length&&-1!=r.indexOf(t)){for(var n={},o=0,_=0;_<r.length;_+=3)r[_+1]in n?n[r[_+1]].push(r[_]):n[r[_+1]]=[r[_]],o++;var s=[],c=[];for(a(t,n[t]),_=0;_<c.length;_++)for(var l=o=0;l<r.length;l+=3)c[_][1]==r[l+1]&&c[_][0]==r[l]&&i(e,r[l],r[l+1],o),o++}},e.SD=function(e,t,a){var r=e.V;e=e.xa;var n;n="digraph debug {\n    node [shape=box];\n";for(var o=0;o<r.length;o+=2){var i=r[o],_=r[o+1],_=t?t(i,_):String(i);n+="    ",n+=String(i)+' [label="'+_.replace(/\"/g,'\\"')+'"];\n'}for(o=0;o<e.length;o+=3)t=e[o],r=e[o+1],_=e[o+2],n+="    ",n+=String(t)+" -> "+String(r),a&&(n+=' [label="'+a(t,r,_)+'"]'),n+=";\n";return n+"}"}},a.module.__ipc=function(e,t){function r(e,t,a){for(var r=0;r<p.length;r+=2)p[r+1]==e&&(d[r+Number(!t)]=a)}function n(e){for(var t=0;t<e.length;t++){var a,r=e[t],n=0;for(a in r){var o=r[a];switch(o.constructor){case Float32Array:n+=o.length;break;case Number:n+=1}}--n,r.len=n}}var o=!0;e.hJ=0,e.NB=1,e.OB=2,e.bJ=3,e.dJ=4,e.eJ=5,e.fJ=6,e.iJ=7,e.PB=8,e.ux=9,e.QB=10,e.kJ=11,e.RB=12,e.lJ=13,e.jJ=14,e.gJ=15,e.cJ=16;var i=e.NB,_=e.OB,s=e.PB,c=e.ux,l=e.QB,f=e.RB;e.xK=100,e.ZJ=101,e.$J=102,e.aK=103,e.bK=104,e.dK=105,e.cK=106,e.eK=107,e.fK=108,e.gK=109,e.hK=110,e.iK=111,e.jK=112,e.lK=113,e.mK=114,e.AK=115,e.nK=116,e.oK=117,e.pK=118,e.rK=119,e.sK=120,e.tK=121,e.vK=122,e.wK=123,e.yK=124,e.kK=125,e.CK=126,e.qK=127,e.bC=128,e.BK=129,e.DK=130,e.FK=131,e.GK=132,e.HK=133,e.IK=134,e.JK=135,e.KK=136,e.LK=137,e.MK=138,e.NK=139,e.cC=140,e.rp=141,e.OK=142,e.aC=143,e.PK=144,e.QK=145,e.zK=146,e.uK=147,e.RK=148,e.EK=149;var u=e.rp,d=a.worker_listeners,p=a.worker_namespaces,m={Xf:f,aa:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),fi:new Float32Array(3),Jh:new Float32Array(3),len:0},g={Xf:s,ay:0,nA:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},h={Xf:c,id:0,mn:0,hit_fract:0,hit_time:0,len:0},v={Xf:l,id:0,mn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},b={Xf:i,xl:0,yl:0,result:0,len:0},E={Xf:_,xl:0,yl:0,result:0,Bl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},A={Xf:u,aa:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},x=[m,g,h,v,b,E,A];e.ZN=function(e,n){var i={Uu:!!e,Nj:null,Ph:[],ug:""};if(n){var _=t("__util"),s=t("__container");if(i.Nj={addEventListener:function(e,t){"message"!=e&&_.F("Wrong web worker event"),r(i.ug,i.Uu,t)},removeEventListener:function(e){"message"!=e&&_.F("Wrong web worker event"),r(i.ug,i.Uu,null)},postMessage:function(e){var t;e:{for(t=0;t<p.length;t+=2)if(p[t+1]==i.ug){t=d[t+Number(!!i.Uu)];break e}t=null}t({data:e})},terminate:function(){for(var e=0;e<p.length;e+=2)if(p[e+1]==i.ug){d.splice(e,2),p.splice(e,2);break}}},i.Uu){var c=a.get_namespace(t),l=_.cs(c+"_worker");p.push(c),p.push(l),d.push(null),d.push(null),i.ug=l,(s=s.QO(e))?o?s.addEventListener("load",function(){a.require("__bindings",i.ug)},!1):(a.cleanup("__bindings",i.ug),a.cleanup("__ipc",i.ug),a.require("__bindings",i.ug)):(s=document.createElement("script"),s.src=e,s.defer="defer",s.async="async",s.addEventListener("load",function(){o=!1,a.require("__bindings",i.ug)},!1),document.head.appendChild(s))}else i.ug=a.get_namespace(t)}else i.Nj=e?new Worker(e):self;return i},e.HL=function(e,t){function a(r){if(r.constructor==ArrayBuffer)r=new Float32Array(r);else if(r[0].constructor==ArrayBuffer){for(var n=0;n<r.length;n++)a(r[n]);return}switch(n=0|r[0]){case f:var o=m;o.aa=0|r[1],o.time=r[2],o.trans[0]=r[3],o.trans[1]=r[4],o.trans[2]=r[5],o.quat[0]=r[6],o.quat[1]=r[7],o.quat[2]=r[8],o.quat[3]=r[9],o.fi[0]=r[10],o.fi[1]=r[11],o.fi[2]=r[12],o.Jh[0]=r[13],o.Jh[1]=r[14],o.Jh[2]=r[15];break;case s:o=g,o.ay=0|r[1],o.nA=0|r[2],o.trans[0]=r[3],o.trans[1]=r[4],o.trans[2]=r[5],o.quat[0]=r[6],o.quat[1]=r[7],o.quat[2]=r[8],o.quat[3]=r[9];break;case c:o=h,o.id=0|r[1],o.mn=0|r[2],o.hit_fract=r[3],o.hit_time=r[4];break;case l:o=v,o.id=0|r[1],o.mn=0|r[2],o.hit_fract=r[3],o.hit_time=r[4],o.hit_pos[0]=r[5],o.hit_pos[1]=r[6],o.hit_pos[2]=r[7],o.hit_norm[0]=r[8],o.hit_norm[1]=r[9],o.hit_norm[2]=r[10];break;case i:o=b,o.xl=0|r[1],o.yl=0|r[2],o.result=!!r[3];break;case _:o=E,o.xl=0|r[1],o.yl=0|r[2],o.result=!!r[3],o.Bl[0]=r[4],o.Bl[1]=r[5],o.Bl[2]=r[6],o.coll_norm[0]=r[7],o.coll_norm[1]=r[8],o.coll_norm[2]=r[9],o.coll_dist=r[10];break;case u:o=A,o.aa=0|r[1],o.trans[0]=r[2],o.trans[1]=r[3],o.trans[2]=r[4],o.quat[0]=r[5],o.quat[1]=r[6],o.quat[2]=r[7],o.quat[3]=r[8];break;default:o=r}t(e,n,o)}n(x),e.Nj.addEventListener("message",function(e){a(e.data)},!1)},e.cleanup=function(){},e.ja=function(e,t){if(e)switch(t){case f:var a=m,r=new Float32Array(a.len);r[0]=a.Xf,r[1]=a.aa,r[2]=a.time,r[3]=a.trans[0],r[4]=a.trans[1],r[5]=a.trans[2],r[6]=a.quat[0],r[7]=a.quat[1],r[8]=a.quat[2],r[9]=a.quat[3],r[10]=a.fi[0],r[11]=a.fi[1],r[12]=a.fi[2],r[13]=a.Jh[0],r[14]=a.Jh[1],r[15]=a.Jh[2],e.Ph.push(r.buffer);break;case s:a=g,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.ay,r[2]=a.nA,r[3]=a.trans[0],r[4]=a.trans[1],r[5]=a.trans[2],r[6]=a.quat[0],r[7]=a.quat[1],r[8]=a.quat[2],r[9]=a.quat[3],e.Ph.push(r.buffer);break;case c:a=h,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.id,r[2]=a.mn,r[3]=a.hit_fract,r[4]=a.hit_time,e.Ph.push(r.buffer);break;case l:a=v,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.id,r[2]=a.mn,r[3]=a.hit_fract,r[4]=a.hit_time,r[5]=a.hit_pos[0],r[6]=a.hit_pos[1],r[7]=a.hit_pos[2],r[8]=a.hit_norm[0],r[9]=a.hit_norm[1],r[10]=a.hit_norm[2],e.Ph.push(r.buffer);break;case i:a=b,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.xl,r[2]=a.yl,r[3]=a.result,e.Ph.push(r.buffer);break;case _:a=E,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.xl,r[2]=a.yl,r[3]=a.result,r[4]=a.Bl[0],r[5]=a.Bl[1],r[6]=a.Bl[2],r[7]=a.coll_norm[0],r[8]=a.coll_norm[1],r[9]=a.coll_norm[2],r[10]=a.coll_dist,e.Ph.push(r.buffer);break;case u:a=A,r=new Float32Array(a.len),r[0]=a.Xf,r[1]=a.aa,r[2]=a.trans[0],r[3]=a.trans[1],r[4]=a.trans[2],r[5]=a.quat[0],r[6]=a.quat[1],r[7]=a.quat[2],r[8]=a.quat[3],e.Ph.push(r.buffer);break;default:for(r=[],a=1;a<arguments.length;a++)r.push(arguments[a]);e.Nj.postMessage(r)}},e.gS=function(e){e&&e.Ph.length&&(e.Nj.postMessage(e.Ph),e.Ph.length=0)},e.HE=function(e){switch(e){case f:return m;case s:return g;case c:return h;case l:return v;case i:return b;case _:return E;case u:return A;default:return null}},e.terminate=function(e){e.Nj.terminate(),e.Nj=null},e.Ru=function(e){return!!e.Nj},e.pF=function(e){return!!e.ug}},a.module.__hud=function(e,t){function a(e){e.font="bold 15px Courier New",e.textBaseline="middle",e.shadowBlur=0,e.shadowColor=null}function r(e){if(n(' SCENE "'+e.name+'"'),n(" Active                 Subscene   Lamps   Size   RenderCalls   Time"),e.G){var t=0,a=0,r=0;return s.X(e.G.va,function(e,o){if(o.type!=c.zi){for(var i=Math.round(o.B.width)+"x"+Math.round(o.B.height),_=0,s=0;s<o.Pa.length;s++)_+=o.Pa[s].Ca.length;s=o.un,o.type!=c.kd&&o.type!=c.Qe||(_*=6);var l=o.Vb&&!o.Ql,f=l?o.af:0;o.enqueue||(o.af=0);n(l?" ()":" ()",c.ww(o),o.oo,i,s,"of",_,"  ",f.toFixed(3)),o.un=0,t+=_,l&&(a+=s,r+=f)}}),[t,a,r]}n("No INFO")}function n(){for(var e=80+20*u[0],t=arguments[0],a=1;a<arguments.length;a++){for(var r="",n=0;n<l[a]-String(arguments[a]).length;n++)r+=" ";t+=r+arguments[a]}u[0]++,f.fillText(t,30,e)}function o(e,t,a){t=e.oc*t,a.x=e.x+t,a.y=e.y,a.oc=e.oc-2*t,a.Jb=e.Jb}function i(e){return e.x+e.oc/2}function _(e){var t=f,a={x:0,y:0,oc:0,Jb:0},r=t.canvas.width,t=t.canvas.height;return a.x=0,a.y=0,a.oc=r,a.Jb=t,o(a,.01,a),r=.02*a.Jb,a.x=a.x,a.y+=r,a.oc=a.oc,a.Jb=a.Jb-2*r,r=a.oc/8,a.x+=r*e,a.y=a.y,a.oc=r,a.Jb=a.Jb,o(a,.02,a),a}var s=t("__graph"),c=t("__subscene"),l=[5,30,4,10,5,3,5],f=null,u=[0,0];e.init=function(e){return e=e.getContext("2d"),a(e),f=e},e.Hm=function(){f&&a(f)},e.reset=function(){var e=f;e&&(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,e.canvas.width,e.canvas.height),u[0]=0,u[1]=0)},e.JT=function(e,t){var a=f;if(a){a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",n(" FPS",(1/t).toFixed(2)),u[0]++;for(var o=a=0,i=0,_=0;_<e.length;_++){var s=r(e[_]),a=a+s[0],o=o+s[1],i=i+s[2];u[0]++}n(" ----------------------------------------------------------------"),n("    ","TOTAL ACTIVE","","",o,"of",a,"  ",i.toFixed(3))}},e.print=function(){var e=f;e&&(e.textAlign="left",e.fillStyle="rgba(0,255,0,255)",n.apply(Math,arguments))},e.plot_array=function(e,t,a,r,n,o,s){var c=f;if(c){t=_(t);var l=t.Jb/5;if(t.x=t.x,t.y+=4*l,t.oc=t.oc,t.Jb=l,c.textAlign="center",c.fillStyle="#00FF00",f.fillText(e,i(t),t.y-10),c.strokeStyle="#00FF00",c.lineWidth=.5,c.beginPath(),c.moveTo(t.x,t.y),c.lineTo(t.x+t.oc,t.y),c.lineTo(t.x+t.oc,t.y+t.Jb),c.lineTo(t.x,t.y+t.Jb),c.closePath(),c.stroke(),!o&&!s)for(o=1e6,s=-1e6,e=0;e<a.length;e++)o=Math.min(o,a[e]),s=Math.max(s,a[e]);for(c.textAlign="right",f.fillText(String(o),t.x-10,t.y+t.Jb),f.fillText(String(s),t.x-10,t.y),c.textAlign="center",f.fillText(String(r),t.x,t.y+t.Jb+15),f.fillText(String(n),t.x+t.oc,t.y+t.Jb+15),c.strokeStyle="#FF0000",c.lineWidth=1.5,c.beginPath(),r=t.oc/(a.length-1),s=t.Jb/(s-o),e=0;e<a.length;e++)n=t.x+r*e,l=t.y+t.Jb-(a[e]-o)*s,e?c.lineTo(n,l):c.moveTo(n,l);c.stroke()}},e.draw_mixer_strip=function(e,t,a,r,n,o,s){var c=f;if(c)for(c.textAlign="center",c.fillStyle="#00FF00",c.font="bold 12px Courier",a=_(a),f.fillText(t?"["+e+"]":e,i(a),a.y),0<=o&&f.fillText(o?"[M]":"[ ]",i(a)-15,a.y+30),0<=s&&f.fillText(s?"[S]":"[ ]",i(a)+15,a.y+30),e={x:0,y:0,oc:0,Jb:0},t=0;t<r.length;t++){o=r[t];var l="VOLUME"==o[0];if(l){s=a.y+350;var u=a.oc,d=e;d.x=a.x,d.y=s,d.oc=u,d.Jb=250}else{s=a.y+50+50*t;var u=a.oc,d=a.Jb,p=e;p.x=a.x,p.y=s,p.oc=u,p.Jb=d}s=c;var u=e,p=t==n,m=o[0],d=o[1],g=o[2],h=o[3],v=(h-g)/o[4],v=1>v?Math.floor(1/v-1e-5).toFixed(0).length:0;if(o=o[5]?Math.log(d/g)/Math.log(h/g):(d-g)/(h-g),s.textAlign="center",p?s.fillText("["+m+"]",i(u),u.y):s.fillText(m,i(u),u.y),s.strokeStyle="#00FF00",s.lineWidth=l?3:1,l?(s.textAlign="right",s.fillText(h.toFixed(v),i(u)-10,u.y+15),s.textAlign="right",s.fillText(g.toFixed(v),i(u)-10,u.y+u.Jb-15)):(s.textAlign="right",s.fillText(g.toFixed(v),u.x+28,u.y+15),s.textAlign="left",s.fillText(h.toFixed(v),u.x+u.oc-28,u.y+15)),s.beginPath(),l){var b=u.y+15+(u.Jb-30)*(1-o);s.moveTo(i(u),u.y+15),s.lineTo(i(u),u.y+u.Jb-15),s.moveTo(i(u)-5,u.y+15),s.lineTo(i(u)+5,u.y+15),s.moveTo(i(u)-5,u.y+u.Jb-15),s.lineTo(i(u)+5,u.y+u.Jb-15),s.moveTo(i(u)-5,b),s.lineTo(i(u)+5,b)}else{var E=u.x+30+(u.oc-60)*o;s.moveTo(u.x+30,u.y+15),s.lineTo(u.x+u.oc-30,u.y+15),s.moveTo(u.x+30,u.y+15-5),s.lineTo(u.x+30,u.y+15+5),s.moveTo(u.x+u.oc-30,u.y+15-5),s.lineTo(u.x+u.oc-30,u.y+15+5),s.moveTo(E,u.y+15-5),s.lineTo(E,u.y+15+5)}s.stroke(),"EQ_Q"==m?(o=Math.log(1+1/(2*d*d)+Math.sqrt((2+1/(d*d))*(2+1/(d*d))/4-1))/Math.log(2),l?(s.textAlign="left",s.fillText(d.toFixed(v),i(u)+10,b),s.textAlign="left",s.fillText("("+o.toFixed(v+1)+")",i(u)+10,b+10)):(s.textAlign="right",s.fillText(d.toFixed(v),E,u.y+30),s.textAlign="left",s.fillText("("+o.toFixed(v+1)+")",E,u.y+30))):l?(s.textAlign="left",s.fillText(d.toFixed(v),i(u)+10,b)):(s.textAlign="center",s.fillText(d.toFixed(v),E,u.y+30))}}},a.module.__renderer=function(e,t){function a(e){for(var t=e.B,a=e.Pa,r=null,o=g.Cb(t.v,I),s=0;s<a.length;s++){var c=a[s];if(c.Vb){var f=c.ib,d=c.Ca;if(f.ni!=r){S.useProgram(f.ni);for(var r=e,v=t,E=f,A=E.WH,x=A.length;x--;){var T=A[x];T.Mn(S,T.ke,r,v)}if(E.ko&&!E.yv)for(E.iA.length||i(E),E=E.iA,A=E.length;A--;)T=E[A],T.Mn(S,T.ke,r,v);r=f.ni}for(c.Te?(S.enable(S.SAMPLE_ALPHA_TO_COVERAGE),e.kb||S.enable(S.BLEND)):(S.disable(S.SAMPLE_ALPHA_TO_COVERAGE),e.kb||S.disable(S.BLEND)),c=0;c<d.length;c++)if(A=d[c],A.Vb){if(E=A.Yf,v=A.ra,l.yS(v),l.oF()&&"DEBUG_VIEW"==v.type&&(v.rq=h.smooth(_.KL(v.tn),v.rq,1,15)),D.alpha_sort&&v.Pe){var T=E,A=A.Ou,x=o,O=v.ga;(b.dist(x,A.SI)>D.alpha_sort_threshold*Math.min(A.NL,1)||T.Gq)&&(u.BU(O,A,T.v,x),b.copy(x,A.SI),T.Gq=!1)}for(var T=e,A=v,x=f,w=x.XH,R=w.length;R--;)O=w[R],O.Mn(S,O.ke,E,A);if(x.ko&&!x.yv){for(x.nr.length||i(x),w=x.nr,R=w.length;R--;)O=w[R],O.Mn(S,O.ke,E,A);x.ko=!1}for(S.depthMask(A.Ya),A.gc?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE),O=A.fa,w=S,R=0;R<O.length;R++){var L=O[R];w.activeTexture(w.TEXTURE0+R),w.bindTexture(L.lb,L.zb),L.Qg&&w.generateMipmap(L.lb)}if(T.type==p.ae){for(E=T,x=x.Gm,w=E.B.$b,O=w.zb,w=w.lb,R=E.Si,L=0;6>L;L++){var M=n(L);if(D.ey?(S.bindTexture(S.TEXTURE_CUBE_MAP,O),S.texImage2D(M,0,S.RGBA,1,1,0,S.RGBA,S.UNSIGNED_BYTE,y)):(S.uniformMatrix4fv(x.u_cube_view_matrix,!1,R[L]),S.uniform4fv(x.u_sky_tex_fac,E.Jo),S.uniform3fv(x.u_sky_tex_color,E.Ho),S.uniform1f(x.u_sky_tex_dvar,E.Io),S.uniform3fv(x.u_horizon_color,E.yd),S.uniform3fv(x.u_zenith_color,E.Ld),S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,M,O,0),N(A,0)),E.jo&&5!=L){var M=E,U=L,k=C;D.ey?k.set(y):(S.readPixels(191,191,1,1,S.RGBA,S.UNSIGNED_BYTE,k),255!=k[0]&&255!=k[1]&&255!=k[2]||S.readPixels(191,220,1,1,S.RGBA,S.UNSIGNED_BYTE,k));var P=k[0],G=k[1],k=k[2],P=P/255,G=G/255,k=k/255;4===U?(M.$e[3]=P,M.$e[7]=G,M.$e[11]=k):(M.$e[4*U]=P,M.$e[4*U+1]=G,M.$e[4*U+2]=k)}}D.dB&&(S.bindTexture(w,O),S.generateMipmap(w),S.texParameteri(w,S.TEXTURE_MIN_FILTER,m.wp)),T.un+=6}else N(A,E.Uw),T.un++;l.zS(v),l.oF()&&"MAIN"==v.type&&_.LL(v.id,v.af)}}}}function r(e){if(e){var t=(e.rb?S.COLOR_BUFFER_BIT:0)|(e.ub?S.DEPTH_BUFFER_BIT:0);if(!t)return;switch(e.type){case p.Md:e=T;break;case p.ld:e=E;break;case p.Cf:e=A;break;case p.we:case p.Rg:case p.Xm:e=x;break;case p.Tg:case p.vp:case p.Bs:e=T;break;default:e=D.background_color}}else t=S.COLOR_BUFFER_BIT|S.DEPTH_BUFFER_BIT,e=D.background_color;S.colorMask(!0,!0,!0,!0),S.depthMask(!0),S.clearColor(e[0],e[1],e[2],e[3]),S.clear(t)}function n(e){switch(e){case 0:return S.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return S.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return S.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return S.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return S.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return S.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function o(e){var t=f.Yy(),a=e.Gp,r=e.ga,n=r.xb;e.Ne.length=0;var o,i=1;for(o in n)i=Math.max(i,n[o].frames);for(n=0;n<i;n++){o=t.createVertexArray(),L(o),r.Bg&&S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,r.Bg);for(var _=0;_<r.fd.length;_++){S.bindBuffer(S.ARRAY_BUFFER,r.fd[_].Lj);for(var s=0;s<a.length;s++){var c=a[s];c.Ww==r.fd[_].type&&(S.enableVertexAttribArray(c.ke),S.vertexAttribPointer(c.ke,c.cc,c.Pn,c.Pn!=S.FLOAT,c.Cj,c.Ys+c.gu*n),w(c.ke,c.Ml))}}L(null),e.Ne.push(o)}}function i(e){var t=e.Gm,a=e.XH,r=e.nr,n=e.WH,o=e.iA;a.length=0,r.length=0,n.length=0,o.length=0;for(var i in t){var _=!1,s=null,c=null;switch(i){case"u_proj_matrix":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.pb)},_=!0;break;case"u_view_refl_matrix":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.$w)},_=!0;break;case"u_view_tsr":case"u_view_tsr_frag":s=function(e,t,a,r){r.nc?e.uniformMatrix3fv(t,!1,r.Ar):e.uniformMatrix3fv(t,!1,r.vf)},_=!0;break;case"u_view_tsr_inverse":s=function(e,t,a,r){r.nc?e.uniformMatrix3fv(t,!1,r.Vv):e.uniformMatrix3fv(t,!1,r.ax)},_=!0;break;case"u_shadow_cast_billboard_view_tsr":s=function(e,t,a,r){e.uniformMatrix3fv(t,!1,r.Lr)},_=!0;break;case"u_view_proj_prev":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.mA)},_=!0;break;case"u_view_proj_matrix":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.gd)},_=!0;break;case"u_view_proj_inverse":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.Zw)},_=!0;break;case"u_sky_vp_inverse":s=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.Kg)},_=!0;break;case"u_camera_eye":case"u_camera_eye_frag":s=function(e,t,a,r){e.uniform3fv(t,g.Cb(r.v,I))},_=!0;break;case"u_camera_quat":s=function(e,t,a,r){e.uniform4fv(t,g.mb(r.v,M))},_=!0;break;case"u_view_max_depth":s=function(e,t,a,r){e.uniform1f(t,r.far)},_=!0;break;case"u_camera_range":s=function(e,t,a,r){e.uniform2f(t,r.near,r.far)},_=!0;break;case"u_csm_center_dists":s=function(e,t,a,r){e.uniform4fv(t,r.Gt)};break;case"u_height":s=function(e,t,a,r){e.uniform1f(t,r.height)},_=!0;break;case"u_pcf_blur_radii":s=function(e,t,a,r){e.uniform4fv(t,r.uo)};break;case"u_dof_dist":s=function(e,t,a,r){r.dof_on?e.uniform1f(t,r.dof_distance):e.uniform1f(t,0)},_=!0;break;case"u_dof_front_start":s=function(e,t,a,r){e.uniform1f(t,r.dof_front_start)},_=!0;break;case"u_dof_front_end":s=function(e,t,a,r){e.uniform1f(t,r.dof_front_end)},_=!0;break;case"u_dof_rear_start":s=function(e,t,a,r){e.uniform1f(t,r.dof_rear_start)},_=!0;break;case"u_dof_rear_end":s=function(e,t,a,r){e.uniform1f(t,r.dof_rear_end)},_=!0;break;case"u_dof_bokeh_intensity":s=function(e,t,a,r){e.uniform1f(t,r.dof_bokeh_intensity)},_=!0;break;case"u_camera_direction":s=function(e,t,a,r){e.uniform3fv(t,r.direction)},_=!0;break;case"u_cam_water_depth":s=function(e,t,a){e.uniform1f(t,a.Sp)},_=!0;break;case"u_fog_color_density":s=function(e,t,a){e.uniform4fv(t,a.Sd)};break;case"u_fog_params":s=function(e,t,a){e.uniform4fv(t,a.ff)};break;case"u_underwater_fog_color_density":s=function(e,t,a){e.uniform4fv(t,a.Eh)};break;case"u_bloom_key":s=function(e,t,a){e.uniform1f(t,a.ln)};break;case"u_average_lum_val":s=function(e,t,a){e.uniform1f(t,a.average_luminance)};break;case"u_mipmap_1x1":s=function(e,t,a){e.uniform1f(t,a.av)};break;case"u_bloom_edge_lum":s=function(e,t,a){e.uniform1f(t,a.kn)};break;case"u_time":s=function(e,t,a){e.uniform1f(t,a.time)},_=!0;break;case"u_wind":s=function(e,t,a){e.uniform3fv(t,a.Fh)},_=!0;break;case"u_sky_tex_dvar":s=function(e,t,a){e.uniform1f(t,a.Io)};break;case"u_sky_tex_fac":s=function(e,t,a){e.uniform4fv(t,a.Jo)};break;case"u_sky_tex_color":s=function(e,t,a){e.uniform3fv(t,a.Ho)};break;case"u_horizon_color":s=function(e,t,a){e.uniform3fv(t,a.yd)};break;case"u_zenith_color":s=function(e,t,a){e.uniform3fv(t,a.Ld)};break;case"u_environment_energy":s=function(e,t,a){e.uniform1f(t,a.Nf)};break;case"u_bsdf_cube_sky_dim":s=function(e,t,a){e.uniform1f(t,a.gt)},_=!0;break;case"u_sky_color":s=function(e,t,a){e.uniform3fv(t,a.Ok)};break;case"u_rayleigh_brightness":s=function(e,t,a){e.uniform1f(t,a.rayleigh_brightness)};break;case"u_mie_brightness":s=function(e,t,a){e.uniform1f(t,a.mie_brightness)};break;case"u_spot_brightness":s=function(e,t,a){e.uniform1f(t,a.spot_brightness)};break;case"u_scatter_strength":s=function(e,t,a){e.uniform1f(t,a.scatter_strength)};break;case"u_rayleigh_strength":s=function(e,t,a){e.uniform1f(t,a.rayleigh_strength)};break;case"u_mie_strength":s=function(e,t,a){e.uniform1f(t,a.mie_strength)};break;case"u_rayleigh_collection_power":s=function(e,t,a){e.uniform1f(t,a.rayleigh_collection_power)};break;case"u_mie_collection_power":s=function(e,t,a){e.uniform1f(t,a.mie_collection_power)};break;case"u_mie_distribution":s=function(e,t,a){e.uniform1f(t,a.mie_distribution)};break;case"u_light_positions":s=function(e,t,a){e.uniform4fv(t,a.im)};break;case"u_light_directions":s=function(e,t,a){e.uniform3fv(t,a.br)};break;case"u_light_color_intensities":s=function(e,t,a){e.uniform4fv(t,a.hm)};break;case"u_sun_quaternion":s=function(e,t,a){e.uniform4fv(t,a.zw)};break;case"u_sun_intensity":s=function(e,t,a){e.uniform3fv(t,a.yw)};break;case"u_sun_direction":s=function(e,t,a){e.uniform3fv(t,a.xw)};break;case"u_debug_view_mode":s=function(e,t,a){e.uniform1i(t,a.debug_view_mode)};break;case"u_debug_colors_seed":s=function(e,t,a){e.uniform1f(t,a.debug_colors_seed)};break;case"u_debug_render_time_threshold":s=function(e,t,a){e.uniform1f(t,a.Lt)};break;case"u_subpixel_jitter":s=function(e,t,a){e.uniform2fv(t,a.vz)},_=!0;break;case"u_subsample_indices":s=function(e,t,a){e.uniform4fv(t,a.LQ)},_=!0;break;case"u_radial_blur_step":s=function(e,t,a){e.uniform1f(t,a.xo)};break;case"u_god_rays_intensity":s=function(e,t,a){e.uniform1f(t,a.god_rays_intensity)};break;case"u_ssao_radius_increase":s=function(e,t,a){e.uniform1f(t,a.Po)};break;case"u_ssao_blur_discard_value":s=function(e,t,a){e.uniform1f(t,a.Lo)},_=!0;break;case"u_ssao_influence":s=function(e,t,a){e.uniform1f(t,a.Oo)};break;case"u_ssao_dist_factor":s=function(e,t,a){e.uniform1f(t,a.Mo)};break;case"u_texel_size":s=function(e,t,a){e.uniform2fv(t,a.Wr)},_=!0;break;case"u_normal_offset":s=function(e,t,a){e.uniform1f(t,a.self_shadow_normal_offset)};break;case"u_v_light_ts":s=function(e,t,a){e.uniform4fv(t,a.cp)},_=!0;break;case"u_v_light_r":s=function(e,t,a){e.uniform4fv(t,a.bp)},_=!0;break;case"u_v_light_tsr":s=function(e,t,a){e.uniformMatrix3fv(t,!1,a.os)},_=!0;break;case"u_p_light_matrix0":s=function(e,t,a){e.uniformMatrix4fv(t,!1,a.qj[0])},_=!0;break;case"u_p_light_matrix1":s=function(e,t,a){e.uniformMatrix4fv(t,!1,a.qj[1])},_=!0;break;case"u_p_light_matrix2":s=function(e,t,a){e.uniformMatrix4fv(t,!1,a.qj[2])},_=!0;break;case"u_p_light_matrix3":s=function(e,t,a){e.uniformMatrix4fv(t,!1,a.qj[3])},_=!0;break;case"u_outline_color":s=function(e,t,a){e.uniform3fv(t,a.rh)};break;case"u_draw_outline":s=function(e,t,a){e.uniform1f(t,a.yq)},_=!0;break;case"u_glow_mask_small_coeff":s=function(e,t,a){e.uniform1f(t,a.small_glow_mask_coeff)},_=!0;break;case"u_glow_mask_large_coeff":s=function(e,t,a){e.uniform1f(t,a.large_glow_mask_coeff)},_=!0;break;case"u_brightness":s=function(e,t,a){e.uniform1f(t,a.brightness)};break;case"u_contrast":s=function(e,t,a){e.uniform1f(t,a.contrast)};break;case"u_exposure":s=function(e,t,a){e.uniform1f(t,a.exposure)};break;case"u_saturation":s=function(e,t,a){e.uniform1f(t,a.saturation)};break;case"u_enable_hmd_stereo":s=function(e,t,a){e.uniform1i(t,a.enable_hmd_stereo)};break;case"u_distortion_params":s=function(e,t,a){e.uniform4fv(t,a.Ui)};break;case"u_chromatic_aberration_coefs":s=function(e,t,a){e.uniform4fv(t,a.chromatic_aberration_coefs)};break;case"u_motion_blur_exp":s=function(e,t,a){e.uniform1f(t,a.qv)},_=!0;break;case"u_motion_blur_decay_threshold":s=function(e,t,a){e.uniform1f(t,a.mb_decay_threshold)},_=!0;break;case"u_model_tsr":c=function(e,t,a){e.uniformMatrix3fv(t,!1,a.v)},_=!0;break;case"u_model_tsr_inverse":c=function(e,t,a){e.uniformMatrix3fv(t,!1,a.jx)},_=!0;break;case"u_transb":c=function(e,t,a){e.uniform4fv(t,a.Jd)},_=!0;break;case"u_transa":c=function(e,t,a){e.uniform4fv(t,a.te)},_=!0;break;case"u_arm_rel_trans":c=function(e,t,a){e.uniform4fv(t,a.Dp)},_=!0;break;case"u_arm_rel_quat":c=function(e,t,a){e.uniform4fv(t,a.Cp)},_=!0;break;case"u_quat":c=function(e,t,a){e.uniform4fv(t,g.mb(a.v,M))},_=!0;break;case"u_quatsb":c=function(e,t,a){e.uniform4fv(t,a.Bd)},_=!0;break;case"u_quatsa":c=function(e,t,a){e.uniform4fv(t,a.oe)},_=!0;break;case"u_frame_factor":c=function(e,t,a){e.uniform1f(t,a.gf)},_=!0;break;case"au_center_pos":c=function(e,t,a){e.uniform3fv(t,a.nt)},_=!0;break;case"au_wind_bending_amp":c=function(e,t,a){e.uniform1f(t,a.xf)},_=!0;break;case"au_wind_bending_freq":c=function(e,t,a){e.uniform1f(t,a.yf)},_=!0;break;case"au_detail_bending_freq":c=function(e,t,a){e.uniform1f(t,a.df)},_=!0;break;case"au_detail_bending_amp":c=function(e,t,a){e.uniform1f(t,a.cf)},_=!0;break;case"au_branch_bending_amp":c=function(e,t,a){e.uniform1f(t,a.Xe)},_=!0;break;case"u_node_values":c=function(e,t,a,r){e.uniform1fv(t,r.oh)},_=!0;break;case"u_node_rgbs":c=function(e,t,a,r){e.uniform3fv(t,r.Xd)},_=!0;break;case"u_lod_coverage":c=function(e,t,a,r){e.uniform1f(t,r.tk.Ae)},_=!0;break;case"u_lod_cmp_logic":c=function(e,t,a,r){e.uniform1f(t,r.tk.st)},_=!0;break;case"u_diffuse_color":c=function(e,t,a,r){e.uniform4fv(t,r.ud)},_=!0;break;case"u_diffuse_intensity":c=function(e,t,a,r){e.uniform1f(t,r.Xh)},_=!0;break;case"u_diffuse_params":c=function(e,t,a,r){e.uniform2fv(t,r.nd)},_=!0;break;case"u_emit":c=function(e,t,a,r){e.uniform1f(t,r.dh)},_=!0;break;case"u_ambient":c=function(e,t,a,r){e.uniform1f(t,r.Xg)},_=!0;break;case"u_specular_color":c=function(e,t,a,r){e.uniform3fv(t,r.ri)},_=!0;break;case"u_specular_alpha":c=function(e,t,a,r){e.uniform1f(t,r.Bm)},_=!0;break;case"u_specular_params":c=function(e,t,a,r){e.uniform3fv(t,r.qe)},_=!0;break;case"u_reflect_factor":c=function(e,t,a,r){e.uniform1f(t,r.reflect_factor)},_=!0;break;case"u_mirror_factor":c=function(e,t,a,r){e.uniform1f(t,r.mm)},_=!0;break;case"u_grass_map_dim":c=function(e,t,a,r){e.uniform3fv(t,r.ad)},_=!0;break;case"u_grass_size":c=function(e,t,a,r){e.uniform1f(t,r.aj)},_=!0;break;case"u_scale_threshold":c=function(e,t,a,r){e.uniform1f(t,r.zu)},_=!0;break;case"u_cube_fog":c=function(e,t,a,r){e.uniformMatrix4fv(t,!1,r.$e)};break;case"u_jitter_amp":c=function(e,t,a,r){e.uniform1f(t,r.Xu)},_=!0;break;case"u_jitter_freq":c=function(e,t,a,r){e.uniform1f(t,r.Yu)},_=!0;break;case"u_wireframe_edge_color":c=function(e,t,a,r){e.uniform3fv(t,r.wireframe_edge_color)};break;case"u_cluster_id":c=function(e,t,a,r){e.uniform1f(t,r.bq)},_=!0;break;case"u_batch_debug_id_color":c=function(e,t,a,r){e.uniform1f(t,r.Kt)},_=!0;break;case"u_batch_debug_main_render_time":c=function(e,t,a,r){e.uniform1f(t,r.rq)},_=!0;break;case"u_refr_bump":c=function(e,t,a,r){e.uniform1f(t,r.yo)},_=!0;break;case"u_line_width":c=function(e,t,a,r){e.uniform1f(t,r.jm)},_=!0;break;case"u_lamp_light_positions":c=function(e,t,a,r){e.uniform3fv(t,r.$n)};break;case"u_lamp_light_directions":c=function(e,t,a,r){e.uniform3fv(t,r.Yq)};break;case"u_lamp_light_color_intensities":c=function(e,t,a,r){e.uniform3fv(t,r.Xq)};break;case"u_halo_size":c=function(e,t,a,r){e.uniform1f(t,r.Ju)},_=!0;break;case"u_halo_hardness":c=function(e,t,a,r){e.uniform1f(t,r.Gu)},_=!0;break;case"u_halo_rings_color":c=function(e,t,a,r){e.uniform3fv(t,r.Iu)},_=!0;break;case"u_halo_lines_color":c=function(e,t,a,r){e.uniform3fv(t,r.Hu)},_=!0;break;case"u_halo_stars_blend":c=function(e,t,a,r){e.uniform1f(t,r.Ku)},_=!0;break;case"u_halo_stars_height":c=function(e,t,a,r){e.uniform1f(t,r.Lu)},_=!0;break;case"u_fresnel_params":c=function(e,t,a,r){e.uniform4fv(t,r.Pf)},_=!0;break;case"u_texture_scale":c=function(e,t,a,r){e.uniform3fv(t,r.Ng)},_=!0;break;case"u_parallax_scale":c=function(e,t,a,r){e.uniform1f(t,r.parallax_scale)},_=!0;break;case"u_color_id":c=function(e,t,a){e.uniform3fv(t,a.Wj)},_=!0;break;case"u_diffuse_color_factor":c=function(e,t,a,r){e.uniform1f(t,r.Wh)},_=!0;break;case"u_alpha_factor":c=function(e,t,a,r){e.uniform1f(t,r.mg)},_=!0;break;case"u_specular_color_factor":c=function(e,t,a,r){e.uniform1f(t,r.Aj)},_=!0;break;case"u_normal_factor":c=function(e,t,a,r){e.uniform1f(t,r.no)},_=!0;break;case"u_normalmap0_scale":c=function(e,t,a,r){e.uniform2fv(t,r.pj[0])},_=!0;break;case"u_normalmap1_scale":c=function(e,t,a,r){e.uniform2fv(t,r.pj[1])},_=!0;break;case"u_normalmap2_scale":c=function(e,t,a,r){e.uniform2fv(t,r.pj[2])},_=!0;break;case"u_normalmap3_scale":c=function(e,t,a,r){e.uniform2fv(t,r.pj[3])},_=!0;break;case"u_foam_factor":c=function(e,t,a,r){e.uniform1f(t,r.foam_factor)},_=!0;break;case"u_foam_uv_freq":c=function(e,t,a,r){e.uniform2fv(t,r.fu)},_=!0;break;case"u_foam_mag":c=function(e,t,a,r){e.uniform2fv(t,r.eu)},_=!0;break;case"u_foam_scale":c=function(e,t,a,r){e.uniform2fv(t,r.Eq)},_=!0;break;case"u_water_norm_uv_velocity":c=function(e,t,a,r){e.uniform1f(t,r.hl)},_=!0;break;case"u_shallow_water_col":c=function(e,t,a,r){e.uniform3fv(t,r.shallow_water_col)},_=!0;break;case"u_shore_water_col":c=function(e,t,a,r){e.uniform3fv(t,r.shore_water_col)},_=!0;break;case"u_water_shallow_col_fac":c=function(e,t,a,r){e.uniform1f(t,r.shallow_water_col_fac)},_=!0;break;case"u_water_shore_col_fac":c=function(e,t,a,r){e.uniform1f(t,r.shore_water_col_fac)},_=!0;break;case"u_p_length":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Ew)},_=!0;break;case"u_p_cyclic":c=function(e,t,a,r){e.uniform1i(t,r.Ba.cyclic)},_=!0;break;case"u_p_max_lifetime":c=function(e,t,a,r){e.uniform1f(t,r.Ba.cv)},_=!0;break;case"u_p_fade_in":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Wi)},_=!0;break;case"u_p_fade_out":c=function(e,t,a,r){e.uniform1f(t,r.Ba.De)},_=!0;break;case"u_p_size":c=function(e,t,a,r){e.uniform1f(t,r.Ba.size)},_=!0;break;case"u_p_alpha_start":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Ps)},_=!0;break;case"u_p_alpha_end":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Os)},_=!0;break;case"u_p_nfactor":c=function(e,t,a,r){e.uniform1f(t,r.Ba.lo)},_=!0;break;case"u_p_gravity":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Au)},_=!0;break;case"u_p_mass":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Eg)},_=!0;break;case"u_p_color_ramp":c=function(e,t,a,r){e.uniform4fv(t,r.Ba.vt)},_=!0;break;case"u_p_wind_fac":c=function(e,t,a,r){e.uniform1f(t,r.Ba.ix)},_=!0;break;case"u_p_time":c=function(e,t,a,r){e.uniform1f(t,r.Ba.time)},_=!0;break;case"u_p_tilt":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Cw)},_=!0;break;case"u_p_tilt_rand":c=function(e,t,a,r){e.uniform1f(t,r.Ba.Dw)},_=!0;break;case"u_position":c=function(e,t,a,r){e.uniform3fv(t,r.ql)},_=!0;break;case"u_va_frame_factor":c=function(e,t,a){e.uniform1f(t,a.Vw)},_=!0;break;case"u_refl_plane":c=function(e,t,a){e.uniform4fv(t,a.nc)},_=!0;break;case"u_outline_intensity":c=function(e,t,a){e.uniform1f(t,a.sh)},_=!0;break;case"u_obj_info":c=function(e,t,a,r){e.uniform3fv(t,r.po)},_=!0}c&&(c={name:i,Mn:c,ke:t[i]},_?a.push(c):r.push(c)),s&&(c={name:i,Mn:s,ke:t[i]},_?n.push(c):o.push(c))}if(r.length||o.length){e=e.jA;for(var l in e)delete e[l];for(l=0;l<r.length;l++)c=r[l],e[c.name]=c;for(l=0;l<o.length;l++)c=o[l],e[c.name]=c}else e.yv=!0}var _=t("__batch"),s=t("__camera"),c=t("__config"),l=t("__debug"),f=t("__extensions"),u=t("__geometry"),d=t("__quat"),p=t("__subscene"),m=t("__textures"),g=t("__tsr"),h=t("__util"),v=t("__version"),b=t("__vec3"),E=[1,0,0,1],A=[1,1,1,1],x=[0,0,0,1],T=[0,0,0,0],y=new Uint8Array([91.8,142.8,.96*255,255]),S=null,O=null,w=null,R=null,L=null,N=null,I=new Float32Array(3),M=d.create(),C=new Uint8Array(4),D=c.H;e.bg=function(e){var t=D.background_color;e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.cullFace(e.BACK),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),S=e},e.Cn=function(e){if(e.Vb&&!e.Ql)if(e.type==p.As){l.tA(e);var t=e.B;S.bindFramebuffer(S.READ_FRAMEBUFFER,t.Hq),S.bindFramebuffer(S.DRAW_FRAMEBUFFER,t.Ee);var o=0;t.$b&&(o|=S.COLOR_BUFFER_BIT),t.bf&&(o|=S.DEPTH_BUFFER_BIT),S.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,o,S.NEAREST),l.uA(e),l.by("draw resolve")}else if(e.type==p.ox)l.tA(e),t=e.B,S.bindFramebuffer(S.FRAMEBUFFER,t.Hq),S.bindTexture(S.TEXTURE_2D,t.$b.zb),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,t.width,t.height,0),l.uA(e),l.by("draw copy");else{switch(l.tA(e),t=e.B,S.bindFramebuffer(S.FRAMEBUFFER,t.Ee),e.Fp&&(o=t.$b,S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,o.lb,o.zb,0)),S.viewport(0,0,t.width,t.height),e.type!=p.kd&&e.type!=p.Qe&&r(e),e.kb?S.enable(S.BLEND):S.disable(S.BLEND),e.td?S.enable(S.DEPTH_TEST):S.disable(S.DEPTH_TEST),e.type){case p.ld:S.enable(S.POLYGON_OFFSET_FILL),S.polygonOffset(e.self_shadow_polygon_offset,e.self_shadow_polygon_offset),S.cullFace(S.BACK);break;case p.Nd:case p.Bf:S.disable(S.POLYGON_OFFSET_FILL),S.cullFace(S.FRONT);break;case p.Sg:S.enable(S.POLYGON_OFFSET_FILL),S.polygonOffset(-4,-4),S.cullFace(S.BACK);break;case p.Md:if(1<D.Rb||D.RS){S.enable(S.POLYGON_OFFSET_FILL),S.polygonOffset(-2,-2);break}default:S.disable(S.POLYGON_OFFSET_FILL),S.cullFace(S.BACK)}if(e.type==p.kd||e.type==p.Qe)for(var t=e.B,o=t.$b.zb,i=0;6>i;i++){var _=n(i);t.Mb=e.Si[i],g.from_mat4(t.Mb,t.vf),s.Yx(t),S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,_,o,0),r(e);for(var _=e.Pa,c=0;c<_.length;c++)for(var f=0;f<_[c].Ca.length;f++){var u=_[c].Ca[f];u.Vb=u.Ay[i]}a(e)}else a(e);l.uA(e),l.by("draw subscene: "+p.ww(e))}},e.clear=function(e){S.bindFramebuffer(S.FRAMEBUFFER,e.B.Ee),r(e)},e.Ts=function(e){var t=e.Gp;t.length=0;var a,r=e.ga,n=r.xb,i=e.ib.attributes;for(a in i){var _=n[a],s=u.On(a),c=u.PP(a),f=u.ME(a);t.push({Ww:s,Pn:c,ke:i[a],Ys:_.offset*f,gu:1<_.frames?_.length*f:0,cc:_.cc,Cj:_.Cj*f,Ml:_.Ml})}if("DEBUG"==v.type())for(a in n)s=u.On(a),t=u.US(r.fd,s),t=r.fd[t],_=e.Ra.uf+" | "+e.Ra.ge,s=n[a].length*n[a].frames*u.ME(a),l.MO(t.fO,_,a,s,a in i);D.Gx&&o(e)},e.GL=o,e.FM=function(e){for(var t=f.Yy(),a=0;a<e.Ne.length;a++)t.deleteVertexArray(e.Ne[a]);e.Ne.length=0},e.HM=function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a];t.push({Ww:r.Ww,Pn:r.Pn,ke:r.ke,Ys:r.Ys,gu:r.gu,cc:r.cc,Cj:r.Cj,Ml:r.Ml})}return t},e.FL=i,e.FC=function(e){var t=e.ib,a=e.fa;e=e.rf,S.useProgram(t.ni);for(var r=0;r<a.length;r++)S.uniform1i(t.Gm[e[r]],r)},e.Uv=function(e,t,a,r,n,o){return S.bindFramebuffer(S.FRAMEBUFFER,e),S.readPixels(t,a,r,n,S.RGBA,S.UNSIGNED_BYTE,o),S.bindFramebuffer(S.FRAMEBUFFER,null),o},e.yU=function(e){var t=e.ib;t.yv||(S.useProgram(t.ni),t.nr.length||i(t),t=t.jA.u_cube_fog,t.Mn(S,t.ke,null,e))},e.xS=function(e,t){var a=S.createFramebuffer();if(S.bindFramebuffer(S.FRAMEBUFFER,a),m.Yn(e)){var r=e.Oe;S.framebufferRenderbuffer(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.RENDERBUFFER,r)}else if(m.Zn(e)){var n=e,r=n.zb,n=n.lb==S.TEXTURE_CUBE_MAP?S.TEXTURE_CUBE_MAP_NEGATIVE_Z:n.lb;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,n,r,0)}return m.Yn(t)?(r=t.Oe,S.framebufferRenderbuffer(S.FRAMEBUFFER,S.DEPTH_ATTACHMENT,S.RENDERBUFFER,r)):m.Zn(t)&&(n=t,r=n.zb,n=n.lb,S.framebufferTexture2D(S.FRAMEBUFFER,S.DEPTH_ATTACHMENT,n,r,0)),l.pM(),S.bindFramebuffer(S.FRAMEBUFFER,null),a},e.wS=function(e,t,a,r,n){null==e?(S.bindFramebuffer(S.FRAMEBUFFER,e),S.viewport(0,0,r,n),S.clear(S.COLOR_BUFFER_BIT|S.DEPTH_BUFFER_BIT)):(m.Yn(t)?S.deleteRenderbuffer(t.Oe):m.Zn(t)&&S.deleteTexture(t.zb),m.Yn(a)?S.deleteRenderbuffer(a.Oe):m.Zn(a)&&S.deleteTexture(a.zb),S.deleteFramebuffer(e))},e.PX=function(){},e.qO=function(e,t,a,r,n,o){e=e.zb,S.viewport(0,0,a,a),S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,t,e,0),t=_.Dt("FLIP_CUBEMAP_COORDS"),e=t.ib,S.activeTexture(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,n);var i=n=0;a!=r&&(n=1/(6*r),i=1/(4*r)),S.uniform1i(e.Gm.u_tex_number,o),S.uniform2fv(e.Gm.u_delta,[n,i]),S.useProgram(e.ni),N(t,0),S.bindTexture(S.TEXTURE_2D,null)},e.rO=function(e,t,a,r,n){S.bindFramebuffer(S.FRAMEBUFFER,r),r=e.zb,e=e.lb,S.bindTexture(e,r),S.viewport(0,0,t,a),S.texImage2D(e,0,S.RGBA,t,a,0,S.RGBA,S.UNSIGNED_BYTE,null),S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,e,r,0),t=_.Dt("NONE"),a=t.ib,S.activeTexture(S.TEXTURE0),S.bindTexture(e,n),S.useProgram(a.ni),N(t,0),S.bindFramebuffer(S.FRAMEBUFFER,null),S.bindTexture(e,null)},e.cleanup=function(){},e.gT=function(){var e=f.SP(),t=f.Yy();D.xC=!!e,D.Gx=!!t,e?(O=function(t,a,r,n){e.drawElementsInstanced(S.TRIANGLES,t,a,r,n)},w=function(t,a){e.vertexAttribDivisor(t,a)},R=function(t,a,r){e.drawArraysInstanced(S.TRIANGLES,t,a,r)}):(O=function(e,t,a){S.drawElements(S.TRIANGLES,e,t,a)},w=function(){},R=function(e,t){S.drawArrays(S.TRIANGLES,e,t)}),t?(L=function(e){t.bindVertexArray(e)},N=function(e,t){var a=e.ga;L(e.Ne[t]),a.Bg?O(a.count,a.Xl,0,a.am):R(0,a.count,a.am),L(null)}):N=function(e,t){for(var a=e.ga,r=e.Gp,n=0;n<a.fd.length;n++){S.bindBuffer(S.ARRAY_BUFFER,a.fd[n].Lj);for(var o=0;o<r.length;o++){var i=r[o];i.Ww==a.fd[n].type&&(S.enableVertexAttribArray(i.ke),S.vertexAttribPointer(i.ke,i.cc,i.Pn,i.Pn!=S.FLOAT,i.Cj,i.Ys+i.gu*t),w(i.ke,i.Ml))}}for(a.Bg?(S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.Bg),O(a.count,a.Xl,0,a.am)):R(0,a.count,a.am),n=0;n<r.length;n++)i=r[n],S.disableVertexAttribArray(i.ke)}},e.reset=function(){L=R=w=O=S=null}},a.module.__shaders=function(e,t){function r(){return{uf:"",ge:"",ah:[],He:[],status:0,Us:0,Bw:0}}function n(e){var t=r();return t.uf=e.uf,t.ge=e.ge,t.ah=N.P(e.ah),t.He=N.P(e.He),t.status=e.status,t.Us=e.Us,t.Bw=e.Bw,t}function o(e,t,a){var r=e.ah;for("string"==typeof a?(e=i(e,a))&&(a=e[1]):a=String(a),e=0;e<r.length;e++)if(r[e][0]==t){r[e][1]=a;break}}function i(e,t){for(var a=e.ah,r=0;r<a.length;r++)if(a[r][0]==t)return a[r];return!1}function _(e,t){var a=e+t;if(!(a in P)){var r,n=h(C.shaders_path,e),o=h(C.shaders_path,t),n=b(n),o=b(o);for(r in o)n[r]=o[r];o=[];for(r in n)o.push([r,n[r]]);P[a]=o}return P[a]}function s(e,t){return e+t}function c(e,t){return(e.split(";").map(function(e){return(e=e.match(t))&&(e[3]?parseInt(e[3],10):1)}).filter(function(e){return e})||[]).reduce(s,0)}function l(e,t){var a=g(e.type),r=g(t.type),n=e.vl,o=t.vl;return a>r?-1:a<r?1:n>o?-1:n<o?1:0}function f(e){if(I.Ab){e=e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var t=B}else t=H;return e=e.split(";").map(function(e){return(e=e.match(t))&&{type:e[2],vl:e[4]?parseInt(e[4],10):1}}).filter(function(e){return e}),d(e,z,M.lv)}function u(e,t,a){e=e.split(";");for(var r=[],n=0;n<e.length;n++){var o=e[n].match(j);o&&r.push({type:o[2],vl:o[4]?parseInt(o[4],10):1})}return d(r,t,a)}function d(e,t,a){if(!e.length)return!0;for(var r=0;r<a;r++)t[r]=0;J=a,e.sort(l);var n=0,o=0,i=0;return function(){for(;i<e.length;){var a=e[i];if(4!=g(a.type))break;o+=m(a.type)*a.vl,i++}return!(o>J)&&(V=o,p(t,0,o,0,4),!0)}()&&function(){for(var a=0;i<e.length;){var r=e[i];if(3!=g(r.type))break;a+=m(r.type)*r.vl,i++}return!((n=o+a)>J)&&(p(t,o,a,0,3),!0)}()&&function(){for(var a=J-n,r=a,o=a;i<e.length;){var _=e[i];if(2!=g(_.type))break;if((_=m(_.type)*_.vl)<=r)r-=_;else{if(!(_<=o))return!1;o-=_}i++}return o=a-o,p(t,n,a-r,0,2),p(t,J-o,o,2,2),!0}()&&function(){for(;i<e.length;){for(var r=e[i],r=m(r.type)*r.vl,n=-1,o=a+1,_=-1,s=0;4>s;s++){var c=q;c[0]=0,c[1]=1;var l;l=t;for(var f=s,u=r,d=c;V<l.length&&15===l[V];)V++;for(;0<J&&15===l[J];)J--;if(J-V<u)l=!1;else{for(var f=1<<f,g=0,h=-1,v=l.length+1,b=!1,E=V;E<=J;E++)E<J&&!(l[E]&f)?b||(g=E,b=!0):(b&&(b=E-g)>=u&&b<v&&(v=b,h=g),b=!1);0>h?l=!1:(d[0]=h,d[1]=v,l=!0)}l&&c[1]<o&&(_=c[0],o=c[1],n=s)}if(0>n)return!1;p(t,_,r,n,1),i++}return!0}()}function p(e,t,a,r,n){for(var o=0,i=0;i<n;i++)o|=1<<r+i;for(i=0;i<a;i++)e[t+i]|=o}function m(e){switch(e){case"mat4":e=4;break;case"mat3":e=3;break;case"mat2":e=2;break;default:e=1}return e}function g(e){switch(e){case"mat4":case"vec4":case"ivec4":case"bvec4":case"mat2":e=4;break;case"mat3":case"vec3":case"ivec3":case"bvec3":e=3;break;case"vec2":case"ivec2":case"bvec2":e=2;break;default:e=1}return e}function h(e,a){var r=e+a;if(U[r])return U[r];if(k){var n=k[a];if(!n)return null;n=t("__gpp_parser").mY.parse(n)}else if(!(n=t("shader_texts")[a]))return null;return U[r]=n}function v(e,t){for(var a={},r=t.ah||[],n=0;n<r.length;n++)a[r[n][0]]=[r[n][1]];for(n=0;n<t.He.length;n++)a["USE_NODE_"+t.He[n].id]=["1"];I.Ab?(a.GLSL1=["0"],a.GLSL3=["1"],a.GLSL_VERSION=["300 es"],a.GLSL_IN=["in"],a.GLSL_OUT=["out"],a.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],a.GLSL_TEXTURE=["texture"],a.GLSL_TEXTURE_CUBE=["texture"],a.GLSL_TEXTURE_PROJ=["textureProj"],a.GLSL_TEXTURE_LOD=["textureLod"],a.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(a.GLSL1=["1"],a.GLSL3=["0"],a.GLSL_VERSION=["100"],a.GLSL_IN="vert"==e?["attribute"]:["varying"],a.GLSL_OUT="vert"==e?["varying"]:[""],a.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],a.GLSL_TEXTURE=["texture2D"],a.GLSL_TEXTURE_CUBE=["textureCube"],a.GLSL_TEXTURE_PROJ=["texture2DProj"],a.GLSL_TEXTURE_LOD=["textureLod"],I.dB?(a.GLSL_TEXTURE_LOD=["texture2DLodEXT"],a.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(a.GLSL_TEXTURE_LOD=["texture2D"],a.GLSL_TEXTURE_CUBE_LOD=["textureCube"])),a.GLSL_SMPLR2D_SHDW=I.jq&&!I.Fr?["sampler2DShadow"]:["sampler2D"];for(var o in a)a[o][0].constructor!=String&&L.warn("Warning! The value of a directive '"+o+"' is not of type string.");return a}function b(e){function t(e){"var"==e.a?r[e.c]=e.b.join(""):"include"==e.a&&(e=h(C.shaders_path,C.oH+e.A),a(e,t))}function a(e,t,r){if(e instanceof Array)for(var n=0;n<e.length;n++)a(e[n],t,r);else if(e instanceof Object&&e){t&&t(e);for(n in e)a(e[n],t,r);r&&r(e)}}var r={};return a(e,t),r}function E(e,t,a){function r(t){t=t.f;for(var a=0;a<t.length;a++){var c=t[a];switch(c.a){case"cond":e:for(var c=c.f,l=0;l<c.length;l++){var g=c[l];switch(g.a){case"if":case"elif":if(n(g.i)){r(g.j);break e}break;case"else":r(g.j);break e;case"ifdef":g.c in d&&r(g.j);break;case"ifndef":g.c in d||r(g.j)}}break;case"include":c=c.A,l=h(C.shaders_path,C.oH+c),m.push("include/"+c),r(l),m.pop();break;case"var":break;case"define":d[c.c]=c.b;break;case"error":N.F("Shader error: #error "+c.b.join(" "));break;case"line":break;case"pragma":u.push("#pragma "+c.c+" "+c.b.join(" "));break;case"undef":delete d[c.c];break;case"warning":L.warn("Shader warning: #warning "+c.b.join(" "));break;case"extension":c=s(c.b,d,p,!1),u.push("#extension "+c.join(" "));break;case"version":c=s(c.b,d,p,!1),u.push("#version "+c.join(" "));case"#":break;case"node":b[c.c]=c;break;case"nodes_global":for(c=f,l=0;l<c.length;l++){var g=c[l],v=b[g.id];if(v)for(var A=0,x=0;x<v.s.length;x++){var w=v.s[x];if("node_param"==w.a){var R;if("PARTICLE_INFO"==g.id&&w.g)if(1==d.PARTICLE_BATCH)switch(R=!1,A){case 0:R=S(g.Ua,"PART_INFO_IND")||S(g.Ua,"PART_INFO_AGE")||S(g.Ua,"PART_INFO_LT")||S(g.Ua,"PART_INFO_SIZE");break;case 1:R=S(g.Ua,"PART_INFO_LOC");break;case 2:R=S(g.Ua,"PART_INFO_VEL");break;case 3:R=S(g.Ua,"PART_INFO_A_VEL");break;case 4:R=S(g.Ua,"PART_INFO_IND")}else R=!1;else R=!0;R&&(w=w.h.join(" ")+" ","vert"==e?w+=g.ue[A]:"frag"==e&&(w+=g.Y[A],null!==g.ro[A]&&(w+="="+g.ro[A])),w+=";",_(i(w))),A++}}}break;case"nodes_main":for(c=f,l=0;l<c.length;l++)if(g=c[l],v=b[g.id]){A={},O=y=T=0,x=v,w=g,R=x;for(var I={},M=0;M<R.u.length;M++){var D=R.u[M];I[D.c]=[D.b.join("")]}for(R=I,I=0;I<w.Ua.length;I++)(M=w.Ua[I][0])in R&&(R[M]=[w.Ua[I][1]]);for(I=M=0;I<x.s.length;I++)D=x.s[I],"node_out"==D.a&&(R["USE_OUT_"+D.c]=[-1<E.indexOf(w.outputs[M])|0],M++);for(x=R,w=g,R=v.s,I=A,M=x,D=0;D<R.length;D++){var U=R[D];switch(U.a){case"node_in":var k=w.inputs[T];if(null!==w.mz[T]){if(("MATERIAL_BEGIN"==w.id&&3===T||!M.MATERIAL_EXT&&("MATERIAL_BEGIN"==w.id&&4===T||"MATERIAL_END"==w.id&&3===T||"MATERIAL_END"==w.id&&4===T||"MATERIAL_END"==w.id&&5===T)||"TEXTURE_COLOR"==w.id||"TEXTURE_NORMAL"==w.id)&&U.g){I[U.c]=w.mz[T],T++;continue}var P=U.h.join(" ")+" ",P=P+(k+"=")+w.mz[T]+";";_(i(P))}I[U.c]=k,T++;break;case"node_out":k=w.outputs[y],(!U.g||-1<E.indexOf(k))&&(P=U.h.join(" ")+" ",P+=k+";",_(i(P)),I[U.c]=k),y++;break;case"node_param":"vert"==e?k=w.ue[O]:"frag"==e&&(k=w.Y[O]),I[U.c]=k,O++}}u.push("{"),o(g,v.m,A,x),u.push("}")}break;case"txt":_(c.b);break;default:N.F("Unknown element type: "+c.a)}}}function n(e,t){var a;a=s(e,d,p,!0,t);for(var r=[],n=0;n<a.length;n++)if(a[n]instanceof Object)switch(a[n].a){case"conditional_expr":var o=r.pop(),i=r.pop();r.pop()?r.push(i):r.push(o);break;case"logical_or_expr":for(var i=r.pop(),_=0;_<a[n].l-1;_++)o=r.pop(),i=i||o;r.push(i);break;case"logical_and_expr":for(i=r.pop(),_=0;_<a[n].l-1;_++)o=r.pop(),i=i&&o;r.push(i);break;case"logical_bitor_expr":for(i=r.pop(),_=0;_<a[n].l-1;_++)i|=r.pop();r.push(i);break;case"logical_bitxor_expr":for(i=r.pop(),_=0;_<a[n].l-1;_++)i^=r.pop();r.push(i);break;case"logical_bitand_expr":for(i=r.pop(),_=0;_<a[n].l-1;_++)i&=r.pop();r.push(i);break;case"equal_expr":o=r.pop(),i=r.pop(),r.push(i==o);break;case"non_equal_expr":o=r.pop(),i=r.pop(),r.push(i!=o);break;case"le_expr":o=r.pop(),i=r.pop(),r.push(i<=o);break;case"ge_expr":o=r.pop(),i=r.pop(),r.push(i>=o);break;case"l_expr":o=r.pop(),i=r.pop(),r.push(i<o);break;case"g_expr":o=r.pop(),i=r.pop(),r.push(i>o);break;case"left_shift_expr":i=r.pop(),o=r.pop(),r.push(i<<o);break;case"right_shift_expr":i=r.pop(),o=r.pop(),r.push(i>>o);break;case"add_expr":i=r.pop(),o=r.pop(),r.push(i+o);break;case"sub_expr":i=r.pop(),o=r.pop(),r.push(i-o);break;case"mul_expr":i=r.pop(),o=r.pop(),r.push(i*o);break;case"div_expr":i=r.pop(),o=r.pop(),r.push(i/o);break;case"mod_expr":i=r.pop(),o=r.pop(),r.push(i%o);break;case"pre_inc_expr":case"post_inc_expr":o=r.pop(),r.push(++o);break;case"pre_dec_expr":case"post_dec_expr":o=r.pop(),r.push(--o);break;case"positive_expr":o=r.pop(),r.push(+o);break;case"negative_expr":o=r.pop(),r.push(-o);break;case"one_compl_expr":o=r.pop(),r.push(~o);break;case"logic_negative_expr":o=r.pop(),r.push(!o);break;default:N.F("Unknown operation type: "+a[n].a)}else o=a[n],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(o)?(r.push(0),0!=o.indexOf("USE_NODE_")&&(i=m[m.length-1],i in g||(g[i]=[]),-1==g[i].indexOf(o)&&(g[i].push(o),L.error("Undefined directive '"+o+"' in shader '"+i+"'. Should it be defined with #var/#node_var or #define?")))):r.push(parseFloat(a[n]));return 1==r.length?a=r[0]:(N.F("Incorrect expression: "+a.join(" ")),a=void 0),a}function o(e,t,a,r){for(var i=0;i<t.length;i++){var s=t[i];switch(s.a){case"node_cond":e:for(var c=e,s=s.f,l=a,f=r,u=0;u<s.length;u++){var p=s[u];switch(p.a){case"node_if":case"node_elif":if(n(p.i,f)){o(c,p.m,l,f);break e}break;case"node_else":o(c,p.m,l,f);break e;case"node_ifdef":(p.c in d||p.c in f)&&o(c,p.m,l,f);break;case"node_ifndef":p.c in d||p.c in f||o(c,p.m,l,f)}}break;case"txt":for(c=[],l=0;l<s.b.length;l++)f=s.b[l],f in a?c.push(a[f]):c.push(f);_(c,r)}}}function i(e){return e.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function _(t,a){var r=t;if(!I.Ab&&"frag"==e){var n=r.join(" ");x&&(n.match(/[^;]*;/)?(n=n.replace(/[^;]*;/,""),x=!1):n=""),n=n.replace(/GLSL_OUT [^;]*;/g,""),n.match(/GLSL_OUT(?:$| [^;]*)/)&&(n=n.replace(/GLSL_OUT(?:$| [^;]*)/,""),x=!0),n=n.replace(/ {2,}/g," "),r=(n=n.trim())?n.split(" "):[]}t=r,t.length&&(r=s(t,d,p,!1,a),u.push(r.join(" ")))}function s(e,t,a,r,n){var o=[];return c(e,t,a,r,o,n),o}function c(e,t,a,r,n,o){for(var i=0;i<e.length;i++){var _=e[i];if(o&&_ in o)_=o[_];else{if(!(_ in t)){n.push(_);continue}_=t[_]}0==_.length&&r?n.push(0):c(_,t,a,r,n,o)}}var l,f=a.He,u=[],d=v(e,a),p={},m=[a[e]],g={},b={},E=[];for(l in f)for(var A in f[l].inputs)E.push(f[l].inputs[A]);var x=!1;r(t);var T=0,y=0,O=0;return u.join("\n")}function A(e,t,a){return a=e.createShader(a),e.shaderSource(a,t),e.compileShader(a),a}function x(e){Q.deleteProgram(e.ni),Q.deleteShader(e.cx),Q.deleteShader(e.iu),delete D[e.KA]}function T(e,t){switch(!t&&e.length?t=e.length:t||(t=1),t){case 1:return y(e);case 2:return"vec2("+y(e[0])+","+y(e[1])+")";case 3:return"vec3("+y(e[0])+","+y(e[1])+","+y(e[2])+")";case 4:return"vec4("+y(e[0])+","+y(e[1])+","+y(e[2])+","+y(e[3])+")";case 9:return"mat3("+y(e[0])+","+y(e[1])+","+y(e[2])+","+y(e[3])+","+y(e[4])+","+y(e[5])+","+y(e[6])+","+y(e[7])+","+y(e[8])+")";case 16:return"mat4("+y(e[0])+","+y(e[1])+","+y(e[2])+","+y(e[3])+","+y(e[4])+","+y(e[5])+","+y(e[6])+","+y(e[7])+","+y(e[8])+","+y(e[9])+","+y(e[10])+","+y(e[11])+","+y(e[12])+","+y(e[13])+","+y(e[14])+","+y(e[15])+")";default:N.F("Wrong glsl value dimension")}}function y(e){return e%1?String(e):String(e)+".0"}function S(e,t){for(var a=0;a<e.length;a++)if(e[a][0]==t)return!0;return!1}var O=t("__assets"),w=t("__config"),R=t("__debug"),L=t("__print"),N=t("__util"),I=w.H,M=w.Zg,C=w.Ie,D={},U={},k=null,P={},G="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv node_skybox.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_truncated.glslf postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/coverage.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");e.gC=0,e.XI=1,e.WI=2,e.$I=4,e.ZI=8,e.YI=16,e.UI=32;var F=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,j=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,B=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,H=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,X=/(?:\W|^)discard(\W|$)/,q=new Int16Array(2),z=null,W=null,Y=null,V=0,J=0,K=[],Q=null,Z=!1;e.bg=function(e){Q=e},e.yQ=r,e.KM=n,e.ka=o,e.EP=i,e.eT=function(e){e.ah=N.P(_(e.uf,e.ge)),o(e,"PRECISION",w.H.precision),"highp"==w.H.precision?o(e,"EPSILON",T(1e-6)):o(e,"EPSILON",T(1e-4)),o(e,"CONSTANTS_HACK",0|I.JA),o(e,"SRGB",I.srgb_type),o(e,"COMPARED_MODE",0|I.jq)},e.IX=function(e){return e.uf},e.BX=function(e){return e.ge},e.xP=function(e){var t=JSON.stringify(e.uf)+JSON.stringify(e.ge)+JSON.stringify(e.ah)+JSON.stringify(e.He),a=D[t];if(a)return a;var r=e.ge,o=h(C.shaders_path,e.uf),r=h(C.shaders_path,r);if(!o||!r)return null;var o=E("vert",o,e),r=E("frag",r,e),a=0,i=c(r,F);if(e.Bw=i,i>M.Iz&&(a|=1),z||(z=new Uint32Array(M.lv)),W||(W=new Uint32Array(M.Ez)),Y||(Y=new Uint32Array(M.mv)),u(r,W,M.Ez)||(a|=2),u(o,Y,M.mv)||(a|=4),i=I.Ab?(o.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(o.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length,e.Us=i,i>M.Jz&&(a|=8),f(r)||(a|=16),e.status=a,0===e.status){var a=Q,_=A(a,o,a.VERTEX_SHADER),s=A(a,r,a.FRAGMENT_SHADER),i=a.createProgram();a.attachShader(i,_),a.attachShader(i,s),a.linkProgram(i);for(var _={cx:_,iu:s,ni:i,attributes:{},Gm:{},nr:N.Yj(),iA:N.Yj(),jA:{},ko:!0,yv:!1,XH:N.Yj(),WH:N.Yj(),Ra:n(e),KA:t,WE:!!r.match(X),sg:!0},l=a.getProgramParameter(i,a.ACTIVE_ATTRIBUTES),s=0;s<l;s++){var d=a.getActiveAttrib(i,s).name;_.attributes[d]=a.getAttribLocation(i,d)}for(l=a.getProgramParameter(i,a.ACTIVE_UNIFORMS),s=0;s<l;s++)d=a.getActiveUniform(i,s).name.split("[0]").join(""),_.Gm[d]=a.getUniformLocation(i,d);D[t]=a=_,i=!Q.getShaderParameter(a.iu,Q.COMPILE_STATUS),_=!Q.getShaderParameter(a.cx,Q.COMPILE_STATUS),s=!Q.getProgramParameter(a.ni,Q.LINK_STATUS),i?R.GG(a.iu,t,r):_?R.GG(a.cx,t,o):s&&R.DS(a.ni,t,o,r),(i||_||s)&&(e.status|=32,a=null)}else a=null;return a},e.hR=function(){if(Z=!1,a.module_check("shader_texts"))Z=!0;else{for(var e=[],t=O.AT_TEXT,r=0;r<G.length;r++){var n=N.ji(C.shaders_path+G[r]);e.push({id:G[r],type:t,url:n})}t=function(e,t){k||(k={}),k[t]=e},e.length?O.enqueue(e,t,function(){Z=!0}):L.error("Shaders have not been found.")}},e.lD=function(){return Z},e.eX=function(){return K},e.DE=function(){return D},e.cleanup=function(){for(var e in D)x(D[e]);for(var t in U)delete U[t];for(var a in K)delete K[a];Y=W=z=null,P={}},e.EM=x,e.fX=function(e){var t=e.ah;for(L.log("Shader: "+e.uf+" "+e.ge+", "+String(t.length)+" directives: "),e=0;e<t.length;e++)L.log("  "+t[e][0],t[e][1])},e.R=T,e.mD=function(e,t){return t in e.Gm},e.reset=function(){Q=null}},a.module.__geometry=function(e,t){function a(){return{length:0,frames:1,cc:0,Cj:0,offset:0,Ml:0}}function r(e,t){for(var a=t.a_tbn,r=t.a_position,n=r.length,o=1;o<e.fb.length;o++)for(var i=e.fb[o].Rq,_=e.fb[o].Qf.a_position,s=0;s<n;s++)r[s]+=i*_[s];for(r=q.tu(a),o=0;o<r;o++){for(n=q.identity(V),s=1;s<e.fb.length;s++)_=e.fb[s].Qf.a_tbn,(i=e.fb[s].Rq)&&(_=q.Wl(_,o,J),i=q.slerp(q.identity(K),_,i,J),q.vv(i,n,n));s=q.Wl(a,o,J),s=q.vv(n,s,J),q.oi(a,s,o)}}function n(e){return 65536<e.Na&&!B.EE()}function o(e){return 0<e.qa.length}function i(e,t,a){if(!o(e))return e;a||H.log('%cDEBUG max vertices exceeded for indexed submesh "'+e.name+'": '+e.Na*(t||1)+", will use drawArrays","color: #aa0"),t=e.qa,a=e.Na;var r,n=e.oa,i=e.$;for(r in n){var s=n[r],c=x(s,a);n[r]=_(t,s,c)}for(n=0;n<i.length;n++){var l=i[n];for(r in l)s=l[r],c=x(s,a),l[r]=_(t,s,c)}for(n=0;n<e.fb.length;n++){r=e.fb[n].Qf;for(var f in r)s=r[f],c=x(s,a),r[f]=_(t,s,c)}return e.Na=t.length,e.qa=new Uint16Array(0),e}function _(e,t,a){if(0==t.length)return new Float32Array(0);for(var r=new Float32Array(e.length*a),n=0;n<e.length;n++)for(var o=e[n],i=0;i<a;i++)r[a*n+i]=t[a*o+i];return r}function s(){return{Td:null,Yb:N(),Xl:0,count:0,xb:{},usage:0,sn:0,vn:0,fd:[],Bg:null,fb:null,am:1,sg:!0}}function c(e,t,r,n){if("a_normal"==t)return n=q.Tl(n),c(e,"a_tbn",r,n);var o=e.xb,i=o[t],_=k(t);if(i)r&&i.cc!=r&&W.F('invalid num_comp for "'+t+'"'),P(e.Yb,t,n,i.offset);else{i=M(e.Yb,_),-1==i&&(e.Yb.push(I(_,0)),i=e.Yb.length-1);var _=e.Yb[i].cl,s=new _.constructor(_.length+n.length);s.set(_),e.Yb[i].cl=s,P(e.Yb,t,n,_.length),t=o[t]=a(),t.cc=r,t.offset=_.length,t.length=n.length}return d(e),e}function l(e,t){if("a_normal"==t){for(var a=l(e,"a_tbn"),r=q.tu(a),n=new Float32Array(3*r),o=0;o<r;o++){var i=q.WP(a,o,Q);n.set(i,3*o)}return n}if(a=e.xb[t])return r=k(t),G(t,D(e.Yb,r).subarray(a.offset,a.offset+a.length),new Float32Array(a.length));W.F("extract_array_float() failed; invalid name: "+t)}function f(t,a){var r;switch(a){case e.Ym:case e.op:r=ae.STATIC_DRAW;break;case e.ws:r=ae.DYNAMIC_DRAW;break;default:W.F("Wrong draw_mode")}t.usage=r}function u(e,t,a){function r(e,t){o[e]||(o[e]=0),o[e]+=t}var n,o={};for(n in e[0]){var i=e[0][n],_=k(n);r(_,i.length*e.length)}for(n in t)i=t[n],_=k(n),r(_,i.length);if(a){e=a.$r.length,_=k("a_part_ts"),r(_,4*e),_=k("a_part_r"),r(_,4*e),t=a.so;for(n in t)_=k(n),r(_,t[n].cc*e);a=a.vw;for(n in a)_=k(n),r(_,e)}return o}function d(e){e.Td?(e.Bg||(e.Bg=ae.createBuffer()),ae.bindBuffer(ae.ELEMENT_ARRAY_BUFFER,e.Bg),ae.bufferData(ae.ELEMENT_ARRAY_BUFFER,e.Td,e.usage),e.sn=e.Td.byteLength):e.sn=0;for(var t=e.vn=0;t<e.Yb.length;t++){var a=e.Yb[t].type,r=M(e.fd,a);-1==r&&(e.fd.push({Lj:null,type:a,fO:W.$H()}),r=e.fd.length-1),a=e.fd[r],a.Lj||(a.Lj=ae.createBuffer()),ae.bindBuffer(ae.ARRAY_BUFFER,a.Lj),ae.bufferData(ae.ARRAY_BUFFER,e.Yb[t].cl,e.usage),e.vn+=e.Yb[t].cl.byteLength}}function p(e,t){e.la=j.nn(e.la,t),e.tb=j.Ux(e.tb,t),e.hc=j.et(e.hc,t),e.Uc=j.Vx(e.Uc,t)}function m(e){for(var t=e[0],a=e[0],r=L("JOIN_"+e.length+"_SUBMESHES"),n=0,o=0;o<e.length;o++)n+=e[o].qa.length;r.qa=new Uint32Array(n);var i=n=0;if(0<e[0].fb.length)for(var _=0;_<e[0].fb.length;_++){for(o=0;o<e.length;o++)n+=e[o].fb[_].Qf.a_position.length,i+=q.tu(e[o].fb[_].Qf.a_tbn);o={a_position:new Float32Array(n),a_tbn:q.create(i)},r.fb.push({Rq:e[0].fb[_].Rq,Qf:o})}for(o=n=0;o<e.length;o++)n+=e[o].Na;r.Na=n;for(var s in a.oa){for(o=n=0;o<e.length;o++)n+=e[o].oa[s].length;r.oa[s]=new Float32Array(n)}for(s in a.$[0]){for(o=n=0;o<e.length;o++)n+=e[o].$[0][s].length;for(o=0;o<a.$.length;o++)r.$[o]=r.$[o]||{},r.$[o][s]=new Float32Array(n)}for(o=r.Qc,o.la=j.rt(t.Qc.la),i=n=0,_=[],a=0;a<e.length;a++){var c=e[a],l=c.qa,f=c.Na,u=c.oa;for(s=c.Qc.hc,j.Yt(o.la,c.Qc.la),j.CO(o.hc,s),j.Hy(c.Qc.Uc,_),s=0;s<l.length;s++)r.qa[n+s]=l[s]+i;var d,n=n+l.length;for(d in u){var l=u[d],p=i*x(l,f);r.oa[d].set(l,p)}for(s=0;s<c.$.length;s++){var u=c.$[s],m=r.$[s];for(d in u)l=u[d],p=i*x(l,f),m[d].set(l,p)}i+=f}if(o.tb=j.zt(W.f32(_),!0),0<r.fb.length)for(a=0;a<r.fb.length;a++)for(d=r.fb[a].Qf,s=n=o=0;s<e.length;s++)i=e[s].fb[a].Qf,d.a_position.set(i.a_position,o),d.a_tbn.set(i.a_tbn,n),o+=i.a_position.length,n+=i.a_tbn.length;return e[0].Fe&&(r.Fe={$r:t.Fe.$r,UA:t.Fe.UA,BH:!0,vw:t.Fe.vw,so:t.Fe.so,St:t.Fe.St}),r}function g(e,t,a){t=t.Qc;for(var r=j.Be(),n=j.Et(),o=[],i=0;i<a.length;i++)j.nn(e.Qc.la,a[i],r),j.Yt(t.la,r),j.Vx(e.Qc.Uc,a[i],n),j.Hy(n,o);t.tb=j.zt(W.f32(o),!0),t.Uc=j.YM(t.tb),t.hc=j.Bt(t.tb)}function h(e,t,a,r,n,o){var _=e.submeshes[t],s=_.base_length,c=L("SUBMESH_"+e.name+"_"+e.materials[t].name);c.Na=s;var l=!1;if(E(a,"a_texcoord")){var f=null,u=e.materials[t];if(t=e.submeshes[t],u.texture_slots.length)switch(u=u.texture_slots[0],u.texture_coords){case"UV":f=b(t,u.uv_layer,e.name);break;case"ORCO":for(var d=e.b4w_boundings.bb_src,f=new Float32Array(2*t.base_length),u=(d.max_x+d.min_x)/2,p=(d.max_y+d.min_y)/2,m=d.max_x-d.min_x,d=d.max_y-d.min_y,g=0,h=0;h<t.position.length;h+=3)f[g++]=(t.position[h]-u)/m+.5,f[g++]=(t.position[h+1]-p)/d+.5}null===f&&(f=new Float32Array(2*t.base_length)),t=f}else t=new Float32Array(0);if(E(a,"a_orco_tex_coord")){for(var f=e.b4w_boundings.bb_src,u=new Float32Array(3*_.base_length),p=_.position,m=f.max_x-f.min_x,d=f.max_y-f.min_y,g=f.max_z-f.min_z,x=h=0;x<p.length;x+=3)u[h++]=m?W.clamp(parseFloat(((p[x]-f.min_x)/m).toFixed(5)),0,1):.5,u[h++]=d?W.clamp(parseFloat(((p[x+1]-f.min_y)/d).toFixed(5)),0,1):.5,u[h++]=g?W.clamp(parseFloat(((p[x+2]-f.min_z)/g).toFixed(5)),0,1):.5;f=u}else f=new Float32Array(0);if(u=_.group,E(a,"a_influence")&&r){for(p=new Float32Array(4*s),m=u.length/s,d=new Float32Array(m),g=0;g<m;g++){d[g]=-1;for(var T in r)if(h=r[T],h.DI===g){d[g]=h.wy;break}}x=3<m?m:4,r=new Float32Array(x),T=new Uint32Array(x);for(var g=new Float32Array(4),h=new Float32Array(x),x=new Uint32Array(x),y=new Float32Array(4),S=0;S<s;S++)r.set(h),T.set(x),g.set(y),p.set(A(u,m,S,s,d,r,T,g),4*S)}else p=new Float32Array(0);for(r=p,n=n?W.P(n):{},n.a_color={Vl:!0},n.a_color.src=E(a,"a_color")&&e.active_vcol_name?[{name:e.active_vcol_name,Dg:7}]:[],c.oa.a_texcoord=t,c.oa.a_influence=r,c.oa.a_orco_tex_coord=f,r=c.oa,T=_.vertex_colors,t=_.color,f=e.name,u=[],p=0;p<T.length;p++)u.push(T[p].name);for(var w in n)if(p=n[w].src,p.length){for(d=m=0;d<p.length;d++)m+=W.xm(p[d].Dg);for(r[w]=new Float32Array(m*s),d=g=0;d<p.length;d++){var R=p[d].name,h=p[d].Dg,x=W.JG(h),y=u.indexOf(R);if(-1==y)H.warn('vertex color "'+R+'" for mesh "'+f+'" not found'),S=7;else{for(var N,S=T[y].mask,I=N=0;I<y;I++)N+=W.xm(T[I].mask);N*=s}for(I=W.xm(S),(h&S)!==h&&H.error("Wrong color extraction from "+R+" to "+w+' for the mesh "'+f+'".'),R=0;R<s;R++)for(var M=0;3>M;M++)if(x[M]){var C=W.Ao(S,M);r[w][R*m+(g+W.Ao(h,M))]=-1==y?0:t[N+R*I+C]}g+=I}}else r[w]=new Float32Array(0);if(w=e.name,N=c.oa,o)for(var D in o)N[o[D]]=b(_,D,w);for(c.qa=new Uint32Array(_.indices),D=_.position.length/s/3,w=!(!E(a,"a_tbn")||!_.tbn.length),N=!(!E(a,"a_shade_tangs")||!_.shade_tangs.length),0<e.b4w_shape_keys.length&&(l=!0),n=0;n<D;n++){if(o=v(_,s,w,N,n),l){if(r={},r.name=e.b4w_shape_keys[n].name,c.fb.push(r),n){r.Qf=o,r.Rq=e.b4w_shape_keys[n].value;continue}r.Qf=v(_,s,w,N,n),r.Rq=1}c.$.push(o)}if(1<D&&!l){e=c.$[0],o={};for(var U in e)o[U]=new Float32Array(e[U]);c.$.push(o)}return E(a,"a_polyindex")&&(i(c,1,!0),c.oa.a_polyindex=O(c)),_=_.boundings,a=c.Qc,a.la=j.Be(),a.la.max_x=_.bb.max_x,a.la.max_y=_.bb.max_y,a.la.max_z=_.bb.max_z,a.la.min_x=_.bb.min_x,a.la.min_y=_.bb.min_y,a.la.min_z=_.bb.min_z,U=_.rbb,e=_.caxis_x,s=_.caxis_y,l=_.caxis_z,o=_.be_ax,a.tb=j.Ox(e,s,l,_.be_cen),Y.scale(a.tb.Ia,o[0],a.tb.Ia),Y.scale(a.tb.Ja,o[1],a.tb.Ja),Y.scale(a.tb.Ka,o[2],a.tb.Ka),a.hc=j.Bt(a.tb),Y.copy(U.rbb_c,a.Uc.N),Y.copy(e,a.Uc.Ia),Y.copy(s,a.Uc.Ja),Y.copy(l,a.Uc.Ka),_=U.rbb_s,Y.scale(a.Uc.Ia,_[0],a.Uc.Ia),Y.scale(a.Uc.Ja,_[1],a.Uc.Ja),Y.scale(a.Uc.Ka,_[2],a.Uc.Ka),c}function v(e,t,a,r,n){var o={},i=new Float32Array(3*t),_=q.create(a?t:0),s=n*t*3;return i.set(e.position.subarray(s,s+3*t),0),a&&q.copy(e.tbn,n*t,t,_),r&&(a=new Float32Array(3*t),a.set(e.shade_tangs.subarray(0,3*t),0),o.a_shade_tangs=a),o.a_position=i,o.a_tbn=_,o}function b(e,t,a){var r=2*e.base_length,n=e.uv_layers.indexOf(t);return-1==n?(H.warn('uv layer "'+t+'" for mesh "'+a+'" not found'),new Float32Array(r)):(t=n*r,e.texcoord.subarray(t,t+r))}function E(e,t){return-1<e.indexOf(t)}function A(t,a,r,n,o,i,_,s){for(var c=!0,l=0;l<a;l++){var f=t[l*n+r];if(-1!==f){var u=o[l];-1!==u&&(i[l]=f,_[l]=u,c=!1)}}if(c)return s;for(T(i,_,e.yx,!1),l=t=0;4>l;l++)t+=i[l];if(.01>t)return s;for(l=0;4>l;l++)i[l]/=t;if(.01>Math.abs(i[0]-1))s[0]=_[0]+1;else for(l=0;4>l;l++)s[l]=_[l]+i[l];return s}function x(e,t){if(0==t)return 0;var a=e.length,r=a/t;return r!=Math.floor(r)&&W.F("Array size mismatch during geometry calculation: array length="+a+", base length="+t),r}function T(t,a,r,n){for(var o=t.length,i=o,_=!1,s=n?-1:1;1<i||_;){1<i&&(i=Math.floor(i/1.247330950103979));for(var _=!1,c=0;i+c<o;c++)(r==e.yx?0>s*(t[c]-t[c+i]):t[c]<t[c+i]&&n)&&(_=t[c],t[c]=t[c+i],t[c+i]=_,_=a[c],a[c]=a[c+i],a[c+i]=_,_=!0)}}function y(e,t,a){var r=[],n=[];return Y.subtract(t,e,r),Y.subtract(a,e,n),Y.normalize(r,r),Y.normalize(n,n),e=W.clamp(Y.dot(r,n),-1,1),Math.acos(e)}function S(e,t){var a=[];if(o(t))for(var r=t.qa,n=r.length/3,i=0;i<n;i++){var _=new Float32Array(9),s=r[3*i];_[0]=e[3*s],_[1]=e[3*s+1],_[2]=e[3*s+2],s=r[3*i+1],_[3]=e[3*s],_[4]=e[3*s+1],_[5]=e[3*s+2],s=r[3*i+2],_[6]=e[3*s],_[7]=e[3*s+1],_[8]=e[3*s+2],a[i]=_}else for(i=0;i<e.length;i++)_=new Float32Array(9),_[0]=e[9*i],_[1]=e[9*i+1],_[2]=e[9*i+2],_[3]=e[9*i+3],_[4]=e[9*i+4],_[5]=e[9*i+5],_[6]=e[9*i+6],_[7]=e[9*i+7],_[8]=e[9*i+8],a[i]=_;return a}function O(e){for(var t=new Float32Array(e.Na),a=0;a<e.Na;a++)t[a]=a%3/2;return t}function w(e,t,a){var r=Y.dist(e,t);return e=Y.dist(e,a),t=Y.dist(t,a),(a=(r+e+t)/2)*(a-r)*(a-e)*(a-t)}function R(e){for(var t=new Float32Array([0,0,0,1,1,1,1,0]),a=new Float32Array(8*e),r=0;r<e;r++)a.set(t,8*r);return a}function L(e){return{name:e,Na:0,qa:null,$:[],oa:{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},fb:[],Qc:{la:j.Be(),tb:j.oq(),hc:j.At(),Uc:j.Et()},Fe:null}}function N(e){var t,a=[];for(t in e)a.push(I(t,e[t]));return a}function I(e,t){return{cl:new(U(e))(t),type:e}}function M(e,t){for(var a=0;a<e.length;a++)if(e[a].type==t)return a;return-1}function C(e,t){var a=M(e,t);return-1==a?null:e[a].Lj}function D(e,t){var a=M(e,t);return-1==a?null:e[a].cl}function U(e){switch(e){case"float":return Float32Array;case"short":return Int16Array;case"unsigned_byte":return Uint8Array;default:return Float32Array}}function k(e){switch(e=e.replace(/_next$/,""),e=e.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a")){case"a_tbn":case"a_shade_tangs":return"short";case"a_color":case"a_bending_col_main":case"a_bending_col_detail":case"a_grass_size":case"a_grass_color":case"param_GEOMETRY_VC_a":case"a_polyindex":case"a_p_bb_vertex":case"a_halo_bb_vertex":case"a_bb_vertex":return"unsigned_byte";default:return"float"}}function P(e,t,a,r){F(t,a,e[M(e,k(t))].cl.subarray(r))}function G(e,t,a){switch(k(e)){case"float":a.set(t);break;case"short":for(e=0;e<t.length;e++)a[e]=W.rH(t[e]);break;case"unsigned_byte":for(e=0;e<t.length;e++)a[e]=W.YH(t[e])}return a}function F(e,t,a){switch(k(e)){case"float":a.set(t);break;case"short":for(e=0;e<t.length;e++)a[e]=W.Hn(t[e]);break;case"unsigned_byte":for(e=0;e<t.length;e++)a[e]=W.ZH(t[e])}return a}var j=t("__boundings"),B=t("__extensions"),H=t("__print"),X=t("__quat"),q=t("__tbn"),z=t("__tsr"),W=t("__util"),Y=t("__vec3"),V=q.create(),J=q.create(),K=q.create(),Q=new Float32Array(3),Z=new Float32Array(3),$=new Float32Array(3),ee=X.create(),te=new Float32Array(8);e.op=10,e.ws=20,e.yx=0,e.ZV=1,e.Ym=e.op;var ae=null;e.an="float",e.bW="short",e.cW="unsigned_byte",e.bg=function(e){ae=e},e.IH=function(e,t,o){n(e)&&i(e);var _,c=e.qa,l=e.Na,p=e.$,m={};for(_ in e.oa)_ in o&&!o[_].Vl||(m[_]=e.oa[_]);if(o=s(),0<e.fb.length&&r(e,p[0]),_=e.Fe,c.length){var g=c.length;if(65536>=l)var c=new Uint16Array(c),h=ae.UNSIGNED_SHORT;else c=new Uint32Array(c),h=ae.UNSIGNED_INT}else g=l,c=null;for(var v=u(p,m,_),v=N(v),b={},E=0;E<v.length;E++)b[v[E].type]=0;var A,T={};for(A in m){var y=m[A],S=y.length;if(S){var O=k(A),E=T[A]=a();E.length=S,E.cc=x(y,l),E.offset=b[O],P(v,A,y,b[O]),b[O]+=S}}m=p.length;for(A in p[0])if(y=p[0][A],O=k(A),S=y.length,y=x(y,l),S)for(E=T[A]=a(),E.length=S,E.frames=m,E.cc=y,E.offset=b[O],1<m&&(E=T[A+"_next"]=a(),E.length=S,E.frames=m,E.cc=y,E.offset=b[O]+S),E=0;E<m;E++)y=p[E][A],O=k(A),P(v,A,y,b[O]),b[O]+=S;if(_){p=_.$r,A=_.UA;var w,m=_.so,S=_.vw,O=_.BH,l={a_part_ts:{data:[],cc:4},a_part_r:{data:[],cc:4}};for(w in m)l[w]={data:[],cc:m[w].cc};for(w in S)l[w]={data:[],cc:1};for(y=0;y<p.length;y++){E=p[y],O&&A&&!_.St&&(E=z.multiply(A,p[y],te)),!O&&_.St&&Y.subtract(p[y],A,p[y]),l.a_part_ts.data.push(E[0],E[1],E[2],E[3]),l.a_part_r.data.push(E[4],E[5],E[6],E[7]);for(w in m)for(var E=m[w].cc,R=0;R<E;R++)l[w].data.push(m[w].data[y*E+R]);for(w in S)l[w].data.push(S[w][0])}for(w in l)p=k(w),P(v,w,l[w].data,b[p]),A=a(),A.cc=l[w].cc,A.offset=b[p],A.Ml=1,A.length=l[w].data.length,T[w]=A,b[p]+=A.length;o.am=_.$r.length}return o.count=g,o.Td=c,o.Yb=v,o.Xl=h,o.xb=T,f(o,t),d(o),o.fb=e.fb,o},e.gU=r,e.HQ=n,e.GQ=o,e.uw=i,e.bI=function(e,t,a){f(e,t),e.count=a.length,e.Td=a,e.Xl=a instanceof Uint16Array?ae.UNSIGNED_SHORT:ae.UNSIGNED_INT},e.aI=c,e.Gy=l,e.iY=function(e){e.usage=ae.STATIC_DRAW},e.qR=function(e){e.usage=ae.DYNAMIC_DRAW},e.tB=d,e.ds=function(e,t,a,r){ae.bindBuffer(ae.ARRAY_BUFFER,e.fd[M(e.fd,t)].Lj),ae.bufferSubData(ae.ARRAY_BUFFER,W.xi*r,a)},e.CM=function(e){e.Bg&&ae.deleteBuffer(e.Bg);for(var t=0;t<e.fd.length;t++)e.fd[t].Lj&&ae.deleteBuffer(e.fd[t].Lj);e.fd.length=0},e.XE=function(e,t){return!e.submeshes[t].base_length},e.XA=function(e,t){for(var a=0;a<e.$.length;a++){var r=e.$[a].a_position;z.transform_vectors(r,t,r,0),r=e.$[a].a_tbn,q.WF(r,t,r),(r=e.$[a].a_shade_tangs)&&0<r.length&&z.transform_dir_vectors(r,t,r,0)}(a=e.oa.au_center_pos)&&a.length&&z.transform_vectors(a,t,a,0),p(e.Qc,t)},e.fU=function(e,t){var a=e.oa.au_center_pos;if(a&&a.length){var r=new Float32Array(a);z.transform_vectors(r,t,r,0);for(var n=0;n<e.$.length;n++)for(var o=0;o<r.length;o++)e.$[n].a_position[o]+=r[o]-a[o];a.set(r)}else W.F('Attribute "au_center_pos" is missing in particle submesh');p(e.Qc,t)},e.VL=p,e.eU=function(e,t){var a,r=e.Na;for(a in t){var n=t[a].length;e.oa[a]=new Float32Array(n*r);for(var o=0;o<r;o++)for(var i=0;i<n;i++)e.oa[a][o*n+i]=t[a][i]}},e.HH=m,e.rR=function(e,t,a){if(!e.Na)return L("EMPTY");var r=a.length;65536<e.Na*r&&!B.EE()&&i(e,r);var n,o=e.qa,_=e.Na,s=e.oa,c=e.$;for(n in t){var l=t[n].length,f=l*_;s[n]=new Float32Array(f);for(var u=0;u<_;u++)for(f=0;f<l;f++)s[n][u*l+f]=t[n][f]}for(t=L("CLONE_"+r+"_SUBMESHES"),t.Na=_*r,t.qa=new Uint32Array(o.length*r),u=0;u<r;u++)for(l=o.length*u,n=_*u,f=0;f<o.length;f++)t.qa[l+f]=o[f]+n;for(var d in s)for(o=s[d],f=o.length*r,l=x(o,_),t.oa[d]=new Float32Array(f),u=0;u<r;u++)n=_*l*u,t.oa[d].set(o,n);for(d in c[0])for(u=0;u<c.length;u++)for(o=c[u][d],f=o.length*r,l=x(o,_),t.$[u]=t.$[u]||{},t.$[u][d]=new Float32Array(f),f=0;f<r;f++)switch(s=a[f],n=_*l*f,d){case"a_position":z.transform_vectors(o,s,t.$[u][d],n);break;case"a_tbn":z.pU(o,s,t.$[u][d],n);break;case"a_shade_tangs":z.transform_tangents(o,s,t.$[u][d],n);break;default:W.F("Wrong attribute name: "+d)}return g(e,t,a),t},e.$C=g,e.$t=h,e.HO=function(e){var t=e.Na,a=e.$[0].a_position,r=new Float32Array(12*t);e=new Uint32Array(4*e.qa.length);for(var n=new Float32Array(4*t),o=0;o<t;o++){r[12*o]=a[3*o],r[12*o+1]=a[3*o+1],r[12*o+2]=a[3*o+2],r[12*o+3]=a[3*o],r[12*o+4]=a[3*o+1],r[12*o+5]=a[3*o+2],r[12*o+6]=a[3*o],r[12*o+7]=a[3*o+1],r[12*o+8]=a[3*o+2],r[12*o+9]=a[3*o],r[12*o+10]=a[3*o+1],r[12*o+11]=a[3*o+2],e[6*o]=4*o+2,e[6*o+1]=4*o+1,e[6*o+2]=4*o,e[6*o+3]=4*o+2,e[6*o+4]=4*o,e[6*o+5]=4*o+3;var i=Math.random();n[4*o]=i,n[4*o+1]=i,n[4*o+2]=i,n[4*o+3]=i}return a=L("HALO"),a.$[0]={},a.Na=4*t,a.$[0].a_position=r,a.oa.a_halo_bb_vertex=R(t),a.oa.a_random_vals=n,a.qa=e,a},e.hQ=E,e.gE=function(e,t,a){for(var r=[],n=0;n<e.submeshes.length;n++){var o=h(e,n,t,null,a,null);o.Na&&r.push(o)}return r.length?1==r.length?r[0]:m(r):L("EMPTY")},e.BU=function(e,t,a,r){var n=e.Td,o=l(e,"a_position"),i=t.zR,_=t.AR;t=t.nO;for(var s=n,c=s.length/3,f=0;f<c;f++){var u=s[3*f],d=s[3*f+1],p=s[3*f+2],m=o[3*u+1],g=o[3*u+2],h=o[3*d+1],v=o[3*d+2],b=o[3*p+1],E=o[3*p+2];i[3*f]=(o[3*u]+o[3*d]+o[3*p])/3,i[3*f+1]=(m+h+b)/3,i[3*f+2]=(g+v+E)/3}for(z.transform_vectors(i,a,_),a=_.length/3,o=0;o<a;o++)i=_[3*o]-r[0],s=_[3*o+1]-r[1],c=_[3*o+2]-r[2],t[o]=i*i+s*s+c*c;if(r=n,!(2>(n=t.length)))for(_=n,o=!1;1<_||o;)for(1<_&&(_=Math.floor(_/1.247330950103979)),o=!1,a=0;_+a<n;a++)0>t[a]-t[a+_]&&(o=t[a],t[a]=t[a+_],t[a+_]=o,o=r,i=a,s=a+_,c=o[3*i],f=o[3*i+1],u=o[3*i+2],o[3*i]=o[3*s],o[3*i+1]=o[3*s+1],o[3*i+2]=o[3*s+2],o[3*s]=c,o[3*s+1]=f,o[3*s+2]=u,o=!0);n=r,ae.bindBuffer(ae.ELEMENT_ARRAY_BUFFER,e.Bg),ae.bufferData(ae.ELEMENT_ARRAY_BUFFER,n,ae.DYNAMIC_DRAW)},e.PT=T,e.YC=function(e,t,a){for(var r=t.length/3,n=e.length/3,o=[],i=Array(3),_=Array(3),s=Array(3),c=0;c<n;c++){for(var l=e[3*c],f=e[3*c+1],u=e[3*c+2],d=0;3>d;d++)i[d]=t[3*l+d],_[d]=t[3*f+d],s[d]=t[3*u+d];if(a)var d=y(i,_,s),p=y(_,s,i),m=Math.PI-d-p;else m=p=d=1;var g,h=o;g=i;var v=s,b=[],E=[],A=[];for(Y.subtract(_,g,b),Y.subtract(v,g,E),Y.cross(b,E,A),Y.normalize(A,A),g=A,v=0;3>v;v++)b=3*f+v,E=3*u+v,h[3*l+v]=d*g[v],h[b]=p*g[v],h[E]=m*g[v]}if(a)for(var x in a)for(c=a[x],e=0;3>e;e++){for(t=3*c[0]+e,n=1;n<c.length;n++)i=3*c[n]+e,o[t]+=o[i];for(n=1;n<c.length;n++)i=3*c[n]+e,o[i]=o[t]}for(c=0;c<r;c++){for(a=c,x=o,e=new Float32Array(3),t=0;3>t;t++)n=3*a+t,e[t]=x[n];for(Y.normalize(e,e),t=0;3>t;t++)n=3*a+t,x[n]=e[t]}return o},e.ZC=function(e,t,a){for(var r={},n=t.length/3,o=0;o<n;o++){var i=String(t[3*o])+String(t[3*o+1])+String(t[3*o+2]);r[i]=[]}for(t=e.length,o=0;o<t;o++)n=e[o],(i=String(a[3*n])+String(a[3*n+1])+String(a[3*n+2]))in r&&r[i].push(n);return r},e.Ly=function(e,t,a,r){var n;if(n=S(e.$[0].a_position,e),a){var o;o=e.$[0].a_tbn;for(var i=q.tu(o),_=new Float32Array(3*i),s=0;s<i;s++){var c=q.mb(o,s,ee),c=Y.transformQuat(W.AXIS_Y,c,Q);_[3*s]=c[0],_[3*s+1]=c[1],_[3*s+2]=c[2]}o=S(_,e)}for(_=n.length,s=new Float32Array(_),i=Q,e=0;e<_;e++){var l=n[e];i.set(l.subarray(0,3)),Z.set(l.subarray(3,6)),$.set(l.subarray(6)),s[e]=Math.sqrt(w(i,Z,$))}for(i=new Float32Array(_),i[0]=s[0],e=1;e<_;e++)i[e]=i[e-1]+s[e];for(_=i[s.length-1],s=[],e=0;e<t;e++){var c=_*W.Jg(r),c=W.$s(i,c,0,i.length-1),l=a?o[c]:n[c],f=r;(c=Q)||(c=new Float32Array(3));var u=l[0],d=l[1],p=l[2],m=l[3],g=l[4],h=l[5],v=l[6],b=l[7],l=l[8],E=W.Jg(f),f=W.Jg(f);1<E+f&&(E=1-E,f=1-f);var A=1-E-f;c[0]=A*u+E*m+f*v,c[1]=A*d+E*g+f*b,c[2]=A*p+E*h+f*l,a?(s[e]=new Float32Array(4),Y.normalize(c,c),c=X.rotationTo(W.AXIS_Y,c,ee),s[e][0]=c[0],s[e][1]=c[1],s[e][2]=c[2],s[e][3]=c[3]):(s[e]=new Float32Array(3),s[e][0]=c[0],s[e][1]=c[1],s[e][2]=c[2])}return s},e.Zt=O,e.PY=w,e.pE=R,e.OG=function(e,t,a){e=e.$[0].a_position;for(var r=0;r<e.length;r+=3)e[r]=(e[r]-a[0])*t[0]+a[0],e[r+1]=(e[r+1]-a[1])*t[1]+a[1],e[r+2]=(e[r+2]-a[2])*t[2]+a[2]},e.Kx=function(e,t,a){var r=e.K[0].U;e=e.o.dg;for(var n=1;n<e.length;n++)e[n].name==t&&(e[n].value=a);for(n=0;n<r.length;n++)if(!r[n].wg&&r[n].Me&&!r[n].Ti){t=r[n].ga,a=k("a_position");var o=D(t.Yb,a);ae.bindBuffer(ae.ARRAY_BUFFER,C(t.fd,a));var i=t.xb.a_position;a=r[n];var _=e;if(i){for(var s=i.offset,i=i.length+s,c=a.ga.fb[0].Qf.a_position,l=s;l<i;l++)o[l]=c[l-s];for(l=1;l<a.ga.fb.length;l++){var c=a.ga.fb[l].Qf.a_position,f=_[l].value;if(f)for(var u=s;u<i;u++)o[u]+=f*c[u-s]}ae.bufferSubData(ae.ARRAY_BUFFER,W.xi*s,o.subarray(s))}if(o=k("a_tbn"),a=D(t.Yb,o),ae.bindBuffer(ae.ARRAY_BUFFER,C(t.fd,o)),s=t.xb.a_tbn,t=r[n],o=e,s){for(_=s.offset,s=s.length+_,i=t.ga.fb[0].Qf.a_tbn,l=_;l<s;l+=q.fC){for(c=q.identity(V),f=(l-_)/q.fC,u=1;u<t.ga.fb.length;u++){var d=o[u].value;if(d){var p=q.Wl(t.ga.fb[u].Qf.a_tbn,f,J),d=q.slerp(q.identity(K),p,d,J);q.vv(d,c,c)}}f=q.Wl(i,f,J),c=q.vv(c,f,J),a[l]=W.Hn(c[0]),a[l+1]=W.Hn(c[1]),a[l+2]=W.Hn(c[2]),a[l+3]=W.Hn(c[3])}ae.bufferSubData(ae.ARRAY_BUFFER,W.xi*_,a.subarray(_))}}},e.check_shape_keys=function(e){return e.o.Me},e.get_shape_keys_names=function(e){var t=[];if(e.o)for(var a=1;a<e.o.dg.length;a++)t.push(e.o.dg[a].name);return t},e.get_shape_key_value=function(e,t){if(e.o)for(var a=1;a<e.o.dg.length;a++)if(t==e.o.dg[a].name)return e.o.dg[a].value;return 0},e.fz=function(e,t){var a=e.o.dg;if(a)for(var r=1;r<a.length;r++)if(a[r].name==t)return!0;return!1},e.bj=function(e){return!!(e&&e.o&&e.o.fe)},e.draw_line=function(t,a,r){var n=t.ga;if(n){for(var o=r?a.length/3/2:a.length/3-1,i=new Float32Array(12*o),_=new Float32Array(12*o),s=new Uint16Array(6*o),c=0;c<o;c++){if(r)var l=6*c,f=6*c+3;else l=3*c,f=3*(c+1);var u=a[l],p=a[l+1],l=a[l+2],m=a[f],g=a[f+1],f=a[f+2],h=m-u,v=g-p,b=f-l;i[12*c]=u,i[12*c+1]=p,i[12*c+2]=l,_[12*c]=h,_[12*c+1]=v,_[12*c+2]=b,i[12*c+3]=m,i[12*c+4]=g,i[12*c+5]=f,_[12*c+3]=-h,_[12*c+4]=-v,_[12*c+5]=-b,i[12*c+6]=u,i[12*c+7]=p,i[12*c+8]=l,_[12*c+6]=-h,_[12*c+7]=-v,_[12*c+8]=-b,i[12*c+9]=m,i[12*c+10]=g,i[12*c+11]=f,_[12*c+9]=h,_[12*c+10]=v,_[12*c+11]=b,s[6*c]=4*c,s[6*c+1]=4*c+1,s[6*c+2]=4*c+2,s[6*c+3]=4*c,s[6*c+4]=4*c+3,s[6*c+5]=4*c+1}r=0;for(var E in n.xb)a=n.xb[E],r+=i.length/3*a.cc;a={},a.float=r,r=n.Yb=N(a),e.bI(n,t.bh,s),t=0;for(E in n.xb)switch(a=n.xb[E],E){case"a_position":P(r,E,i,t),a.offset=t,a.length=i.length,t+=a.length;break;case"a_direction":P(r,E,_,t),a.offset=t,a.length=_.length,t+=a.length;break;default:a.offset=t,a.length=i.length/3*a.cc,s=new Float32Array(a.length),P(r,E,s,t),t+=a.length}d(n)}},e.JM=function(e){if(e){var t=s();if(e.Td)switch(e.Xl){case ae.UNSIGNED_SHORT:t.Td=new Uint16Array(e.Td);break;case ae.UNSIGNED_INT:t.Td=new Uint32Array(e.Td)}else t.Td=null;for(var a=t,r=e.Yb,n=[],o=0;o<r.length;o++){var i=r[o].cl,_=r[o].type;n.push({cl:new i.constructor(i),type:_})}a.Yb=n,t.Xl=e.Xl,t.count=e.count,t.xb=W.P(e.xb),t.usage=e.usage,t.sn=e.sn,t.vn=e.vn,t.Bg=null,t.Ou=W.P(e.Ou),t.fb=W.P(e.fb),t.am=e.am,t.sg=e.sg}else t=null;return t},e.Cg=L,e.LM=function(e){var t=L(e.name);return t.Na=e.Na,t.qa=W.P(e.qa),t.$=W.P(e.$),t.oa=W.P(e.oa),t.fb=W.P(e.fb),j.$g(e.Qc.la,t.Qc.la),j.El(e.Qc.tb,t.Qc.tb),j.Pi(e.Qc.hc,t.Qc.hc),j.SM(e.Qc.Uc,t.Qc.Uc),t.Fe=W.P(e.Fe),t},e.reset=function(){ae=null},e.zQ=N,e.US=M,e.HX=C,e.Xy=D,e.zP=U,e.On=k,e.ME=function(e){switch(k(e)){case"float":return W.xi;case"short":return W.tp;case"unsigned_byte":return W.lx;default:return W.xi}},e.PP=function(e){switch(k(e)){case"float":return ae.FLOAT;case"short":return ae.SHORT;case"unsigned_byte":return ae.UNSIGNED_BYTE;default:return ae.FLOAT}},e.ps=P,e.UY=function(e,t){switch(k(e)){case"short":return W.rH(t);case"unsigned_byte":return W.YH(t)}return t},e.TY=function(e,t){switch(k(e)){case"short":return W.Hn(t);case"unsigned_byte":return W.ZH(t)}return t},e.GW=G,e.EW=F},a.module.__objects=function(e,t){function a(e){var t=e.K;e=e.o;for(var a=0;a<t.length;a++){var r=t[a].eb;r.G.outline&&e.sh&&j.ES(r)}}function r(e){e.o.sh=0,-1!=(e=ne.indexOf(e))&&ne.splice(e,1)}function n(e){if(e.Fn)for(var t=e.K,a=0;a<t.length;a++)j.eI(t[a].eb,e)}function o(e,t){for(var a=e.K,r=t.K,n=0;n<a.length;n++){for(var o=!1,_=0;_<r.length;_++)if(a[n].eb==r[_].eb){o=!0;break}o||i(t,a[n].eb)&&D.Bp(t,a[n].eb)}}function i(e,t){return!(!t.qC&&"SPEAKER"==e.type||!t.$K&&"LAMP"==e.type)}function _(e){var t=e.b4w_do_not_batch,a=e.b4w_collision,r=e.b4w_vehicle,n=e.b4w_floating,o=e.b4w_character,i=U.jQ(e),_=M.VC(e),c=0<e.data.b4w_shape_keys.length,f=e.b4w_dynamic_geometry,u=s(e);if(!(t=T.UC(e)||t||a||r||c||n||i||o||_||f))e:{for(e=e.data,t=0;t<e.materials.length;t++)if(a=e.materials[t],a.b4w_water||a.b4w_lens_flares||l(a.node_tree)){t=!0;break e}t=!1}return t||u}function s(e){var t=!1,a=e.constraints.length;if(a){for(var r=null,a=a-1;0<=a;a--){var n=e.constraints[a];if("LOCKED_TRACK"!=n.type||"REFLECTION PLANE"!=n.name){r=n;break}}if(!r||!r.target)return!1;if(e=r.target,r=e.type,e.parent)return r=e.parent.type,t="MESH"==r?t||_(e.parent):"EMPTY"!=r||(t||c(e.parent));t="MESH"==r?t||_(e):"EMPTY"!=r||(t||c(e))}return t}function c(e){var t=M.VC(e),a=e.b4w_do_not_batch,r=!!e.b4w_anchor,n=s(e);return T.UC(e)||t||a||r||n}function l(e){if(!e)return!1;e=e.nodes;for(var t=0;t<e.length;t++){var a=e[t];if("VECT_TRANSFORM"==a.type){var r=a.convert_from,n=a.convert_to,o=a.outputs[0];if(!(!o.is_linked||"WORLD"==r&&"CAMERA"==n||"CAMERA"==r&&"WORLD"==n||"OBJECT"==r&&"OBJECT"==n))return!0}if("NORMAL_MAP"==a.type&&(r=a.space,o=a.outputs[0],o.is_linked&&("OBJECT"==r||"BLENDER_OBJECT"==r))||"TEX_COORD"==a.type&&a.outputs[3].is_linked||"OBJECT_INFO"==a.type&&(o=a.outputs[1],r=a.outputs[3],a.outputs[0].is_linked||o.is_linked||r.is_linked))return!0}return!1}function f(e){if(m(e,ee.ALL,!1,-1)){for(var t,a=1;t="."+(3>String(a).length?("000"+String(a)).slice(-3):String(a)),m(e+t,ee.ALL,!1,-1);)a++;return P.error('Object "'+e+'" already exists. Name was replaced by "'+e+t+'".'),t}return""}function u(e,t,a){t=ee[t]||[];for(var r=[],n=0;n<t.length;n++){var o=t[n];if(o.o.Rd==a||-1==a)for(var i=o.K,_=0;_<i.length;_++)i[_].eb==e&&r.push(o)}return r}function d(e,t){var a=ee[e]||[];if(-1==t)return a;for(var r=[],n=0;n<a.length;n++){var o=a[n];o.o.Rd==t&&r.push(o)}return r}function p(e,t,a,r){for(var n=0;n<e.K.length;n++)for(var o=e.K[n].U,i=0;i<o.length;i++){var _=o[i];_.ga&&(_.ga.sg=t),_.sg=t,_.ib&&(_.ib.sg=a),""!==_.Wd&&(_=C.uu(_.Wd))&&(_.tD=r)}}function m(e,t,a,r,n){for(var o=null,i=0;i<t.length;i++){var _=t[i];if(!((a?_.qd:_.name)!=e||_.o.Rd!=r&&-1!=r||n&&_.pk||(o=_,D.get_dg_parent(o))))break}return o}function g(e){ee.ALL.push(e),ee[e.type]||(ee[e.type]=[]),ee[e.type].push(e);var t=e.o.zd;if(null!=t)for(var a=0;a<re.length;a++){var r=re[a];r.o.zd==t&&r.Cr.push(e)}}function h(e,t,a){if(!t.cj)return!0;if(e=e.tk,e.Vh!=e.Ae)if(e.ns){var r=Y.sign(e.Vh-e.Ae);e.Ae+=r*q.CP()/.4,e.Ae=Y.clamp(e.Ae,0,1)}else e.Ae=e.Vh;return r="STATIC"==t.type?t.dr:V.add(t.Pd.N,t.jv,oe),a=V.dist(r,a),0==e.Sn?(r=Math.max(t.Vf-e.Rn/2,0),t=t.Uf+e.Qn/2):-1==e.Sn?(r=t.Vf+e.Rn/2,t=t.Uf+e.Qn/2):(r=Math.max(t.Vf-e.Rn/2,0),t=Math.max(t.Uf-e.Qn/2,0)),e.Sn=a<r?-1:a<t?0:1,e.Vh=a<r||a>t?0:1,e.st=e.Vh?1:-1,Math.abs(a-e.Ov)>Z.lod_leap_smooth_threshold&&(0==e.Ae||1==e.Ae)&&(e.Ae=e.Vh),e.Ov=a,!!e.Vh||0!=e.Ae}function v(e,t){p(e,!0,!1,!0);for(var a=d("ALL",-1),r=0;r<a.length;r++){var n=a[r];n!=e&&p(n,!1,!1,!1)}for(j.EG(e,t),r=0;r<e.K.length;r++)for(n=e.K[r].U.length-1;0<=n;n--){var o=e.K[r].U[n];0!=o.Pb.length&&-1==o.Pb.indexOf(t)||D.PG(e.K[r],n)}for(k.na(e)&&k.remove_object(e),r=0;r<a.length;r++)a[r]!=e&&p(a[r],!0,!0,!0);return T.iO(e,t),a=e.Wg.Xa,e.Wg.Xa=e,a}function b(e,t){e.Wg.Xa=t,p(e,!0,!0,!0)}function E(e,t,a,r){var n=a.xc.Ak.indexOf(r);for(t=e.xc.Tj[e.xc.Ak.indexOf(t)],a.xc.Tj[n]=t,e=t.name,t.name=r,r=0;r<a.Wg.data.materials.length;r++)a.Wg.data.materials[r]=a.xc.Tj[r],a.xc.bm[r]=r!=n;return e}function A(e,t,a,r){for(var n=0;n<a.Wg.data.materials.length;n++)a.xc.bm[n]=!1;e.xc.Tj[e.xc.Ak.indexOf(t)].name=r}function x(e,t,a,r,n){for(var o=1;o<e.o.dg.length;o++)N.Kx(e,e.o.dg[o].name,e.o.dg[o].value);if(T.is_animated(e))for(o=0;o<e.ia.length;o++){var i=e.ia[o];if(i)switch(i.type){case T.OBJ_ANIM_TYPE_PARTICLES:T.set_frame(e,T.Py(e,o),o);break;case T.OBJ_ANIM_TYPE_MATERIAL:if(i.yk)for(var _=i.yk.length-1;0<=_;_--)-1!=i.yk[_].Pb.indexOf(t)&&i.yk.splice(_,1)}}r&&y.uz(e,t,function(t){if(t.Ba){var a=t.Ba.name;if(r[a]){var n=t.Ba.pn!=r[a].pn;t.Ba=U.wD(r[a]),n&&U.set_factor(e,a,t.Ba.pn)}}},"PARTICLES"),n&&(o=y.Va(e,t,"MAIN"))&&(o.ud.set(n.ud),o.Xh=n.Xh,o.Wh=n.Wh,o.nd.set(n.nd),o.ri.set(n.ri),o.Aj=n.Aj,o.qe.set(n.qe),o.Bm=n.Bm,o.dh=n.dh,o.Xg=n.Xg,o.mg=n.mg,o.mm=n.mm,o.no=n.no,o.reflect_factor=n.reflect_factor,o.yo=n.yo,o.Pf.set(n.Pf),o.parallax_scale=n.parallax_scale,o.Ng.set(n.Ng),o.shallow_water_col.set(n.shallow_water_col),o.shallow_water_col_fac=n.shallow_water_col_fac,o.shore_water_col.set(n.shore_water_col),o.shore_water_col_fac=n.shore_water_col_fac,o.foam_factor=n.foam_factor,o.hl=n.hl,o.oh=n.oh.slice(),o.Xd=n.Xd.slice()),y.uz(e,t,function(t){for(var r=0;r<t.We.length;r++){var n=t.We[r],o=t.fa[r];if("IMAGE"==o.source||"ENVIRONMENT"==o.source){var i=X.Wy(a,n);i&&o.jk!=i.jk&&X.zT(e,n,i)}}})}var T=t("__animation"),y=t("__batch"),S=t("__boundings"),O=t("__camera"),w=t("__config"),R=t("__constraints"),L=t("__container"),N=t("__geometry"),I=t("__lights"),M=t("__nla"),C=t("__nodemat"),D=t("__obj_util"),U=t("__particles"),k=t("__physics"),P=t("__print"),G=t("__primitives"),F=t("__quat"),j=t("__scenes"),B=t("__subscene"),H=t("__sfx"),X=t("__textures"),q=t("__time"),z=t("__transform"),W=t("__tsr"),Y=t("__util"),V=t("__vec3"),J=t("__armature"),K=t("__anchors"),Q=t("__renderer"),Z=w.H,$=w.Oc,ee={ALL:[]},te=0,ae=0,re=[],ne=[],oe=new Float32Array(3),ie=new Float32Array(4);e.tx=0,e.sx=1,e.Ac=2,e.DATA_ID_ALL=-1,e.update=function(e){for(var t=0;t<ne.length;t++){var n=ne[t],o=n,i=e,_=0,s=o.lG;if(0==s.Fw&&(s.Fw=i),i-=s.Fw,s.sA&&i/s.$f>=s.sA)r(o);else{if((i%=s.$f)<s.dA)switch(s=i/(s.dA/5),i=Math.floor(s)){case 0:_=(s-i)/2;break;case 1:_=(s-i)/2+.5;break;case 2:_=1;break;case 3:_=1-(s-i)/2;break;case 4:_=.5-(s-i)/2}o.o.sh=_}n.o.sh&&a(n)}if(e=ee.ARMATURE)for(t=0;t<e.length;t++)n=e[t],n.Vz&&(z.O(n),n.Vz=!1)},e.set_outline_intensity=function(e,t){e.o.sh=t,a(e)},e.apply_outline_anim=function(e,t,a,r){var n=e.lG;n.Fw=0,n.dA=t,n.$f=a,n.sA=r,-1==ne.indexOf(e)&&ne.push(e)},e.clear_outline_anim=r,e.$k=function(e,t){t.Kj=e.uuid,t.pk=!1,t.Kl=e.dn,t.is_dynamic=e.Ci,t.Uq=e.pC||!1,t.hf=e.b4w_vehicle,t.is_character=e.b4w_character,t.dm=e.b4w_floating,t.$o=e.b4w_collision,t.Zb=e.b4w_collision_id,t.yt=e.b4w_correct_bounding_offset;var a=e.game;for(t.uh={or:a.physics_type,ms:a.use_ghost,vI:a.use_sleep,Eg:a.mass,AI:a.velocity_min,zI:a.velocity_max,RD:a.damping,KG:a.rotation_damping,iR:a.lock_location_x,jR:a.lock_location_y,kR:a.lock_location_z,lR:a.lock_rotation_x,mR:a.lock_rotation_y,nR:a.lock_rotation_z,gq:a.collision_margin,cq:a.collision_group,hq:a.collision_mask,vB:a.use_collision_bounds,ut:a.collision_bounds_type,hs:a.use_collision_compound},(a=e.b4w_vehicle_settings)&&(t.tf={name:a.name,mf:a.part,iU:a.suspension_rest_length,YA:a.suspension_compression,$A:a.suspension_stiffness,ZA:a.suspension_damping,CB:a.wheel_friction,yA:a.roll_influence,Hz:a.max_suspension_travel_cm,Fq:a.force_max,Qp:a.brake_max,Ro:a.steering_max,co:a.max_speed_angle,tq:a.delta_tach_angle,Rr:a.speed_ratio,Tr:a.steering_ratio,Tq:a.inverse_control,Pl:a.floating_factor,Sm:a.water_lin_damp,Tm:a.water_rot_damp,KH:a.synchronize_position}),(a=e.b4w_floating_settings)&&(t.In={name:a.name,mf:a.part,Pl:a.floating_factor,Sm:a.water_lin_damp,Tm:a.water_rot_damp,KH:a.synchronize_position}),(a=e.b4w_character_settings)&&(t.gD={xV:a.walk_speed,QS:a.run_speed,bU:a.step_height,OQ:a.jump_strength,AV:a.waterline}),a=0;a<e.constraints.length;a++){var r=e.constraints[a];"RIGID_BODY_JOINT"==r.type&&t.kA.push({target:r.target.Xa,ZR:r.pivot_type,$R:r.pivot_x,aS:r.pivot_y,bS:r.pivot_z,Ia:r.axis_x,Ja:r.axis_y,Ka:r.axis_z,jV:r.use_limit_x,kV:r.use_limit_y,lV:r.use_limit_z,fV:r.use_angular_limit_x,gV:r.use_angular_limit_y,hV:r.use_angular_limit_z,$Q:r.limit_max_x,aR:r.limit_max_y,bR:r.limit_max_z,cR:r.limit_min_x,dR:r.limit_min_y,eR:r.limit_min_z,UQ:r.limit_angle_max_x,VQ:r.limit_angle_max_y,WQ:r.limit_angle_max_z,XQ:r.limit_angle_min_x,YQ:r.limit_angle_min_y,ZQ:r.limit_angle_min_z})}a=t.o=D.rn("MESH"===t.type?t.is_dynamic?"DYNAMIC":"STATIC":t.type),e.parent?(t.parent=e.parent.Xa,"BONE"==e.parent_type&&"ARMATURE"==e.parent.type&&(t.lr=e.parent_bone),e.pinverse_tsr&&(t.Lv=W.create(),W.copy(e.pinverse_tsr,t.Lv))):e.dg_parent&&(t.parent=e.dg_parent.Xa,t.Fk=!0);var r=e.location,n=e.scale[0];switch(Y.oA(e.rotation_quaternion,ie),z.set_translation(t,r),z.set_rotation(t,ie),z.set_scale(t,n),t.ks=e.b4w_use_default_animation,t.rl=T.Ix(e.b4w_anim_behavior),e.b4w_object_tags&&(t.ov={title:e.b4w_object_tags.title,description:e.b4w_object_tags.description,category:e.b4w_object_tags.category}),t.Jt=e.b4w_custom_prop,e.b4w_viewport_alignment&&(t.bx={cL:e.b4w_viewport_alignment.alignment,distance:e.b4w_viewport_alignment.distance}),a.hide=e.b4w_hidden_on_load,a.ZE=e.b4w_hide_chldr_on_load,e.type){case"ARMATURE":J.$k(e,t),r=a.qg,n=T.fM(r),e.b4w_animation_mixing?(a.Bd=new Float32Array(n.Fb),a.oe=new Float32Array(n.Fb),a.Jd=new Float32Array(n.trans),a.te=new Float32Array(n.trans)):(a.Bd=n.Fb,a.oe=n.Fb,a.Jd=n.trans,a.te=n.trans);for(var o in r){var i=r[o];1==i.ot.length&&J.AU(i,!0,n.trans,n.Fb)}a.sr=n,a.gf=0,a.Fi=e.b4w_animation_mixing;break;case"MESH":for(a.Ii=y.ML(e.data.b4w_boundings.bb),t.jF=e.data.is_boundings_overridden,a.An=e.b4w_do_not_render,a.Kk=$.outlining_overview_mode||e.b4w_selectable,a.Cv=e.b4w_selectable,a.Oc=$.outlining_overview_mode||e.b4w_outlining,a.Bv=e.b4w_outlining,a.Dv=$.outlining_overview_mode||e.b4w_outline_on_select,a.pg=e.b4w_billboard,a.Kp=e.b4w_pres_glob_orientation,a.Mp="BASIC",a.Lp="SPHERICAL"==e.b4w_billboard_geometry,o=a.ki,o.Bk=e.b4w_outline_settings.outline_duration,o.Ck=e.b4w_outline_settings.outline_period,o.Dk=e.b4w_outline_settings.outline_relapses,a.Kk&&(a.Wj=Y.qE(te),te++),o=0;o<e.data.b4w_vertex_anim.length;o++)r=e.data.b4w_vertex_anim[o],t.Rc.push({name:r.name,sa:r.frame_start,Za:r.frame_end,KW:r.averaging,LW:r.averaging_interval,dL:r.allow_nla});if(t.o.Rc=!!t.Rc.length,"MESH"!=e.type&&Y.F("Wrong object type: "+e.name),o=t.o,e.data.b4w_shape_keys.length)for(o.Me=!0,r=0;r<e.data.b4w_shape_keys.length;r++)n={},n.value=e.data.b4w_shape_keys[r].value,n.name=e.data.b4w_shape_keys[r].name,o.dg.push(n);else o.Me=!1;if(a.Je=e.b4w_shadow_cast,a.Gd=e.b4w_shadow_receive,a.pe=e.b4w_shadow_cast_only&&a.Je,a.Yd=e.b4w_reflexible,a.Dd=e.b4w_reflexible_only&&a.Yd,a.Cd=e.b4w_reflective,a.xh=e.b4w_reflection_type,!a.Cd)for(o=e.data.materials,r=0;r<o.length;r++)n=o[r],!n.use_nodes||-1==n.node_tree.Ls.indexOf("BSDF_GLOSSY")&&-1==n.node_tree.Ls.indexOf("BSDF_DIFFUSE")||(a.Cd=!0,a.xh="CUBE");if(a.Jf=e.b4w_caustics,(a.ve=e.b4w_wind_bending)&&(a.Wm=e.b4w_wind_bending_angle,o=y.MI(Y.deg_to_rad(e.b4w_wind_bending_angle),a.Ii,e.scale[0]),a.xf=o,a.yf=e.b4w_wind_bending_freq,a.df=e.b4w_detail_bending_freq,a.cf=e.b4w_detail_bending_amp,a.Xe=e.b4w_branch_bending_amp,a.kj=e.b4w_main_bend_stiffness_col,o=e.b4w_detail_bend_colors,a.Ce.yz=o.leaves_stiffness_col,a.Ce.xz=o.leaves_phase_col,a.Ce.eA=o.overall_stiffness_col),a.fe=e.b4w_dynamic_geometry,a.fe)for(t.Wg=e,o=0;o<e.data.materials.length;o++)r=e.data.materials[o],t.xc.Ak.push(r.name),t.xc.Tj.push(r),t.xc.bm.push(!1);"MESH"!==e.type&&Y.F("Wrong object"),o=e.data.materials[0],a.Ln=o.physics.friction,a.Dn=o.physics.elasticity,a.Vf=0,a.Uf=D.vx,a.Kv=e.pass_index;break;case"LINE":a.la=S.Be(),a.tb=S.oq(),a.og=S.Be(),a.Ji=S.oq();break;case"CAMERA":O.iM(e,t),O.DL(t);break;case"LAMP":I.PQ(e,t);break;case"SPEAKER":for(t.Z=H.uN(),a=!1,o=0;o<t.K.length;o++)if(t.K[o].eb.Hc){a=!0;break}a&&H.$k(e,t);break;case"EMPTY":o=S.Be(),a.la=o,o=S.At(),a.hc=o,e.field&&(t.Fn={type:e.field.type,FH:e.field.strength}),e.b4w_anchor&&(t.anchor={type:e.b4w_anchor.type,yn:e.b4w_anchor.detect_visibility,bk:e.b4w_anchor.element_id,xR:e.b4w_anchor.max_width})}g(t)},e.cV=function(e,t){t.Kj=e.uuid,t.pk=!1,t.Kl=e.dn,t.is_dynamic=e.Ci,t.o=D.rn(t.type),t.ks=e.b4w_use_default_animation,t.rl=T.Ix(e.b4w_anim_behavior),g(t)},e.OU=function(e,t){var a=t.o;if("MESH"==t.type){var r=T.BE(e);if(r){var n=r.Xa,i=n.o.sr,_=t.o,s=e.data;if(t.Ss=n,s=s.vertex_groups,s.length){var c,n=n.o.qg,l=0,f={};for(c in n){var u=Y.keysearch("name",c,s);u&&(f[c]={DI:u.index,Nh:n[c].Nh,wy:l++})}_.Oh=f,c=l,s=T.GE(),_.mh=c,c>2*s?(_.qk=!1,P.error('too many bones for "'+e.name+'" / '+_.mh+" bones (max "+s+" with blending, "+2*s+" without blending). Skinning will be disabled.")):_.qk=!0}i=T.IO(i.trans,i.Fb,a.Oh),r.b4w_animation_mixing?(a.Bd=new Float32Array(i.Fb),a.oe=new Float32Array(i.Fb),a.Jd=new Float32Array(i.trans),a.te=new Float32Array(i.trans)):(a.Bd=i.Fb,a.oe=i.Fb,a.Jd=i.trans,a.te=i.trans),a.Dp=new Float32Array(4),a.Cp=F.create(),a.sr=i,a.gf=0}if(a.Cd)if(a=t.o,"CUBE"==a.xh)a.Qd=ae++;else if("PLANE"==a.xh){e:{for(r=e.constraints,i=0;i<r.length;i++)if(_=r[i],"LOCKED_TRACK"==_.type&&"REFLECTION PLANE"==_.name){if(_.target&&_.target.Xa){r=_.target.Xa;break e}P.warn('Reflection plane target for object: "'+t.name+"\" is not present on the scene. Using object's Z-axis.")}r=null}for(r||(r=Y.cs("%reflection%"),r=D.qn(r,"EMPTY"),i=D.rn("EMPTY"),r.o=i,o(t,r),R.zC(r,t,[0,0,0],null,1),g(r)),i=null,_=0;_<re.length;_++)if(re[_]==r){i=_;break}null==i&&(i=re.length,re.push(r)),r.o.zd=i,a.zd=i,r.Cr.push(t)}}},e.GU=n,e.$W=o,e.rM=i,e.PU=function(e){for(var t=0;t<e.length;t++){var a=e[t];!a.o||"DYNAMIC"!=a.o.type&&"CAMERA"!=a.o.type||z.O(a),a.ks&&T.iG(a)&&(T.apply_def(a),a.ia.length&&T.play(a,null,T.SLOT_ALL))}},e.WC=function(e){if(e.b4w_hidden_on_load||e.dg_parent&&e.dg_parent.Ci||e.parent&&e.parent.Ci)return!0;switch(e.type){case"MESH":return _(e);case"EMPTY":return c(e);default:return!0}},e.get_meta_tags=function(e){return Y.P(e.ov)},e.get_custom_prop=function(e){return e.Jt},e.cleanup=function(){ae=te=0,re.length=0,ne.length=0,ee={ALL:[]}},e.copy=function(e,t,a){var r=D.get_dg_parent(e),r=r?D.rE(r.name,t):t,n=f(r);for(t=D.qn(r+n,e.type,t+n),t.pk=e.pk,t.Wg=e.Wg,t.xc.Ak=D.on(e.xc.Ak),t.xc.Tj=D.on(e.xc.Tj),t.xc.bm=D.on(e.xc.bm),t.is_dynamic=e.is_dynamic,t.Uq=e.Uq,t.ks=e.ks,t.Kl=e.Kl,t.o=D.fy(e.o),t.o.cj=!1,t.ov=D.nq(e.ov),t.Jt=D.nq(e.Jt),o(e,t),t.en=D.on(e.en),t.parent=D.on(e.parent),t.Fk=e.Fk,t.lr=e.lr,t.Rc=D.on(e.Rc),t.rl=e.rl,!e.I||e.hf||e.is_character||e.dm||(t.$o=e.$o,t.I=null),t.Zb=e.Zb,t.yt=e.yt,t.uh=D.nq(e.uh),r=[],n=0;n<e.K.length;n++){var i=t.K[n],_=e.K[n].U;if(a){for(var s=i.U,c=0;c<_.length;c++)if(!_[c].wg){var l=D.nq(_[c]);l.ga=N.JM(_[c].ga),D.Ff(t,i.eb,l),r.push(_[c].ga)}for(c=0;c<_.length;c++)if(_[c].wg){l=D.nq(_[c]),D.Ff(t,i.eb,l);for(var u=0;u<r.length;u++)r[u]==_[c].ga&&(l.ga=s[u].ga)}for(c=0;c<s.length;c++)s[c].ga&&N.tB(s[c].ga),Z.Gx&&s[c].ga&&Q.GL(s[c]),s[c].zk=y.mP(s[c],t.o,t.Kj),y.vU(s[c]);X.IT(s)}else for(c=0;c<_.length;c++)D.Ff(t,i.eb,_[c])}return D.DA(t,!1),g(t),t.o.qz=!0,t.o.Su=a,t.o.Wj=Y.qE(te),te++,t},e.CE=function(e,t){var a=[],r=e.animation_data,n=e.data?e.data.animation_data:null;return r&&r.action&&(r=r.action,(r.G.type==T.OBJ_ANIM_TYPE_OBJECT||r.G.type==T.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==e.type||r.G.type==T.YJ&&"LAMP"==e.type||r.G.type==T.XJ&&t)&&a.push(T.dF(null,r))),n&&n.action&&("SPEAKER"==e.type||"LAMP"==e.type)&&a.push(T.dF(null,n.action)),"MESH"==e.type&&a.push.apply(a,T.tP(e)),t&&a.push.apply(a,T.uP(e)),a},e.update_boundings=function(e){for(var t=e.o,a=null,r=e.K[0].U,n=0;n<r.length;n++){var o=r[n],i=e.K[0].If[n];if(o.ga&&i.ye&&i.ee){var _=N.On("a_position");if(_=N.Xy(o.ga.Yb,_)){var s=o.ga.xb.a_position.offset,c=o.ga.xb.a_position.length+s;y.JU(o,_.subarray(s,c)),D.mI(o,t.v,i),"MAIN"==o.type&&(a?S.Yt(a,o.Ta.ee):a=S.rt(o.Ta.ee))}}}if(a=a||S.Be(),t.pg)D.hI(e,a);else{for(i=[],n=0;n<r.length;n++)o=r[n],"MAIN"==o.type&&(_=N.On("a_position"),_=N.Xy(o.ga.Yb,_))&&(o=r[n].ga.xb,s=o.a_position.offset,c=o.a_position.length+s,i.push(_.subarray(s,c)));D.UU(e,a,i)}if(Z.debug_view)for(n=0;n<r.length;n++)if("DEBUG_VIEW"===r[n].type&&r[n].Ti){e=t.tb,t=G.Ky(1,e.N),N.OG(t,[e.Ia[0],e.Ja[1],e.Ka[2]],e.N),N.uw(t,1,!0),t.oa.a_polyindex=N.Zt(t),y.uU(r[n],t);break}},e.Hb=u,e.KE=function(e,t,a){t=ee[t]||[];for(var r=[],n=0;n<t.length;n++){var o=t[n];if(!(o.o.Rd!=a&&-1!=a||o.pk))for(var i=o.K,_=0;_<i.length;_++)i[_].eb==e&&r.push(o)}return r},e.get_all_objects=d,e.get_first_character=function(e){var t=ee.MESH;if(t)for(var a=0;a<t.length;a++){var r=t[a];if(k.VE(r))for(var n=r.K,o=0;o<n.length;o++)if(n[o].eb==e)return r}return null},e.qo=p,e.get_selectable_objects=function(){var e=[],t=ee.MESH;if(t)for(var a=0;a<t.length;a++){var r=t[a];r.o.Kk&&!r.pk&&e.push(r)}return e},e.get_outlining_objects=function(){var e=[],t=ee.MESH;if(t)for(var a=0;a<t.length;a++){var r=t[a];r.o.Oc&&!r.pk&&e.push(r)}return e},e.lc=function(t,a,r,n){var o=null,i=ee.ALL;switch(t){case e.tx:o=m(a,i,!0,r,n);break;case e.sx:e:{for(t=0;t<i.length;t++)if(o=i[t],o.qd==r&&(o.o.Rd==n||-1==n)){var _=D.get_dg_parent(o);if(_&&_.qd==a)break e}o=null}break;case e.Ac:e:{for(n=0;n<i.length;n++){t=i[n];for(var o=a.length-1,_=t,s=!0;0<=o&&s;)s=_&&_.qd==a[o]&&(_.o.Rd==r||-1==r),_&&(_=D.get_dg_parent(_)),o--;if(s&&!_){o=t;break e}}o=null}}return o},e.get_world_by_name=function(e,t){return m("%meta_world%"+e,ee.WORLD,!0,t)},e.xu=function(e){return e.qd.replace("%meta_world%","")},e.pick_object=function(t,a){var r=j.jh();if(!r)return P.error("No active scene"),null;var n=j.Ib(r,B.jg);if(n&&n.enable_hmd_stereo&&(n=L.get_canvas(),t=n.clientHeight/2,a=n.clientWidth/2),n=K.XR(t,a))return n;if(!(n=j.YR(r,t,a)))return null;for(var r=u(r,"MESH",-1),o=0;o<r.length;o++){var i=r[o].o,_=i.Wj;if(_&&3>Math.abs(255*_[0]-n[0])&&3>Math.abs(255*_[1]-n[1])&&3>Math.abs(255*_[2]-n[2]))return i.Oc&&i.Dv&&($.outlining_overview_mode?e.apply_outline_anim(r[o],$.Bk,$.Ck,$.Dk):(n=i.ki,e.apply_outline_anim(r[o],n.Bk,n.Ck,n.Dk))),r[o]}return null},e.set_wind_params=function(e,t){for(var a=u(e,"EMPTY",-1),r=0;r<a.length;r++){var o=a[r];if(o.Fn&&"WIND"===o.Fn.type){var i=o;break}}if(!i)return P.error("There is no wind on the scene"),0;"number"==typeof t.wind_dir&&(a=Y.deg_to_rad(t.wind_dir),V.set(Math.sin(a),-Math.cos(a),0,oe),Y.dir_to_quat(oe,Y.AXIS_Z,ie),z.set_rotation(i,ie)),"number"==typeof t.wind_strength&&(i.Fn.FH=t.wind_strength),n(i)},e.remove_object=function(e){R.sM(e)&&R.remove(e);var t=ee.ALL,a=ee[e.type],r=t.indexOf(e);e=a.indexOf(e),-1!=r&&t.splice(r,1),-1!=e&&a.splice(e,1)},e.MR=g,e.lY=function(e){return ee[e.type]&&-1<ee[e.type].indexOf(e)},e.KU=function(e,t){if(e.o.cj){var a=e.o,r=t.G;if(a.cj)for(var n=z.get_translation(t.Bi,oe),o=0;o<e.K.length;o++)if(e.K[o].eb==t)for(var i=0;i<e.K[o].U.length;i++){var _=e.K[o].U[i],s=_.tk;if(Z.lod_smooth_transitions){var c=r.oR;("ALL"==c||"NON-OPAQUE"==c&&(_.kb||_.Di))&&(s.ns=!0)}h(_,a,n),s.Ae=s.Vh,s.Rn=Math.min(r.IF,.6*a.ij),s.Qn=Math.min(r.IF,.6*a.jj)}}},e.LU=h,e.kT=function(e){var t=e.o,a=t.xf,r=t.yf,n=t.df,o=t.cf,i=t.Xe;for(e=e.K,t=0;t<e.length;t++)for(var _=e[t].U,s=0;s<_.length;s++){var c=_[s].ga,l=c.xb,f=l.au_wind_bending_amp,u=l.au_wind_bending_freq,d=l.au_detail_bending_amp,p=l.au_detail_bending_freq,l=l.au_branch_bending_amp;if(u){var m=Array.apply(null,Array(u.length)).map(function(){return r});N.ds(c,N.an,new Float32Array(m),u.offset)}f&&(m=Array.apply(null,Array(f.length)).map(function(){return a}),N.ds(c,N.an,new Float32Array(m),f.offset)),d&&(m=Array.apply(null,Array(d.length)).map(function(){return o}),N.ds(c,N.an,new Float32Array(m),d.offset)),p&&(m=Array.apply(null,Array(p.length)).map(function(){return n}),N.ds(c,N.an,new Float32Array(m),p.offset)),l&&(m=Array.apply(null,Array(l.length)).map(function(){return i}),N.ds(c,N.an,new Float32Array(m),l.offset))}},e.inherit_material=function(e,t,a,r){if(e.o.fe&&a.o.fe){var n=y.Va(e,t,"MAIN"),o=null;y.uz(a,r,function(e){o||(o={}),e.Ba&&(o[e.Ba.name]=e.Ba)},"PARTICLES");for(var i=v(a,r),_=E(e,t,a,r),s=j.get_active(),c=0;c<a.K.length;c++){var l=a.K[c].eb;j.set_active(l);var f=u(l,"LAMP",0),d=a.K[c].U;for(a.K[c].U=[],a.K[c].If=[],y.vE(l,[a.Wg],f,[]),y.Ct(a,j.ru(l),l),j.DC(l,[a]),j.append_object(l,a,!1,!0),f=0;f<d.length;f++)D.Ff(a,l,d[f])}A(e,t,a,_),b(a,i),x(a,r,e,o,n),j.set_active(s)}},e.create_line=function(e){return e=e||"",e+=f(e),e=D.qn(e,"LINE"),e.o=D.rn("EMPTY"),e.is_dynamic=!0,y.uE(j.jh(),[e]),j.append_object(j.jh(),e),g(e),e},e.lP=function(e,t){var a=t.o,r=S.rt(a.Ii);a.pg?D.hI(t,r):D.TU(t,r,e.data.b4w_boundings)},e.set_nodemat_value=function(e,t,a,r){for(var n=D.is_world(e),o=0;o<e.K.length;o++)for(var i=e.K[o].U,_=0;_<i.length;_++){var s=i[_];(n||-1!=s.Pb.indexOf(t))&&(s.oh[a]=r)}n&&j.Nw(e)},e.set_nodemat_rgb=function(e,t,a,r,n,o){for(var i=D.is_world(e),_=0;_<e.K.length;_++)for(var s=e.K[_].U,c=0;c<s.length;c++){var l=s[c];(i||-1!=l.Pb.indexOf(t))&&(l.Xd[3*a]=r,l.Xd[3*a+1]=n,l.Xd[3*a+2]=o)}i&&j.Nw(e)},e.get_nodemat_value=function(e,t){return e.oh[t]},e.get_nodemat_rgb=function(e,t,a){return a[0]=e.Xd[3*t],a[1]=e.Xd[3*t+1],a[2]=e.Xd[3*t+2],a},e.$h=function(e,t,a){var r=t[a];for(a+=1;a<t.length;a++)r+="%join%"+t[a];for(t=r,r=0;r<e.length;r+=2)if(e[r]==t)return e[r+1];return null}},a.module.__obj_util=function(e,t){function a(e){return e={type:e,Rd:0,v:m.Gl(),jx:m.Gl(),pivot:new Float32Array(3),mc:new Float32Array(3),kk:0,lk:0,qz:!1,Su:!1,Wj:null,sh:0,si:!1,Zd:h.create(),use_panning:!1,hb:0,fp:1,ep:1,gp:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,wd:!1,dof_object:null,Bb:null,Ha:null,vb:null,Mc:null,Lc:null,rd:null,tg:!0,ki:{Bk:1,Ck:1,Dk:0},Qd:-1,zd:-1,nc:new Float32Array(4),Ln:0,Dn:0,cj:!1,dr:new Float32Array(3),jv:new Float32Array(3),Vf:0,Uf:1/0,ij:0,jj:0,An:!1,Je:!1,Gd:!1,pe:!1,Yd:!1,Dd:!1,Cd:!1,xh:"",ve:!1,fe:!1,Dc:!1,hide:!1,ZE:!1,Kk:!1,Cv:!1,Oc:!1,Bv:!1,Dv:!1,nk:!1,is_visible:!1,Gq:!1,Wm:0,xf:0,yf:0,df:0,cf:0,Xe:0,kj:"",Ce:{yz:"",xz:"",eA:""},wl:!1,nt:new Float32Array(3),pg:!1,Kp:!1,Mp:"",Lp:!1,gf:0,Uw:0,Vw:0,mh:0,Sl:!1,Rc:!1,Me:!1,dg:[],qk:!1,Fi:!1,Ue:1,gn:0,fn:1,Ei:null,nh:!1,Mh:new Int8Array([-1,-1]),Go:[],nv:[],ew:[],Bd:null,oe:null,Jd:null,te:null,Vk:null,Gk:null,qg:null,Oh:null,sr:null,Dp:null,Cp:null,Ii:d.Be(),la:d.Be(),og:d.Be(),hc:d.At(),Pd:d.At(),tb:d.oq(),Ji:d.oq(),Uc:d.Et(),JC:d.Et(),Jp:d.uQ(),Hp:d.sQ(),Ip:d.tQ(),Kv:0},h.copy(g.AXIS_Z,e.Zd),e}function r(e){return{eb:e,Ru:!1,U:[],If:[],li:[],Ri:null,LA:[],cr:0,hG:!1,ba:[],pH:[]}}function n(e){if(!(e instanceof Object))return e;var t=null,a=null,r=null,o=null,i=null,_=null;e.fa&&(t=e.fa,e.fa=null),e.rf&&(a=e.rf,e.rf=null),e.We&&(r=e.We,e.We=null),e.fb&&(o=e.fb,e.fb=null),e.ib&&(i=e.ib,e.ib=null),e.Ne&&(_=e.Ne,e.Ne=null);var s;switch(s=e.constructor){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:s=new s(e);break;case Array:s=new s(e.length);for(var c=0;c<e.length;c++)s[c]=n(e[c]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:s=e;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:s=null;break;case Function:s=e;break;default:for(c in s=new s,e)s[c]=n(e[c])}return t&&(s.fa=t,e.fa=t),a&&(s.rf=a,e.rf=a),r&&(s.We=r,e.We=r),o&&(s.fb=o,e.fb=o),i&&(s.ib=i,e.ib=i),_&&(s.Ne=g.Yj(),e.Ne=_),s}function o(e,t){d.$g(t,e.la),d.nn(e.la,e.v,e.og)}function i(e,t,a){e.hc=d.XC(t,a),d.et(e.hc,e.v,e.Pd)}function _(e,t,a,r,n,o){e.tb=d.Ox(t,a,r,o),h.scale(e.tb.Ia,n[0],e.tb.Ia),h.scale(e.tb.Ja,n[1],e.tb.Ja),h.scale(e.tb.Ka,n[2],e.tb.Ka),d.Ux(e.tb,e.v,e.Ji)}function s(e,t,a,r){e.Jp=d.MC(t,r),e.Hp=d.KC(a,r),e.Ip=d.LC(t,r)}function c(e,t,a,r,n,o){e.Uc=d.KS(o,t,a,r,n),d.Vx(e.Uc,e.v,e.JC)}function l(e,t,a){d.nn(e.Ta.ee,t,a.ee),e.al&&d.Ux(e.Ta.ye,t,a.ye),d.et(e.Ta.ze,t,a.ze)}function f(e,t){for(var a=e.K,r=0;r<a.length;r++){var n=a[r];if(n.eb==t)return n}return null}function u(e){return e.Fk?e.parent:e.parent?u(e.parent):null}var d=t("__boundings"),p=t("__config"),m=t("__tsr"),g=t("__util"),h=t("__vec3"),v=t("__vec4"),b=p.H;e.vx=1/0;var E=m.create();e.rn=a,e.fy=function(e){var t=a(e.type);return t.Rd=e.Rd,m.copy(e.v,t.v),m.copy(e.jx,t.jx),h.copy(e.pivot,t.pivot),h.copy(e.mc,t.mc),t.kk=e.kk,t.lk=e.lk,t.qz=e.qz,t.Su=e.Su,e.Wj&&(t.Wj=h.clone(e.Wj)),t.sh=e.sh,t.si=e.si,h.copy(e.Zd,t.Zd),t.use_panning=e.use_panning,t.hb=e.hb,t.fp=e.fp,t.ep=e.ep,t.gp=e.gp,t.dof_distance=e.dof_distance,t.dof_front_start=e.dof_front_start,t.dof_front_end=e.dof_front_end,t.dof_rear_start=e.dof_rear_start,t.dof_rear_end=e.dof_rear_end,t.dof_power=e.dof_power,t.dof_bokeh_intensity=e.dof_bokeh_intensity,t.dof_bokeh=e.dof_bokeh,t.wd=e.wd,t.dof_object=e.dof_object,t.Bb=g.P(e.Bb),t.Ha=g.P(e.Ha),t.vb=g.P(e.vb),t.Mc=g.P(e.Mc),t.Lc=g.P(e.Lc),t.rd=e.rd,t.tg=e.tg,t.ki.Bk=e.ki.Bk,t.ki.Ck=e.ki.Ck,t.ki.Dk=e.ki.Dk,t.Qd=e.Qd,t.zd=e.zd,t.nc=e.nc,t.Ln=e.Ln,t.Dn=e.Dn,t.cj=e.cj,h.copy(e.dr,t.dr),h.copy(e.jv,t.jv),t.Vf=e.Vf,t.Uf=e.Uf,t.ij=e.ij,t.jj=e.jj,t.An=e.An,t.Je=e.Je,t.Gd=e.Gd,t.pe=e.pe,t.Yd=e.Yd,t.Dd=e.Dd,t.Cd=e.Cd,t.xh=e.xh,t.ve=e.ve,t.fe=e.fe,t.Dc=e.Dc,t.hide=e.hide,t.Kk=e.Kk,t.Cv=e.Cv,t.Oc=e.Oc,t.Bv=e.Bv,t.Dv=e.Dv,t.nk=e.nk,t.is_visible=e.is_visible,t.Gq=e.Gq,t.Wm=e.Wm,t.xf=e.xf,t.yf=e.yf,t.df=e.df,t.cf=e.cf,t.Xe=e.Xe,t.kj=e.kj,t.Ce=e.Ce,t.wl=e.wl,h.copy(e.nt,t.nt),t.pg=e.pg,t.Kp=e.Kp,t.Mp=e.Mp,t.Lp=e.Lp,t.gf=e.gf,t.Uw=e.Uw,t.Vw=e.Vw,t.mh=e.mh,t.Sl=e.Sl,t.Rc=e.Rc,t.Me=e.Me,t.dg=g.P(e.dg),t.qk=e.qk,t.Fi=e.Fi,t.Ue=e.Ue,t.gn=e.gn,t.fn=e.fn,t.Mh.set(e.Mh),t.Go=g.P(e.Go),t.nv=g.P(e.nv),t.ew=g.P(e.ew),t.Bd=g.P(e.Bd),t.oe=g.P(e.oe),t.Jd=g.P(e.Jd),t.te=g.P(e.te),t.qg=g.P(e.qg),t.Oh=g.P(e.Oh),t.sr=g.P(e.sr),t.Dp=g.P(e.Dp),t.Cp=g.P(e.Cp),d.$g(e.Ii,t.Ii),d.$g(e.la,t.la),d.$g(e.og,t.og),d.Pi(e.hc,t.hc),d.Pi(e.Pd,t.Pd),d.El(e.tb,t.tb),d.El(e.Ji,t.Ji),d.PM(e.Hp,t.Hp),d.RM(e.Jp,t.Jp),d.QM(e.Ip,t.Ip),t.Kv=e.Kv,t},e.qn=function(e,t,a){return a||(a=e),{name:e,Kj:g.lu(),qd:a,type:t,pk:!0,Wg:null,xc:{Ak:[],Tj:[],bm:[]},is_dynamic:!1,Uq:!1,ks:!1,jF:!1,o:null,ic:null,Z:null,wb:null,Ss:null,anchor:null,Fn:null,ov:null,Jt:null,K:[],Rc:[],Ze:g.Yj(),ky:g.Yj(),ia:[],Cr:[],jf:[],en:[],Ah:null,zm:[],parent:null,Fk:!1,lr:"",bx:null,Lv:null,$o:!1,Zb:"",yt:"AUTO",hf:!1,is_character:!1,dm:!1,Rx:!1,I:null,J:null,vg:null,tf:null,In:null,gD:null,kA:[],uh:{or:"NO_COLLISION",ms:!1,vI:!1,Eg:0,AI:0,zI:0,RD:0,KG:0,iR:!1,jR:!1,kR:!1,lR:!1,mR:!1,nR:!1,gq:0,cq:0,hq:0,vB:!1,ut:"BOX",hs:!1},lG:{Fw:0,dA:0,$f:0,sA:0},rl:0,Kl:[],Vz:!1,YF:!1,er:[]}},e.WX=r,e.on=function(e){return e instanceof Array?e.slice():e},e.nq=n,e.is_dynamic=function(e){return e.is_dynamic},e.gb=function(e){return"MESH"==e.type&&e.is_dynamic},e.Bp=function(e,t){e.K.push(r(t))},e.Ff=function(e,t,a){var r=e.o;e=f(e,t),e.U.push(a),t=d.eF(),r="STATIC"==r.type&&"COLOR_ID"==a.type?m.identity(E):r.v,l(a,r,t),e.If.push(t)},e.hI=function(e,t){var a=e.o,r=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),n=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),l=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),l=Math.sqrt(r*r+n*n+l*l),r=Math.sqrt(r*r+n*n),n=d.Be();n.max_x=n.max_y=n.max_z=l,n.min_x=n.min_y=n.min_z=-l,o(a,n),i(a,l,[0,0,0]),_(a,[1,0,0],[0,1,0],[0,0,1],[l,l,l],[0,0,0]),e.is_dynamic?s(a,r,r,n):c(a,[1,0,0],[0,1,0],[0,0,1],[l,l,l],[0,0,0])},e.TU=function(e,t,a){var r=e.o,n=a.bs_rad,l=a.bc_rad,f=a.bs_cen,u=a.be_cen,d=a.caxis_x,p=a.caxis_y,m=a.caxis_z,g=a.be_ax,h=a.rbb.rbb_c;a=a.rbb.rbb_s,o(r,t),i(r,n,f),t=e.is_dynamic,_(r,t?d:[1,0,0],t?p:[0,1,0],t?m:[0,0,1],g,u),e.is_dynamic?s(r,l,l,r.la):c(r,d,p,m,a,h)},e.UU=function(e,t,a){for(var r=e.o,n=t.max_x-t.min_x,l=t.max_y-t.min_y,f=t.max_z-t.min_z,u=(t.max_x+t.min_x)/2,d=(t.max_y+t.min_y)/2,p=(t.max_z+t.min_z)/2,m=u,g=p,h=Math.max(n,Math.max(l,f))/2,v=Math.max(n,f)/2,b=[u/(n||1),d/(l||1),p/(f||1)],E=.5,A=0;A<a.length;A++)for(var x=a[A],T=0;T<x.length;T+=3){var y=x[T],S=x[T+1],O=x[T+2],w=Math.sqrt((u-y)*(u-y)+(d-S)*(d-S)+(p-O)*(p-O));if(w>h)var R=u-h*(y-u)/w,L=d-h*(S-d)/w,w=p-h*(O-p)/w,u=(R+y)/2,d=(L+S)/2,p=(w+O)/2,h=Math.sqrt((u-y)*(u-y)+(d-S)*(d-S)+(p-O)*(p-O));L=Math.sqrt((m-y)*(m-y)+(g-O)*(g-O)),L>v&&(R=m-v*(y-m)/L,w=g-v*(O-g)/L,m=(R+y)/2,g=(w+O)/2,v=Math.sqrt((m-y)*(m-y)+(g-O)*(g-O))),y/=n||1,S/=l||1,O/=f||1,w=Math.sqrt((b[0]-y)*(b[0]-y)+(b[1]-S)*(b[1]-S)+(b[2]-O)*(b[2]-O)),w>E&&(R=b[0]-E*(y-b[0])/w,L=b[1]-E*(S-b[1])/w,w=b[2]-E*(O-b[2])/w,b[0]=(R+y)/2,b[1]=(L+S)/2,b[2]=(w+O)/2,E=Math.sqrt((b[0]-y)*(b[0]-y)+(b[1]-S)*(b[1]-S)+(b[2]-O)*(b[2]-O)))}a=n?n*b[0]:t.max_x,m=l?l*b[1]:t.max_y,b=f?f*b[2]:t.max_z,n*=E,l*=E,f*=E,o(r,t),i(r,h,[u,d,p]),_(r,[1,0,0],[0,1,0],[0,0,1],[n,l,f],[a,m,b]),e.is_dynamic?s(r,v,v,r.la):c(r,[(r.la.max_x-r.la.min_x)/2,0,0],[0,(r.la.max_y-r.la.min_y)/2,0],[0,0,(r.la.max_z-r.la.min_z)/2],[1,1,1],[(r.la.max_x+r.la.min_x)/2,(r.la.max_y+r.la.min_y)/2,(r.la.max_z+r.la.min_z)/2])},e.mI=l,e.qY=function(e,t){for(var a=e.K,r=0;r<a.length;r++)if(a[r].eb==t){a.splice(r,1);break}},e.ya=f,e.gI=function(e,t){for(var a=0;a<e.length;a++)v.copy(t,e[a].o.nc)},e.DA=function(e,t,a){for(var r=0;r<e.K.length;r++){var n=e.K[r];a&&n.eb!=a||(n.Ru=t)}},e.PG=function(e,t){e.U.splice(t,1),e.If.splice(t,1)},e.wu=function(e,t){for(var a=[],r=t?b.QF-1:b.QF,n=0;n<e.length;n++){var o=e[n];o.wb.wE&&a.length<r&&a.push(o)}return a.length?a:e[0]?[e[0]]:[]},e.BR=function(e,t){m.identity(t.v),t.Wj=null,e.o=t},e.jD=function(e,t){if(t.b4w_enable_soft_particles&&0<t.b4w_particles_softness){var a=t.material-1,r=e.data.materials;if(0<=a&&a<r.length&&("ADD"==r[a].game_settings.alpha_blend||"ALPHA"==r[a].game_settings.alpha_blend||"ALPHA_SORT"==r[a].game_settings.alpha_blend))return!0}return!1},e.xM=function(e){e=e.K;for(var t=0;t<e.length;t++)for(var a=e[t].U,r=0;r<a.length;r++)for(var n=a[r].Ra.ah,o=0;o<n.length;o++){var i=n[o];if("USE_MODEL_TSR_INVERSE"==i[0]&&"1"==i[1])return!0}return!1},e.rE=function(e,t){return e+"*"+t},e.get_parent=function(e){return e.Fk?null:e.parent},e.get_dg_parent=u,e.Qy=function(e,t){for(var a=[],r=0;r<t.length;r++){var n=t[r];u(n)==e&&a.push(n)}return a},e.get_object_data_id=function(e){return e.o.Rd},e.is_mesh=function(e){return"MESH"===e.type},e.is_armature=function(e){return"ARMATURE"===e.type},e.is_speaker=function(e){return"SPEAKER"===e.type},e.is_camera=function(e){return"CAMERA"===e.type},e.is_lamp=function(e){return"LAMP"===e.type},e.is_empty=function(e){return"EMPTY"===e.type},e.is_line=function(e){return"LINE"===e.type},e.is_world=function(e){return"WORLD"===e.type}},a.module.__particles=function(e,t){function a(){d.F("_rand() undefined")}function r(e,t){return{name:e,Fv:t,time:0,Pv:-1,ap:!1,pn:1,sa:0,Za:0,Ew:0,ar:0,cv:0,cyclic:0,Eg:0,lo:0,Au:0,Wi:0,De:0,ix:0,size:0,Ps:0,Os:0,wt:0,vt:new Float32Array(16),wv:!1,positions:null,ur:null,Aw:null,Vr:null,wn:null,sq:null,Lf:null,Ev:null,Cw:0,Dw:0}}function n(e,t,a,r,n,o){var i=e.wn,_=e.Lf,s=e.time;e=e.Pv;for(var l=0;l<i.length;l+=4){var f=i[l];if(s>e&&s>=f&&f>e||s<e&&(f>e||s>=f))for(f=0;8>f;f++)_[8*l+f]=r[f],h[f]=r[f];else for(f=0;8>f;f++)h[f]=_[8*l+f];f=v,f[0]=t[3*l],f[1]=t[3*l+1],f[2]=t[3*l+2],u.transform_vec3(f,h,f),n[3*l]=f[0],n[3*l+1]=f[1],n[3*l+2]=f[2];var d=c.Wl(a,l,g);for(c.WF(d,h,d),c.oi(o,d,l),f=1;4>f;f++)n[3*(l+f)]=n[3*l],n[3*(l+f)+1]=n[3*l+1],n[3*(l+f)+2]=n[3*l+2],c.oi(o,d,l+f)}}function o(e){e?(d.$T(e),a=function(){return d.oS()}):a=function(){return Math.random()}}var i=t("__config"),_=t("__batch"),s=t("__geometry"),c=t("__tbn"),l=t("__textures"),f=t("__time"),u=t("__tsr"),d=t("__util"),p=t("__vec3"),m=i.H,g=c.create(),h=new Float32Array(8),v=new Float32Array(3),b=[];e.wD=function(e){var t=r(e.name,e.type);return t.time=e.time,t.Pv=e.Pv,t.ap=e.ap,t.pn=e.pn,t.sa=e.sa,t.Za=e.Za,t.Ew=e.Ew,t.ar=e.ar,t.cv=e.cv,t.cyclic=e.cyclic,t.Eg=e.Eg,t.lo=e.lo,t.Au=e.Au,t.Wi=e.Wi,t.De=e.De,t.ix=e.ix,t.size=e.size,t.Ps=e.Ps,t.Os=e.Os,t.wt=e.wt,t.vt.set(e.vt),t.wv=e.wv,t.positions=d.P(e.positions),t.ur=d.P(e.ur),t.Aw=d.P(e.Aw),t.Vr=d.P(e.Vr),t.wn=d.P(e.wn),t.sq=d.P(e.sq),t.Lf=d.P(e.Lf),t.Ev=d.P(e.Ev),t.Cw=e.Cw,t.Dw=e.Dw,t},e.update=function(){for(var e=0;e<b.length;e++)for(var t=b[e],a=t.K,r=0;r<a.length;r++)for(var o=t,i=a[r].U,_=0;_<i.length;_++){var s=i[_],c=s.Ba;c&&c.ap&&!s.wg&&(n(c,c.positions,c.Aw,o.o.v,c.ur,c.Vr),c.wv=!0)}},e.Yz=function(e){e=e.K;for(var t=0;t<e.length;t++)for(var a=e[t].U,r=0;r<a.length;r++)if(a[r].Ba)return!0;return!1},e.Zz=function(e,t){for(var a=e.K,r=0;r<a.length;r++)for(var n=a[r].U,o=0;o<n.length;o++){var i=n[o].Ba;if(i&&i.name==t)return!0}return!1},e.gG=function(e){e=e.K;for(var t=0;t<e.length;t++)for(var a=e[t].U,r=0;r<a.length;r++){var n=a[r].Ba;if(n&&"EMITTER"==n.Fv)return!0}return!1},e.XL=function(e){return 0<e.particle_systems.length},e.WL=function(e){for(var t=0;t<e.particle_systems.length;t++)if("EMITTER"==e.particle_systems[t].settings.type)return!0;return!1},e.jQ=function(e){for(var t=0;t<e.particle_systems.length;t++){var a=e.particle_systems[t].settings;if("HAIR"==a.type&&a.b4w_dynamic_grass)return!0}return!1},e.oN=function(e,t,a){var n=e.Ba=r(t.name,t.settings.type);n.sa=t.settings.frame_start,n.Za=t.settings.frame_end,n.Ew=(n.Za-n.sa)/f.pd(),n.ar=t.settings.lifetime,n.cv=n.ar/f.pd(),n.cyclic=t.settings.b4w_cyclic?1:0,n.Eg=t.settings.mass,n.lo=t.settings.normal_factor,n.Au=9.81*t.settings.effector_weights.gravity,n.Wi=t.settings.b4w_fade_in/f.pd(),n.De=t.settings.b4w_fade_out/f.pd(),n.ix=t.settings.effector_weights.wind,n.ap="WORLD"==t.settings.b4w_coordinate_system;var o,i,s;if(e.Qq?(o=a.halo.size,i=a.halo.hardness,30>i?(i=.5,s=.9):40>i?(i=.1,s=1):50>i?(i=0,s=.8):(i=0,s=.5)):(o=t.settings.particle_size,s=i=1),n.size=o,n.Ps=i,n.Os=s,a.use_nodes&&"BILLBOARD"==t.settings.render_type&&(_.qb(e,"NODES",1),_.qb(e,"PARTICLE_BATCH",1),e.nb=!0),t=t.settings.texture_slots,t[0]&&t[0].use_map_size&&t[0].texture&&"BLEND"==t[0].texture.type&&t[0].texture.use_color_ramp&&m.Ns&&(t=t[0].texture,o=[],l.cM(t.color_ramp,l.dC,o),o=new Uint8Array(o.map(function(e){return d.clamp(255*e,0,255)})),o=l.HD(o,l.dC),_.Rj(e,o,"u_color_ramp_tex",t.name),_.qb(e,"USE_COLOR_RAMP",1)),a=a.texture_slots,e=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0],a[0]&&"STRAND"==a[0].texture_coords&&a[0].texture&&"BLEND"==a[0].texture.type&&a[0].texture.use_color_ramp){for(a=a[0].texture.color_ramp.elements,t=Math.min(4*a.length,e.length),o=0;o<t;o+=4)i=a[o/4],e[o]=i.position,e[o+1]=i.color[0],e[o+2]=i.color[1],e[o+3]=i.color[2];n.wt=a.length}n.vt.set(e)},e.gP=function(e,t,r,i){var _=e.Ba,l=i.v;i=r.settings.count;var u=r.settings.frame_start/f.pd(),m=r.settings.frame_end/f.pd(),h=r.settings.lifetime/f.pd(),v=r.settings.lifetime_random,b=r.settings.emit_from,E=r.settings.factor_random;if(r.settings.use_rotations)var A=r.settings.angular_velocity_mode,x=r.settings.angular_velocity_factor;else A="NONE",x=0;var T=r.settings.b4w_randomize_emission,y=r.settings.b4w_cyclic;_.Cw=r.settings.billboard_tilt,_.Dw=r.settings.billboard_tilt_random,o(r.seed);var S;switch(t=s.gE(t,["a_position","a_tbn"],null),b){case"VERT":var O=t.$[0].a_position;for(S=t.$[0].a_tbn,r=O.length/3,t=[],b=0;b<i;b++){var w=Math.round((r-1)*a());t.push(w),t.push(w),t.push(w),t.push(w)}for(r=[],b=0;b<t.length;b++)r.push(O[3*t[b]]),r.push(O[3*t[b]+1]),r.push(O[3*t[b]+2]);for(O=new Float32Array(r),r=c.create(t.length),b=0;b<t.length;b++)w=c.Wl(S,t[b],g),c.oi(r,w,b);S=r;break;case"FACE":for(O=[],S=[],d.Pu(0,S),r=s.Ly(t,i,!1,S),d.Pu(0,S),t=s.Ly(t,i,!0,S),S=c.create(4*r.length),b=0;b<r.length;b++)O.push(r[b][0],r[b][1],r[b][2]),O.push(r[b][0],r[b][1],r[b][2]),O.push(r[b][0],r[b][1],r[b][2]),O.push(r[b][0],r[b][1],r[b][2]),c.oi(S,t[b],4*b),c.oi(S,t[b],4*b+1),c.oi(S,t[b],4*b+2),c.oi(S,t[b],4*b+3);O=new Float32Array(O);break;case"VOLUME":d.F("Particle emission from volume is not supported");break;default:d.F("Wrong emit from option")}for(S=[O,S],O=S[0],S=S[1],_.positions=new Float32Array(O),_.Aw=new Float32Array(S),_.ur=new Float32Array(O.length),_.Vr=new Float32Array(S.length),t=[],m=(m-u)/i,r=0;r<i;r++)b=T?m*r+10*m*(.5-a()):m*r,y||(b+=u),t.push(b),t.push(b),t.push(b),t.push(b);if(u=new Float32Array(t),_.wn=new Float32Array(u),_.sq=new Float32Array(u),_.ap){for(_.Lf=new Float32Array(8*u.length),T=0;T<8*u.length;T++)for(y=0;8>y;y++)_.Lf[8*T+y]=l[y];n(_,O,S,l,O,S)}for(l=s.Cg("EMITTER_PARTICLES"),T=d.Sh(),T.a_position=O,T.a_tbn=S,l.$[0]=T,e.bh=s.ws,e=[],T=0;T<i;T++)e.push(4*T,4*T+2,4*T+1,4*T,4*T+3,4*T+2);for(e=new Uint16Array(e),l.qa=e,l.oa.a_p_bb_vertex=s.pE(i),l.Na=O.length/3,e=[],v*=h,T=0;T<i;T++)y=v*a(),e.push(h-y),e.push(h-y),e.push(h-y),e.push(h-y);for(h=l.oa,v=[],T=0;T<i;T++)y=Math.random(),v.push(e[4*T],u[4*T],y),v.push(e[4*T+1],u[4*T+1],y),v.push(e[4*T+2],u[4*T+2],y),v.push(e[4*T+3],u[4*T+3],y);for(v=new Float32Array(v),h.a_p_data=v,h=l.oa,v=[],e=0;e<i;e++){switch(u=[a()-.5,a()-.5,a()-.5],p.normalize(u,u),v.push(E*u[0]),v.push(E*u[1]),v.push(E*u[2]),A){case"NONE":v.push(0);break;case"SPIN":case"VELOCITY":v.push(x);break;case"RAND":v.push(2*x*(a()-.5));break;default:d.F("Undefined velocity factor")}for(u=v.slice(-4),T=0;12>T;T++)v.push(u[T%4])}return i=new Float32Array(v),h.a_p_vels=i,_.Ev=new Float32Array(l.oa.a_p_data),l},e.AT=function(e,t,a){e=e.K;for(var r=0;r<e.length;r++)for(var n=e[r].U,o=0;o<n.length;o++){var i=n[o].Ba;i&&i.name==t&&!n[o].wg&&(i.Pv=i.time,i.time=a)}},e.hS=function(e){for(var t=e.Na,a=e.$[0].a_position,r=[],n=[],o=0;o<t;o++)n.push(a[3*o]),r.push(a[3*o+1]),n.push(a[3*o+2]);return r=new Float32Array(r),n=new Float32Array(n),e.oa.a_lf_dist=r,e.oa.a_lf_bb_vertex=n,e},e.set_size=function(e,t,a){e=e.K;for(var r=0;r<e.length;r++)for(var n=e[r].U,o=0;o<n.length;o++){var i=n[o].Ba;i&&i.name==t&&(i.size=a)}},e.set_normal_factor=function(e,t,a){e=e.K;for(var r=0;r<e.length;r++)for(var n=e[r].U,o=0;o<n.length;o++){var i=n[o].Ba;i&&i.name==t&&(i.lo=a)}},e.DX=function(e,t){for(var a=e.K,r=0;r<a.length;r++)for(var n=a[r].U,o=0;o<n.length;o++){var i=n[o].Ba;if(i&&i.name==t)return i.lo}return 0},e.set_factor=function(e,t,a){e=e.K;for(var r=0;r<e.length;r++)for(var n=e[r].U,o=0;o<n.length;o++){var i=n[o],_=i.Ba;if(_&&_.name==t){_.pn=a;var c=_.wn;if(1==a)var l=c;else if(0==a)for(var l=_.sq,f=0;f<l.length;f+=4)l[f]=1e4,l[f+1]=l[f],l[f+2]=l[f],l[f+3]=l[f];else for(var u=4/a,l=_.sq,d=0,f=0;f<l.length;f+=4)f>=d?(l[f]=c[f],d+=u):l[f]=1e4,l[f+1]=l[f],l[f+2]=l[f],l[f+3]=l[f];if(i=i.ga,i.xb.a_p_data){for(_=_.Ev,f=0;f<_.length;f+=3)_[f+1]=l[Math.round(f/3)];s.aI(i,"a_p_data",3,_)}}}},e.aV=function(e,t,a){e=e.K;for(var r=0;r<e.length;r++)for(var n=e[r].U,o=0;o<n.length;o++){var i=n[o].Ba;if(i&&i.ap)for(var _=0;_<8*i.wn.length;_++)i.Lf[8*_]=t[0],i.Lf[8*_+1]=t[1],i.Lf[8*_+2]=t[2],i.Lf[8*_+3]=t[3],i.Lf[8*_+4]=a[0],i.Lf[8*_+5]=a[1],i.Lf[8*_+6]=a[2],i.Lf[8*_+7]=a[3]}},e.SU=function(e,t,a){if(e.oa.a_tbn=c.create(4*a),c.identity(e.oa.a_tbn),t.mr){for(var r=[],n=0;n<a;n++)r.push(n,n,n,n);e.oa[t.mr.name]=new Float32Array(r)}},e.RU=function(e){-1==b.indexOf(e)&&b.push(e)},e.tS=function(e){-1!=(e=b.indexOf(e))&&b.splice(e,1)},e.cleanup=function(){b.length=0}},a.module.__primitives=function(e,t){function a(e,t,a,r){for(var n=[],o=[],i=[],l=e*t,f=2*a/(e-1),u=2*r/(t-1),d=0;d<e;d++)for(var p=d*f-a,m=0;m<t;m++)if(o.push(p,m*u-r,0),i.push(d/(e-1),m/(t-1)),d&&m){var g=d*t+m,h=g-1,v=(d-1)*t+m,b=v-1;n.push(g,h,v),n.push(h,b,v)}return e=c.Sh(),e.a_position=new Float32Array(o),e.a_tbn=s.create(l),l=_.Cg("GRID_PLANE"),l.$[0]=e,l.oa.a_texcoord=new Float32Array(i),l.qa=new Uint32Array(n),l.Na=o.length/3,l}function r(e){var t=e.length;t%4&&c.F("Wrong array");for(var a=[],r=[],n=0;n<t;n+=4){var i=e[n+1],l=e[n+2],f=e[n+3];o(e[n],r),o(i,r),o(l,r),o(f,r),a.push(n,n+1,n+2),a.push(n,n+2,n+3)}return e=c.Sh(),e.a_position=new Float32Array(r),e.a_tbn=s.create(t/4),t=_.Cg("FROM_QUADS"),t.$[0]=e,t.qa=new Uint32Array(a),t.Na=r.length/3,t}function n(e,t){var a=3*t;return[e[a],e[a+1],e[a+2]]}function o(e,t){t.push(e[0],e[1],e[2])}var i=t("__config"),_=t("__geometry"),s=t("__tbn"),c=t("__util"),l=i.H;e.kP=function(){var e=_.Cg("LINE"),t=c.Sh();return t.a_position=new Float32Array(3),t.a_direction=new Float32Array(3),e.$[0]=t,e.qa=new Uint32Array(1),e.Na=1,e},e.nP=function(){var e=a(2,2,1,1);return e.name="PLANE",e},e.uX=a,e.eP=function(e,t,a){function r(e,t){return 1==e%2&&(0==t||t==f-1)||1==t%2&&(0==e||e==i-1)}var n=a/=Math.pow(2,e-1),o=a,i=t+1,f=t+1;t=[],a=[];for(var u=0,d=0,p=0,m=-1,g=[],h=0;h<e;h++){for(var v=2*n/(i-1),b=2*o/(f-1),E=[],A=[],x=0,T=0;T<i;T++){for(var y=T*v-n,S=[],O=0;O<f;O++){var w=O*b-o;if(y>-d&&y<d&&w>-p&&w<p)S.push(-1),x++;else{for(var R=null,L=0;L<g.length;L+=3)if(y==g[L]&&w==g[L+1]){R=g[L+2];break}if(L=null!==R?R:m+1,r(T,O)?(S.push(-2),x++):(null==R&&(O&&O!=f-1&&T&&T!=i-1?R=v:(R=h==e-1?v:2*v,E.push(y,w,L)),a.push(y,w,R),u++,m++),S.push(L)),T&&O)if(1==T)if(r(T-1,O)){if(1<O){var w=L-1,R=A[T-1][O+1],N=R-1;t.push(N,w,L)}else R=A[T-1][O+1],N=R-1;t.push(R,N,L)}else r(T,O)||(w=L-1,R=A[T-1][O],t.push(R,w,L));else if(T==i-1){if(!r(T,O))if(O==f-1)w=L-1,R=A[T-1][O-1],N=A[T-2][O],t.push(R,w,L),t.push(N,R,L);else{var w=L-1,R=A[T-1][O],N=R-1,I=R+1;t.push(N,w,L),t.push(R,N,L),t.push(I,R,L),2==O&&(I=A[T-2][O-2],t.push(N,I,w))}}else 1==O?r(T,O-1)?(w=A[T-1][O],R=A[T-1][O-1],t.push(w,R,L)):(w=S[O-1],R=A[T-1][O],N=A[T-2][O-1],t.push(R,w,L),t.push(R,N,w)):O==f-1?r(T,O)||(w=S[O-1],R=A[T-1][O-1],N=A[T-2][O],t.push(R,w,L),t.push(N,R,L)):-1!=A[T-1][O]&&-1!=A[T-1][O-1]&&-1!=S[O-1]?(w=S[O-1],R=A[T-1][O],N=A[T-1][O-1],t.push(R,w,L),t.push(R,N,w),O==f-2&&r(T,O+1)&&(I=A[T-1][O+1],t.push(I,R,L))):O==f-2&&r(T,O+1)&&(R=A[T-1][O],I=A[T-1][O+1],t.push(I,R,L))}}A.push(S)}g=E,d=n,p=o,n*=2,o*=2}return 2e4>d&&(e=-2*d/(i-1),a.push(-2e4,-2e4,e),a.push(-2e4,2e4,e),a.push(-d,-p,e),a.push(-d,p,e),a.push(2e4,-2e4,e),a.push(2e4,2e4,e),a.push(d,-p,e),a.push(d,p,e),L=m+1,t.push(L+1,L+2,L+3,L+1,L+0,L+2,L+2,L+4,L+6,L+2,L+0,L+4,L+1,L+7,L+5,L+1,L+3,L+7,L+7,L+4,L+5,L+6,L+4,L+7),u+=8),e=c.Sh(),e.a_position=new Float32Array(a),e.a_tbn=s.create(u),s.Sz(e.a_tbn,[.707,0,0,.707],e.a_tbn),n=_.Cg("MULTIGRID_PLANE"),n.$[0]=e,n.qa=new Uint32Array(t),n.Na=a.length/3,l.LI&&(_.uw(n,1,!0),e.a_polyindex=_.Zt(n)),n},e.tX=function(e){var t=e.length;t%3&&c.F("Wrong array");for(var a=[],r=[],n=0;n<t;n+=3){var i=e[n+1],s=e[n+2];o(e[n],r),o(i,r),o(s,r),a.push(n,n+1,n+2)}return e=c.Sh(),e.a_position=new Float32Array(r),t=_.Cg("FROM_TRIANGLES"),t.$[0]=e,t.qa=new Uint32Array(a),t.Na=r.length/3,t},e.sX=r,e.hP=function(e){e=c.pV(e);var t=[];return t.push(e[0],e[1],e[2],e[3]),t.push(e[0],e[3],e[5],e[4]),t.push(e[3],e[2],e[6],e[5]),t.push(e[1],e[7],e[6],e[2]),t.push(e[0],e[4],e[7],e[1]),t.push(e[4],e[5],e[6],e[7]),e=r(t),e.name="FRUSTUM",e},e.Zc=function(){var e=_.Cg("FULLSCREEN_TRI"),t=c.Sh();return t.a_position=new Float32Array([0,0,1,0,0,1]),e.$[0]=t,e.qa=new Uint32Array([0,1,2]),e.Na=3,e},e.iP=function(){var e=_.Cg("FULLSCREEN_QUAD"),t=c.Sh();return t.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]),e.$[0]=t,e.qa=new Uint32Array([0,2,1,1,2,3]),e.Na=4,e},e.dP=function(){var e=_.Cg("BILLBOARD"),t=c.Sh();return t.a_bb_vertex=_.pE(1),e.$[0]=t,e.qa=new Uint32Array([0,2,1,0,3,2]),e.Na=4,e},e.Ky=function(e,t){var a,r,i=_.Cg("UV_SPHERE"),c=[],l=[],f=[];for(r=0;8>=r;r++)for(a=0;16>=a;a++){var u=a/16,d=r/8;l.push(-e*Math.cos(2*u*Math.PI)*Math.sin(d*Math.PI)+t[0],e*Math.cos(d*Math.PI)+t[1],e*Math.sin(2*u*Math.PI)*Math.sin(d*Math.PI)+t[2])}for(r=u=0;8>r;r++)for(a=0;16>a;a++){var d=n(l,17*r+a+1),p=n(l,17*r+a),m=n(l,17*(r+1)+a),g=n(l,17*(r+1)+a+1);Math.abs(d[1])==e+t[1]?(o(d,c),o(m,c),o(g,c),f.push(u,u+1,u+2),u+=3):Math.abs(m[1])==e+t[1]?(o(d,c),o(p,c),o(m,c),f.push(u,u+1,u+2),u+=3):(o(d,c),o(p,c),o(m,c),o(g,c),f.push(u,u+1,u+2),f.push(u,u+2,u+3),u+=4)}return a={},a.a_position=c,l=_.ZC(f,l,c),l=_.YC(f,c,l),a.a_tbn=s.Tl(l),i.$[0]=a,i.qa=f,i.Na=c.length/3,i},e.tE=function(e){var t=_.Cg("INDEX"),a=c.Sh();a.a_index=new Float32Array(3*e);for(var r=new Uint16Array(3*e),n=0;n<3*e;n++)a.a_index[n]=n,r[n]=n;return t.$[0]=a,t.qa=r,t.Na=3*e,t}},a.module.__prerender=function(e,t){function a(e,t){var a=e.Yf;if(a.is_visible=!1,a.hide)return!1;var r=t.B,o=t.type==s.ld?r.fv:c.Cb(r.v,u),_=e.ra;if(!i.LU(_,a,o))return!1;if(a.is_visible=!0,t.type==s.Sg)_=t.debug_view_mode==n.DV_BOUNDINGS?_.Ti:!_.Ti;else{if(!(a=t.type==s.Tg&&0==a.sh)&&(a=!_.Vi&&e.DB)){var r=r.ih,o=e.DB.ze,a=e.DB.ye,f=_.al,_=o.N;if(l.VT(_,r,o.ab))a=!0;else if(f)var o=a.Ia,f=a.Ja,d=a.Ka,_=a.N,a=l.xO(_,r,o,f,d);else a=!1}_=!a}return _}function r(e){var t=e.Ba;if(t&&t.wv){e=e.ga,o.qR(e);var a=e.xb;o.ps(e.Yb,"a_position",t.ur,a.a_position.offset),o.ps(e.Yb,"a_tbn",t.Vr,a.a_tbn.offset),o.tB(e)}}var n=t("__debug"),o=t("__geometry"),i=t("__objects"),_=t("__renderer"),s=t("__subscene"),c=t("__tsr"),l=t("__util"),f=[s.Gb,s.Sc,s.Nd,s.kd,s.Bf,s.Qe,s.Md,s.ig,s.ld,s.Cf,s.Tg,s.Sg,s.we,s.Rg],u=new Float32Array(3);e.Nv=function(e){if(-1<f.indexOf(e.type)){for(var t=!1,n=e.type==s.kd||e.type==s.Qe,o=e.Pa,i=0;i<o.length;i++){for(var c=o[i],l=c.Ca,u=!1,d=0;d<l.length;d++){var p=l[d],m=p.ra;if(n)for(var g=0;6>g;g++)e.B.ih=e.Il[g],p.Ay[g]=a(p,e),p.Ay[g]&&(u=t=!0,r(m));else p.Vb=a(p,e),p.Vb&&(u=t=!0,r(m));e.Ea&&(m.ib.ko=!0)}c.Vb=u}switch(e.Ea=!1,e.type){case s.Sg:break;default:e.type==s.Gb||e.type==s.Cf||e.type==s.Md||e.type==s.Nd||e.type==s.kd||t?e.Vb=!0:(e.Vb&&_.clear(e),e.Vb=!1)}}else if(e.Ea){for(o=e.Pa,i=0;i<o.length;i++)for(l=o[i].Ca,d=0;d<l.length;d++)p=l[d],m=p.ra,m.ib.ko=!0;e.Ea=!1}e.hr&&s.OT(e)}},a.module.__print=function(e){function t(e,t){var a=[];-1<e[0].indexOf("%c")?a.push(e[0].replace("%c","%c"+t+": ")):a.push(t+": "+e[0]);for(var r=1;r<e.length;r++)a.push(e[r]);return a}function a(){i++;var e=t(arguments,"B4W ERROR");console.error.apply(console,e)}function r(e){e in s||(s[e]=e,a([e]))}function n(e,t){r(e+"() is deprecated, use "+t+"() instead.")}var o=!1,i=0,_=0,s={};e.BT=function(e){o=e},e.cd=function(){console.log.apply(console,arguments)},e.log=function(){if(o){var e=t(arguments,"B4W LOG");console.log.apply(console,e)}},e.zD=t,e.error=a,e.da=r,e.xd=n,e.hX=function(e,t){switch(1<t.length){case!0:r(e+"() is deprecated, use "+t.slice(0,-1).join("(), ")+"() or "+t[t.length-1]+"() instead.");break;case!1:n(e,t[0])}},e.Xt=function(e,t){r(void 0===t?'Config option "'+e+'" is deprecated.':'Config option "'+e+'" is deprecated, use "'+t+'" instead.')},e.warn=function(){_++;var e=t(arguments,"B4W WARN");console.warn.apply(console,e)},e.info=function(){var e=t(arguments,"B4W INFO");console.info.apply(console,e)},e.DO=function(){i++;var e=t(arguments,"B4W EXPORT ERROR");console.error.apply(console,e)},e.EO=function(){_++;var e=t(arguments,"B4W EXPORT WARNING");console.warn.apply(console,e)},e.time=function(){o&&console.time.apply(console,arguments)},e.timeEnd=function(){o&&console.timeEnd.apply(console,arguments)},e.group=function(){console.group.apply(console,arguments)},e.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)},e.groupEnd=function(){console.groupEnd.apply(console,arguments)},e.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)},e.cQ=function(){return _},e.FP=function(){return i},e.clear_errors_warnings=function(){i=_=0}},a.module.print=a.module.__print,a.module.__reformer=function(e,t){function a(e){switch(e.type){case"VALTORGB":e.color_ramp||(e.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},n("node Color Ramp",e,"color_ramp"));break;case"CURVE_RGB":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},n("node RGB Curves",e,"curve_mapping"));break;case"CURVE_VEC":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},n("node Vector Curves",e,"curve_mapping"));break;case"MAPPING":e.vector_type||(e.vector_type="POINT",n("node Mapping",e,"vector_type"));break;case"MATERIAL":case"MATERIAL_EXT":"alpha"in e||(e.alpha=1,n("node material",e,"alpha")),"darkness"in e||(e.darkness=1,n("node material",e,"darkness")),"diffuse_toon_size"in e||(e.diffuse_toon_size=.5,n("node material",e,"diffuse_toon_size")),"diffuse_toon_smooth"in e||(e.diffuse_toon_smooth=.1,n("node material",e,"diffuse_toon_smooth")),"diffuse_intensity"in e||(e.diffuse_intensity=1,n("node material",e,"diffuse_intensity")),"use_tangent_shading"in e||(e.use_tangent_shading=!1,n("node material",e,"use_tangent_shading")),"specular_shader"in e||(e.specular_shader="COOKTORR",n("node material",e,"specular_shader")),"specular_ior"in e||(e.specular_ior=4,n("node material",e,"specular_ior")),"specular_hardness"in e||(e.specular_hardness=50,n("node material",e,"specular_hardness")),"specular_slope"in e||(e.specular_slope=.1,n("node material",e,"specular_slope")),"specular_toon_size"in e||(e.specular_toon_size=.5,n("node material",e,"specular_toon_size")),"specular_toon_smooth"in e||(e.specular_toon_smooth=.1,n("node material",e,"specular_toon_smooth")),"specular_intensity"in e||(e.specular_intensity=.5,n("node material",e,"specular_intensity")),"diffuse_shader"in e||(e.diffuse_shader="LAMBERT",n("node material",e,"diffuse_shader")),"roughness"in e||(e.roughness=.5,n("node material",e,"roughness")),"diffuse_fresnel"in e||(e.diffuse_fresnel=.1,n("node material",e,"diffuse_fresnel")),"diffuse_fresnel_factor"in e||(e.diffuse_fresnel_factor=.5,n("node material",e,"diffuse_fresnel_factor"));break;case"MATH":case"MIX_RGB":"use_clamp"in e||(e.use_clamp=!1,n("node "+e.type,e,"use_clamp"));break;case"GROUP":switch(e.node_tree_name=e.node_tree_name.replace(/\.[0-9]{3,}$/g,""),e.node_tree_name){case"CLAMP":case"LEVELS_OF_QUALITY":case"LINEAR_TO_SRGB":case"NORMAL_VIEW":case"PARALLAX":case"REFLECT":case"REFRACTION":case"REPLACE":case"SMOOTHSTEP":case"SRGB_TO_LINEAR":case"TIME":case"TRANSLUCENCY":case"VECTOR_VIEW":e.node_tree_name="B4W_"+e.node_tree_name}break;case"VECT_TRANSFORM":"convert_from"in e||(e.convert_from="WORLD",n("node "+e.type,e,"convert_from")),"convert_to"in e||(e.convert_to="WORLD",n("node "+e.type,e,"convert_to")),"vector_type"in e||(e.vector_type="POINT",n("node "+e.type,e,"vector_type"))}}function r(e){if(e=e.nla_tracks)for(var t=0;t<e.length;t++)for(var a=e[t],r=0;r<a.strips.length;r++){var o=a.strips[r];"action"in o||(o.action=null,n("strip",o,"action")),"action_frame_start"in o||(o.action_frame_start=0,n("strip",o,"action_frame_start")),"action_frame_end"in o||(o.action_frame_end=o.frame_end-o.frame_start,n("strip",o,"action_frame_end")),"repeat"in o||(o.repeat=1,n("strip",o,"repeat")),"use_reverse"in o||(o.use_reverse=!1,n("strip",o,"use_reverse")),"scale"in o||(o.scale=1,n("strip",o,"scale"))}}function n(e,t,a){a=a+">>"+e,a in x||(x[a]={WA:[],HG:"undefined",type:e}),x[a].WA.push(t.name)}function o(e,t,a){a=a+">>"+e,a in x||(x[a]={WA:[],HG:"deprecated",type:e}),x[a].WA.push(t.name)}function i(e){u.warn(e)}function _(e,t){t||(t=e.name+"_COPY");var a=e.materials,r=e.submeshes;e.materials=null,e.submeshes=null;var n=m.P(e);for(e.materials=a,e.submeshes=r,n.name=t,n.materials=e.materials.slice(0),n.submeshes=[],a=0;a<r.length;a++){var o=m.aq(r[a]);n.submeshes.push(o)}return n}var s=t("__boundings"),c=t("__config"),l=t("__curve"),f=t("__mat4"),u=t("__print"),d=t("__quat"),p=t("__tbn"),m=t("__util"),g=t("__vec3"),h=t("__mat3"),v=t("__logic_nodes"),b=t("__animation"),E=c.H,A=[5,4],x={},T=h.create(),y=p.create(),S=d.create();e.kD=function(e){return-1!=m.BI(e,A)},e.qM=function(e){x={};var t=e.worlds;if(0==t.length){u.warn('WARNING Datablock world is missing, reexport "'+e.b4w_filepath_blend+'" scene');var _={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};t.push(_)}for(var s=0;s<t.length;s++){_=t[s],"use_sky_blend"in _||(n("world",_,"use_sky_blend"),_.use_sky_blend=!1),"use_sky_paper"in _||(n("world",_,"use_sky_paper"),_.use_sky_paper=!1),"use_sky_real"in _||(n("world",_,"use_sky_real"),_.use_sky_real=!1),"b4w_sky_settings"in _&&"rayleigh_brightness"in _.b4w_sky_settings||(n("world",_,"rayleigh_brightness"),_.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4}),"fog_settings"in _||(n("world",_,"fog_settings"),_.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in _&&(_.fog_settings.use_custom_color=!0,_.fog_settings.color=_.b4w_fog_color),"b4w_fog_density"in _&&0<_.b4w_fog_density&&(_.fog_settings.depth=1/_.b4w_fog_density)),"render_sky"in _.b4w_sky_settings||(n("world",_,"render_sky"),_.b4w_sky_settings.render_sky=!1);for(var c=_.texture_slots,l=0;l<c.length;l++){var f=c[l];"blend_type"in f||(f.blend_type="MIX",n("world_texture_slot",f,"blend_type")),"use_map_blend"in f||(f.use_map_blend=!1,n("world_texture_slot",f,"use_map_blend")),"use_map_horizon"in f||(f.use_map_horizon=!0,n("world_texture_slot",f,"use_map_horizon")),"use_map_zenith_up"in f||(f.use_map_zenith_up=!1,n("world_texture_slot",f,"use_map_zenith_up")),"use_rgb_to_intensity"in f||(f.use_rgb_to_intensity=!1,n("world_texture_slot",f,"use_rgb_to_intensity")),"invert"in f||(f.invert=!1,n("world_texture_slot",f,"invert")),"color"in f||(f.color=[1,0,1],n("world_texture_slot",f,"color")),"blend_factor"in f||(f.blend_factor=0,n("world_texture_slot",f,"blend_factor")),"horizon_factor"in f||(f.horizon_factor=1,n("world_texture_slot",f,"horizon_factor")),"zenith_up_factor"in f||(f.zenith_up_factor=0,n("world_texture_slot",f,"zenith_up_factor")),"zenith_down_factor"in f||(f.zenith_down_factor=0,n("world_texture_slot",f,"zenith_down_factor")),"default_value"in f||(f.default_value=1,n("world_texture_slot",f,"default_value"))}"b4w_use_default_animation"in _||(n("world",_,"b4w_use_default_animation"),_.b4w_use_default_animation=!1),"b4w_anim_behavior"in _||(n("world",_,"b4w_anim_behavior"),_.b4w_anim_behavior="CYCLIC")}for(l=e.scenes,s=0;s<l.length;s++)c=l[s],f=c.world,"timeline_markers"in c||(c.timeline_markers=null,n("scene",c,"timeline_markers")),"boolean"==typeof c.b4w_enable_physics&&(c.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in c||(c.b4w_reflection_quality="MEDIUM",n("scene",c,"b4w_reflection_quality")),"b4w_use_nla"in c||(c.b4w_use_nla=!1,n("scene",c,"b4w_use_nla")),"fps"in c||(c.fps=24,n("scene",c,"fps")),"b4w_nla_cyclic"in c||(c.b4w_nla_cyclic=!1,n("scene",c,"b4w_nla_cyclic")),"b4w_logic_nodes"in c||(c.b4w_logic_nodes=[],n("scene",c,"b4w_logic_nodes")),"b4w_detect_collisions"in c&&(o("scene",c,"b4w_detect_collisions"),delete c.b4w_detect_collisions),"audio_doppler_speed"in c||(c.audio_doppler_speed=343.3),"audio_doppler_factor"in c||(c.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in c||(c.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},n("scene",c,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in c||(c.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in c||(c.b4w_enable_bloom=!1,n("scene",c,"b4w_enable_bloom")),"b4w_enable_motion_blur"in c||(c.b4w_enable_motion_blur=!1,n("scene",c,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in c||(c.b4w_enable_color_correction=!1,n("scene",c,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in c||(c.b4w_antialiasing_quality="MEDIUM",n("scene",c,"b4w_antialiasing_quality")),"b4w_tags"in c||(c.b4w_tags={title:"",description:""},n("scene",c,"b4w_tags")),"b4w_lod_smooth_type"in c||(c.b4w_lod_smooth_type="OFF",n("scene",c,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in c||(c.b4w_lod_hyst_interval=0,n("scene",c,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in c||(c.b4w_enable_object_selection="AUTO",n("scene",c,"b4w_enable_object_selection")),"b4w_enable_outlining"in c||(c.b4w_enable_outlining="AUTO",n("scene",c,"b4w_enable_outlining")),"b4w_enable_glow_materials"in c||(c.b4w_enable_glow_materials="AUTO",n("scene",c,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in c||(c.b4w_enable_anchors_visibility="AUTO",n("scene",c,"b4w_enable_anchors_visibility")),"b4w_outline_color"in c||(c.b4w_outline_color=[1,1,1],n("scene",c,"b4w_outline_color")),"b4w_outline_factor"in c||(c.b4w_outline_factor="b4w_glow_factor"in c?c.b4w_glow_factor:1,n("scene",c,"b4w_outline_factor")),"b4w_shadow_settings"in c||(n("scene",c,"b4w_shadow_settings"),t=f.b4w_shadow_settings,c.b4w_shadow_settings=t||{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),t=c.b4w_shadow_settings,"csm_resolution"in t||(n("scene",c,"b4w_shadow_settings.csm_resolution"),t.csm_resolution=2048),"blur_samples"in t||(n("scene",c,"b4w_shadow_settings.blur_samples"),t.blur_samples="16x"),"soft_shadows"in t||(n("scene",c,"b4w_shadow_settings.soft_shadows"),t.soft_shadows=!0),"self_shadow_polygon_offset"in t||(n("scene",c,"b4w_shadow_settings.self_shadow_polygon_offset"),t.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in t||(n("scene",c,"b4w_shadow_settings.self_shadow_normal_offset"),t.self_shadow_normal_offset=.01),"b4w_enable_csm"in t||(n("scene",c,"b4w_shadow_settings.b4w_enable_csm"),t.b4w_enable_csm=!1),"csm_num"in t||(n("scene",c,"b4w_shadow_settings.csm_num"),t.csm_num=1),"csm_first_cascade_border"in t||(n("scene",c,"b4w_shadow_settings.csm_first_cascade_border"),t.csm_first_cascade_border=10),"first_cascade_blur_radius"in t||(n("scene",c,"b4w_shadow_settings.first_cascade_blur_radius"),t.first_cascade_blur_radius=3),"csm_last_cascade_border"in t||(n("scene",c,"b4w_shadow_settings.csm_last_cascade_border"),t.csm_last_cascade_border=100),"last_cascade_blur_radius"in t||(n("scene",c,"b4w_shadow_settings.last_cascade_blur_radius"),t.last_cascade_blur_radius=1.5),"fade_last_cascade"in t||(n("scene",c,"b4w_shadow_settings.fade_last_cascade"),t.fade_last_cascade=!0),"blend_between_cascades"in t||(n("scene",c,"b4w_shadow_settings.blend_between_cascades"),t.blend_between_cascades=!0),"b4w_ssao_settings"in c||(n("scene",c,"b4w_ssao_settings"),t=f.b4w_ssao_settings,c.b4w_ssao_settings=t||{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),t=c.b4w_ssao_settings,"dist_factor"in t||(n("scene",c,"b4w_ssao_settings.dist_factor"),t.dist_factor=0),"samples"in t||(n("scene",c,"b4w_ssao_settings.samples"),t.samples=16),"hemisphere"in t||(n("scene",c,"b4w_ssao_settings.hemisphere"),t.hemisphere=!1),"blur_depth"in t||(n("scene",c,"b4w_ssao_settings.blur_depth"),t.blur_depth=!1),"blur_discard_value"in t||(n("scene",c,"b4w_ssao_settings.blur_discard_value"),t.blur_discard_value=1),"b4w_bloom_settings"in c||(n("scene",c,"b4w_bloom_settings"),t=f.b4w_bloom_settings,c.b4w_bloom_settings=t||{key:.2,blur:4,edge_lum:1}),"key"in c.b4w_bloom_settings||(n("scene",c,"b4w_bloom_settings.key"),c.b4w_bloom_settings.key=.2),"blur"in c.b4w_bloom_settings||(n("scene",c,"b4w_bloom_settings.blur"),c.b4w_bloom_settings.blur=4),"edge_lum"in c.b4w_bloom_settings||(n("scene",c,"b4w_bloom_settings.edge_lum"),c.b4w_bloom_settings.edge_lum=1),"adaptive"in c.b4w_bloom_settings||(n("scene",c,"b4w_bloom_settings.adaptive"),c.b4w_bloom_settings.adaptive=!0),"average_luminance"in c.b4w_bloom_settings||(n("scene",c,"b4w_bloom_settings.average_luminance"),c.b4w_bloom_settings.average_luminance=.5),"b4w_motion_blur_settings"in c||(n("scene",c,"b4w_motion_blur_settings"),t=f.b4w_motion_blur_settings,c.b4w_motion_blur_settings=t||{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in c.b4w_motion_blur_settings||(n("scene",c,"b4w_motion_blur_settings.motion_blur_factor"),c.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in c.b4w_motion_blur_settings||(n("scene",c,"b4w_motion_blur_settings.motion_blur_decay_threshold"),c.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in c||(n("scene",c,"b4w_color_correction_settings"),t=f.b4w_color_correction_settings,c.b4w_color_correction_settings=t||{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in c||(n("scene",c,"b4w_god_rays_settings"),t=f.b4w_god_rays_settings,c.b4w_god_rays_settings=t||{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in c.b4w_god_rays_settings||(n("scene",c,"b4w_god_rays_settings.steps_per_pass"),c.b4w_god_rays_settings.steps_per_pass=10),"b4w_glow_settings"in c||(n("scene",c,"b4w_glow_settings"),c.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},t=c.b4w_glow_settings,"b4w_render_glow_over_blend"in f&&(t.render_glow_over_blend=f.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in f&&(t.small_glow_mask_coeff=f.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in f&&(t.large_glow_mask_coeff=f.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in f&&(t.small_glow_mask_width=f.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in f&&(t.large_glow_mask_width=f.b4w_large_glow_mask_width)),f=c.b4w_render_shadows,"AUTO"!=f&&"OFF"!=f&&"ON"!=f&&(c.b4w_render_shadows=f?"ON":"OFF"),f=c.b4w_render_reflections,"OFF"!=f&&"ON"!=f&&(c.b4w_render_reflections=f?"ON":"OFF"),f=c.b4w_render_refractions,"AUTO"!=f&&"OFF"!=f&&"ON"!=f&&(c.b4w_render_refractions=f?"ON":"OFF"),"b4w_render_dynamic_grass"in c||(n("scene",c,"b4w_render_dynamic_grass"),c.b4w_render_dynamic_grass="AUTO"),c.b4w_nla_script&&o("scene",c,"b4w_nla_script"),"audio_distance_model"in c||(n("scene",c,"audio_distance_model"),c.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in c||(n("scene",c,"b4w_custom_prop"),c.b4w_custom_prop=null);for(c=e.meshes,s=0;s<c.length;s++){f=c[s],f.b4w_boundings||(n("mesh",f,"b4w_boundings"),f.b4w_boundings={},t=f.b4w_boundings,t.bb=f.b4w_bounding_box?f.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},t.bb_src=f.b4w_bounding_box_source?f.b4w_bounding_box_source:f.b4w_bounding_box,t.bs_cen=f.b4w_bounding_sphere_center?f.b4w_bounding_sphere_center:[0,0,0],t.bc_cen=f.b4w_bounding_cylinder_center?f.b4w_bounding_cylinder_center:[0,0,0],t.be_cen=f.b4w_bounding_ellipsoid_center?f.b4w_bounding_ellipsoid_center:[0,0,0],f.b4w_bounding_ellipsoid_axes?t.be_ax=f.b4w_bounding_ellipsoid_axes:(l=t.bb,t.be_ax=[(l.max_x-l.min_x)/2,(l.max_y-l.min_y)/2,(l.max_z-l.min_z)/2]),f.b4w_rotated_bounding_box?t.rbb=f.b4w_rotated_bounding_box:(l=t.bb,t.rbb={rbb_c:[(l.max_x+l.min_x)/2,(l.max_y+l.min_y)/2,(l.max_z+l.min_z)/2],rbb_s:[1,1,1]}),t.caxis_x=f.b4w_cov_axis_x?f.b4w_cov_axis_x:[1,0,0],t.caxis_y=f.b4w_cov_axis_y?f.b4w_cov_axis_y:[0,1,0],t.caxis_z=f.b4w_cov_axis_z?f.b4w_cov_axis_z:[0,0,1]),"is_boundings_overridden"in f||(n("mesh",f,"is_boundings_overridden"),f.is_boundings_overridden=!1),"b4w_shape_keys"in f||(f.b4w_shape_keys=[],n("mesh",f,"b4w_shape_keys")),t=!0;for(_=0;_<f.submeshes.length;_++){var d=f.submeshes[_];"boundings"in d||(t=!1,d.boundings={be_ax:f.b4w_bounding_ellipsoid_axes,be_cen:f.b4w_bounding_ellipsoid_center,bb:{max_x:f.b4w_bounding_box.max_x,max_y:f.b4w_bounding_box.max_y,max_z:f.b4w_bounding_box.max_z,min_x:f.b4w_bounding_box.min_x,min_y:f.b4w_bounding_box.min_y,min_z:f.b4w_bounding_box.min_z}}),"uv_layers"in d||(n("submesh",f,"uv_layers"),d.uv_layers=f.uv_textures),"be_ax"in d.boundings||(d.boundings.be_ax=f.b4w_bounding_ellipsoid_axes),"be_cen"in d.boundings||(d.boundings.be_cen=f.b4w_bounding_ellipsoid_center),"bb"in d.boundings||(d.boundings.bb=f.b4w_bounding_box),"rbb"in d.boundings||(l=f.b4w_bounding_box,d.boundings.rbb={rbb_c:[(l.max_x+l.min_x)/2,(l.max_y+l.min_y)/2,(l.max_z+l.min_z)/2],rbb_s:[1,1,1]}),"caxis_x"in d.boundings||(d.boundings.caxis_x=[1,0,0]),"caxis_y"in d.boundings||(d.boundings.caxis_y=[0,1,0]),"caxis_z"in d.boundings||(d.boundings.caxis_z=[0,0,1])}for(t||n("mesh",f,"submesh_bd"),l=f,t=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],_=null,d=0;d<t.length;d++)l[t[d]]&&(_?(l[t[d]]=!1,u.warn('WARNING property "'+t[d]+'" of object "'+l.name+'" has been set to "false". Foreground property "'+_+'" already exists.')):_=t[d]);for(l=0;l<f.b4w_vertex_anim.length;l++)"allow_nla"in(t=f.b4w_vertex_anim[l])||(n('mesh["b4w_vertex_anim"]',f,"allow_nla"),t.allow_nla=!0)}for(l=e.cameras,s=0;s<l.length;s++)c=l[s],c.type||(c.type="PERSP",n("camera",c,"type")),"b4w_eye_target_dist"in c&&(delete c.b4w_eye_target_dist,o("camera",c,"b4w_eye_target_dist")),"b4w_hover_zero_level"in c||(c.b4w_hover_zero_level=0,n("camera",c,"b4w_hover_zero_level")),"b4w_trans_velocity"in c||(c.b4w_trans_velocity=1,n("camera",c,"b4w_trans_velocity")),"b4w_rot_velocity"in c||(c.b4w_rot_velocity=1,n("camera",c,"b4w_rot_velocity")),"b4w_zoom_velocity"in c||(c.b4w_zoom_velocity=.1,n("camera",c,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in c||(c.b4w_use_target_distance_limits=c.b4w_use_distance_limits||!1,n("camera",c,"b4w_use_target_distance_limits")),"b4w_use_zooming"in c||(c.b4w_use_zooming=c.b4w_use_distance_limits||!1,n("camera",c,"b4w_use_zooming")),"b4w_distance_min"in c||(c.b4w_distance_min=1,n("camera",c,"b4w_distance_min")),"b4w_distance_max"in c||(c.b4w_distance_max=100,n("camera",c,"b4w_distance_max")),"b4w_horizontal_translation_min"in c||(c.b4w_horizontal_translation_min=-100,n("camera",c,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in c||(c.b4w_horizontal_translation_max=100,n("camera",c,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in c||(c.b4w_vertical_translation_min=-100,n("camera",c,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in c||(c.b4w_vertical_translation_max=100,n("camera",c,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in c||(c.b4w_use_horizontal_clamping=!1,n("camera",c,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in c||(c.b4w_rotation_left_limit=-Math.PI,n("camera",c,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in c||(c.b4w_rotation_right_limit=Math.PI,n("camera",c,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in c||(c.b4w_horizontal_clamping_type="LOCAL",n("camera",c,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in c||(c.b4w_use_vertical_clamping=!1,n("camera",c,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in c||(c.b4w_rotation_down_limit=-Math.PI/2,n("camera",c,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in c||(c.b4w_rotation_up_limit=Math.PI/2,n("camera",c,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in c||(c.b4w_vertical_clamping_type="LOCAL",n("camera",c,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in c||(c.b4w_hover_angle_min=Math.PI/6,n("camera",c,"b4w_hover_angle_min")),"b4w_hover_angle_max"in c||(c.b4w_hover_angle_max=Math.PI/6,n("camera",c,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in c||(c.b4w_enable_hover_hor_rotation=!0,n("camera",c,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in c||(c.b4w_use_panning=!0,n("camera",c,"b4w_use_panning")),"b4w_use_pivot_limits"in c||(c.b4w_use_pivot_limits=!1,c.b4w_pivot_z_min=0,c.b4w_pivot_z_max=10,n("camera",c,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in c||(c.b4w_dof_bokeh=!1,n("camera",c,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in c||(c.b4w_dof_bokeh_intensity=.3,n("camera",c,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in c||(c.b4w_dof_foreground_blur=!1,n("camera",c,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in c||(c.b4w_dof_front_start=0,n("camera",c,"b4w_dof_front_start")),"b4w_dof_front_end"in c||(c.b4w_dof_front_end=c.b4w_dof_front,n("camera",c,"b4w_dof_front_end")),"b4w_dof_rear_start"in c||(c.b4w_dof_rear_start=0,n("camera",c,"b4w_dof_rear_start")),"b4w_dof_rear_end"in c||(c.b4w_dof_rear_end=c.b4w_dof_rear,n("camera",c,"b4w_dof_rear_end")),"sensor_fit"in c||(c.sensor_fit="VERTICAL",n("camera",c,"sensor_fit"));for(l=e.lamps,s=0;s<l.length;s++)c=l[s],"b4w_generate_shadows"in c||(c.b4w_generate_shadows=!1,n("lamp",c,"b4w_generate_shadows")),"b4w_dynamic_intensity"in c||(c.b4w_dynamic_intensity=!1,n("lamp",c,"b4w_dynamic_intensity")),"use_diffuse"in c||(c.use_diffuse=!0,n("lamp",c,"use_diffuse")),"use_specular"in c||(c.use_specular=!0,n("lamp",c,"use_specular")),"clip_start"in c||(c.clip_start=.1,n("lamp",c,"clip_start")),"clip_end"in c||(c.clip_end=30,n("lamp",c,"clip_end")),"POINT"!=c.type&&"SPOT"!=c.type||"use_sphere"in c||(c.use_sphere=!1,n("lamp",c,"use_sphere"));for(l=e.speakers,s=0;s<l.length;s++)c=l[s],"b4w_behavior"in c||(c.b4w_behavior=c.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in c||(c.b4w_auto_play=!1,n("speaker",c,"b4w_auto_play")),"b4w_enable_doppler"in c||(c.b4w_enable_doppler=!1,n("speaker",c,"b4w_enable_doppler")),"b4w_delay"in c||(c.b4w_delay=0),"b4w_delay_random"in c||(c.b4w_delay_random=0),"b4w_volume_random"in c||(c.b4w_volume_random=0),"b4w_pitch_random"in c||(c.b4w_pitch_random=0),"b4w_fade_in"in c||(c.b4w_fade_in=0),"b4w_fade_out"in c||(c.b4w_fade_out=0),"b4w_loop"in c||(c.b4w_loop=!1),"b4w_loop_start"in c||(c.b4w_loop_start=0,n("speaker",c,"b4w_loop_start")),"b4w_loop_end"in c||(c.b4w_loop_end=0,n("speaker",c,"b4w_loop_end")),c.animation_data&&r(c.animation_data);for(l=e.textures,s=0;s<l.length;s++)c=l[s],"b4w_anisotropic_filtering"in c||(c.b4w_anisotropic_filtering="OFF",n("texture",c,"b4w_anisotropic_filtering")),"b4w_water_foam"in c||(c.b4w_water_foam=!1,n("texture",c,"b4w_water_foam")),"b4w_foam_uv_freq"in c||(c.b4w_foam_uv_freq=[1,1],n("texture",c,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in c||(c.b4w_foam_uv_magnitude=[1,1],n("texture",c,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in c||(c.b4w_parallax_steps=5,n("material",c,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in c||(c.b4w_parallax_lod_dist=10,n("material",c,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in c||(c.b4w_shore_dist_map=!1,n("texture",c,"b4w_shore_dist_map")),"b4w_shore_boundings"in c||(c.b4w_shore_boundings=[1e3,-1e3,1e3,-1e3],n("texture",c,"b4w_shore_boundings")),"b4w_max_shore_dist"in c||(c.b4w_max_shore_dist=100,n("texture",c,"b4w_max_shore_dist")),"b4w_disable_compression"in c||(c.b4w_disable_compression=!1,n("texture",c,"b4w_disable_compression")),"b4w_source_type"in c||(c.b4w_source_type="",n("texture",c,"b4w_source_type")),"b4w_source_id"in c||(c.b4w_source_id="",n("texture",c,"b4w_source_id")),"b4w_source_size"in c||(c.b4w_source_size=1024,n("texture",c,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in c||(c.b4w_enable_canvas_mipmapping=!0,n("texture",c,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in c||(c.b4w_nla_video=!1,n("texture",c,"b4w_nla_video"));for(l=e.images,s=0;s<l.length;s++)"colorspace_settings_name"in(c=l[s])||(c.colorspace_settings_name="sRGB",n("image",c,"colorspace_settings_name"));for(t=e.materials,s=0;s<t.length;s++){_=t[s],"ALPHA_ANTIALIASING"==_.game_settings.alpha_blend&&(E.NF?_.game_settings.alpha_blend="CLIP":2>E.Rb&&(u.warn('Material "'+_.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),_.game_settings.alpha_blend="CLIP")),"use_tangent_shading"in _||(_.use_tangent_shading=!1,n("material",_,"use_tangent_shading")),"b4w_node_mat_type"in _&&o("material",_,"b4w_node_mat_type"),"b4w_skydome"in _&&o("material",_,"b4w_skydome"),"b4w_procedural_skydome"in _&&o("material",_,"b4w_procedural_skydome"),"b4w_lens_flares"in _||(_.b4w_lens_flares=!1,n("material",_,"b4w_lens_flares")),"LENS_FLARES"===_.name&&(_.b4w_lens_flares||u.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),_.b4w_lens_flares=!0),_.b4w_water&&("b4w_water_shore_smoothing"in _||(_.b4w_water_shore_smoothing=!1,n("material",_,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in _||(_.b4w_water_dynamic=!1,n("material",_,"b4w_water_dynamic")),"b4w_waves_height"in _||(_.b4w_waves_height=1,n("material",_,"b4w_waves_height")),"b4w_waves_length"in _||(_.b4w_waves_length=1,n("material",_,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in _||(_.b4w_water_dst_noise_scale0=.05,n("material",_,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in _||(_.b4w_water_dst_noise_scale1=.03,n("material",_,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in _||(_.b4w_water_dst_noise_freq0=1.3,n("material",_,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in _||(_.b4w_water_dst_noise_freq1=1,n("material",_,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in _||(_.b4w_water_dir_min_shore_fac=.4,n("material",_,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in _||(_.b4w_water_dir_freq=.5,n("material",_,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in _||(_.b4w_water_dir_noise_scale=.05,n("material",_,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in _||(_.b4w_water_dir_noise_freq=.07,n("material",_,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in _||(_.b4w_water_dir_min_noise_fac=.5,n("material",_,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in _||(_.b4w_water_dst_min_fac=.2,n("material",_,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in _||(_.b4w_water_waves_hor_fac=5,n("material",_,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in _||(_.b4w_water_absorb_factor=6,n("material",_,"b4w_water_absorb_factor")),"b4w_water_fog_color"in _||(_.b4w_water_fog_color=[.5,.7,.7],n("material",_,"b4w_water_fog_color")),"b4w_foam_factor"in _||(_.b4w_foam_factor=5,n("material",_,"b4w_foam_factor")),"b4w_generated_mesh"in _||(_.b4w_generated_mesh=!1,n("material",_,"b4w_generated_mesh")),"b4w_water_num_cascads"in _||(_.b4w_water_num_cascads=5,n("material",_,"b4w_water_num_cascads")),"b4w_water_subdivs"in _||(_.b4w_water_subdivs=64,n("material",_,"b4w_water_subdivs")),"b4w_water_detailed_dist"in _||(_.b4w_water_detailed_dist=1e3,n("material",_,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in _||(_.b4w_water_enable_caust=!1,n("material",_,"b4w_water_enable_caust")),"b4w_water_caust_scale"in _||(_.b4w_water_caust_scale=.25,n("material",_,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in _||(_.b4w_water_caust_brightness=.5,n("material",_,"b4w_water_caust_brightness"))),"b4w_dynamic_grass_size"in _||(_.b4w_dynamic_grass_size=""),"b4w_dynamic_grass_color"in _||(_.b4w_dynamic_grass_color=""),"diffuse_intensity"in _||(_.diffuse_intensity=1,n("material",_,"diffuse_intensity")),"b4w_use_ghost"in _||(_.b4w_use_ghost=!1),"b4w_collision_margin"in _||(_.b4w_collision_margin=.04,n("material",_,"b4w_collision_margin")),"b4w_collision_group"in _||(_.b4w_collision_group=128,n("material",_,"b4w_collision_group")),"b4w_collision_mask"in _||(_.b4w_collision_mask=127,n("material",_,"b4w_collision_mask")),"b4w_do_not_render"in _||(_.b4w_do_not_render=!1,n("material",_,"b4w_do_not_render")),"HALO"!=_.type||"b4w_halo_sky_stars"in _||(_.b4w_halo_sky_stars=!1,n("material",_,"b4w_halo_sky_stars")),"HALO"!=_.type||"b4w_halo_stars_blend_height"in _||(_.b4w_halo_stars_blend_height=10,n("material",_,"b4w_halo_stars_blend_height")),"HALO"!=_.type||"b4w_halo_stars_min_height"in _||(_.b4w_halo_stars_min_height=0,n("material",_,"b4w_halo_stars_min_height")),"specular_shader"in _||(_.specular_shader="COOKTORR",n("material",_,"specular_shader")),"diffuse_shader"in _||(_.diffuse_shader="LAMBERT",n("material",_,"diffuse_shader")),"roughness"in _||(_.roughness=.5,n("material",_,"roughness")),"diffuse_fresnel"in _||(_.diffuse_fresnel=.1,n("material",_,"diffuse_fresnel")),"diffuse_fresnel_factor"in _||(_.diffuse_fresnel_factor=.5,n("material",_,"diffuse_fresnel_factor")),"specular_slope"in _||(_.specular_slope=.2,n("material",_,"specular_slope")),"specular_toon_size"in _||(_.specular_toon_size=.5,n("material",_,"specular_toon_size")),"specular_toon_smooth"in _||(_.specular_toon_smooth=.1,n("material",_,"specular_toon_smooth")),"specular_alpha"in _||(_.specular_alpha=1,n("material",_,"specular_alpha")),"b4w_wettable"in _||(_.b4w_wettable=!1,n("material",_,"b4w_wettable")),"b4w_refractive"in _||(_.b4w_refractive=!1,n("material",_,"b4w_refractive")),"b4w_refr_bump"in _||(_.b4w_refr_bump=0,n("material",_,"b4w_refr_bump")),"b4w_shallow_water_col"in _||(_.b4w_shallow_water_col=[0,.8,.3],n("material",_,"b4w_shallow_water_col")),"b4w_shore_water_col"in _||(_.b4w_shore_water_col=[0,.9,.2],n("material",_,"b4w_shore_water_col")),"b4w_shallow_water_col_fac"in _||(_.b4w_shallow_water_col_fac=1,n("material",_,"b4w_shallow_water_col_fac")),"b4w_shore_water_col_fac"in _||(_.b4w_shore_water_col_fac=.5,n("material",_,"b4w_shore_water_col_fac")),"b4w_water_sss_strength"in _||(_.b4w_water_sss_strength=5.9,n("material",_,"b4w_water_sss_strength")),"b4w_water_sss_width"in _||(_.b4w_water_sss_width=.45,n("material",_,"b4w_water_sss_width")),"b4w_render_above_all"in _||(_.b4w_render_above_all=!1,n("material",_,"b4w_render_above_all")),"b4w_water_norm_uv_velocity"in _||(_.b4w_water_norm_uv_velocity=.05,n("material",_,"b4w_water_norm_uv_velocity")),"specular_ior"in _||(_.specular_ior=1,n("material",_,"specular_ior")),"darkness"in _||(_.darkness=0,n("material",_,"darkness")),"diffuse_toon_size"in _||(_.diffuse_toon_size=0,n("material",_,"diffuse_toon_size")),"diffuse_toon_smooth"in _||(_.diffuse_toon_smooth=0,n("material",_,"diffuse_toon_smooth")),"pass_index"in _||(_.pass_index=0,n("material",_,"pass_index")),c=_.texture_slots;for(l=0;l<c.length;l++)"blend_type"in(f=c[l])||(f.blend_type="MIX",n("texture_slot",f,"blend_type"));if(_.node_tree){for(c=_.node_tree.nodes,l=0;l<c.length;l++)a(c[l]);_.node_tree.animation_data&&r(_.node_tree.animation_data)}}for(f=e.node_groups,s=0;s<f.length;s++)for(c=f[s].node_tree.nodes,l=0;l<c.length;l++)a(c[l]);for(c=e.objects,s=0;s<c.length;s++){switch(f=c[s],f.type){case"MESH":"b4w_dynamic_geometry"in f||(f.b4w_dynamic_geometry=!1),"b4w_reflexible"in f||(f.b4w_reflexible=!1),"b4w_reflexible_only"in f||(f.b4w_reflexible_only=!1),"b4w_reflective"in f||(f.b4w_reflective=!1),"b4w_reflection_type"in f||(f.b4w_reflection_type="PLANE",n("object",f,"b4w_reflection_type")),"b4w_wind_bending"in f||(f.b4w_wind_bending=!1,n("object",f,"b4w_wind_bending")),"b4w_wind_bending_angle"in f||(f.b4w_wind_bending_angle=10,f.b4w_wind_bending_freq=.25,n("object",f,"wind bending params")),"b4w_detail_bending_amp"in f||(f.b4w_detail_bending_amp=.1,f.b4w_branch_bending_amp=.3,n("object",f,"detail bending params")),"b4w_detail_bending_freq"in f||(f.b4w_detail_bending_freq=1,n("object",f,"b4w_detail_bending_freq")),"b4w_main_bend_stiffness_col"in f||(f.b4w_main_bend_stiffness_col="",n("object",f,"b4w_main_bend_stiffness_col")),"b4w_detail_bend_colors"in f||(f.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},n("object",f,"b4w_detail_bend_colors")),"b4w_caustics"in f||(f.b4w_caustics=!1),"vertex_groups"in f&&f.vertex_groups.length&&f.data&&0==f.data.vertex_groups.length&&(f.data.vertex_groups=f.vertex_groups,delete f.vertex_groups,n("object",f,"vertex_groups")),"b4w_vertex_anim"in f&&f.b4w_vertex_anim.length&&f.data&&0==f.data.b4w_vertex_anim.length&&(f.data.b4w_vertex_anim=f.b4w_vertex_anim,delete f.b4w_vertex_anim,n("object",f,"b4w_vertex_anim")),"b4w_do_not_render"in f||(f.b4w_do_not_render=!1),"b4w_hidden_on_load"in f||(f.b4w_hidden_on_load=!1),"b4w_hide_chldr_on_load"in f||(f.b4w_hide_chldr_on_load=!1),"use_ghost"in f.game||(f.game.use_ghost=!1),"use_sleep"in f.game||(f.game.use_sleep=!1),"velocity_min"in f.game||(f.game.velocity_min=0),"velocity_max"in f.game||(f.game.velocity_max=0),"collision_group"in f.game||(f.game.collision_group=1),"collision_mask"in f.game||(f.game.collision_mask=255),l=f,t=l.game,_=t.collision_bounds_type,t.use_collision_bounds&&"BOX"!=_&&"CYLINDER"!=_&&"CONE"!=_&&"SPHERE"!=_&&"CAPSULE"!=_&&"EMPTY"!=_&&(u.error("Wrong collision bounds type "+_+". Disable physics for object "+l.name),l.b4w_collision=!1,l.b4w_floating=!1,l.b4w_vehicle=!1,l.b4w_character=!1),"b4w_vehicle_settings"in f?f.b4w_vehicle_settings&&("steering_ratio"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.steering_ratio=10),"steering_max"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.steering_max=1),"inverse_control"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.inverse_control=!1),"force_max"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.force_max=1500),"brake_max"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.brake_max=100),"speed_ratio"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.wheel_friction=1e3),"roll_influence"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.floating_factor=3),"floating_factor"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in f.b4w_vehicle_settings||(f.b4w_vehicle_settings.water_rot_damp=.9)):(f.b4w_vehicle_settings=null,n("object",f,"b4w_vehicle_settings")),"b4w_floating_settings"in f?f.b4w_floating_settings&&("floating_factor"in f.b4w_floating_settings||(f.b4w_floating_settings.floating_factor=3),"water_lin_damp"in f.b4w_floating_settings||(f.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in f.b4w_floating_settings||(f.b4w_floating_settings.water_rot_damp=.8)):(f.b4w_floating_settings=null,n("object",f,"b4w_floating_settings")),"b4w_character_settings"in f?f.b4w_character_settings&&("walk_speed"in f.b4w_character_settings||(f.b4w_character_settings.walk_speed=4),"run_speed"in f.b4w_character_settings||(f.b4w_character_settings.run_speed=8),"step_height"in f.b4w_character_settings||(f.b4w_character_settings.step_height=.25),"jump_strength"in f.b4w_character_settings||(f.b4w_character_settings.jump_strength=5),"waterline"in f.b4w_character_settings||(f.b4w_character_settings.waterline=0)):(f.b4w_character_settings=null,n("object",f,"b4w_character_settings")),"b4w_selectable"in f||(f.b4w_selectable=!1,n("object",f,"b4w_selectable")),"b4w_outlining"in f||(f.b4w_outlining=!1,n("object",f,"b4w_outlining")),"b4w_outline_on_select"in f||(f.b4w_outline_on_select=!1,n("object",f,"b4w_outline_on_select")),"b4w_billboard"in f||(f.b4w_billboard=!1,n("object",f,"b4w_billboard")),"b4w_billboard_geometry"in f||(f.b4w_billboard_geometry="SPHERICAL",n("object",f,"b4w_billboard_geometry")),"b4w_pres_glob_orientation"in f||(f.b4w_pres_glob_orientation=!1,n("object",f,"b4w_pres_glob_orientation")),"b4w_outline_settings"in f||("b4w_glow_settings"in f?f.b4w_outline_settings=f.b4w_glow_settings:(f.b4w_outline_settings={},f.b4w_outline_settings.outline_duration=1,f.b4w_outline_settings.outline_period=1,f.b4w_outline_settings.outline_relapses=0),n("object",f,"b4w_outline_settings")),"lod_levels"in f||(f.lod_levels=[],n("object",f,"lod_levels")),"b4w_animation_mixing"in f||(f.b4w_animation_mixing=!1,n("object",f,"b4w_animation_mixing"));break;case"EMPTY":"b4w_anchor"in f||(f.b4w_anchor=null,n("object",f,"b4w_anchor")),!f.b4w_anchor||"max_width"in f.b4w_anchor||(f.b4w_anchor.max_width=250)}if("collision_margin"in f.game||(f.game.collision_margin=.04,n("object",f,"collision_margin")),"b4w_anim_behavior"in f||(f.b4w_anim_behavior=f.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",n("object",f,"b4w_anim_behavior")),!("rotation_quaternion"in f)){l=[0,0,0,1],m.euler_to_quat(f.rotation_euler,l);var t=l,_=l[0],d=l[1],p=l[2];t[0]=l[3],t[1]=_,t[2]=d,t[3]=p,f.rotation_quaternion=l,n("object",f,"rotation_quaternion")}"webgl_do_not_batch"in f&&(f.b4w_do_not_batch=f.webgl_do_not_batch)&&o("object",f,"webgl_do_not_batch"),"b4w_shadow_cast_only"in f||(f.b4w_shadow_cast_only=!1,n("object",f,"b4w_shadow_cast_only")),"b4w_correct_bounding_offset"in f||(f.b4w_correct_bounding_offset="AUTO",n("object",f,"b4w_correct_bounding_offset")),t=f.particle_systems;for(l=0;l<t.length;l++)_=t[l],d=_.settings,"use_rotation_dupli"in d||(d.use_rotation_dupli=!1,n("particle_settings",d,"use_rotation_dupli")),"use_whole_group"in d||(d.use_whole_group=!1,n("particle_settings",d,"use_whole_group")),_.transforms||(_.transforms=new Float32Array,n("particle_system",_,"transforms")),"b4w_billboard_align"in d||(d.b4w_billboard_align="VIEW",n("particle_settings",d,"b4w_billboard_align")),"b4w_dynamic_grass"in d||(d.b4w_dynamic_grass=!1,n("object",d,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in d||(d.b4w_dynamic_grass_scale_threshold=.01,n("object",d,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in d||(d.b4w_initial_rand_rotation=!1,n("particle_settings",d,"b4w_initial_rand_rotation")),"b4w_rotation_type"in d||(d.b4w_rotation_type="Z",n("particle_settings",d,"b4w_rotation_type")),"b4w_rand_rotation_strength"in d||(d.b4w_rand_rotation_strength=1,n("particle_settings",d,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in d||(d.b4w_hair_billboard=!1,n("particle_settings",d,"b4w_hair_billboard")),"b4w_hair_billboard_type"in d||(d.b4w_hair_billboard_type="BASIC",n("particle_settings",d,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in d||(d.b4w_hair_billboard_jitter_amp=0,n("particle_settings",d,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in d||(d.b4w_hair_billboard_jitter_freq=0,n("particle_settings",d,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in d||(d.b4w_hair_billboard_geometry="SPHERICAL",n("particle_settings",d,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in d||(d.b4w_wind_bend_inheritance="PARENT",n("particle_settings",d,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in d||(d.b4w_shadow_inheritance="PARENT",n("particle_settings",d,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in d||(d.b4w_reflection_inheritance="PARENT",n("particle_settings",d,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in d||(d.b4w_vcol_from_name="",n("particle_settings",d,"b4w_vcol_from_name")),"b4w_vcol_to_name"in d||(d.b4w_vcol_to_name="",n("particle_settings",d,"b4w_vcol_to_name")),"b4w_coordinate_system"in d||(d.b4w_coordinate_system="LOCAL",n("particle_settings",d,"b4w_coordinate_system")),"b4w_allow_nla"in d||(d.b4w_allow_nla=!0,n("particle_settings",d,"b4w_allow_nla")),"b4w_enable_soft_particles"in d||(d.b4w_enable_soft_particles=!1,n("particle_settings",d,"b4w_enable_soft_particles")),"b4w_particles_softness"in d||(d.b4w_particles_softness=1,n("particle_settings",d,"b4w_particles_softness")),"billboard_tilt"in d||(d.billboard_tilt=0,n("particle_settings",d,"billboard_tilt")),"billboard_tilt_random"in d||(d.billboard_tilt_random=0,n("particle_settings",d,"billboard_tilt_random")),"use_rotations"in d||(d.use_rotations=!1,n("particle_settings",d,"use_rotations"));"constraints"in f||(f.constraints=[],n("object",f,"constraints")),t=f.constraints;for(l=0;l<t.length;l++)_=t[l],"influence"in _||(_.influence=1),"axes"in _||(_.axes=[1,1,1]);for(t=f.modifiers,l=0;l<t.length;l++){e:{switch(_=t[l],_.type){case"ARRAY":if(!("fit_type"in _)){u.error("WARNING Incomplete modifier "+String(_.type)+' for "'+f.name+'", reexport "'+e.b4w_filepath_blend+'" scene'),_=!1;break e}}_=!0}_||(t.splice(l,1),l--)}"animation_data"in f||(f.animation_data={action:null,nla_tracks:[]},n("object",f,"animation_data")),f.animation_data&&("action"in f.animation_data||(f.animation_data.action=null,i("no action in animation data "+f.name)),"nla_tracks"in f.animation_data||(f.animation_data.nla_tracks=[],i("no NLA in animation data "+f.name)),r(f.animation_data)),"b4w_collision_id"in f||(f.b4w_collision_id="",n("object",f,"b4w_collision_id")),"b4w_viewport_alignment"in f||(f.b4w_viewport_alignment=null,n("object",f,"b4w_viewport_alignment")),"pinverse_tsr"in f||(f.pinverse_tsr=null,n("object",f,"pinverse_tsr")),"b4w_cluster_data"in f||(f.b4w_cluster_data={cluster_id:-1,cluster_center:null},n("object",f,"b4w_cluster_data")),"pass_index"in f||(f.pass_index=0,n("object",f,"pass_index")),"b4w_custom_prop"in f||(n("object",f,"b4w_custom_prop"),f.b4w_custom_prop=null),(0>f.scale[0]||0>f.scale[1]||0>f.scale[2])&&i('negative scale for object "'+f.name+'", can lead to some errors'),l=f.scale,0==l[0]&&0==l[1]&&0==l[2]?l=!0:(t=Math.abs((l[1]-l[2])/l[1]),l=.005>Math.abs((l[0]-l[1])/l[0])&&.005>t),l||i("non-uniform scale for object "+f.name)}for(var g in x)s=x[g],l=g.match(/.*?(?=>>|$)/i)[0],u.warn('Property "'+String(l)+'" is '+s.HG+' for "'+s.type+'". To fix this, reexport '+e.b4w_filepath_blend)},e.nM=function(e,t){"num_channels"in e||(e.num_channels=1,i('B4W Warning: no channels number in animation fcurve for "'+t.name+'" action, reexport scene'))},e.zL=function(e){var t;e:{t=e.modifiers;for(var a=0;a<t.length;a++){var r=t[a].type;if("ARRAY"==r||"CURVE"==r){t=!0;break e}}t=!1}if(!t)return null;for(t=_(e.data,e.data.name+"_MOD"),e=e.modifiers,a=0;a<e.length;a++){var n=e[a];switch(n.type){case"ARRAY":for(var r=t,o=n,i=0,c=0,u=0,v=new Float32Array(16),n=[],b=1;b<o.count;b++){if(o.use_constant_offset&&(i+=o.constant_offset_displace[0],c+=o.constant_offset_displace[1],u+=o.constant_offset_displace[2]),o.use_relative_offset)var E=r.b4w_boundings.bb,i=i+(E.max_x-E.min_x)*o.relative_offset_displace[0],c=c+(E.max_y-E.min_y)*o.relative_offset_displace[1],u=u+(E.max_z-E.min_z)*o.relative_offset_displace[2];m.lU(i,c,u,v);for(var A=E=_(r),x=v,O=h.fromMat4(x,T),O=d.fromMat3(O,S),w=0;w<A.submeshes.length;w++){var R=A.submeshes[w];m.wo(R.position,x,R.position,0),p.Sz(R.tbn,O,R.tbn)}n.push(E)}for(b=0;b<n.length;b++)for(o=r,i=n[b],c=0;c<o.submeshes.length;c++){u=o.submeshes[c],v=i.submeshes[c],E=u.base_length,A=u.indices.length,u.base_length+=v.base_length;for(var L in u)if("base_length"!=L&&"boundings"!=L&&"uv_layers"!=L)if("indices"==L)for(u[L]=m.qU(u[L],v[L]),x=A;x<u.indices.length;x++)u.indices[x]+=E;else"vertex_colors"!=L&&(u[L]=m.RO(u[L],v[L]))}break;case"CURVE":for(r=t,b=l.xN(n.object),o=new Float32Array(16),c=b.mk?4:3,i=new Float32Array(c),c=new Float32Array(c),u=new Float32Array(3),v=new Float32Array(4),E=new Float32Array(4),A=new Float32Array(3),x=new Float32Array(3),O=new Float32Array(3),w=0;w<r.submeshes.length;w++){var N,I=r.submeshes[w],R=I.position,I=I.tbn;e:{switch(N=n.deform_axis){case"POS_X":case"NEG_X":N=0;break e;case"POS_Y":case"NEG_Y":N=1;break e;case"POS_Z":case"NEG_Z":N=2;break e;default:m.F("Wrong deform axis value "+N)}N=void 0}A[0]=0,A[1]=0,A[2]=0,A[N]=1;for(var M=l.YT(b),C=0;C<R.length/3;C++){O[0]=R[3*C],O[1]=R[3*C+1],O[2]=R[3*C+2];var D=O[N],U=l.XT(b,D);l.ZT(b,U,i),u[0]=i[0],u[1]=i[1],u[2]=i[2],l.WT(b,U,c),x[0]=c[0],x[1]=0,x[2]=c[2],g.normalize(x,x),d.rotationTo(A,x,v),0>D?(i[0]=x[0],i[1]=x[1],i[2]=x[2],g.scale(i,D,i),g.add(u,i,u)):D>M&&(i[0]=x[0],i[1]=x[1],i[2]=x[2],g.scale(i,D-M,i),g.add(u,i,u)),f.fromRotationTranslation(v,u,o),b.mk&&(d.setAxisAngle(A,i[3],E),g.transformQuat(O,E,O)),O[N]=0,g.transformMat4(O,o,O),R[3*C]=O[0],R[3*C+1]=O[1],R[3*C+2]=O[2],D=p.Wl(I,C,y),p.Sz(D,v,D),p.oi(I,D,C)}}}s.pS(t)}return t},e.lN=function(){return{name:"DEFAULT",uuid:m.lu(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1e3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}},e.EL=function(e,t){function a(t,a){for(var r in t){var n=t[r],o=n[0];if(1<n.length)for(var i=1;i<n.length;i++)o+="*"+n[i];for(i=0;i<e.length;i++)if(n=e[i],n.name==o)for(var _ in a)n[_]=a[_]}}for(var r=t.b4w_logic_nodes,n=0;n<r.length;n++)for(var o=r[n],_=0;_<o.length;_++){var s,c=o[_],l={register1:"variable1",register2:"variable2",registerd:"variabled"};for(s in l)s in c&&(c[l[s]]=c[s]);for(var f in c.variables)"boolean"!=typeof c.variables[f][0]&&(c.variables[f]=[!1,c.variables[f]]);switch(0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(c.type)&&("variable1"in c&&(c.variables.v1=[!1,c.variable1]),"variable2"in c&&(c.variables.v2=[!1,c.variable2]),"variabled"in c&&(c.variables.vd=[!1,c.variabled])),c.type){case"SELECT":for(var u=0;u<e.length;u++)l=e[u],l.name==c.object&&(l.b4w_selectable=!0);c.bools||(c.bools={}),c.bools.not_wait||(c.bools.not_wait=!1),i('Logic nodes type "SELECT" is deprecated');break;case"SWITCH_SELECT":if(a(c.objects_paths,{b4w_selectable:!0}),c.links instanceof Array){i('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+t.name+'"');var l={},d=0;for(u in c.objects_paths)l[u]=c.links[d],d++;c.links=l}break;case"SELECT_PLAY":i('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+t.name+'"'),c.mute=!0;break;case"SELECT_PLAY_ANIM":i('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case"SHOW":c.bools||(c.bools={}),void 0===c.bools.ch&&(c.bools.ch=!1);case"HIDE":a(c.objects_paths,{b4w_do_not_batch:!0});break;case"SET_SHADER_NODE_PARAM":case"INHERIT_MAT":a(c.objects_paths,{b4w_do_not_batch:!0});break;case"PLAY":t.b4w_use_nla=!0;break;case"MOVE_TO":a(c.objects_paths,{b4w_do_not_batch:!0});break;case"TRANSFORM_OBJECT":switch(a(c.objects_paths,{b4w_do_not_batch:!0}),c.common_usage_names.space_type){case"WORLD":c.common_usage_names.space_type=v.UJ;break;case"PARENT":c.common_usage_names.space_type=v.TJ;break;case"LOCAL":c.common_usage_names.space_type=v.SJ}break;case"OUTLINE":a(c.objects_paths,{b4w_outlining:!0});break;case"CONDJUMP":if(c.condition&&(c.common_usage_names.condition=c.condition),"cnd"in c.floats)c.common_usage_names.condition=c.floats.cnd;else switch(c.common_usage_names.condition){case"GEQUAL":c.common_usage_names.condition=v.VB;break;case"LEQUAL":c.common_usage_names.condition=v.XB;break;case"GREATER":c.common_usage_names.condition=v.WB;break;case"LESS":c.common_usage_names.condition=v.YB;break;case"NOTEQUAL":c.common_usage_names.condition=v.ZB;break;case"EQUAL":c.common_usage_names.condition=v.UB}void 0!=c.number1&&(c.input1=c.number1),void 0!=c.number2&&(c.input2=c.number2),c.bools||(c.bools={}),void 0===c.bools.str&&(c.bools.str=!1,c.floats.inp1=c.input1,c.floats.inp2=c.input2);break;case"SEND_REQ":c.bools||(c.bools={}),c.strings||(c.strings={}),void 0===c.bools.ct&&(c.bools.ct=!1),void 0!=c.url&&(c.bools.url=!1,c.strings.url=c.url);break;case"MATH":switch(void 0!=c.number1&&(c.input1=c.number1),void 0!=c.number2&&(c.input2=c.number2),void 0!=c.input1&&(c.floats.inp1=c.input1),void 0!=c.input2&&(c.floats.inp2=c.input2),c.operation){case"DIV":c.operation=v.zJ;break;case"SUB":c.operation=v.IJ;break;case"MUL":c.operation=v.EJ;break;case"ADD":c.operation=v.uJ;break;case"RAND":c.operation=v.FJ;break;case"SIN":c.operation=v.HJ;break;case"COS":c.operation=v.yJ;break;case"TAN":c.operation=v.JJ;break;case"ARCSIN":c.operation=v.wJ;break;case"ARCCOS":c.operation=v.vJ;break;case"ARCTAN":c.operation=v.xJ;break;case"LOG":c.operation=v.AJ;break;case"MIN":c.operation=v.CJ;break;case"MAX":c.operation=v.BJ;break;case"ROUND":c.operation=v.GJ;break;case"MOD":c.operation=v.DJ;break;case"ABS":c.operation=v.tJ}break;case"REGSTORE":if(c.floats||(c.floats={}),c.strings||(c.strings={}),void 0!=c.number1&&(c.input1=c.number1),void 0!=c.input1)switch(typeof c.input1){case"number":c.floats.inp1=c.input1,c.common_usage_names.variable_type="NUMBER";break;default:c.strings.inp1=c.input1,c.common_usage_names.variable_type="STRING"}switch(c.common_usage_names.variable_type){case"NUMBER":c.common_usage_names.variable_type=v.VJ;break;case"STRING":c.common_usage_names.variable_type=v.WJ}break;case"PAGEPARAM":c.bools||(c.bools={}),void 0===c.bools.hsh&&(c.bools.hsh=!1),c.floats||(c.floats={}),void 0===c.floats.ptp&&(c.floats.ptp=0);break;case"PLAY_ANIM":a(c.objects_paths,{b4w_do_not_batch:!0}),c.bools||(c.bools={}),void 0===c.bools.env&&(c.bools.env=!1),(l=c.common_usage_names.param_anim_behavior)||(l="FINISH_STOP"),c.common_usage_names.param_anim_behavior=b.Ix(l);break;case"STOP_ANIM":c.bools||(c.bools={}),void 0===c.bools.env&&(c.bools.env=!1);break;case"STRING":switch(c.common_usage_names.string_operation){case"JOIN":c.common_usage_names.string_operation=v.PJ;break;case"FIND":c.common_usage_names.string_operation=v.OJ;break;case"REPLACE":c.common_usage_names.string_operation=v.QJ;break;case"SPLIT":c.common_usage_names.string_operation=v.RJ;break;case"COMPARE":c.common_usage_names.string_operation=v.NJ}if("cnd"in c.floats)c.common_usage_names.condition=c.floats.cnd;else switch(c.common_usage_names.condition){case"GEQUAL":c.common_usage_names.condition=v.VB;break;case"LEQUAL":c.common_usage_names.condition=v.XB;break;case"GREATER":c.common_usage_names.condition=v.WB;break;case"LESS":c.common_usage_names.condition=v.YB;break;case"NOTEQUAL":c.common_usage_names.condition=v.ZB;break;case"EQUAL":c.common_usage_names.condition=v.UB}break;case"REDIRECT":void 0!=c.url&&(c.bools.url=!1,c.strings.url=c.url);break;case"SET_CAMERA_MOVE_STYLE":switch(c.common_usage_names.camera_move_style){case"STATIC":c.common_usage_names.camera_move_style=v.pJ;break;case"TARGET":c.common_usage_names.camera_move_style=v.qJ;break;case"EYE":c.common_usage_names.camera_move_style=v.nJ;break;case"HOVER":c.common_usage_names.camera_move_style=v.oJ}break;case"ENTRYPOINT":c.bools||(c.bools={}),void 0===c.bools.js&&(c.bools.js=!1),c.bools.js&&(c.mute=!0);break;case"JS_CALLBACK":for(s in c=c.common_usage_names.js_cb_params)switch(c[s]){case"OBJECT":c[s]=v.rJ;break;case"VARIABLE":c[s]=v.sJ}}}}},a.module.__scenegraph=function(e,t){function a(e,t){var a=[];N.Pg(e,function(t,r,n){-1<a.indexOf(n)?N.BS(e,t,r,n,b(n)):a.push(n)}),N.X(e,function(e,r){for(var n=0;n<r.Sa.length;n++){var o=r.Sa[n];t||r.type!=C.Nd&&r.type!=C.kd&&r.type!=C.ig||(o.Kd=!0),-1<a.indexOf(o)?r.Sa[n]=b(o):a.push(o)}})}function r(e,t){N.X(e,function(a,r){r.type==C.EB&&N.Ij(e,a,function(e,t){if(t.type==C.Ih)for(var a=0;a<t.Sa.length;a++){var r=t.Sa[a];r.ea=D.L,r.ha=D.L}}),t||N.Ij(e,a,function(e,t,a){"DEPTH"==a.from&&(a.Kd=!0)})}),N.X(e,function(t){var a={};n(e,t,a);for(var r in a){t=a[r];for(var o=t[0],i=0;i<t.length;i++)if(t[i].ea==D.L){o=t[i];break}for(var _=t[0],i=0;i<t.length;i++)if(t[i].ha==D.L){_=t[i];break}for(var s=t[0],i=0;i<t.length;i++)if(!t[i].Kd){s=t[i];break}for(i=0;i<t.length;i++)t[i].ea=o.ea,t[i].ha=_.ha,t[i].Kd=s.Kd}})}function n(e,t,a){if(N.Ij(e,t,function(t,r,o){o.active&&o.from==o.to&&(a[o.from]=a[o.from]||[],-1==a[o.from].indexOf(o)&&a[o.from].push(o),n(e,t,a))}),N.Wk(e,t,function(e,t,r){r.active&&(a[r.from]=a[r.from]||[],-1==a[r.from].indexOf(r)&&a[r.from].push(r))}),t=N.Qa(e,t),t.type==C.Ih)for(var r=0;r<t.Sa.length;r++){var o=t.Sa[r];a[o.from].push(o)}}function o(e){var t=[C.Ih,C.xx,C.Cs,C.Nd,C.kd,C.sp];P.Ab||t.push(C.HB);var a=N.fB(e),r=[];N.X(a,function(e,n){for(var o=0;o<n.Sa.length;o++){var f=n.Sa[o];-1<t.indexOf(n.type)&&(f.Yk=!0);var u=l(r,f,i(f));f.Ma=u,n.Og[o]=u}for(o=0;o<n.Og.length;o++)u=n.Og[o],c(r,u);N.Wk(a,e,function(o,c,f){if(!f.Ma){if(-1<t.indexOf(n.type))f.Yk=!0;else if((o=_(a,e,f.from))&&f.active&&!f.Ma)return s(r,o),void(f.Ma=o);o=l(r,f,i(f)),f.Ma=o}}),N.Ij(a,e,function(e,t,a){c(r,a.Ma)}),N.Wk(a,e,function(e,t,a){a.Ma&&"NONE"==a.to&&c(r,a.Ma)})})}function i(e){var t=e.to,a=e.active,r=e.Ma;e.to="",e.active=!1,e.Ma=null;var n=U.aD(e);return e.to=t,e.active=a,e.Ma=r,n}function _(e,t,a){var r=null;return N.Ij(e,t,function(e,t,n){if(n.active&&n.from==n.to&&n.from==a&&n.Ma)return r=n.Ma,!0}),N.Wk(e,t,function(e,t,n){if(n.active&&n.from==a&&n.Ma)return r=n.Ma,!0}),r}function s(e,t){for(var a=0;a<e.length;a++){var r=e[a];r.cB===t&&r.Br++}}function c(e,t){for(var a=0;a<e.length;a++){var r=e[a];r.cB===t&&r.Br&&r.Br--}}function l(e,t,a){if(t.um)return s(e,t.um.Ma),t.um.Ma;if(t.Yk)return f(t);for(var r=null,n=0;n<e.length;n++){var o=e[n];if(o.id==a&&0===o.Br){r=o;break}}return r&&!P.iE?(r.Br++,r.cB):(t=f(t),e.push({id:a,Br:1,cB:t}),t)}function f(e){var t=e.wj*e.size,a=e.xj*e.size,r=e.Rw,n=e.Qg;switch(e.from){case"COLOR":return e.Kd?(r=D.Zj(e.ii?D.Hs:D.Gs,r,n),D.resize(r,t,a)):(r=D.Zj(D.Ug,r,n),D.resize(r,t,a),D.FA(r,e.ea,e.ha)),r;case"DEPTH":return e.Kd?(r=D.Zj(e.ii?D.Fs:D.Es,r,n),D.resize(r,t,a)):(r=D.Zj(D.ll,r,n),D.resize(r,t,a),D.FA(r,e.ea,e.ha)),r;case"CUBEMAP":return r=D.cN(t,n);case"SCREEN":case"NONE":return null;default:U.F("Wrong slink param: "+e.from)}}function u(e,t){var a=!1;N.Pg(e,function(r,n,o){if(o&&(r=N.Qa(e,r),n=N.Qa(e,n),t(o,!1,r,n)))return a=!0}),a||N.X(e,function(e,a){for(var r=0;r<a.Sa.length;r++)if(t(a.Sa[r],!0,a,null))return!0})}function d(e){N.X(e,function(t,a){if(a.type!=C.zi){var r=a.B;N.Wk(e,t,function(e,t,a){a.Ma&&a.active&&a.Ma&&(w.$v(r,a.from,a.Ma),a.from==a.to&&t.B&&w.$v(t.B,a.from,a.Ma))});for(var n=0;n<a.Sa.length;n++){var o=a.Sa[n];o.active&&o.from==o.to&&w.$v(r,o.from,a.Og[n])}!r.$b&&!r.bf||r.Ee||(r.Ee=I.xS(r.$b,r.bf))}}),N.X(e,function(t,a){if(a.type==C.As||a.type==C.ox){var r=x(e,a);a.B.Hq=r[0].B.Ee}})}function p(e){var t=null,a=0;return N.X(e,function(e,r){if(r.type==k.Ur){if(a==k.hU)return t=r,!0;a++}}),t}function m(e,t){var a=N.oj(e,t),r=C.wc("NONE"),n=N.T(e,r),o=N.Nq(e)[0];N.Pg(e,function(t,a){a==o&&N.qS(e,t,o,t,n)});var i=g(t,e);N.Pg(e,function(n,o,_){if(n==a){if(i){n=C.Ft(),N.T(e,n),o=v("COLOR","RESOLVE",1,1,1,!0,!0),o.ii=!0,o.Kd=!0;var s=v("DEPTH","RESOLVE",1,1,1,!0,!0);s.ii=!0,s.Kd=!0,N.D(e,t,n,o),N.D(e,t,n,s),t=n}return N.D(e,t,r,v(k.KT,"u_color",_.size,_.wj,_.xj,_.Hm,_.Qs)),!0}}),N.vc(e,n,o,v("SCREEN","NONE",.5,.5,.5,!0,!0))}function g(e,t){var a=!1,r=N.oj(t,e);return N.Zf(t,r)&&(a=N.yg(t,r,0),r=N.Ec(t,r,a,0),"COLOR"==r.from&&"COLOR"==r.to||"DEPTH"==r.from&&"DEPTH"==r.to?(r=N.Qa(t,a),a=g(r,t)):a="RESOLVE"==r.to),a}function h(e,t,a,r){for(var n=a.ba,o=t.Mu,i=t.wh.li,_=t.wh.Mv,s=N.Rk(e,N.VP(e,r),N.Pj),c=[],l=[],f=[],s=N.clone(s,function(t){var r;if(-1<F.indexOf(t.type))l.push(t),r=t;else{if(r=C.MM(t),r.type==C.Nd)for(var s=0;s<i.length;s++)if(i[s][0]==t){i[s]=[t,r],r.B.nc=t.B.nc,a.ba.push(r.B);break}if(t.type==C.Bf){for(s=0;s<i.length;s++)if(_[s][0]==t){_[s]=[t,r],r.B=i[s][1].B;break}}else-1<n.indexOf(t.B)&&(o?(w.kv(t.B,w.Re),w.kv(r.B,w.xe),r.Ql=!0):(w.kv(t.B,w.tc),w.kv(r.B,w.Bc)),n.push(r.B));var u=N.oj(e,t);if(N.Ij(e,u,function(e,t,a){-1<F.indexOf(t.type)&&c.push([t,r,a])}),t.type!==C.Ih)for(s=0;s<t.Sa.length;s++)r.Sa[s].um=t.Sa[s];for(t=!0,s=0;s<N.ci(e,u);s++){var d=N.Rf(e,u,s),d=N.Qa(e,d);-1==F.indexOf(d.type)&&(t=!1)}t&&f.push(r)}return r},function(e){var t=b(e,!0);return t.um=e,t}),u=0;u<l.length;u++)N.nf(s,N.oj(s,l[u]));if(N.dy(s),t=C.WN(o),u=N.T(e,t),P.Qu)var d=C.wc("NONE"),p=v("COLOR","u_color",1,1,1,!0,!0);else d=C.oy(),p=v("COLOR","COPY",1,1,1,!0,!0);p.ea=D.L,p.ha=D.L,N.T(e,d),N.D(e,r,d,p);var m=v("COLOR","u_sampler_left",1,1,1,!0,!0);if(m.Yk=!0,m.ea=D.L,m.ha=D.L,N.D(e,d,t,m),!r.Ob){if(P.Qu)var m=C.wc("NONE"),g=v("COLOR","u_color",1,1,1,!0,!0);else m=C.oy(),g=v("COLOR","COPY",1,1,1,!0,!0);N.T(s,m),g.um=p;var h=N.Nq(s)[0],h=N.Qa(s,h);N.D(s,h,m,g)}for(m=v("COLOR","u_sampler_right",1,1,1,!0,!0),r.Ob&&(m.um=p),m.ea=D.L,m.ha=D.L,N.AC(s,e,[N.Nq(s)[0],u,m]),u=0;u<c.length;u++)N.D(e,c[u][0],c[u][1],c[u][2]);for(r=v("SCREEN","NONE",0,0,0,!1,!1),u=0;u<f.length;u++)N.D(e,d,f[u],r);return N.Pg(e,function(t,a,r){N.Qa(e,t).type===C.Ih&&(r.um=null)}),t}function v(e,t,a,r,n,o,i){return{from:e,to:t,size:a,wj:r,xj:n,Hm:o,Qs:i,active:!0,Ma:null,ii:!1,Kd:!1,ea:D.Df,ha:D.Df,Yk:!1,Rw:!1,Qg:!1}}function b(e,t){var a=v(e.from,e.to,e.size,e.wj,e.xj,e.Hm,e.Qs);return a.active=e.active,!t&&e.Ma&&U.F("Failed to clone slink with attached texture"),a.Ma=e.Ma,a.ii=e.ii,a.Kd=e.Kd,a.ea=e.ea,a.ha=e.ha,a.Yk=e.Yk,a.Rw=e.Rw,a.Qg=e.Qg,a}function E(e,t,a){if(t.type==a)return!0;t=T(e,t);for(var r=0;r<t.length;r++)if(E(e,t[r],a))return!0;return!1}function A(e,t,a){if(t.type==a)return!0;t=x(e,t);for(var r=0;r<t.length;r++)if(A(e,t[r],a))return!0;return!1}function x(e,t){var a=N.oj(e,t);a==N.wx&&U.F("Subscene not in graph");for(var r=[],n=N.ci(e,a),o=0;o<n;o++){var i=N.Rf(e,a,o);i!=a&&r.push(N.Qa(e,i))}return r}function T(e,t){var a=N.oj(e,t);a==N.wx&&U.F("Subscene not in graph");for(var r=[],n=N.Zf(e,a),o=0;o<n;o++){var i=N.yg(e,a,o);i!=a&&r.push(N.Qa(e,i))}return r}function y(e){var t=[],a=[];return u(e,function(e){e.Ma&&-1==t.indexOf(e.Ma)&&(t.push(e.Ma),a.push(e.Ma,t.length-1))}),a}function S(e,t){var a;if(a=e.from+"\\n",a+="NONE"!=e.to?e.to+"\\n":"",a+="(",e.Hm){var r=e.wj,n=e.xj;Math.round(r)!=r&&(r=r.toFixed(2)),Math.round(n)!=n&&(n=n.toFixed(2)),a=a+((1==r?"":r)+"Sx")+(1==n?"":n)+"S"+(e.Qs?" FACT":" VIEW")}else r=e.wj,n=e.xj,a+=e.size*r+"x"+e.size*n;if("SCREEN"!=e.from){if(a+=" ",e.Kd)a+="RR";else{var r=e.ea,n=e.ha,o="";r==D.L?o+="L":r==D.Df&&(o+="N"),n==D.L?o+="L":n==D.Df&&(o+="N"),a+=o}for(r=0;r<t.length;r+=2)t[r]==e.Ma&&(a+=" "+t[r+1])}return a+")\\n"}var O=t("__batch"),w=t("__camera"),R=t("__config"),L=t("__debug"),N=t("__graph"),I=t("__renderer"),M=t("__shaders"),C=t("__subscene"),D=t("__textures"),U=t("__util"),k=R.Jl,P=R.H,G=R.Co,F=[C.yi,C.ld,C.kd,C.Qe];e.zM=function(e){switch(e.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"NONE":return!1;default:return!0}},e.Jw=u,e.rN=function(e,t,n,i){function _(a){var r=w.Cc(se,!0);for(t.ba.push(r),r=C.Hl(a,r,!1,R,O,V,Y,J,e.Sk),N.T(s,r),a==C.ig?(N.D(s,c[0],r,v("COLOR","COLOR",1,1,1,!0,!0)),r.Sa.push(v("DEPTH","DEPTH",1,1,1,!0,!0))):(a=ne&&c[0].type==C.As?Fe:c[0],N.D(s,Fe,r,ie),N.D(s,a,r,oe)),ce&&(N.D(s,ce,r,fe),N.D(s,ce,r,ue)),a=0;a<f.length;a++)N.D(s,f[a],r,u[a]);if(Qe&&N.D(s,Qe,r,Ze),g.length){var n=g.length;for(a=0;a<n;a++)N.D(s,g[a],r,E[a])}if(A.length)for(a=0;a<A.length;a++)N.D(s,A[a],r,y[a]);return Ye&&N.D(s,Ye,r,Je),r}var s=N.create(),c=[],l=[],f=[],u=[],g=[],E=[],A=[],y=[],S=[],O=e.QQ,R=e.hd,I=e.shore_smoothing,M=e.MT,F=e.ssao,j=e.god_rays,B=e.wh,H=e.OF,X=e.TL,q=e.motion_blur,z=e.compositing,W=e.antialiasing,Y=e.jl,V=e.OI,J=e.Pc,K=e.yR,Q=e.mM,Z=e.eQ,$=e.PR,ee=e.dof,te=e.jO,ae=e.refractions,re=!!i.length,ne=1<P.Rb,oe=v("COLOR","COLOR",1,1,1,!0,!0),ie=v("DEPTH","DEPTH",1,1,1,!0,!0);if(ne){var _e=b(ie);oe.ii=!0,oe.Kd=!0,ie.ii=!0,ie.Kd=!0}var se=t.ba[0];if(e.Dc){var ce=C.KN();N.T(s,ce);var le=G.Pq;ce.B.width=le,ce.B.height=le;var fe=v("DEPTH","u_grass_map_depth",le,1,1,!1,!1);P.Ab||(fe.ea=D.L,fe.ha=D.L);var ue=v("COLOR","u_grass_map_color",le,1,1,!1,!1);ue.ea=D.L,ue.ha=D.L}else ue=fe=ce=null;if(J){w.sB(se,J);for(var de=0;de<J.lh.length;de++)for(var pe=J.csm_num,me=0;me<pe;me++){var ge=C.RN(me,de,J,O);N.T(s,ge),f.push(ge);var le=J.csm_resolution,he=ge.B;t.pH.push(he),he.width=le,he.height=le,ge.rb=!0;var ve=0<de?de:me;if(P.Fr){u.push(v("COLOR","u_shadow_map"+ve,le,1,1,!1,!1));var be=v("DEPTH","DEPTH",le,1,1,!1,!1);be.Kd=!0,ge.Sa.push(be)}else{var Ee=v("DEPTH","u_shadow_map"+ve,le,1,1,!1,!1);P.jq&&(Ee.ea=D.L,Ee.ha=D.L,Ee.Rw=!0),u.push(Ee),(L.tM()||P.qH)&&ge.Sa.push(v("COLOR","COLOR",le,1,1,!1,!1))}ce&&(N.D(s,ce,ge,fe),N.D(s,ce,ge,ue))}}if(B&&B.dG&&!re)for(me=0;me<B.dG;me++){he=w.Yc(w.Gc),he.width=e.Uh,he.height=e.Uh,w.ZG(he,Math.PI/2,.1,100),w.set_projection(he,!1);var Ae=C.Hl(C.kd,he,!1,R,O,V,Y,null,e.Sk);for(Ae.Si=U.jP(),de=0;6>de;de++)Ae.Il.push(w.fN());N.T(s,Ae);var xe=v("CUBEMAP","u_cube_reflection",e.Uh,1,1,!1,!1);if(xe.ea=D.L,xe.ha=D.L,y.push(xe),!B.ez){var Te=v("CUBEMAP","u_cube_reflection",e.Uh,1,1,!1);Te.Qg=!0,Te.ea=D.wp,Te.ha=D.L,S.push(Te)}if(ce&&(N.D(s,ce,Ae,fe),N.D(s,ce,Ae,ue)),B.UE){var ye=C.Hl(C.Qe,he,!1,R,O,V,Y,null,e.Sk);ye.Si=Ae.Si,ye.Il=Ae.Il,N.T(s,ye);var Se=v("DEPTH","DEPTH",e.Uh,1,1,!1,!1),Oe=v("COLOR","COLOR",e.Uh,1,1,!1,!1);N.D(s,Ae,ye,Se),N.D(s,Ae,ye,Oe),A.push(ye),B.ry.push(ye),ce&&(N.D(s,ce,ye,fe),N.D(s,ce,ye,ue))}else{var we=v("DEPTH","DEPTH",e.Uh,1,1,!1,!1);Ae.Sa.push(we),A.push(Ae)}B.Ri.push(Ae)}if(B&&0<B.CG.length&&!re)for(de=0;de<B.CG.length;de++)he=w.Cc(se,!0),he.nc=new Float32Array(4),t.ba.push(he),Ae=C.Hl(C.Nd,he,!1,R,O,V,Y,null,e.Sk),N.T(s,Ae),xe=v("COLOR","u_plane_reflection",1,e.vh,e.vh,!0,!0),xe.ea=D.L,xe.ha=D.L,E.push(xe),ce&&(N.D(s,ce,Ae,fe),N.D(s,ce,Ae,ue)),B.UE?(ye=C.Hl(C.Bf,he,!1,R,O,V,Y,null,e.Sk),N.T(s,ye),Se=v("DEPTH","DEPTH",1,e.vh,e.vh,!0,!0),Oe=v("COLOR","COLOR",1,e.vh,e.vh,!0,!0),Oe.ea=D.Df,Oe.ha=D.Df,N.D(s,Ae,ye,Se),N.D(s,Ae,ye,Oe),B.Mv.push([ye]),g.push(ye),ce&&(N.D(s,ce,ye,fe),N.D(s,ce,ye,ue))):(we=v("DEPTH","DEPTH",1,e.vh,e.vh,!0,!0),Ae.Sa.push(we),g.push(Ae)),B.li.push([Ae]);if(J){var Re=w.Cc(se,!0);t.ba.push(Re);var Le=C.SN(Re,O);for(N.T(s,Le),Le.self_shadow_normal_offset=J.self_shadow_normal_offset,me=0;me<f.length;me++)ge=f[me],N.D(s,ge,Le,u[me]);if(F){var Ne=v("COLOR","u_color",1,1,1,!0,!0),Ie=v("DEPTH","u_depth",1,1,1,!0,!0),Me=w.Cc(se,!0);t.ba.push(Me);var Ce=e.aU,De=C.UN(Me,V,Ce);N.T(s,De);var Ue=v("COLOR","u_ssao_mask",1,1,1,!0,!0);N.D(s,Le,De,Ne),N.D(s,Le,De,Ie);var ke=w.Cc(se,!0);t.ba.push(ke);var Pe=C.VN(ke,Ce);N.T(s,Pe);var Ge=v("COLOR","u_shadow_mask",1,1,1,!0,!0);N.D(s,De,Pe,Ue),N.D(s,Le,Pe,Ie)}ne?Ee=v("DEPTH","DEPTH",1,1,1,!0,!0):P.Fr?(Ee=v("DEPTH","DEPTH",1,1,1,!0,!0),Ee.Kd=!0):Ee=ie,Le.Sa.push(Ee),ce&&(N.D(s,ce,Le,fe),N.D(s,ce,Le,ue))}else Le=null;var Fe=C.Hl(C.Gb,se,!0,R,O,V,Y,null,e.Sk);if(N.T(s,Fe),ne){var je=C.Ft();N.T(s,je),l.push(je);var Be=v("COLOR","RESOLVE",1,1,1,!0,!0);Be.ii=!0,Be.Kd=!0;var He=v("DEPTH","RESOLVE",1,1,1,!0,!0);He.ii=!0,He.Kd=!0,N.D(s,Fe,je,Be),N.D(s,Fe,je,He)}else l.push(Fe);if(Le&&(Ue?N.D(s,Pe,Fe,Ge):J?N.D(s,Le,Fe,v("COLOR","u_shadow_mask",1,1,1,!0,!0)):U.F("Internal error")),ce&&(N.D(s,ce,Fe,fe),N.D(s,ce,Fe,ue)),g.length)for(var Xe=g.length,de=0;de<Xe;de++)N.D(s,g[de],Fe,E[de]);if(A.length)for(de=0;de<A.length;de++)N.D(s,A[de],Fe,y[de]);if(c=l,l=[],!re&&e.NM){var qe=k.enabled&&(k.Ur===C.we||k.Ur===C.Rg),he=w.Cc(se,!0);qe||(he.width=he.height=1),t.ba.push(he);var ze=C.JD(he,!1,O);if(N.T(s,ze),e.Hh){he=w.Cc(se,!0),qe||(he.width=he.height=1),t.ba.push(he);var We=C.JD(he,!0,O);N.T(s,We),N.D(s,ze,We,v("COLOR","COLOR",1,1,1,qe,!0)),N.D(s,ze,We,v("DEPTH","DEPTH",1,1,1,qe,!0))}}else ze=null;if(!H.refractions&&!ae||re)Ye=null;else{if(ne)Ye=je;else{if(P.Qu)var Ye=C.wc("NONE"),Ve=v("COLOR","u_color",1,1,1,!0,!0);else Ye=C.oy(),Ve=v("COLOR","COPY",1,1,1,!0,!0);N.T(s,Ye),N.D(s,c[0],Ye,Ve)}var Je=v("COLOR","u_refractmap",1,1,1,!0,!0)}if(te&&(ae||I||M)){var Ke=w.Cc(se,!0);t.ba.push(Ke);var Qe=C.HN(Ke);N.T(s,Qe),N.D(s,ne?je:Fe,Qe,v("DEPTH","u_depth",1,1,1,!0,!0));var Ze=v("COLOR","u_scene_depth",1,1,1,!0,!0);Ze.ea=D.Df,Ze.ha=D.Df}else Qe=null;if(e.yu){var $e=_(C.Sc);l.push($e),c=l,l=[]}if(e.glow_materials){var et=w.Cc(se,!0);t.ba.push(et);var tt=C.Hl(C.Md,et,!1,R,O,V,Y);if(N.T(s,tt),Qe&&N.D(s,Qe,tt,Ze),Ye&&N.D(s,Ye,tt,Je),ce&&(N.D(s,ce,tt,fe),N.D(s,ce,tt,ue)),g.length)for(Xe=g.length,de=0;de<Xe;de++)N.D(s,g[de],tt,E[de]);if(A.length)for(de=0;de<A.length;de++)N.D(s,A[de],tt,y[de]);e.yu&&N.D(s,tt,$e,v("SCREEN","NONE",0,0,0,!1,!1)),N.D(s,ne?je:Fe,tt,ne?_e:ie);var at=C.wc("X_GLOW_BLUR");at.sb="GLOW_MASK_SMALL",at.re=e.ai.small_glow_mask_width;var rt=v("COLOR","u_color",1,1,1,!0,!0);rt.ea=D.L,rt.ha=D.L,N.T(s,at),N.D(s,tt,at,rt);var nt=C.wc("Y_GLOW_BLUR");nt.sb="GLOW_MASK_SMALL",nt.re=e.ai.small_glow_mask_width;var ot=v("COLOR","u_color",1,.5,.5,!0,!0);ot.ea=D.L,ot.ha=D.L,N.T(s,nt),N.D(s,at,nt,ot);var it=C.wc("X_GLOW_BLUR");it.sb="GLOW_MASK_LARGE",it.re=e.ai.large_glow_mask_width;var _t=v("COLOR","u_color",1,.5,.5,!0,!0);_t.ea=D.L,_t.ha=D.L,N.T(s,it),N.D(s,nt,it,_t);var st=C.wc("Y_GLOW_BLUR");st.sb="GLOW_MASK_LARGE",st.re=e.ai.large_glow_mask_width;var ct=v("COLOR","u_color",1,.25,.25,!0,!0);ct.ea=D.L,ct.ha=D.L,N.T(s,st),N.D(s,it,st,ct);var lt=w.Cc(se,!0);t.ba.push(lt);var ft=C.IN(lt,e);N.T(s,ft);var ut=v("COLOR","u_src_color",1,1,1,!0,!0);if(ut.ea=D.L,ut.ha=D.L,e.yu)if(ne){var dt=C.Ft();N.T(s,dt),N.D(s,$e,dt,Be),N.D(s,$e,dt,He),N.D(s,dt,ft,ut)}else N.D(s,$e,ft,ut);else N.D(s,ne?je:Fe,ft,ut);var pt=v("COLOR","u_glow_mask_small",1,.5,.5,!0,!0);pt.ea=D.L,pt.ha=D.L,N.D(s,nt,ft,pt);var mt=v("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);mt.ea=D.L,mt.ha=D.L,N.D(s,st,ft,mt),c=[ft],l=[]}if(e.yu||($e=_(C.Sc),l.push($e),c=l,l=[]),P.debug_view){he=w.Cc(se,!0),t.ba.push(he);var gt=C.GN(he);l.push(gt),N.T(s,gt),N.D(s,c[0],gt,oe),N.D(s,c[0],gt,ie),ce&&(N.D(s,ce,gt,fe),N.D(s,ce,gt,ue)),L.dT(gt),c=l,l=[]}if(ne){var ht=C.Ft();N.T(s,ht),l.push(ht),N.D(s,c[0],ht,Be),N.D(s,c[0],ht,He),c=l,l=[]}var vt=c.slice(0);if(!re&&e.eL){he=w.Cc(se,!0),t.ba.push(he);var bt=C.CN(he);N.T(s,bt),N.D(s,c[0],bt,ne?_e:ie)}if(j&&te&&!re){var Et=Z.uk,At=Z.intensity,xt=Z.Pk,Tt=c[0],yt=!!R,St=v("DEPTH","u_input",1,1,1,!0,!0),Ot=v("COLOR","u_input",1,.25,.25,!0,!0);Ot.ea=D.L,Ot.ha=D.L;var wt=Et/xt,Rt=w.Cc(se,!0);t.ba.push(Rt);var Lt=C.py(Rt,yt,Et,!0,wt,O,xt);N.T(s,Lt),N.D(s,Tt,Lt,St);var wt=Et/xt*.5,Nt=w.Cc(se,!0);t.ba.push(Nt);var It=C.py(Nt,yt,Et,!1,wt,O,xt);N.T(s,It),N.D(s,Lt,It,Ot);var wt=Et/xt*.25,Mt=w.Cc(se,!0);t.ba.push(Mt);var Ct=C.py(Mt,yt,Et,!1,wt,O,xt);N.T(s,Ct),N.D(s,It,Ct,Ot);var Dt=C.JN(At,O);l.push(Dt),N.T(s,Dt);var Ut=v("COLOR","u_main",1,1,1,!0,!0);Ut.ea=D.L,Ut.ha=D.L,N.D(s,Tt,Dt,Ut);var kt=v("COLOR","u_god_rays",1,1,1,!0,!0);kt.ea=D.L,kt.ha=D.L,N.D(s,Ct,Dt,kt),c=l,l=[]}if(X&&!re){var Tt=c[0],Pt=C.LN();N.T(s,Pt),Ut=v("COLOR","u_input",1,1,1,!0,!0),Ut.ea=D.L,Ut.ha=D.L,N.D(s,Tt,Pt,Ut);var Gt=X.key,Ft=X.edge_lum,jt=w.Cc(se,!0);t.ba.push(jt);var Bt=C.MN(Gt,Ft,O,jt);N.T(s,Bt);var Ht=v("COLOR","u_luminance",1,.25,.25,!0,!0);if(Ht.ea=D.L,Ht.ha=D.L,X.adaptive){var Xt=C.DN();N.T(s,Xt),Xt.B.width=1,Xt.B.height=1;var qt=v("COLOR","u_input",1,.25,.25,!0,!0);if(qt.Qg=!0,qt.ea=D.wp,qt.ha=D.L,P.Ab)Ht.Qg=!0,Ht.ea=D.wp,N.D(s,Pt,Xt,qt);else{var zt=C.tN(),Wt=v("COLOR","u_color",1,.25,.25,!0,!0);N.T(s,zt),N.D(s,Pt,zt,Wt),N.D(s,zt,Xt,qt)}N.D(s,Xt,Bt,v("COLOR","u_average_lum",1,1,1,!1,!1)),Bt.ol=!0}else Bt.ol=!1,Bt.average_luminance=X.average_luminance;N.D(s,Tt,Bt,v("COLOR","u_main",1,1,1,!0,!0)),N.D(s,Pt,Bt,Ht);for(var Yt=Bt,Vt=1,Jt=[],me=0;5>me;me++)at=C.wc("X_BLOOM_BLUR"),at.re=e.ai.small_glow_mask_width,rt=v("COLOR","u_color",1,Vt,Vt,!0,!0),rt.ea=D.L,rt.ha=D.L,N.T(s,at),N.D(s,Yt,at,rt),Vt/=2,nt=C.wc("Y_BLOOM_BLUR"),nt.re=e.ai.small_glow_mask_width,ot=v("COLOR","u_color",1,Vt,Vt,!0,!0),ot.ea=D.L,ot.ha=D.L,N.T(s,nt),N.D(s,at,nt,ot),Yt=nt,nt.jn=Vt,at.jn=Vt,Jt.push(nt,Vt);var Kt=C.EN(X.blur);for(N.T(s,Kt),me=0;me<Jt.length;me+=2){var nt=Jt[me],Qt=Jt[me+1],pt=v("COLOR","u_bloom_level_"+(me/2).toString(),1,Qt,Qt,!0,!0);pt.ea=D.L,pt.ha=D.L,N.D(s,nt,Kt,pt)}N.D(s,Tt,Kt,v("COLOR","u_main",1,1,1,!0,!0)),l.push(Kt),c=l,l=[]}if(ee&&te&&!re){var Tt=c[0],Zt=w.Cc(se,!0);if(t.ba.push(Zt),n.dof_bokeh){var $t=v("COLOR","u_color",1,1,1,!0,!0);$t.ea=D.L,$t.ha=D.L;var ea=v("DEPTH","u_depth",1,1,1,!0,!0),ta=v("COLOR","u_color",1,.5,.5,!0,!0);ta.ea=D.Df,ta.ha=D.Df;var aa=v("COLOR","u_color",1,.5,.5,!0,!0);aa.ea=D.Df,aa.ha=D.Df;var ra=v("COLOR","u_blurred1",1,.5,.5,!0,!0);ra.ea=D.L,ra.ha=D.L;var na=v("COLOR","u_blurred2",1,.5,.5,!0,!0);na.ea=D.L,na.ha=D.L;var oa=vt[0];if(n.wd){var ia=w.Cc(se,!0);t.ba.push(ia);var _a=C.ny(ia,"COC_FOREGROUND");ia.dof_distance=n.dof_distance,ia.dof_object=n.dof_object,ia.dof_front_start=n.dof_front_start,ia.dof_front_end=n.dof_front_end,ia.dof_rear_start=n.dof_rear_start,ia.dof_rear_end=n.dof_rear_end,ia.dof_power=n.dof_power,ia.dof_bokeh=n.dof_bokeh,ia.dof_bokeh_intensity=n.dof_bokeh_intensity,ia.wd=n.wd,ia.dof_on=!0,N.T(s,_a),N.D(s,Tt,_a,$t),N.D(s,oa,_a,ea);var sa=C.wc("X_ALPHA_BLUR");N.T(s,sa),N.D(s,_a,sa,ta);var ca=C.wc("Y_ALPHA_BLUR");N.T(s,ca),N.D(s,sa,ca,aa);var la=w.Cc(se,!0),fa=C.ny(la,"COC_COMBINE");t.ba.push(la),la.dof_distance=n.dof_distance,la.dof_object=n.dof_object,la.dof_front_start=n.dof_front_start,la.dof_front_end=n.dof_front_end,la.dof_rear_start=n.dof_rear_start,la.dof_rear_end=n.dof_rear_end,la.dof_power=n.dof_power,la.dof_bokeh=n.dof_bokeh,la.dof_bokeh_intensity=n.dof_bokeh_intensity,la.wd=n.wd,la.dof_on=!0,N.T(s,fa),N.D(s,Tt,fa,$t),N.D(s,oa,fa,ea),N.D(s,ca,fa,v("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else la=w.Cc(se,!0),t.ba.push(la),fa=C.ny(la,"COC_ALL"),la.dof_distance=n.dof_distance,la.dof_object=n.dof_object,la.dof_front_start=n.dof_front_start,la.dof_front_end=n.dof_front_end,la.dof_rear_start=n.dof_rear_start,la.dof_rear_end=n.dof_rear_end,la.dof_power=n.dof_power,la.dof_bokeh=n.dof_bokeh,la.dof_bokeh_intensity=n.dof_bokeh_intensity,la.wd=n.wd,la.dof_on=!0,N.T(s,fa),N.D(s,Tt,fa,$t),N.D(s,oa,fa,ea);var ua=C.wc("X_DOF_BLUR");ua.B.dof_bokeh_intensity=n.dof_bokeh_intensity,N.T(s,ua),N.D(s,fa,ua,ta);var da=C.wc("Y_DOF_BLUR");da.B.dof_bokeh_intensity=n.dof_bokeh_intensity,N.T(s,da),N.D(s,ua,da,aa);var pa=C.wc("Y_DOF_BLUR");pa.B.dof_bokeh_intensity=n.dof_bokeh_intensity,N.T(s,pa),N.D(s,ua,pa,aa);var ma=C.KD(Zt);Zt.dof_distance=n.dof_distance,Zt.dof_object=n.dof_object,Zt.dof_front_start=n.dof_front_start,Zt.dof_front_end=n.dof_front_end,Zt.dof_rear_start=n.dof_rear_start,Zt.dof_rear_end=n.dof_rear_end,Zt.dof_power=n.dof_power,Zt.dof_bokeh=n.dof_bokeh,Zt.dof_bokeh_intensity=n.dof_bokeh_intensity,Zt.wd=n.wd,Zt.dof_on=!0,l.push(ma),N.T(s,ma),N.D(s,Tt,ma,v("COLOR","u_sharp",1,1,1,!0,!0)),N.D(s,da,ma,ra),N.D(s,pa,ma,na)}else{var ga=v("COLOR","u_color",1,1,1,!0,!0);ga.ea=D.L,ga.ha=D.L;var ha=v("COLOR","u_color",1,1,1,!0,!0);ha.ea=D.L,ha.ha=D.L,ua=C.wc("X_BLUR"),N.T(s,ua),N.D(s,Tt,ua,ga);var va=C.wc("Y_BLUR");N.T(s,va),N.D(s,ua,va,ha);var ba=vt[0],ma=C.KD(Zt);Zt.dof_distance=n.dof_distance,Zt.dof_object=n.dof_object,Zt.dof_front_start=n.dof_front_start,Zt.dof_front_end=n.dof_front_end,Zt.dof_rear_start=n.dof_rear_start,Zt.dof_rear_end=n.dof_rear_end,Zt.dof_power=n.dof_power,Zt.dof_bokeh=n.dof_bokeh,Zt.dof_bokeh_intensity=n.dof_bokeh_intensity,Zt.wd=n.wd,Zt.dof_on=!0,l.push(ma),N.T(s,ma),N.D(s,Tt,ma,v("COLOR","u_sharp",1,1,1,!0,!0)),N.D(s,va,ma,v("COLOR","u_blurred",1,1,1,!0,!0)),N.D(s,ba,ma,v("DEPTH","u_depth",1,1,1,!0,!0))}c=l,l=[]}if(e.Hh){var Ea=_(C.ig);l.push(Ea),c=l,l=[]}if(q&&!re){var Aa=c[0],xa=C.NN(K.mb_decay_threshold,K.mb_factor);l.push(xa),N.T(s,xa),N.D(s,Aa,xa,v("COLOR","u_mb_tex_curr",1,1,1,!0,!0)),xa.Sa.push(v("COLOR","u_mb_tex_accum",1,1,1,!0,!0)),c=l,l=[]}if(!re&&e.outline){var Tt=c[0],Ta=w.Cc(se,!0);t.ba.push(Ta);var ya=C.PN(Ta,O);N.T(s,ya);var Sa=C.wc("X_EXTEND"),Oa=v("COLOR","u_color",1,1,1,!0,!0),wa=v("COLOR","u_outline_mask",1,1,1,!0,!0);wa.ea=D.L,wa.ha=D.L,Sa.em=!0,N.T(s,Sa),N.D(s,ya,Sa,Oa);var Ra=v("COLOR","u_color",1,.5,.5,!0,!0);Ra.ea=D.L,Ra.ha=D.L;var La=C.wc("Y_EXTEND");La.em=!0,N.T(s,La),N.D(s,Sa,La,Ra),ua=C.wc("X_BLUR"),ua.em=!0,N.T(s,ua),N.D(s,La,ua,Ra);var Na=v("COLOR","u_color",1,.25,.25,!0,!0);Na.ea=D.L,Na.ha=D.L;var Ia=v("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);Ia.ea=D.L,Ia.ha=D.L,va=C.wc("Y_BLUR"),va.em=!0,N.T(s,va),N.D(s,ua,va,Na);var Ma=C.ON($);N.T(s,Ma);var Ca=v("COLOR","u_outline_src",1,1,1,!0,!0);Ca.ea=D.L,Ca.ha=D.L,N.D(s,Tt,Ma,Ca),N.D(s,ya,Ma,wa),N.D(s,va,Ma,Ia),l.push(Ma),c=l,l=[]}if(a(s,te),(e.anaglyph_use||e.Mu)&&!re){var Da=h(s,e,t,c[0]);l.push(Da),c=l,l=[]}if(z&&!re){var Tt=c[0],Ua=C.FN(Q.brightness,Q.contrast,Q.exposure,Q.saturation),ka=v("COLOR","u_color",1,1,1,!0,!0);ka.ea=D.L,ka.ha=D.L,!e.anaglyph_use&&!e.Mu||re||(ka.Yk=!0),N.T(s,Ua),N.D(s,Tt,Ua,ka),l.push(Ua),c=l,l=[]}if(!c[0].Ob||c[0].type==C.Ih||c[0].type==C.As){var Pa=C.wc("NONE");N.T(s,Pa);var Ga=v("COLOR","u_color",1,1,1,!0,!0);Ga.ea=D.L,Ga.ha=D.L,N.D(s,c[0],Pa,Ga),l.push(Pa),c=l,l=[]}if(W){if(Tt=c[0],P.smaa){var Fa=v("COLOR","u_color",1,1,1,!0,!1);Fa.ea=D.L,Fa.ha=D.L;var ja=C.qy(C.Bs,e);N.T(s,ja),N.D(s,Tt,ja,Fa);var Ba=C.qy(C.vp,e);N.T(s,Ba),N.D(s,ja,Ba,Fa);var Ha=v("COLOR","u_search_tex",1,1,1,!1,!1),Xa=v("COLOR","u_area_tex",1,1,1,!1,!1);Ha.ea=D.L,Ha.ha=D.L,Xa.ea=D.L,Xa.ha=D.L,Ba.Sa.push(Ha),Ba.Sa.push(Xa);var qa=C.qy(C.Cs,e);N.T(s,qa),N.D(s,Tt,qa,Fa);var za=v("COLOR","u_blend",1,1,1,!0,!1);za.ea=D.L,za.ha=D.L,N.D(s,Ba,qa,za),l.push(qa)}else{var Wa=C.BN(e);N.T(s,Wa);var Ya=v("COLOR","u_color",1,1,1,!0,!1);Ya.ea=D.L,Ya.ha=D.L,!e.anaglyph_use&&!e.Mu||re||(Ya.Yk=!0),N.D(s,Tt,Wa,Ya),l.push(Wa)}c=l,l=[]}if(l.push(c[0]),ze&&(We?l.push(We):l.push(ze)),bt&&l.push(bt),le=1,e.kw.FG){var Va=e.kw,Ja=e.jl,Ka=Ja.Am,le=Ka?Ka.PH:le,Qa=C.TN(Ja,O,Va,le);N.T(s,Qa),l.push(Qa)}var Za=C.LD();for(N.T(s,Za),me=0;me<l.length;me++){var $a=l[me];switch($a.type){case C.we:case C.Rg:N.D(s,$a,Za,v("COLOR","NONE",1,1,1,qe,!1)),N.D(s,$a,Za,v("DEPTH","NONE",1,1,1,qe,!1));break;case C.ae:for(N.D(s,$a,Za,v("CUBEMAP","u_sky",le,1,1,!1)),de=0;de<S.length;de++)N.D(s,$a,Fe,S[de]),$e&&N.D(s,$a,$e,S[de]),tt&&N.D(s,$a,tt,S[de]),Ea&&N.D(s,$a,Ea,S[de]);break;case C.Xm:N.D(s,$a,Za,v("COLOR","NONE",1,1,1,!0,!1));break;default:if(re){var er=i[0],tr=v("COLOR","OFFSCREEN",1,1,1,!0,!0);for(tr.Ma=er,N.D(s,l[me],Za,tr),de=1;de<i.length;de++){var ar=i[de],rr=C.wc("NONE");N.T(s,rr),N.D(s,l[me],rr,v("COLOR","SCALE",1,1,1,!0,!0));var nr=ar.yj/er.yj,tr=v("COLOR","OFFSCREEN",1,nr,nr,!0,!0);tr.Ma=ar,N.D(s,rr,Za,tr)}}else N.D(s,l[me],Za,v("SCREEN","NONE",1,1,1,!0,!1))}}if(je&&!T(s,je).length&&(N.nf(s,N.oj(s,je)),N.dy(s)),a(s,te),r(s,te),k.enabled){var or=p(s);or&&m(s,or)}if(o(s),d(s),J&&N.X(s,function(e,t){if(t.type==C.Cf||t.type==C.Sc||t.type==C.ig){for(var a=0,r=x(s,t),n=0,o=0;o<r.length;o++){var i=r[o];i.type==C.ld&&(n++,t.qj=t.qj||[],t.qj[0<i.cg?i.cg:a]=i.B.pb,a++)}t.cp&&t.bp||(P.iv?t.os=new Float32Array(9*n):(t.cp=new Float32Array(4*n),t.bp=new Float32Array(4*n)))}}),!B.ez)for(me=0;me<y.length;me++)y[me].active=!1;return s},e.ER=function(e,t,a){var r=[];N.X(e,function(t,a){if(-1==F.indexOf(a.type)&&a.Sa.length&&E(e,a,C.jg))for(var n=0;n<a.Sa.length;n++){var o=a.Sa[n];-1==r.indexOf(o)&&r.push(o)}}),N.Pg(e,function(t,a,n){t=N.Qa(e,t),a=N.Qa(e,a),-1==F.indexOf(t.type)&&E(e,a,C.jg)&&-1==r.indexOf(n)&&r.push(n)});for(var n=0;n<r.length;n++)r[n].wj*=t,r[n].xj*=a},e.Fd=function(e,t,a){var r=e.re;e.Wr[0]=t*e.yb[0]*r,e.Wr[1]=a*e.yb[1]*r},e.dd=function(e,t){e.re=t},e.qN=function(){var e=N.create(),t=C.QN(),a=w.Yc(w.rc);return a.width=512,a.height=512,t.B=a,N.T(e,t),t.Sa.push(v("COLOR","u_color",512,1,1,!1,!1)),a=C.LD(),N.T(e,a),N.D(e,t,a,v("COLOR","NONE",512,1,1,!1,!1)),o(e),d(e),e},e.PO=function(e){var t=null;return N.X(e,function(e,a){return!(!a.B||null!==a.B.Ee)&&(t=a,!0)}),t},e.Jc=function(e,t,a){for(e=x(e,t),t=0;t<e.length;t++)if(e[t].type==a)return e[t];return null},e.su=function(e,t,a){e=x(e,t),t=[];for(var r=0;r<e.length;r++)e[r].type==a&&t.push(e[r]);return t},e.KX=E,e.MX=A,e.RP=x,e.XP=T,e.bc=function(e,t){var a=null;return N.X(e,function(e,r){return r.type==t&&(a=r,!0)}),a},e.eO=function(e){var t="digraph scenegraph {\n",t=t+"    ",t=t+'size="11.7,16.5";\n',t=t+"    ",t=t+'ratio="fill";\n',t=t+"    ",t=t+'node [shape=box margin="0.25,0.055"];\n',a=y(e);return N.X(e,function(e,r){var n=t+="    ",o=C.ww(r);if(r.B){for(var o=o+"\\n",i=0;i<a.length;i+=2){var _=r.B.$b;a[i]==_&&(o=D.Yn(_)?o+"CR"+a[i+1]+" ":o+"C"+a[i+1]+" ")}for(i=0;i<a.length;i+=2)_=r.B.bf,a[i]==_&&(o=D.Yn(_)?o+"DR"+a[i+1]:o+"D"+a[i+1])}for(r.Sa.length&&(o+="\\n-----\\n"),i=0;i<r.Sa.length;i++)o+=S(r.Sa[i],a);t=n+(String(e)+' [label="')+o+'" color="black" style="'+(r.type==C.zi?"dotted":r.enqueue?"solid":"dashed")+',bold"];\n'}),N.Pg(e,function(e,r,n){t+="    ",t+=String(e)+" -> "+String(r)+' [label="'+S(n,a)+'" style="'+(n.active?"solid":"dotted")+'"];\n'}),t+="}"},e.sN=function(e){e=N.kU(e);for(var t=[],a=0;a<e.length;a++){var r=e[a];r.enqueue&&t.push(r)}return t},e.Dl=function(e,t,a){var r=N.oj(e,t);for(N.Ij(e,r,function(e,t,r){if(r.active){switch(r.from){case"COLOR":case"CUBEMAP":var n=t.B.$b;break;case"DEPTH":n=t.B.bf;break;case"SCREEN":n=null;break;case C.kd:return;default:U.F("Wrong slink")}switch(r.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"u_cube_reflection":case"u_plane_reflection":break;default:n||U.F("Connection of SCREEN is forbidden"),n.Oe&&U.F("Batch texture can't use renderbuffer"),M.mD(a.ib,r.to)&&O.Rj(a,n,r.to)}}}),e=0;e<t.Sa.length;e++){var r=t.Sa[e],n=t.Og[e];switch(r.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":break;default:n.Oe&&U.F("Batch texture can't use renderbuffer"),M.mD(a.ib,r.to)&&O.Rj(a,n,r.to)}}}},a.module.__subscene=function(e,t){function a(e,t){e.oo=t,e.br=new Float32Array(3*t),e.im=new Float32Array(4*t),e.hm=new Float32Array(4*t)}function r(e){return e={type:e,sb:"",Ql:!1,kb:!1,Gv:!1,Fp:!1,jo:!1,un:0,af:0,ak:[],debug_view_mode:0,debug_colors_seed:0,Lt:1,xq:!1,time:0,B:null,Si:null,Il:[],Pa:[],Sa:[],Og:[],Fh:new Float32Array(3),ad:new Float32Array(3),Sd:new Float32Array(4),ff:new Float32Array(4),$e:new Float32Array(16),Io:0,Nf:0,oo:0,br:null,im:null,hm:null,DF:null,yd:new Float32Array(3),Ld:new Float32Array(3),Jo:new Float32Array(4),yw:new Float32Array(3),xw:new Float32Array([0,0,1]),zw:new Float32Array(4),Ho:new Float32Array(3),jw:"",gt:0,sm:0,yq:0,em:!1,rh:new Float32Array(3),wf:!1,Sp:0,Eh:new Float32Array(4),vi:0,Jf:!1,lt:0,mt:new Float32Array(2),kt:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Ok:new Float32Array(3),No:!1,Ko:!1,Lo:0,Po:0,Oo:0,Mo:0,Dm:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,uk:0,xo:0,Pk:0,pq:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,cp:null,bp:null,os:null,qj:null,Ob:!1,ju:"",ln:0,hn:0,kn:0,ol:!0,average_luminance:0,Np:0,Dq:0,mb_decay_threshold:0,mb_factor:0,qv:0,vr:"",tt:"",vz:new Float32Array(2),av:0,bt:2,jn:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Wr:new Float32Array(2),yb:new Float32Array(2),Ui:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,cg:0,hr:!0,iw:!1,qw:!1,mw:!1,nw:!1,pw:!1,ow:!1,hw:"",Jm:!1,Km:!1,Lm:!1,Vb:!0,enqueue:!0,rb:!0,ub:!0,td:!0,Ea:!0,re:1},e.yb[0]=1,e.yb[1]=1,e.Ui[2]=.5,e.Ui[3]=.5,e.Dm=8,e}function n(e,t){return e==t?0:e>t?1:-1}function o(e,t){return n(e.Te,t.Te)||n(e.ej,t.ej)||n(e.ph,t.ph)||n(e.ib.WE,t.ib.WE)||n(e.ib.KA,t.ib.KA)}var i=t("__camera"),_=t("__config"),s=t("__util"),c=t("__boundings"),l=_.Oc;e.Gb=0,e.Sc=1,e.ig=2,e.Nd=3,e.kd=4,e.Bf=5,e.Qe=6,e.Md=7,e.ld=8,e.Cf=9,e.yi=10,e.Tb=11,e.qp=13,e.As=14,e.we=15,e.Rg=16,e.Sg=17,e.Xm=18,e.JB=19,e.Ds=20,e.zx=21,e.EB=22,e.vp=23,e.Bs=24,e.xx=25,e.Cs=26,e.nx=27,e.Ih=28,e.mx=29,e.pp=30,e.Tg=31,e.$m=32,e.Zm=33,e.xs=34,e.ae=35,e.ox=36,e.jg=37,e.LUMINANCE=38,e.HB=39,e.ys=40,e.lp=41,e.VK=42,e.zi=43,e.sp=44,e.eC=45,e.RN=function(e,t,n,o){var _=r(8);switch(_.pq=e,_.self_shadow_polygon_offset=n.self_shadow_polygon_offset,_.cg=t,n.lh[t]){case"SPOT":case"POINT":_.B=i.Yc(i.Gc),i.ZG(_.B,n.zH[t],n.$p[t],n.Zp[t]);break;default:_.B=i.Yc(i.Ai)}return a(_,o),_},e.MM=function(e){var t=r(e.type);return t.sb=e.sb,t.Ql=e.Ql,t.Vb=e.Vb,t.enqueue=e.enqueue,t.rb=e.rb,t.ub=e.ub,t.td=e.td,t.kb=e.kb,t.Gv=e.Gv,t.Fp=e.Fp,t.jo=e.jo,t.Ea=e.Ea,t.un=0,t.af=0,t.ak=[],t.debug_view_mode=e.debug_view_mode,t.debug_colors_seed=e.debug_colors_seed,t.Lt=e.Lt,t.xq=e.xq,t.time=e.time,t.B=i.Cc(e.B,!0),t.Si=s.P(e.Si),t.Il=s.P(e.Il),t.Pa=s.P(e.Pa),t.Sa=s.P(e.Sa),t.Og=s.P(e.Og),t.Fh.set(e.Fh),t.ad.set(e.ad),t.Sd.set(e.Sd),t.ff.set(e.ff),t.$e.set(e.$e),t.Io=e.Io,t.Nf=e.Nf,t.oo=e.oo,t.br=s.P(e.br),t.im=s.P(e.im),t.hm=s.P(e.hm),t.DF=s.P(e.DF),t.yd.set(e.yd),t.Ld.set(e.Ld),t.Jo.set(e.Jo),t.yw.set(e.yw),t.xw.set(e.xw),t.zw.set(e.zw),t.Ho.set(e.Ho),t.jw=e.jw,t.gt=e.gt,t.sm=e.sm,t.yq=e.yq,t.em=e.em,t.rh.set(e.rh),t.wf=e.wf,t.Sp=e.Sp,t.Eh.set(e.Eh),t.vi=e.vi,t.Jf=e.Jf,t.lt=e.lt,t.mt.set(e.mt),t.kt=e.kt,t.procedural_skydome=e.procedural_skydome,t.use_as_environment_lighting=e.use_as_environment_lighting,t.mie_brightness=e.mie_brightness,t.rayleigh_brightness=e.rayleigh_brightness,t.spot_brightness=e.spot_brightness,t.mie_strength=e.mie_strength,t.rayleigh_strength=e.rayleigh_strength,t.scatter_strength=e.scatter_strength,t.mie_collection_power=e.mie_collection_power,t.rayleigh_collection_power=e.rayleigh_collection_power,t.mie_distribution=e.mie_distribution,t.Ok.set(e.Ok),t.No=e.No,t.Ko=e.Ko,t.Lo=e.Lo,t.Po=e.Po,t.Oo=e.Oo,t.Mo=e.Mo,t.Dm=e.Dm,t.ssao_only=e.ssao_only,t.ssao_white=e.ssao_white,t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t.god_rays_intensity=e.god_rays_intensity,t.uk=e.uk,t.xo=e.xo,t.Pk=e.Pk,t.pq=e.pq,t.self_shadow_polygon_offset=e.self_shadow_polygon_offset,t.self_shadow_normal_offset=e.self_shadow_normal_offset,t.cp=s.P(e.cp),t.bp=s.P(e.bp),t.os=s.P(e.os),t.qj=s.P(e.qj),t.Ob=e.Ob,t.ju=e.ju,t.ln=e.ln,t.hn=e.hn,t.kn=e.kn,t.ol=e.ol,t.average_luminance=e.average_luminance,t.Np=e.Np,t.Dq=e.Dq,t.mb_decay_threshold=e.mb_decay_threshold,t.mb_factor=e.mb_factor,t.qv=e.qv,t.vr=e.vr,t.tt=e.tt,t.vz.set(e.vz),t.av=e.av,t.bt=e.bt,t.jn=e.jn,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.re=e.re,t.Wr.set(e.Wr),t.yb.set(e.yb),t.Ui.set(e.Ui),t.chromatic_aberration_coefs.set(e.chromatic_aberration_coefs),t.enable_hmd_stereo=e.enable_hmd_stereo,t.cg=e.cg,t.hr=e.hr,t.iw=e.iw,t.qw=e.qw,t.mw=e.mw,t.nw=e.nw,t.pw=e.pw,t.ow=e.ow,t.hw=e.hw,t.Jm=e.Jm,t.Km=e.Km,t.Lm=e.Lm,t},e.KN=function(){var e=r(10);return e.B=i.Yc(i.Vg),e},e.wc=function(e){var t=r(11);switch(t.rb=!1,t.ub=!1,t.td=!1,t.Ob=!0,t.B=i.Yc(i.rc),t.vr=e,e){case"NONE":case"GRAYSCALE":t.yb[0]=1,t.yb[1]=1;break;case"X_BLUR":t.yb[0]=1,t.yb[1]=0;break;case"Y_BLUR":t.yb[0]=0,t.yb[1]=1;break;case"X_GLOW_BLUR":t.yb[0]=1,t.yb[1]=0;break;case"Y_GLOW_BLUR":t.yb[0]=0,t.yb[1]=1;break;case"X_BLOOM_BLUR":t.yb[0]=1,t.yb[1]=0;break;case"Y_BLOOM_BLUR":t.yb[0]=0,t.yb[1]=1;break;case"X_DOF_BLUR":case"Y_DOF_BLUR":t.yb[0]=1,t.yb[1]=1;break;case"X_ALPHA_BLUR":t.yb[0]=1,t.yb[1]=0,t.re=3;break;case"Y_ALPHA_BLUR":t.yb[0]=0,t.yb[1]=1,t.re=3;break;case"X_EXTEND":t.yb[0]=1,t.yb[1]=0;break;case"Y_EXTEND":t.yb[0]=0,t.yb[1]=1;break;default:s.F("Wrong postprocessing effect: "+e)}return t},e.IN=function(e,t){var a=r(13);return a.rb=!1,a.ub=!1,a.td=!1,a.small_glow_mask_coeff=t.ai.small_glow_mask_coeff,a.large_glow_mask_coeff=t.ai.large_glow_mask_coeff,a.small_glow_mask_width=t.ai.small_glow_mask_width,a.large_glow_mask_width=t.ai.large_glow_mask_width,a.B=e,a.Ob=!0,a},e.Hl=function(e,t,n,o,i,_,c,l,f){var u=r(e);return 0==e?(u.rb=!0,u.ub=n,u.kb=!1):1==e?(u.rb=!1,u.ub=!1,u.kb=!0):2==e?(u.rb=!1,u.ub=!0,u.kb=!0):3==e||4==e?(u.rb=!0,u.ub=!0,u.kb=!1):5==e||6==e?(u.rb=!1,u.ub=!1,u.kb=!0):7==e?(u.rb=!0,u.ub=!1,u.kb=!0):s.F("wrong main subscene type"),u.kb&&l&&(u.self_shadow_normal_offset=l.self_shadow_normal_offset),u.B=t,(e=c.Am)&&(u.Jo.set([e.RC,e.aF,e.RI,e.QI]),u.Ho.set(e.color),u.Io=e.Aa),u.yd.set(c.yd),u.Ld.set(c.Ld),u.Nf=c.Nf,u.Sd=_.Sd,u.ff=_.ff,o&&(o.Sd&&u.Eh.set(o.Sd),u.vi=o.vi,o.Jf&&f&&(u.Jf=!0,u.lt=o.kM,u.kt=o.jM,u.mt.set(o.lM))),a(u,i),u},e.Ft=function(){var e=r(14);return e.Ob=!0,e.B=i.Yc(i.rc),e},e.JD=function(e,t,n){var o=r(15);return t&&(o.type=16,o.rb=!1,o.ub=!0),o.enqueue=!1,o.B=e,a(o,n),o},e.GN=function(e){var t=r(17);return t.Vb=!1,t.rb=!1,t.ub=!1,t.B=e,t},e.CN=function(e){var t=r(18);return t.rb=!0,t.ub=!1,t.B=e,t},e.SN=function(e,t){var n=r(9);return n.B=e,a(n,t),n},e.HN=function(e){var t=r(19);return t.rb=!1,t.ub=!1,t.B=e,t.Ob=!0,t},e.UN=function(e,t,a){var n=r(20);return n.rb=!1,n.ub=!1,n.td=!1,n.B=e,n.Sd=t.Sd,n.Eh.set(t.Sd),n.Po=a.radius_increase,n.No=a.nQ,n.Oo=a.influence,n.Mo=a.dist_factor,n.Dm=a.SS,n.Ob=!0,n},e.VN=function(e,t){var a=r(21);return a.rb=!1,a.ub=!1,a.td=!1,a.B=e,a.Ko=t.UL,a.Lo=t.blur_discard_value,a.Ob=!0,a},e.BN=function(e){var t=r(22);return t.rb=!1,t.ub=!1,t.td=!1,t.re=1/e.zo,t.ju=e.rC,t.B=i.Yc(i.rc),t.Ob=!0,t},e.qy=function(e,t){var a=r(e);return a.rb=23==e||24==e,a.ub=!1,a.td=!1,a.re=1/t.zo,a.B=i.Yc(i.rc),23==e&&(a.LQ=new Float32Array(4)),a.Ob=!0,a},e.FN=function(e,t,a,n){var o=r(27);return o.rb=!1,o.ub=!1,o.td=!1,o.B=i.Yc(i.rc),o.brightness=e,o.contrast=t,o.exposure=a,o.saturation=n,o.Ob=!0,o},e.NN=function(e,t){var a=r(28);return a.rb=!1,a.ub=!1,a.td=!1,a.B=i.Yc(i.rc),a.Fp=!0,a.mb_decay_threshold=e,a.mb_factor=t,a.Ob=!0,a},e.ny=function(e,t){var a=r(29);return a.rb=!1,a.ub=!1,a.td=!1,a.B=e,a.re=a.B.dof_power,a.tt=t,a.Ob=!0,a},e.KD=function(e){var t=r(30);return t.rb=!1,t.ub=!1,t.td=!1,t.B=e,t.re=t.B.dof_power,t.Ob=!0,t},e.PN=function(e,t){var n=r(31);return n.td=!1,n.B=e,a(n,t),n},e.ON=function(e){var t=r(32);return l.outlining_overview_mode?t.rh.set(l.rh):t.rh.set(e.rh),t.sm=e.sm,t.Dq=5,t.Np=3,t.td=!1,t.B=i.Yc(i.rc),t.Ob=!0,t},e.py=function(e,t,n,o,i,_,s){var c=r(33);return c.rb=!1,c.ub=!1,c.td=!1,c.yd=new Float32Array([1,1,1]),c.Ld=new Float32Array([1,1,1]),c.Nf=1,c.Gv=o,c.wf=t,c.xo=i,c.uk=n,c.Pk=s,c.B=e,a(c,_),c},e.JN=function(e,t){var n=r(34);return n.rb=!1,n.ub=!1,n.td=!1,n.B=i.Yc(i.rc),n.god_rays_intensity=e,a(n,t),n.Ob=!0,n},e.TN=function(e,t,n,o){var _=r(35);_.enqueue=!1,_.rb=!1,_.ub=!1,_.td=!1;var c=i.Yc(i.rc);return c.width=o,c.height=o,_.B=c,_.Si=s.fP(),a(_,t),_.yd=new Float32Array([1,1,1]),_.Ld=new Float32Array([1,1,1]),_.Nf=1,_.Ok.set(n.Ok),_.procedural_skydome=n.procedural_skydome,_.use_as_environment_lighting=n.use_as_environment_lighting,_.rayleigh_brightness=n.rayleigh_brightness,_.mie_brightness=n.mie_brightness,_.spot_brightness=n.spot_brightness,_.scatter_strength=n.scatter_strength,_.rayleigh_strength=n.rayleigh_strength,_.mie_strength=n.mie_strength,_.rayleigh_collection_power=n.rayleigh_collection_power,_.mie_collection_power=n.mie_collection_power,_.mie_distribution=n.mie_distribution,e&&(_.yd.set(e.yd),_.Ld.set(e.Ld),_.Nf=e.Nf,(t=e.Am)&&(_.Jo.set([t.RC,t.aF,t.RI,t.QI]),_.Ho.set(t.color),_.Io=t.Aa,_.iw=t.invert,_.qw=t.uI,_.mw=t.pI,_.nw=t.qI,_.pw=t.sI,_.ow=t.rI,_.hw=t.SC),_.Jm=e.Jm,_.Km=e.Km,_.Lm=e.Lm,_.jw=e.Wd),_},e.oy=function(){var e=r(36);return e.rb=!1,e.ub=!1,e.B=i.Yc(i.rc),e.Ob=!0,e},e.WN=function(e){var t=r(37);return t.rb=!1,t.ub=!1,t.sb=e?"HMD":"ANAGLYPH",t.B=i.Yc(i.rc),t.Ob=!0,t},e.LN=function(){var e=r(38);return e.rb=!1,e.ub=!1,e.B=i.Yc(i.rc),e.Ob=!0,e},e.DN=function(){var e=r(39);return e.rb=!1,e.ub=!1,e.B=i.Yc(i.rc),e.Ob=!0,e},e.tN=function(){var e=r(45);return e.rb=!1,e.ub=!1,e.B=i.Yc(i.rc),e.Ob=!0,e},e.MN=function(e,t,n,o){var i=r(40);return i.rb=!1,i.ub=!1,i.ln=e,i.kn=t,i.B=o,a(i,n),i.Ob=!0,i},e.EN=function(e){var t=r(41);return t.rb=!1,t.ub=!1,t.B=i.Yc(i.rc),t.hn=e,t.bt=5,t.Ob=!0,t},e.cX=function(e){var t=r(42);return t.rb=!1,t.ub=!1,t.B=e,t.Ob=!0,t},e.LD=function(){var e=r(43);return e.enqueue=!1,e},e.QN=function(){var e=r(44);return e.Ob=!0,e},e.ww=function(e){switch(e.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+e.vr.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}},e.Ic=function(e,t){for(var a=t.ra,r=a.ib,n=a.Te,o=0;o<e.Pa.length;o++){var i=e.Pa[o].Ca,_=i.indexOf(t);if(-1!=_&&(i.splice(_,1),!i.length)){e.Pa.splice(o,1);break}}o=e.kb?a.ph:0;e:{for(i=e.Pa,_=0;_<i.length;_++){var s=i[_];if(s.ib==r&&s.Te==n&&s.ph==o&&s.ej==a.ej){i=s;break e}}i=null}i?i.Ca.push(t):(e.Pa.push({ib:r,Ca:[t],Te:n,ph:o,ej:a.ej,Vb:!0}),e.hr=!0)},e.di=function(e,t,a){return t={Vb:!0,Ay:[!0,!0,!0,!0,!0,!0],Yf:t,ra:e,DB:a||null,Ou:null},e.Pe&&e.ga.Td&&(a=e.ga.Td,t.Ou={zR:new Float32Array(a.length),AR:new Float32Array(a.length),nO:new Float32Array(a.length/3),SI:new Float32Array(3),NL:c.eM(e.Ta.ee)}),t},e.OT=function(e){e.Pa.sort(o),e.hr=!1}},a.module.__texcomp=function(e,t){function a(e,t,a,r){var n,_,f,u,d,p,m=new Int32Array(a,0,31);if(542327876!=m[0])return i.error("Invalid magic number in DDS header"),0;if(4&!m[20])return i.error("Unsupported format, must contain a FourCC code"),0;switch(n=m[21]){case s:_=8,f=t?t.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case c:_=16,f=t?t.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case l:_=16,f=t?t.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return i.error("Unsupported FourCC code:",o(n)),null}if(p=1,131072&m[2]&&!1!==r&&(p=Math.max(1,m[7])),u=m[4],d=m[3],m=m[1]+4,t)for(n=0;n<p;++n)r=Math.max(4,u)/4*Math.max(4,d)/4*_,t=new Uint8Array(a,m,r),e.compressedTexImage2D(e.TEXTURE_2D,n,f,u,d,0,t),m+=r,u=Math.max(.5*u,1),d=Math.max(.5*d,1);else{if(n!=s)return i.error("No manual decoder for",o(n),"and no native support"),0;a=t=new Uint16Array(a),_=m/2,f=u,m=new Uint16Array(4),t=new Uint16Array(f*d);for(var g,h,v,b,E,A,x=f/4,T=d/4,y=0;y<T;y++)for(var S=0;S<x;S++)n=_+4*(y*x+S),m[0]=a[n],m[1]=a[n+1],g=31&m[0],h=2016&m[0],v=63488&m[0],b=31&m[1],E=2016&m[1],A=63488&m[1],m[2]=5*g+3*b>>3|5*h+3*E>>3&2016|5*v+3*A>>3&63488,m[3]=5*b+3*g>>3|5*E+3*h>>3&2016|5*A+3*v>>3&63488,g=a[n+2],h=4*y*f+4*S,t[h]=m[3&g],t[h+1]=m[g>>2&3],t[h+2]=m[g>>4&3],t[h+3]=m[g>>6&3],h+=f,t[h]=m[g>>8&3],t[h+1]=m[g>>10&3],t[h+2]=m[g>>12&3],t[h+3]=m[g>>14],g=a[n+3],h+=f,t[h]=m[3&g],t[h+1]=m[g>>2&3],t[h+2]=m[g>>4&3],t[h+3]=m[g>>6&3],h+=f,t[h]=m[g>>8&3],t[h+1]=m[g>>10&3],t[h+2]=m[g>>12&3],t[h+3]=m[g>>14];e.texImage2D(e.TEXTURE_2D,0,e.RGB,u,d,0,e.RGB,e.UNSIGNED_SHORT_5_6_5,t),r&&e.generateMipmap(e.TEXTURE_2D)}return p}function r(e,t,r,n,o){var i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status){e.bindTexture(e.TEXTURE_2D,n);var r=a(e,t,i.response,!0);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,1<r?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)}o&&o(n)},i.send(null)}function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function o(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var i=t("__print"),_=t("__util"),s=n("DXT1"),c=n("DXT3"),l=n("DXT5");e.dV=a,e.eV=function(e,t,a){var r=new Uint32Array(a,0,13);if(55727696==r[0]){var n=r[7],o=r[6],i=r[11],s=52+r[12];switch(r[2]){case 0:var c=2,l=1;break;case 1:c=2,l=3;break;case 2:c=4,l=0;break;case 3:c=4,l=2;break;default:_.F("Unsupported PVR V3 format.")}}else if(559044176==r[11]){n=r[2],o=r[1],i=r[3],s=r[0],i++;var f=255&r[4],r=0<r[10];25==f?(c=4,l=r?2:0):24==f?(c=2,l=r?3:1):_.F("Unsupported PVR V2 format.")}else _.F("Unsupported PVR version.");switch(f=2==c?8:4,r=4,l){case 0:var u=t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:u=t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:u=t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:u=t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}for(t=f*r*c/8,c=0;c<i;c++){var l=Math.max(n>>c,1),d=Math.max(o>>c,1),p=l/f,m=d/r;2>p&&(p=2),2>m&&(m=2),p=p*m*t,m=new Uint8Array(a,s,p),e.compressedTexImage2D(e.TEXTURE_2D,c,u,l,d,0,m),s+=p}},e.PE=function(e,t){switch(t){case"dds":var a=new Int32Array(e,0,31);return{width:a[4],height:a[3]};case"pvr":if(a=new Uint32Array(e,0,13),55727696==a[0])var r=a[7],a=a[6];else r=a[2],a=a[1];return{width:r,height:a}}},e.yP=function(e,t){var a=1;if("dds"==t){var r=new Int32Array(e,0,31),n=r[21];switch(n){case s:a=6;break;case c:case l:a=4;break;default:i.error("Unsupported FourCC code:",o(n))}}else if("pvr"==t)if(r=new Uint32Array(e,0,13),55727696==r[0])switch(r[2]){case 0:a=12;break;case 1:a=16;break;case 2:a=6;break;case 3:a=8}else n=255&r[4],r=0<r[10],25==n?a=r?8:6:24==n&&(a=r?16:12);return a},e.gY=function(e,t,a,n){var o=e.createTexture();return r(e,t,a,o,n),o}},a.module.__textures=function(e,t){function a(){return ne||(ne=ce.createFramebuffer()),ne}function r(){return re||(re=ce.createTexture()),re}function n(){return{type:0,source:"",Pr:"",width:0,height:0,lq:1,anisotropic_filtering:0,yj:1024,ck:!1,rg:null,lb:0,zb:null,Oe:null,dj:!1,ss:-1,Wa:null,Yw:"",vk:0,gh:0,sa:0,Wb:0,ek:0,Gg:!1,zh:1,Qg:!1,VF:0,sd:null,Ir:0,Hr:0,vj:-1,Kr:!1,Lk:-1,qs:!1,uB:!1,Jj:!1,bl:!1,repeat:!0,jk:"",Un:"",Yl:"",jz:"",iz:"",ik:""}}function o(e,t,a){e.Yl=t.uuid,e.Un=t.filepath,e.jz=t.source,e.iz=t.name,e.jk=W.ji(a+t.filepath),e.ik=t.kg,-1==ie.fa.indexOf(e)&&(ie.fa.push(e),ie.bo.push(!1))}function i(e,t,a){var r=-1<t.indexOf(".pvr");e.ik=-1<t.indexOf(".dds")?"dds":r?"pvr":"",e.Un=t,e.jk=a,e.Yl=W.lu(),ie.fa.push(e),ie.bo.push(!0)}function _(t,a,r){var o=n();if(o.type=t,o.source="NONE",o.Qg=r,t==e.Gs||t==e.Es||t==e.Hs||t==e.Fs)o.Oe=ce.createRenderbuffer();else{var i=ce.TEXTURE_2D,_=ce.createTexture();ce.bindTexture(i,_),ce.texParameteri(i,ce.TEXTURE_MAG_FILTER,ce.LINEAR),r?ce.texParameteri(i,ce.TEXTURE_MIN_FILTER,oe[$.Ej]):ce.texParameteri(i,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(i,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(i,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),r=v(o);var s=b(o),c=A(o);ce.texImage2D(i,0,s,1,1,0,r,c,t==e.ll?null:new Uint8Array([204,204,204,255])),$.jq&&a&&ce.texParameterf(i,ce.TEXTURE_COMPARE_MODE,ce.COMPARE_REF_TO_TEXTURE),ce.bindTexture(i,null),o.lb=i,o.zb=_}return o}function s(e){var t=e.lb;ce.bindTexture(t,e.zb);var a=v(e),r=b(e),n=A(e),o=e.rg.canvas;ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!0),ce.texImage2D(t,0,r,a,n,o),ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!1),e.ck&&ce.generateMipmap(t),ce.bindTexture(t,null),e.width=o.width,e.height=o.height}function c(e){var t=e.lb;ce.bindTexture(t,e.zb),ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!0),4!=e.Wa.length?e.Gg?u(e,e.Wa,e.width*e.zh,e.height*e.zh,!1):ce.texImage2D(t,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,e.Wa):ce.texImage2D(t,0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,e.Wa),ce.bindTexture(t,null)}function l(e){var t=e.lb;ce.bindTexture(t,e.zb),ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!0),e.Gg?u(e,e.sd[e.vj],e.width*e.zh,e.height*e.zh,!1):ce.texImage2D(t,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,e.sd[e.vj]),ce.bindTexture(t,null)}function f(){return ae||(ae=document.createElement("canvas")),ae}function u(e,t,n,o,i){i||(p(ce.TEXTURE_2D),ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,t)),ce.bindTexture(ce.TEXTURE_2D,null),t=a(),i=r(),Y.rO(e,n,o,t,i)}function d(e,t,a){for(var r=0;6>r;r++){var n=le[r],o=fe[r],i=f();i.width=a,i.height=a;var _=i.getContext("2d");_.translate(a/2,a/2),"TEXTURE_CUBE_MAP_POSITIVE_X"==n?(_.rotate(Math.PI/2),_.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==n?(_.rotate(Math.PI/2),_.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==n||"TEXTURE_CUBE_MAP_POSITIVE_Z"==n?_.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=n&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=n||_.scale(-1,1),_.drawImage(e,o[0]*t,o[1]*t,t,t,-a/2,-a/2,a,a),$.QD?ce.texImage2D(ce[n],0,ce.RGBA,a,a,0,ce.RGBA,ce.UNSIGNED_BYTE,new Uint8Array(_.getImageData(0,0,a,a).data.buffer)):ce.texImage2D(ce[n],0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,i)}}function p(e){ce.bindTexture(e,null);var t=r();ce.bindTexture(e,t),ce.texParameteri(e,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(e,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(e,ce.TEXTURE_MAG_FILTER,ce.LINEAR),ce.texParameteri(e,ce.TEXTURE_MIN_FILTER,ce.LINEAR)}function m(e,t,n){var o,i=e.source,_=e.zb,s=e.lb,c=e.ik,l=e.Un;if(ce.bindTexture(s,_),e.repeat?(ce.texParameteri(s,ce.TEXTURE_WRAP_S,ce.REPEAT),ce.texParameteri(s,ce.TEXTURE_WRAP_T,ce.REPEAT)):(ce.texParameteri(s,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(s,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE)),e.dj||"NODE_TEX"==i?ce.texParameteri(s,ce.TEXTURE_MIN_FILTER,ce.LINEAR):ce.texParameteri(s,ce.TEXTURE_MIN_FILTER,oe[$.Ej]),e.anisotropic_filtering&&ce.texParameterf(s,X.Ny().TEXTURE_MAX_ANISOTROPY_EXT,e.anisotropic_filtering),4==t.length&&(o=!0,t=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])),"IMAGE"==i)if(o)ce.texImage2D(s,0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,t),e.width=1,e.height=1;else if(c){if(o=B.PE(t,c),n=W.Yp(o.width)||W.Yp(o.height),o.width>ee.Qb||o.height>ee.Qb)return void q.error('Image "'+l+'" has unsupported size: '+o.width+"x"+o.height+". Max available: "+ee.Qb+"x"+ee.Qb+".");i=o.width,o=o.height,(n||"pvr"==c)&&(e.Gg=!0,p(s),i=h(i*e.zh),o=h(o*e.zh)),"dds"==c?B.dV(ce,X.JE(),t,!0):"pvr"==c&&B.eV(ce,X.IE(),t),e.Gg&&(u(e,null,i,o,!0),ce.bindTexture(s,_),ce.generateMipmap(s)),e.width=i,e.height=o,e.lq=B.yP(t,c)}else ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!0),e.dj?$.Jr?(i=t[0].width,o=t[0].height):(i=t.videoWidth,o=t.videoHeight):(i=t.width,o=t.height),e.width=i,e.height=o,(i>ee.Qb||o>ee.Qb)&&(q.warn('Image "'+l+'" has unsupported size: '+i+"x"+o+". Max available: "+ee.Qb+"x"+ee.Qb+". Reduced image size will be used."),e.zh=Math.min(ee.Qb/i,ee.Qb/o),e.Gg=!0),e.dj&&(n in se||(se[n]={}),se[n][e.Yw]=e,$.Jr?(e.sd=t,e.Ir=t.length,e.gh=e.Hr*e.vk/t.length,t=t[0]):(e.Wa=t,e.Wa.loop=e.Jj,e.gh=t.duration?e.vk/t.duration:z.pd(),te.YD||(t.playbackRate=z.pd()/e.gh,te.qD&&2<t.playbackRate&&(t.playbackRate=2)),g(e))),i=h(e.width*e.zh),o=h(e.height*e.zh),e.Gg||$.IG?(l=f(),c=l.getContext("2d"),l.width=i,l.height=o,c.drawImage(t,0,0,e.width,e.height,0,0,i,o),$.QD?ce.texImage2D(s,0,ce.RGBA,i,o,0,ce.RGBA,ce.UNSIGNED_BYTE,new Uint8Array(c.getImageData(0,0,i,o).data.buffer)):ce.texImage2D(s,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,l)):$.Ab||!W.Yp(e.width)&&!W.Yp(e.height)?ce.texImage2D(s,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,t):(u(e,t,i,o,!1),e.Gg=!0),e.width=i,e.height=o,e.dj||(ce.bindTexture(s,_),ce.generateMipmap(s));else if("ENVIRONMENT_MAP"==i)if(o){for(_=0;6>_;_++)ce.texImage2D(ce["TEXTURE_CUBE_MAP_"+le[_]],0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,t);e.width=3,e.height=2}else{if(ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!1),t.width%3||t.height%2)return void q.error('Cubemap Image "'+l+'" has unsupported size: '+t.width+"x"+t.height+". The width must be multiple of three and the height - multiple of two.");if(_=t.width/3,_>ee.Wf?(q.warn('Cubemap Image "'+l+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+3*ee.Wf+"x"+2*ee.Wf+". Reduced image size will be used."),l=h(ee.Wf/_*_),e.Gg=!0):(l=h(_),!$.Ab&&(3*l>ee.Qb||2*l>ee.Qb)&&(e.Gg=!0)),e.Gg||$.Er)d(t,_,l);else{for(c=t,i=l,p(ce.TEXTURE_2D),ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,ce.RGBA,ce.UNSIGNED_BYTE,c),ce.bindTexture(ce.TEXTURE_2D,null),c=0;6>c;c++)ce.texImage2D(ce.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,ce.RGBA,i,i,0,ce.RGBA,ce.UNSIGNED_BYTE,null);for(ce.bindTexture(e.lb,null),c=a(),ce.bindFramebuffer(ce.FRAMEBUFFER,c),o=r(),c=0;6>c;c++)Y.qO(e,ce[le[c]],i,_,o,c);ce.bindFramebuffer(ce.FRAMEBUFFER,null),ce.bindTexture(e.lb,e.zb),ce.texParameteri(e.lb,ce.TEXTURE_MIN_FILTER,oe[$.Ej]),ce.texParameteri(e.lb,ce.TEXTURE_MAG_FILTER,ce.LINEAR)}H.vM()&&(q.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),d(t,_,F.$B)),e.width=3*l,e.height=2*l,ce.generateMipmap(s)}else"NODE_TEX"==i&&(ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,!1),ce.texImage2D(s,0,ce.RGBA,t.width,t.height,0,ce.RGBA,ce.UNSIGNED_BYTE,t.data),e.width=t.width,e.height=t.height);ce.bindTexture(s,null)}function g(e){e.Wa.oncanplay=function(){O(e)&&c(e)}}function h(e){return W.Yp(e)?W.clamp(Math.pow(2,(0|e).toString(2).length),2,ee.Qb):e}function v(t){var a;switch(t.type){case e.Ug:a=ce.RGBA;break;case e.Is:a=ce.RGB;break;case e.xp:a=ce.RGBA;break;case e.yp:a=ce.RGB;break;case e.ll:a=ce.DEPTH_COMPONENT;break;default:W.F("Wrong texture type")}return a}function b(t){var a;switch(t.type){case e.Ug:a=$.Ab?ce.RGBA8:ce.RGBA;break;case e.Is:a=$.Ab?ce.RGB8:ce.RGB;break;case e.xp:a=$.Ab?ce.RGBA8:ce.RGBA;break;case e.yp:a=$.Ab?ce.RGB8:ce.RGB;break;case e.ll:a=$.Ab?E(ee.xn):ce.DEPTH_COMPONENT;break;default:W.F("Wrong texture type")}return a}function E(e){switch(e){case 16:e=ce.DEPTH_COMPONENT16;break;case 24:e=ce.DEPTH_COMPONENT24;break;case 32:e=ce.DEPTH_COMPONENT32F;break;default:e=ce.DEPTH_COMPONENT24}return e}function A(t){var a;switch(t.type){case e.Ug:case e.Is:a=ce.UNSIGNED_BYTE;break;case e.xp:case e.yp:a=ce.FLOAT;break;case e.ll:a=ce.UNSIGNED_INT;break;default:W.F("Wrong texture type")}return a}function x(e){e.Wa?e.Wa.play():e.sd&&(e.Kr=!0),e.qs=!1}function T(e){e.Wa?e.Wa.pause():e.sd&&(e.Kr=!1),e.qs=!0}function y(e){e.Wa?e.Wa.currentTime=e.Wb/e.gh:e.sd&&(e.vj=w(e,e.Wb),l(e))}function S(e){return e.Wa?!e.Wa.paused:!!e.sd&&e.Kr}function O(e){return e.Wa||e.sd?!e.Wa||2<=e.Wa.readyState:0}function w(e,t){return Math.round(t*e.Ir/e.vk)}function R(e,t){if(J.is_dynamic(e))return N(e,t);for(var a=e.er,r=0;r<a.length;r++){var n=N(a[r],t);if(n)return n}return null}function L(e,t,a){if(J.is_dynamic(e))I(e,t,a);else{e=e.er;for(var r=0;r<e.length;r++)I(e[r],t,a)}}function N(e,t){var a=e.K;if(a.length)for(var a=a[0].U,r=0;r<a.length;r++){var n=a[r];if("MAIN"==n.type||"SKY"==n.type)for(var o=0;o<n.fa.length;o++)if(n.We[o]==t)return n.fa[o]}return null}function I(e,t,a){if(e=e.K,e.length){e=e[0].U;for(var r=0;r<e.length;r++){var n=e[r];if("MAIN"==n.type)for(var o=0;o<n.fa.length;o++)if(n.We[o]==t){var i=n.fa[o];n.fa[o]=a,k(i)}}}}function M(e,t){var a=e.K;if(a.length)for(var a=a[0].U,r=0;r<a.length;r++){var n=a[r];if("MAIN"==n.type)for(var o=0;o<n.fa.length;o++){var i=n.fa[o],_=n.We[o];-1==t.indexOf(_)&&"NODE_TEX"!=i.source&&t.push(_)}}}function C(e,t,a){var r=e.elements;e=e.interpolation;for(var n=0;n<t;n++){var o=n/(t-1),i=D(r,o,!0),_=U(r,o,!0);if(i&&_)if("CONSTANT"==e)a.push.apply(a,i.color);else{var s=a,c=i,l=_;c==l?s.push.apply(s,c.color):(s.push(K.dv(l.color[0],l.position,c.color[0],c.position,o)),s.push(K.dv(l.color[1],l.position,c.color[1],c.position,o)),s.push(K.dv(l.color[2],l.position,c.color[2],c.position,o)),s.push(K.dv(l.color[3],l.position,c.color[3],c.position,o)))}_&&!i&&a.push.apply(a,_.color),i&&!_&&a.push.apply(a,i.color)}}function D(e,t,a){for(var r=null,n=0;n<e.length;n++){var o=a?t-e[n].position:t-e[n][1][0];0<=o&&(r?o<=(a?t-r.position:t-e[n][1][0])&&(r=e[n]):r=e[n])}return r}function U(e,t,a){for(var r=null,n=0;n<e.length;n++){var o=a?e[n].position-t:e[n][1][0]-t;0<=o&&(r?o<=(a?r.position-t:r[1][0]-t)&&(r=e[n]):r=e[n])}return r}function k(e){var t;if(!(t=$.enable_texture_cache))e:{t=V.get_all_objects("ALL",V.DATA_ID_ALL);for(var a=0;a<t.length;a++){var r=t[a];if(P(r,e)){t=!0;break e}for(var r=r.er,n=0;n<r.length;n++)if(P(r[n],e)){t=!0;break e}}t=!1}t||(e.zb&&ce.deleteTexture(e.zb),-1!=(e=ie.fa.indexOf(e))&&(ie.fa.splice(e,1),ie.bo.splice(e,1)))}function P(e,t){for(var a=0;a<e.K.length;a++)for(var r=e.K[a].U,n=0;n<r.length;n++)for(var o=r[n].fa,i=0;i<o.length;i++)if(o[i]==t)return!0}function G(e,t){for(var a=0;a<ie.fa.length;a++){var r=ie.fa[a];if(r.jk==e&&r.type==t.type&&r.source==t.source&&r.repeat==t.repeat&&r.anisotropic_filtering==t.anisotropic_filtering&&r.bl==t.bl)return r}return null}var F=t("__compat"),j=t("__config"),B=t("__texcomp"),H=t("__debug"),X=t("__extensions"),q=t("__print"),z=t("__time"),W=t("__util"),Y=t("__renderer"),V=t("__objects"),J=t("__obj_util"),K=t("__curve"),Q=t("__vec3"),Z=t("__scenes"),$=j.H,ee=j.Zg,te=j.Z,ae=null,re=null,ne=null;e.Df=0,e.L=0,e.UK=0,e.SK=0,e.TK=0,e.wp=0,e.Ug=10,e.Is=20,e.xp=30,e.yp=40,e.ll=50,e.Gs=60,e.Es=70,e.Hs=80,e.Fs=90,e.IB=128,e.TI=128,e.dC=128;var oe,ie={fa:[],bo:[]},_e={},se={},ce=null,le="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),fe=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];e.bg=function(t){oe=[t.NEAREST_MIPMAP_NEAREST,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_LINEAR],e.Df=t.NEAREST,e.L=t.LINEAR,e.UK=t.NEAREST_MIPMAP_NEAREST,e.SK=t.LINEAR_MIPMAP_NEAREST,e.TK=t.NEAREST_MIPMAP_LINEAR,e.wp=t.LINEAR_MIPMAP_LINEAR,ce=t},e.xX=function(e,t){return t in _e&&e in _e[t]?_e[t][e].rg:null},e.RY=function(e,t){return t in _e&&e in _e[t]&&(s(_e[t][e]),!0)},e.yC=o,e.Zj=_,e.cN=function(t,a){var r=ce.createTexture(),o=ce.TEXTURE_CUBE_MAP;ce.bindTexture(o,r),ce.texParameteri(o,ce.TEXTURE_MAG_FILTER,ce.LINEAR),a?ce.texParameteri(o,ce.TEXTURE_MIN_FILTER,oe[$.Ej]):ce.texParameteri(o,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(o,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(o,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE);for(var i=0;6>i;i++)ce.texImage2D(ce[le[i]],0,ce.RGBA,t,t,0,ce.RGBA,ce.UNSIGNED_BYTE,null);return ce.bindTexture(o,null),o=n(),o.type=e.Ug,o.source="NONE",o.width=3*t,o.height=2*t,o.lq=1,o.Qg=a,o.zb=r,o.lb=ce.TEXTURE_CUBE_MAP,o},e.TG=function(e,t){var a=e.lb;ce.bindTexture(a,e.zb);for(var r=0;6>r;r++)ce.texImage2D(ce[le[r]],0,ce.RGBA,t,t,0,ce.RGBA,ce.UNSIGNED_BYTE,null);ce.bindTexture(a,null),e.width=3*t,e.height=2*t},e.FA=function(e,t,a){var r=e.lb;ce.bindTexture(r,e.zb),t&&ce.texParameteri(r,ce.TEXTURE_MIN_FILTER,t),a&&ce.texParameteri(r,ce.TEXTURE_MAG_FILTER,a),ce.bindTexture(r,null)},e.resize=function(t,a,r){if(a=Math.max(a,1),r=Math.max(r,1),t.width!=a||t.height!=r){switch(t.type){case e.Gs:ce.bindRenderbuffer(ce.RENDERBUFFER,t.Oe),ce.renderbufferStorage(ce.RENDERBUFFER,ce.RGB565,a,r),ce.bindRenderbuffer(ce.RENDERBUFFER,null);break;case e.Es:ce.bindRenderbuffer(ce.RENDERBUFFER,t.Oe),ce.renderbufferStorage(ce.RENDERBUFFER,E(ee.xn),a,r),ce.bindRenderbuffer(ce.RENDERBUFFER,null);break;case e.Hs:ce.bindRenderbuffer(ce.RENDERBUFFER,t.Oe),ce.renderbufferStorageMultisample(ce.RENDERBUFFER,$.Rb,ce.RGBA8,a,r),ce.bindRenderbuffer(ce.RENDERBUFFER,null);break;case e.Fs:ce.bindRenderbuffer(ce.RENDERBUFFER,t.Oe),ce.renderbufferStorageMultisample(ce.RENDERBUFFER,$.Rb,E(ee.xn),a,r),ce.bindRenderbuffer(ce.RENDERBUFFER,null);break;default:var n=t.lb;ce.bindTexture(n,t.zb);var o=v(t),i=b(t),_=A(t);t.Qg&&($.Ab||(r=Math.max(a,r),a=h(r),r=h(r)),t.VF=Math.round(Math.log(Math.max(a,r))/Math.log(2)+.5)),ce.texImage2D(n,0,i,a,r,0,o,_,null),ce.bindTexture(n,null)}a>ee.Qb||r>ee.Qb?W.F('Slink texture "'+t.type+'" has unsupported size: '+a+"x"+r+". Max available: "+ee.Qb+"x"+ee.Qb+"."):(t.width=a,t.height=r)}},e.XN=function(t,a,r,i,_){var c=t.type;if("BLEND"==c)return null;var l=t.image,f=n();if(f.type=e.Ug,f.width=1,f.height=1,$.Jx){var u=t.b4w_anisotropic_filtering;"DEFAULT"===u&&(u=a),"OFF"!==u&&$.anisotropic_filtering&&(f.anisotropic_filtering=parseFloat(u.split("x")[0]))}if(("REPEAT"!=t.extension||t.b4w_shore_dist_map)&&(f.repeat=!1),l){if("IMAGE"==c&&"MOVIE"==l.source&&(f.dj=!0,f.Yw=t.name,f.sa=t.frame_start,f.Wb=t.frame_offset,f.ek=t.frame_duration,f.uB=t.use_auto_refresh,f.Jj=t.use_cyclic,f.vk=t.movie_length,f.bl=t.b4w_nla_video,0!=f.Wb&&q.warn('Frame offset for texture "'+t.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),f.source=c,a=W.ji(_+l.filepath),a=G(a,f))return a;o(f,l,_)}switch(a=new Uint8Array([204,204,204,255]),c){case"IMAGE":_=ce.createTexture(),l=ce.TEXTURE_2D,ce.bindTexture(l,_),ce.texImage2D(l,0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,a);break;case"NONE":if("NONE"==t.b4w_source_type)return null;if(_=ce.createTexture(),l=ce.TEXTURE_2D,f.source=t.b4w_source_type,"SCENE"==f.source){if(!t.b4w_source_id)return null;if(!(i=W.keysearch("name",t.b4w_source_id,r)))return null;f.Pr=t.b4w_source_id,f.yj=t.b4w_source_size,i.lg=i.lg||[],i.lg.push(f),ce.bindTexture(l,_),ce.texImage2D(l,0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,a)}else"CANVAS"==f.source&&(r=t.b4w_source_id,a=t.b4w_source_size,f.Pr=r,f.ck=t.b4w_enable_canvas_mipmapping,t=document.createElement("canvas"),t.width=a,t.height=a,f.rg=t.getContext("2d"),i in _e||(_e[i]={}),_e[i][r]=f,ce.bindTexture(l,_));break;case"ENVIRONMENT_MAP":for(_=ce.createTexture(),l=ce.TEXTURE_CUBE_MAP,ce.bindTexture(l,_),t="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" "),i=0;6>i;i++)ce.texImage2D(ce["TEXTURE_CUBE_MAP_"+t[i]],0,ce.RGBA,1,1,0,ce.RGBA,ce.UNSIGNED_BYTE,a);break;default:return q.error('texture "'+t.name+'" has unsupported type "'+c+'"'),null}return f.zb=_,f.lb=l,"NONE"==c?(f.ck?ce.texParameteri(l,ce.TEXTURE_MIN_FILTER,oe[$.Ej]):ce.texParameteri(l,ce.TEXTURE_MIN_FILTER,ce.LINEAR),f.anisotropic_filtering&&ce.texParameterf(l,X.Ny().TEXTURE_MAX_ANISOTROPY_EXT,f.anisotropic_filtering),"CANVAS"==f.source&&s(f)):(ce.generateMipmap(l),ce.bindTexture(l,null)),f},e.bV=s,e.kI=c,e.jI=l,e.fs=m,e.Xx=h,e.Zn=function(e){return!(!e||!e.zb&&!e.Oe)},e.Yn=function(e){return!(!e||!e.Oe)},e.$X=function(t){return t.type==e.xp||t.type==e.yp},e.aQ=function(t){var a=0;switch(t.type){case e.Ug:case e.Is:a=4;break;case e.xp:case e.yp:a=16;break;case e.ll:a=3;break;case e.Gs:case e.Es:a=2;break;case e.Hs:a=4*$.Rb;break;case e.Fs:a=3*$.Rb}return a},e.cleanup=function(){if(!$.Jr)for(var e in se)for(var t in se[e])se[e][t].Wa.pause(),se[e][t].Wa.src="",se[e][t].Wa.load();ie.fa.length=0,ie.bo.length=0,_e={},se={}},e.pause=function(){for(var e in se)for(var t in se[e]){var a=se[e][t];S(a)&&T(a)}},e.reset=function(){for(var e in se)for(var t in se[e])y(se[e][t])},e.play=function(e){for(var t in se)for(var a in se[t]){var r=se[t][a];e&&!r.qs||x(r)}},e.Zy=function(e,t){return t in se&&e in se[t]?se[t][e]:null},e.yB=function(e){return e.bl},e.play_video=x,e.pause_video=T,e.reset_video=y,e.hT=function(e,t){if(void 0 in se&&e in se[void 0]){var a=se[void 0][e];a.Wa?a.Wa.currentTime=t/a.gh:a.sd&&(a.vj=t,l(a))}},e.HI=S,e.II=O,e.EI=function(e){return e.Wa||e.sd?e.Wa?Math.round(e.Wa.currentTime*e.gh):e.vj:0},e.GI=function(e){return e.Wa||e.sd?e.Wa?e.Wb:w(e,e.Wb):0},e.rV=function(e){if(!e.Wa&&!e.sd)return 0;var t=Math.min(e.ek,e.vk-e.Wb);return e.Wa?e.Wb+t:w(e,e.Wb+t)},e.Zv=function(e,t){return Math.round(t*e.Hr*(z.pd()/e.gh))},e.FI=function(e){return Math.min(e.ek,e.vk-e.Wb)},e.qV=w,e.wP=function(e,t){var a=R(e,t);return a&&"CANVAS"==a.source?a.rg:null},e.Wy=R,e.zT=L,e.get_texture_names=function(e){var t=[];if(J.is_dynamic(e))M(e,t);else{e=e.er;for(var a=0;a<e.length;a++)M(e[a],t)}return t},e.IT=function(e){for(var t={},a=0;a<e.length;a++){for(var r=e[a].fa,o=e[a].rf,i=[],_=[],c=0;c<r.length;c++){var l=r[c],f=o[c];if("CANVAS"==l.source)if(f in t)l=t[f];else{var u=r[c],l=n();l.source="CANVAS",l.width=u.width,l.height=u.height,l.ck=u.ck,l.type=u.type,u=document.createElement("canvas"),u.width=l.width,u.height=l.height,l.rg=u.getContext("2d"),l.lb=ce.TEXTURE_2D,l.zb=ce.createTexture(),ce.bindTexture(ce.TEXTURE_2D,l.zb),l.ck?ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,oe[$.Ej]):ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MAG_FILTER,ce.LINEAR),ce.bindTexture(ce.TEXTURE_2D,null),u=l,u.rg.drawImage(r[c].rg.canvas,0,0),s(u),t[f]=l}i.push(l),_.push(f)}e[a].fa=i}},e.FO=function(e,t){for(var a=[],r=0;r<e.length;r++)C(e[r].data.value.color_ramp,t,a);return new Uint8Array(a.map(function(e){return W.clamp(255*e,0,255)}))},e.cM=C,e.JO=function(e,t){for(var a=new Float32Array(3),r=new Float32Array(3),n=[],o=0;o<e.length;o++){for(var i=e[o].data.value,_=[],s=i.curve_mapping.curves_data,c=i.curve_mapping.curve_extend,l=i.curve_mapping.curves_handle_types,i=0;i<s.length;i++){for(var f=c[i],u=s[i],d=[],p=l[i],m=0;m<u.length;m++)d.push([new Float32Array(3),new Float32Array(u[m].concat(0)),new Float32Array(3)]);for(K.Zx(d[0],null,d[1],p[0],p[0]),m=1;m<d.length-1;m++)K.Zx(d[m],d[m-1],d[m+1],p[m],p[m]);if(K.Zx(d[d.length-1],d[d.length-2],null,p[d.length-1],p[d.length-1]),2<d.length){if("AUTO"==p[0]){Q.subtract(d[0][2],d[0][1],a),m=Q.length(a),Q.copy(d[1][0],r),r[0]<d[0][1][0]&&(r[0]=d[0][1][0]),Q.subtract(r,d[0][1],r);var g=Q.length(r);1e-8<g&&(Q.scale(r,m/g,r),Q.add(d[0][1],r,d[0][2]),Q.subtract(d[0][1],r,d[0][0]))}u=d.length-1,"AUTO"==p[0]&&(Q.subtract(d[u][0],d[u][1],a),m=Q.length(a),Q.copy(d[u-1][2],r),r[0]>d[u][1][0]&&(r[0]=d[u][1][0]),Q.subtract(r,d[u][1],r),1e-8<(g=Q.length(r))&&(Q.scale(r,m/g,r),Q.add(d[u][1],r,d[u][0]),Q.subtract(d[u][1],r,d[u][2])))}for(u=0;u<d.length-1;u++)K.TM(d[u][1],d[u][2],d[u+1][0],d[u+1][1]);for(u=[],3>=s.length?(m=Math.round(-t/2),p=Math.round(t/2)):(m=0,p=t);m<p;m++){var g=m/(p-1),h=D(d,g,!1),v=U(d,g,!1);h&&v?u.push(K.NC(g,h[1],h[2],v[0],v[1],.001)):v&&!h?"EXTRAPOLATED"==f?(g=v[1][0]==v[2][0]?v[1][1]:K.EF(g,v[1],v[2]),u.push(g)):u.push(v[1][1]):h&&!v&&("EXTRAPOLATED"==f?(g=h[0][0]==h[1][0]?h[1][1]:K.EF(g,h[0],h[1]),u.push(g)):u.push(h[1][1]))}_.push(u)}n.push(_)}for(a=[],m=0;m<n.length;m++)for(_=n[m],i=0;i<_[0].length;i++)3>=_.length?(r=W.clamp(127.5*(_[0][i]+1),0,255),o=W.clamp(127.5*(_[1][i]+1),0,255),s=W.clamp(127.5*(_[2][i]+1),0,255),u=255):(r=W.clamp(255*_[0][i],0,255),o=W.clamp(255*_[1][i],0,255),s=W.clamp(255*_[2][i],0,255),u=W.clamp(255*_[3][i],0,255)),a.push(r,o,s,u);return new Uint8Array(a)},e.HD=function(t,a){var r=_(e.Ug,!1);return r.source="NODE_TEX",r.repeat=!1,m(r,{width:a,height:t.length/(4*a),data:t}),r},e.change_image=function(e,t,a,r,o){var _=W.ji(o);if("WORLD"!=e.type){var s=G(_,t);if(!s){s=n(),s.type=t.type,s.anisotropic_filtering=t.anisotropic_filtering,s.source=t.source,s.Pr=t.Pr,s.width=t.width,s.height=t.height,s.lq=t.lq,s.yj=t.yj,s.ck=t.ck,s.rg=t.rg,s.lb=t.lb,s.zb=t.zb,s.Oe=t.Oe,s.dj=t.dj,s.ss=t.ss,s.Wa=t.Wa,s.Yw=t.Yw,s.vk=t.vk,s.gh=t.gh,s.sa=t.sa,s.Wb=t.Wb,s.ek=t.ek,s.Gg=t.Gg,s.zh=t.zh,s.sd=t.sd,s.Ir=t.Ir,s.Hr=t.Hr,s.vj=t.vj,s.Kr=t.Kr,s.Lk=t.Lk,s.qs=t.qs,s.uB=t.uB,s.Jj=t.Jj,s.bl=t.bl,s.repeat=t.repeat,s.Un=t.Un,s.jk=t.jk,s.Yl=t.Yl,s.jz=t.jz,s.iz=t.iz,s.ik=t.ik;var c=s;ce.bindTexture(t.lb,t.zb);var l=ce.getTexParameter(t.lb,ce.TEXTURE_MAG_FILTER),f=ce.getTexParameter(t.lb,ce.TEXTURE_MIN_FILTER),u=ce.getTexParameter(t.lb,ce.TEXTURE_WRAP_S);t=ce.getTexParameter(t.lb,ce.TEXTURE_WRAP_T),c.zb=ce.createTexture(),ce.bindTexture(c.lb,c.zb),ce.texParameteri(c.lb,ce.TEXTURE_MAG_FILTER,l),ce.texParameteri(c.lb,ce.TEXTURE_MIN_FILTER,f),ce.texParameteri(c.lb,ce.TEXTURE_WRAP_S,u),ce.texParameteri(c.lb,ce.TEXTURE_WRAP_T,t),ce.bindTexture(c.lb,null),i(s,o,_),m(s,r,0)}L(e,a,s)}else s=t,i(s,o,_),m(s,r,0),Z.FU(e,s),Z.Nw(e)},e.uD=k,e.he=function(e){return e.texture.G},e.GS=function(){ce=null},e.FE=function(){return ie.fa},e.vP=function(e){return-1!=(e=ie.fa.indexOf(e))&&ie.bo[e]},e.$S=function(e){-1!=(e=ie.fa.indexOf(e))&&(ie.bo[e]=!0)}},a.module.__assets=function(e,t){function a(){return m.kF()?t(m.Ie.it).data:null}function r(){var e={Ms:null,aL:function(t){switch(e.responseType){case"json":case"text":return t;case"arraybuffer":t=atob(t);for(var a=t.length,r=new Int8Array(a),n=0;n<a;n++)r[n]=t.charCodeAt(n);return r.buffer;default:return t}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(t,a){e.Ms=a,e.readyState=1},send:function(){e.status=404,e.readyState=4;var t=a();t&&e.Ms in t&&(e.status=200,t[e.Ms]&&(e.response=e.aL(t[e.Ms]))),"[object Function]"==={}.toString.call(e.onreadystatechange)&&e.onreadystatechange()}};return e}function n(t){for(var a=0,r=0;r<t.length;r++){var n=t[r];if(20===n.state&&a++,a>=T.wR)break;if(10===n.state)switch(n.state=20,a++,n.type){case e.AT_JSON_ZIP:case e.AT_ARRAYBUFFER:case e.AT_ARRAYBUFFER_ZIP:o(n,"arraybuffer");break;case e.AT_JSON:o(n,"json");break;case e.AT_TEXT:o(n,"text");break;case e.AT_AUDIOBUFFER:i(n);break;case e.AT_IMAGE_ELEMENT:_(n);break;case e.AT_AUDIO_ELEMENT:s(n);break;case e.AT_VIDEO_ELEMENT:c(n);break;case e.AT_SEQ_VIDEO_ELEMENT:l(n);break;default:E.F("Wrong asset type: "+n.type)}}}function o(t,n){var o=t.url.split("?v=")[0];if(o in w)"json"==n?t.Nb(E.P(w[o]),t.id,t.type,t.url,t.param):t.Nb(w[o],t.id,t.type,t.url,t.param);else{var i=a(),_=i&&t.url in i?new r:new XMLHttpRequest,i=null;if("GET"==t.request_method)_.open("GET",t.url,!0);else if("POST"==t.request_method)switch(_.open("POST",t.url,!0),t.type){case e.AT_TEXT:i="text/plain";break;case e.AT_JSON:i="application/json"}if(t.overwrite_header)for(var s in t.overwrite_header)"Content-Type"==s?i=t.overwrite_header[s]:_.setRequestHeader(s,t.overwrite_header[s]);i&&_.setRequestHeader("Content-Type",i),"text"==n?(_.overrideMimeType("text/plain"),_.responseType="text"):"json"==n?(_.overrideMimeType("application/json"),_.responseType="text"):_.responseType=n,_.onreadystatechange=function(){if(40!=t.state&&4==_.readyState){if(200==_.status||0==_.status){var a=_.response;if(!a||"arraybuffer"==n&&0==a.byteLength)v.error("empty responce when trying to get "+t.url),t.Nb(null,t.id,t.type,t.url,t.param);else{switch(t.type){case e.AT_JSON_ZIP:try{a=h.Vn(a,{to:"string"})}catch(e){return v.error(e+" (parsing gzipped file "+t.url+")"),void t.Nb(null,t.id,t.type,t.url,t.param)}case e.AT_JSON:try{a=JSON.parse(a,t.MQ)}catch(e){return v.error(e+" (parsing JSON "+t.url+")"),void t.Nb(null,t.id,t.type,t.url,t.param)}break;case e.AT_ARRAYBUFFER_ZIP:try{a=h.Vn(a).buffer}catch(e){return v.error(e+" (parsing gzipped file "+t.url+")"),void t.Nb(null,t.id,t.type,t.url,t.param)}}t.ie&&(w[o]=t.type==e.AT_JSON||t.type==e.AT_JSON_ZIP?E.P(a):a),t.Nb(a,t.id,t.type,t.url,t.param)}}else v.error(_.status+" when trying to get "+t.url),t.Nb(null,t.id,t.type,t.url,t.param);t.state=30}},_.addEventListener("progress",function(e){e.lengthComputable&&t.wG(e.loaded/e.total)},!1),_.send(t.post_data)}}function i(e){var t=e.url.split("?v=")[0];if(t in N)e.Nb(N[t],e.id,e.type,e.url,e.param),e.state=30;else{"GET"!=e.request_method&&E.F("Unsupported request type for audio buffer");var n=(t=a())&&e.url in t?new r:new XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){if(40!=e.state&&4==n.readyState)if(200==n.status||0==n.status){var t=n.response;t?b.hO(t,function(t){e.Nb(t,e.id,e.type,e.url,e.param),e.state=30,e.ie&&(N[e.url.split("?v=")[0]]=t)},function(){v.error("failed to decode "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30}):(v.error("empty responce when trying to get "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30)}else v.error(n.status+" when trying to get "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30},n.send()}}function _(e){var t=e.url.split("?v=")[0];if(t in R)e.Nb(R[t],e.id,e.type,e.url,e.param),e.state=30;else{"GET"!=e.request_method&&E.F("Unsupported request type for image element");var r=document.createElement("img");if(x.allow_cors&&(r.crossOrigin="Anonymous"),r.onload=function(){40!=e.state&&(e.Nb(r,e.id,e.type,e.url,e.param),e.state=30,e.ie&&(R[e.url.split("?v=")[0]]=r))},r.addEventListener("error",function(){40!=e.state&&(v.error("could not load image: "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30)},!1),(t=a())&&e.url in t)if(t[e.url]){var n=u(e.url);r.src="data:"+n+";base64,"+t[e.url]}else g.is_ie11()?(t=document.createEvent("CustomEvent"),t.initCustomEvent("error",!1,!1,null)):t=new CustomEvent("error"),r.dispatchEvent(t);else r.src=e.url}}function s(e){var t=e.url.split("?v=")[0];if(t in L)e.Nb(L[t],e.id,e.type,e.url,e.param),e.state=30;else{"GET"!=e.request_method&&E.F("Unsupported request type for audio element");var r=document.createElement("audio");if(x.allow_cors&&(r.crossOrigin="Anonymous"),r.addEventListener("loadeddata",function(){40!=e.state&&(e.Nb(r,e.id,e.type,e.url,e.param),e.state=30,e.ie&&(L[e.url.split("?v=")[0]]=r))},!1),r.addEventListener("error",function(){40!=e.state&&(v.error("could not load sound: "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30)},!1),r.addEventListener("stalled",function(){40!=e.state&&(v.error("could not load sound: "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30)},!1),(t=a())&&e.url in t)if(t[e.url]){var n=d(e.url);r.src="data:"+n+";base64,"+t[e.url],40!=e.state&&(e.Nb(r,e.id,e.type,e.url,e.param),e.state=30)}else g.is_ie11()?(t=document.createEvent("CustomEvent"),t.initCustomEvent("error",!1,!1,null)):t=new CustomEvent("error"),r.dispatchEvent(t);else r.src=e.url,x.is_mobile_device&&r.load();x.Mz&&(r.autoplay=!0,r.pause()),setTimeout(function(){r.Cx=1},5e3)}}function c(e){function t(){40!=e.state&&(v.error("could not load video: "+e.url,e.param),e.Nb(null,e.id,e.type,e.url),e.state=30)}var r=e.url.split("?v=")[0];if(r in R)e.Nb(R[r],e.id,e.type,e.url,e.param),e.state=30;else{"GET"!=e.request_method&&E.F("Unsupported request type for video element");var n=document.createElement("video");if(n.muted=!0,x.allow_cors&&(n.crossOrigin="Anonymous"),n.addEventListener("loadeddata",function(){n.removeEventListener("error",t,!1),40!=e.state&&(e.Nb(n,e.id,e.type,e.url,e.param),e.state=30,e.ie&&(R[e.url.split("?v=")[0]]=n))},!1),n.addEventListener("error",t,!1),(r=a())&&e.url in r)if(r[e.url]){var o=p(e.url);n.src="data:"+o+";base64,"+r[e.url],40!=e.state&&n.addEventListener("loadeddata",function(){e.Nb(n,e.id,e.type,e.url,e.param),e.state=30},!1)}else g.is_ie11()?(r=document.createEvent("CustomEvent"),r.initCustomEvent("error",!1,!1,null)):r=new CustomEvent("error"),n.dispatchEvent(r);else n.src=e.url,x.is_mobile_device&&n.load();x.Mz&&(n.autoplay=!0,n.pause()),setTimeout(function(){n.Cx=1},1e4)}}function l(e){function t(t){e.Nb(t,e.id,e.type,e.url,e.param),e.state=30,e.ie&&(R[e.url.split("?v=")[0]]=t)}var n=e.url.split("?v=")[0];if(n in R)e.Nb(R[n],e.id,e.type,e.url,e.param),e.state=30;else{"GET"!=e.request_method&&E.F("Unsupported request type for seq video element");var o=(n=a())&&e.url in n?new r:new XMLHttpRequest;o.open("GET",e.url,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(40!=e.state&&4==o.readyState)if(200==o.status||0==o.status){var a=o.response;a?f(a,t):(v.error("empty responce when trying to get "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30)}else v.error(o.status+" when trying to get "+e.url),e.Nb(null,e.id,e.type,e.url,e.param),e.state=30},o.addEventListener("progress",function(t){t.lengthComputable&&e.wG(t.loaded/t.total)},!1),o.send()}}function f(e,t){for(var a=new Int32Array(e),r=new Int8Array(e),n=a[3],o={images:[],TC:[],gh:a[4]},i=20,_=0;_<n;_++){var s=a[i/4],c=new Blob([r.subarray(i+4,i+4+s)],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(c),o.images.push(l),o.TC.push(c),i+=s+8-s%4}l.onload=function(){for(var e=0;e<o.images.length;e++)window.URL.revokeObjectURL(o.images[e].src);delete o.TC,t(o)}}function u(e){var t="image";switch(E.Sy(e).toLowerCase()){case"jpeg":case"jpg":t+="/jpeg";break;case"png":t+="/png"}return t}function d(e){var t="audio";switch(E.Sy(e).toLowerCase()){case"ogv":case"ogg":t+="/ogg";break;case"mp3":t+="/mpeg";break;case"m4v":case"mp4":t+="/mp4";break;case"webm":t+="/webm"}return t}function p(e){var t="video";switch(E.Sy(e).toLowerCase()){case"ogv":t+="/ogg";break;case"webm":t+="/webm";break;case"m4v":t+="/mp4"}return t}var m=t("__config"),g=t("__compat"),h=t("__pako_inflate"),v=t("__print"),b=t("__sfx"),E=t("__util"),A=t("__version"),x=m.H,T=m.Od;e.AT_ARRAYBUFFER=10,e.AT_ARRAYBUFFER_ZIP=20,e.AT_JSON=30,e.AT_JSON_ZIP=40,e.AT_TEXT=50,e.AT_AUDIOBUFFER=60,e.AT_IMAGE_ELEMENT=70,e.AT_AUDIO_ELEMENT=80,e.AT_VIDEO_ELEMENT=90,e.AT_SEQ_VIDEO_ELEMENT=100;var y=[],S=0,O={},w={},R={},L={},N={};e.sw=function(e){e=e.split(".");var t=Array(2);return t[0]=e.slice(0,-1).join("."),t[1]=String(e.slice(-1)),t},e.FX=function(e){if(O[e])return O[e];var t=T.prevent_caching?e+A.timestamp():e,a=new XMLHttpRequest;if(a.overrideMimeType("text/plain"),a.open("GET",t,!1),a.send(null),200!=a.status&&a.status)E.F("Error XHR: "+a.status+", GET "+e);else{if(t=a.responseText,t.length)return O[e]=t;E.F("Error XHR: responce is empty, GET "+e)}},e.cleanup=function(){for(var e=0;e<y.length;e++)y[e].state=40;y=[],S=0,O={}},e.enqueue=function(e,t,r,o,i){for(var _=0;_<e.length;_++){var s=e[_],s={id:s.id,type:s.type,url:s.url,ie:s.ie,request_method:s.request_method?s.request_method:"GET",overwrite_header:s.overwrite_header?s.overwrite_header:null,post_data:s.post_data?s.post_data:null,param:s.param?s.param:null,state:10,Nb:t||function(){},mG:r||function(){},wG:o||function(){},MQ:i||null,nG:S};if(T.prevent_caching){var c=a();c&&s.url in c||(s.url+=A.timestamp())}y.push(s)}n(y),S++},e.update=function(){n(y);for(var e=y,t=0,a=!0,r=0;r<e.length;r++){var o=e[r];o.nG===e[t].nG?30!==o.state&&(a=!1):(a&&(e[r-1].mG(),a=r-t,e.splice(t,a),r-=a),t=r,a=30===e[r].state),r===e.length-1&&a&&(o=e[r],e.splice(t),o.mG())}},e.wM=function(e){return"png"==e||"jpg"==e||"jpeg"==e||"gif"==e||"bmp"==e||"dds"==e||"pvr"==e},e.GM=function(){w={},R={},L={},N={}}},a.module.__loader=function(e,t){function a(t,a,n,o){var i,_=b,s=m.create();for(i in a){var c=r(a[i]);(o&&c.Lb||!t&&c.dc)&&(c.Mr=!0),m.T(s,c)}for(i in a)for(c=a[i],c.name=i,t=0;t<c.inputs.length;t++)m.D(s,a[c.inputs[t]],c,null);if(a=r({name:"out",Eb:e.VI,Ub:function(e,t,a,r,n){t.Db&&(_.TA=!0),p(t)||(t.status=2),t.HF(t.id,!0),n(t,a),g.log("%cTHREAD "+t.id+": LOADED CALLBACK","color: #f0f;")},Sb:5}),n)n=m.Nq(s);else{i=m.clone(s);do{for(n=m.Nq(i),c=[],t=0;t<n.length;t++){o=n[t];var l=m.Qa(i,o);l.Kb&&c.push(o)}for(t=0;t<c.length;t++)m.nf(i,c[t]);c.length&&m.dy(i)}while(c.length)}for(m.T(s,a),t=0;t<n.length;t++)o=n[t],l=m.Qa(s,o),a.inputs.push(l.name),m.D(s,l,a,null);return s}function r(e){return e.Kb=e.Kb||!1,e.Eb||0===e.Eb||(e.Eb=e.be),e.inputs=e.inputs||[],e.cm=e.cm||!1,e.Mr=e.Mr||!1,e.Sb=e.Sb||0,e.Lb=e.Lb||!1,e.dc=e.dc||!1,e.status=0,e.hY=0,e.GF=0,e.Vp=e.Vp||null,e}function n(e,t,a){t.yD(a,t),t.status=3,e.Ex--,v.debug_loading&&g.log("%cTHREAD "+t.id+": 100% LOADING END "+Math.round(performance.now()-t.Xr)+"ms","color: #f0f;"),t.RA=null,t.yD=null,v.debug_loading||(t.Mg=null),t.Bj=null}function o(e,t){for(var a=[],r=[],n=0;n<t.length;n++){var o=t[n];m.Qa(e.Mg,o).cm&&(m.Wk(e.Mg,o,function(r){var n=!0;m.Ij(e.Mg,r,function(e,t){if(!t.cm)return n=!1,1}),n&&-1==a.indexOf(r)&&-1==t.indexOf(r)&&a.push(r)}),r.push(n))}for(n=r.length-1;0<=n;n--)t.splice(r[n],1);return a}function i(e){function t(t,a){var r=m.Qa(e.Mg,t),n=m.Qa(e.Mg,a),o=n.Eb-r.Eb;return o||(o=r.Kb-n.Kb),o}var a=[],r=e.Bj,n=!1;do{var i=o(e,r);a.push.apply(a,r),0<i.length&&(n=!0),r=i}while(0<i.length);return n&&a.sort(t),e.Bj=a,e.Bj.length}function _(e,t,a){if(t.Mr)return t.cm=!0,v.debug_loading&&g.log("%cTHREAD "+e.id+": SKIP STAGE "+t.name,"color: #f0f;"),c(e,t),!1;if(v.debug_loading&&0==t.status){var r=s(e);g.log("%cTHREAD "+e.id+": "+r+"% LOADING START "+t.name+" "+Math.round(performance.now()-e.Xr)+"ms ","color: #f0f;")}if(!t.Ub&&!t.Uj&&!t.Up)return c(e,t),!1;if(0==t.status&&(t.status++,t.Ub))return t.Ub(a,e,t,t.Vp,c,l),!0;if(1==t.status){if(t.Uj)return t.Uj(a,e,t,t.Vp,c,l),!0;t.status++}return!(2!=t.status||(t.status++,!t.Up))&&(t.Up(a,e,t,t.Vp,c,l),!0)}function s(e){if(0==e.tw)return 100;var t=0;return m.X(e.Mg,function(a,r){e.do_not_load_resources&&r.Lb||(t+=r.GF*r.Sb)}),h.trunc(100*t/e.tw)}function c(e,t){if(t.cm=!0,t.status=3,f(e,t,1),v.debug_loading){var a=s(e);g.log("%cTHREAD "+e.id+": "+a+"% LOADING END "+t.name+" "+Math.round(performance.now()-e.Xr)+"ms ","color: #f0f;")}}function l(e,t,a){1>a?f(e,t,a):t.status++}function f(e,t,a){var r=b;(t.Ub||t.Uj||t.Up)&&(t.GF=a,t=s(e),(e.PD!=t||1==a)&&(e.RA(t,performance.now()-e.Xr,e.id),e.PD=t,r.Bz=!0))}function u(e,t){var a=null;return m.X(e.Mg,function(e,r){if(r.name==t)return a=r,1}),a}function d(){return 0==b.Ex}function p(e){return e&&(3==e.status||4==e.status)}var m=t("__graph"),g=t("__print"),h=t("__util"),v=t("__config").H;e.be=0,e.hg=1,e.VI=2;var b=null;e.Ty=function(){return b},e.ID=function(){return b={sf:[],uy:0,Ex:0,TA:!1,Bz:!1}},e.MD=function(e,t,r,n,o,i,_,s,c){var l=b,f=l.sf.length,u={id:f,Db:0==f,status:0,Zh:t,QC:"",HF:r||function(){},FF:s||!1,WY:i,Xr:0,PD:0,tw:0,wA:!1,RA:n||function(){},yD:o||function(){},Mg:null,Bj:null,gz:!1,dz:!1,kz:!1,Tf:c};for(e=a(u.Db,e,i,_),u.Mg=e,t=[],r=m.ZP(e),n=0;n<r.length;n++)t.push(r[n]);return u.Bj=t,m.X(e,function(e,t){!(t.Ub||t.Uj||t.Up)||u.do_not_load_resources&&t.Lb||(u.tw+=t.Sb)}),l.sf.push(u),l.Ex++,u.id},e.WU=function(t){var a=b;if(a&&!d())if(a.Bz)a.Bz=!1;else{var r=performance.now();do{var o=a.sf[a.uy],s=t[o.id];if(!p(o))if(0==o.status&&(o.status=1,o.Xr=performance.now(),o.RA(0,0,o.id),v.debug_loading&&g.log("%cTHREAD "+o.id+": 0% LOADING START 0ms","color: #f0f;")),i(o)){var c=o,l=c.Bj.length;do{var f=m.Qa(c.Mg,c.Bj[0]),u=_(c,f,s);f.Eb==e.hg&&(c.wA=!0),f=c.Bj.shift(),c.Bj.push(f),l--}while(!u&&0!=l)}else n(a,o,s);if(a.TA&&(a.uy=(a.uy+1)%a.sf.length),o.wA){o.wA=!1;break}}while(16>performance.now()-r)}},e.sC=function(e){var t=b;n(t,e,null),e.status=4,e.Db&&(t.TA=!0),e.HF(e.id,!1)},e.JY=l,e.gw=function(e,t){var a=u(e,t);null!==a&&(a.Mr=!0)},e.cm=d,e.jU=p,e.is_primary_loaded=function(e){var t=b;return!!t&&(e|=0,t.sf[e]&&(3==t.sf[e].status||2==t.sf[e].status))},e.fQ=function(t){if(v.debug_loading){var a=b;return a&&a.sf[t]&&a.sf[t].Mg?m.SD(a.sf[t].Mg,function(t,a){if(a.Mr)return"SKIPPED\n("+a.name+")";var r=a.name+"\n",n=[];return n.push(a.Eb==e.hg?"ASYNC":"SYNC"),a.Kb&&n.push("BKG"),a.Lb&&n.push("RES"),r+n.join(" | ")},null):null}g.error("Debug mode isn't enabled. Can not retrieve the graph.")},e.cleanup=function(){b=null}},a.module.__logic_nodes=function(e,t){function a(){return function(e,t,a,r){a=r[0];var n=r[1];if(r=r[2],-2==a.state){for(var o=0;o<a.Yv;o++)if(x.get_sensor_value(e,t,o))for(var i=0;i<a.Xv.length;i++)if(a.Xv[i]==o)return void(n.pm==a.QH?(h.is_play(n.wa)&&(a.state=-1),r.fg.Sf||(a.state=1,a.Nr=a.ev[i])):(a.state=1,a.Nr=a.ev[i]));a.state=0}}}function r(){return function(e,t,a,r){a=r[0];var n=r[1];r=r[2];for(var o=0;o<a.Yv;o++)if(x.get_sensor_value(e,t,o)&&o==a.SG)return void(h.is_play(n.wa)&&n.pm==a.QH?a.state=-1:r.fg.Sf&&!a.M.no_wait||(a.state=1));a.state=0}}function n(e,t){return{name:e.name,type:e.type,label:e.label,Oa:e.slot_idx_order,Nr:e.slot_idx_jump,sa:e.frame_range[0],Za:e.frame_range[1],XO:!e.frame_range_mask||e.frame_range_mask[0],WO:!e.frame_range_mask||e.frame_range_mask[1],state:-1,Yv:-1,SG:-1,TR:e.param_name,NR:e.operation,mute:e.mute,zq:e.object,obj:null,jc:null,qc:null,$a:{},ng:e.anim_name,uc:p.SLOT_ALL,VR:e.parse_json_vars,UR:e.parse_json_paths,yc:e.objects_paths,cG:e.nodes_paths,ma:e.floats,M:e.bools,S:e.variables,Dj:e.strings,Cz:e.materials_names,nH:e.shader_nd_type,Xc:e.common_usage_names,zO:e.encode_json_vars,yO:e.encode_json_paths,QH:t,vG:B[e.type]?B[e.type]:s,Qv:!1,Gw:0,Xv:null,fR:e.links,ev:[]}}function o(e,t,a){return e[0]?t[e[1]]:a[e[1]]}function i(e,t,a,r){e[0]?t[e[1]]=r:a[e[1]]=r}function _(e,t,a){switch(t.state){case 2:a.pa=e.Oa}}function s(e,t,a){switch(t.state){case 1:b.error("Unknown node type: "+e.type);break;case 2:a.pa=e.Oa}}function c(e){return v.lc(v.Ac,e.zq||[],0)}function l(e,t){var a=e.b4w_logic_nodes,r=t.le;t.state=1;for(var o=0;o<a.length;o++){var i={V:[],fg:{eb:e,pa:0,Sf:!1,eB:o,C:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};r.push(i);for(var _=r[r.length-1],s=a[o],c=0;c<s.length;c++){var l=n(s[c],_);_.V.push(l)}for(s=0;s<_.V.length;s++)l=_.V[s],l.mute||l.vG(l,t,i.fg,0,0)}var f,a=e.timeline_markers;for(f in a)t.Or.push(a[f]);t.Or.sort(function(e,t){return e-t}),t.state=2,H.push(t)}function f(e,t){switch(t){case 0:return Number(e)?Number(e):0;case 1:return String(e);default:return null}}function u(e){switch(typeof e){case"string":return f(e,1);case"number":return f(e,0);default:return f(e,1)}}function d(e){q[e]||(q[e]=0);var t=e+"_"+q[e],t=t.replace(/ /g,"_").replace(/\//g,"_");return q[e]++,t}var p=t("__animation"),m=t("__assets"),g=t("__camera"),h=t("__nla"),v=t("__objects"),b=t("__print"),E=t("__scenes"),A=t("__config"),x=t("__controls"),T=t("__batch"),y=t("__geometry"),S=t("__mat3"),O=t("__mat4"),w=t("__physics"),R=t("__quat"),L=t("__sfx"),N=t("__time"),I=t("__transform"),M=t("__tsr"),C=t("__util"),D=t("__vec3"),U=new Float32Array(4),k=new Float32Array(3),P=new Float32Array(3),G=new Float32Array(2),F=new Float32Array(9),j=new Float32Array(16);e.VJ=0,e.WJ=1,e.zJ=0,e.IJ=1,e.EJ=2,e.uJ=3,e.FJ=4,e.HJ=5,e.yJ=6,e.JJ=7,e.wJ=8,e.vJ=9,e.xJ=10,e.AJ=11,e.CJ=12,e.BJ=13,e.GJ=14,e.DJ=15,e.tJ=16,e.PJ=0,e.OJ=1,e.QJ=2,e.RJ=3,e.NJ=4,e.VB=0,e.XB=1,e.WB=2,e.YB=3,e.ZB=4,e.UB=5,e.UJ=0,e.TJ=1,e.SJ=2,e.pJ=0,e.qJ=1,e.nJ=2,e.oJ=3,e.rJ=0,e.sJ=1;var B={ENTRYPOINT:function(e,t,a){switch(t.state){case 2:a.pa=e.Oa}},HIDE:function(e,t,a){switch(t.state){case 1:e.obj=c(e),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:e.M.ch?E.Xp(e.obj,!0):E.Wp(e.obj,!0),a.pa=e.Oa}},SHOW:function(e,t,a){switch(t.state){case 1:e.obj=c(e),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:e.M.ch?E.Xp(e.obj,!1):E.Wp(e.obj,!1),a.pa=e.Oa}},PAGEPARAM:function(e,t,a){switch(t.state){case 2:var r=e.S.vd;t=t.C;var n,o=a.C;e:{n=e.TR;var _=e.ma.ptp,s=e.M.hsh,c=A.get("url_params");if(c&&n in c)n=Number(c[n]);else{if(s=s?location.hash:location.search)for(s=s.slice(1).split("&"),c=0;c<s.length;c++){var l=s[c].split("=");if(1<l.length&&l[0]==n){n=f(l[1],_);break e}}n=0}}i(r,t,o,n),a.pa=e.Oa}},SWITCH_SELECT:function(e,t,r){switch(t.state){case 1:e:{r=t.le[r.eB];var n=v.get_selectable_objects();e.Xv=[],e.ev=[];for(var o in e.yc){var i=v.lc(v.Ac,e.yc[o],0),_=n.indexOf(i);if(-1==_){b.error("logic script error: non-selectable object:",e.yc[o][e.yc[o].length-1]);break e}e.Xv.push(_),e.ev.push(e.fR[o])}for(e.state=-1,e.Yv=n.length,o=[],_=0;_<n.length;_++)o.push(x.create_selection_sensor(n[_],!1));n=a(),x.create_sensor_manifold(i,"LOGIC_NODES_SWITCH_SELECT_"+d(e.label),x.CT_SHOT,o,x.default_OR_logic_fun,n,[e,t,r])}break;case 2:if(-1==e.state){for(t=t.le[r.eB].V,i=0;i<t.length;i++)n=t[i],"SWITCH_SELECT"==n.type&&(n.state=-1);e.state=-2}0!=e.state&&1!=e.state||(r.pa=e.state?e.Nr:e.Oa,e.state=-1)}},SELECT:function(e,t,a){switch(t.state){case 1:a=t.le[a.eB];var n=c(e),o=v.get_selectable_objects(),i=o.indexOf(n);if(-1==i)b.error("logic script error: non-selectable object:",e.zq[e.zq.length-1]);else{e.state=-1,e.Yv=o.length,e.SG=i;for(var i=[],_=0;_<o.length;_++)i.push(x.create_selection_sensor(o[_],!1));o=r(),x.create_sensor_manifold(n,"LOGIC_NODES_SELECT_"+d(e.label),x.CT_SHOT,i,x.default_OR_logic_fun,o,[e,t,a])}break;case 2:0==e.state||1==e.state?(a.pa=e.state?e.Nr:e.Oa,e.state=-1):e.M.not_wait&&(a.pa=e.Oa)}},PLAY:function(e,t,a,r){switch(t.state){case 1:h.VA(),e.state=-1,e.M.not_wait||(e.M.not_wait=!1);break;case 2:switch(e.state){case-1:if(h.is_play(t.wa)){if(t.sy==t.pm&&a.Sf)break;var n=t.pm;if(n){n.fg.pa=n.V[n.fg.pa].Oa,n.V[n.fg.pa].state=-1;for(var n=t.pm.V,o=0;o<n.length;o++){var i=n[o];"PLAY"==i.type&&(i.state=-1)}}}if(a.Sf=!e.M.not_wait,t.pm=t.sy,e.state=0,e.XO&&(h.tT(e.sa),h.eH(r)),e.WO)h.GA(e.Za);else{r=h.get_frame(r);var _,n=-1;for(_ in t.Or)if(r<t.Or[_]){n=_;break}0<=n?h.GA(t.Or[n]):h.GA(h.get_frame_end())}h.sG(null),e.M.not_wait&&(a.pa=e.Oa,e.state=-1,a.Sf=!1);break;case 0:h.is_play()||(a.pa=e.Oa,e.state=-1,a.Sf=!1);break;case 1:a.pa=e.Oa,e.state=-1,t.pm=null,a.Sf=!1;break;default:C.F("Unknown state of "+e.name),e.state=-1}}},REDIRECT:function(e,t,a){switch(t.state){case 2:window.location.href=e.M.url?f(o(e.S.url,t.C,a.C),1):e.Dj.url,t.state=3}},MATH:function(e,t,a){switch(t.state){case 2:var r=-1==e.S.v1[1]?e.ma.inp1:f(o(e.S.v1,t.C,a.C),0),n=-1==e.S.v2[1]?e.ma.inp2:f(o(e.S.v2,t.C,a.C),0),_=0;switch(e.NR){case 3:_=r+n;break;case 2:_=r*n;break;case 1:_=r-n;break;case 0:0==n&&C.F("Division by zero in Logic script"),_=r/n;break;case 4:_=Math.random()*(n-r)+r;break;case 5:_=Math.sin(r);break;case 6:_=Math.cos(r);break;case 7:_=Math.tan(r);break;case 8:_=Math.asin(r);break;case 9:_=Math.acos(r);break;case 10:_=Math.atan(r);break;case 11:_=Math.log(r);break;case 12:_=Math.min(r,n);break;case 13:_=Math.max(r,n);break;case 14:_=Math.round(r);break;case 15:_=r%n;break;case 16:_=Math.abs(r)}i(e.S.vd,t.C,a.C,_),a.pa=e.Oa}},CONDJUMP:function(e,t,a){switch(t.state){case 2:var r=e.M.str?1:0,n=e.M.str?e.Dj:e.ma,i=-1==e.S.v1[1]?n.inp1:f(o(e.S.v1,t.C,a.C),r);switch(t=-1==e.S.v2[1]?n.inp2:f(o(e.S.v2,t.C,a.C),r),r=!1,e.Xc.condition){case 5:i==t&&(r=!0);break;case 4:i!=t&&(r=!0);break;case 3:i<t&&(r=!0);break;case 2:i>t&&(r=!0);break;case 1:i<=t&&(r=!0);break;case 0:i>=t&&(r=!0)}a.pa=r?e.Nr:e.Oa}},REGSTORE:function(e,t,a){switch(t.state){case 2:i([e.M.gl||e.S.vd[0],e.S.vd[1]],t.C,a.C,(1==e.Xc.variable_type?e.Dj:e.ma).inp1),a.pa=e.Oa}},PLAY_ANIM:function(e,t,a){switch(t.state){case 1:e.obj=e.M.env?v.get_world_by_name(e.zq[0],0):c(e),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:switch(0!=e.state||p.is_play(e.obj,e.uc)||(e.state=1),e.state){case-1:for(var r in t.le){var n=t.le[r].fg.pa;-1!=n&&(n=t.le[r].V[n],"PLAY_ANIM"==n.type&&n!=e&&0==n.state&&n.obj==e.obj&&(n.state=1))}if(t=e.Xc.param_anim_behavior,""==e.ng)p.apply_def(e.obj),p.set_behavior(e.obj,t,p.SLOT_ALL);else{e:{r=e.obj;for(var n=e.ng,o=-1,i=0;8>i;i++){var _=r.ia[i];if(_&&_.Gi&&p.GH(_.Gi)==p.GH(n)){if(-1==o){r=-1;break e}o=i}}r=o}-1==r?(e.uc=p.LT(e.obj,e.ng),p.apply(e.obj,null,e.ng,e.uc)):e.uc=r,p.set_behavior(e.obj,t,e.uc)}e.M.not_wait||(a.Sf=!0),p.play(e.obj,null,e.uc),e.state=0,e.M.not_wait&&(a.pa=e.Oa,e.state=-1);break;case 0:break;case 1:e.M.not_wait||(a.Sf=!1),a.pa=e.Oa,e.state=-1;break;default:C.F("Unknown state of "+e.name),e.state=-1}}},SELECT_PLAY:_,SEND_REQ:function(e,t,a){function r(e,r,n,o,_){e=JSON.stringify(e),i(_[0].S.dst,t.C,a.C,e),_[0].state=1}switch(t.state){case 2:switch(e.state){case-1:e.state=0;var n=e.M.url?f(o(e.S.url,t.C,a.C),1):e.Dj.url,_={};e.M.ct&&(_["Content-Type"]=e.Dj.ct),"GET"==e.Xc.request_type?m.enqueue([{id:n,type:m.AT_JSON,url:n,overwrite_header:_,param:[e,a.C]}],r,null,null,null):"POST"==e.Xc.request_type&&m.enqueue([{id:n,type:m.AT_JSON,url:n,overwrite_header:_,request_method:"POST",post_data:f(o(e.S.dst1,t.C,a.C),1),param:[e,a.C]}],r,null,null,null);break;case 1:e.state=-1,a.pa=e.Oa}}},INHERIT_MAT:function(e,t,a){switch(t.state){case 1:for(t=0;2>t;t++)e.$a["id"+t]=v.lc(v.Ac,e.yc["id"+t],0),e.$a["id"+t]||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:v.inherit_material(e.$a.id0,e.Cz.id0,e.$a.id1,e.Cz.id1),a.pa=e.Oa}},SET_SHADER_NODE_PARAM:function(e,t,a){switch(t.state){case 1:e.yc.id0&&(e.$a.id0=v.lc(v.Ac,e.yc.id0,0),e.yc.id0||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.cG.id0.unshift(e.Cz.id0));break;case 2:var r=e.$a.id0,n=e.cG.id0,i=n[0],_=T.Va(r,i,"MAIN");if(a.pa=e.Oa,null===_)b.error('Material "'+i+'" was not found in the object "'+r.name+'".');else{if("ShaderNodeRGB"==e.nH){var s=v.$h(_.kf,n,1);v.set_nodemat_rgb(r,i,s,e.M.id0?f(o(e.S.id0,t.C,a.C),0):e.ma.id0,e.M.id1?f(o(e.S.id1,t.C,a.C),0):e.ma.id1,e.M.id2?f(o(e.S.id2,t.C,a.C),0):e.ma.id2)}"ShaderNodeValue"==e.nH&&(s=v.$h(_.lf,n,1),v.set_nodemat_value(r,i,s,e.M.id0?f(o(e.S.id0,t.C,a.C),0):e.ma.id0))}}},DELAY:function(e,t,a,r,n){switch(t.state){case 2:-1==e.state?(e.state=0,e.Gw=0,a.Sf=!0):0==e.state&&(e.Gw+=n,(e.M.dl?f(o(e.S.dl,t.C,a.C),0):e.ma.dl)<e.Gw&&(e.state=-1,a.pa=e.Oa,a.Sf=!1))}},APPLY_SHAPE_KEY:function(e,t,a){switch(t.state){case 1:t=e.$a.id0=v.lc(v.Ac,e.yc.id0,0),t||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),a=e.Xc.sk,y.check_shape_keys(t)?y.fz(t,a)||(b.error("Wrong key name:",a),e.mute=!0):(b.error("No shape keys in object:",t.name),e.mute=!0);break;case 2:y.Kx(e.$a.id0,e.Xc.sk,e.M.skv?f(o(e.S.skv,t.C,a.C),0):e.ma.skv),a.pa=e.Oa}},OUTLINE:function(e,t,a){switch(t.state){case 1:var r=e.$a.id0=v.lc(v.Ac,e.yc.id0,0);r||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r&&r.o&&r.o.Oc||(b.error("Can't evaluate 'Outline' logic node: wrong object"),e.mute=!0);break;case 2:switch(r=e.$a.id0,e.Xc.outline_operation){case"PLAY":t=r.o.ki,v.apply_outline_anim(r,t.Bk,t.Ck,t.Dk);break;case"STOP":v.clear_outline_anim(r);break;case"INTENSITY":r.o.sh=e.M.in?f(o(e.S.in,t.C,a.C),0):e.ma.in}a.pa=e.Oa}},MOVE_CAMERA:function(e,t,a){function r(e,t,a,r){switch(g.get_move_style(e)){case g.MS_TARGET_CONTROLS:g.HA(e,t,a);break;case g.MS_EYE_CONTROLS:case g.MS_STATIC:I.set_tsr(e,r);break;case g.MS_HOVER_CONTROLS:D.sub(a,t,k),D.normalize(k,k),g.cH(e,a),P[0]=k[0],P[1]=0,P[2]=k[2],t=D.dot(P,k),a=Math.acos(t/(D.length(P)*D.length(k))),t=k[2]?Math.atan(k[0]/k[2]):0<k[0]?0:Math.PI,0<k[2]&&0<k[0]?G[1]=-(Math.PI+G[1]):0<k[2]&&0>k[0]?G[1]=-(Math.PI+G[1]):0>k[2]&&0>k[0]?(G[0]+=Math.PI,t=-(Math.PI-t)):0>k[2]&&0<k[0]&&(G[0]+=Math.PI,t-=Math.PI),g.wT(e,t+Math.PI,-a)}I.O(e),w.sync_transform(e)}function n(e,t,a,r){O.lookAt(t,a,C.AXIS_Z,j),O.invert(j,j),S.fromMat4(j,F),R.fromMat3(F,U),R.normalize(U,U),e=M.get_scale(e.o.v),M.set_sep(t,e,U,r)}switch(t.state){case 1:var i=null,i=e.$a.ca=v.lc(v.Ac,e.yc.id0,0);i||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.$a.tr=v.lc(v.Ac,e.yc.id1,0),e.$a.tr||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.$a.ta=v.lc(v.Ac,e.yc.id2,0),e.$a.ta||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.state=-1,e.qc={UH:new Float32Array(3),TH:new Float32Array(3),oz:new Float32Array(3),bB:new Float32Array(3),OH:new Float32Array(3),nz:new Float32Array(3),Xk:new Float32Array(8),ti:new Float32Array(8),Sq:new Float32Array(8)};break;case 2:var _=e.$a.ca,i=M.get_trans_view(e.$a.tr.o.v),s=M.get_trans_view(e.$a.ta.o.v);switch(e.state){case-1:if(0==(t=e.M.dur?f(o(e.S.dur,t.C,a.C),0):e.ma.dur)){n(_,i,s,e.qc.ti),r(_,i,s,e.qc.ti),a.pa=e.Oa;break}a=M.get_trans_view(_.o.v),D.copy(a,e.qc.UH);var c=g.get_move_style(_);c==g.MS_HOVER_CONTROLS?D.copy(_.o.mc,e.qc.bB):c==g.MS_STATIC||c==g.MS_EYE_CONTROLS?(M.copy(_.o.v,e.qc.Xk),n(_,i,s,e.qc.ti)):D.copy(_.o.pivot,e.qc.bB),D.copy(i,e.qc.TH),D.copy(s,e.qc.OH),e.state=0;var l=N.animate(0,1,1e3*t,function(t){E.Fa()&&(c==g.MS_STATIC||c==g.MS_EYE_CONTROLS?M.interpolate(e.qc.Xk,e.qc.ti,C.smooth_step(t),e.qc.Sq):(e.qc.nz=D.lerp(e.qc.bB,e.qc.OH,C.smooth_step(t),e.qc.nz),e.qc.oz=D.lerp(e.qc.UH,e.qc.TH,C.smooth_step(t),e.qc.oz)),r(_,e.qc.oz,e.qc.nz,e.qc.Sq),1==t&&(e.state=1))});break;case 1:N.clear_animation(l),e.state=-1,a.pa=e.Oa}}},SET_CAMERA_MOVE_STYLE:function(e,t,a){switch(t.state){case 1:var r;r=e.$a.ca=v.lc(v.Ac,e.yc.id0,0),r||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),t=r.o,e.eD={si:t.si,use_panning:t.use_panning,Bb:t.Bb,Ha:t.Ha,vb:t.vb,Lc:t.Lc,Mc:t.Mc,rd:t.rd,tg:t.tg};break;case 2:r=e.$a.ca;var n=r.o,i=e.eD;switch(g.ts(r),e.Xc.camera_move_style){case 0:n.hb=g.MS_STATIC;break;case 2:n.hb=g.MS_EYE_CONTROLS;var _=M.get_trans_view(n.v);g.jH(r,_,null,i.Bb,i.Ha);break;case 3:n.hb=g.MS_HOVER_CONTROLS;var _=M.get_trans_view(n.v),s=k;e.M.pvo?(s=v.lc(v.Ac,e.yc.id1,0),s=M.get_trans_view(s.o.v)):(s[0]=e.M.pvx?f(o(e.S.pvx,t.C,a.C),0):e.ma.pvx,s[1]=e.M.pvy?f(o(e.S.pvy,t.C,a.C),0):e.ma.pvy,s[2]=e.M.pvz?f(o(e.S.pvz,t.C,a.C),0):e.ma.pvz),g.kH(r,_,s,i.vb,i.Ha,i.Lc,i.Mc,i.tg);break;case 1:n.hb=g.MS_TARGET_CONTROLS,_=M.get_trans_view(n.v),s=k,e.M.pvo?(s=v.lc(v.Ac,e.yc.id1,0),s=M.get_trans_view(s.o.v)):(s[0]=e.M.pvx?f(o(e.S.pvx,t.C,a.C),0):e.ma.pvx,s[1]=e.M.pvy?f(o(e.S.pvy,t.C,a.C),0):e.ma.pvy,s[2]=e.M.pvz?f(o(e.S.pvz,t.C,a.C),0):e.ma.pvz),g.lH(r,_,s,i.Bb,i.Ha,i.vb,i.rd,i.use_panning)}P[0]=e.M.vtr?f(o(e.S.vtr,t.C,a.C),0):e.ma.vtr,P[1]=e.M.vro?f(o(e.S.vro,t.C,a.C),0):e.ma.vro,P[2]=e.M.vzo?f(o(e.S.vzo,t.C,a.C),0):e.ma.vzo,P[0]=C.clamp(P[0],0,1/0),P[1]=C.clamp(P[1],0,1/0),P[2]=C.clamp(P[2],0,.99),n.fp=P[0],n.ep=P[1],n.gp=P[2],I.O(r),w.sync_transform(r),g.Wn(r),a.pa=e.Oa}},SET_CAMERA_LIMITS:function(e,t,a){switch(t.state){case 1:var r;r=e.$a.ca=v.lc(v.Ac,e.yc.id0,0),r||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),a=r.o,e.eD={si:a.si,use_panning:a.use_panning,Bb:a.Bb,Ha:a.Ha,vb:a.vb,Lc:a.Lc,Mc:a.Mc,rd:a.rd,tg:a.tg};break;case 2:switch(r=e.$a.ca,r.o.hb){case g.MS_TARGET_CONTROLS:if(e.M.dsl){var n=e.M.dslmin?f(o(e.S.dslmin,t.C,a.C),0):e.ma.dslmin,i=e.M.dslmax?f(o(e.S.dslmax,t.C,a.C),0):e.ma.dslmax,_={};_.min=Math.max(n,0),_.max=Math.max(i,0),g.UG(r,_)}e.M.vrl&&(n=e.M.vrldown?f(o(e.S.vrldown,t.C,a.C),0):e.ma.vrldown,i=e.M.vrlup?f(o(e.S.vrlup,t.C,a.C),0):e.ma.vrlup,_={},_.down=n,_.up=i,_.camera_space="CAMERA"==e.Xc.cam_lim_vert_rot_space_type,g.cw(r,_)),e.M.hrl&&(n=e.M.hrlleft?f(o(e.S.hrlleft,t.C,a.C),0):e.ma.hrlleft,i=e.M.hrlright?f(o(e.S.hrlright,t.C,a.C),0):e.ma.hrlright,_={},_.left=n,_.right=i,_.camera_space="CAMERA"==e.Xc.cam_lim_hor_rot_space_type,g.aw(r,_)),e.M.pvl&&(n=e.M.pvlmin?f(o(e.S.pvlmin,t.C,a.C),0):e.ma.pvlmin,t=e.M.pvlmax?f(o(e.S.pvlmax,t.C,a.C),0):e.ma.pvlmax,_={},_.min_z=n,_.max_z=t,g.fH(r,_));break;case g.MS_HOVER_CONTROLS:e.M.htl&&(n=e.M.htlmin?f(o(e.S.htlmin,t.C,a.C),0):e.ma.htlmin,i=e.M.htlmax?f(o(e.S.htlmax,t.C,a.C),0):e.ma.htlmax,_={},_.min=n,_.max=i,g.bH(r,_)),e.M.vtl&&(n=e.M.vtlmin?f(o(e.S.vtlmin,t.C,a.C),0):e.ma.vtlmin,i=e.M.vtlmax?f(o(e.S.vtlmax,t.C,a.C),0):e.ma.vtlmax,_={},_.min=n,_.max=i,g.hH(r,_)),e.M.vrl&&(n=e.M.vrldown?f(o(e.S.vrldown,t.C,a.C),0):e.ma.vrldown,i=e.M.vrlup?f(o(e.S.vrlup,t.C,a.C),0):e.ma.vrlup,_={},_.down=n,_.up=i,_.camera_space="CAMERA"==e.Xc.cam_lim_vert_rot_space_type,g.hover_set_vertical_limits(r,_)),e.M.dsl&&(n=e.M.dslmin?f(o(e.S.dslmin,t.C,a.C),0):e.ma.dslmin,i=e.M.dslmax?f(o(e.S.dslmax,t.C,a.C),0):e.ma.dslmax,_={},_.min=Math.max(n,0),_.max=Math.max(i,0),g.hover_set_distance_limits(r,_));break;case g.MS_EYE_CONTROLS:e.M.vrl&&(n=e.M.vrldown?f(o(e.S.vrldown,t.C,a.C),0):e.ma.vrldown,i=e.M.vrlup?f(o(e.S.vrlup,t.C,a.C),0):e.ma.vrlup,_={},_.down=n,_.up=i,_.camera_space="CAMERA"==e.Xc.cam_lim_vert_rot_space_type,g.cw(r,_)),e.M.hrl&&(n=e.M.hrlleft?f(o(e.S.hrlleft,t.C,a.C),0):e.ma.hrlleft,i=e.M.hrlright?f(o(e.S.hrlright,t.C,a.C),0):e.ma.hrlright,_={},_.left=n,_.right=i,_.camera_space="CAMERA"==e.Xc.cam_lim_hor_rot_space_type,g.aw(r,_))}I.O(r),w.sync_transform(r),a.pa=e.Oa}},MOVE_TO:function(e,t,a){function r(e,t){I.set_tsr(e,t),I.O(e),w.sync_transform(e)}switch(t.state){case 1:e.$a.ob=v.lc(v.Ac,e.yc.id0,0),e.$a.ob||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.$a.de=v.lc(v.Ac,e.yc.id1,0),e.$a.de||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.state=-1,e.jc={XD:new Float32Array(8),xy:new Float32Array(8),gF:new Float32Array(8)};break;case 2:var n=e.$a.ob;switch(M.copy(e.$a.ob.o.v,e.jc.XD),M.copy(e.$a.de.o.v,e.jc.xy),e.state){case-1:if(0==(t=e.M.dur?f(o(e.S.dur,t.C,a.C),0):e.ma.dur)){r(n,e.jc.xy),a.pa=e.Oa;break}e.state=0;var i=N.animate(0,1,1e3*t,function(t){E.Fa()&&(e.jc.XX=M.interpolate(e.jc.XD,e.jc.xy,C.smooth_step(t),e.jc.gF),r(n,e.jc.gF),1==t&&(e.state=1))});break;case 1:N.clear_animation(i),e.state=-1,a.pa=e.Oa}}},TRANSFORM_OBJECT:function(e,t,a){function r(e,t,a){0==a?I.set_tsr(e,t):I.set_tsr_rel(e,t),I.O(e),w.sync_transform(e)}switch(t.state){case 1:e.$a.ob=v.lc(v.Ac,e.yc.id0,0),e.$a.ob||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.state=-1,e.jc={rw:0,Xk:new Float32Array(8),ti:new Float32Array(8),Sq:new Float32Array(8)};break;case 2:var n=e.$a.ob;switch(e.state){case-1:P[0]=e.M.trx?f(o(e.S.trx,t.C,a.C),0):e.ma.trx,P[1]=e.M.try?f(o(e.S.try,t.C,a.C),0):e.ma.try,P[2]=e.M.trz?f(o(e.S.trz,t.C,a.C),0):e.ma.trz,k[0]=e.M.rox?f(o(e.S.rox,t.C,a.C),0)*Math.PI/180:e.ma.rox,k[1]=e.M.roy?f(o(e.S.roy,t.C,a.C),0)*Math.PI/180:e.ma.roy,k[2]=e.M.roz?f(o(e.S.roz,t.C,a.C),0)*Math.PI/180:e.ma.roz;var i=e.M.sc?o(e.S.sc,t.C,a.C):e.ma.sc;switch(C.euler_to_quat(k,U),M.set_sep(P,i,U,e.jc.ti),e.jc.rw=e.Xc.space_type,e.jc.rw){case 0:I.get_tsr(n,e.jc.Xk);break;case 1:I.get_tsr_rel(n,e.jc.Xk);break;case 2:I.get_tsr_rel(n,e.jc.Xk),M.multiply(e.jc.Xk,e.jc.ti,e.jc.ti)}if(0==(t=e.M.dur?f(o(e.S.dur,t.C,a.C),0):e.ma.dur)){r(n,e.jc.ti,e.jc.rw),a.pa=e.Oa;break}e.state=0,i=N.animate(0,1,1e3*t,function(t){E.Fa()&&(M.interpolate(e.jc.Xk,e.jc.ti,C.smooth_step(t),e.jc.Sq),r(n,e.jc.Sq,e.jc.rw),1==t&&(e.state=1))});break;case 1:N.clear_animation(i),e.state=-1,a.pa=e.Oa}}},SPEAKER_PLAY:function(e,t,a){switch(t.state){case 1:e.obj=v.lc(v.Ac,e.yc.id0,0),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),void 0==e.M.not_wait&&(e.M.not_wait=!0);break;case 2:switch(L.is_playing(e.obj)||0!=e.state||(e.state=1),e.state){case-1:for(var r in t.le){var n=t.le[r].fg.pa;-1!=n&&(n=t.le[r].V[n],"SPEAKER_PLAY"==n.type&&n!=e&&0==n.state&&n.obj==e.obj&&(n.state=1))}e.M.not_wait||(a.Sf=!0),L.play_def(e.obj),e.state=0;break;case 0:e.M.not_wait&&(a.pa=e.Oa,e.state=-1);break;case 1:e.M.not_wait||(a.Sf=!1),a.pa=e.Oa,e.state=-1;break;default:C.F("Unknown state of "+e.name),e.state=-1}}},SPEAKER_STOP:function(e,t,a){switch(t.state){case 1:e.obj=v.lc(v.Ac,e.yc.id0,0),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:L.stop(e.obj),a.pa=e.Oa}},STOP_ANIM:function(e,t,a){switch(t.state){case 1:e.obj=e.M.env?v.get_world_by_name(e.zq[0],0):c(e),e.obj||(b.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);break;case 2:p.stop(e.obj,p.SLOT_ALL),e.M.rst&&p.set_first_frame(e.obj,p.SLOT_ALL),a.pa=e.Oa}},STOP_TIMELINE:function(e,t,a,r){switch(t.state){case 2:e.M.rst&&h.eH(r),h.VA(),a.pa=e.Oa}},CONSOLE_PRINT:function(e,t,a){switch(t.state){case 2:var r,n={};for(r in e.S)n[e.S[r][1]]=o(e.S[r],t.C,a.C);b.log(e.Xc.msg,JSON.stringify(n)),a.pa=e.Oa}},STRING:function(e,t,a){switch(t.state){case 2:var r=e.M.id0?f(o(e.S.id0,t.C,a.C),1):e.Dj.id0,n=e.M.id1?f(o(e.S.id1,t.C,a.C),1):e.Dj.id1,_=0;switch(e.Xc.string_operation){case 0:_=r+n;break;case 1:_=r.indexOf(n);break;case 2:_=r.replace(n,e.M.id2?f(o(e.S.id2,t.C,a.C),1):e.Dj.id2);break;case 3:var s=e.S,_=r.substring(0,r.indexOf(n));i(s.dst1,t.C,a.C,r.substring(r.indexOf(n)+1,r.length)),""==o(s.dst,t.C,a.C)&&(_=o(s.dst1,t.C,a.C),i(s.dst1,t.C,a.C,""));break;case 4:switch(e.Xc.condition){case 5:_=r==n?1:0;break;case 4:_=r!=n?1:0;break;case 3:_=r<n?1:0;break;case 2:_=r>n?1:0;break;case 1:_=r<=n?1:0;break;case 0:_=r>=n?1:0}}i(e.S.dst,t.C,a.C,_),a.pa=e.Oa}},GET_TIMELINE:function(e,t,a,r){switch(t.state){case 2:r=e.M.nla?f(h.get_frame(r),0):f(N.get_frame(r),0),i(e.S.vd,t.C,a.C,r),a.pa=e.Oa}},JSON:function(e,t,a){switch(t.state){case 2:switch(e.Xc.json_operation){case"PARSE":try{var r=JSON.parse(f(o(e.S.jsn,t.C,a.C),1));!function(e,t,a,r){for(var n=0;n<t.length;n++){for(var o=t[n].split("."),i=e,_=a[n],s=0;s<o.length&&void 0!==(i=i[o[s]])&&null!==i;s++);i=u(i),r[_]=i}}(r,e.UR,e.VR,a.C)}catch(e){b.error("logic script error: non valid JSON string")}break;case"ENCODE":r={},function(e,t,a,r){r||(r={});for(var n=0;n<t.length;n++){var o=t[n].split("."),i=r,_=a[n];if(_ in e){for(var s=0;s<o.length-1;s++)void 0===i[o[s]]&&(i[o[s]]=isNaN(o[s+1])?{}:[]),i=i[o[s]];i[o[o.length-1]]=u(e[_])}}}(a.C,e.yO,e.zO,r),r=f(JSON.stringify(r),1),i(e.S.jsn,t.C,a.C,r)}a.pa=e.Oa}},JS_CALLBACK:function(e,t,a){switch(t.state){case 2:for(var r=e.M.cb?f(o(e.S.cb,t.C,a.C),1):e.Dj.cb,n=[],_=0,s="id"+_,c=e.Xc.js_cb_params;s in c;)s=0==c[s]?v.lc(v.Ac,e.yc[s],0):o(e.S[s],t.C,a.C),n.push(s),_++,s="id"+_;for(c=[],_=0,s="out"+_;s in e.S;)s=o(e.S[s],t.C,a.C),c.push(s),_++,s="out"+_;if(_=1,r in X){if(_=!X[r](n,c))for(r=0;r<c.length;r++)(s="out"+r)in e.S&&i(e.S[s],t.C,a.C,u(c[r]))}else b.error("logic script error: no custom callback with id "+r);_&&(a.pa=e.Oa)}},EMPTY:_},H=[],X={},q={};e.wQ=function(e,t){var a={Rd:t,QG:e.name,state:0,pm:null,eb:e,sy:null,le:[],Or:[],C:{}};e.AW=a,l(e,a)},e.update=function(e,t){var a=h.$P();if(!(0>=a))for(var r=0;r<H.length;r++)for(var n=r,o=e,i=t,_=a,s=H[n],c=0;c<H[n].le.length;c++){s.sy=H[n].le[c];var l=H[n].le[c],f=s,u=o,d=i,p=_,m=l.V;if(m.length){for(var g=0;g<m.length;g++)m[g].Qv=!1;for(g=0;g<m.length&&0<=l.fg.pa;g++){var v=m[l.fg.pa];if(v.Qv)break;if(v.mute){if("ENTRYPOINT"==v.type)break;l.fg.pa=v.Oa,v.Qv=!0}else v.vG(v,f,l.fg,u,d,p),v.Qv=!0}}}},e.lL=function(e,t){X[e]=t},e.sS=function(e){delete X[e]},e.OS=function(e,t){for(var a=0;a<H.length;a++)if(H[a].QG==e){for(var a=H[a],r=0;r<a.le.length;r++){var n=a.le[r].V[0];if(n.name==t){n.M.js&&(n.mute=!1),a.le[r].fg.pa=0;break}}break}},e.cleanup=function(){H.length=0,X={},q={}}},a.module.__main=function(e,t){function a(e,t,a){var n=r.get_canvas();if(n.toBlob)n.toBlob(e,t,a);else{a=atob(n.toDataURL(t,a).split(",")[1]);for(var n=new Uint8Array(a.length),o=0;o<a.length;o++)n[o]=a.charCodeAt(o);e(new Blob([n],{type:t||"image/png"}))}}var r=t("__container"),n=null,o="image/png",i=1,_="",s=!1,c=!1;e.canvas_data_url=function(e,t,a,r){s=c="undefined"!==typeof r||r,n=e,o=t||o,i=a||i},e.frame=function(){var e=n;e&&(s&&URL.revokeObjectURL(_),a(function(t){_=URL.createObjectURL(t),e(_)},o,i),n=null,o="image/png",i=1)}},a.module.__math=function(e,t){function a(e,t){for(var a=e[1],r=1,n=2;n<e.length;n++)4!=n&&8!=n&&Math.abs(e[n])>Math.abs(a)&&(a=e[n],r=n);for(var o=Math.floor(r/3),r=r%3,a=.5*Math.atan(2*a/(e[3*o+o]-e[3*r+r])),n=0;n<t.length;n++)t[n]=n&&4!=n&&8!=n?0:1;return t[r+3*o]=-Math.sin(a),t[o+3*r]=Math.sin(a),t[o+3*o]=Math.cos(a),t[r+3*r]=Math.cos(a),t}function r(e){return Math.sqrt(e[1]*e[1]+e[2]*e[2]+e[5]*e[5])}function n(e,t){for(var a=e.content[t];0<t;){var r=(t+1>>1)-1,n=e.content[r];if(!(e.ym(a)<e.ym(n)))break;e.content[r]=a,e.content[t]=n,t=r}}function o(e,t){for(var a=e.content.length,r=e.content[t],n=e.ym(r);;){var o=t+1<<1,i=o-1,_=null;if(i<a){var s=e.ym(e.content[i]);s<n&&(_=i)}if(o<a&&e.ym(e.content[o])<(null===_?n:s)&&(_=o),null===_)break;e.content[t]=e.content[_],e.content[_]=r,t=_}}function i(e,t,a,r){return a-_(r-e,0,a,r)+t}function _(e,t,a,r){return(e/=r)<1/2.75?7.5625*a*e*e+t:e<2/2.75?a*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?a*(7.5625*(e-=2.25/2.75)*e+.9375)+t:a*(7.5625*(e-=2.625/2.75)*e+.984375)+t}var s=t("__mat3"),c=t("__vec3"),l=new Float32Array(3),f=new Float32Array(9),u=new Float32Array(9),d=new Float32Array(9),p=new Float32Array(9);e.get_pline_directional_vec=function(e,t){return t=t||new Float32Array(3),t[0]=e[3],t[1]=e[4],t[2]=e[5],t},e.get_pline_initial_point=function(e,t){return t=t||new Float32Array(3),c.copy(e,t)},e.set_pline_initial_point=function(e,t){c.copy(t,e)},e.set_pline_directional_vec=function(e,t){c.normalize(t,l),e[3]=l[0],e[4]=l[1],e[5]=l[2]},e.calc_pline_point=function(e,t,a){return a=a||new Float32Array(3),a[0]=e[0]+e[3]*t,a[1]=e[1]+e[4]*t,a[2]=e[2]+e[5]*t,a},e.gM=function(e,t){t[0]=0,t[1]=0;for(var a=t[2]=0;a<e.length;a+=3)t[0]+=e[a],t[1]+=e[a+1],t[2]+=e[a+2];return c.scale(t,3/e.length,t)},e.dM=function(e,t,a){for(var r=0;r<a.length;r++)a[r]=0;for(r=0;r<e.length;r+=3){var n=e[r]-t[0],o=e[r+1]-t[1],i=e[r+2]-t[2];a[0]+=n*n,a[1]+=n*o,a[2]+=n*i,a[4]+=o*o,a[5]+=o*i,a[8]+=i*i}for(a[3]=a[1],a[6]=a[2],a[7]=a[5],r=0;r<a.length;r++)a[r]*=3/e.length;return a},e.NO=function(e,t){var n=s.copy(e,f);if(5e-4>r(n))return s.identity(t);var o=a(n,u),i=s.transpose(o,d);s.multiply(n,i,p),s.multiply(o,p,n);for(var _=s.copy(o,t),c=1;5e-4<=r(n)&&100>c;)o=a(n,u),i=s.transpose(o,d),s.multiply(n,i,p),s.multiply(o,p,n),s.multiply(o,_,_),c++;return _},e.point_plane_dist=function(e,t){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]},e.PL=function(e){return{content:[],ym:e}},e.PC=function(e,t){e.content.push(t),n(e,e.content.length-1)},e.QL=function(e){var t=e.content[0],a=e.content.pop();return 0<e.content.length&&(e.content[0]=a,o(e,0)),t},e.NW=function(e,t){var a=e.content.indexOf(t),r=e.content.pop();a!==e.content.length-1&&(e.content[a]=r,e.ym(r)<e.ym(t)?n(a):o(a))},e.RL=function(e,t){n(e,e.content.indexOf(t))},e.linear_tween=function(e,t,a,r){return a*e/r+t},e.ease_in_quad=function(e,t,a,r){return a*(e/=r)*e+t},e.ease_out_quad=function(e,t,a,r){return-a*(e/=r)*(e-2)+t},e.ease_in_out_quad=function(e,t,a,r){return 1>(e/=r/2)?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t},e.ease_in_cubic=function(e,t,a,r){return a*(e/=r)*e*e+t},e.ease_out_cubic=function(e,t,a,r){return a*((e=e/r-1)*e*e+1)+t},e.ease_in_out_cubic=function(e,t,a,r){return 1>(e/=r/2)?a/2*e*e*e+t:a/2*((e-=2)*e*e+2)+t},e.ease_in_quart=function(e,t,a,r){return a*(e/=r)*e*e*e+t},e.ease_out_quart=function(e,t,a,r){return-a*((e=e/r-1)*e*e*e-1)+t},e.ease_in_out_quart=function(e,t,a,r){return 1>(e/=r/2)?a/2*e*e*e*e+t:-a/2*((e-=2)*e*e*e-2)+t},e.ease_in_quint=function(e,t,a,r){return a*(e/=r)*e*e*e*e+t},e.ease_out_quint=function(e,t,a,r){return a*((e=e/r-1)*e*e*e*e+1)+t},e.ease_in_out_quint=function(e,t,a,r){return 1>(e/=r/2)?a/2*e*e*e*e*e+t:a/2*((e-=2)*e*e*e*e+2)+t},e.ease_in_sine=function(e,t,a,r){return-a*Math.cos(e/r*(Math.PI/2))+a+t},e.ease_out_sine=function(e,t,a,r){return a*Math.sin(e/r*(Math.PI/2))+t},e.ease_in_out_sine=function(e,t,a,r){return-a/2*(Math.cos(Math.PI*e/r)-1)+t},e.ease_in_expo=function(e,t,a,r){return 0==e?t:a*Math.pow(2,10*(e/r-1))+t},e.ease_out_expo=function(e,t,a,r){return e==r?t+a:a*(1-Math.pow(2,-10*e/r))+t},e.ease_in_out_expo=function(e,t,a,r){return 0==e?t:e==r?t+a:1>(e/=r/2)?a/2*Math.pow(2,10*(e-1))+t:a/2*(2-Math.pow(2,-10*--e))+t},e.ease_in_circ=function(e,t,a,r){return-a*(Math.sqrt(1-(e/=r)*e)-1)+t},e.ease_out_circ=function(e,t,a,r){return a*Math.sqrt(1-(e=e/r-1)*e)+t},e.ease_in_out_circ=function(e,t,a,r){return 1>(e/=r/2)?-a/2*(Math.sqrt(1-e*e)-1)+t:a/2*(Math.sqrt(1-(e-=2)*e)+1)+t},e.ease_in_elastic=function(e,t,a,r){var n=0,o=a;return 0==e?t:1==(e/=r)?t+a:(n||(n=.3*r),o<Math.abs(a)?(o=a,a=n/4):a=n/(2*Math.PI)*Math.asin(a/o),-o*Math.pow(2,10*--e)*Math.sin(2*(e*r-a)*Math.PI/n)+t)},e.ease_out_elastic=function(e,t,a,r){var n,o=0,i=a;return 0==e?t:1==(e/=r)?t+a:(o||(o=.3*r),i<Math.abs(a)?(i=a,n=o/4):n=o/(2*Math.PI)*Math.asin(a/i),i*Math.pow(2,-10*e)*Math.sin(2*(e*r-n)*Math.PI/o)+a+t)},e.ease_in_out_elastic=function(e,t,a,r){var n,o=0,i=a;return 0==e?t:2==(e/=r/2)?t+a:(o||(o=.3*r*1.5),i<Math.abs(a)?(i=a,n=o/4):n=o/(2*Math.PI)*Math.asin(a/i),1>e?-.5*i*Math.pow(2,10*--e)*Math.sin(2*(e*r-n)*Math.PI/o)+t:i*Math.pow(2,-10*--e)*Math.sin(2*(e*r-n)*Math.PI/o)*.5+a+t)},e.ease_in_back=function(e,t,a,r,n){return void 0==n&&(n=1.70158),a*(e/=r)*e*((n+1)*e-n)+t},e.ease_out_back=function(e,t,a,r,n){return void 0==n&&(n=1.70158),a*((e=e/r-1)*e*((n+1)*e+n)+1)+t},e.ease_in_out_back=function(e,t,a,r,n){return void 0==n&&(n=1.70158),1>(e/=r/2)?a/2*e*e*((1+(n*=1.525))*e-n)+t:a/2*((e-=2)*e*((1+(n*=1.525))*e+n)+2)+t},e.ease_in_bounce=i,e.ease_out_bounce=_,e.ease_in_out_bounce=function(e,t,a,r){return e<r/2?.5*i(2*e,0,a,r)+t:.5*_(2*e-r,0,a,r)+.5*a+t}},a.module.__navmesh=function(e,t){function a(e,t){function a(e){var t=e[0];e[0]=e[1],e[1]=e[2],e[2]=t}for(var r=e.fl,o=t.fl,i=[],_=0;_<r.length;_++)0<=n(o,r[_])&&i.push(r[_]);if(2>i.length)return[];for(0<=n(i,r[0])&&0<=n(i,r[r.length-1])&&a(r),0<=n(i,o[0])&&0<=n(i,o[o.length-1])&&a(o),i=[],_=0;_<r.length;_++)0<=n(o,r[_])&&i.push(r[_]);return i}function r(e){function t(e){for(var a=e.Hg,r=0;r<a.length;r++){var n=a[r];void 0==n.island&&(n.island=e.island,t(n))}}e=e.eS;for(var a=[],r=0,n=0;n<e.length;n++){var o=e[n];void 0==o.island&&(o.island=r++,t(o)),a[o.island]||(a[o.island]=[]),a[o.island].push(e[n])}return a}function n(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]==t)return a;return-1}function o(e){function t(e,t){for(var a=0;a<e.length;a++)if(t===e[a])return a}for(var n={},o=e.ip,i=0;i<o.length;i++)o[i][0]=parseFloat(o[i][0].toFixed(2)),o[i][1]=parseFloat(o[i][1].toFixed(2)),o[i][2]=parseFloat(o[i][2].toFixed(2));for(n.ip=e.ip,e=r(e),n.sz=[],i=0;i<e.length;i++){for(var o=[],_=e[i],s=0;s<_.length;s++){for(var c=[],l=_[s],f=0;f<l.Hg.length;f++)c.push(t(_,l.Hg[f]));for(var u=[],f=0;f<l.Hg.length;f++)u.push(a(l,l.Hg[f]));l.Wc[0]=parseFloat(l.Wc[0].toFixed(2)),l.Wc[1]=parseFloat(l.Wc[1].toFixed(2)),l.Wc[2]=parseFloat(l.Wc[2].toFixed(2)),o.push({id:t(_,l),Hg:c,fl:l.fl,Wc:l.Wc,Nc:l.Nc,fS:u,Iy:0,Iq:0,Jb:0,UM:1,zB:!1,closed:!1,parent:null})}n.sz.push(o)}return n}function i(e,t,a,r,n){function o(e,t){return b.subtract(e,t,A),b.dot(A,A)}!function(e){for(var t=0;t<e.length;t++){var a=e[t];a.Iy=0,a.Iq=0,a.Jb=0,a.UM=1,a.zB=!1,a.closed=!1,a.parent=null}}(e);var i=g.PL(function(e){return e.Iy});for(g.PC(i,t);0<i.content.length;){var _=g.QL(i);if(_===a){for(e=_,a=[];e.parent;)a.push(e),e=e.parent;return a.push(t),a.reverse()}_.closed=!0;for(var s=function(e,t){for(var a=[],r=0;r<t.Hg.length;r++)a.push(e[t.Hg[r]]);return a}(e,_),c=0,l=s.length;c<l;c++){var f=s[c];if(!f.closed){var u=_.Iq+b.dist(f.Wc,_.Wc),d=f.zB;(!d||u<f.Iq)&&(f.zB=!0,f.parent=_,f.Jb=f.Jb||o(f.Wc,n)+o(f.Wc,r),f.Iq=u,f.Iy=f.Iq+f.Jb,d?g.RL(i,f):g.PC(i,f))}}}return[]}function _(e,t){e.push(t[0]),e.push(t[1]),e.push(t[2])}function s(e,t,a,r){return t=b.subtract(t,e,A),e=b.subtract(a,e,x),e=b.cross(t,e,A),v.sign(b.dot(r,e))}function c(e,t){return b.subtract(e,t,A),1e-5>b.dot(A,A)}function l(e,t,a){var r=b.subtract(t.right,t.left,A),n=a.Nc,o=t.Nc;a=Math.acos(b.dot(n,o)),n=v.sign(b.dot(r,b.cross(n,o,x))),a*=-n,n=h.identity(R),h.translate(n,t.left,n),h.rotate(n,a,r,n),h.translate(n,b.scale(t.left,-1,x),n),h.multiply(e,n,e)}function f(e,t,a,r,n,o,i,s,c){for(var f=h.identity(O),u=n;u<a;u++)if(e[u].nF&&(u>n||!u)){var d,p=t,m=r;d=e[u].left;var g=e[u].right,v=o,x=f,w=b.create(),R=b.transformMat4(d,x,T);R[3]=1,x=b.transformMat4(g,x,A),x=b.subtract(x,R,y),p=b.subtract(m,p,A),v=b.cross(v,p,S),.01>Math.abs(b.dot(v,x))?m=.5:(b.normalize(v,v),v[3]=-b.dot(v,m),m=-E.dot(v,R)/E.dot(v,x)),g=b.subtract(g,d,A),d=b.scaleAndAdd(d,g,m,w),_(i,d),s&&_(c,e[u].Nc),u&&l(f,e[u],e[u-1])}}function u(e,t){function a(t,a){E=v=g=a,o=n=r=t,b.copy(t,i),b.copy(t,u),b.copy(e[g].Nc,d)}var r,n,o,i,u,d,p=[],m=[],g=0,v=0,E=0;r=e[0].right,n=e[0].left,o=e[0].right,i=b.copy(n,L),u=b.copy(o,N),d=b.copy(e[0].Nc,C),_(p,r),t&&_(m,e[0].Nc);for(var A=h.identity(w),x=1;x<e.length;x++){var T=e[x].left,y=e[x].right,S=b.transformMat4(T,A,I),O=b.transformMat4(y,A,M);if(e[x].nF&&l(A,e[x],e[x-1]),0>=s(r,u,O,d)){var R=c(r,o);if(!(R||0<s(r,i,O,d))){(T=c(i,r))||f(e,i,v,r,g,d,p,t,m),A=h.identity(A),a(n,v),x=g,T||(_(p,r),t&&_(m,e[x].Nc));continue}o=y,b.copy(O,u),E=x}0<=s(r,i,S,d)&&((R=c(r,n))||0>s(r,u,S,d)?(n=T,b.copy(S,i),v=x):((T=c(u,r))||f(e,u,E,r,g,d,p,t,m),A=h.identity(A),a(o,E),x=g,T||(_(p,r),t&&_(m,e[x].Nc))))}return A=e.length-1,x=e[A].left,(T=c(r,x))||f(e,i,A,r,g,d,p,t,m),T&&g||_(p,x),t?(_(m,e[A].Nc),{positions:new Float32Array(p),normals:new Float32Array(m)}):{positions:new Float32Array(p),normals:null}}function d(e,t,a,r,n){for(var o=null,i=Number.MAX_VALUE,_=0;_<e.length;_++){var s=e[_],c=n(a,s.Wc,s.fl,t,i);c<i&&(o=s,i=c)}return 0<r&&i>r?null:o}function p(e,t,a,r,n){e.push({left:t,right:a,nF:r,Nc:n})}var m=t("__geometry"),g=t("__math"),h=t("__mat4"),v=t("__util"),b=t("__vec3"),E=t("__vec4"),A=b.create(),x=b.create(),T=E.create(),y=E.create(),S=E.create(),O=h.create(),w=h.create(),R=h.create(),L=b.create(),N=b.create(),I=b.create(),M=b.create(),C=b.create();e.HR=function(e){var t=m.Xy(e.Yb,m.an),a=e.Td;e=[];for(var r=0;r<a.length;r+=3)e.push({qa:new Uint32Array([a[r],a[r+1],a[r+2]]),Wc:new Float32Array(3),Nc:new Float32Array(3)});for(a=[],r=0;r<t.length;r+=3){var n=new Float32Array(3);n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],a.push(n)}for(t=0;t<e.length;t++)r=e[t],b.add(a[r.qa[0]],a[r.qa[1]],A),b.add(A,a[r.qa[2]],A),b.scale(A,1/3,r.Wc);for(t=0;t<e.length;t++){var r=e[t],n=b.subtract(a[r.qa[1]],a[r.qa[0]],A),i=b.subtract(a[r.qa[2]],a[r.qa[0]],x),n=b.cross(n,i,A);b.normalize(n,n),b.copy(n,r.Nc)}for(var _,s,c={},t=[],r=[],l=Math.pow(10,4),n=0,i=a.length;n<i;n++)_=a[n],s=Math.round(_[0]*l)+"_"+Math.round(_[1]*l)+"_"+Math.round(_[2]*l),void 0===c[s]?(c[s]=n,t.push(_),r[n]=t.length-1):r[n]=r[c[s]];for(c=[],n=0,i=e.length;n<i;n++)for(_=e[n],_.qa[0]=r[_.qa[0]],_.qa[1]=r[_.qa[1]],_.qa[2]=r[_.qa[2]],_=[_.qa[0],_.qa[1],_.qa[2]],s=0;3>s;s++)if(_[s]==_[(s+1)%3]){c.push(n);break}for(n=c.length-1;0<=n;n--)e.splice(c[n],1);for(n=a.length=0;n<t.length;n++)a.push(t[n]);for(r=[],t=n=0;t<e.length;t++)i=e[t],r.push({id:n++,fl:i.qa,Wc:i.Wc,Nc:i.Nc,Hg:[]});for(e={eS:r,ip:a},a={},t=0;t<r.length;t++)for(n=0;3>n;n++)i=r[t].fl[n],c=r[t].fl[(n+1)%3],i=i>c?c+"-"+i:i+"-"+c,i in a||(a[i]=[]),a[i].push(r[t]);for(r=Object.keys(a),t=0,c=r.length;t<c;t++)for(i=r[t],n=0;n<a[i].length;n++)for(_=n+1;_<a[i].length;_++)a[i][n].Hg.push(a[i][_]),a[i][_].Hg.push(a[i][n]);return o(e)},e.navmesh_get_island=function(e,t,a){for(var r=null,n=Number.MAX_VALUE,o=e.sz,i=0;i<o.length;i++)for(var _=0;_<o[i].length;_++){var s=o[i][_];b.subtract(s.Wc,t,A),s=a(t,s.Wc,s.fl,e.ip,n),s<n&&(r=i,n=s)}return r},e.KQ=function(e,t,a){for(var r=[],n=0;n<t.length;n++)r.push(a[t[n]]);t=!1,a=-1;for(var n=r.length,o=n-1;++a<n;o=a)(r[a][1]<=e[1]&&e[1]<r[o][1]||r[o][1]<=e[1]&&e[1]<r[a][1])&&e[0]<(r[o][0]-r[a][0])*(e[1]-r[a][1])/(r[o][1]-r[a][1])+r[a][0]&&(t=!t);return!!t},e.navmesh_find_path=function(e,t,a,r){var n;n=e.sz[r.island];var o=e.ip,_=d(n,o,t,r.allowed_distance,r.distance_to_closest);if((n=_&&(o=d(n,o,a,r.allowed_distance,r.distance_to_farthest))?i(n,_,o,t,a):null)&&n.length)if(r.do_not_pull_string)if(a=n,r.return_normals){for(t=new Float32Array(3*a.length),n=0;n<a.length;n++)t.set(a[n].Wc,3*n);a={positions:t,normals:null}}else{for(t=new Float32Array(3*a.length),e=new Float32Array(3*a.length),n=0;n<a.length;n++)t.set(a[n].Wc,3*n),e.set(a[n].Nc,3*n);a={positions:t,normals:e}}else{for(e=e.ip,r=r.return_normals,_=[],p(_,t,t,!1,n[0]&&n[0].Nc||v.AXIS_Z),t=0;t<n.length;t++){var s=n[t];if(o=n[t+1]){var c=.999>Math.abs(b.dot(s.Nc,o.Nc));e:{for(var l=0;l<s.Hg.length;l++)if(s.Hg[l]===o.id){s=s.fS[l];break e}s=void 0}p(_,e[s[0]],e[s[1]],c,o.Nc)}}p(_,a,a,!1,_[_.length-1].Nc),a=u(_,r)}else a=null;return a}},a.module.__nla=function(e,t){function a(e,t){for(var a=u.pP(),r=[],n=0,o=0;o<e.length;o++){var i=e[o];if(""!=i.Ap?i=E.keysearch("uuid",i.Ap,a):(i=i.ng,i=E.keysearch("name",i,a)||E.keysearch("name",i+"_B4W_BAKED",a)),i){var _,i=i.fcurves,s=[];for(_ in i)s.push(_);r.push(s)}}for(o=0;o<r.length;o++){for(a=!1,_=0;_<o;_++)if(E.CL(r[o],r[_])){e[o].uc=e[_].uc,a=!0;break}a||(e[o].uc=t+n++)}return n}function r(){return{type:"CLIP",sa:0,Za:0,tj:!1,paused:!1,ng:"",Ap:"",uc:0,io:null,Qj:0,ml:0,eE:0,dE:0,tI:!1,scale:1,repeat:1,uC:0}}function n(e,t,a){if(e.animation_data){var r=e.animation_data.nla_tracks;if(r)for(var o=0;o<r.length;o++)r[o].io=a,t.push(r[o])}for(e=e.nodes,o=0;o<e.length;o++)if(r=e[o],r.node_group){var i=r.node_group.node_tree;if(i){var _=a.slice();_.push(r.name),n(i,t,_)}}}function o(e,t){var a=Math.round(e)-t.sa;return t.Jj&&0>(a%=t.ek)&&(a+=t.ek),t.Wb+a}function i(e,t){var a=(t-x)*b.pd()+e.Wb;return a>e.sa?(a-=e.sa,e.cyclic&&(a%=e.Za-e.sa+1),a+=e.sa):a=e.sa,a}function _(e,t){e=E.clamp(e,t.sa,t.Za);var a=e==t.Za?t.uC:t.Qj+(e-t.sa)/t.scale%(t.ml-t.Qj);return t.tI&&(a=t.ml-a+t.Qj),a}function s(e,t){for(var a=[],n=0;n<e.length;n++){var o=e[n],i=o.strips;if(i)for(var _=0;_<i.length;_++){var s=i[_],c=r();c.type=s.type,c.sa=s.frame_start,c.Za=s.frame_end,c.uc=t,c.Qj=s.action_frame_start,c.ml=s.action_frame_end,c.tI=s.use_reverse,c.scale=s.scale,c.repeat=s.repeat,s.action&&(c.ng=s.action.name,c.Ap=s.action.uuid,c.io=o.io),a.push(c)}}return a}function c(e){return!("SPEAKER"!=e.type&&"LAMP"!=e.type||!e.data.animation_data||!e.data.animation_data.nla_tracks.length)}function l(e){if("MESH"!=e.type||!e.data)return!1;if(!(e=e.data.materials))return!1;for(var t=0;t<e.length;t++){var a=e[t],r=a.node_tree;if(a=a.use_nodes&&r)if(r.animation_data&&(a=r.animation_data.nla_tracks)&&a.length)a=!0;else{for(r=r.nodes,a=0;a<r.length;a++);a=!1}if(a)return!0}return!1}function f(e,t){var a=g.get_active();if(a.wa){var r=i(a.wa,t);a.wa.Wb-=r-e,a.wa.Kn=!0}}var u=t("__animation"),d=t("__objects"),p=t("__obj_util"),m=t("__print"),g=t("__scenes"),h=t("__sfx"),v=t("__textures"),b=t("__time"),E=t("__util"),A=[],x=-1;e.$k=function(e,t){for(var o,i=null,_=t.K.length-1;0<=_&&(o=t.K[_],!o.eb.b4w_use_nla||(i=o,!o.eb.qC));_--);if(o=i){if(o.hG=!0,i=0,(_=e.animation_data)&&_.nla_tracks.length){var l=_.nla_tracks;(p.is_armature(t)||p.is_camera(t)||p.is_mesh(t)||p.is_empty(t)||p.is_line(t)||p.is_lamp(t)||p.is_speaker(t)||p.is_world(t))&&(l=s(l,i),l.length&&(t.jf=t.jf.concat(l),i++))}if(c(e)&&(l=e.data.animation_data.nla_tracks,l=s(l,i),l.length&&(t.jf=t.jf.concat(l),i++)),p.is_mesh(t))for(var f=e.data.materials,_=0;_<f.length;_++){var u=f[_];u.use_nodes&&u.node_tree&&(l=[],n(u.node_tree,l,[u.name]),l=s(l,i),l.length&&(i+=a(l,i),t.jf=t.jf.concat(l)))}if(p.is_world(t))e.use_nodes&&e.node_tree&&(l=[],n(e.node_tree,l,[e.name]),l=s(l,i),l.length&&(a(l,i),t.jf=t.jf.concat(l)));else{for(_=0;_<e.particle_systems.length;_++)l=e.particle_systems[_],f=l.settings,"EMITTER"==f.type&&f.b4w_allow_nla&&(f=r(),f.type="CLIP",f.sa=o.eb.frame_start,f.Za=o.eb.frame_end+1,f.ng=l.name,f.uc=i,f.Qj=f.sa,f.ml=f.Za,t.jf.push(f),i++);for(o=i+1,_=0;_<t.Rc.length;_++)l=t.Rc[_],l.dL&&(i=o,f=r(),f.type="CLIP",f.sa=l.sa,f.Za=l.Za,f.ng=l.name,f.uc=i,f.Qj=f.sa,f.ml=f.Za,t.jf.push(f))}}},e.VU=function(e,t,a){e.wa||(e.wa={sa:e.frame_start,Za:e.frame_end,Wb:0,Zq:-1,xr:e.frame_end,yr:e.frame_start,Pm:null,cyclic:t,$a:[],fa:[],QG:e.name,rk:!1,Kn:!1,xA:!0},A.push(e.wa)),t=e.wa;for(var n=d.KE(e,"ALL",a),o=0;o<n.length;o++){var i=n[o];if(i.jf.length){t.$a[a]||(t.$a[a]=[]);for(var _=0;_<i.K.length;_++){var s=i.K[_];s.eb==e&&s.hG&&t.$a[a].push(i)}for(var _=i.jf,s=t,c=i.name,l=0;l<_.length;l++){var f=_[l];s.sa>f.Za||s.Za<f.sa?(m.warn("NLA: Strip is out of scene range: "+c+" ["+f.sa+":"+f.Za+"]"),_.splice(l,1),l--):f.ng||"CLIP"!=f.type||(m.warn('NLA: no action in strip for object "'+c+'".'),_.splice(l,1),l--)}for(i=i.jf,_=t,s=0;s<i.length;s++){for(var c=i[s],l=_.sa,f=_.Za+1,u=0;u<i.length;u++){var p=i[u];c.uc==p.uc&&(p.Za<=c.sa&&(l=c.sa),p.sa>=c.Za&&(f=Math.min(f,p.sa)))}c.eE=l,c.dE=f,c.uC=c.repeat%1?c.Qj+c.repeat%1*(c.ml-c.Qj):c.ml}}}for(e=e.G.jp,o=0;o<e.length;o++)n=e[o].G,n.bl&&(n.Wa||n.sd)&&n.ss==a&&(i=r(),i.type="VIDEO",n.Jj?(i.sa=0,i.Za=t.Za):(i.sa=E.clamp(n.sa,0,t.Za),i.Za=E.clamp(n.sa+n.ek,0,t.Za)),i.ng=e[o].name,t.fa.push(n))},e.start=function(){x=0},e.$P=function(){return x},e.CX=function(e){return e.wa?e.wa.Wb:null},e.xY=function(e,t){return!!e.wa&&(e.wa.Wb=t,!0)},e.update=function(e,t){if(!(0>x)){0==x&&(x=e);for(var a=0;a<A.length;a++){var r=A[a];r.rk&&(r.Wb-=b.pd()*t);var n=i(r,e);if((!r.rk||r.Kn)&&n>=r.xr)if(r.cyclic){var n=r,s=e;n.Pm&&n.Pm(),f(n.yr,s),n.xA=!0,n=i(n,s)}else{var s=r,c=n;s.rk=!0,s.Wb-=c-s.xr,s.Pm&&s.Pm()}if(!r.rk||r.Kn){for(var s=r,c=n,l=0;l<s.$a.length;l++){var d=s.$a[l];if(d)for(var p=0;p<d.length;p++){for(var m=d[p],g=m.jf,T=0;T<g.length;T++){var y=g[T];"SOUND"==y.type&&c<s.Zq-1e-6&&(y.tj=!1)}for(T=0;T<g.length;T++)switch(y=g[T],y.type){case"CLIP":if(y.eE<=c&&c<y.dE&&!y.tj){var l=m,S=y,O=S.io;for(""!=S.Ap?u.xL(l,O,S.Ap,S.uc):u.apply(l,O,S.ng,S.uc),u.set_behavior(l,u.AB_FINISH_STOP,S.uc),O=_(S.sa,S),u.set_frame(l,O,S.uc),l=0;l<g.length;l++)g[l]!=y&&g[l].uc==y.uc&&(g[l].tj=!1);y.tj=!0}y.tj&&(S=m,O=_(c,y),1e-6<Math.abs(O-u.Py(S,y.uc))&&u.set_frame(S,O,y.uc));break;case"SOUND":if((c<s.Zq-1e-6||s.Zq<y.sa)&&y.sa<=c&&c<y.Za&&!y.tj){var S=m,w=y,O=(w.sa-c)/b.pd(),w=(w.Za-w.sa)/b.pd();h.play(S,O,w),y.tj=!0}s.Zq<y.Za&&y.Za<=c&&y.tj&&(y.tj=!1)}}}for(s=e,c=r,d=n,p=0;p<c.fa.length;p++)m=c.fa[p],(m.Wa||m.sd)&&(g=v.EI(m),T=m,y=E.clamp(o(d,T),T.Wb,T.Wb+v.FI(T)-1),T.sd&&(y=v.qV(T,y))==T.Ir&&y--,T=y,y=v.GI(m),S=l=!1,(c.Kn||c.xA)&&(S=!0),c.rk||(O=o(d,m),O=m.Wb<=O&&O<=m.Wb+v.FI(m),w=v.HI(m),m.Jj&&T==y&&(S=!0),w||g==T||(S=!0),O&&!w?v.play_video(m):O&&w?l=!0:!O&&w&&(m.Wa&&g<T?l=!0:v.pause_video(m))),S?(v.hT(m,T),m.sd&&(m.Lk=v.Zv(m,s))):l&&v.II(m)&&(m.Wa?v.kI(m):(g=v.Zv(m,s),g!=m.Lk&&(m.vj=T,v.jI(m)),m.Lk=g)));r.Zq=n}r.Kn=!1,r.xA=!1}}},e.cleanup=function(e){if(0==e)A.length=0,x=-1;else for(var t=0;t<A.length;t++)A[t].$a[e]=null},e.VC=function(e){var t=e.animation_data;return!!(t&&t.nla_tracks.length||c(e)||l(e))},e.set_frame=f,e.get_frame=function(e){var t=g.get_active();return t.wa?i(t.wa,e):-1},e.VA=function(){var e=g.get_active();if(e.wa){e.wa.rk=!0;for(var e=e.wa.fa,t=0;t<e.length;t++)v.pause_video(e[t])}},e.sG=function(e){var t=g.get_active();t.wa&&(t.wa.rk=!1,t.wa.Pm=e||null)},e.get_frame_start=function(){var e=g.get_active();return e.wa?e.wa.sa:-1},e.get_frame_end=function(){var e=g.get_active();return e.wa?e.wa.Za:-1},e.is_play=function(){var e=g.get_active();return!!e.wa&&!e.wa.rk},e.check_nla=function(){var e=g.get_active();return!!e.wa&&e.b4w_use_nla},e.check_logic_nodes=function(){var e=g.get_active();return!!e.wa&&0<e.b4w_logic_nodes.length},e.set_range=function(e,t){var a=g.get_active();if(!a.wa)return!1;a.wa.yr=e,a.wa.xr=t},e.GA=function(e){var t=g.get_active();t.wa&&(t.wa.xr=e)},e.tT=function(e){var t=g.get_active();t.wa&&(t.wa.yr=e)},e.reset_range=function(){var e=g.get_active();if(!e.wa)return!1;e=e.wa,e.yr=e.sa,e.xr=e.Za},e.set_cyclic=function(e){var t=g.get_active();if(!t.wa)return!1;t.wa.cyclic=e},e.clear_callback=function(){var e=g.get_active();e.wa&&(e.wa.Pm=null)},e.eH=function(e){var t=g.get_active().wa;t&&(t.Wb=-(e-x)*b.pd()+t.yr,t.Kn=!0)},e.get_frame_end=function(){var e=g.get_active().wa;return e?e.Za:null}},a.module.__camera=function(e,t){function a(e,t,a,r,n){le.set_translation(e,t),a&&A(e,t,a),O(e,r),w(e,n)}function r(e,t,a,r,n,o,i,_){var s=e.o;le.set_translation(e,t),s.pivot.set(a),A(e,t,a),O(e,r),w(e,n),I(e,o),M(e,i),s.use_panning=_}function n(e,t,a,r,n,o,i,_){var s=e.o;le.set_translation(e,t),s.mc.set(a),A(e,t,a),N(e,r),R(e,n),C(e,o),D(e,i),s.tg=_}function o(e,t,a){var r=e.o,n=fe.get_trans_view(r.v),o=fe.get_quat_view(r.v),r=Re;return r.set(ue.AXIS_Z),r[3]=0,e=p(e,Ee)[1],o=ue.quat_to_dir(o,ue.AXIS_MZ,Te),ne.set_pline_initial_point(Ce,n),ne.set_pline_directional_vec(Ce,o),(!ue.line_plane_intersect(r,-t,Ce,a)||Math.abs(e)<ge)&&(ie.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),a[0]=n[0],a[1]=n[1],a[2]=0),a}function i(t){for(var a=t.o,r=0;r<t.K.length;r++){var n=t.K[r].ba[0];if(n.type==e.ce)switch(a.hb){case e.MS_TARGET_CONTROLS:var o=fe.get_trans_view(a.v);a.kk=de.dist(o,a.pivot),a.lk=n.kc;break;case e.MS_HOVER_CONTROLS:o=fe.get_trans_view(a.v),a.kk=de.dist(o,a.mc),a.lk=n.kc}}}function _(e){return e={type:e,name:"",tH:1,width:0,height:0,Ee:null,Hq:null,$b:null,bf:null,jb:0,kc:0,Gn:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,bd:pe.create(),v:new Float32Array(9),Mb:new Float32Array(16),$w:new Float32Array(16),pb:new Float32Array(16),gd:new Float32Array(16),Zw:new Float32Array(16),mA:new Float32Array(16),Kg:new Float32Array(16),direction:new Float32Array(3),vf:fe.Gl(),ax:fe.Gl(),Ar:fe.Gl(),Vv:fe.Gl(),Lr:fe.Gl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,wd:!1,dof_on:!1,fv:new Float32Array(3),ih:c(),Qk:0,qf:0,nc:null,Th:null,qq:null,Gt:new Float32Array(4),uo:new Float32Array(4)},e.bd[0]=e.bd[2]=0,e.bd[1]=e.bd[3]=0,e}function s(e,t){var a=_(e.type);if(a.name=e.name,a.tH=e.tH,a.width=e.width,a.height=e.height,t||(a.Ee=e.Ee,a.Hq=e.Hq,a.$b=e.$b,a.bf=e.bf),a.jb=e.jb,a.Gn=e.Gn,a.kc=e.kc,a.near=e.near,a.far=e.far,a.left=e.left,a.right=e.right,a.top=e.top,a.bottom=e.bottom,pe.copy(e.bd,a.bd),fe.copy(e.v,a.v),re.copy(e.Mb,a.Mb),re.copy(e.pb,a.pb),re.copy(e.gd,a.gd),re.copy(e.Zw,a.Zw),re.copy(e.mA,a.mA),re.copy(e.Kg,a.Kg),fe.copy(e.vf,a.vf),fe.copy(e.ax,a.ax),fe.copy(e.Ar,a.Ar),fe.copy(e.Vv,a.Vv),fe.copy(e.Lr,a.Lr),a.dof_distance=e.dof_distance,a.dof_front_start=e.dof_front_start,a.dof_front_end=e.dof_front_end,a.dof_rear_start=e.dof_rear_start,a.dof_rear_end=e.dof_rear_end,a.dof_power=e.dof_power,a.dof_bokeh_intensity=e.dof_bokeh_intensity,a.dof_object=e.dof_object,a.dof_bokeh=e.dof_bokeh,a.wd=e.wd,a.dof_on=e.dof_on,de.copy(e.fv,a.fv),l(e.ih,a.ih),a.Qk=e.Qk,a.qf=e.qf,e.nc&&(a.nc=pe.clone(e.nc)),e.Th){var r=e.Th.length;a.Th=Array(r);for(var n=0;n<r;n++)a.Th[n]=de.clone(e.Th[n]);a.qq=new Float32Array(e.qq)}return pe.copy(e.Gt,a.Gt),pe.copy(e.uo,a.uo),a}function c(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function l(e,t){pe.copy(e.left,t.left),pe.copy(e.right,t.right),pe.copy(e.top,t.top),pe.copy(e.bottom,t.bottom),pe.copy(e.near,t.near),pe.copy(e.far,t.far)}function f(t){switch(t){case"STATIC":return e.MS_STATIC;case"TARGET":return e.MS_TARGET_CONTROLS;case"EYE":return e.MS_EYE_CONTROLS;case"HOVER":return e.MS_HOVER_CONTROLS;default:ue.F("Unknown move style")}}function u(t){var a=_(t);if(t==e.rc)return a;switch(t){case e.Gc:h(a,me,.1,1e3);break;case e.ce:h(a,2.5,.1,1e3);break;case e.Se:case e.Vg:case e.Ai:break;case e.tc:case e.Bc:case e.Re:case e.xe:ue.F("Stereo camera may only be created from perspective one");break;default:ue.F("Unknown camera type")}return a}function d(t,a,r){if(t.type!=e.tc&&t.type!=e.Bc&&t.type!=e.Re&&t.type!=e.xe&&ue.F("set_stereo_params(): wrong camera type"),t.type!=e.tc&&t.type!=e.Bc||(t.Qk=a),t.qf=r,W(t,!1),se.Fa()&&(a=se.get_active(),t=a.G.Pc))for(a=oe.ya(se.gk(a),a).ba,r=0;r<a.length;r++)K(a[r],t)}function p(e,t){return m(fe.get_quat_view(e.o.v),t)}function m(e,t){var a=ue.quat_to_dir(e,ue.AXIS_Z,Te),r=ue.quat_to_dir(e,ue.AXIS_MY,ye),n=-Math.asin(a[2]/de.length(a)),a=Math.abs(n)>Math.PI/4?de.scale(r,-ue.sign(n),Se):de.scale(a,-ue.sign(r[2]),Se),o=Math.atan(Math.abs(a[0]/a[1]));return 0<r[2]&&(n=ue.sign(n)*Math.PI-n),r=o,0<a[1]&&(r=Math.PI-r),0>a[0]&&(r=2*Math.PI-r),t[0]=r,t[1]=n,t}function g(e){switch(e.Gn){case"AUTO":return 1<e.jb?$(e)?e.kc/e.jb:2*Math.atan(Math.tan(e.kc/2)/e.jb):e.kc;case"HORIZONTAL":return $(e)?e.kc/e.jb:2*Math.atan(Math.tan(e.kc/2)/e.jb);case"VERTICAL":return e.kc}}function h(t,a,r,n){switch(t.type){case e.Gc:case e.tc:case e.Bc:case e.ce:t.kc=a,t.jb=1;break;case e.Re:case e.xe:break;default:ue.F("set_frustum(): Unsupported camera type: "+t.type)}t.near=r,t.far=n}function v(t,a){var r=fe.Cb(a.o.v,Te),n=fe.mb(a.o.v,Oe),o=re.fromRotationTranslation(n,r,Ne);if(re.invert(o,t.Mb),se.Fa())var o=se.get_active(),i=se.Ib(o,ce.jg);if(t.type==e.tc||i&&i.enable_hmd_stereo&&t.type==e.Re?t.Mb[12]+=t.qf/2:(t.type==e.Bc||i&&i.enable_hmd_stereo&&t.type==e.xe)&&(t.Mb[12]-=t.qf/2),t.nc){fe.from_mat4(t.Mb,t.Ar),fe.invert(t.Ar,t.Vv);var o=t.nc[0],i=t.nc[1],_=t.nc[2],s=t.nc[3],c=t.$w;c[0]=1-2*o*o,c[1]=-2*o*i,c[2]=-2*o*_,c[3]=0,c[4]=-2*o*i,c[5]=1-2*i*i,c[6]=-2*i*_,c[7]=0,c[8]=-2*o*_,c[9]=-2*i*_,c[10]=1-2*_*_,c[11]=0,c[12]=-2*o*s,c[13]=-2*i*s,c[14]=-2*_*s,c[15]=1,re.multiply(t.Mb,t.$w,t.Mb),W(t,!0),o=Re,i=Ne,re.invert(t.Mb,i),re.transpose(i,i),pe.transformMat4(t.nc,i,o),i=Le,i[0]=(ue.sign(o[0])+t.pb[8])/t.pb[0],i[1]=(ue.sign(o[1])+t.pb[9])/t.pb[5],i[2]=-1,i[3]=(1+t.pb[10])/t.pb[14],pe.scale(o,2/(o[0]*i[0]+o[1]*i[1]+o[2]*i[2]+o[3]*i[3]),o),t.pb[2]=o[0],t.pb[6]=o[1],t.pb[10]=o[2]+1,t.pb[14]=o[3],de.transformMat4(r,t.$w,r)}fe.from_mat4(t.Mb,t.vf),fe.invert(t.vf,t.ax),V(t),Y(t),fe.set_sep(r,1,n,t.v)}function b(t,a,r,n){re.lookAt(a,r,n,t.Mb),r=se.get_active(),r=se.Ib(r,ce.jg),t.type==e.tc||r&&r.enable_hmd_stereo&&t.type==e.Re?t.Mb[12]+=t.qf/2:(t.type==e.Bc||r&&r.enable_hmd_stereo&&t.type==e.xe)&&(t.Mb[12]-=t.qf/2),fe.from_mat4(t.Mb,t.vf),V(t),Y(t),fe.set_trans(a,t.v)}function E(e,t,a){a=de.subtract(a,t,Te),de.length(a)&&(de.normalize(a,a),a=ue.MG(ue.AXIS_MZ,a,Oe),le.set_rotation(e,a)),le.set_translation(e,t)}function A(e,t,a){var r=e.o,n=S(e);E(e,t,a),n?(t=de.copy(r.Zd,Te),de.negate(t,t),T(e,t,!0)):T(e,r.Zd,!0)}function x(e,t){for(var a=e.o,r=t.ba,n=fe.mb(a.v,Oe),n=ue.quat_to_dir(n,ue.AXIS_MZ,Te),o=fe.Cb(a.v,ye),i=t.pH,_=0;_<i.length;_++){var s=i[_];de.copy(n,s.direction),fe.Cb(a.v,s.fv)}for(_=0;_<r.length;_++)s=r[_],v(s,e),de.copy(n,s.direction),ue.Ol(s.gd,s.ih),s.dof_object&&s.dof_on&&(a=le.get_translation(s.dof_object,Se),a=de.dist(o,a),s.dof_distance=a)}function T(t,a,r){var n=t.o,o=fe.get_quat_view(n.v),i=ue.quat_to_dir(o,ue.AXIS_Z,Te);if(de.normalize(i,i),.999999<Math.abs(de.dot(a,i)))i=_e.identity(Oe);else{var _=de.cross(a,i,ye);de.normalize(_,_),n.hb==e.MS_TARGET_CONTROLS?n.si&&de.negate(_,_):(n=ue.quat_to_dir(o,ue.AXIS_MY,Se),0<de.dot(n,a)&&de.negate(_,_)),n=ue.quat_to_dir(o,ue.AXIS_X,Se),de.normalize(n,n);var s=ue.clamp(de.dot(n,_),-1,1),i=-.999999>=s?_e.setAxisAngle(i,Math.acos(s),Oe):_e.rotationTo(n,_,Oe);_e.normalize(i,i)}_e.multiply(i,o,o),r&&(r=ue.quat_to_dir(o,ue.AXIS_Y,Te),0>de.dot(a,r)&&_e.rotateZ(o,Math.PI,o)),y(t)}function y(t){var a=t.o;a.hb==e.MS_TARGET_CONTROLS&&(a.si=S(t))}function S(e){return e=fe.get_quat_view(e.o.v),0>ue.quat_to_dir(e,ue.AXIS_Y,Te)[2]}function O(t,a){var r=t.o;if(a){r.Bb=r.Bb||{},r.Bb.left=a.left,r.Bb.right=a.right,r.Bb.ao=a.left,r.Bb.Bo=a.right,r.Bb.camera_space=!!a.camera_space;var n=t.o;!(r=n.Bb)||n.hb!=e.MS_EYE_CONTROLS&&n.hb!=e.MS_TARGET_CONTROLS||(n=p(t,Ee),r.camera_space?(r.left+=n[0],r.right+=n[0]):(r.ao-=n[0],r.Bo-=n[0]),r.left=ue.angle_wrap_0_2pi(r.left),r.right=ue.angle_wrap_0_2pi(r.right),r.ao=ue.angle_wrap_0_2pi(r.ao),r.Bo=ue.angle_wrap_0_2pi(r.Bo))}else r.Bb=null}function w(e,t){var a=e.o;t?(a.Ha=a.Ha||{},a.Ha.down=t.down,a.Ha.up=t.up,a.Ha.Bn=t.down,a.Ha.Zo=t.up,a.Ha.camera_space=!!t.camera_space,L(e)):a.Ha=null}function R(e,t){var a=e.o;if(!t){var r=p(e,Ee);t={down:r[1],up:r[1]}}a.Ha=a.Ha||{},a.Ha.down=t.down,a.Ha.up=t.up,L(e),a.vb&&a.Ha&&z(e)}function L(t){var a=t.o,r=a.Ha;if(r)switch(a.hb){case e.MS_EYE_CONTROLS:case e.MS_TARGET_CONTROLS:t=p(t,Ee),r.camera_space?(r.up+=t[1],r.down+=t[1]):(r.Zo-=t[1],r.Bn-=t[1]),r.up=ue.angle_wrap_periodic(r.up,-Math.PI,Math.PI),r.down=ue.angle_wrap_periodic(r.down,-Math.PI,Math.PI),r.Zo=ue.angle_wrap_periodic(r.Zo,-Math.PI,Math.PI),r.Bn=ue.angle_wrap_periodic(r.Bn,-Math.PI,Math.PI);break;case e.MS_HOVER_CONTROLS:r.up=ue.angle_wrap_periodic(r.up,-Math.PI,Math.PI),r.down=ue.angle_wrap_periodic(r.down,-Math.PI,Math.PI),r.up=ue.clamp(r.up,-Math.PI/2,0),r.down=ue.clamp(r.down,-Math.PI/2,0)}}function N(e,t){var a=e.o;if(!t){var r=le.ir(e,a.mc);t={min:r,max:r}}a.vb=a.vb||{},a.vb.min=t.min,a.vb.max=t.max,a.vb&&a.Ha&&z(e)}function I(e,t){var a=e.o;t?(a.vb=a.vb||{},a.vb.min=t.min,a.vb.max=t.max):a.vb=null}function M(e,t){var a=e.o;t?(a.rd=a.rd||{},a.rd.min_z=t.min_z,a.rd.max_z=t.max_z):a.rd=null}function C(e,t){var a=e.o;t?(a.Lc=a.Lc||{},a.Lc.min=t.min,a.Lc.max=t.max):a.Lc=null}function D(e,t){var a=e.o;t?(a.Mc=a.Mc||{},a.Mc.min=t.min,a.Mc.max=t.max):a.Mc=null}function U(t){var a=t.o;if(oe.is_camera(t))for(var r=t.K,n=0;n<r.length;n++){var o=r[n].ba;if(o[0].type===e.ce){switch(a.hb){case e.MS_TARGET_CONTROLS:var i=fe.get_trans_view(a.v),i=de.dist(i,a.pivot),i=i/a.kk*a.lk;break;case e.MS_HOVER_CONTROLS:i=fe.get_trans_view(a.v),i=de.distance(i,a.mc),i=i/a.kk*a.lk;break;default:i=o[0].kc}for(var _=0;_<o.length;_++){var s=o[_];s.kc=i,W(s,!1)}x(t,r[n])}}}function k(t){var a=t.o,r=a.hb;if(r===e.MS_TARGET_CONTROLS||r===e.MS_EYE_CONTROLS){if(a.Bb){var n=a.Bb.left,o=a.Bb.right,i=p(t,Ee);(i=r==e.MS_TARGET_CONTROLS?ue.zl(i[0],n,o):ue.zl(i[0],o,n))&&(r==e.MS_TARGET_CONTROLS?G(t,i,0):j(t,i,0))}if(a.Ha&&(n=a.Ha.down,o=a.Ha.up,i=p(t,Ee),(i=r==e.MS_TARGET_CONTROLS?ue.zl(i[1],o,n):ue.zl(i[1],n,o))&&(r==e.MS_TARGET_CONTROLS?G(t,0,i):j(t,0,i))),r===e.MS_TARGET_CONTROLS&&a.vb){var i=t.o,n=fe.get_trans_view(i.v),o=de.subtract(n,i.pivot,Te),_=de.length(o);_>i.vb.max?(de.scale(o,i.vb.max/_,o),de.add(i.pivot,o,n)):_<i.vb.min&&(_=fe.get_quat_view(i.v),_=ue.quat_to_dir(_,ue.AXIS_MZ,ye),de.scale(_,100*i.vb.min,_),de.add(o,_,o),de.scale(o,-i.vb.min/de.length(o),o),de.add(i.pivot,o,n))}}r===e.MS_TARGET_CONTROLS&&a.rd&&(a=t.o,i=a.pivot[2],(n=ue.clamp(a.pivot[2],a.rd.min_z,a.rd.max_z))!=i&&(i=de.set(0,0,n-i,Te),de.add(a.pivot,i,a.pivot),a=fe.get_trans_view(a.v),de.add(a,i,a))),r===e.MS_HOVER_CONTROLS&&(r=t.o,r.Lc&&(i=ue.clamp(r.mc[0],r.Lc.min,r.Lc.max)-r.mc[0],r.mc[0]+=i,a=fe.get_trans_view(r.v),a[0]+=i),r.Mc&&(i=ue.clamp(r.mc[1],r.Mc.min,r.Mc.max)-r.mc[1],r.mc[1]+=i,a=fe.get_trans_view(r.v),a[1]+=i),r=t.o,a=p(t,Ee)[1],(r=ue.zl(a,r.Ha.up,r.Ha.down))&&H(t,0,r))}function P(e,t,a,r){return e=p(e,xe),r[0]=t-e[0],r[1]=a-e[1],r}function G(e,t,a){var r=e.o;q(e,e.o.pivot,t,a),e=p(e,Ae),e=ue.angle_wrap_periodic(e[1],-Math.PI,Math.PI),r.si=Math.abs(e)>Math.PI/2}function F(e,t,a){t=P(e,t,a,Ae),G(e,t[0],t[1])}function j(e,t,a){var r=e.o;(t||a)&&(e=_e.identity(Oe),t&&(t=_e.setAxisAngle(r.Zd,t,we),_e.multiply(e,t,e)),t=fe.get_quat_view(r.v),a&&(r=ue.quat_to_dir(t,ue.AXIS_X,Te),a=_e.setAxisAngle(r,a,we),_e.normalize(a,a),_e.multiply(e,a,e)),_e.multiply(e,t,t),_e.normalize(t,t))}function B(e,t,a){var r=fe.mb(e.o.v,Oe),r=m(r,Ee);j(e,t-r[0],a-r[1])}function H(e,t,a){var r=e.o;r.tg||(t=0),q(e,r.mc,t,a),a&&z(e)}function X(e,t,a){t=P(e,t,a,Ae),H(e,t[0],t[1])}function q(e,t,a,r){var n=e.o;if(a||r){if(e=_e.identity(Oe),a&&(a=_e.setAxisAngle(ue.AXIS_Z,a,we),_e.multiply(e,a,e)),a=fe.get_quat_view(n.v),r){var o=ue.quat_to_dir(a,ue.AXIS_X,Te);r=_e.setAxisAngle(o,r,we),_e.normalize(r,r),_e.multiply(e,r,e)}r=fe.get_trans_view(n.v),ue.MS(r,t,e,r),_e.multiply(e,a,a),_e.normalize(a,a)}}function z(e){var t=e.o,a=p(e,Ee)[1],r=e.o;e=r.Ha,r=r.vb,e.down-e.up?(a=(e.down-a)/(e.down-e.up),a=Math.max(a,0)):a=0,a=a*(r.max-r.min)+r.min,e=fe.get_trans_view(t.v),r=fe.get_quat_view(t.v),r=ue.quat_to_dir(r,ue.AXIS_MZ,Te),de.normalize(r,r),de.scale(r,a,r),de.subtract(t.mc,r,e)}function W(t,a){switch(t.type){case e.Gc:case e.Se:re.perspective(g(t),t.jb,t.near,t.far,t.pb);break;case e.ce:case e.Vg:var r=g(t),n=r*t.jb;re.ortho(-n,n,-r,r,t.near,t.far,t.pb);break;case e.Ai:re.ortho(t.left,t.right,t.bottom,t.top,t.near,t.far,t.pb);break;case e.tc:case e.Bc:var n=Math.tan(g(t)/2),r=t.near*n,o=t.jb*t.Qk*n;t.type==e.tc?(n=o-t.qf/2,o+=t.qf/2):(n=o+t.qf/2,o-=t.qf/2),n=-t.near/t.Qk*n,o*=t.near/t.Qk,re.frustum(n,o,-r,r,t.near,t.far,t.pb),t.left=n,t.right=o;break;case e.Re:case e.xe:se.Fa()&&(r=se.get_active(),(r=se.Ib(r,ce.jg))&&r.enable_hmd_stereo?(r=Math.tan(t.bd[1]),n=Math.tan(t.bd[2]),o=Math.tan(t.bd[3]),t.top=t.near*Math.tan(t.bd[0]),t.right=t.near*r,t.bottom=-t.near*n,t.left=-t.near*o,re.frustum(t.left,t.right,t.bottom,t.top,t.near,t.far,t.pb)):(t.top=t.near*Math.tan(g(t)/2),t.bottom=-t.top,t.right=t.top*t.jb,t.left=-t.right,re.perspective(g(t),t.jb,t.near,t.far,t.pb)));break;case e.rc:return;default:ue.F("Wrong camera type: "+t.type)}a||(V(t),Y(t))}function Y(e){re.copy(e.Mb,e.Kg),e.Kg[12]=0,e.Kg[13]=0,e.Kg[14]=0,e.Kg[15]=1,re.multiply(e.pb,e.Kg,e.Kg),re.invert(e.Kg,e.Kg)}function V(e){re.copy(e.Mb,e.gd),re.multiply(e.pb,e.gd,e.gd),re.invert(e.gd,e.Zw)}function J(t,a,r,n,o){n||(n=new Float32Array(24)),a||(a=t.near),r||(r=t.far);var i,_,s,c,l,f,u,d;switch(t.type){case e.rc:ue.F("Extraction from NONE camera is not possible");break;case e.Gc:case e.Se:i=a*Math.tan(g(t)/2),c=-i,_=i*t.jb,s=-_,l=r/a*i,d=-l,f=l*t.jb,u=-f;break;case e.ce:case e.Vg:c=g(t),s=c*t.jb,i=l=c,_=f=s,c=d=-c,s=u=-s;break;case e.Ai:i=l=t.top,_=f=t.right,c=d=t.bottom,s=u=t.left;break;case e.tc:case e.Bc:l=a/t.near,i=a*Math.tan(g(t)/2),c=-i,_=t.right*l,s=t.left*l,u=r/a,l=i*u,d=-l,f=_*u,u*=s;break;case e.Re:case e.xe:l=a/t.near,i=t.top*l,c=t.bottom*l,_=t.right*l,s=t.left*l,u=r/a,l=i*u,d=c*u,f=_*u,u*=s;break;default:ue.F("Wrong camera type: "+t.type)}return n[0]=s,n[1]=c,n[2]=-a,n[3]=_,n[4]=c,n[5]=-a,n[6]=_,n[7]=i,n[8]=-a,n[9]=s,n[10]=i,n[11]=-a,n[12]=u,n[13]=d,n[14]=-r,n[15]=u,n[16]=l,n[17]=-r,n[18]=f,n[19]=l,n[20]=-r,n[21]=f,n[22]=d,n[23]=-r,o&&(a=Ne,re.invert(t.Mb,a),ue.wo(n,a,n,0)),n}function K(e,t){if(t.enable_csm){var a=t.csm_num;if(!e.Th){var r=t.csm_num;e.Th=Array(r);for(var n=0;n<r;n++)e.Th[n]=new Float32Array(3);e.qq=new Float32Array(r)}for(r=0;r<a;r++){var n=r?Q(t,e,r-1):e.near,o=Q(t,e,r),n=J(e,n,o,Ie),n=te.MP(n);e.Th[r].set(n.N),e.qq[r]=n.ab,e.Gt[r]=de.length(n.N),e.uo[r]=Z(t.first_cascade_blur_radius,t.last_cascade_blur_radius,a,r)}}else e.uo[0]=t.first_cascade_blur_radius}function Q(e,t,a){var r=e.csm_num,n=ue.clamp(e.csm_first_cascade_border,t.near,t.far);return e=ue.clamp(e.csm_last_cascade_border,t.near,t.far),ue.clamp(Z(n,e,r,a),t.near,t.far)}function Z(e,t,a,r){switch(r){case 0:break;case a-1:e=t;break;default:e=0==e?0:e*Math.pow(t/e,r/(a-1))}return e}function $(t){switch(t.type){case e.ce:case e.Vg:case e.Ai:return!0;default:return!1}}function ee(e,t){t||(t=new Float32Array(3));var a=fe.get_trans_view(e.o.v);return de.copy(a,t),t}var te=t("__boundings"),ae=t("__container"),re=t("__mat4"),ne=t("__math"),oe=t("__obj_util"),ie=t("__print"),_e=t("__quat"),se=t("__scenes"),ce=t("__subscene"),le=t("__transform"),fe=t("__tsr"),ue=t("__util"),de=t("__vec3"),pe=t("__vec4");e.rc=10,e.Gc=20,e.ce=30,e.Se=40,e.Vg=50,e.Ai=60,e.tc=70,e.Bc=80,e.Re=90,e.xe=100,e.MS_STATIC=0,e.MS_TARGET_CONTROLS=2,e.MS_EYE_CONTROLS=3,e.MS_HOVER_CONTROLS=4;var me=ue.deg_to_rad(40),ge=ue.deg_to_rad(.5),he=new Float32Array([1,1,1,1]),ve=new Float32Array([-1,-1,1,1]),be=new Float32Array([0,0,-1,1]),Ee=new Float32Array(2),Ae=new Float32Array(2),xe=new Float32Array(2),Te=new Float32Array(3),ye=new Float32Array(3),Se=new Float32Array(3),Oe=new Float32Array(4),we=new Float32Array(4),Re=new Float32Array(4),Le=new Float32Array(4),Ne=new Float32Array(16),Ie=new Float32Array(24),Me=c(),Ce=new Float32Array(6);e.iM=function(t,_){var c=_.o,l=t.data;switch(l.type){case"PERSP":var d=u(e.Gc);d.Gn=l.sensor_fit,h(d,l.angle,l.clip_start,l.clip_end);break;case"ORTHO":d=u(e.ce),d.Gn=l.sensor_fit,h(d,l.ortho_scale/2,l.clip_start,l.clip_end)}d.name=_.name;var p=_.K;p[0].ba.push(d);for(var m=1;m<p.length;m++){var g=s(d,!1);p[m].ba.push(g)}c.hb=f(l.b4w_move_style),c.dof_distance=l.dof_distance,d=l.dof_object,c.dof_object=d?d.Xa:null,c.dof_front_start=l.b4w_dof_front_start,c.dof_front_end=l.b4w_dof_front_end,c.dof_rear_start=l.b4w_dof_rear_start,c.dof_rear_end=l.b4w_dof_rear_end,c.dof_power=l.b4w_dof_power,c.dof_bokeh=l.b4w_dof_bokeh,c.dof_bokeh_intensity=l.b4w_dof_bokeh_intensity,c.wd=l.b4w_dof_foreground_blur,c.fp=l.b4w_trans_velocity,c.ep=l.b4w_rot_velocity,c.gp=l.b4w_zoom_velocity,d=_.o.hb,p=t.data,m=null,d!=e.MS_TARGET_CONTROLS&&d!=e.MS_EYE_CONTROLS||!p.b4w_use_horizontal_clamping||(m={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},d==e.MS_EYE_CONTROLS&&(m.left*=-1,m.right*=-1)),d=m,p=_.o.hb,m=t.data,g=null,p!=e.MS_TARGET_CONTROLS&&p!=e.MS_EYE_CONTROLS||!m.b4w_use_vertical_clamping?p==e.MS_HOVER_CONTROLS&&m.b4w_use_zooming&&(m.b4w_hover_angle_min<=m.b4w_hover_angle_max?(g={down:m.b4w_hover_angle_min,up:m.b4w_hover_angle_max},g.down*=-1,g.up*=-1):ie.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(g={down:m.b4w_rotation_down_limit,up:m.b4w_rotation_up_limit,camera_space:"LOCAL"==m.b4w_vertical_clamping_type},p==e.MS_TARGET_CONTROLS&&(g.down*=-1,g.up*=-1));var p=g,m=_.o.hb,g=t.data,v=null;m==e.MS_TARGET_CONTROLS&&g.b4w_use_target_distance_limits&&g.b4w_distance_min<=g.b4w_distance_max?v={min:g.b4w_distance_min,max:g.b4w_distance_max}:m===e.MS_HOVER_CONTROLS&&g.b4w_use_zooming&&(g.b4w_distance_min<=g.b4w_distance_max?v={min:g.b4w_distance_min,max:g.b4w_distance_max}:ie.error("Wrong distance limits for the HOVER camera. Disabling distance limits.")),m=v,g=t.data,v=null,_.o.hb==e.MS_HOVER_CONTROLS&&g.b4w_use_horizontal_clamping&&g.b4w_horizontal_translation_min<=g.b4w_horizontal_translation_max&&(v={min:g.b4w_horizontal_translation_min,max:g.b4w_horizontal_translation_max});var g=v,v=t.data,b=null;_.o.hb==e.MS_HOVER_CONTROLS&&v.b4w_use_vertical_clamping&&v.b4w_vertical_translation_min<=v.b4w_vertical_translation_max&&(b={min:v.b4w_vertical_translation_min,max:v.b4w_vertical_translation_max});var v=b,b=t.data,E=null;switch(_.o.hb==e.MS_TARGET_CONTROLS&&b.b4w_use_pivot_limits&&(E={min_z:b.b4w_pivot_z_min,max_z:b.b4w_pivot_z_max}),b=E,c.hb){case e.MS_EYE_CONTROLS:c=fe.get_trans_view(_.o.v),a(_,c,null,d,p);break;case e.MS_TARGET_CONTROLS:c=fe.get_trans_view(_.o.v),r(_,c,l.b4w_target,d,p,m,b,l.b4w_use_panning);break;case e.MS_HOVER_CONTROLS:c=fe.get_trans_view(_.o.v),d=o(_,t.data.b4w_hover_zero_level,ye),n(_,c,d,m,p,g,v,l.b4w_enable_hover_hor_rotation)}k(_),i(_)},e.jH=a,e.lH=r,e.kH=n,e.Wn=i,e.Cc=s,e.fN=c,e.kY=f,e.Yc=u,e.PW=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return!!e.$b;case"DEPTH":return!!e.bf;case"SCREEN":return!e.$b&&!e.bf;default:ue.F("Wrong attachment type: "+t)}},e.$v=function(e,t,a){switch(t){case"COLOR":case"CUBEMAP":e.$b=a;break;case"DEPTH":e.bf=a;break;case"SCREEN":e.$b=null,e.bf=null;break;default:ue.F("Wrong attachment type: "+t)}},e.wX=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return e.$b;case"DEPTH":return e.bf;case"SCREEN":return null;default:ue.F("Wrong attachment type: "+t)}},e.kv=function(t,a){(t.type!=e.Gc||a!=e.tc&&a!=e.Bc&&a!=e.Re&&a!=e.xe)&&ue.F("make_stereo(): wrong camera type"),t.type=a,d(t,6,.065)},e.xT=d,e.get_camera_angles=p,e.Oy=m,e.get_camera_angles_char=function(e,t){return p(e,t),t[0]=ue.angle_wrap_0_2pi(t[0]+Math.PI),t[1]*=-1,t},e.set_fov=function(t,a){switch(t.type){case e.Gc:case e.Se:case e.tc:case e.Bc:t.kc=a}},e.get_fov=function(t){switch(t.type){case e.Gc:case e.Se:case e.tc:case e.Bc:return t.kc;default:return 0}},e.bQ=g,e.ZG=h,e.$G=function(t,a,r,n,o){switch(t.type){case e.Gc:case e.tc:case e.Bc:case e.ce:t.kc=r,t.jb=1;break;case e.Se:case e.Vg:t.kc=r,t.jb=a/r;break;case e.Re:case e.xe:break;default:ue.F("set_frustum2(): Unsupported camera type: "+t.type)}t.near=n,t.far=o},e.jT=function(t,a,r,n,o,i,_){switch(t.type){case e.Ai:t.left=a,t.right=r,t.bottom=n,t.top=o,t.near=i,t.far=_;break;default:ue.F("set_frustum_asymmetric(): Unsupported camera type: "+t.type)}},e.get_move_style=function(e){return e.o.hb},e.CT=v,e.DY=b,e.IA=function(e,t,a){var r=Te;r[0]=0,r[1]=0,r[2]=-1,de.transformQuat(r,a,r),r[0]+=t[0],r[1]+=t[1],r[2]+=t[2];var n=ye;n[0]=0,n[1]=1,n[2]=0,de.transformQuat(n,a,n),b(e,t,r,n)},e.dH=E,e.pT=A,e.DU=x,e.CU=function(t){var a=t.o;switch(k(t),U(t),a.hb){case e.MS_TARGET_CONTROLS:var r=fe.get_trans_view(a.v),n=fe.get_quat_view(a.v);for(ue.Tv(r,n,a.pivot,ue.AXIS_MZ),n=0;n<t.K.length;n++)for(var o=t.K[n].ba,i=0;i<o.length;i++){var _=o[i];_.type!=e.tc&&_.type!=e.Bc||d(_,de.dist(r,a.pivot),_.qf)}T(t,a.Zd);break;case e.MS_EYE_CONTROLS:t.ic||T(t,a.Zd)}y(t)},e.correct_up=T,e.cI=y,e.aw=O,e.cw=w,e.hover_set_vertical_limits=R,e.hover_set_distance_limits=N,e.UG=I,e.fH=M,e.bH=C,e.hH=D,e.QU=U,e.uY=G,e.CY=F,e.rY=function(e,t,a){j(e,t,a)},e.AY=function(e,t,a){B(e,t,a)},e.tY=j,e.BY=B,e.sY=H,e.wT=X,e.LS=function(t,a,r){var n=t.o.hb;n===e.MS_TARGET_CONTROLS?G(t,a,r):n===e.MS_EYE_CONTROLS?j(t,a,r):n===e.MS_HOVER_CONTROLS?H(t,a,r):n===e.MS_STATIC&&j(t,a,r)},e.vT=function(t,a){var r=t.o.hb;r===e.MS_TARGET_CONTROLS?F(t,a,a):r===e.MS_EYE_CONTROLS?B(t,a,a):r===e.MS_HOVER_CONTROLS?X(t,a,a):r===e.MS_STATIC&&B(t,a,a)},e.aY=function(t){switch(t.type){case e.Gc:case e.ce:case e.tc:case e.Bc:return!0;default:return!1}},e.qP=function(t){switch(t.type){case e.Gc:case e.Se:case e.tc:case e.Bc:var a;e:{switch(t.Gn){case"AUTO":a=1<t.jb?t.kc:$(t)?t.kc*t.jb:2*Math.atan(Math.tan(t.kc/2)*t.jb);break e;case"HORIZONTAL":a=t.kc;break e;case"VERTICAL":a=$(t)?t.kc*t.jb:2*Math.atan(Math.tan(t.kc/2)*t.jb);break e}a=void 0}return Math.min(g(t),a);default:return ie.error("get_angular_diameter(): Unsupported camera type: "+t.type),0}},e.ZS=function(t,a){switch(t.type){case e.Se:case e.Vg:ie.error("set_aspect(): Unsupported camera type: "+t.type);break;default:t.jb=a}},e.vX=function(e){return e.jb},e.set_projection=W,e.aT=function(t,a,r,n,o){var i=1/Math.max(o,n);switch(t.type){case e.rc:case e.Gc:case e.Se:o/=2,n/=2,r=-(r-o)/o*Math.tan(g(t)/2),a=(a-n)/n*Math.tan(g(t)/2)*t.jb,n=t.near*(r+i),o=t.near*(a+i),r=t.near*(r-i),a=t.near*(a-i),re.frustum(a,o,r,n,t.near,t.far,t.pb);break;case e.ce:case e.Vg:r=-r/o,a/=n,n=g(t),o=n*t.jb,re.ortho((a-i)*(o+o)-o,(a+i)*(o+o)-o,n+(r-i)*(n+n),n+(r+i)*(n+n),t.near,t.far,t.pb);break;case e.Ai:r=-r/o,a/=n,n=t.top+(r+i)*(t.top-t.bottom),o=t.left+(a+i)*(t.right-t.left),r=t.top+(r-i)*(t.top-t.bottom),a=t.left+(a-i)*(t.right-t.left),re.ortho(a,o,r,n,t.near,t.far,t.pb)}re.copy(t.Mb,t.gd),re.multiply(t.pb,t.gd,t.gd),ue.Ol(t.gd,t.ih)},e.Yx=Y,e.bD=V,e.GO=J,e.DL=function(e){e=e.o;var t=te.Be();t.min_x=-1,t.max_x=1,t.min_y=-1,t.max_y=1,t.min_z=-1,t.max_z=1,e.la=t;var a=te.XC(1,ue.f32([0,0,0]));e.hc=a,e.Hp=te.KC(1,t),e.Jp=te.MC(1,t),e.Ip=te.LC(1,t)},e.is_static_camera=function(t){return oe.is_camera(t)&&t.o&&t.o.hb==e.MS_STATIC},e.is_target_camera=function(t){return oe.is_camera(t)&&t.o&&t.o.hb==e.MS_TARGET_CONTROLS},e.is_eye_camera=function(t){return oe.is_camera(t)&&t.o&&t.o.hb==e.MS_EYE_CONTROLS},e.is_hover_camera=function(t){return oe.is_camera(t)&&t.o&&t.o.hb==e.MS_HOVER_CONTROLS},e.is_ortho_camera=function(t){return oe.is_camera(t)&&t.o&&t.K[0].ba[0].type==e.ce},e.sB=K,e.aO=Q,e.project_point=function(t,a,r){switch(t=t.K[0].ba[0],t.type){case e.Gc:case e.Se:case e.ce:case e.Vg:case e.tc:case e.Bc:case e.Re:case e.xe:case e.rc:var n=Re;return n.set(a),n[3]=1,pe.transformMat4(n,t.gd,n),a=-n[1]/n[3],r[0]=(n[0]/n[3]+1)/2*t.width,r[1]=(a+1)/2*t.height,ae.sV(r[0],r[1],r,t),2<r.length&&(r[2]=(n[2]/Math.abs(n[3])+1)/2),r;default:return ie.error("Non-compatible camera"),r}},e.GP=function(e){return e.K[0].ba[0]},e.nu=function(t,a){switch(t.type){case e.Gc:case e.Se:case e.tc:case e.Bc:var r=Math.tan(g(t)/2);switch(a){case"LEFT":return-r*t.jb;case"RIGHT":return r*t.jb;case"TOP":return r;case"BOTTOM":return-r}break;case e.ce:case e.Vg:switch(a){case"LEFT":return-g(t)*t.jb;case"RIGHT":return g(t)*t.jb;case"TOP":return g(t);case"BOTTOM":return-g(t)}break;case e.Ai:switch(a){case"LEFT":return t.left;case"RIGHT":return t.right;case"TOP":return t.top;case"BOTTOM":return t.bottom}break;case e.Re:case e.xe:if(r=se.get_active(),(r=se.Ib(r,ce.jg))&&r.enable_hmd_stereo)switch(a){case"LEFT":return-Math.tan(Math.min(t.bd[1],t.bd[3]));case"RIGHT":return Math.tan(Math.min(t.bd[1],t.bd[3]));case"TOP":return Math.tan(Math.min(t.bd[0],t.bd[2]));case"BOTTOM":return-Math.tan(Math.min(t.bd[0],t.bd[2]))}else switch(r=Math.tan(g(t)/2),a){case"LEFT":return-r*t.jb;case"RIGHT":return r*t.jb;case"TOP":return r;case"BOTTOM":return-r}break;default:ue.F("Unknown camera type")}},e.JQ=$,e.HA=function(e,t,a){e=e.o,fe.set_trans(t,e.v),de.copy(a,e.pivot)},e.cH=function(e,t){var a=e.o,r=de.subtract(t,a.mc,Te),n=fe.get_trans_view(a.v),r=de.add(r,n,r);le.set_translation(e,r),de.copy(t,a.mc)},e.yT=function(e,t){var a=e.o,r=de.subtract(t,a.pivot,Te),n=fe.get_trans_view(a.v),r=de.add(r,n,r);le.set_translation(e,r),de.copy(t,a.pivot)},e.AX=ee,e.zY=function(t,a){switch(t.o.hb=a,t.o.Bb=null,t.o.Ha=null,t.o.vb=null,t.o.Lc=null,t.o.Mc=null,i(t),a){case e.MS_HOVER_CONTROLS:var r=fe.get_trans_view(t.o.v),_=o(t,0,ye);n(t,r,_,null,null,null,null,t.o.tg);break;case e.MS_TARGET_CONTROLS:r=ee(t,Te),_=fe.get_quat_view(t.o.v),_=ue.quat_to_dir(_,ue.AXIS_MZ,ye),_=de.scaleAndAdd(r,_,10,_),de.copy(_,t.o.pivot)}},e.ts=function(e){e=e.o,e.hb=0,de.set(0,0,0,e.pivot),de.set(0,0,0,e.mc),e.si=!1,e.use_panning=!1,e.Bb=null,e.Ha=null,e.vb=null,e.Lc=null,e.Mc=null,e.rd=null,e.tg=!0},e.set_eye_distance=function(e,t){for(var a=0;a<e.length;a++){var r=e[a];70!=r.type&&80!=r.type&&90!=r.type&&100!=r.type||d(r,r.Qk,t)}},e.set_hmd_fov=function(e,t,a){var r=se.get_active();for(e=oe.ya(e,r).ba,r=0;r<e.length;r++){var n=e[r];90!=n.type&&100!=n.type||(90==n.type&&pe.copy(t,n.bd),100==n.type&&pe.copy(a,n.bd),n.nc||W(n,!1),V(n),Y(n))}},e.yY=function(e,t,a){var r=se.get_active();for(e=oe.ya(e,r).ba,r=0;r<e.length;r++){var n=e[r];90!=n.type&&100!=n.type||(90==n.type&&t&&re.copy(t,n.pb),100==n.type&&a&&re.copy(a,n.pb),V(n),Y(n))}},e.sT=function(t,a){for(var r,n,o,i,_,s,c,f,u=se.get_active(),u=oe.ya(t,u).ba,d=0;d<u.length;d++){var p=u[d];if(p.type==e.rc&&p.near||p.type==e.Gc||p.type==e.Se){r=p.near,n=re.invert(a,Ne),i=pe.transformMat4(he,n,Re),o=i[0]*r,i=i[1]*r,s=pe.transformMat4(ve,n,Re),_=s[0]*r,s=s[1]*r,n=pe.transformMat4(be,n,Re),n=-n[2]*n[3],c=re.frustum(_,o,s,i,r,n,Ne),ue.Ol(c,Me),f=(o-_)/(i-s);break}}for(d=0;d<u.length;d++)p=u[d],(p.type==e.rc||p.type==e.Gc||p.type==e.Se)&&(p.far=n,p.near=r,p.right=o,p.top=i,p.left=_,p.bottom=s,p.jb=f,p.kc=Math.atan(i/r)-Math.atan(s/r),re.copy(c,p.pb),l(Me,p.ih),V(p),Y(p))}},a.module.__lights=function(e,t){function a(e){o.scale(e.color,e.Mf,e.iq)}var r=t("__tsr"),n=t("__util"),o=t("__vec3"),i=new Float32Array(3);e.PQ=function(e,t){var _=e.data,s=t.wb={name:"",type:_.type,uG:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),iq:new Float32Array(3),UD:0,wB:!1,Cm:0,Sr:0,$p:.1,Zp:30,wE:!1,ZF:!1,bE:!1,Im:!0,Mm:!0,Mf:1,distance:25,kX:"INVERSE_SQUARE"};s.name=t.name,s.Im=_.use_diffuse,s.Mm=_.use_specular;var c=r.get_quat_view(t.o.v),c=n.quat_to_dir(c,n.AXIS_Z,i);o.normalize(c,c),s.direction.set(c),s.color[0]=_.color[0],s.color[1]=_.color[1],s.color[2]=_.color[2],s.Mf=s.UD=_.energy,a(s),s.distance=_.distance,s.wB=_.use_sphere,s.$p=_.clip_start,s.Zp=_.clip_end,"POINT"!==s.type&&"SPOT"!==s.type||(s.distance=_.distance),"SPOT"===s.type?(s.Sr=_.spot_blend,s.Cm=_.spot_size):"POINT"===s.type&&(s.Cm=Math.PI/2),s.wE=_.b4w_generate_shadows,s.bE=_.b4w_dynamic_intensity},e.set_light_color=function(e,t){e.color[0]=t[0],e.color[1]=t[1],e.color[2]=t[2],a(e)},e.nT=function(e,t){e.Sr=t},e.mT=function(e,t){e.distance=t},e.oT=function(e,t){e.Cm=t},e.set_light_energy=function(e,t){e.Mf=t,a(e)},e.IU=function(e){var t=e.wb;if(t){if(e=r.get_quat_view(e.o.v),n.quat_to_dir(e,n.AXIS_Z,t.direction),o.normalize(t.direction,t.direction),"SUN"==t.type){e=Math.acos(o.dot(t.uG,n.Bx));var a=Math.acos(o.dot(t.direction,n.Bx));t.ZF=Math.floor(e/.025)!=Math.floor(a/.025)}o.copy(t.direction,t.uG)}}},a.module.__scenes=function(e,t){function a(){return et||(et=r(at)),et}function r(e){for(var t=0;t<e.length;t++){var a=e[t];if(!a.lg||!a.lg.length)return a}return null}function n(){return tt||je.F("No active scene available"),tt}function o(e,t,a){if(!i(e,t,a))return null;a=e.b4w_shadow_settings;var r={};for(a.csm_resolution>We.Qb?(r.csm_resolution=We.Qb,Ie.error("Shadow map texture has unsupported size. Changed to "+We.Qb+".")):r.csm_resolution=a.csm_resolution,ze.shadow_blur_samples=ze.shadow_blur_samples?ze.shadow_blur_samples:a.blur_samples,r.NT=a.soft_shadows,e=we.wu(t,ze.ssao&&e.b4w_enable_ssao),r.self_shadow_polygon_offset=a.self_shadow_polygon_offset,r.self_shadow_normal_offset=a.self_shadow_normal_offset,r.enable_csm=a.b4w_enable_csm&&1==e.length,a.b4w_enable_csm&&1<a.csm_num&&1<e.length&&Ie.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps."),r.lh=[],r.zH=[],r.$p=[],r.Zp=[],t=0;t<e.length;t++)r.lh.push(e[t].wb.type),r.zH.push(e[t].wb.Cm),r.$p.push(e[t].wb.$p),r.Zp.push(e[t].wb.Zp),"SPOT"!=r.lh[t]&&"POINT"!=r.lh[t]||!r.enable_csm||(Ie.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),r.enable_csm=!1);return r.enable_csm?(r.csm_num=a.csm_num,r.csm_first_cascade_border=a.csm_first_cascade_border,r.first_cascade_blur_radius=a.first_cascade_blur_radius,r.csm_last_cascade_border=a.csm_last_cascade_border,r.last_cascade_blur_radius=a.last_cascade_blur_radius,r.fade_last_cascade=a.fade_last_cascade,r.blend_between_cascades=a.blend_between_cascades):(r.csm_num=1,r.csm_first_cascade_border=a.csm_first_cascade_border,r.first_cascade_blur_radius=a.first_cascade_blur_radius,r.csm_last_cascade_border=a.csm_last_cascade_border,r.last_cascade_blur_radius=a.last_cascade_blur_radius,r.fade_last_cascade=!1,r.blend_between_cascades=!1),r}function i(e,t,a){if(0==t.length||!ze.shadows)return!1;switch(e.b4w_render_shadows){case"OFF":return!1;case"ON":return!0}var r=!1,n=!1;if(e=ze.ssao&&e.b4w_enable_ssao,0==t.length&&!e)return!1;for(t=0;t<a.length;t++){var o=a[t];if(o.b4w_shadow_cast&&(r=!0),o.b4w_shadow_receive&&(n=!0),(e||r)&&n)return!0}return!1}function _(e){for(var t=0;t<e.length;t++)if("SUN"==e[t].wb.type)return!0;return!1}function s(e){if(!ze.shore_smoothing)return!1;e=J(e);for(var t=0;t<e.length;t++){var a=e[t];if(a.b4w_water&&a.b4w_water_shore_smoothing)return!0}return!1}function c(e){for(var t=0;t<e.length;t++)for(var a=e[t].particle_systems,r=0;r<a.length;r++)if(we.jD(e[t],a[r].settings))return!0;return!1}function l(e){for(var t=J(e),a=[],r=0;r<t.length;r++){var n=t[r];if(n.b4w_water){for(var o={},i=0;i<e.length;i++)for(var _=e[i],s=_.data.materials,c=0;c<s.length;c++)s[c]==n&&(o.vi=_.location[2]);for(o.Sd=n.b4w_water_fog_color.slice(0),o.Sd.push(n.b4w_water_fog_density),n.b4w_water_dynamic?(o.Aq=!0,o.waves_height=n.b4w_waves_height,o.waves_length=n.b4w_waves_length,o.dst_noise_scale0=n.b4w_water_dst_noise_scale0,o.dst_noise_scale1=n.b4w_water_dst_noise_scale1,o.dst_noise_freq0=n.b4w_water_dst_noise_freq0,o.dst_noise_freq1=n.b4w_water_dst_noise_freq1,o.dir_min_shore_fac=n.b4w_water_dir_min_shore_fac,o.dir_freq=n.b4w_water_dir_freq,o.dir_noise_scale=n.b4w_water_dir_noise_scale,o.dir_noise_freq=n.b4w_water_dir_noise_freq,o.dir_min_noise_fac=n.b4w_water_dir_min_noise_fac,o.dst_min_fac=n.b4w_water_dst_min_fac,o.waves_hor_fac=n.b4w_water_waves_hor_fac):(o.Aq=!1,o.waves_height=0,o.waves_length=0),o.Jf=n.b4w_water_enable_caust,o.kM=n.b4w_water_caust_scale,o.jM=n.b4w_water_caust_brightness,o.lM=new Float32Array([.3,.7]),o.Mk=null,n=n.texture_slots,i=0;i<n.length;i++)_=n[i].texture,!0===_.b4w_shore_dist_map&&"FILE"==_.image.source&&(o.Mk=_.image,o.NA=_.image.size[0],o.Gz=_.b4w_max_shore_dist,_=_.b4w_shore_boundings,o.Eo=[(_[0]+_[1])/2,(_[2]+_[3])/2],o.Fo=[_[0]-_[1],_[2]-_[3]]);a.push(o)}}if(0<a.length){if(o=a[0],!o.Aq)for(r=0;r<a.length;r++)a[r].Aq&&(o=a[r]);return o}return null}function f(e){function t(e){if(e){e=e.nodes;for(var r=0;r<e.length;r++){var n=e[r];"GROUP"==n.type&&n.node_group&&t(n.node_group.node_tree),"GROUP"==n.type&&"B4W_REFRACTION"==n.node_tree_name&&(a.refractions=!0),"BSDF_TRANSPARENT"==n.type&&(a.refractions=!0)}}}var a={refractions:!1};e=J(e);for(var r=0;r<e.length;r++){var n=e[r];n.b4w_refractive&&(a.refractions=!0),n.node_tree&&t(n.node_tree)}return a}function u(e,t,a){if(!ze.reflections)return!1;switch(e.b4w_render_reflections){case"OFF":return!1}e=[];for(var r=0,n=!1,o=!1,i=0;i<t.length;i++){var _=t[i];if(_.o.Cd&&"CUBE"==_.o.xh&&r++,_.Cr.length){for(var s=null,c=0;c<e.length;c++)if(e[c]==_){s=c;break}null==s&&e.push(_)}}for(i=0;i<a.length;i++){t=a[i],t.b4w_reflexible&&(n=!0);e:if(t.b4w_reflexible){for(t=t.data.materials,_=0;_<t.length;_++)if("OPAQUE"!=(s=t[_].game_settings.alpha_blend)&&"CLIP"!=s&&"ALPHA_ANTIALIASING"!=s){t=!0;break e}t=!1}else t=void 0;t&&(o=!0)}return{CG:e,dG:r,Ri:[],ry:[],li:[],Mv:[],ez:n,UE:o}}function d(e,t){var a=e.b4w_sky_settings,r={};return r.FG=a.render_sky||a.procedural_skydome,r.procedural_skydome=a.procedural_skydome,r.use_as_environment_lighting=a.use_as_environment_lighting,r.Ok=a.color,r.rayleigh_brightness=a.rayleigh_brightness,r.mie_brightness=a.mie_brightness,r.spot_brightness=a.spot_brightness,r.scatter_strength=a.scatter_strength,r.rayleigh_strength=a.rayleigh_strength,r.mie_strength=a.mie_strength,r.rayleigh_collection_power=a.rayleigh_collection_power,r.mie_collection_power=a.mie_collection_power,r.mie_distribution=a.mie_distribution,r.Yd=a.reflexible,r.Dd=a.reflexible_only,!t&&a.procedural_skydome&&Ie.warn("There is no sun on the scene. Procedural sky will use a default sun position."),r}function p(e){var t={};return e=e.b4w_ssao_settings,t.radius_increase=e.radius_increase,t.nQ=e.hemisphere,t.UL=e.blur_depth,t.blur_discard_value=e.blur_discard_value,t.influence=e.influence,t.dist_factor=e.dist_factor,t.SS=e.samples,t}function m(e){if(!ze.bloom||!e.b4w_enable_bloom)return null;var t={};return e=e.b4w_bloom_settings,t.blur=e.blur,t.edge_lum=e.edge_lum,t.key=e.key,t.adaptive=e.adaptive,t.average_luminance=e.average_luminance,t}function g(e){var t={};return e=e.b4w_motion_blur_settings,t.mb_decay_threshold=e.motion_blur_decay_threshold,t.mb_factor=e.motion_blur_factor,t}function h(e){var t={};return e=e.b4w_color_correction_settings,t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t}function v(e){var t={};return e=e.b4w_god_rays_settings,t.intensity=e.intensity,t.uk=e.max_ray_length,t.Pk=e.steps_per_pass,t}function b(e){var t={};return t.rh=e.b4w_outline_color,t.sm=e.b4w_outline_factor,t}function E(e){var t={};return e=e.b4w_glow_settings,t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t}function A(e,t){var a=e.light_settings,r={};if(r.Nf=a.environment_energy,r.ls=a.use_environment_light,r.Cy=a.environment_color,r.yd=e.horizon_color.slice(0),r.Ld=e.zenith_color.slice(0),r.Km=e.use_sky_paper,r.Jm=e.use_sky_blend,r.Lm=e.use_sky_real,r.lw=null,r.Am=null,r.Wt=null,r.Wd="",t.render_sky&&e.use_nodes&&e.node_tree&&(a=ye.AD(e.node_tree,e.uuid,!1,e.name,"MAIN"),r.Wd=a.id),a=!0,r.ls&&"SKY_TEXTURE"==r.Cy&&(!t.procedural_skydome||!t.use_as_environment_lighting)){for(var n=null,o=0;o<e.texture_slots.length;o++)if(e.texture_slots[o].texture.b4w_use_as_environment_lighting&&!e.texture_slots[o].texture.b4w_use_as_skydome){n=e.texture_slots[o];break}n?r.Wt=n:a=!1}for(o=0;o<e.texture_slots.length;o++)if(e.texture_slots[o].texture.b4w_use_as_skydome){n=e.texture_slots[o],n.texture.image&&(a=!0,r.lw=n,o=Math.min(We.Wf,Ge.Xx(n.texture.image.size[0]/3)),r.Am={PH:o,RC:n.blend_factor,aF:n.horizon_factor,RI:n.zenith_up_factor,QI:n.zenith_down_factor,color:n.color,Aa:n.default_value,invert:n.invert,uI:n.use_rgb_to_intensity,SC:n.blend_type,pI:n.use_map_blend,qI:n.use_map_horizon,sI:n.use_map_zenith_up,rI:n.use_map_zenith_down});break}return r.ls=!!r.ls&&a,r}function x(e){var t=e.fog_settings,a={};return a.iV=t.use_fog,a.intensity=t.intensity,a.depth=t.depth,a.start=t.start,a.height=t.height,a.KO=t.falloff,a.color=t.use_custom_color?t.color.slice(0):e.horizon_color.slice(0),e=a.color,a.Sd=new Float32Array([e[0],e[1],e[2],1/a.depth]),a.ff=new Float32Array([a.intensity,a.depth,a.start,a.height]),a}function T(e,t){if(!ze.Dc)return!1;switch(e.b4w_render_dynamic_grass){case"OFF":return!1;case"ON":return!0}for(var a=!1,r=!1,n=0;n<t.length;n++){for(var o=t[n],i=o.data.materials,_=0;_<i.length;_++)i[_].b4w_terrain&&(a=!0);for(o=o.particle_systems,_=0;_<o.length;_++)i=o[_].settings,"HAIR"==i.type&&i.b4w_dynamic_grass&&(r=!0);if(a&&r)return!0}return!1}function y(e,t){if(Ye.outlining_overview_mode)return!0;if(!ze.enable_selectable)return!1;switch(e.b4w_enable_object_selection){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var a=0;a<t.length;a++)if(t[a].Xa.o.Kk)return!0;return!1}}function S(e,t){if(Ye.outlining_overview_mode)return!0;if(!ze.enable_outlining)return!1;switch(e.b4w_enable_outlining){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var a=0;a<t.length;a++)if(t[a].Xa.o.Oc)return!0;return!1}}function O(e,t){if(!ze.glow_materials)return!1;switch(e.b4w_enable_glow_materials){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var a=0;a<t.length;a++)for(var r=t[a].data.materials,n=0;n<r.length;n++)if(ye.iD(r[n]))return!0;return!1}}function w(e,t){if(!ze.refractions)return!1;switch(e.b4w_render_refractions){case"OFF":return!1;case"ON":return!0;case"AUTO":return t.refractions}}function R(e){for(var t=0;t<e.length;t++)for(var a=e[t].data.materials,r=0;r<a.length;r++){var n=a[r],o=n.game_settings.alpha_blend;if(n.b4w_render_above_all&&"OPAQUE"!=o&&"CLIP"!=o&&"ALPHA_ANTIALIASING"!=o)return!0}return!1}function L(e,t){switch(e.b4w_enable_anchors_visibility){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var a=0;a<t.length;a++){var r=t[a].Xa;if(r.anchor&&r.anchor.yn)return!0}return!1}}function N(e,t){for(var a=ee(e,[Pe.Gb,Pe.Sc,Pe.Md]),r=0;r<a.length;r++)a[r].gt=t}function I(e,t,a,r,n,o){for(var i=t.o,_=we.ya(t,n),s=_.U,c=0;c<s.length;c++){var l=s[c];if(!(l.pe||l.Dd||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type&&"LINE"!=l.type)&&("OPAQUE"==l.sb&&"OPAQUE"==r||"BLEND"==l.sb&&"BLEND"==r||"XRAY"==l.sb&&"XRAY"==r||"NODES_GLOW"==l.type&&"GLOW"==r)){if(!o&&(C(l,e,t,a,r,n),!pe.zc(l))){if("DEBUG"!==Xe.type())continue;pe.Rs(l,"error.glslv","error.glslf"),pe.zc(l)}var f=Pe.di(l,i,_.If[c]);Pe.Ic(e,f),De.Dl(a,e,l),U(l)}}}function M(e){e.tk.ns&&pe.qb(e,"USE_LOD_SMOOTHING",1)}function C(e,t,a,r,n,o){var i=a.o,_=o.G,s=we.ya(a,o),c="NO_SHADOWS";if(a=ee(o,[Pe.ld]),a.length&&e.Gd){switch(n){case"OPAQUE":c="SHADOW_MAPPING_OPAQUE";break;case"BLEND":case"XRAY":c="SHADOW_MAPPING_BLEND";break;case"COLOR_ID":case"REFLECT":case"GLOW":c="NO_SHADOWS";break;case"SHADOW":c="SHADOW_MASK_GENERATION";break;default:je.F("Wrong subscene type")}for(var l=0;l<a.length;l++)pe.EC(e,o.G.Pc)}if(l="NO_SOFT_SHADOWS",_.Pc&&_.Pc.NT)switch(ze.shadow_blur_samples){case"16x":l="POISSON_X_16";break;case"8x":l="POISSON_X_8";break;case"4x":l="POISSON_X_4"}if(a=e.Ra,ke.ka(a,"SHADOW_USAGE",c),ke.ka(a,"POISSON_DISK_NUM",l),M(e),e.Dc&&(l=De.bc(r,Pe.yi))&&k(e,l,i),D(a,t.B),"SHADOW"!=e.type&&"COLOR_ID"!=n||e.nb){if(n=t.oo,ke.ka(a,"NUM_LIGHTS",n),ke.ka(a,"NUM_LFACTORS",n%2?Math.floor(n/2)+1:n/2),ke.ka(a,"REFLECTION_PASS","REFL_PASS_NONE"),ke.ka(a,"SSAO_ONLY",0),(n=_.hd)&&(ke.ka(a,"WATER_EFFECTS",1),ke.ka(a,"WAVES_HEIGHT",ke.R(n.waves_height)),ke.ka(a,"WAVES_LENGTH",ke.R(n.waves_length)),ke.ka(a,"WATER_LEVEL",ke.R(n.vi))),t.Jf&&e.Jf){if(ke.ka(a,"CAUSTICS",1),l=_.Pc){for(i=l.lh,l=c=0;l<i.length;l++)"SUN"==i[l]&&(c=l);ke.ka(a,"SUN_NUM",c)}ke.ka(a,"CAUST_SCALE",ke.R(t.lt)),ke.ka(a,"CAUST_SPEED",ke.R(t.mt,2)),ke.ka(a,"CAUST_BRIGHT",ke.R(t.kt))}if(l=s.Ri,i=s.li,s=De.bc(r,Pe.ae),-1!==e.rf.indexOf("u_mirrormap"))ke.ka(a,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(e.Cd&&l)t=l.B.$b,_.wh.ez||(l.Ql=!0,s&&(t=s.B.$b)),pe.Rj(e,t,"u_cube_reflection"),ke.ka(a,"REFLECTION_TYPE","REFL_CUBE");else if(e.Cd&&i)for(l=0;l<i.length;l++)t=i[l].B.$b,pe.Rj(e,t,"u_plane_reflection"),ke.ka(a,"REFLECTION_TYPE","REFL_PLANE");else ke.ka(a,"REFLECTION_TYPE","REFL_NONE");if(s?e.Qt?(t=s.B.$b,pe.Rj(e,t,"u_sky")):s.procedural_skydome&&(e.$e=s.$e,ke.ka(a,"PROCEDURAL_FOG",1)):ke.ka(a,"PROCEDURAL_FOG",0),t=_.jl,t.ls&&(ke.ka(a,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==t.Cy?(t.Wt?(s=t.Wt.texture,t=Ge.he(t.Wt),pe.Rj(e,t,"u_sky_texture",s.name)):s&&(t=s.B.$b,pe.Rj(e,t,"u_sky_texture")),ke.ka(a,"SKY_TEXTURE",1)):"SKY_COLOR"==t.Cy&&ke.ka(a,"SKY_COLOR",1)),t=_.OI,t.iV&&(ke.ka(a,"USE_FOG",1),ke.ka(a,"FOG_TYPE",t.KO)),e.rj&&e.kb?(ze.Nt&&ke.ka(a,"USE_REFRACTION_CORRECTION",1),"MAIN"==e.type&&e.nb||"NODES_GLOW"==e.type?(ke.ka(a,"REFRACTIVE",1),_.refractions?ke.ka(a,"USE_REFRACTION",1):ke.ka(a,"USE_REFRACTION",0)):_.refractions?ke.ka(a,"REFRACTIVE",1):ke.ka(a,"REFRACTIVE",0),(_.OF.refractions||_.refractions)&&ke.ka(a,"HAS_REFRACT_TEXTURE",1)):(ke.ka(a,"REFRACTIVE",0),ke.ka(a,"USE_REFRACTION",0),ke.ka(a,"USE_REFRACTION_CORRECTION",0)),e.wf&&(ze.shore_smoothing&&e.Um&&De.bc(r,Pe.JB)?ke.ka(a,"SHORE_SMOOTHING",1):ke.ka(a,"SHORE_SMOOTHING",0),e.water_dynamic&&n&&n.waves_height?ke.ka(a,"DYNAMIC",1):ke.ka(a,"DYNAMIC",0)),"PARTICLES"==e.type&&ke.ka(a,"COLOR_RAMP_LENGTH",e.Ba.wt),!e.wg)for(e=e.fa,r=0;r<e.length;r++)if(t=e[r],"SCENE"==t.source)for(_=0;_<at.length;_++)for(a=at[_],s=at[_].lg,n=0;n<s.length;n++)s[n]==t&&Ee.D(rt,a,o,null)}}function D(e,t){t.type==ge.ce||t.type==ge.Vg||t.type==ge.Ai?ke.ka(e,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ke.ka(e,"CAMERA_TYPE","CAM_TYPE_PERSP")}function U(e){8<e.fa.length&&Ie.warn(e.type,"too many textures used - "+e.fa.length+' (max 8), materials "'+e.Pb.join(", ")+'"')}function k(e,t,a){e.ad=t.ad;var r=t.ad[0],n=t.ad[1],o=t.ad[2];a=a.la,a=Math.max(a.max_x-a.min_x,a.max_y-a.min_y),o=0==o?a:Math.max(o,a),t.ad[2]=o,t=t.B,ge.$G(t,o/2,o/2,-n,-r),ge.set_projection(t,!1),r=e.aj||0,r=0==r?a:Math.max(r,a),e.aj=r}function P(e,t,a,r,n,o){for(var i=t.o,_=we.ya(t,n),s=_.U,c=0;c<s.length;c++){var l=s[c];if(("MAIN"==l.type||"PARTICLES"==l.type||"LINE"==l.type)&&"REFLECT"==l.sb&&l.kb==r){if(e.type==Pe.Nd||e.type==Pe.Bf){var f;e:{var u=n.G.wh.li;for(f=0;f<u.length;f++)for(var d=0;d<u[f].length;d++)if(u[f][d]==e)break e;for(u=n.G.wh.Mv,f=0;f<u.length;f++)for(d=0;d<u[f].length;d++)if(u[f][d]==e)break e;f=null}if(f==i.zd)continue}else if((f=de(n,e))==i.Qd)continue;if(!o&&(C(l,e,t,a,"REFLECT",n),f=l.Ra,ke.ka(f,"WATER_EFFECTS",0),e.type==Pe.Nd||e.type==Pe.Bf?ke.ka(f,"REFLECTION_PASS","REFL_PASS_PLANE"):ke.ka(f,"REFLECTION_PASS","REFL_PASS_CUBE"),ke.ka(f,"TEXTURE_NORM",0),!pe.zc(l))){if("DEBUG"!==Xe.type())continue;pe.Rs(l,"error.glslv","error.glslf"),pe.zc(l)}f=Pe.di(l,i,_.If[c]),Pe.Ic(e,f),De.Dl(a,e,l),U(l)}}}function G(e){W(e);var t=te(e,Pe.Gb),a=!0,r=e.G.Pc;Ee.X(e.G.va,function(n,o){o.type===Pe.ld&&(j(o,e,t.B,r,a),a=!1)})}function F(e){Ee.X(e.G.va,function(e,t){t.type===Pe.$m&&(t.yq=1)})}function j(e,t,a,r,n){if(0!=e.Pa.length){var o=e.B;if(Fe.copy(a.v,o.v),Fe.copy(a.vf,o.Lr),"SUN"===r.lh[e.cg]||"HEMI"===r.lh[e.cg]){var i=a.v,_=dt;me.EV(_);for(var s=0;s<e.Pa.length;s++)for(var c=e.Pa[s].Ca,l=0;l<c.length;l++){var f=c[l].ra,u=c[l].Yf;if(f.Dc){var d=Fe.mb(i,st),p=Be.transformQuat(je.AXIS_MZ,d,_t),d=-p[0],p=p[1],m=Fe.Cb(i,_t),d=m[0]-f.aj*(1+d)/2,p=m[1]-f.aj*(1-p)/2,u=me.nn(f.Ta.ee,u.v,pt),u=u.max_z-u.min_z,m=pt;m.min_x=d,m.min_y=p,m.min_z=f.ad[0]-u,m.max_x=d+f.aj,m.max_y=p+f.aj,m.max_z=f.ad[1]+u}else m=u.og;s||l?me.Yt(_,m):me.$g(m,_)}if(i=me.fE(_,ft),je.wo(i,o.Mb,i),r.enable_csm){if(t=Be.copy(a.Th[e.pq],it),r=Te.invert(a.Mb,lt),je.wo(t,r,t),je.wo(t,o.Mb,t),e=a.qq[e.pq],n)for(mt=0,gt=-1/0,n=2;n<i.length;n+=3)mt=Math.min(mt,i[n]),gt=Math.max(gt,i[n]);n=dt,n.max_x=t[0]+e,n.max_y=t[1]+e,n.max_z=gt,n.min_x=t[0]-e,n.min_y=t[1]-e,n.min_z=mt}else{for(a=n=dt,r=ut,r.set(i),i=nt/9,_=Te.identity(lt),Te.rotate(_,i,je.AXIS_MZ,_),c=s=-1,l=0;10>l;l++)f=me.Nx(r,0,r.length,pt),u=(f.max_x-f.min_x)*(f.max_y-f.min_y),(-1==s||.1<s-u)&&(s=u,c=l,me.$g(f,a)),je.wo(r,_,r);a=c*i,0<a&&(r=Te.identity(lt),Te.rotate(r,a,je.AXIS_MZ,r),Te.multiply(r,o.Mb,o.Mb),Fe.from_mat4(o.Mb,o.vf)),a=n.max_x-n.min_x,r=n.max_y-n.min_y,a&&r&&(i=Math.abs(a-r)/2,2<a/r?(n.max_y+=i,n.min_y-=i):2<r/a&&(n.max_x+=i,n.min_x-=i)),n.max_x+=.005,n.max_y+=.005,n.max_z+=.005,n.min_x-=.005,n.min_y-=.005,n.min_z-=.005,B(e,t.G.va)}ge.jT(o,n.min_x,n.max_x,n.min_y,n.max_y,-n.max_z,-n.min_z),ge.set_projection(o,!1),je.Ol(o.gd,o.ih)}else"SPOT"!==r.lh[e.cg]&&"POINT"!==r.lh[e.cg]||ge.set_projection(o,!1)}}function B(e,t){for(var a=e.B,r=De.XP(t,e),n=0;n<r.length;n++){var o=r[n];if(o.type==Pe.Gb||o.type==Pe.Cf||o.type==Pe.Sc||o.type==Pe.ig)if(ze.iv)o.os.set(a.vf,9*e.cg);else{var i=Fe.get_trans_view(a.vf),_=Fe.get_scale(a.vf),s=Fe.get_quat_view(a.vf);He.set(i[0],i[1],i[2],_,ct),o.cp.set(ct,4*e.cg),o.bp.set(s,4*e.cg)}}}function H(e,t,a,r,n){for(var o=t.o,i=we.ya(t,r),_=i.U,s=0;s<_.length;s++){var c=_[s];if("COLOR_ID"==c.type&&(e.type==Pe.we&&"COLOR_ID"==c.sb||e.type==Pe.Rg&&"COLOR_ID_XRAY"==c.sb)){if(!n&&(C(c,e,t,a,"COLOR_ID",r),pe.qb(c,"USE_OUTLINE",0),!pe.zc(c)))continue;c=Pe.di(c,o,i.If[s]),Pe.Ic(e,c)}}}function X(e,t){q(e,t);for(var a=0;a<e.Ze.length;a++)e.Ze[a].parent==e&&X(e.Ze[a],t)}function q(e,t){if(e.o.hide=t,we.is_lamp(e))for(var a=0;a<e.K.length;a++)for(var r=e.K[a],n=ee(r.eb,Ke),o=0;o<n.length;o++){var i=n[o],_=e.o,s=e.wb,c=r.cr,l=s.Im&&!_.hide?1:0;i.im[4*c+3]=l,l=s.Mm&&!_.hide?1:0,i.hm[4*c+3]=l,i.Ea=!0}}function z(e,t){for(var a=ee(t,Ke),r=e.wb,n=e.o,o=we.ya(e,t),i=Fe.get_trans_view(n.v),n=Fe.get_quat_view(n.v),_=0;_<a.length;_++){var s=a[_],c=s,l=e.o,f=e.wb,u=o.cr,d=Fe.get_trans_view(e.o.v),p=f.iq;switch(c.br.set(f.direction,3*u),ct[0]=d[0],ct[1]=d[1],ct[2]=d[2],ct[3]=f.Im&&!l.hide?1:0,c.im.set(ct,4*u),ct[0]=p[0],ct[1]=p[1],ct[2]=p[2],ct[3]=f.Mm&&!l.hide?1:0,c.hm.set(ct,4*u),c.Ea=!0,r.type){case"SUN":s.zw.set(n),s.yw=r.iq,Be.copy(r.direction,s.xw),s.type==Pe.ae&&s.procedural_skydome&&(s.jo=r.ZF,V(t,s));break;case"HEMI":case"POINT":case"SPOT":break;default:Ie.error("Unknown light type: "+r.type+'".')}for(s=s.Pa,c=0;c<s.length;c++)for(l=s[c].Ca,f=0;f<l.length;f++)u=l[f].ra,u.gm&&pe.lT(u,e)}for(a=te(t,Pe.Gb).B,o=o.LA,r=t.G.Pc,_=0;_<o.length;_++)s=o[_],ge.IA(s.B,i,n),j(s,t,a,r,!0),B(s,t.G.va)}function W(e){var t=Se.Hb(e,"LAMP",Se.DATA_ID_ALL),t=we.wu(t,ze.ssao&&e.b4w_enable_ssao);if(t.length)for(var a=0;a<t.length;a++)for(var r=t[a],n=r.o,o=Fe.Cb(n.v,it),n=Fe.mb(n.v,st),i=0;i<r.K.length;i++){var _=r.K[i],s=_.LA;if(_.eb==e)for(_=0;_<s.length;_++)ge.IA(s[_].B,o,n)}}function Y(e){var t=te(e,Pe.ae);t&&V(e,t)}function V(e,t){if(Le.Nv(t),Ce.Cn(t),t.jo)for(var a=ee(e,Qe),r=0;r<a.length;r++)for(var n=a[r].Pa,o=0;o<n.length;o++)for(var i=n[o].Ca,_=0;_<i.length;_++){var s=i[_];s.Vb&&(s=s.ra,pe.oM(s)&&Ce.yU(s))}}function J(e){for(var t=[],a=0;a<e.length;a++)for(var r=e[a].data,n=0;n<r.materials.length;n++){var o=r.materials[n];-1==t.indexOf(o)&&t.push(o)}return t}function K(e,t,r,n){ve.qF()&&(t*=window.devicePixelRatio,r*=window.devicePixelRatio);var o=a();return o&&(o=o.G,t*=o.zo,r*=o.zo),t*=e.wj,r*=e.xj,n[0]=Math.floor(t),n[1]=Math.floor(r),n}function Q(e,t,a){return e=K(e,t,a,ot),e[0]>We.Qb||e[1]>We.Qb?(Ie.warn("Texture size exceeds platform limits, downscaling"),Math.min(We.Qb/e[0],We.Qb/e[0])):1}function Z(e,t,a){for(var r=e.G,n=we.ya(e.Bi,e).ba,o=0!=a?t/a:1,i=0;i<n.length;i++){var _=n[i];ge.ZS(_,o),ge.set_projection(_,!1),r.Pc&&ge.sB(_,r.Pc)}if(r.Pc){for(r.xv=!0,r=ee(e,[Pe.Cf]),i=0;i<r.length;i++)r[i].Ea=!0;for(r=ee(e,[Pe.Sc]),i=0;i<r.length;i++)r[i].Ea=!0}$(e,t,a)}function $(e,t,a){var r=e.G.va,n=1/0;De.Jw(r,function(e){e.Hm&&(n=Math.min(n,Q(e,t,a)))}),De.Jw(r,function(o,i,_,s){if(o.Hm){var c,l;if(s&&s.type==Pe.zi||_.Ob&&!o.Qs?(c=t*o.wj,l=a*o.xj):(l=K(o,t,a,ot),c=l[0]*n,l=l[1]*n),i)for(i=0;i<_.Sa.length;i++)_.Sa[i]==o&&Ge.resize(o.Ma,c,l);else switch(Ge.Zn(o.Ma)&&(Ge.resize(o.Ma,c,l),o.Ma.Qg&&(s.av=o.Ma.VF)),o=_.B,o.width=c,o.height=l,_.type){case Pe.pp:re(e,{dof_power:_.B.dof_power});break;case Pe.qp:oe(e,{small_glow_mask_width:_.small_glow_mask_width,large_glow_mask_width:_.large_glow_mask_width});break;case Pe.lp:ne(e,{blur:_.hn});break;case Pe.eC:o.width=o.$b.width,o.height=o.$b.height;break;case Pe.$m:_=De.Jc(r,_,Pe.Tb),o=De.Jc(r,_,Pe.Tb),l=De.Jc(r,o,Pe.Tb),i=De.Jc(r,l,Pe.Tb),De.Fd(_,1/c,1/c),De.Fd(o,1/c,1/c),De.Fd(l,1/c,1/c),De.Fd(i,1/c,1/c);break;default:De.Fd(_,1/c,1/l)}}})}function ee(e,t){for(var a=[],r=0;r<t.length;r++){var n=t[r];e.G.va&&Ee.X(e.G.va,function(e,t){t.type==n&&a.push(t)})}return a}function te(e,t){return De.bc(e.G.va,t)}function ae(e){var t=a();t&&Ee.X(t.G.va,function(t,a){var r=a.B;r&&r.type==ge.xe&&(a.Ql=e)})}function re(e,t){var a=ee(e,[Pe.pp]);if(!a.length)return Ie.error("DOF is not enabled on the scene. Check camera settings"),0;for(var r=0;r<a.length;r++){var n=a[r],o=t,i=e,_=n.B.dof_bokeh,s=_?ee(i,[Pe.mx]):[],i=i.G.va;if("boolean"==typeof o.dof_on&&(n.B.dof_on=o.dof_on,_))for(var c=0;c<s.length;c++)s[c].B.dof_on=o.dof_on;if("number"==typeof o.dof_distance&&(n.B.dof_distance=o.dof_distance,_))for(c=0;c<s.length;c++)s[c].B.dof_distance=o.dof_distance;if("number"==typeof o.dof_front_start&&(n.B.dof_front_start=o.dof_front_start,_))for(c=0;c<s.length;c++)s[c].B.dof_front_start=o.dof_front_start;if("number"==typeof o.dof_front_end&&(n.B.dof_front_end=o.dof_front_end,_))for(c=0;c<s.length;c++)s[c].B.dof_front_end=o.dof_front_end;if("number"==typeof o.dof_rear_start&&(n.B.dof_rear_start=o.dof_rear_start,_))for(c=0;c<s.length;c++)s[c].B.dof_rear_start=o.dof_rear_start;if("number"==typeof o.dof_rear_end&&(n.B.dof_rear_end=o.dof_rear_end,_))for(c=0;c<s.length;c++)s[c].B.dof_rear_end=o.dof_rear_end;if("number"==typeof o.dof_bokeh_intensity&&(n.B.dof_bokeh_intensity=o.dof_bokeh_intensity,_&&(s=De.su(i,n,Pe.Tb),s[0].B.dof_bokeh_intensity=o.dof_bokeh_intensity,s[1].B.dof_bokeh_intensity=o.dof_bokeh_intensity,s[0]=De.Jc(i,s[0],Pe.Tb),s[0].B.dof_bokeh_intensity=o.dof_bokeh_intensity)),"number"==typeof o.dof_power)if(_){o=o.dof_power,n.B.dof_power=o;var o=o/2,_=n.B.width,c=n.B.height,l=[1/_,0],f=[1/_*.5,1/c*.866],u=[-1/_*.5,1/c*.866],s=De.su(i,n,Pe.Tb);De.dd(s[0],o),De.Fd(s[0],u[0],u[1]),De.dd(s[1],o),De.Fd(s[1],f[0],f[1]),s[0]=De.Jc(i,s[0],Pe.Tb),De.dd(s[0],o),De.Fd(s[0],l[0],l[1]),n.B.wd&&(s[0]=De.Jc(i,s[0],Pe.mx),s[0]=De.Jc(i,s[0],Pe.Tb),De.Fd(s[0],1/_,1/c),s[0]=De.Jc(i,s[0],Pe.Tb),De.Fd(s[0],1/_,1/c))}else n.B.dof_power=o.dof_power,s=De.Jc(i,n,Pe.Tb),i=De.Jc(i,s,Pe.Tb),De.dd(s,n.B.dof_power),De.Fd(s,1/n.B.width,1/n.B.height),De.dd(i,n.B.dof_power),De.Fd(i,1/n.B.width,1/n.B.height)}}function ne(e,t){var a=ee(e,[Pe.ys]),r=ee(e,[Pe.lp]);if(!a.length||!r.length)return Ie.error("Bloom is not enabled on the scene"),0;if("number"==typeof t.key)for(var n=0;n<a.length;n++)a[n].ln=t.key,a[n].Ea=!0;if("number"==typeof t.edge_lum)for(n=0;n<a.length;n++)a[n].kn=t.edge_lum,a[n].Ea=!0;if("number"==typeof t.blur)for(n=0;n<r.length;n++){r[n].hn=t.blur;for(var o=e.G.va,i=r[n].B.width/.5,_=r[n].B.height/.5,s=De.su(o,r[n],Pe.Tb),c=0;c<s.length;++c){var l=s[c],f=De.Jc(o,l,Pe.Tb),u=i*l.jn,d=_*l.jn;De.dd(l,t.blur),De.Fd(l,1/u,1/d),De.dd(f,t.blur),De.Fd(f,1/u,1/d)}}if("number"==typeof t.average_luminance)for(n=0;n<a.length;n++)a[n].ol||(a[n].average_luminance=t.average_luminance,a[n].Ea=!0)}function oe(e,t){var a=ee(e,[Pe.qp]);if(!a.length)return Ie.error("Glow is not enabled on the scene"),null;for(var r=0;r<a.length;r++){for(var n=a[r],o=t,i=e.G.va,_=De.RP(i,n),s=0;s<_.length;++s){var c=_[s];if(c.type==Pe.Tb&&"GLOW_MASK_LARGE"==c.sb)var l=c;if(c.type==Pe.Tb&&"GLOW_MASK_SMALL"==c.sb)var f=c}_=De.Jc(i,l,Pe.Tb),i=De.Jc(i,f,Pe.Tb),"number"==typeof o.small_glow_mask_coeff&&(n.small_glow_mask_coeff=o.small_glow_mask_coeff,n.Ea=!0),"number"==typeof o.large_glow_mask_coeff&&(n.large_glow_mask_coeff=o.large_glow_mask_coeff,n.Ea=!0),"number"==typeof o.small_glow_mask_width&&(n.small_glow_mask_width=o.small_glow_mask_width,De.dd(f,o.small_glow_mask_width),De.Fd(f,1/n.B.width,1/n.B.height),f.Ea=!0,De.dd(i,o.small_glow_mask_width),De.Fd(i,1/n.B.width,1/n.B.height),i.Ea=!0),"number"==typeof o.large_glow_mask_width&&(n.large_glow_mask_width=o.large_glow_mask_width,De.dd(l,o.large_glow_mask_width),De.Fd(l,1/n.B.width,1/n.B.height),l.Ea=!0,De.dd(_,o.large_glow_mask_width),De.Fd(_,1/n.B.width,1/n.B.height),_.Ea=!0)}}function ie(e,t,a){var r=e.G,n=r.hd;if(!n.Aq)return n.vi;var o=n.waves_height,i=n.waves_length,_=n.vi,s=Be.length(r.Fh)||1;e=te(e,Pe.Gb).time,e*=s,s=ot,s[0]=20/i*(t-.25*e),s[1]=20/i*(a-.25*e);var c=je.fD(s);s[0]=17/i*(a+.1*e),s[1]=17/i*(t+.1*e);var s=c+je.fD(s)-1,l=n.dst_noise_scale0,c=n.dst_noise_scale1,f=n.dst_noise_freq0,u=n.dst_noise_freq1,d=ot;return d[0]=l*(t+f*e),d[1]=l*(a+f*e),l=je.PA(d),d[0]=c*(a-u*e),d[1]=c*(t-u*e),c=o*l*je.PA(d),n.Mk?(u=(t-n.Eo[0])/n.Fo[0],d=(n.Eo[1]+a)/n.Fo[1],u+=.5,d+=.5,1<u||0>u||1<d||0>d?t=c:(r=je.AE(r.MA,n.NA,u,d),u=n.dir_noise_scale,d=n.dir_noise_freq,l=Math.sqrt(r),f=Math.max(l,n.dst_min_fac),t=o*Math.max(r,n.dir_min_shore_fac)*Math.sin(l/(i/n.Gz/Math.PI)+n.dir_freq*e)*Math.max(je.PA([u/i*(t+d*e),u/i*(a+d*e)]),n.dir_min_noise_fac)*(1-f)+c*f,s*=r)):t=c,_+(t+.05*s)}function _e(e,t){e.em&&e.type==Pe.Tb&&t.Vb!=e.Vb&&(e.Vb=t.Vb),t.Vb||e.type!=Pe.$m||(e.yq=0)}function se(e,t,a,r){var n=Ee.Qa(e,t);ge.$v(n.B,a,r),n.Fp=!0,Ee.Wk(e,t,function(t,n,o){o.active&&o.from==a&&De.zM(o)&&ce(e,t,o.to,r)}),Ee.Ij(e,t,function(t,n,o){o.active&&o.from==a&&o.from==o.to&&se(e,t,a,r)})}function ce(e,t,a,r){for(e=Ee.Qa(e,t).Pa,t=0;t<e.length;t++)for(var n=e[t].Ca,o=0;o<n.length;o++)pe.CS(n[o].ra,r,a)}function le(e){for(var t=ee(e,[Pe.yi]),a=0;a<t.length;a++){var r=t[a],n=r.B,o=e.Bi.o,i=Fe.Cb(o.v,it),_=_t;_[0]=0,_[1]=0,_[2]=-r.ad[2]/2,r=Fe.mb(o.v,st),Be.transformQuat(_,r,_),_[0]+=i[0],_[1]+=i[1],_[2]=0,Me.identity(r),ge.IA(n,_,r)}}function fe(e,t){Ee.X(e,function(a,r){if(r.type==Pe.Ih){r.Sa[0]&&r.Og[0]||je.F("Wrong MOTION_BLUR subscene");var n=r.Sa[0],o=r.Og[0];r.Og[0]=r.B.$b,Ee.Wk(e,a,function(t,a,r){r.active&&ce(e,t,r.to,o)}),se(e,a,n.from,o),ce(e,a,n.to,r.Og[0]),r.qv=Math.exp(-t/r.mb_factor)}})}function ue(e){return e.G.Fh}function de(e,t){if(!e.G.wh)return null;for(var a=e.G.wh.Ri,r=0;r<a.length;r++)if(a[r]==t)return r;for(a=e.G.wh.ry,r=0;r<a.length;r++)if(a[r]==t)return r;return null}var pe=t("__batch"),me=t("__boundings"),ge=t("__camera"),he=t("__config"),ve=t("__container"),be=t("__debug"),Ee=t("__graph"),Ae=t("__hud"),xe=t("__input"),Te=t("__mat4"),ye=t("__nodemat"),Se=t("__objects"),Oe=t("__textures"),we=t("__obj_util"),Re=t("__physics"),Le=t("__prerender"),Ne=t("__primitives"),Ie=t("__print"),Me=t("__quat"),Ce=t("__renderer"),De=t("__scenegraph"),Ue=t("__sfx"),ke=t("__shaders"),Pe=t("__subscene"),Ge=t("__textures"),Fe=t("__tsr"),je=t("__util"),Be=t("__vec3"),He=t("__vec4"),Xe=t("__version"),qe=he.Jl,ze=he.H,We=he.Zg,Ye=he.Oc,Ve=he.Co,Je=[Pe.yi,Pe.ld,Pe.Gb,Pe.Sc,Pe.ig,Pe.Md,Pe.Nd,Pe.kd,Pe.Bf,Pe.Qe,Pe.we,Pe.Rg,Pe.Cf,Pe.Tg,Pe.Sg];e.YV=Je;var Ke=[Pe.Gb,Pe.Sc,Pe.ig,Pe.Md,Pe.Nd,Pe.kd,Pe.Zm,Pe.xs,Pe.ae,Pe.Bf,Pe.Qe,Pe.ys,Pe.Cf,Pe.ld,Pe.we,Pe.Rg,Pe.Tg],Qe=[Pe.Gb,Pe.Ds,Pe.Sc,Pe.ig,Pe.Md,Pe.Nd,Pe.kd,Pe.Bf,Pe.Qe],Ze=[Pe.ld,Pe.Gb,Pe.Sc,Pe.ig,Pe.Md,Pe.Nd,Pe.kd,Pe.Bf,Pe.Qe,Pe.we,Pe.Rg,Pe.Cf,Pe.Zm,Pe.Tg,Pe.Sg],$e=[Pe.Gb,Pe.Sc,Pe.ig,Pe.Md,Pe.Nd,Pe.kd,Pe.Bf,Pe.Qe],et=null,tt=null,at=[],rt=null,nt=Math.PI/2,ot=new Float32Array(2),it=new Float32Array(3),_t=new Float32Array(3),st=new Float32Array(4),ct=new Float32Array(4),lt=new Float32Array(16),ft=new Float32Array(24),ut=new Float32Array(24),dt=me.Be(),pt=me.Be(),mt=0,gt=-1/0,ht=new Uint8Array(4);e.bX=function(){return{}},e.set_active=function(e){tt=e,Ue.YS(e)},e.jS=function(e,t){var a=e.G,r=De.sN(a.va);if(e==t){Z(e,ve.OE(),ve.NE());for(var n=0;n<r.length;n++)e.G.wm.push(r[n])}else for(n=e.lg[0],Z(e,n.yj,n.yj),n=0;n<r.length;n++)t.G.wm.push(r[n]);for(r=ee(e,Ze),n=0;n<r.length;n++)r[n].Fh.set(a.Fh);for(n=0;n<a.wm.length;n++)a.wm[n].type==Pe.ld&&Ce.Cn(a.wm[n])},e.jh=a,e.bu=r,e.get_active=n,e.Fa=function(){return!!tt},e.gk=function(e){return e.Bi},e.Lq=function(){return at},e.vu=function(){if(1==at.length)return at;for(var e=0;e<at.length;e++){var t=at[e].G.va;Ee.X(t,function(t,a){for(var r=a.Pa,n=0;n<r.length;n++)for(var o=r[n].Ca,i=0;i<o.length;i++){for(var _=o[i],s=_.ra.fa,c=_.ra.We,l=null,f=0;f<s.length;f++)if("SCENE"==s[f].source&&s[f].Pr==at[e].name&&a.type!=Pe.ox){Ie.error('Texture-scene loop detected. A scene is rendered to texture "'+c[f]+'" yet this texture belongs to the same scene.'),l=_.ra;break}if(l)for(s=l.fa,l.fa=[],l.rf=[],pe.xU(l,null),pe.zc(l),Pe.Ic(a,_),f=0;f<s.length;f++)Oe.uD(s[f])}})}for(var a=[],e=0;e<at.length;e++)if(t=at[e],!t.lg.length){t=Ee.oj(rt,t),Ee.AO(rt,t),t=Ee.Rk(rt,t,Ee.Pj),t=Ee.fB(t),Ee.X(t,function(e,t){a.push(t)});break}return a},e.nL=function(e,t,a,r,n){e.lg=e.lg||[],e.wa=null;var i=e.G,N=we.ya(e.Bi,e),I=e.Bi.o;i.jp=[];var M=e.world;if(i.QQ=a.length,i.Sk=_(a),i.kw=d(M,i.Sk),i.jl=A(M,i.kw),i.OI=x(M),M=!e.lg.length)e:{if("HMD"==ze.stereo){if(N.ba[0].type!=ge.Gc){Ie.warn("Head-mounted display stereo is disabled for the non-perspective camera"),ze.stereo="NONE",M=!1;break e}if(!xe.can_use_device(xe.DEVICE_HMD)){Ie.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices"),ze.stereo="NONE",M=!1;break e}}M="HMD"==ze.stereo}switch(i.Mu=M,(M=!e.lg.length)&&(N.ba[0].type!=ge.Gc&&"ANAGLYPH"==ze.stereo?(Ie.warn("Anaglyph stereo is disabled for the non-perspective camera"),ze.stereo="NONE",M=!1):M="ANAGLYPH"==ze.stereo),i.anaglyph_use=M,i.eL=!i.anaglyph_use&&L(e,n),i.wh=u(e,t,r),i.TL=m(e),i.yR=g(e),i.mM=h(e),i.eQ=v(e),i.PR=b(e),i.ai=E(e),i.dof=ze.dof&&(0<I.dof_distance||I.dof_object),i.motion_blur=ze.motion_blur&&e.b4w_enable_motion_blur,i.compositing=ze.compositing&&e.b4w_enable_color_correction,i.antialiasing=ze.antialiasing&&1==ze.Rb&&"NONE"!=e.b4w_antialiasing_quality,i.ssao=ze.ssao&&e.b4w_enable_ssao,i.god_rays=ze.god_rays&&e.b4w_enable_god_rays&&i.Sk,i.jO=ze.Nt,i.yu=e.b4w_glow_settings.render_glow_over_blend,i.aU=p(e),n=f(r),i.OF=n,i.refractions=w(e,n),i.Pc=o(e,a,r),i.hd=l(r),i.Hh=R(r),i.MT=c(r),i.shore_smoothing=s(r),i.Dc=T(e,r),i.NM=y(e,r),i.outline=S(e,r),i.glow_materials=O(e,r),i.oR=e.b4w_lod_smooth_type,i.IF=e.b4w_lod_hyst_interval,ze.reflection_quality?ze.reflection_quality:e.b4w_reflection_quality){case"LOW":i.Uh=Ve.ND,i.vh=Ve.qG;break;case"MEDIUM":i.Uh=Ve.cO,i.vh=Ve.dS;break;case"HIGH":i.Uh=Ve.bO,i.vh=Ve.cS;break;default:i.Uh=Ve.ND,i.vh=Ve.qG}for(ve.qF()?(Ie.log("%cENABLE HIDPI MODE","color: #00a"),i.rC="AA_QUALITY_LOW",i.zo=1,ze.Rb=1):1<ze.Rb?(Ie.log("%cENABLE MSAA RENDERING: "+ze.Rb+"x","color: #00a"),i.zo=1):(i.rC="AA_QUALITY_"+e.b4w_antialiasing_quality,i.zo=ze.quality===he.P_ULTRA?1.33:1),a=e.lg.sort(function(e,t){return t.yj-e.yj}),i.va=De.rN(i,N,I,a),i.wm=[],i.xv=!1,i.Tz=!1,i.Uz=!1,i.Fh=new Float32Array(3),at.push(e),rt||(rt=Ee.create()),Ee.T(rt,e),i=0;i<t.length;i++)we.DA(t[i],!0,e);e=ve.get_container(),ve.resize(e.clientWidth,e.clientHeight,!0)},e.oL=function(e,t,a){for(var r=0;r<t.length;r++){var n=t[r].G;n&&n.dj&&(n.ss=a,e.G.jp.push(t[r]))}},e.ru=function(e){return e.G.va},e.sE=function(e,t){Ee.X(t,function(a,r){var n=null;switch(r.type){case Pe.Tb:n=pe.Dt(r.vr);break;case Pe.Ds:n=pe.yN(r);break;case Pe.zx:n=pe.zN(r);break;case Pe.JB:n=pe.dN();break;case Pe.Zm:n=pe.hN(r.Gv,r.wf,r.Pk);break;case Pe.xs:n=pe.iN();break;case Pe.Ih:n=pe.mN();break;case Pe.mx:n=pe.$M(r.tt);break;case Pe.pp:var n=pe.eN(r),o=r.B.dof_power;if(r.B.dof_bokeh){var o=o/2,i=De.su(t,r,Pe.Tb);De.dd(i[0],o),De.dd(i[1],o),i[0]=De.Jc(t,i[0],Pe.Tb),De.dd(i[0],o)}else{var i=De.Jc(t,r,Pe.Tb),_=De.Jc(t,i,Pe.Tb);De.dd(i,o),De.dd(_,o)}break;case Pe.$m:var n=pe.nN(),o=De.Jc(t,r,Pe.Tb),i=De.Jc(t,o,Pe.Tb),_=De.Jc(t,i,Pe.Tb),s=De.Jc(t,_,Pe.Tb);De.dd(i,r.Np),De.dd(o,r.Np),De.dd(s,r.Dq*r.sm),De.dd(_,r.Dq*r.sm);break;case Pe.qp:n=pe.gN();break;case Pe.nx:n=pe.aN();break;case Pe.EB:n=pe.WM(r);break;case Pe.xx:case Pe.Bs:case Pe.vp:case Pe.Cs:n=pe.wN(r.type);break;case Pe.jg:n=pe.AN(r.sb);break;case Pe.ae:n=pe.bN(e,r);break;case Pe.LUMINANCE:n=pe.jN();break;case Pe.HB:n=pe.XM();break;case Pe.ys:n=pe.kN(r.ol);break;case Pe.lp:n=pe.ZM(r.bt);break;case Pe.eC:n=pe.Dt("NONE");break;case Pe.VK:n=pe.YN();break;case Pe.Xm:n=pe.VM();break;case Pe.sp:n=pe.pN()}n&&(o=Pe.di(n,we.rn("NONE")),Pe.Ic(r,o),De.Dl(t,r,n),U(n))})},e.append_object=function(e,t,a,r){switch(t.type){case"MESH":case"LINE":case"WORLD":var n=e.G.va,o=t.o;for(!De.bc(n,Pe.ld)&&o.Gd&&(o.Gd=!1),o=ee(e,Je),(a||r)&&Re.append_object(t,e),r=0;r<o.length;r++){var i=o[r],_=t,s=n,c=e,l=a;switch(i.type){case Pe.Gb:I(i,_,s,"OPAQUE",c,l);break;case Pe.Sc:I(i,_,s,"BLEND",c,l);break;case Pe.ig:I(i,_,s,"XRAY",c,l);break;case Pe.Md:I(i,_,s,"GLOW",c,l);break;case Pe.Nd:case Pe.kd:P(i,_,s,!1,c,l);break;case Pe.Bf:case Pe.Qe:P(i,_,s,!0,c,l);break;case Pe.Cf:for(var f=we.ya(_,c),u=f.U,d=0;d<u.length;d++){var p=u[d];if("SHADOW"==p.type&&"RECEIVE"==p.sb&&p.Gd){if(!l&&(C(p,i,_,s,"SHADOW",c),!pe.zc(p)))continue;var m=Pe.di(p,_.o,f.If[d]);Pe.Ic(i,m),De.Dl(s,i,p),U(p)}}break;case Pe.ld:for(f=!1,u=_.o,_=we.ya(_,c),d=_.U,p=De.bc(s,Pe.yi),m=0;m<d.length;m++){var g=d[m];if("SHADOW"==g.type&&"CAST"==g.sb){if(f=!0,!l){M(g);var h=i.oo;if(pe.qb(g,"NUM_LIGHTS",h),pe.qb(g,"NUM_LFACTORS",h%2?Math.floor(h/2)+1:h/2),D(g.Ra,i.B),ke.ka(g.Ra,"SHADOW_USAGE","SHADOW_CASTING"),g.Dc&&p&&k(g,p,u),pe.qb(g,"SHADOW_TEX_RES",ke.R(c.G.Pc.csm_resolution)),!pe.zc(g))continue}g.Dc&&(c.G.Pc.tO=!0),h=Pe.di(g,u,_.If[m]),Pe.Ic(i,h),De.Dl(s,i,g),U(g)}}f&&(_=c.G.Pc,l=De.bc(s,Pe.Gb),j(i,c,l.B,_,!0));break;case Pe.we:case Pe.Rg:H(i,_,s,c,l);break;case Pe.Tg:for(f=_.o,u=we.ya(_,c),d=u.U,p=0;p<d.length;p++)if(m=d[p],"COLOR_ID"==m.type&&"OUTLINE"==m.sb){if(!l&&(C(m,i,_,s,"COLOR_ID",c),pe.qb(m,"USE_OUTLINE",1),!pe.zc(m)))continue;m=Pe.di(m,f,u.If[p]),Pe.Ic(i,m)}break;case Pe.yi:for(s=_.o,_=we.ya(_,c),c=_.U,f=0;f<c.length;f++)if(u=c[f],"GRASS_MAP"==u.type){if(!l&&!pe.zc(u)){if("DEBUG"!==Xe.type())continue;pe.Rs(u,"error.glslv","error.glslf"),pe.zc(u)}u=Pe.di(u,s,_.If[f]),Pe.Ic(i,u),u=i.B,g=s.og,d=i.ad[0],p=i.ad[1],m=i.ad[2],0==d&&0==p?(d=g.min_z,p=g.max_z):(d=Math.min(d,g.min_z),p=Math.max(p,g.max_z)),g=1e-4*(p-d),d-=g,p+=g,i.ad[0]=d,i.ad[1]=p,ge.$G(u,m/2,m/2,-p,-d),ge.set_projection(u,!1)}break;case Pe.Sg:for(f=_.o,_=we.ya(_,c),c=_.U,u=0;u<c.length;u++)if(d=c[u],"DEBUG_VIEW"==d.type){if(!l&&(d.Dc&&(p=De.bc(s,Pe.yi))&&k(d,p,f),!pe.zc(d))){if("DEBUG"!==Xe.type())break;pe.Rs(d,"error.glslv","error.glslf"),pe.zc(d)}p=Pe.di(d,f,_.If[u]),Pe.Ic(i,p),De.Dl(s,i,d),U(d)}}}break;case"LAMP":z(t,e)}for(a=we.ya(t,e),n=a.U,o=0;o<n.length;o++)null==n[o].ib&&"PHYSICS"!=n[o].type&&(we.PG(a,o),o--);we.DA(t,!0,e)},e.vQ=function(e,t){if(e&&e.G&&e.G.va){var a=e.G.va,r=De.bc(e.G.va,Pe.ae);if(r){var n=null;if(De.Jw(a,function(e,t,a,r){if("CUBEMAP"==e.from&&a.type==Pe.ae&&r.type==Pe.zi)return n=e.Ma,!0}),n){var a=Ve.Ht,o=pe.Mq(t,e);o&&o.nb?-1!=(o=ye.UP(ye.uu(o.Wd).va))&&(a=Oe.Xx(o/2)):(o=e.G.jl.Am)&&(a=o.PH),a=Math.min(a,We.Wf),r.B.width=a,r.B.height=a,Ge.TG(n,a),N(e,a)}}}},e.FU=function(e,t){for(var a=e.K,r=0;r<a.length;r++){var n=a[r].eb,o=n.G.va,i=De.bc(n.G.va,Pe.ae);if(i){var _=null;De.Jw(o,function(e,t,a,r){if("CUBEMAP"==e.from&&a.type==Pe.ae&&r.type==Pe.zi)return _=e.Ma,!0}),_&&(o=Oe.Xx(t.height/2),o=Math.min(o,We.Wf),i.B.width=o,i.B.height=o,Ge.TG(_,o),N(n,o))}}},e.EA=function(e){e.G.xv=!0},e.XU=function(e,t){Ee.X(t,function(t,a){a.type===Pe.ld&&(Fe.copy(e.v,a.B.v),Fe.copy(e.vf,a.B.Lr))})},e.SY=B,e.AP=function(e,t){for(var a=e.G.Pc,r=new Float32Array(a.csm_num),n=0;n<a.csm_num;n++)r[n]=ge.aO(a,t,n);return r},e.Xp=X,e.Wp=q,e.is_hidden=function(e){return e.o.hide},e.EG=function(e,t){for(var a=0;a<e.K.length;a++)for(var r=ee(e.K[a].eb,Je),n=0;n<r.length;n++)for(var o=r[n].Pa,i=0;i<o.length;i++)for(var _=o[i].Ca,s=_.length-1;0<=s;s--){var c=_[s];c.Yf==e.o&&(c.ra?"undefined"!=typeof t&&-1==c.ra.Pb.indexOf(t)&&0!=c.ra.Pb.length||(pe.vD(c.ra),_.splice(s,1)):_.splice(s,1))}},e.HU=function(e,t){for(var a=e.wb,r=we.ya(e,t).cr,n=ee(t,Ke),o=0;o<n.length;o++){var i=n[o];i.hm.set(a.iq,4*r),i.Ea=!0}},e.es=z,e.Nw=function(e){e=e.K;for(var t=0;t<e.length;t++)Y(e[t].eb)},e.Ow=Y,e.ZU=V,e.cleanup=function(){for(var e=0;e<at.length;e++){var t=at[e];Ee.X(t.G.va,function(e,t){if(t.type!=Pe.zi){var a=t.B;Ce.wS(a.Ee,a.$b,a.bf,a.width,a.height);for(var a=t.Pa,r=0;r<a.length;r++)for(var n=a[r].Ca,o=0;o<n.length;o++){var i=n[o].ra;i&&pe.vD(i)}}}),t.G.va=null,t.G.wm=[]}tt=et=null,at.length=0,rt=null},e.MF=function(e,t,a){e=ge.GO(e,e.near,e.far,null,!0);var r=Ne.hP(e);e=we.rn("DYNAMIC"),e.og=e.la={max_x:1e12,min_x:-1e12,max_y:1e12,min_y:-1e12,max_z:1e12,min_z:-1e12},e.Pd=e.hc=me.OL();var n=e.Pd.ab;e.Ji=e.tb=me.Ox([n,0,0],[0,n,0],[0,0,n],e.Pd.N),a=pe.vN(r,a),a.Vi=!0,a=Pe.di(a,e),Pe.Ic(t,a)},e.EX=function(e){return[e.frame_start,e.frame_end]},e.iH=function(e,t,a){ve.FT(e,t,a),tt&&Z(tt,e,t)},e.eg=ee,e.Ib=te,e.uS=function(){ae(!1)},e.vS=function(){ae(!0)},e.get_environment_colors=function(e){e=te(e,Pe.Gb);var t=e.yd,a=e.Ld,r=[],n=[];return r[0]=t[0],r[1]=t[1],r[2]=t[2],n[0]=a[0],n[1]=a[1],n[2]=a[2],[e.Nf,r,n]},e.set_environment_colors=function(e,t,a,r){for(var n=ee(e,Ke),o=0;o<n.length;o++){var i=n[o];i.yd.set(a),i.Ld.set(r),i.Nf=t,i.Ea=!0}(t=De.bc(e.G.va,Pe.ae))&&V(e,t)},e.get_sky_params=function(e){if((e=te(e,Pe.ae))&&e.procedural_skydome){var t={};return t.color=Array(3),Be.copy(e.Ok,t.color),t.procedural_skydome=e.procedural_skydome,t.use_as_environment_lighting=e.use_as_environment_lighting,t.rayleigh_brightness=e.rayleigh_brightness,t.mie_brightness=e.mie_brightness,t.spot_brightness=e.spot_brightness,t.scatter_strength=e.scatter_strength,t.rayleigh_strength=e.rayleigh_strength,t.mie_strength=e.mie_strength,t.rayleigh_collection_power=e.rayleigh_collection_power,t.mie_collection_power=e.mie_collection_power,t.mie_distribution=e.mie_distribution,t}return null},e.JP=function(e){return ee(e,Qe)[0].ff[0]},e.HP=function(e){return ee(e,Qe)[0].ff[1]},e.KP=function(e){return ee(e,Qe)[0].ff[2]},e.IP=function(e){return ee(e,Qe)[0].ff[3]},e.XG=function(e,t){for(var a=ee(e,Qe),r=0;r<a.length;r++){var n=a[r];n.ff[0]=t,n.Ea=!0}},e.VG=function(e,t){for(var a=ee(e,Qe),r=0;r<a.length;r++){var n=a[r];n.ff[1]=t,n.Ea=!0}},e.YG=function(e,t){for(var a=ee(e,Qe),r=0;r<a.length;r++){var n=a[r];n.ff[2]=t,n.Ea=!0}},e.WG=function(e,t){for(var a=ee(e,Qe),r=0;r<a.length;r++){var n=a[r];n.ff[3]=t,n.Ea=!0}},e.get_fog_color_density=function(e,t){var a=t||[],r=ee(e,Qe)[0].Sd;return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a},e.set_fog_color_density=function(e,t){for(var a=ee(e,Qe),r=0;r<a.length;r++){var n=a[r];n.Sd.set(t),n.Ea=!0}},e.get_ssao_params=function(e){var t=te(e,Pe.Ds),a=te(e,Pe.zx);if(e=te(e,Pe.Gb),!t)return null;var r={};return r.quality=t.Dm,r.use_hemisphere=t.No,r.use_blur_depth=a.Ko,r.blur_discard_value=a.Lo,r.radius_increase=t.Po,r.influence=t.Oo,r.dist_factor=t.Mo,r.ssao_only=e.ssao_only,r.ssao_white=t.ssao_white,r},e.get_dof_params=function(e){if(!(e=te(e,Pe.pp)))return null;var t={};return t.dof_on=e.B.dof_on,t.dof_distance=e.B.dof_distance,t.dof_front_start=e.B.dof_front_start,t.dof_front_end=e.B.dof_front_end,t.dof_rear_start=e.B.dof_rear_start,t.dof_rear_end=e.B.dof_rear_end,t.dof_power=e.B.dof_power,t.dof_bokeh=e.B.dof_bokeh,t.dof_bokeh_intensity=e.B.dof_bokeh_intensity,t.dof_object=e.B.dof_object,t},e.set_dof_params=re,e.get_god_rays_params=function(e){var t=ee(e,[Pe.Zm]);if(e=te(e,Pe.xs),!t||!e)return null;var a={};return a.god_rays_max_ray_length=t[0].uk,a.god_rays_intensity=e.god_rays_intensity,a.god_rays_steps=pe.$c(t[0].Pa[0].Ca[0].ra,"STEPS_PER_PASS")[1],a},e.set_god_rays_params=function(e,t){var a=ee(e,[Pe.Zm]),r=ee(e,[Pe.xs]);if(!a.length||!r.length)return Ie.error("God Rays are not enabled on the scene"),0;if("number"==typeof t.god_rays_intensity)for(var n=0;n<r.length;n++)r[n].god_rays_intensity=t.god_rays_intensity;if("number"==typeof t.god_rays_max_ray_length)for(var o=t.god_rays_max_ray_length,n=0;n<a.length;n++)a[n].uk=o,a[n].xo=o/a[n].Pk/(n+1),a[n].Ea=!0;if("number"==typeof t.god_rays_steps)for(var i=ke.R(t.god_rays_steps,1),o=a[0].uk,n=0;n<a.length;n++){a[n].Pk=i,a[n].xo=o/i/(n+1),a[n].Ea=!0;var _=a[n].Pa[0].Ca[0],s=_.ra;pe.qb(s,"STEPS_PER_PASS",i),pe.zc(s),Pe.Ic(a[n],_)}for(n=0;n<r.length;n++)r.Ea=!0},e.get_bloom_params=function(e){var t=te(e,Pe.ys);if(e=te(e,Pe.lp),!t||!e)return null;var a={};return a.key=t.ln,a.edge_lum=t.kn,a.blur=e.hn,a.adaptive=t.ol,a.average_luminance=t.average_luminance,a},e.set_bloom_params=ne,e.get_glow_material_params=function(e){if(!(e=te(e,Pe.qp)))return null;var t={};return t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t},e.set_glow_material_params=oe,e.get_wind_params=function(e){var t=ue(e);if(0==(e=Be.length(t)))return null;var t=je.rad_to_deg(Math.atan2(t[0],-t[1])),a={};return a.wind_dir=t,a.wind_strength=e,a},e.TS=function(e){e.G.Tz=!0},e.get_water_surface_level=ie,e.get_water_mat_params=function(e,t){var a=e.G.hd,r=te(e,Pe.Gb);r&&a&&(t.waves_height=a.waves_height,t.waves_length=a.waves_length,t.water_fog_density=r.Eh[3],a=t.water_fog_color=[],a[0]=r.Eh[0],a[1]=r.Eh[1],a[2]=r.Eh[2])},e.set_water_params=function(e,t){var a=e.G.hd;if(!a)return Ie.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof t.dst_noise_scale0&&(a.dst_noise_scale0=t.dst_noise_scale0),"number"==typeof t.dst_noise_scale1&&(a.dst_noise_scale1=t.dst_noise_scale1),"number"==typeof t.dst_noise_freq0&&(a.dst_noise_freq0=t.dst_noise_freq0),"number"==typeof t.dst_noise_freq1&&(a.dst_noise_freq1=t.dst_noise_freq1),"number"==typeof t.dir_min_shore_fac&&(a.dir_min_shore_fac=t.dir_min_shore_fac),"number"==typeof t.dir_freq&&(a.dir_freq=t.dir_freq),"number"==typeof t.dir_noise_scale&&(a.dir_noise_scale=t.dir_noise_scale),"number"==typeof t.dir_noise_freq&&(a.dir_noise_freq=t.dir_noise_freq),"number"==typeof t.dir_min_noise_fac&&(a.dir_min_noise_fac=t.dir_min_noise_fac),"number"==typeof t.dst_min_fac&&(a.dst_min_fac=t.dst_min_fac),"number"==typeof t.waves_hor_fac&&(a.waves_hor_fac=t.waves_hor_fac),"number"==typeof t.water_dynamic&&(a.Aq=t.water_dynamic);for(var r=ee(e,$e),n=0;n<r.length;n++){var o=r[n];"number"==typeof t.water_fog_density&&a.Sd&&(o.Eh[3]=t.water_fog_density),"object"==typeof t.water_fog_color&&a.Sd&&o.Eh.set(t.water_fog_color),o.Ea=!0}},e.get_shore_dist=function(e,t,a){var r=e.G.hd;if(!r.Mk)return 100;var n=r.Gz;e=r.vi;var o=(t[0]-r.Eo[0])/r.Fo[0],i=(r.Eo[1]+t[1])/r.Fo[1],o=o+.5,i=i+.5;return 1<o||0>o||1<i||0>i?void 0:(r=n*je.AE(tt.G.MA,r.NA,o,i),t=(e-t[2])*a,t=Math.sqrt(r*r+t*t))},e.update=function(e,t){for(var a=n().Bi.o,r=0;r<at.length;r++){var o=at[r],i=o.G.va,_=o.G;if(_.hd)var s=Fe.get_trans_view(a.v),c=s[2]-ie(o,s[0],s[1]);for(s=0;s<_.jp.length;s++){var l=_.jp[s].G,f=l.Wa,u=l.sd;if(!(o.b4w_use_nla&&l.bl||!f&&!u)&&Ge.HI(l)){var d=Ge.EI(l),p=Ge.GI(l);f&&ze.is_mobile_device&&(p-=5);var m=Ge.rV(l);d>=m&&l.Jj||d<p?(Ge.reset_video(l),u&&(l.Lk=Ge.Zv(l,e))):d>=m&&!l.Jj?Ge.pause_video(l):Ge.II(l)&&(f?Ge.kI(l):(f=Ge.Zv(l,e),f!=l.Lk&&(Ge.jI(l),l.vj++),l.Lk=f))}}Ee.X(i,function(t,a){-1<Ze.indexOf(a.type)&&(a.time=e),_.hd&&(a.Sp=c)})}for(r=0;r<at.length;r++)if(o=at[r],_=o.G,i=_.va,a=_.wm,a.length)for(_.xv&&(G(o),_.xv=!1),_.Tz&&(le(o),_.Tz=!1),_.Uz&&(F(o),_.Uz=!1),_.motion_blur&&fe(i,t),o=De.bc(i,Pe.Tg),s=0;s<a.length;s++)i=a[s],Le.Nv(i),o&&_e(i,o),Ce.Cn(i);ze.show_hud_debug_info&&Ae.JT(at,t)},e.ES=function(e){e.G.Uz=!0},e.My=function(e){var t=[];return Ee.X(e.G.va,function(e,a){t.push(a)}),t},e.get_cam_water_depth=function(){var e=te(tt,Pe.Sc),t=tt;return e||t.G.hd?e.Sp:null},e.iI=function(e){Ee.X(e.G.va,function(e,t){t.Ea=!0})},e.cT=function(e,t){e.debug_view_mode=t,e.Vb=t!=be.DV_NONE,e.kb=t==be.DV_TRANSPARENT_WIREFRAME,e.Ea=!0;for(var a=n(),r=0;r<$e.length;r++)for(var o=ee(a,[$e[r]]),i=0;i<o.length;i++)o[i].xq=t==be.DV_RENDER_TIME},e.bT=function(e,t){e.debug_colors_seed=t,e.Ea=!0},e.uT=function(e,t){e.Lt=t,e.Ea=!0},e.DT=function(e,t){for(var a=e.Pa,r=0;r<a.length;r++)for(var n=a[r].Ca,o=0;o<n.length;o++){var i=n[o].ra;Be.copy(t,i.wireframe_edge_color),i.ib.ko=!0}},e.eI=function(e,t){var a=t.Fn,r=e.G.Fh;if(a&&"WIND"==a.type&&r){var n=Fe.get_quat_view(t.o.v);for(Be.transformQuat(je.AXIS_Z,n,r),Be.normalize(r,r),Be.scale(r,a.FH,r),a=ee(e,Ze),n=0;n<a.length;n++)a[n].Fh.set(r);return!0}return!1},e.YR=function(e,t,a){var r=te(e,Pe.we);if(r){var n=qe.enabled&&(qe.Ur===Pe.we||qe.Ur===Pe.Rg);if(n)var o=ve.Tp(t,a,ot,r.B);else{var i=ve.get_canvas();ge.aT(r.B,t,a,i.clientWidth,i.clientHeight)}if(Le.Nv(r),r.Vb&&Ce.Cn(r),(e=te(e,Pe.Rg))?(Te.copy(r.B.pb,e.B.pb),Te.copy(r.B.gd,e.B.gd),je.Ol(e.B.gd,e.B.ih),Le.Nv(e),e.Vb&&Ce.Cn(e),t=e.B):t=r.B,r.Vb||e&&e.Vb)return n?(o[1]=t.height-o[1],Ce.Uv(t.Ee,o[0],o[1],1,1,ht)):Ce.Uv(e?e.B.Ee:r.B.Ee,0,0,1,1,ht)}else Ie.error("Object Selection is not available on the scene");return null},e.set_outline_color=function(e){for(var t=n(),t=ee(t,[Pe.$m]),a=0;a<t.length;a++){var r=t[a];r.rh.set(e),r.Ea=!0}},e.JX=ue,e.get_meta_tags=function(e){var t={title:"",description:""};return e.b4w_tags&&(t.title=e.b4w_tags.title,t.description=e.b4w_tags.description),t},e.get_custom_prop=function(e){return e.b4w_custom_prop},e.dI=function(e,t){var a=it;Be.negate(t,a);for(var r=0;6>r;r++){var n=e.Si[r],o=e.Il[r],i=e.B;Te.translate(je.aJ[r],a,n),Te.multiply(i.pb,n,i.gd),je.Ol(i.gd,o)}},e.fI=function(e,t,a){je.mU(t,a,je.AXIS_Z,e.B.nc)},e.DC=function(e,t,a){var r=e.G.wh;if(r&&t)for(var n=0;n<t.length;n++){var o=t[n],i=we.ya(o,e);if(-1!=o.o.zd){var _=r.li,s=r.Mv,o=o.o.zd;s.length&&o<s.length?i.li=s[o]:_.length&&o<_.length&&(i.li=_[o])}else-1!=o.o.Qd&&(_=r.Ri,s=r.ry,o=o.o.Qd,s.length?i.Ri=s[o]:_.length&&(i.Ri=_[o]))}if(a)for(t=we.wu(a,ze.ssao&&e.b4w_enable_ssao),a=e.G.Pc,n=0;n<t.length;n++)if(i=we.ya(t[n],e),a)for(r=ee(e,[Pe.ld]),o=0;o<r.length;o++)n==r[o].cg&&i.LA.push(r[o])},e.marker_frame=function(e,t){return e.timeline_markers[t]},e.set_hmd_params=function(e){var t=n();(t=te(t,Pe.jg))&&(e.distortion_coefs&&(t.Ui[0]=e.distortion_coefs[0],t.Ui[1]=e.distortion_coefs[1],t.Ea=!0),e.chromatic_aberration_coefs&&(t.chromatic_aberration_coefs[0]=e.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1]=e.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2]=e.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]=e.chromatic_aberration_coefs[3],t.Ea=!0),e.base_line_factor&&(t.Ui[2]=e.base_line_factor,t.Ea=!0),e.inter_lens_factor&&(t.Ui[3]=e.inter_lens_factor,t.Ea=!0),null!=e.enable_hmd_stereo&&(t.enable_hmd_stereo=e.enable_hmd_stereo,t.Ea=!0))},e.uv=function(t,a){for(var r=at,n=0;n<r.length;n++)De.ER(e.ru(r[n]),t,a)},e.sU=function(e){for(var t=Se.Hb(e,"LAMP",Se.DATA_ID_ALL),a=ee(e,Je),r=0;r<a.length;r++)for(var n=a[r],o=n.Pa,i=0;i<o.length;i++)for(var _=o[i].Ca,s=0;s<_.length;s++){var c=_[s],l=c.ra;"MAIN"==l.type&&(pe.wU(l,t,e),pe.zc(l),Pe.Ic(n,c))}},e.BG=function(e){for(var t=0;t<at.length;t++)Ee.X(at[t].G.va,function(t,a){for(var r=a.Pa,n=0;n<r.length;n++)for(var o=r[n].Ca,i=0;i<o.length;i++){var _=o[i];_.ra==e&&Pe.Ic(a,_)}})}},a.module.__physics=function(e,t){function a(e,t){for(var r=e.Ze,n=0;n<r.length;n++)r[n].uh.hs&&t.push(r[n]),a(r[n],t)}function r(e,t,a){for(var r=e.pc.Ca,n=0;n<r.length;n++)for(var o=r[n].I,i=0;i<o.Ye.length;i++){var _=o.Ye[i];"ANY"!=_.Zb&&a!=_.Zb||E(_,e,t)}}function n(e,t,a){if(C.Ru(e))switch(t){case C.hJ:var r=o(e);r.pc.NI=!0,C.ja(e,C.xK,Date.now()-performance.now(),z.max_fps,z.Wx?W.mE:0);break;case C.iJ:U.cd("URANIUM:",a.slice(1));break;case C.dJ:U.error(a);break;case C.eJ:M.fbmsg.apply(this,a.slice(1));break;case C.RB:if(e=i(a.aa)){var n=e;e=a.trans,r=a.quat,t=a.fi;var s=a.Jh,c=n.I;c.It=a.time,a=j.get_scale(n.o.v),j.set_sep(e,a,r,c.ty),H.copy(t,c.fi),H.copy(s,c.Jh)}break;case C.PB:(e=i(a.ay))&&j.set_sep(a.trans,1,a.quat,e.J.wr[a.nA]);break;case C.fJ:(r=i(a[1]))&&(e=a[4],r=r.vg.dt[a[2]],F.set_translation(r,a[3]),F.set_rotation(r,e),F.O(r));break;case C.lJ:(e=i(a[1]))&&(e.J.speed=a[2]);break;case C.NB:r=o(e),_(r,a.xl,a.yl,a.result,null,null,0);break;case C.OB:r=o(e),_(r,a.xl,a.yl,a.result,a.Bl,a.coll_norm,a.coll_dist);break;case C.bJ:(e=i(a[1]))&&(e=e.I,e.Al&&e.Al(a[2]));break;case C.ux:case C.QB:r=o(e),(e=r.pc.Hk[a.id])&&(r=i(a.mn),t==C.ux?(t=e.callback)(e.id,a.hit_fract,r,a.hit_time):(t=a.hit_fract,s=a.hit_time,c=a.hit_pos,n=e.callback,c?n(e.id,t,r,s,c,a.hit_norm):n(e.id,t,r,s)));break;case C.kJ:T(a.id);break;case C.jJ:e=J.indexOf(e),console.log("Physics #"+e+" Ping: OUT "+(a[2]-a[1]).toFixed(3)+" ms, IN "+(performance.now()-a[2]).toFixed(3)+" ms, ALL "+(performance.now()-a[1]).toFixed(3)+" ms");break;case C.gJ:V=a[1];break;case C.cJ:e=J.indexOf(e),console.log("Worker: #"+String(e)),console.log(a[1]);break;default:U.error("Wrong message: "+t)}}function o(e){for(var t=0;t<J.length;t++)if(J[t]==e)return K[t]}function i(e){return Q[e]||null}function _(e,t,a,r,n,o,_){e=e.pc.Ca;for(var c=0;c<e.length;c++)for(var l=e[c].I,f=0;f<l.Ye.length;f++){for(var u=l.Ye[f],d=u.Ek,p=!1,m=0;m<d.length;m++){var g=d[m];if(g[0]===t&&g[1]===a){u.kr[m]=r,p=!0;break}}p&&(d=s(u),n&&u.Sx!=t&&(p=n,m=o,g=_,p[0]+=m[0]*g,p[1]+=m[1]*g,p[2]+=m[2]*g,m[0]*=-1,m[1]*=-1,m[2]*=-1),u.callback(d,d?i(u.Sx==t?a:t):null,n,o,_))}}function s(e){e=e.kr;for(var t=!1,a=0;a<e.length;a++)t=t||e[a];return t}function c(){return++ee.body}function l(e){var t=$.indexOf(e);return-1==t?($.push(e),$.length-1):t}function f(e,t){return{aa:e,type:t,Eg:0,Tu:!1,Nk:!0,hf:!1,is_character:!1,EQ:!1,xt:null,Zb:"",fq:0,YW:{},Ye:[],Al:null,It:0,ty:new Float32Array([0,0,0,1,0,0,0,1]),fi:new Float32Array(3),Jh:new Float32Array(3),jt:new Float32Array(3),Rp:new Float32Array(4),fr:null}}function u(e,t){switch(e){case"BOX":var a=t.la;break;case"CYLINDER":a=t.Jp;break;case"CONE":a=t.Ip;break;case"SPHERE":a=t.hc;break;case"CAPSULE":a=t.Hp}return a}function d(e){if(!e)return null;var t={};return"number"===typeof e.min_x&&(t.min_x=e.min_x),"number"===typeof e.min_y&&(t.min_y=e.min_y),"number"===typeof e.min_z&&(t.min_z=e.min_z),"number"===typeof e.max_x&&(t.max_x=e.max_x),"number"===typeof e.max_y&&(t.max_y=e.max_y),"number"===typeof e.max_z&&(t.max_z=e.max_z),"object"===typeof e.N&&(t.center=e.N),"number"===typeof e.ab&&(t.radius=e.ab),"number"===typeof e.height&&(t.height=e.height),t}function p(e,t,a,r,n){var o=j.get_trans_view(e.o.v),i=j.invert(t.o.v,re),_=new Float32Array(3);switch(j.transform_vec3(o,i,_),t.J.type){case 10:t=t.tf,e=e.o.la,C.ja(n,C.aK,a,_,t.iU,t.yA,(e.max_z-e.min_z)/2,r);break;case 20:C.ja(n,C.$J,a,_,e.Rx)}}function m(e){return e.I&&e.I.xt}function g(e,t,a,r,n,o,i,_,s,c){var l;ee.ic++,l=ee.ic.toString(16);var f=t.I.aa;C.ja(h(f),C.hK,l,e,_,f,a,r,n.I.aa,o,i,s,c),t.I.xt=l}function h(e){for(var t=0;t<K.length;t++)for(var a=K[t].pc.Ca,r=0;r<a.length;r++)if(a[r].I.aa==e)return J[t];return null}function v(e){var t=e.I;if(t=!!t&&(0===t.Eg||(!0===t.Tu||(!1===t.Nk||"RIGID_BODY"!==t.type&&"DYNAMIC"!==t.type))))var t=j.Cb(e.o.v,te),a=j.mb(e.o.v,ae),t=t[0]!=e.I.jt[0]||t[1]!=e.I.jt[1]||t[2]!=e.I.jt[2]||a[0]!=e.I.Rp[0]||a[1]!=e.I.Rp[1]||a[2]!=e.I.Rp[2]||a[3]!=e.I.Rp[3];if(t){var t=e.I,r=e.o,a=C.HE(C.rp);a.aa=t.aa;var n=j.Cb(r.v,a.trans),r=j.mb(r.v,a.quat);H.copy(n,t.jt),k.copy(r,t.Rp),"DYNAMIC"==t.type&&k.identity(a.quat),C.ja(h(t.aa),C.rp)}for(e=e.Ze,t=0;t<e.length;t++)v(e[t])}function b(e,t,a,r,n){n=n||new Float32Array(3),e=j.get_quat_view(e.o.v),n[0]=t,n[1]=a,n[2]=r,H.transformQuat(n,e,n)}function E(e,t,a){var r=e.Ek,n=e.kr,o=e.Sx,i=[],_=e.Zb;i||B.F("At least one destination required");for(var s=0;s<t.pc.Ca.length;s++){var c=t.pc.Ca[s];("ANY"==_||c.I.Zb==_&&"NAVMESH"!=c.I.type)&&(c=c.I.aa,i&&-1==i.indexOf(c)&&i.push(c))}for(t=0;t<i.length;t++)_=i[t],o<_&&!A(r,o,_)?(r.push([o,_]),n.push(!1)):o>_&&!A(r,_,o)&&(r.push([_,o]),n.push(!1));C.ja(a,C.ZJ,o),C.ja(a,C.gK,r,e.Qh)}function A(e,t,a){for(var r=0;r<e.length;r++)if(e[r][0]==t&&e[r][1]==a)return!0;return!1}function x(e){e.I&&e.I.Al&&(e=e.I,C.ja(h(e.aa),C.tK,e.aa),e.Al=null)}function T(e){var t=S(e),a=y(e).pc;a.Hk[e]&&(delete a.Hk[e],a.rA.splice(a.rA.indexOf,1),C.ja(t,C.CK,e))}function y(e){for(var t=0;t<K.length;t++){var a=K[t];if(a.pc.Hk[e])return a}return null}function S(e){for(var t=0;t<K.length;t++)if(K[t].pc.Hk[e])return J[t];return null}function O(e,t,a){if(t.So){e=e.I.aa;var r=t.En*t.Fq,n=t.Pp*t.Qp,o=-t.Qo*t.Ro*2*Math.PI/t.Tr;switch(t.Tq&&(o*=-1),t.type){case 10:C.ja(a,C.QK,e,r,n,o);break;case 20:C.ja(a,C.PK,e,r,n,o)}}}function w(e){return e.hf&&"CHASSIS"==e.tf.mf}function R(e){return e.hf&&"HULL"==e.tf.mf}function L(e){return"NAVMESH"==e.uh.or}function N(e){return e.dm&&"MAIN_BODY"==e.In.mf}var I=t("__config"),M=t("__debug"),C=t("__ipc"),D=t("__obj_util"),U=t("__print"),k=t("__quat"),P=t("__scenes"),G=t("__subscene"),F=t("__transform"),j=t("__tsr"),B=t("__util"),H=t("__vec3"),X=t("__version"),q=t("__navmesh"),z=I.I,W=I.H,Y=I.Od,V=0,J=[],K=[],Q={},Z=[],$=["ANY"],ee={body:0,ic:0,zG:0},te=new Float32Array(3),ae=new Float32Array(4),re=j.create(),ne=j.create();e.xQ=function(e){e.pc={NI:!1,Ca:[],Hk:{},rA:[]};var t=z.gs;Y.prevent_caching&&(t+=X.timestamp()),U.log("%cLOAD PHYSICS","color: #0a0",z.Om?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+z.max_fps),U.log("%cPHYSICS PATH","color: #0a0",t);var a=C.ZN(t,!z.Om);C.HL(a,n),J.push(a),K.push(e),z.ping&&setInterval(function(){C.ja(a,C.zK,performance.now())},1e3)},e.AM=function(e){return!e.pc||e.pc.NI},e.cleanup=function(){for(var e=0;e<J.length;e++)C.terminate(J[e]);J.length=0,K.length=0,Q={},Z.length=0,$=["ANY"];for(var t in ee)ee[t]=0},e.append_object=function(e,t){if(t.pc){var n;e:{for(var o=0;o<K.length;o++)if(K[o]==t){n=J[o];break e}n=void 0}var i=[];e.uh.hs&&a(e,i);var _=t.pc.Ca;if(w(e)||R(e)||e.is_character||N(e)||e.$o){var s,h=L(e);if(h){var v=c(),b=f(v,"NAVMESH"),E=D.ya(e,t).U;b.fr=null;for(var A=0;A<E.length;A++){var x=E[A];if("PHYSICS"==x.type){b.fr=q.HR(x.ga);break}}s=b}else{var T=n,y=e.o,S=e.uh,I=S.or,M=c();if("CAMERA"==e.type)var P=S.vB?S.ut:"BOX",G=u(P,y),F=.5,H=0;else if("EMPTY"==e.type)P="EMPTY",G=null,H=F=0;else{var P=S.vB?S.ut:"BOX",G=u(P,y),X=j.get_scale(y.v);if(1!=X){var z=G;switch(P){case"BOX":z.min_x*=X,z.max_x*=X,z.min_y*=X,z.max_y*=X,z.min_z*=X,z.max_z*=X;break;case"CYLINDER":case"CONE":case"CAPSULE":z.height*=X,z.ab*=X;break;case"SPHERE":z.ab*=X}}F=y.Ln,H=y.Dn}var W,Y=j.get_trans_view(y.v),V=j.get_quat_view(y.v),$=S.ms,ee=S.vI,te=S.Eg,oe=S.AI,ie=S.zI,_e=S.RD,se=S.KG,ce=e.Zb,le=l(ce),fe=S.gq,ue=S.cq,de=S.hq,pe=y.hc.ab,me=d(G),ge=e.yt,he=P;if(i.length){var ve=[],be={};be.quat=new Float32Array([0,0,0,1]),be.trans=new Float32Array(3),be.worker_bounding=me,be.bounding_type=he,ve.push(be);var Ee=j.invert(y.v,re),Ae=ae,xe=j.get_quat_view(y.v);k.invert(xe,Ae);for(var Te=0;Te<i.length;Te++){var ye={},Se=i[Te],Oe=Se.uh.ut,we=new Float32Array(4),Re=new Float32Array(3),Le=j.get_trans_view(Se.o.v),Ne=j.get_quat_view(Se.o.v);j.transform_vec3(Le,Ee,Re),k.multiply(Ae,Ne,we),ye.trans=Re,ye.quat=we,ye.bounding_type=Oe,ye.worker_bounding=d(u(Oe,Se.o)),ve.push(ye)}W=ve}else W=[];C.ja(T,C.dK,M,Y,V,I,$,ee,te,oe,ie,_e,se,le,fe,ue,de,P,me,pe,F,H,W,ge),Q[M]=e,Z.push(e);var Ie=f(M,"BOUNDING");Ie.type=I,Ie.Eg=te,Ie.Tu=$,Ie.Zb=ce,Ie.fq=le,s=Ie}var Me=s;e.I=Me;var Ce={ra:null,I:Me};h||(_.push(Ce),r(t,n,Me.Zb))}else for(var De=D.ya(e,t).U,Ue=0;Ue<De.length;Ue++){var ke,Pe=De[Ue];if(ke="PHYSICS"==Pe.type){var Ge;e:{for(var Fe=t.pc.Ca,je=0;je<Fe.length;je++){var Be=Fe[je].ra;if(Be&&Be.id==Pe.id){Ge=!0;break e}}Ge=!1}ke=!Ge}if(ke)if(Pe.Id.Na)if(Pe.wf&&t.G.hd){var He=Pe,Xe=t,qe=n,ze=Xe.G.hd;if(C.ja(qe,C.mK,ze.vi),He.zV){var We={};We.dst_noise_scale0=He.dst_noise_scale0,We.dst_noise_scale1=He.dst_noise_scale1,We.dst_noise_freq0=He.dst_noise_freq0,We.dst_noise_freq1=He.dst_noise_freq1,We.dir_min_shore_fac=He.dir_min_shore_fac,We.dir_freq=He.dir_freq,We.dir_noise_scale=He.dir_noise_scale,We.dir_noise_freq=He.dir_noise_freq,We.dir_min_noise_fac=He.dir_min_noise_fac,We.dst_min_fac=He.dst_min_fac,We.waves_hor_fac=He.waves_hor_fac;var Ye=ze.waves_height,Ve=ze.waves_length;ze.Mk?C.ja(qe,C.aC,We,ze.Fo[0],ze.Fo[1],ze.Eo[0],ze.Eo[1],ze.Gz,Ye,Ve,ze.NA,Xe.G.MA):C.ja(qe,C.aC,We,0,0,0,0,0,Ye,Ve,0,null)}}else{var Je;if(Pe.ms){var Ke=e,Qe=Pe,Ze=n,$e=c(),et=Qe.Id,tt=et.$[0].a_position,at=et.qa||null,rt=Qe.Zb,nt=l(rt),ot=Qe.gq,it=Qe.cq,_t=Qe.hq,st=j.get_trans_view(Ke.o.v);C.ja(Ze,C.jK,$e,tt,at,st,nt,ot,it,_t);var ct=f($e,"STATIC_MESH");ct.Tu=!0,ct.Zb=rt,ct.fq=nt,Je=ct}else{var lt=e,ft=Pe,ut=n,dt=c(),pt=ft.Id,mt=pt.$[0].a_position,gt=pt.qa||null,ht=j.get_trans_view(lt.o.v),vt=ft.Ln,bt=ft.Dn,Et=ft.Zb,At=l(Et);C.ja(ut,C.lK,dt,mt,gt,ht,vt,bt,At,ft.gq,ft.cq,ft.hq);var xt=f(dt,"STATIC_MESH");xt.Zb=Et,xt.fq=At,Je=xt}Me=Je,e.I=Me,Ce={ra:Pe,I:Me},_.push(Ce),r(t,n,Me.Zb)}else U.error("Object "+e.name+" has collision material with no assigned vertices")}if(w(e)||R(e)){var Tt=n,yt=e.I.aa;if(w(e)?(e.J.type=10,C.ja(Tt,C.eK,yt,e.J.YA,e.J.$A,e.J.ZA,e.J.CB,e.J.Hz)):R(e)&&(e.J.type=20,C.ja(Tt,C.cK,yt,e.J.Pl,e.J.Sm,e.J.Tm)),e.J.vm){var St=e.J.vm;switch(e.J.type){case 10:p(St[0],e,yt,!0,Tt),p(St[1],e,yt,!0,Tt),p(St[2],e,yt,!1,Tt),p(St[3],e,yt,!1,Tt);break;case 20:for(var Ot=0;Ot<St.length;Ot++)p(St[Ot],e,yt,!1,Tt)}}O(e,e.J,n)}else if(e.is_character){var wt=n,Rt=e.o,Lt=e.I,Nt=Rt.la.max_z-Rt.la.min_z,It=Lt.aa,Mt=e.gD,Ct=Mt.xV,Dt=Mt.QS,Ut=Mt.bU,kt=Mt.OQ,Pt=Mt.AV,Gt=B.lO(e);C.ja(wt,C.fK,It,Gt,Nt,Ct,Dt,Ut,kt,Pt),Lt.is_character=!0}else if(N(e)){var Ft=n,jt=e.I.aa;if(C.ja(Ft,C.iK,jt,e.vg.Pl,e.vg.Sm,e.vg.Tm),e.vg.dt)for(var Bt=e.vg.dt,Ht=0;Ht<Bt.length;Ht++){var Xt=Bt[Ht],qt=j.get_trans_view(Xt.o.v),zt=j.invert(e.o.v,re),Wt=new Float32Array(3);j.transform_vec3(qt,zt,Wt),C.ja(Ft,C.bK,jt,Wt,Xt.Rx)}e.I.EQ=!0}for(Ue=0;Ue<Z.length;Ue++){var Yt=Z[Ue];if(Yt.I){var Vt=Yt;if(!m(Vt))for(var Jt=0;Jt<Vt.kA.length;Jt++){var Kt=Vt.kA[Jt],Qt=Kt.target,Zt=Kt.ZR;if(Qt.I){var $t=new Float32Array([Kt.$R,Kt.aS,Kt.bS]),ea=B.euler_to_quat(new Float32Array([Kt.Ia,Kt.Ja,Kt.Ka]),new Float32Array(4)),ta=j.identity(re),ta=j.set_trans($t,ta),ta=j.set_quat(ea,ta),aa=j.multiply(Vt.o.v,ta,re),ra=j.invert(Qt.o.v,ne),na=j.multiply(ra,aa,ra),oa=j.get_trans_view(na),ia=j.get_quat_view(na),_a=Kt,sa={};sa.use_limit_x=_a.jV,sa.use_limit_y=_a.kV,sa.use_limit_z=_a.lV,sa.use_angular_limit_x=_a.fV,sa.use_angular_limit_y=_a.gV,sa.use_angular_limit_z=_a.hV,sa.limit_max_x=_a.$Q,sa.limit_min_x=_a.cR,sa.limit_max_y=_a.aR,sa.limit_min_y=_a.dR,sa.limit_max_z=_a.bR,sa.limit_min_z=_a.eR,sa.limit_angle_max_x=_a.UQ,sa.limit_angle_min_x=_a.XQ,sa.limit_angle_max_y=_a.VQ,sa.limit_angle_min_y=_a.YQ,sa.limit_angle_max_z=_a.WQ,sa.limit_angle_min_z=_a.ZQ,g(Zt,Vt,$t,ea,Qt,oa,ia,sa,null,null)}}}}}},e.OO=i,e.update=function(e,t){for(var a=0;a<J.length;a++){var r=J[a],n=e;r&&C.pF(r)&&C.ja(r,C.RK,n,t);for(var o=0;o<Z.length;o++){var i=Z[o],_=i.I;if(_.Nk&&_.It){var s=C.pF(r)?n-_.It:performance.now()/1e3-_.It,s=Math.min(s,10/z.max_fps),s=s-1/z.max_fps;W.IR&&(s=0);var c=re;if(j.AQ(_.ty,s,_.fi,_.Jh,re),F.set_tsr(i,c),F.O(i),v(i),i.J)for(var _=i,s=_.J.vm,c=_.o.v,l=re,f=0;f<s.length;f++){var u=s[f];j.multiply(c,_.J.wr[f],l),F.set_tsr(u,l),F.O(u)}i.J&&i.J.So&&(l=i,s=l.J,_=s.So)&&(f=l.J.CH,j.multiply(l.o.v,l.J.DH,_.o.v),c=te,j.transform_dir_vec3(f,l.o.v,c),l=ae,k.setAxisAngle(c,-s.Qo*s.Ro*2*Math.PI,l),s=j.get_quat_view(_.o.v),k.multiply(l,s,s),F.O(_)),i.J&&i.J.QA&&(l=i,s=l.J,_=s.QA)&&(f=l.J.xH,j.multiply(l.o.v,l.J.yH,_.o.v),c=te,j.transform_dir_vec3(f,l.o.v,c),l=ae,f=Math.abs(s.speed)*s.Rr,f>s.co&&(f=s.co),k.setAxisAngle(c,-f,l),s=j.get_quat_view(_.o.v),k.multiply(l,s,s),k.normalize(s,s),F.O(_)),i.J&&i.J.aB&&(c=i,_=c.J,i=_.aB)&&(l=c.J.LH,j.multiply(c.o.v,c.J.MH,i.o.v),s=te,j.transform_dir_vec3(l,c.o.v,s),c=ae,k.setAxisAngle(s,-Math.abs(_.En)*_.tq,c),_=j.get_quat_view(i.o.v),k.multiply(c,_,_),k.normalize(_,_),F.O(i))}}C.gS(r),r=K[a],(n=r.G.hd)&&0<n.waves_height&&(r=P.Ib(r,G.Gb),n=H.length(r.Fh)||1,C.ja(J[a],C.OK,r.time*n))}},e.oP=function(){return K[0]},e.pause=function(){for(var e=0;e<J.length;e++)C.ja(J[e],C.yK)},e.resume=function(){for(var e=0;e<J.length;e++)C.ja(J[e],C.DK)},e.enable_simulation=function(e){if((e=e.I)||B.F("No object physics"),!e.Nk){var t=e.aa,a=h(t);e.Nk=!0,C.ja(a,C.wK,t)}},e.disable_simulation=function(e){if((e=e.I)||B.F("No object physics"),e.Nk){var t=e.aa,a=h(t);e.Nk=!1,C.ja(a,C.vK,t)}},e.Wv=function(e){return!!e.pc},e.na=function(e){return!!e.I},e.has_dynamic_physics=function(e){return!!((e=e.I)&&e.Nk&&("RIGID_BODY"==e.type||"DYNAMIC"==e.type)&&0<e.Eg&&0==e.Tu)},e.has_simulated_physics=function(e){return!(!(e=e.I)||!e.Nk)},e.set_gravity=function(e,t){var a=e.I.aa;C.ja(h(a),C.NK,a,t)},e.iQ=m,e.apply_constraint=g,e.clear_constraint=function(e){e=e.I,C.ja(h(e.aa),C.BK,e.xt),e.xt=null},e.pull_to_constraint_pivot=function(t,a,r,n,o,i){a=j.set_sep(a,1,r,re),o=j.set_sep(o,1,i,ne),j.invert(a,a),j.multiply(o,a,a),F.get_tsr(n,o),j.multiply(o,a,a),F.set_tsr(t,a),F.O(t),n=j.get_trans_view(t.o.v),o=j.get_quat_view(t.o.v),e.set_transform(t,n,o)},e.set_transform=function(e,t,a){var r=e.I,n=C.HE(C.rp),o=j.Cb(e.o.v,n.trans);e=j.mb(e.o.v,n.quat),j.set_sep(o,1,e,r.ty),n.aa=r.aa,H.copy(t,n.trans),k.copy(a,n.quat),C.ja(h(r.aa),C.rp)},e.sync_transform=v,e.apply_velocity=function(e,t,a,r){var n=te;b(e,t,a,r,n),e=e.I.aa,t=Math.abs(0),a=Math.abs(0),r=Math.abs(0);var o=Math.abs(n[0]),i=Math.abs(n[1]),_=Math.abs(n[2]);n[0]=o?n[0]/o*Math.max(o,t):0,n[1]=i?n[1]/i*Math.max(i,a):0,n[2]=_?n[2]/_*Math.max(_,r):0,C.ja(h(e),C.cC,e,n[0],n[1],n[2])},e.apply_velocity_world=function(e,t,a,r){e=e.I.aa,C.ja(h(e),C.cC,e,t,a,r)},e.apply_force=function(e,t,a,r,n){var o=te;n?(o[0]=t,o[1]=a,o[2]=r):b(e,t,a,r,o),e=e.I.aa,C.ja(h(e),C.nK,e,o[0],o[1],o[2])},e.apply_torque=function(e,t,a,r){var n=te;b(e,t,a,r,n),e=e.I.aa,C.ja(h(e),C.pK,e,n[0],n[1],n[2])},e.set_angular_velocity=function(e,t,a,r){e=e.I.aa,C.ja(h(e),C.EK,e,t,a,r)},e.set_character_move_dir=function(e,t,a){e=e.I.aa,C.ja(h(e),C.HK,e,t,a)},e.set_character_move_type=function(e,t){var a=e.I.aa;C.ja(h(a),C.IK,a,t)},e.set_character_walk_velocity=function(e,t){var a=e.I.aa;C.ja(h(a),C.MK,a,t)},e.set_character_run_velocity=function(e,t){var a=e.I.aa;C.ja(h(a),C.KK,a,t)},e.set_character_fly_velocity=function(e,t){var a=e.I.aa;C.ja(h(a),C.FK,a,t)},e.character_jump=function(e){e=e.I.aa,C.ja(h(e),C.rK,e)},e.character_rotation_inc=function(e,t,a){e=e.I.aa,C.ja(h(e),C.sK,e,t,a)},e.set_character_rotation=function(e,t,a){e=e.I.aa,C.ja(h(e),C.JK,e,t,a)},e.set_character_rotation_h=function(e,t){var a=e.I.aa;C.ja(h(a),C.GK,a,t)},e.set_character_rotation_v=function(e,t){var a=e.I.aa;C.ja(h(a),C.LK,a,t)},e.append_collision_test=function(e,t,a,r){var n=e.I;if(!n.fr){for(var i=n.aa,_=0;_<n.Ye.length;_++)if(e=n.Ye[_],e.Zb==t&&e.callback==a)return;e={Sx:i,Qh:r||!1,Zb:t,callback:a,Ek:[],kr:[]},n.Ye.push(e),t=h(i),E(e,o(t),t)}},e.remove_collision_test=function(e,t,a){e=e.I;for(var r=h(e.aa),n=o(r),i=0;i<e.Ye.length;i++){var _=e.Ye[i];if(_.Zb==t&&_.callback==a){if(s(_)){var c=H.set(0,0,0,te);_.callback(!1,null,c,c,0)}e.Ye.splice(i,1),i--;for(var c=r,_=_.Ek,l=n.pc.Ca,f=0;f<l.length;f++)for(var u=l[f].I,d=0;d<u.Ye.length;d++)for(var p=u.Ye[d],m=0;m<p.Ek.length;m++)for(var g=p.Ek[m],v=0;v<_.length;v++){var b=_[v];g[0]==b[0]&&g[1]==b[1]&&(_.splice(v,1),v--)}_.length&&C.ja(c,C.bC,_)}}},e.apply_collision_impulse_test=function(e,t){e.I&&e.I.Al&&x(e);var a=e.I;C.ja(h(a.aa),C.oK,a.aa),a.Al=t},e.clear_collision_impulse_test=x,e.append_ray_test=function(e,t,a,r,n,i,_,s,c){var f;return ee.zG++,f=ee.zG,e={id:f,aa:e?e.I.aa:0,from:new Float32Array(t),to:new Float32Array(a),Zb:r,fq:l(r),HC:i,bM:_,Qh:s,Nu:c,callback:n},t=h(e.aa)||J[0],a=o(t).pc,a.Hk[f]=e,a.rA.push(e),C.ja(t,C.kK,e.id,e.aa,e.from,e.to,e.fq,e.HC,e.bM,e.Qh,e.Nu),f},e.remove_ray_test=T,e.change_ray_test_from_to=function(e,t,a){var r=S(e),n=y(e).pc.Hk[e];n&&!n.HC&&(n.from.set(t),n.to.set(a),C.ja(r,C.qK,e,t,a))},e.rF=function(e){return!!y(e).pc.Hk[e]},e.vehicle_throttle=function(e,t){var a=e.J;a.En=t,O(e,a,h(e.I.aa))},e.vehicle_steer=function(e,t){var a=e.J;a.Qo=t,O(e,a,h(e.I.aa))},e.vehicle_brake=function(e,t){var a=e.J;a.Pp=t,O(e,a,h(e.I.aa))},e.is_vehicle_chassis=w,e.is_vehicle_hull=R,e.cY=L,e.DQ=function(e){return!!e.hf&&("WHEEL_FRONT_LEFT"==(e=e.tf.mf)||"WHEEL_FRONT_RIGHT"==e||"WHEEL_BACK_LEFT"==e||"WHEEL_BACK_RIGHT"==e)},e.CQ=function(e){return!!e.hf&&"BOB"==e.tf.mf},e.FQ=function(e){return!!e.dm&&"BOB"==e.In.mf},e.tF=function(e){return!(!e.hf||"STEERING_WHEEL"!=e.tf.mf)},e.sF=function(e){return!(!e.hf||"SPEEDOMETER"!=e.tf.mf)},e.uF=function(e){return!(!e.hf||"TACHOMETER"!=e.tf.mf)},e.get_vehicle_speed=function(e){return e.J.speed},e.CV=function(e){switch(e){case"WHEEL_FRONT_RIGHT":return 0;case"WHEEL_FRONT_LEFT":return 1;case"WHEEL_BACK_LEFT":return 2;case"WHEEL_BACK_RIGHT":return 3}},e.VE=function(e){return e.I&&e.I.is_character},e.bY=N,e.LP=function(){return V},e.gO=function(){for(var e=0;e<J.length;e++)C.ja(J[e],C.uK)},e.remove_object=function(e){var t=e.I.aa;if("BOUNDING"==e.I.type){var a=Z.indexOf(e);-1==a&&U.error("Object "+e.name+" doesn't have bounding physics"),delete Q[t],Z.splice(a,1)}for(var a=h(t),r=o(a),n=r.pc.Ca,i=[],_=0;_<n.length;_++)for(var c=n[_].I,l=0;l<c.Ye.length;l++)for(var f=c.Ye[l],u=0;u<f.Ek.length;u++){var d=f.Ek[u],p=f.kr[u];d[0]!=t&&d[1]!=t||(f.Ek.splice(u,1),f.kr.splice(u,1),u--,p&&!s(f)&&(p=H.set(0,0,0,te),f.callback(!1,null,p,p,0)),i.push(d))}for(i.length&&C.ja(a,C.bC,i),e.I&&e.I.Al&&x(e),e=r.pc.Ca,r=0;r<e.length;r++)e[r].I.aa==t&&(e.splice(r,1),r--);C.ja(a,C.AK,t)},e.kQ=function(e){var t=e.uh;return e.hf||e.dm||e.is_character||e.$o&&!t.ms&&0<t.Eg&&("DYNAMIC"==t.or||"RIGID_BODY"==t.or)}},a.module.__data=function(e,t){function a(e,t){Xe[t.id]=null,qe[t.id]=null}function r(e,t,a,r){e instanceof ArrayBuffer?(e=ce.PE(e,r),r=e.width,e=e.height):(r=e.width,e=e.height),xe.log("%cLOAD IMAGE "+r+"x"+e,"color: #"+(2048<r||2048<e?"a00":1024<r||1024<e?"aa0":"0a0"),t),-1==t.indexOf(ze)&&a&&xe.warn("image",t,"is not from app root.")}function n(e,t,a,r,n,o){function i(e){o(t,a,e)}function _(r,o,c,l){if(r){switch(xe.log("%cLOAD METADATA","color: #616",l),o=Ue.EH(r.b4w_format_version),Ue.BI(o,Fe.lm)){case-1:o[0]<Fe.lm[0]?Ue.F("JSON version is too old relative to B4W engine: "+Ue.el(o)+", required: "+Ue.el(Fe.lm)+". Reexport scene with the latest B4W addon to fix it."):xe.warn("JSON version is a bit old relative to B4W engine: "+Ue.el(o)+", required: "+Ue.el(Fe.lm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:o[0]>Fe.lm[0]?Ue.F("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):xe.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Fe.Az=o;for(var f in r)e[f]=r[f];if(t.Db&&(We=Oe.bu(e.scenes)),(r=e.binaries[0].binfile)?t.QC=r:(de.gw(t,"load_binaries"),de.gw(t,"prepare_bindata")),Fe.is_mobile_device||de.gw(t,"mobile_media_start"),Fe.antialiasing&&Fe.smaa||de.gw(t,"load_smaa_textures"),e.b4w_export_errors)for(r=0;r<e.b4w_export_errors.length;r++)f=e.b4w_export_errors[r],(t.Db&&"PRIMARY"==f.type||"ALL"==f.type)&&xe.DO(f.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(e.b4w_export_warnings)for(r=0;r<e.b4w_export_warnings.length;r++)f=e.b4w_export_warnings[r],(t.Db&&"PRIMARY"==f.type||"ALL"==f.type)&&xe.EO(f.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");t.Tf&&b(e),n(t,a)}else c==ne.AT_JSON_ZIP?(xe.warn("Compressed file ",l,"not found or invalid. Trying to load non-compressed",s),ne.enqueue([{id:s,type:ne.AT_JSON,url:s,ie:t.Tf}],_,null,i)):de.sC(t)}var s=t.Zh;if(s||Ue.F("Nothing requested"),Fe.assets_gzip_available){r=s+".gz";var c=ne.AT_JSON_ZIP}else r=s,c=ne.AT_JSON;ne.enqueue([{id:r,type:c,url:r,ie:t.Tf}],_,null,i)}function o(e,t,a,r,n,o){function i(e){o(t,a,e)}function _(r,o,c,l){r?(xe.log("%cLOAD BINARY","color: #616",l),e.bin_data=r,o=new Uint32Array(r,4,1)[0],r=new Uint32Array(r,8,1)[0],r=[o,r],o=Ue.EH(e.b4w_format_version),r[0]!=o[0]&&Ue.F("BIN version does not match to JSON version: "+Ue.el(r)+", required: "+Ue.el(Fe.lm)+". Couldn't load the scene. Reexport scene to fix it."),r[1]!=o[1]&&xe.warn("BIN version does not match to JSON version: "+ +Ue.el(r)+", required: "+Ue.el(Fe.lm)+". Some compatibility issues can occur. Reexport scene to fix it."),n(t,a)):c==ne.AT_ARRAYBUFFER_ZIP?(xe.warn("Compressed file ",l,"not found or invalid. Trying to load non-compressed",s),ne.enqueue([{id:s,type:ne.AT_ARRAYBUFFER,url:s,ie:t.Tf}],_,null,i)):de.sC(t)}var s=$(t.Zh)+t.QC;if(s||Ue.F("Binary data is missing"),Fe.assets_gzip_available){r=s+".gz";var c=ne.AT_ARRAYBUFFER_ZIP}else r=s,c=ne.AT_ARRAYBUFFER;ne.enqueue([{id:r,type:c,url:r,ie:t.Tf}],_,null,i)}function i(e,t,a,r,n){Re.lD()&&n(t,a)}function _(e,t,a,r,n){r=e.bin_data;var o=e.binaries[0],i=e.objects,_=e.meshes;e=e.actions;for(var c=Ue.uM(),l=["indices"],f=["position","texcoord","texcoord2","shade_tangs"],u=["normal","tangent"],d=["group"],p=["color"],m=0;m<_.length;m++)for(var g=_[m].submeshes,h=0;h<g.length;h++){for(var v in g[h]){var b=g[h][v][1];if(-1!=l.indexOf(v)){var E=g[h][v][0]*Ue.MB+o.int+12,A=g[h],x=v,T=r;if(c)var y=new Uint32Array(T,E,b);else for(var y=new Uint32Array(b),T=new DataView(T),S=0;S<b;S++)y[S]=T.getUint32(E+S*Ue.MB,!0);A[x]=y}else if(-1!=f.indexOf(v))E=g[h][v][0]*Ue.xi+o.float+12,g[h][v]=s(r,E,b,c);else if(-1!=u.indexOf(v)){for(E=g[h][v][0]*Ue.tp+o.short+12,A=g[h],x=v,T=r,y=new Float32Array(b),T=new DataView(T),S=0;S<b;S++)y[S]=T.getInt16(E+S*Ue.tp,!0)/32767;A[x]=y}else if(-1!=d.indexOf(v)){for(E=g[h][v][0]*Ue.tp+o.ushort+12,A=g[h],x=v,T=r,y=new Float32Array(b),T=new DataView(T),S=0;S<b;S++)y[S]=T.getUint16(E+S*Ue.tp,!0)/65535;A[x]=y}else if(-1!=p.indexOf(v)){for(E=g[h][v][0]*Ue.lx+o.uchar+12,A=g[h],x=v,T=r,y=new Float32Array(b),T=new DataView(T),S=0;S<b;S++)y[S]=T.getUint8(E+S*Ue.lx)/255;A[x]=y}}if(b=g[h],_[m].b4w_shape_keys.length)for(E=b.base_length,A=b.normal.length/E/3,b.tbn=Ne.Tl(b.normal.subarray(0,3*E),b.tangent.subarray(0,4*E),Ne.create(b.normal.length/3)),x=1;x<A;x++)for(T=x*E,y=0;y<E;y++){var O=b.normal.subarray(3*y,3*(y+1)),w=ke.add(b.normal.subarray(3*(T+y),3*(T+y+1)),O,Ve),S=Ne.identity(Qe);if(b.tangent.length){var R=b.tangent.subarray(4*y,4*(y+1)),L=Pe.add(b.tangent.subarray(4*(T+y),4*(T+y+1)),R,Je),O=Ne.Tl(O,R),w=Ne.Tl(w,L);Ne.FR(w,O,S)}else w=Te.rotationTo(O,w,Ke),Ne.set_quat(S,w,0);Ne.oi(b.tbn,S,T+y)}else b.tbn=Ne.Tl(b.normal,b.tangent);"texcoord2"in g[h]&&(b=new Float32Array(g[h].texcoord.length+g[h].texcoord2.length),b.set(g[h].texcoord),b.set(g[h].texcoord2,g[h].texcoord.length),g[h].texcoord=b,delete g[h].texcoord2)}for(v=0;v<i.length;v++)for(_=i[v].particle_systems,l=0;l<_.length;l++)f=_[l],f.transforms=s(r,f.transforms[0]*Ue.xi+o.float+12,f.transforms[1],c);for(i=0;i<e.length;i++){v=e[i],_=v.fcurves,l=v.frame_range,u=l[0],d=l[1],p=re.sP(u,d),l=null,0>p&&(p=0);var N,g=m=!1;for(N in _)m|=-1<N.indexOf("rotation_euler"),g|=-1<N.indexOf("rotation_quaternion");f=[];for(N in _)if(m&&g&&-1<N.indexOf("rotation_euler"))delete _[N];else{var I,h=_[N];for(I in h)b=h[I],E=s(r,o.float+b.bin_data_pos[0]*Ue.xi+12,b.bin_data_pos[1],c),A=new Float32Array(p),l||(l=new Int8Array(p)),re.AL(b,E,A,l,u,d),b.Ef=A;-1<N.indexOf("rotation_euler")&&(re.LO(_[N]),f.push(N))}for(u=0;u<f.length;u++)d=f[u],p=d.replace("euler","quaternion"),_[p]=_[d],delete _[d];v.YK=l}n(t,a)}function s(e,t,a,r){if(r)r=new Float32Array(e,t,a);else{r=new Float32Array(a),e=new DataView(e);for(var n=0;n<a;n++)r[n]=e.getFloat32(t+n*Ue.xi,!0)}return r}function c(e,t,a,r,n){var o=e.cameras,i=e.groups,_=e.materials,s=e.meshes,c=e.node_groups,l=e.objects,d=e.particles,g=e.scenes,h=e.speakers,v=e.lamps,E=e.textures,A=e.worlds;c||(xe.warn('"node_groups" datablock undefined. reexport main scene.'),c=e.node_groups=[]);for(var x="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),T={},w=0;w<x.length;w++)for(var R=e[x[w]],L=0;L<R.length;L++){var N=R[L];T[N.uuid]=N}for(var I=0;I<g.length;I++){for(var M=g[I],C=M.objects,D=0;D<C.length;D++)O(C,D,T);M.camera&&O(M,"camera",T),M.world&&O(M,"world",T)}for(I=0;I<i.length;I++)for(var U=i[I].objects,D=0;D<U.length;D++)O(U,D,T);for(I=0;I<l.length;I++){var k=l[I];k.dupli_group&&O(k,"dupli_group",T),k.parent&&O(k,"parent",T),k.dg_parent&&O(k,"dg_parent",T);var P=k.animation_data;switch(P&&y(P,T),k.type){case"MESH":k.data||Ue.F("mesh not found for object "+k.name),O(k,"data",T);for(var j=!1,B=k.modifiers,D=0;D<B.length;D++){var H=B[D];"ARMATURE"==H.type?(j&&xe.warn('Object "'+k.name+'" has more than one armature modifiers. Only the first one will be used.'),j=!0,O(H,"object",T)):"CURVE"==H.type&&O(H,"object",T)}var X=k.particle_systems;if(X)for(D=0;D<X.length;D++)O(X[D],"settings",T);break;case"ARMATURE":O(k,"data",T);for(var q=k.pose.bones,z=k.data.bones,D=0;D<q.length;D++){var W=q[D];W.bone=z[W.bone];var Y=W.constraints;if(Y)for(var V=0;V<Y.length;V++){var J=Y[V];J.target&&O(J,"target",T)}for(var K=W.parent_recursive,V=0;V<K.length;V++)K[V]=q[K[V]]}break;case"LAMP":case"CAMERA":case"SPEAKER":case"CURVE":O(k,"data",T)}if(Y=k.constraints)for(D=0;D<Y.length;D++)J=Y[D],J.target&&O(J,"target",T);var Q=k.lod_levels;if(Q)for(D=0;D<Q.length;D++){var Z=Q[D];Z.object&&O(Z,"object",T)}}for(I=0;I<s.length;I++)for(var ee=s[I].materials,D=0;D<ee.length;D++)O(ee,D,T);for(I=0;I<_.length;I++){for(var te=_[I],ae=te.texture_slots,D=0;D<ae.length;D++)O(ae[D],"texture",T);var ne=te.node_tree;ne&&S(ne,T)}for(I=0;I<c.length;I++)(ne=c[I].node_tree)&&S(ne,T);for(I=0;I<E.length;I++){var oe=E[I],ie=oe.type;"IMAGE"!=ie&&"ENVIRONMENT_MAP"!=ie||O(oe,"image",T)}for(I=0;I<o.length;I++){var _e=o[I];_e.dof_object&&O(_e,"dof_object",T)}for(I=0;I<h.length;I++){var se=h[I];se.sound&&O(se,"sound",T),(P=se.animation_data)&&y(P,T)}for(I=0;I<d.length;I++){for(var ce=d[I],ae=ce.texture_slots,D=0;D<ae.length;D++)O(ae[D],"texture",T);ce.dupli_group&&O(ce,"dupli_group",T),ce.dupli_object&&O(ce,"dupli_object",T)}for(I=0;I<v.length;I++)(P=v[I].animation_data)&&y(P,T);for(I=0;I<A.length;I++){var le=A[I];if(ae=le.texture_slots)for(D=0;D<ae.length;D++)O(ae[D],"texture",T);(P=le.animation_data)&&y(P,T),(ne=le.node_tree)&&S(ne,T)}ye.qM(e),b(e);for(var fe=$(t.Zh),ue=e.textures,de=t.Db?e.scenes[0].b4w_anisotropic_filtering:We.b4w_anisotropic_filtering,pe=0;pe<ue.length;pe++){var me=ue[pe];t.Db||"SCENE"!=me.b4w_source_type||(me.b4w_source_id="");var ge=Ie.XN(me,de,e.scenes,t.id,fe);me.G=ge}for(var he={},ve=e.objects,Ee=0;Ee<ve.length;Ee++){var Te=ve[Ee];if("MESH"===Te.type&&!Te.particle_systems.length)for(var Se=Te.data,Re=Se.name,Le=Se.submeshes,Ne=Se.materials,Ce=0;Ce<Le.length;Ce++)0!==Le[Ce].base_length||he[Re]||(Ne[Ce]&&xe.warn('material "'+Ne[Ce].name+'" is not assigned to any face (object "'+Te.name+'").'),he[Re]=!0)}var De=e.materials,ke=ye.lN();De.push(ke);for(var Pe=e.meshes,Ge=Ue.keysearch("name","DEFAULT",e.materials),Fe=0;Fe<Pe.length;Fe++){var je=Pe[Fe];0==je.materials.length&&je.materials.push(Ge)}for(var He=e.actions,Xe=t.id,ze=0;ze<He.length;ze++){var Ye=He[ze];Ye.ZK=Xe,re.gL(Ye)}for(var Ve={KF:[],gv:[]},Je=e.scenes,Ke=0;Ke<Je.length;Ke++)for(var Qe=Je[Ke],Ze=Je[Ke].objects,$e=0;$e<Ze.length;$e++)G(Qe,Ze,Ze[$e],null,Ve);for(Ke=0;Ke<Ve.gv.length;Ke++)for(var et=Ve.gv[Ke],$e=0;$e<et.zv.length;$e++){var tt=et.zv[$e],at=et.$F[$e],nt=et.CA[$e],ot=et.$z[$e];et.JF[$e].object=at;for(var it=0;it<ot.length;it++)Ue.wL(ot[it],at);for(var _t=tt,st=nt,ct=0;ct<st.length;ct++){for(var lt=st[ct].objects,ft=0;ft<lt.length;ft++){var ut=lt[ft].dupli_group;ut&&F(_t,ut)}var dt=lt.indexOf(_t);-1<dt&&lt.splice(dt,1)}}!t.Db&&1<e.scenes.length&&(e.scenes=[Oe.bu(e.scenes)],xe.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var pt=t.Db?We:Oe.bu(e.scenes);Me.iT(We.fps),1<e.scenes.length&&(e.scenes.splice(e.scenes.indexOf(We),1),e.scenes.unshift(We));for(var mt=0;mt<e.scenes.length;mt++){var gt=e.scenes[mt];gt.G={},gt.qC=gt==pt,gt.$K=t.Db;var ht;if(ht=Be.enabled){var vt;if(vt="OFF"!=gt.b4w_enable_physics){var bt;if(!(bt="AUTO"!=gt.b4w_enable_physics))e:{for(var Et=u(gt),At=0;At<Et.length;At++){if(Et[At].b4w_collision){bt=!0;break e}var xt=Et[At].data;if(xt.materials)for(var Tt=0;Tt<xt.materials.length;Tt++)if(xt.materials[Tt].b4w_collision){bt=!0;break e}}bt=!1}vt=bt}ht=vt}ht&&(t.Db||!Ae.Wv(We)&&gt==Oe.bu(e))&&Ae.xQ(gt)}for(var yt=0;yt<e.scenes.length;yt++){var St=e.scenes[yt];if(St.b4w_use_logic_editor){var Ot=u(St);ye.EL(Ot,St)}}for(var wt=0;wt<e.scenes.length;wt++){for(var Rt=e.scenes[wt],Lt=u(Rt),Nt=0;Nt<Lt.length;Nt++){var It=Lt[Nt];be.rM(It,Rt,e)&&(It.Tc||(It.Tc=[]),It.Tc.push(t.Db?Rt:We))}for(var Mt=Lt,Ct=0;Ct<Mt.length;Ct++){var Dt=Mt[Ct];if(Dt.Tc&&"WORLD"!=Dt.type)for(var Ut=Dt.particle_systems,kt=0;kt<Ut.length;kt++){var Pt=Ut[kt].settings;if("HAIR"==Pt.type)if("OBJECT"==Pt.render_type){var Gt=Pt.dupli_object;Gt.Tc||(Gt.Tc=Dt.Tc.slice())}else if("GROUP"==Pt.render_type)for(var Ft=Pt.dupli_group,jt=0;jt<Ft.objects.length;jt++)Gt=Ft.objects[jt],Gt.Tc||(Gt.Tc=Dt.Tc.slice())}}}for(var Bt=e.scenes,Ht=[],Xt=0;Xt<Bt.length;Xt++)p(Bt[Xt].objects,0,t.Db,Ht);for(qe[t.id]=[],Xt=0;Xt<Ht.length;Xt++)for(var qt=Ht[Xt],zt=0;zt<qt.length;zt++)for(var Wt=qt[zt],Yt=0;Yt<Wt.length;Yt++)qe[t.id].push(Wt[Yt]);for(var Vt=e.particles,Xt=0;Xt<Vt.length;Xt++){var Jt=Vt[Xt].dupli_object;Jt&&(Jt.pC=!0,qe[t.id].push(Jt));var Kt=Vt[Xt].dupli_group;if(Kt)for(var Qt=Kt.objects,zt=0;zt<Qt.length;zt++)Jt=Qt[zt],Jt.pC=!0,qe[t.id].push(Jt)}for(var Zt=qe[t.id],Xt=Zt.length-1;0<=Xt;Xt--)Zt[Xt].Tc||Zt.splice(Xt,1);for(var $t=qe[t.id],wt=0;wt<$t.length;wt++){if(It=$t[wt],!t.Db&&It.parent&&-1<rt.indexOf(It.parent.type)&&(It.parent=""),"MESH"==It.type){var ea=ye.zL(It);ea&&(e.meshes.push(ea),It.data=ea)}It.dn=be.CE(It,!1),It.Ci=be.WC(It)}for(wt=0;wt<$t.length;wt++){for(var It=$t[wt],ta=It.Ci,Nt=0;Nt<It.lod_levels.length;Nt++){var aa=It.lod_levels[Nt].object;aa&&(ta=ta||aa.Ci)}if(ta)for(It.Ci=!0,Nt=0;Nt<It.lod_levels.length;Nt++)(aa=It.lod_levels[Nt].object)&&(aa.Ci=!0)}for(var ra=0;ra<e.scenes.length;ra++){var na=e.scenes[ra],oa=na.world;oa.Tc||(oa.Tc=[]),oa.Tc.push(t.Db?na:We)}for(var ia=[],ra=0;ra<e.worlds.length;ra++)oa=e.worlds[ra],oa.Tc?(oa.dn=be.CE(oa,!0),oa.Ci=be.WC(oa)):ia.push(oa);for(ra=0;ra<ia.length;ra++)oa=ia[ra],e.worlds.splice(e.worlds.indexOf(oa),1);for(var _a=e.node_groups,sa=e.materials,ca=0;ca<_a.length;ca++){var la=_a[ca].node_tree;if(la){var fa=[];f(la,fa,!0),la.Ls=fa}}for(ca=0;ca<sa.length;ca++)(la=sa[ca].node_tree)&&(fa=[],f(la,fa,!1),la.Ls=fa);for(var ua=0;ua<e.scenes.length;ua++){var da=e.scenes[ua],pa=t.Db?da:We;m(t.id,pa,"SPEAKER").length&&!pa.Hc&&we.IL(pa)}n(t,a)}function l(e,t,a,r,n){r=$(t.Zh);for(var o=[],i=[],_=0;_<e.speakers.length;_++){var s=e.speakers[_],c=s.sound.uuid;if(-1==i.indexOf(c)){switch(i.push(c),s.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":var l=ne.AT_AUDIOBUFFER;break;case"BACKGROUND_MUSIC":l=ne.AT_AUDIO_ELEMENT}s=Ue.ji(r+s.sound.filepath),C(o,c,l,s,t.Tf)}}o.length?ne.enqueue(o,function(){},function(){n(t,a)}):n(t,a)}function f(e,t,a){e=e.nodes;for(var r=0;r<e.length;r++){var n=e[r],o=n.type;if("GROUP"==o&&n.node_group){if(n=n.node_group.node_tree)if(a)f(n,t,!0);else for(n=n.Ls,o=0;o<n.length;o++){var i=n[o];-1==t.indexOf(i)&&t.push(i)}}else-1!=ot.indexOf(o)&&-1==t.indexOf(o)&&t.push(o)}}function u(e){var t=[];return-1==e.objects.indexOf(e.camera)&&e.objects.push(e.camera),d(e.objects,"ALL",t),t}function d(e,t,a){for(var r=0;r<e.length;r++){var n=e[r];"ALL"!=t&&t!=n.type||a.push(n),(n=n.dupli_group)&&d(n.objects,t,a)}}function p(e,t,a,r){r[t]=r[t]||[];for(var n=r[t],o=0;o<e.length;o++){var i=e[o],_=te(i);n[_]=n[_]||[],(a||-1==rt.indexOf(i.type))&&-1==n[_].indexOf(i)&&n[_].push(i),(i=i.dupli_group)&&p(i.objects,t+1,a,r)}}function m(e,t,a){var r=[];e=qe[e];for(var n=0;n<e.length;n++){var o=e[n];if(o.type==a||"ALL"==a)for(var i=0;i<o.Tc.length;i++)t==o.Tc[i]&&r.push(o)}return r}function g(e,t,a,r,n){var o=qe[t.id],i=e.worlds;r=t.id;for(var _=0;_<o.length;_++){for(var s=o[_],c=Ee.qn(s.name,s.type,s.origin_name),l=0;l<s.Tc.length;l++)Ee.Bp(c,s.Tc[l]);s.Xa=c,be.$k(s,c),c.o.Rd=r}for(r=0;r<i.length;r++){for(_=i[r],s="%meta_world%"+_.name,s=Ee.qn(s,"WORLD",s),c=0;c<_.Tc.length;c++)Ee.Bp(s,_.Tc[c]);_.Xa=s,be.cV(_,s)}for(r=be.get_all_objects("ALL",t.id),_=0;_<o.length;_++)s=o[_],c=s.Xa,me.$k(s,c);for(_=0;_<i.length;_++)s=i[_],me.$k(s,s.Xa);for(t.Db&&h(e,t.id),_=0;_<o.length;_++)s=o[_],c=s.Xa,c.Uq||(_e.iS(s,c),be.OU(s,c),Ce.O(c)),"MESH"==c.type&&be.lP(s,c);for(e=0;e<o.length;e++)if(l=o[e],_=l.Xa,i=_.o,Ee.is_mesh(_)||Ee.is_empty(_)){var f=l.lod_levels.length;if(f){for(var _=[l],s=[0],u=1/0,c=0;c<f;c++){var d=l.lod_levels[c].object,p=l.lod_levels[c].distance;if(!d){u=p;break}_.push(d),s.push(p)}for(s.push(u),c=0;c<_.length;c++)d=_[c],l=d.Xa.o,l.cj=!0,"DYNAMIC"==i.type&&0<c&&ke.subtract(i.Pd.N,l.Pd.N,l.jv),l.Vf=s[c],l.Uf=s[c+1],f=s[c+1]-s[c],u=c==_.length-1?1/0:s[c+2]-s[c+1],l.ij=Math.min(c?s[c]-s[c-1]:0,f),l.jj=Math.min(f,u)}}for(o=0;o<r.length;o++)if(e=r[o],"MESH"==e.type&&(i=e.Ss)){var m,i=i.o,_=e.o.Oh,s=[];for(m in _)c=_[m],s.push(4*c.wy,4*c.Nh);i.nv.push(s),i.Go.push(e.o)}for(o=m=-1,e=re.GE(),i=0;i<r.length;i++)_=r[i],s=_.o,Ee.is_mesh(_)&&s.qk&&(_=s.mh,_>m&&(m=_),e>=_&&_>o&&(o=_));for(i=0;i<r.length;i++)_=r[i],s=_.o,Ee.is_mesh(_)&&s.qk&&(s.Sl=!0,m<e?s.mh=m:s.mh<=e?s.mh=o:(xe.warn('too many bones for "'+_.name+'" / '+s.mh+" bones (max "+e+" with blending, "+2*e+" without blending). Blending between frames will be disabled."),s.mh=m,s.Sl=!1),s.Sl=s.Sl&&!Ge.nE);for(m=0;m<r.length;m++)if(o=r[m],o.hf)if(e=o.tf,"CHASSIS"==e.mf){for(o.J={},o.J.Fq=e.Fq,o.J.Qp=e.Qp,o.J.YA=e.YA,o.J.$A=e.$A,o.J.ZA=e.ZA,o.J.CB=e.CB,o.J.yA=e.yA,o.J.Hz=e.Hz,o.J.En=0,o.J.Pp=1,o.J.Qo=0,o.J.speed=0,o.J.vm=[],o.J.wr=[],o.J.So=null,_=(i=Ee.get_dg_parent(o))?Ee.Qy(i,r):r,i=0;i<_.length;i++)s=_[i],s.hf&&(c=s.tf,Ae.DQ(s)&&e.name==c.name?(c=Ae.CV(s.tf.mf),o.J.vm[c]=s,o.J.wr[c]=new Float32Array(8)):Ae.tF(s)&&e.name==c.name?(o.J.So=s,o.J.Ro=c.Ro,o.J.Tr=c.Tr,o.J.Tq=c.Tq,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.DH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.CH=c):Ae.sF(s)&&e.name==c.name?(o.J.QA=s,o.J.Rr=c.Rr,o.J.co=c.co,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.yH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.xH=c):Ae.uF(s)&&e.name==c.name&&(o.J.aB=s,o.J.tq=c.tq,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.MH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.LH=c));4!=o.J.vm.length&&Ue.F("Not enough wheels for chassis "+o.name)}else if("HULL"==e.mf)for(o.J={},o.J.vm=[],o.J.wr=[],o.J.Fq=e.Fq,o.J.Qp=e.Qp,o.J.Pl=e.Pl,o.J.Sm=e.Sm,o.J.Tm=e.Tm,o.J.En=0,o.J.Pp=1,o.J.Qo=0,o.J.speed=0,o.J.So=null,_=(i=Ee.get_dg_parent(o))?Ee.Qy(i,r):r,i=0;i<_.length;i++)s=_[i],s.hf&&(c=s.tf,Ae.CQ(s)&&e.name==c.name?(o.J.vm.push(s),o.J.wr.push(new Float32Array(8))):Ae.tF(s)&&e.name==c.name?(o.J.So=s,o.J.Ro=c.Ro,o.J.Tr=c.Tr,o.J.Tq=c.Tq,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.DH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.CH=c):Ae.sF(s)&&e.name==c.name?(o.J.QA=s,o.J.Rr=c.Rr,o.J.co=c.co,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.yH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.xH=c):Ae.uF(s)&&e.name==c.name&&(o.J.aB=s,o.J.tq=c.tq,c=De.invert(o.o.v,De.create()),s=De.multiply(c,s.o.v,c),o.J.MH=s,c=new Float32Array([1,0,0]),De.transform_dir_vec3(c,s,c),o.J.LH=c));for(m=0;m<r.length;m++)if(o=r[m],o.dm&&(e=o.In,"MAIN_BODY"==e.mf))for(o.vg={},o.vg.Pl=e.Pl,o.vg.Sm=e.Sm,o.vg.Tm=e.Tm,o.vg.dt=[],i=(i=Ee.get_dg_parent(o))?Ee.Qy(i,r):r,_=0;_<i.length;_++)s=i[_],s.dm&&(c=s.In,Ae.FQ(s)&&e.name==c.name&&(o.vg.dt.push(s),s.Rx=s.In.KH));n(t,a)}function h(e,t){for(var a=0;a<e.scenes.length;a++){for(var r=e.scenes[a],n=be.Hb(r,"LAMP",t),o=Array(n.length),i=0;i<n.length;i++)o[i]=i;for(o.sort(function(e,t){var a=n[e].wb,r=n[t].wb;return r.Im&&r.Mm&&(!a.Im||!a.Mm)||!a.Im&&(r.Im||!a.Mm&&r.Mm)?1:0}),i=0;i<o.length;i++)Ee.ya(n[o[i]],r).cr=i}}function v(e,t,a,r,n){for(r=0;r<e.scenes.length;r++){var o=e.scenes[r];o.Bi=o.camera.Xa}for(r=0;r<e.scenes.length;r++){var o=t.Db?e.scenes[r]:We,i=t.Db?be.Hb(o,"LAMP",t.id):be.Hb(o,"LAMP",0),_=be.Hb(o,"ALL",t.id),s=m(t.id,o,"MESH"),c=m(t.id,o,"EMPTY");t.Db&&Oe.nL(o,_,i,s,c);for(var _=!1,l=0;l<c.length;l++)for(var f=c[l].Xa,u=f.K,d=0;d<u.length;d++){var p=u[d].eb,g=Oe.eI(p,f);o.name==p.name&&(_=_||g)}for(t.Db&&o.G.hd&&!_&&xe.warn('Scene "'+o.name+'" has water but has no wind. Using default settings.'),c=[],Oe.set_active(o),oe.vE(o,s,i,c),l=be.Hb(o,"LINE",t.id),oe.uE(o,l),f=Oe.ru(o),t.Db&&(_=o.G.kw,l=o.world,(_.FG||_.procedural_skydome)&&(u=l.Xa,oe.rL(o,_,u),oe.Ct(u,f,o)),Oe.sE(o,f),(_=o.G.jl)&&(_.ls||_.Wd)&&oe.kL(o,l.Xa)),l=0;l<s.length;l++)oe.Ct(s[l].Xa,f,o);for(l=0;l<c.length;l++)oe.Ct(c[l],f,o),be.MR(c[l]);for(_=be.Hb(o,"ALL",t.id),Oe.DC(o,_,i),l=0;l<_.length;l++)f=_[l],f.o.Me&&!f.jF&&be.update_boundings(f),Ee.xM(f)&&(f.YF=!0),be.KU(f,o)}Oe.oL(We,e.textures,t.id),t.Db&&We.G.jp.length&&(t.gz=!0),n(t,a)}function b(e){var t=e.materials;e=e.images;for(var a=0;a<e.length;a++){var r=e[a];r.kg="FILE"==r.source&&-1<r.filepath.indexOf(".dds")&&"dds"==Fe.Cl?"dds":""}if((je.vy&&"dds"==Fe.Cl||je.Rv&&"pvr"==Fe.Cl)&&Fe.oI)for(e=0;e<t.length;e++){for(var r=t[e],n=r.texture_slots,a=0;a<n.length;a++){var o=n[a],i=o.texture;if("IMAGE"==i.type||"ENVIRONMENT_MAP"==i.type){var _=i.image;_&&!_.kg&&(o=!i.b4w_disable_compression&&!o.use_map_normal&&"ENVIRONMENT_MAP"!=i.type&&!i.b4w_shore_dist_map&&"MOVIE"!=_.source,E(_,o))}}if(a=r.node_tree)for(r=a.nodes,a=0;a<r.length;a++){if(n=r[a],o=!1,"TEXTURE"==n.type){if((i=n.texture)&&(_=i.image)&&!_.kg&&(o=!i.b4w_disable_compression&&"MOVIE"!=i.image.source&&"ENVIRONMENT_MAP"!=i.type)){e:{for(o=n.outputs,n=0;n<o.length;n++)if(i=o[n],i.is_linked&&"Normal"==i.identifier){o=!0;break e}o=!1}o=!o}}else"TEX_IMAGE"==n.type?(_=n.image)&&!_.kg&&(o="MOVIE"!=_.source):"TEX_ENVIRONMENT"==n.type&&(o=!1);_&&!_.kg&&E(_,o)}}}function E(e,t){-1<e.filepath.indexOf(".dds")?e.kg="dds":t?(e.kg=Fe.Cl,e.filepath="dds"==Fe.Cl?e.filepath+".dds":e.filepath+".pvr"):e.kg=""}function A(e,t,a,r,n){r=e.groups;for(var o=e.objects,i={},_={},s={},c={},l=0;l<r.length;l++){var f=r[l];i[f.uuid]=f,s[f.uuid]=f}for(l=0;l<o.length;l++)f=o[l],_[f.uuid]=f,c[f.uuid]=f;for(e=e.scenes,l=0;l<e.length;l++)x(e[l].objects,null,c,s,null);for(var u in s)u in i||r.push(s[u]);for(u in c)u in _||o.push(c[u]);n(t,a)}function x(e,t,a,r,n){for(var o=[],i=0;i<e.length;i++){var _=e[i],s=a[_.uuid];if(_=s.proxy){t&&-1==o.indexOf(_.uuid)&&o.push(_.uuid);for(var c=a[_.uuid],l=c.constraints,_=0;_<l.length;_++){var f=Ue.P(l[_]);f.name=f.name+"_CLONE",s.constraints.push(f)}"b4w_proxy_inherit_anim"in s&&!s.b4w_proxy_inherit_anim||(s.animation_data&&(c.animation_data=Ue.P(s.animation_data)),c.b4w_use_default_animation=s.b4w_use_default_animation,c.b4w_auto_skel_anim=s.b4w_auto_skel_anim,c.b4w_anim_behavior=s.b4w_anim_behavior,c.b4w_cyclic_animation=s.b4w_cyclic_animation)}}for(i=0;i<o.length;i++)-1<(s=Ue.QP(e,o[i]))&&e.splice(s,1);if(o={},t)for(i=0;i<e.length;i++)_=e[i],s=a[_.uuid],l=Ue.P(s),c="origin_name"in s?s.origin_name:s.name,l.name=Ee.rE(t.name,c),l.origin_name=c,l.dg_parent={uuid:t.uuid},T(l),a[l.uuid]=l,o[_.uuid]=l.uuid,_.uuid=l.uuid,n&&n[s.uuid]&&(l.b4w_cluster_data=n[s.uuid]);for(i=0;i<e.length;i++)_=e[i],s=a[_.uuid],s.dupli_group&&(_=s.dupli_group,n=r[_.uuid],l=Ue.P(n),l.name=Ue.cs(n.name+"_CLONE"),l.uuid=pe.YE("Group"+l.name),r[l.uuid]=l,_.uuid=l.uuid,x(l.objects,s,a,r,s.b4w_cluster_data));if(t)for(i=0;i<e.length;i++){_=e[i],s=a[_.uuid],s.parent&&s.parent.uuid in o?s.parent.uuid=o[s.parent.uuid]:s.parent&&(xe.warn("Object's \""+s.name+'" parent is not in dupli group. Disabling parenting.'),s.parent=null),l=s.constraints;for(_=0;_<l.length;_++)t=l[_],t.target&&t.target.uuid in o&&(t.target.uuid=o[t.target.uuid]);if(t=s.pose)for(r=t.bones,_=0;_<r.length;_++)if(n=r[_].constraints)for(l=0;l<n.length;l++)t=n[l],t.target&&t.target.uuid in o&&(t.target.uuid=o[t.target.uuid]);for(t=s.modifiers,_=0;_<t.length;_++)r=t[_],r.object&&r.object.uuid in o&&(r.object.uuid=o[r.object.uuid]);if((s=s.lod_levels)&&s.length)for(_=0;_<s.length;_++)t=s[_],t.object&&t.object.uuid in o&&(t.object.uuid=o[t.object.uuid])}for(var u in o)Ye[u]=o[u]}function T(e){e.uuid=pe.YE("Object"+e.name)}function y(e,t){if(e.action&&O(e,"action",t),e.nla_tracks)for(var a=0;a<e.nla_tracks.length;a++)for(var r=e.nla_tracks[a],n=0;n<r.strips.length;n++)r.strips[n].action&&O(r.strips[n],"action",t)}function S(e,t){for(var a=e.nodes,r=0;r<a.length;r++){var n=a[r];"TEXTURE"==n.type&&n.texture&&O(n,"texture",t),"LAMP"==n.type&&n.lamp&&(n.lamp.uuid in Ye&&(n.lamp.uuid=Ye[n.lamp.uuid]),t[n.lamp.uuid]||(n.lamp=null)),"GROUP"==n.type&&n.node_group&&O(n,"node_group",t),"TEX_IMAGE"!=n.type&&"TEX_ENVIRONMENT"!=n.type||!n.image||O(n,"image",t)}for(n=e.links,r=0;r<n.length;r++){var o=n[r];w(o,"from_node",a),w(o,"to_node",a),R(o,"from_socket",o.from_node.outputs),R(o,"to_socket",o.to_node.inputs)}(a=e.animation_data)&&y(a,t)}function O(e,t,a){e[t]&&((a=a[e[t].uuid])||xe.error("Dangling link found:",t,e),e[t]=a)}function w(e,t,a){a=Ue.keysearch("name",e[t].name,a),e[t]=a}function R(e,t,a){a=Ue.keysearch("identifier",e[t].identifier,a),e[t]=a}function L(e,t,a,n,o,i){var _=[],s=[],c={};n=e.images;for(var l=Ie.FE(),f=$(t.Zh),u=0;u<n.length;u++){var d=n[u],p=d.uuid;if(p){var m=Ue.ji(f+d.filepath),g=ne.sw(m),h=g[1].toLowerCase(),v=d.source;if("FILE"===v){if(v=d.kg?ne.AT_ARRAYBUFFER:ne.AT_IMAGE_ELEMENT,!ne.wM(h)){xe.error('image "'+d.name+'" has unsupported format or broken path.');continue}je.Lz&&Fe.use_min50&&(m=N(g))}else{if("MOVIE"!==v){xe.error('Image "'+d.name+'" has unsupported format "'+v+'".');continue}if(Fe.Jr)m=g[0]+".altconv.seq",v=ne.AT_SEQ_VIDEO_ELEMENT;else{if(""==(v=we.detect_video_container(h))){xe.error("failed to load video file (unsupported format)",m);continue}m=v!=h?g[0]+".altconv."+v:g[0]+"."+g[1],v=ne.AT_VIDEO_ELEMENT}}p in c||(c[p]=[]);for(g=0;g<l.length;g++)h=l[g],(!Ie.vP(h)&&h.ik==d.kg&&h.Yl==p||t.Tf)&&c[p].push(h);d.kg&&Fe.assets_gzip_available&&(v=ne.AT_ARRAYBUFFER_ZIP,m+=".gz"),c[p].length&&_.push({id:p,type:v,url:m,ie:t.Tf})}}if(_.length){var b=0,E=function(n,o,l,f){if(n){if(t.Tf)o=l;else{o=c[o];for(var u=0;u<o.length;u++){var d=o[u];if(l==ne.AT_SEQ_VIDEO_ELEMENT)d.Hr=n.gh,Ie.fs(d,n.images,t.id);else if(Ie.fs(d,n,t.id),"ENVIRONMENT_MAP"==d.source&&t.Db)for(var p=0;p<e.scenes.length;p++)Oe.Ow(e.scenes[p]);Ie.$S(d)}o=o[0].ik}l==ne.AT_VIDEO_ELEMENT||l==ne.AT_SEQ_VIDEO_ELEMENT?(l==ne.AT_VIDEO_ELEMENT?(o=n.videoWidth,n=n.videoHeight):(o=n.images[0].width,n=n.images[0].height),xe.log("%cLOAD VIDEO "+o+"x"+n,"color: #"+(2048<o||2048<n?"a00":1024<o||1024<n?"aa0":"0a0"),f),-1==f.indexOf(ze)&&xe.warn("video",f,"is not from app root.")):r(n,f,!0,o)}else{e:{if(n=t.Tf,f=f.split("?v")[0],l=ne.sw(f),"gz"==l[1])f=l[0],l=ne.AT_ARRAYBUFFER;else if("dds"==l[1]||"pvr"==l[1])for(f=l[0],l=ne.AT_IMAGE_ELEMENT,u=c[o],d=0;d<u.length;d++)u[d].ik="";else{if(-1==f.indexOf(".min50")){o=null;break e}f=f.split(".min50"),f=f[0]+f[1],l=ne.AT_IMAGE_ELEMENT}o={id:o,type:l,url:f,ie:n}}o&&(xe.warn("Trying to load fallback image",o.url),s.push(o))}o=++b/(_.length+s.length),i(t,a,o)},A=function(){s.length?(ne.enqueue(s,E,A),s.length=0):(xe.log("%cLOADED ALL IMAGES","color: #0a0"),o(t,a))};ne.enqueue(_,E,A)}else o(t,a)}function N(e){return"dds"==e[1]?(e=ne.sw(e[0]),e[0]+".min50."+e[1]+".dds"):e[0]+".min50."+e[1]}function I(e,t,a,r,n){for(e=Oe.vu(),r=0;r<e.length;r++){var o=e[r];if(o.b4w_use_nla){var i=o.b4w_nla_cyclic;o.b4w_use_logic_editor&&(i=!1),me.VU(o,i,t.id)}}n(t,a)}function M(e,t,a,r,n,o){e=$(t.Zh);var i=[],_={};r=be.get_all_objects("ALL",t.id);for(var s=0;s<r.length;s++){var c=r[s];if(D(c)){var l=c.Z.Kj;if("BACKGROUND_MUSIC"==we.Uy(c)?(l=Ue.lu(),t.dz=!0):"NONE"!=we.Uy(c)&&Fe.lz&&(t.kz=!0),!(l in _)){_[l]=[];var f=Ue.ji(e+c.Z.Zh);switch(we.wH(c)){case we.kx:var u=ne.AT_AUDIOBUFFER;break;case we.FB:u=ne.AT_AUDIO_ELEMENT}C(i,l,u,f,t.Tf)}_[l].push(c)}}if(i.length){var d=0;ne.enqueue(i,function(e,r,n,s){if(e)for(xe.log("%cLOAD SOUND","color: #0aa",s),-1==s.indexOf(ze)&&xe.warn("sound",s,"is not from app root."),r=_[r],n=0;n<r.length;n++)we.$U(r[n],e);e=++d/i.length,o(t,a,e)},function(){xe.log("%cLOADED ALL SOUNDS","color: #0aa"),n(t,a)})}else n(t,a)}function C(e,t,a,r,n){var o=ne.sw(r),i=o[1].toLowerCase(),_=we.detect_audio_container(i);""!=_?(r=_!=i?o[0]+".altconv."+_:o[0]+"."+o[1],e.push({id:t,type:a,url:r,ie:n})):xe.error("failed to load audio file (unsupported format)",r)}function D(e){return Ee.is_speaker(e)&&we.wH(e)!=we.GB}function U(e,t,a){for(e=be.Hb(e,"SPEAKER",t),t=0;t<e.length;t++){var r=e[t];Ee.is_speaker(r)&&(we.BQ(r)||a)&&we.play_def(r)}}function k(e,t){for(var a=e.G.jp,r=0;r<a.length;r++){var n=a[r].G;e.b4w_use_nla&&a[r].b4w_nla_video||!a[r].use_auto_refresh||t!=n.ss||(Ie.reset_video(n),Ie.play_video(n))}}function P(e,t,a,r,n){me.start(),xe.log("%cSTART NLA","color: #0a0"),n(t,a)}function G(e,t,a,r,n){for(var o=a.lod_levels.length,i=0;i<o;i++){var _=a.lod_levels[i],s=_.object;if(s){var c=n.KF.indexOf(a);if(-1==c){n.KF.push(a);var l={zv:[],$F:[],JF:[],CA:[],$z:[]};n.gv.push(l)}else l=n.gv[c];var f=l.zv.indexOf(s);-1!=c&&-1!=f?(l.CA[f].push(e),l.$z[f].push(t)):(c=Ue.aq(s),c.name=a.name+"_LOD_"+String(i+1),c.b4w_cluster_data=a.b4w_cluster_data,T(c),c.lod_levels=[],r&&(c.dg_parent=r),l.zv.push(s),l.$F.push(c),l.JF.push(_),l.CA.push([e]),l.$z.push([t]))}}if(t=a.dupli_group)for(t=t.objects,r=0;r<t.length;r++)G(e,t,t[r],a,n)}function F(e,t){var a=t.objects,r=a.indexOf(e);for(-1<r&&a.splice(r,1),r=0;r<a.length;r++)(t=a[r].dupli_group)&&F(e,t)}function j(e,t,a,r,n){r=!0;for(var o=0;o<e.scenes.length;o++)if(!Ae.AM(e.scenes[o])){r=!1;break}r&&(n(t,a),xe.log("%cPHYSICS READY","color: #0a0"))}function B(e,t,a,r,n){for(r=0;r<e.scenes.length;r++){var o=e.scenes[r];if(t.Db)var i=Ae.Wv(o);else i=Ae.Wv(We)||Ae.Wv(o),o=We;if(Be.enabled&&i)for(i=0;i<nt.length;i++)for(var _=be.Hb(o,nt[i],t.id),s=0;s<_.length;s++){var c=_[s];c.o.Rd==t.id&&(Ae.append_object(c,o),t.FF&&Ae.na(c)&&Ae.disable_simulation(c))}}n(t,a)}function H(e,t,a,n,o){var i={};n=[];for(var _=e.scenes,s=0;s<e.scenes.length;s++){var c=_[s];if(c.G.hd){var l=c.G.hd.Mk;if(l&&"FILE"===l.source){var c=l.uuid,f=Ue.ji($(t.Zh)+l.filepath);n.push({id:c,type:l.kg?ne.AT_ARRAYBUFFER:ne.AT_IMAGE_ELEMENT,url:f}),i[c]=l}}}n.length?ne.enqueue(n,function(e,a,n,o){if(e){r(e,o,!0),n=[],o=Ie.FE();for(var s=0;s<o.length;s++){var c=o[s];c.uri===a&&n.push(c)}for(a=0;a<n.length;a++)Ie.fs(n[a],e,t.id);for(a=0;a<_.length;a++)if(n=_[a],n.G.hd&&(o=n.G.hd.Mk)===l){var c=e,f=document.createElement("canvas");o=l.size[0],s=l.size[1],f.width=o,f.height=s,f=f.getContext("2d"),f.drawImage(c,0,0),c=f.getImageData(0,0,o,s).data,f=new Float32Array(4),f[0]=1/16581375,f[1]=1/65025,f[2]=1/255,f[3]=1,o*=s;for(var s=new Float32Array(o),u=0;u<o;u++)s[u]=f[1]*c[4*u+2]+f[2]*c[4*u+3];n.G.MA=s}}else for(e=i[a],a=0;a<_.length;a++)n=_[a],(o=n.G.hd.Mk)===e&&(n.G.hd.Mk=null,xe.warn("image",o.filepath," was not found. Disabling water shore effects."))},function(){o(t,a)}):o(t,a)}function X(e,t,a,n,o){n=e.scenes[0],e=[];for(var i=[Le.Bs,Le.vp,Le.Cs,Le.xx],_=0;_<i.length;_++){var s=Oe.Ib(n,i[_]);s&&e.push(s)}if(e.length){for(n=[],_=ne.AT_IMAGE_ELEMENT,n.push({id:"SEARCH_TEXTURE",type:_,url:ie.Ie.smaa_search_texture_path,ie:t.Tf}),n.push({id:"AREA_TEXTURE",type:_,url:ie.Ie.smaa_area_texture_path,ie:t.Tf}),_=0;_<e.length;_++)if(i=e[_],i.type==Le.vp){for(e=i.Sa,_=0;_<e.length;_++)if(i=e[_],"u_search_tex"==i.to)var c=i.Ma;else if("u_area_tex"==i.to)var l=i.Ma;break}n.length?ne.enqueue(n,function(e,a,n,o){e&&(r(e,o,!1),a="SEARCH_TEXTURE"==a?c:l,a.source="IMAGE",Ie.fs(a,e,t.id),Ie.FA(a,Ie.L,Ie.L))},function(){o(t,a)}):o(t,a)}else o(t,a)}function q(e,t,a,r){for(a=0;a<e.scenes.length;a++){var n=e.scenes[a];t.Db||(n=We);for(var o=be.Hb(n,"LAMP",t.id),i=0;i<o.length;i++){var _=o[i];_.o.Rd==t.id&&r.Fx.push({eb:n,obj:_})}for(o=be.Hb(n,"ALL",t.id),i=0;i<o.length;i++)_=o[i],"LAMP"!=_.type&&_.o.Rd==t.id&&(t.FF&&Ee.is_mesh(_)&&Oe.Wp(_,!0),r.Fx.push({eb:n,obj:_}))}}function z(e,t,a,r,n,o){var i=r.Fx;if(n=r.fG,i.length){e=i[n].obj;var _=i[n].eb;if(n=Ee.ya(e,_),Oe.append_object(_,e),e.anchor&&!_.G.anaglyph_use&&ae.append(e),r=++r.fG/i.length,e.o.ZE&&Oe.Xp(e,!0),i=n.Ri,-1!=e.o.Qd&&i){var s=ke.copy(e.o.Pd.N,Ve);Oe.dI(i,s)}if(i=e.Cr,i.length&&_.G.wh)for(_=De.get_trans_view(e.o.v),e=De.get_quat_view(e.o.v),n=n.li,s=0;s<n.length;s++)Oe.fI(n[s],_,e),Ee.gI(i,n[s].B.nc)}else r=1;o(t,a,r)}function W(e,t,a,r,n){if(t.Db){e=Oe.jh(),Oe.Ow(e),r=Oe.vu();for(var o=0;o<r.length;o++){var i=r[o];Oe.Ow(i),Oe.jS(i,e)}Oe.set_active(e)}else Oe.iI(We);e=be.get_all_objects("ALL",t.id),be.PU(e),n(t,a)}function Y(e,t,a,r,n){if(t.Db)for(e=Oe.vu(),r=0;r<e.length;r++)for(var o=e[r],i=be.Hb(o,"WORLD",0),_=0;_<i.length;_++)Oe.vQ(o,i[_]),Oe.Ow(o);n(t,a)}function V(e,t,a,r,n){if(t.Db)for(e=Oe.vu(),r=0;r<e.length;r++){var o=e[r];o.b4w_use_logic_editor&&ge.wQ(o,t.id)}n(t,a)}function J(e,t,a,r,n){if(t.Db)for(r=0;r<e.scenes.length;r++)k(e.scenes[r],t.id),U(e.scenes[r],t.id,!1);else k(We,t.id),U(We,t.id,!1);n(t,a)}function K(e,t,a,r,n){for(r=0;r<e.scenes.length;r++)e.scenes[r].camera=null;Fe.media_auto_activation&&(t.gz||t.dz||t.kz)?Ze||Q(e,n,t,a):n(t,a)}function Q(e,t,a,r){var n=it.parentElement;et=n.style.zIndex,n.style.zIndex="999",Ze=document.createElement("div"),Ze.style.position="relative",Ze.style.height="88px",Ze.style.width="88px";var o=Math.round(it.offsetWidth/2-44);Ze.style.top=Math.round(it.offsetHeight/2-44).toString()+"px",Ze.style.left=o.toString()+"px",Ze.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')",Ze.style.backgroundSize="88px",$e=document.createElement("div"),$e.style.position="relative",$e.style.height=it.offsetHeight.toString()+"px",$e.style.width=it.offsetWidth.toString()+"px",$e.style.background="rgba(0, 0, 0, 0.5)",$e.style.zIndex="999",n.appendChild($e),$e.appendChild(Ze),at=function(){if(a.gz&&(Ie.play(),Ie.pause(),Ie.reset()),a.dz){if(a.Db)for(var n=0;n<e.scenes.length;n++)U(e.scenes[n],a.id,!0);else U(We,a.id,!0);we.pause()}a.kz&&we.rG(),Z(),t(a,r)},ue.add_click_listener(Ze,at)}function Z(){if(Ze){var e=it.parentElement;e.style.zIndex=et,ue.remove_click_listener(Ze,at),$e.removeChild(Ze),e.removeChild($e),Ze=$e=null,et=0}}function $(e){return(e=e.split("/").slice(0,-1).join("/"))&&(e+="/"),e}function ee(e){re.is_animated(e)&&re.remove(e),he.tS(e),be.clear_outline_anim(e),se.check_sensor_manifold(e)&&se.remove_sensor_manifold(e),Ae.na(e)&&Ae.remove_object(e),Oe.EG(e),Ee.is_speaker(e)&&we.RT(e),ae.is_anchor(e)&&ae.remove(e)}function te(e){var t=re.BE(e);return(e=t&&t.parent==e?null:e.parent||t)?1+te(e):0}var ae=t("__anchors"),re=t("__animation"),ne=t("__assets"),oe=t("__batch"),ie=t("__config"),_e=t("__constraints"),se=t("__controls"),ce=t("__texcomp"),le=t("__debug"),fe=t("__extensions"),ue=t("__input"),de=t("__loader"),pe=t("__md5"),me=t("__nla"),ge=t("__logic_nodes"),he=t("__particles"),ve=t("__nodemat"),be=t("__objects"),Ee=t("__obj_util"),Ae=t("__physics"),xe=t("__print"),Te=t("__quat"),ye=t("__reformer"),Se=t("__renderer"),Oe=t("__scenes"),we=t("__sfx"),Re=t("__shaders"),Le=t("__subscene"),Ne=t("__tbn"),Ie=t("__textures"),Me=t("__time"),Ce=t("__transform"),De=t("__tsr"),Ue=t("__util"),ke=t("__vec3"),Pe=t("__vec4"),Ge=ie.sl,Fe=ie.H,je=ie.Od,Be=ie.I,He=ie.Z,Xe=null,qe=null,ze="",We=null,Ye={},Ve=new Float32Array(3),Je=new Float32Array(4),Ke=new Float32Array(4),Qe=Ne.create(),Ze=null,$e=null,et=0,tt=!1,at=null,rt=["LAMP"],nt=["MESH","CAMERA","EMPTY"],ot=["BSDF_GLOSSY","BSDF_DIFFUSE","BSDF_TRANSPARENT"],it=null;e.is_primary_loaded=function(e){return de.is_primary_loaded(e)},e.update=function(){de.WU(Xe)},e.ET=function(e){it=e},e.MU=function(e,t){if(Ze){$e.style.height=t.toString()+"px",$e.style.width=e.toString()+"px";var a=Math.round(e/2-44);Ze.style.top=Math.round(t/2-44).toString()+"px",Ze.style.left=a.toString()+"px"}},e.load=function(e,t,r,s,l){var f={load_main:{Eb:de.hg,Kb:!1,inputs:[],Lb:!1,Sb:500,dc:!1,Ub:n},duplicate_objects:{Eb:de.be,Kb:!1,inputs:["load_main"],Lb:!1,Sb:50,dc:!1,Ub:A},load_binaries:{Eb:de.hg,Kb:!1,inputs:["load_main"],Lb:!1,Sb:500,dc:!1,Ub:o},wait_for_shaders:{Eb:de.be,Kb:!1,inputs:[],Lb:!1,Sb:50,dc:!0,Uj:i},prepare_bindata:{Eb:de.be,Kb:!1,inputs:["duplicate_objects","load_binaries"],Lb:!1,Sb:100,dc:!1,Ub:_},prepare_bpy_data:{Eb:de.be,Kb:!1,inputs:["duplicate_objects","prepare_bindata"],Lb:!1,Sb:100,dc:!1,Ub:c},process_objects:{Eb:de.be,Kb:!1,inputs:["prepare_bpy_data"],Lb:!1,Sb:150,dc:!1,Ub:g},process_scenes:{Eb:de.be,Kb:!1,inputs:["process_objects","wait_for_shaders"],Lb:!1,Sb:300,dc:!1,Ub:v},load_smaa_textures:{Eb:de.hg,Kb:!1,inputs:["process_scenes"],Lb:!1,Sb:30,dc:!0,Ub:X},load_shoremap:{Eb:de.hg,Kb:!1,inputs:["process_scenes"],Lb:!1,Sb:30,dc:!0,Ub:H},load_images:{Eb:de.hg,Kb:!0,inputs:["process_scenes"],Lb:!0,Sb:500,dc:!1,Ub:L},update_scenes_nla:{Eb:de.be,Kb:!1,inputs:["process_scenes","load_images"],Lb:!1,Sb:50,dc:!1,Ub:I},wait_physics_workers:{Eb:de.be,Kb:!1,inputs:["load_shoremap"],Lb:!1,Sb:20,dc:!1,Uj:j},add_physics_objects:{Eb:de.be,Kb:!1,inputs:["wait_physics_workers"],Lb:!1,Sb:50,dc:!1,Ub:B},add_objects:{Eb:de.be,Kb:!1,inputs:["add_physics_objects"],Lb:!1,Sb:600,dc:!1,Ub:q,Uj:z,Up:W,Vp:{Fx:[],fG:0}},init_cube_sky_dynamic_props:{Eb:de.be,Kb:!1,inputs:["add_objects","load_images"],Lb:!1,Sb:50,dc:!1,Ub:Y},init_logic_nodes:{Eb:de.be,Kb:!1,inputs:["update_scenes_nla","add_objects"],Lb:!1,Sb:50,dc:!1,Ub:V},load_speakers:{Eb:de.hg,Kb:!0,inputs:["add_objects"],Lb:!0,Sb:100,dc:!1,Ub:M},mobile_media_start:{Eb:de.be,Kb:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Lb:!0,Sb:5,dc:!1,Ub:K,Uj:K},synchronize_media:{Eb:de.be,Kb:!0,inputs:["mobile_media_start"],Lb:!0,Sb:50,dc:!1,Ub:J},start_nla:{Eb:de.be,Kb:!0,inputs:["mobile_media_start"],Lb:!1,Sb:5,dc:!0,Ub:P}},u=de.Ty();return u||(u=de.ID(),Xe={},qe={},Ye={}),Xe[u.sf.length]={},de.MD(f,e,t,r,a,s||He.GC,Fe.do_not_load_resources,l,!1)},e.unload=function(e){var t=de.Ty();if(!t||!t.sf.length||e&&!de.jU(t.sf[e]))xe.error("Unable to unload data!");else{if(0==e)xe.log("%cUNLOAD ALL","color: #00a"),ae.cleanup(),re.cleanup(),we.cleanup(),oe.cleanup(),Oe.cleanup(),de.cleanup(),se.cleanup(),Ae.cleanup(),be.cleanup(),Ue.cleanup(),Se.cleanup(),ve.cleanup(),Re.cleanup(),fe.cleanup(),ne.cleanup(),Ie.cleanup(),ge.cleanup(),he.cleanup(),ue.cleanup(),le.cleanup(),qe=null,Ye={},Xe=We=null,tt=!1;else{xe.log("%cUNLOAD DATA "+e,"color: #00a"),re.rS(e);for(var t=be.get_all_objects("ALL",be.DATA_ID_ALL),a=0;a<t.length;a++){var r=t[a];Ee.get_object_data_id(r)!=e&&be.qo(r,!1,!1,!1)}for(t=be.get_all_objects("ALL",e),a=t.length-1;0<=a;a--)r=t[a],ee(r),be.remove_object(r);for(t=be.get_all_objects("ALL",be.DATA_ID_ALL),a=0;a<t.length;a++)be.qo(t[a],!0,!0,!0)}me.cleanup(e),Z()}},e.tG=ee,e.set_debug_resources_root=function(e){ze=e},e.activate_media=function(){tt||Fe.media_auto_activation||(Ie.play(),Ie.pause(),Ie.reset(),U(We,be.DATA_ID_ALL,!0),we.pause(),Fe.lz&&we.rG(),tt=!0)},e.reset=function(){it=null},e.prefetch=function(e,t,r){var i={load_main:{Eb:de.hg,Kb:!1,inputs:[],Lb:!1,Sb:500,dc:!1,Ub:n},load_binaries:{Eb:de.hg,Kb:!1,inputs:["load_main"],Lb:!1,Sb:500,dc:!1,Ub:o},load_images:{Eb:de.hg,Kb:!1,inputs:["load_main"],Lb:!1,Sb:500,dc:!1,Ub:L},preload_sounds:{Eb:de.hg,Kb:!1,inputs:["load_main"],Lb:!1,Sb:500,dc:!1,Ub:l}},_=de.Ty();return _||(_=de.ID(),Xe={},qe={},Ye={}),Xe[_.sf.length]={},de.MD(i,e,t,r,a,!1,Fe.do_not_load_resources,!1,!0)},e.unfetch=function(){ne.GM()}},a.module.__batch=function(e,t){function a(e){return e={type:e,sb:"",id:0,Rd:0,bq:-1,zk:"",Kt:-1,tn:-1,rq:0,af:0,ak:[],fa:[],rf:[],We:[],Pb:[],Oi:[],ui:null,Fc:{},ib:null,Ra:ee.yQ(),Wd:"",Gp:[],ga:null,Ne:oe.Yj(),Me:!1,Ti:!1,Mt:!1,num_vertices:0,num_triangles:0,Xu:0,Yu:0,Dc:!1,zu:0,aj:0,ad:new Float32Array(3),$e:new Float32Array(16),Di:!1,Te:!1,kb:!1,Ya:!1,Hh:!1,gc:!1,Le:!1,fe:!1,Je:!1,pe:!1,Gd:!1,Yd:!1,Dd:!1,Cd:!1,bh:ne.Ym,Pe:!1,wg:!1,Vi:!1,Jf:!1,Uf:Y.vx,Vf:0,ij:0,jj:0,tk:n(),Qd:-1,zd:-1,Fu:!1,Ju:0,Gu:0,Ku:0,Lu:0,Iu:new Float32Array(3),Hu:new Float32Array(3),Qq:!1,Xg:0,dh:0,Xh:1,reflect_factor:0,Aj:0,Bm:1,parallax_scale:0,Wh:0,mg:1,no:0,mm:0,ph:0,yo:0,nd:new Float32Array(2),qe:new Float32Array(3),Ng:new Float32Array(3),ri:new Float32Array(3),ud:new Float32Array(4),Pf:new Float32Array(4),gm:null,$n:null,Yq:null,Xq:null,nb:!1,wireframe_edge_color:ie.create(),wf:!1,water_dynamic:!1,Um:!1,ex:!1,fx:0,gx:0,dx:0,hl:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,fu:new Float32Array(2),eu:new Float32Array(2),Eq:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),pj:null,rj:!1,ej:!1,Qt:!1,Ba:null,jm:0,ql:null,mr:null,oh:[],lf:[],Xd:[],kf:[],Ta:j.eF(),al:!1,Id:null,sg:!0,fF:0,po:new Float32Array(3)},e.ud[3]=1,e.Ya=!0,e.jm=1,e.tk.Sn=-1,e}function r(e){var t=a(e.type);t.sb=e.sb,t.id=e.id,t.bq=e.bq,t.zk=e.zk,t.Kt=e.Kt,t.tn=e.tn,t.rq=e.rq,t.af=e.af,t.ak=[],t.fa=e.fa.slice(),t.rf=e.rf.slice(),t.We=e.We.slice(),t.Pb=e.Pb.slice(),t.Oi=e.Oi.slice(),t.ui=oe.P(e.ui),t.Fc=oe.P(e.Fc),t.ib=e.ib,t.Ra=ee.KM(e.Ra),t.Wd=e.Wd,t.Gp=Z.HM(e.Gp),t.ga=e.ga,t.Me=e.Me,t.Ti=e.Ti,t.Mt=e.Mt,t.num_vertices=e.num_vertices,t.num_triangles=e.num_triangles,t.Xu=e.Xu,t.Yu=e.Yu,t.zu=e.zu,t.aj=e.aj,t.ad=e.ad,t.$e=e.$e,t.Di=e.Di,t.Te=e.Te,t.kb=e.kb,t.Ya=e.Ya,t.Hh=e.Hh,t.gc=e.gc,t.Le=e.Le,t.fe=e.fe,t.Je=e.Je,t.pe=e.pe,t.Gd=e.Gd,t.Yd=e.Yd,t.Dd=e.Dd,t.Cd=e.Cd,t.Dc=e.Dc,t.bh=e.bh,t.Pe=e.Pe,t.wg=e.wg,t.Vi=e.Vi,t.Jf=e.Jf,t.Uf=e.Uf,t.Vf=e.Vf,t.ij=e.ij,t.jj=e.jj;var r=e.tk,o=n();return o.ns=r.ns,o.Ae=r.Ae,o.st=r.st,o.Vh=r.Vh,o.Sn=r.Sn,o.Rn=r.Rn,o.Qn=r.Qn,o.Ov=r.Ov,t.tk=o,t.Qd=e.Qd,t.zd=e.zd,t.Fu=e.Fu,t.Ju=e.Ju,t.Gu=e.Gu,t.Ku=e.Ku,t.Lu=e.Lu,ie.copy(e.Iu,t.Iu),ie.copy(e.Hu,t.Hu),t.Qq=e.Qq,t.Xg=e.Xg,t.dh=e.dh,t.Xh=e.Xh,t.reflect_factor=e.reflect_factor,t.Aj=e.Aj,t.Bm=e.Bm,t.parallax_scale=e.parallax_scale,t.Wh=e.Wh,t.mg=e.mg,t.no=e.no,t.mm=e.mm,t.ph=e.ph,t.yo=e.yo,t.nd[0]=e.nd[0],t.nd[1]=e.nd[1],ie.copy(e.qe,t.qe),ie.copy(e.Ng,t.Ng),ie.copy(e.ri,t.ri),_e.copy(e.ud,t.ud),_e.copy(e.Pf,t.Pf),t.gm=oe.P(e.gm),e.$n&&(t.$n=new Float32Array(e.$n),t.Yq=new Float32Array(e.Yq),t.Xq=new Float32Array(e.Xq)),t.nb=e.nb,ie.copy(e.wireframe_edge_color,t.wireframe_edge_color),t.wf=e.wf,t.water_dynamic=e.water_dynamic,t.Um=e.Um,t.ex=e.ex,t.fx=e.fx,t.gx=e.gx,t.dx=e.dx,t.hl=e.hl,t.shallow_water_col_fac=e.shallow_water_col_fac,t.shore_water_col_fac=e.shore_water_col_fac,t.foam_factor=e.foam_factor,t.fu.set(e.fu),t.eu.set(e.eu),t.Eq.set(e.Eq),ie.copy(e.shallow_water_col,t.shallow_water_col),ie.copy(e.shore_water_col,t.shore_water_col),t.pj=oe.P(e.pj),t.rj=e.rj,t.ej=e.ej,t.Qt=e.Qt,e.Ba&&(t.Ba=V.wD(e.Ba)),t.jm=e.jm,e.ql&&(t.ql=new Float32Array(e.ql)),t.mr=oe.P(e.mr),t.oh=e.oh.slice(),t.lf=e.lf.slice(),t.Xd=e.Xd.slice(),t.kf=e.kf.slice(),j.GD(e.Ta,t.Ta),t.al=e.al,t.sg=e.sg,t.po=e.po,t}function n(){return{ns:!1,Ae:0,Vh:0,Sn:0,Rn:0,Qn:0,Ov:0,st:1}}function o(e){switch(e.type){case"MAIN":case"PARTICLES":case"LINE":e.sb=e.kb?e.Hh?"XRAY":"BLEND":"OPAQUE";break;case"SHADOW":e.sb=e.pe?"CAST":"RECEIVE";break;case"COLOR_ID":e.sb=e.Hh?"COLOR_ID_XRAY":"COLOR_ID"}}function i(e,t,r){var n=[],o=e.Xa,i=s(r,t,!t.An,!1),_=e.data,l=_.materials,f=Array(l.length),u=Array(l.length),d=[],p=$.bc(r,te.Gb),m=!1;p&&(m=!!p.im.length);for(var g=0;g<i.length;g++)for(var h=i[g],v=0;v<l.length;v++){var b=l[v];if(!F(o,v)&&!ne.XE(_,v))if("PHYSICS"==h&&e.b4w_collision&&"NAVMESH"==e.game.physics_type)d.push(ne.$t(_,v,[],t.Oh,{},null));else if(!b.b4w_lens_flares||m){var E=a(h);if("MAIN"==h?f[v]=E:"DEBUG_VIEW"==h&&(u[v]=E),E.bq=e.b4w_cluster_data.cluster_id,I(E,b)&&c(E,b)){"SHADOW"==h&&f[v]&&(E.Le=f[v].Le),E.bh=t.Me||t.fe?ne.ws:ne.Ym,T(E,t),O(E,e.particle_systems),"DYNAMIC"!=t.type&&"COLOR_ID"!=E.type||(E.zk=G(E,t,e.uuid)),E.Vi=e.b4w_do_not_cull,"MAIN"==E.type&&(E.Jf=e.b4w_caustics),R(E,"DISABLE_FOG",0|("COLOR_ID"!=h&&"SHADOW"!=h&&e.b4w_disable_fogging));var A=ne.$t(_,v,E.Oi,t.Oh,E.Fc,E.ui);!b.use_tangent_shading||"a_shade_tangs"in A.$[0]||(R(E,"CALC_TBN",1),w(E,"a_tbn")),b.b4w_lens_flares&&(A=V.hS(A)),M(E),n.push({ra:E,Yf:t,Zs:t,Id:A,Fg:[b.name],Ed:[e]})}}}if(d.length){E=a("PHYSICS"),E.sb="NAVMESH",E.zk=G(E,t,e.uuid);for(var A=ne.HH(d),x=[],g=0;g<l.length;g++)x.push(l[g].name);M(E),n.push({ra:E,Yf:t,Zs:t,Id:A,Fg:x,Ed:[e]})}for(g=0;g<u.length;g++)u[g]&&(u[g].tn=f[g].id,M(u[g]));var y=e.particle_systems;if(0<y.length){for(var S=!1,L=!1,g=0;g<y.length;g++){var C=y[g],D=C.settings;if(D.use_render_emitter&&n.length&&(S=!0),"HAIR"!=D.type||"OBJECT"!=D.render_type&&"GROUP"!=D.render_type&&C.transforms.length||(L=!0),S&&L)break}var U;if(n.length)U=n[0];else{var k=a("TMP");O(k,y);U={ra:k,Id:ne.$t(_,0,k.Oi,t.Oh,k.Fc,k.ui)}}var P,j=U,B=j.ra.Fc;if(L){var X;if(1<l.length){for(var q={},z=0;z<y.length;z++){var W=y[z].settings;if("HAIR"==W.type&&("OBJECT"==W.render_type||"GROUP"==W.render_type)){var J=W.b4w_vcol_from_name,K=W.b4w_vcol_to_name;""!==J&&""!==K&&(q[J]=oe.P(B[J]))}}"a_bending_col_main"in B&&(q.a_bending_col_main=oe.P(B.a_bending_col_main)),"a_bending_col_detail"in B&&(q.a_bending_col_detail=oe.P(B.a_bending_col_detail)),X=ne.gE(_,[],q)}else X=j.Id;P=X}else P=null;for(var Z=P,ae=e.Xa,_e=[],ce=e.particle_systems,le=e.data,fe=0;fe<ce.length;fe++){var ue=ce[fe],de=ue.settings;if(de.count)if("EMITTER"==de.type){if("DYNAMIC"==t.type){var pe=a("PARTICLES");pe.Ta.ee=t.la,pe.Ta.ye=t.tb,pe.Ta.ze=t.hc;var me,ge=ue.settings.material-1;ge>=le.materials.length&&(H.warn('Wrong material used for rendering particle system "'+ue.name+'"'),ge=0),me=ge;var he=le.materials[me];if(!F(ae,me)&&("HALO"===ue.settings.render_type&&"HALO"===he.type&&(pe.Qq=!0),c(pe,he))){var ve=pe,be=e,Ee=ue.settings;switch(Ee.b4w_billboard_align){case"VIEW":R(ve,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case"XY":R(ve,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case"YZ":R(ve,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case"ZX":R(ve,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:oe.F("Wrong billboard align value")}R(ve,"BILLBOARD",0);var Ae=Ee.b4w_enable_soft_particles&&Y.jD(be,Ee);R(ve,"SOFT_PARTICLES",0<Ee.b4w_particles_softness&&Ae&&se.Nt?1:0),R(ve,"SOFT_STRENGTH",ee.R(Ee.b4w_particles_softness)),ee.ka(ve.Ra,"WORLD_SPACE","WORLD"==Ee.b4w_coordinate_system?1:0),pe.fe=!0,pe.Vi=e.b4w_do_not_cull,pe.zk=G(pe,t,ae.name+"_"+de.uuid),V.oN(pe,ue,he);var xe=V.gP(pe,le,ue,ae.o);V.SU(xe,pe,de.count),V.RU(ae),T(pe,ae.o),M(pe),_e.push({ra:pe,Yf:t,Zs:t,Id:xe,Fg:[he.name],Ed:[e]})}}}else if("HAIR"==de.type){var Te=oe.Pu(ue.seed),ye=Q.kD(se.Az)&&!de.b4w_initial_rand_rotation&&!de.b4w_hair_billboard,Se=4;if(ye&&(Se=8),ue.transforms.length)var Oe=ue.transforms;else for(var we=ne.Ly(Z,de.count,!1,Te),Oe=new Float32Array(we.length*Se),Re=0;Re<we.length;Re++){var Le=.75+.5*oe.Jg(Te);Oe[Re*Se]=we[Re][0],Oe[Re*Se+1]=we[Re][1],Oe[Re*Se+2]=we[Re][2],Oe[Re*Se+3]=Le,ye&&(Oe[Re*Se+4]=1,Oe[Re*Se+5]=0,Oe[Re*Se+6]=0,Oe[Re*Se+7]=0)}var Ne=!!$.bc(r,te.yi);if("OBJECT"==de.render_type){var Ie=[s(r,de.dupli_object.Xa.o,!t.An,!0)],Me=N(e,t,B,Z,[de.dupli_object],Ie,[Oe],de,ue,Ne,Te,!1);_e.push.apply(_e,Me)}else if("GROUP"==de.render_type){for(var Ce=de.dupli_group.objects,Ie=[],Re=0;Re<Ce.length;Re++){var De=s(r,Ce[Re].Xa.o,!t.An,!0);Ie.push(De)}for(var Ue=!1,ke=[],Re=0;Re<Ce.length;Re++)ke.push(Ce[Re].Xa);if(de.use_whole_group){for(var Pe,Ge=Oe,Fe=ke,je=ye,Be=Se,He={},Xe=new Float32Array([0,0,0,1]),qe=0;qe<Ge.length;qe+=Be)for(var ze=0;ze<Fe.length;ze++){var We=ie.create(),Ye=re.get_scale(Fe[ze].o.v),Ve=re.get_trans_view(Fe[ze].o.v);ie.scale(Ve,Ye,We);var Je=ie.clone([Ge[qe],Ge[qe+1],Ge[qe+2]]);He[ze]||(He[ze]=new Float32Array(Ge.length)),je&&(He[ze][qe+4]=Xe[0]=Ge[qe+4],He[ze][qe+5]=Xe[1]=Ge[qe+5],He[ze][qe+6]=Xe[2]=Ge[qe+6],He[ze][qe+7]=Xe[3]=Ge[qe+7],oe.oA(Xe,Xe),oe.nU(We,Xe,We)),ie.add(Je,We,Je),He[ze][qe]=Je[0],He[ze][qe+1]=Je[1],He[ze][qe+2]=Je[2],He[ze][qe+3]=Ge[qe+3]}Pe=He,Ue=!0}else{var Ke;if(de.use_group_count){for(var Qe=Oe,Ze=ke,$e=de.dupli_weights,et=Te,tt=ye,at=Se,rt={},nt=[],ot=0;ot<Ze.length;ot++)for(var it=Ze[ot],_t=it.qd||it.name,st=0;st<$e.length;st++){var ct=$e[st];_t==ct.name&&nt.push(ct)}for($e.length!=nt.length&&H.error("dupli weights match failed"),ot=0;ot<Qe.length;ot+=at){for(var lt,ft=nt,ut=[0],dt=0;dt<ft.length;dt++)ut[dt+1]=ut[dt]+ft[dt].count;for(var pt=ut[ut.length-1]*oe.Jg(et),mt=0,dt=0;dt<ut.length;dt++)if(pt>=ut[dt]&&pt<ut[dt+1]){mt=dt;break}lt=mt,rt[lt]=rt[lt]||[],rt[lt].push(Qe[ot],Qe[ot+1],Qe[ot+2],Qe[ot+3]),tt&&rt[lt].push(Qe[ot+4],Qe[ot+5],Qe[ot+6],Qe[ot+7])}for(lt in rt)rt[lt]=new Float32Array(rt[lt]);Ke=rt}else{for(var gt=Oe,ht=Te,vt=ye,bt=Se,Et=ke.length,At={},xt=0;xt<gt.length;xt+=bt){var Tt=Math.floor(Et*oe.Jg(ht));At[Tt]=At[Tt]||[],At[Tt].push(gt[xt],gt[xt+1],gt[xt+2],gt[xt+3]),vt&&At[Tt].push(gt[xt+4],gt[xt+5],gt[xt+6],gt[xt+7])}for(Tt in At)At[Tt]=new Float32Array(At[Tt]);Ke=At}Pe=Ke}Me=N(e,t,B,Z,Ce,Ie,Pe,de,ue,Ne,Te,Ue),_e.push.apply(_e,Me)}"INSTANCE"==de.b4w_wind_bend_inheritance&&ae.o.ve&&H.warn('Emitter object "'+ae.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else oe.F("Unknown particle settings type")}S?n.push.apply(n,_e):n=_e}return n}function _(e){for(var t=[],a=[],r={},n=0;n<e.length;n++){var o=e[n].ra,i=null;if(o.id in r){var _=r[o.id],s=a[_].ra;if(C(o,function(e){C(s,function(t){oe.cU(e,t)&&1!=e.fF&&(i=a[_])})}),!i)do{o.id++}while(r[o.id])}if(i||(i={ra:o,jG:[],IC:[],JH:[],Ed:[],DG:[],Fg:[]},r[o.id]=a.length,a.push(i)),e[n].Id&&e[n].Id.Na){i.jG.push(e[n].Yf),i.IC.push(e[n].Zs),i.JH.push(e[n].Id);for(var c=0;c<e[n].Ed.length;c++)o=e[n].Ed[c],-1==i.DG.indexOf(o.uuid)&&(i.Ed.push(o),i.DG.push(o.uuid));for(c=0;c<e[n].Fg.length;c++)o=e[n].Fg[c],-1==i.Fg.indexOf(o)&&i.Fg.push(o)}i.Fg.sort()}for(n=0;n<a.length;n++){var o=a[n].ra,l=a[n].jG,f=a[n].IC,u=a[n].JH;if(e="DYNAMIC"==f[0].type||"COLOR_ID"==o.type?f[0]:Y.fy(f[0]),"STATIC"==e.type)for(c=0;c<l.length;c++){var d=l[c],p=f[c],r=u[c],m=re.identity(he);d.pg&&!d.Kp?(d=re.Cb(d.v,de),re.set_trans(d,m)):re.copy(d.v,m),p.nk?r.Fe||(p.pg?ne.fU(r,m):ne.XA(r,m)):ne.XA(r,m),p.nk?R(o,"AU_QUALIFIER","GLSL_IN"):1<a[n].Ed.length?(d={},(p.ve||p.pg)&&(d.au_center_pos=[m[0],m[1],m[2]]),p.ve&&(d.au_wind_bending_amp=[p.xf],d.au_wind_bending_freq=[p.yf],d.au_detail_bending_amp=[p.cf],d.au_detail_bending_freq=[p.df],d.au_branch_bending_amp=[p.Xe]),ne.eU(r,d),R(o,"AU_QUALIFIER","GLSL_IN")):(e.nt.set(m.subarray(0,3)),R(o,"AU_QUALIFIER","uniform"))}if(0==u.length)r=ne.Cg(oe.cs("%empty"));else if(1==u.length)r=u[0];else{for(r=[],c=0;c<u.length;c++)ne.HQ(u[c])||r.push(c);if(r.length<u.length)for(c=0;c<r.length;c++)ne.uw(u[r[c]]);r=ne.HH(u)}if("STATIC"==e.type){if(1<a[n].Ed.length){for(u=[],c=0;c<a[n].Ed.length;c++)j.Hy(a[n].Ed[c].Xa.o.JC,u);j.Nx(u,0,u.length,e.og),j.$g(e.og,e.la),e.Ji=j.zt(oe.f32(u),!0),j.El(e.Ji,e.tb),e.Pd=j.Bt(e.Ji),j.Pi(e.Pd,e.hc)}e.cj&&(c=a[n].Ed[0].b4w_cluster_data,c.cluster_center?e.dr.set(c.cluster_center):e.dr.set(e.Pd.N))}"PARTICLES"!=o.type&&(c=r.Qc,e.pg?("STATIC"==e.type?(j.$g(e.og,o.Ta.ee),j.El(e.Ji,o.Ta.ye),j.Pi(e.Pd,o.Ta.ze)):(j.$g(e.la,o.Ta.ee),j.El(e.tb,o.Ta.ye),j.Pi(e.hc,o.Ta.ze)),o.al=!1):(j.$g(c.la,o.Ta.ee),j.El(c.tb,o.Ta.ye),e.hc.ab<c.hc.ab?"STATIC"==e.type?j.Pi(e.Pd,o.Ta.ze):j.Pi(e.hc,o.Ta.ze):j.Pi(c.hc,o.Ta.ze),o.al=j.hF(o.Ta.ye,o.Ta.ze))),t.push({ra:o,o:e,Id:r,Fg:a[n].Fg,Ed:a[n].Ed})}return t}function s(e,t,a,r){var n=[];if(r||(t.Kk&&$.bc(e,te.we)||t.Oc&&$.bc(e,te.Tg))&&n.push("COLOR_ID"),a&&(n.push("MAIN"),n.push("NODES_GLOW"),$.bc(e,te.Sg)&&n.push("DEBUG_VIEW"),$.bc(e,te.Cf)&&n.push("SHADOW"),$.bc(e,te.yi)&&n.push("GRASS_MAP")),n.push("PHYSICS"),t.pe||t.Dd)for(e=null,t.pe&&(e=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),t.Dd&&(t=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],e=e?oe.BL(e,t):t),t=e,e=0;e<t.length;e++)-1!==(a=n.indexOf(t[e]))&&n.splice(a,1);return n}function c(e,t){var a;switch(e.type){case"MAIN":if(t.b4w_do_not_render)a=!1;else{if(t.use_nodes&&"HALO"!=t.type)h(e,t,"MAIN");else{u(e,t),a=t.game_settings.alpha_blend,e.Hh=t.b4w_render_above_all&&"OPAQUE"!=a&&"CLIP"!=a&&"ALPHA_ANTIALIASING"!=a,e.ph=t.offset_z,e.Ng.set([1,1,1]);var r=t.texture_slots;if(_e.set(t.diffuse_color[0],t.diffuse_color[1],t.diffuse_color[2],t.alpha,e.ud),t.b4w_lens_flares){U(e,"lens_flares.glslv","lens_flares.glslf"),w(e,"a_position"),w(e,"a_texcoord");var n=ae.he(r[0]),o=r[0].texture;k(e,n,"u_sampler",o.name)}else{if(U(e,"main.glslv","main_stack.glslf"),!t.use_shadeless){var i=W.my(t.uuid,t.name,{Le:t.use_shadeless,uq:t.diffuse_shader,Qr:t.specular_shader,Nm:t.use_tangent_shading});e.Ra.He=W.kq(i)}var _=d("use_map_color_diffuse",r),s=d("use_map_color_spec",r),c=d("use_map_normal",r),v=d("use_map_mirror",r),b=d("use_stencil",r),i=_[0],s=s[0],c=c[0],v=v[0],_=_[1],r=b[0]&&d("use_rgb_to_intensity",r)[0];if(i){switch(o=i.texture,i.blend_type){case"MIX":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}n=ae.he(i),k(e,n,"u_colormap0",o.name),e.Wh=i.diffuse_color_factor,i.use_map_alpha?e.mg=i.alpha_factor:e.mg=0,e.Ng.set(i.scale)}if(b=i&&i==s,s&&(b||(o=s.texture,n=ae.he(s),k(e,n,"u_specmap0",o.name)),e.Aj=s.specular_color_factor),c&&(o=c.texture,w(e,"a_tbn"),n=ae.he(c),k(e,n,"u_normalmap0",o.name),e.no=c.normal_factor,o.b4w_use_map_parallax&&se.Hv)){var n=ee.R(o.b4w_parallax_steps),E=ee.R(o.b4w_parallax_lod_dist);R(e,"PARALLAX",1),R(e,"PARALLAX_STEPS",n),R(e,"PARALLAX_LOD_DIST",E),e.parallax_scale=o.b4w_parallax_scale}if(v&&(o=v.texture,n=ae.he(v),k(e,n,"u_mirrormap",o.name),e.mm=v.mirror_factor),(v=i&&_&&r?1:0)&&(n=ae.he(_),o=_.texture,k(e,n,"u_colormap1",o.name),n=ae.he(r),o=r.texture,k(e,n,"u_stencil0",o.name)),(o=i||s||c)&&e.Ng.set(o.scale),R(e,"TEXTURE_SPEC",void 0==s?0:1),R(e,"ALPHA_AS_SPEC",b?1:0),R(e,"TEXTURE_STENCIL_ALPHA_MASK",v),w(e,"a_position"),w(e,"a_tbn"),(i||s||c)&&w(e,"a_texcoord"),t.b4w_water){for(e.wf=!0,e.water_dynamic=t.b4w_water_dynamic,t.b4w_water_shore_smoothing&&!e.kb?(H.warn('Material: "'+t.name+'" is opaque.',"Disabling water shore smoothing."),e.Um=!1):e.Um="REFLECT"!=e.sb&&t.b4w_water_shore_smoothing,U(e,"water.glslv","water.glslf"),v=W.my(t.uuid,t.name,{Le:!1,uq:t.diffuse_shader,Qr:t.specular_shader,Nm:t.use_tangent_shading}),e.Ra.He=W.kq(v),w(e,"a_position"),se.LI?(w(e,"a_polyindex"),e.Ya=!0,ie.set(0,0,0,e.wireframe_edge_color),X.Vy()?R(e,"DEBUG_WIREFRAME",1):R(e,"DEBUG_WIREFRAME",2)):R(e,"DEBUG_WIREFRAME",0),b=t.texture_slots,v=d("use_map_normal",b),n=d("use_map_mirror",b)[0],v.length&&(o=v[0].texture,k(e,ae.he(v[0]),"u_normalmap0",o.name),e.hl=t.b4w_water_norm_uv_velocity),R(e,"NUM_NORMALMAPS",v.length),e.pj=Array(v.length),o=0;o<v.length;o++)e.pj[o]=new Float32Array(2),e.pj[o].set([v[o].scale[0],v[o].scale[1]]);if(n&&(E=ae.he(n),o=n.texture,k(e,E,"u_mirrormap",o.name),e.mm=n.mirror_factor),n=null,se.Jn)for(o=0;o<b.length;o++){var A=b[o];if(!0===A.texture.b4w_water_foam){n=A;break}}for(n&&(R(e,"FOAM",1),E=ae.he(n),o=n.texture,k(e,E,"u_foam",o.name),e.foam_factor=t.b4w_foam_factor,e.fu.set(o.b4w_foam_uv_freq),e.eu.set(o.b4w_foam_uv_magnitude),e.Eq[0]=n.scale[0],e.Eq[1]=n.scale[1]),o=0;o<b.length;o++)if(A=b[o],!0===A.texture.b4w_shore_dist_map){var T=A;break}if(T&&se.Ns&&(b=ae.he(T),o=T.texture,k(e,b,"u_shore_dist_map",o.name),R(e,"SHORE_PARAMS",1),T=A.texture.b4w_shore_boundings,R(e,"MAX_SHORE_DIST",ee.R(A.texture.b4w_max_shore_dist)),R(e,"SHORE_MAP_SIZE_X",ee.R(T[0]-T[1])),R(e,"SHORE_MAP_SIZE_Y",ee.R(T[2]-T[3])),R(e,"SHORE_MAP_CENTER_X",ee.R((T[0]+T[1])/2)),R(e,"SHORE_MAP_CENTER_Y",ee.R((T[2]+T[3])/2))),t.b4w_generated_mesh?(R(e,"GENERATED_MESH",1),e.ex=!0,e.fx=t.b4w_water_num_cascads,e.gx=t.b4w_water_subdivs,e.dx=t.b4w_water_detailed_dist):(w(e,"a_tbn"),(n||v.length)&&w(e,"a_texcoord"),R(e,"GENERATED_MESH",0)),t.b4w_water_dynamic){var A=ee.R(t.b4w_water_dst_noise_scale0),T=ee.R(t.b4w_water_dst_noise_scale1),v=ee.R(t.b4w_water_dst_noise_freq0),b=ee.R(t.b4w_water_dst_noise_freq1),o=ee.R(t.b4w_water_dir_min_shore_fac),n=ee.R(t.b4w_water_dir_freq),E=ee.R(t.b4w_water_dir_noise_scale),y=ee.R(t.b4w_water_dir_noise_freq),S=ee.R(t.b4w_water_dir_min_noise_fac),O=ee.R(t.b4w_water_dst_min_fac),L=ee.R(t.b4w_water_waves_hor_fac);R(e,"DST_NOISE_SCALE_0",A),R(e,"DST_NOISE_SCALE_1",T),R(e,"DST_NOISE_FREQ_0",v),R(e,"DST_NOISE_FREQ_1",b),R(e,"DIR_MIN_SHR_FAC",o),R(e,"DIR_FREQ",n),R(e,"DIR_NOISE_SCALE",E),R(e,"DIR_NOISE_FREQ",y),R(e,"DIR_MIN_NOISE_FAC",S),R(e,"DST_MIN_FAC",O),R(e,"WAVES_HOR_FAC",L)}m(e,t),g(e,t),e.shallow_water_col.set(t.b4w_shallow_water_col),e.shore_water_col.set(t.b4w_shore_water_col),e.shallow_water_col_fac=t.b4w_shallow_water_col_fac,e.shore_water_col_fac=t.b4w_shore_water_col_fac,R(e,"ABSORB",ee.R(t.b4w_water_absorb_factor)),R(e,"SSS_STRENGTH",ee.R(t.b4w_water_sss_strength)),R(e,"SSS_WIDTH",ee.R(t.b4w_water_sss_width))}"HALO"===t.type&&(U(e,"halo.glslv","halo.glslf"),l(e,t),e.Oi=["a_position"]),t.use_tangent_shading&&(R(e,"USE_TBN_SHADING",1),w(e,"a_shade_tangs")),R(e,"TEXCOORD",0),R(e,"NORMAL_TEXCOORD",0),i&&f(e,i,"TEXTURE_COLOR0_CO"),_&&f(e,_,"TEXTURE_COLOR1_CO"),r&&f(e,r,"TEXTURE_STENCIL_ALPHA_MASK_CO"),s&&f(e,s,"TEXTURE_SPEC_CO"),c&&f(e,c,"TEXTURE_NORM_CO"),R(e,"SHADELESS",t.use_shadeless?1:0),e.Le=t.use_shadeless}R(e,"ALPHA","OPAQUE"===a?0:1),R(e,"ALPHA_CLIP","CLIP"===a?1:0),R(e,"DOUBLE_SIDED_LIGHTING",t.b4w_double_sided_lighting?1:0),t.use_vertex_color_paint?(R(e,"VERTEX_COLOR",1),w(e,"a_color")):R(e,"VERTEX_COLOR",0),e.Xg=t.ambient,e.Xh=t.diffuse_intensity,e.dh=t.emit,e.ri.set(t.specular_color),e.Bm=t.specular_alpha,m(e,t),g(e,t),t.b4w_wettable?R(e,"WETTABLE",1):R(e,"WETTABLE",0),p(e,t),t.b4w_refractive&&!e.kb?(H.warn('Material "'+t.name+'" is not blend. Disabling refractions.'),e.rj=!1):e.rj=t.b4w_refractive,e.yo=t.b4w_refr_bump}a=!0}break;case"NODES_GLOW":a=h(e,t,"GLOW");break;case"SHADOW":if(t.b4w_lens_flares||t.b4w_water||t.b4w_do_not_render||"HALO"===t.type)a=!1;else if(u(e,t),e.kb)a=!1;else{if(i=t.game_settings.alpha_blend,!t.use_nodes||"CLIP"!=i&&"ALPHA_ANTIALIASING"!=i?U(e,"shadow.glslv","shadow.glslf"):h(e,t,"SHADOW"),_e.set(0,0,0,t.alpha,e.ud),w(e,"a_position"),w(e,"a_tbn"),R(e,"ALPHA","OPAQUE"===i?0:1),e.Ng.set([1,1,1]),!(a=d("use_map_color_diffuse",t.texture_slots)[0])||"CLIP"!=i&&"ALPHA_ANTIALIASING"!=i)R(e,"TEXTURE_COLOR",0);else{switch(a.blend_type){case"MIX":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.Ng.set(a.scale),R(e,"TEXTURE_COLOR",1),w(e,"a_texcoord"),i=ae.he(a),a=a.texture,"IMAGE"!=i.source&&"ENVIRONMENT_MAP"!=i.source&&"CANVAS"!=i.source&&"NONE"!=i.source||k(e,i,"u_colormap0",a.name)}a=!0}break;case"PHYSICS":t.b4w_collision?(e.ms=t.b4w_use_ghost,e.Zb=t.b4w_collision_id,e.gq=t.b4w_collision_margin,e.cq=t.b4w_collision_group,e.hq=t.b4w_collision_mask,e.Ln=t.physics.friction,e.Dn=t.physics.elasticity,a=!0):t.b4w_water?(e.wf=!0,e.zV=t.b4w_water_dynamic,e.dst_noise_scale0=t.b4w_water_dst_noise_scale0,e.dst_noise_scale1=t.b4w_water_dst_noise_scale1,e.dst_noise_freq0=t.b4w_water_dst_noise_freq0,e.dst_noise_freq1=t.b4w_water_dst_noise_freq1,e.dir_min_shore_fac=t.b4w_water_dir_min_shore_fac,e.dir_freq=t.b4w_water_dir_freq,e.dir_noise_scale=t.b4w_water_dir_noise_scale,e.dir_noise_freq=t.b4w_water_dir_noise_freq,e.dir_min_noise_fac=t.b4w_water_dir_min_noise_fac,e.dst_min_fac=t.b4w_water_dst_min_fac,e.waves_hor_fac=t.b4w_water_waves_hor_fac,a=!0):a=!1;break;case"COLOR_ID":if(t.b4w_lens_flares||"HALO"===t.type)a=!1;else{if(s=a=t.game_settings.alpha_blend,"ALPHA_ANTIALIASING"==s&&(s="CLIP",t.game_settings.alpha_blend="CLIP"),u(e,t),e.Pe=!1,e.Ya=!0,e.kb=!1,e.Hh=t.b4w_render_above_all&&"OPAQUE"!=s&&"CLIP"!=s,t.use_nodes&&"CLIP"==s?h(e,t,"COLOR_ID"):U(e,"color_id.glslv","color_id.glslf"),_e.set(0,0,0,t.alpha,e.ud),w(e,"a_position"),R(e,"ALPHA","OPAQUE"===s?0:1),e.Ng.set([1,1,1]),i=d("use_map_color_diffuse",t.texture_slots)[0],R(e,"ALPHA_CLIP","CLIP"===s?1:0),i&&"CLIP"==s){switch(i.blend_type){case"MIX":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.Ng.set(i.scale),R(e,"TEXTURE_COLOR",1),w(e,"a_texcoord"),s=ae.he(i),i=i.texture,"IMAGE"!=s.source&&"ENVIRONMENT_MAP"!=s.source&&"CANVAS"!=s.source&&"NONE"!=s.source||k(e,s,"u_colormap0",i.name)}else R(e,"TEXTURE_COLOR",0);t.game_settings.alpha_blend=a,a=!0}break;case"GRASS_MAP":!t.b4w_terrain||t.b4w_do_not_render?a=!1:(u(e,t),e.kb=!1,e.Pe=!1,e.Ya=!0,U(e,"grass_map.glslv","grass_map.glslf"),w(e,"a_position"),a=t.b4w_dynamic_grass_size?t.b4w_dynamic_grass_size:null,i=t.b4w_dynamic_grass_color?t.b4w_dynamic_grass_color:null,e.Fc.a_grass_size={Vl:!0,src:[]},a?(e.Fc.a_grass_size.src.push({name:a,Dg:4}),R(e,"DYNAMIC_GRASS_SIZE",1)):R(e,"DYNAMIC_GRASS_SIZE",0),e.Fc.a_grass_color={Vl:!0,src:[]},i?(e.Fc.a_grass_color.src.push({name:i,Dg:7}),R(e,"DYNAMIC_GRASS_COLOR",1)):R(e,"DYNAMIC_GRASS_COLOR",0),R(e,"GRASS_TEXTURE_SIZE",ee.R(le.Pq)),a=!0);break;case"DEBUG_VIEW":a=x(e,t);break;case"PARTICLES":e:if(t.b4w_do_not_render)a=!1;else{if(a=t.texture_slots,e.Qq)U(e,"particle_system.glslv","particle_system_stack.glslf"),R(e,"HALO_PARTICLES",1),l(e,t);else{if(i={Le:!1,uq:t.diffuse_shader,Qr:t.specular_shader,Nm:t.use_tangent_shading},t.use_nodes){U(e,"particle_system.glslv","particle_system.glslf"),h(e,t,"PARTICLES"),a=!0;break e}if(U(e,"particle_system.glslv","particle_system_stack.glslf"),i=W.my(t.uuid,t.name,i),e.Ra.He=W.kq(i),a=d("use_map_color_diffuse",a)[0]){switch(R(e,"TEXTURE_COLOR",1),a.blend_type){case"MIX":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":R(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.Wh=a.diffuse_color_factor,a.use_map_alpha?e.mg=a.alpha_factor:e.mg=0,k(e,ae.he(a),"default"+String(e.fa.length),a.texture.name)}}_e.set(t.diffuse_color[0],t.diffuse_color[1],t.diffuse_color[2],t.alpha,e.ud),e.Xg=t.ambient,e.Xh=t.diffuse_intensity,e.dh=t.emit,e.ri.set(t.specular_color),e.Bm=t.specular_alpha,w(e,"a_position"),w(e,"a_tbn"),a=t.game_settings.alpha_blend,R(e,"ALPHA","OPAQUE"===a?0:1),R(e,"ALPHA_CLIP","CLIP"===a?1:0),R(e,"PARTICLES_SHADELESS",t.use_shadeless?1:0),m(e,t),g(e,t),u(e,t),e.Hh=t.b4w_render_above_all&&"OPAQUE"!=a&&"CLIP"!=a&&"ALPHA_ANTIALIASING"!=a,e.ph=t.offset_z,a=!0}break;default:oe.F("Wrong batch type: "+e.type)}return a}function l(e,t){var a=t.halo;R(e,"NUM_RINGS",a.ring_count),R(e,"NUM_LINES",a.line_count),R(e,"NUM_STARS",a.star_tip_count),R(e,"SKY_STARS",t.b4w_halo_sky_stars?1:0),e.Ju=a.size,e.Gu=a.hardness/20,e.Iu.set(a.b4w_halo_rings_color),e.Hu.set(a.b4w_halo_lines_color),e.Ku=1/t.b4w_halo_stars_blend_height,e.Lu=t.b4w_halo_stars_min_height,e.Fu=!0}function f(e,t,a){switch(t.texture_coords){case"UV":case"ORCO":R(e,a,"TEXTURE_COORDS_UV_ORCO"),R(e,"TEXCOORD",1);break;case"NORMAL":R(e,a,"TEXTURE_COORDS_NORMAL"),R(e,"NORMAL_TEXCOORD",1);break;default:R(e,a,"TEXTURE_COORDS_NONE")}}function u(e,t){var a=t.game_settings,r=a.alpha_blend;switch(r){case"ALPHA_ANTIALIASING":e.kb=!1,e.Pe=!1,e.Ya=!0,e.Di=!1,e.Te=!0;break;case"ALPHA_SORT":e.kb=!0,e.Pe=!0,e.Ya=!0,e.Di=!1,e.Te=!1;break;case"ALPHA":e.kb=!0,e.Pe=!1,e.Ya=!0,e.Di=!1,e.Te=!1;break;case"CLIP":e.kb=!1,e.Pe=!1,e.Ya=!0,e.Di=!0,e.Te=!1;break;case"ADD":e.kb=!0,e.Pe=!1,e.Ya=!1,e.Di=!1,e.Te=!1;break;case"OPAQUE":e.kb=!1,e.Pe=!1,e.Ya=!0,e.Di=!1,e.Te=!1;break;default:oe.F("Unknown alpha blend mode: "+r)}e.gc=a.use_backface_culling}function d(e,t){for(var a=[],r=t.length,n=0;n<r;n++){var o=t[n];1==o[e]&&o.texture&&o.texture.G&&a.push(o)}return a}function p(e,t){var a=t.raytrace_transparency;e.Pf[0]=a.fresnel,e.Pf[1]=1-a.fresnel_factor/5,a=t.raytrace_mirror,e.reflect_factor=a.reflect_factor,e.Pf[2]=a.fresnel,e.Pf[3]=1-a.fresnel_factor/5}function m(e,t){var a,r=0;switch(t.specular_shader){case"PHONG":case"COOKTORR":a=t.specular_hardness;break;case"WARDISO":a=t.specular_slope;break;case"TOON":a=t.specular_toon_size,r=t.specular_toon_smooth;break;case"BLINN":a=t.specular_ior,r=t.specular_hardness;break;default:H.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.name+'")'),a=t.specular_hardness}e.qe[0]=t.specular_intensity,e.qe[1]=a,e.qe[2]=r}function g(e,t){switch(t.diffuse_shader){case"LAMBERT":e.nd[0]=0,e.nd[1]=0;break;case"OREN_NAYAR":e.nd[0]=t.roughness,e.nd[1]=0;break;case"FRESNEL":e.nd[0]=t.diffuse_fresnel,e.nd[1]=t.diffuse_fresnel_factor;break;case"MINNAERT":e.nd[0]=t.darkness,e.nd[1]=0;break;case"TOON":e.nd[0]=t.diffuse_toon_size,e.nd[1]=t.diffuse_toon_smooth;break;default:H.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.name+'")'),e.nd[0]=0,e.nd[1]=0}}function h(e,t,a){if(!t.use_nodes||t.b4w_do_not_render)return!1;var r;switch(a){case"MAIN":U(e,"main.glslv","main.glslf"),r=!1;break;case"GLOW":U(e,"main.glslv","main.glslf"),r=!0;break;case"SHADOW":U(e,"shadow.glslv","shadow.glslf"),r=!1;break;case"COLOR_ID":U(e,"color_id.glslv","color_id.glslf"),r=!1}var n=W.AD(t.node_tree,t.uuid,!1,t.name,a);if(!n.va)return H.error('Failed to create node graph for material "'+t.name+'", disable nodes'),A(e,t),!0;e.Wd=n.id,e.nb=!0,R(e,"NODES",1),R(e,"DOUBLE_SIDED_LIGHTING",t.b4w_double_sided_lighting?1:0),w(e,"a_position"),t.use_orco_tex_coord&&w(e,"a_orco_tex_coord"),u(e,t),e.ph=t.offset_z;var o=t.game_settings.alpha_blend;r?(R(e,"ALPHA",1),R(e,"ALPHA_CLIP",0)):(R(e,"ALPHA","OPAQUE"===o?0:1),R(e,"ALPHA_CLIP","CLIP"===o?1:0)),e.Hh=t.b4w_render_above_all&&"OPAQUE"!=o&&"CLIP"!=o&&"ALPHA_ANTIALIASING"!=o,!se.hE||"MAIN"!=a&&"GLOW"!=a||R(e,"FF_COMPOSITING_HACK",1),e.dh=t.emit,e.Xg=t.ambient,p(e,t),t.b4w_wettable?R(e,"WETTABLE",1):R(e,"WETTABLE",0);var i=null,_=!1;for(q.X(n.va,function(a,r){switch(r.type){case"UVMAP":case"TEX_COORD_UV":case"GEOMETRY_UV":case"UV_MERGED":var n=r.data.name,o=r.data.value;e.ui||(e.ui={}),e.ui[o]=n;break;case"GEOMETRY_VC":case"GEOMETRY_VC1":case"GEOMETRY_VC2":case"GEOMETRY_VC3":if(n=r.data.name,e.Fc[n]={Vl:!0,src:[{name:r.data.value}]},o=0,"GEOMETRY_VC"==r.type)o=7;else for(var s=0;s<r.outputs.length;s++){var c="RGB".indexOf(r.outputs[s].identifier);-1<c&&(o|=1<<2-c)}e.Fc[n].src[0].Dg=o;break;case"TEX_COORD_NO":case"TEX_COORD_RE":case"GEOMETRY_NO":case"FRESNEL":case"LAYER_WEIGHT":w(e,"a_tbn");break;case"TEX_COORD_OB":R(e,"USE_MODEL_TSR_INVERSE",1);break;case"TEX_COORD_WI":R(e,"USE_POSITION_CLIP",1);break;case"MATERIAL_BEGIN":r.data.value.Nm&&(R(e,"USE_TBN_SHADING",1),"PARTICLES"!=e.type&&w(e,"a_shade_tangs")),w(e,"a_tbn"),_=!0;break;case"BSDF_BEGIN":_=!0,w(e,"a_tbn");break;case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_CUBE":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":n=r.data.name,o=r.data.Op,s=r.data.value,k(e,s,n,o);break;case"TEXTURE_NORMAL":case"B4W_PARALLAX":R(e,"CALC_TBN_SPACE",1),w(e,"a_tbn"),r.data&&(n=r.data.name,o=r.data.Op,s=r.data.value,k(e,s,n,o));break;case"NORMAL_MAP":switch(w(e,"a_tbn"),Number(r.Ua[0][1])){case W.MJ:R(e,"CALC_TBN_SPACE",1);break;case W.LJ:case W.KJ:R(e,"USE_MODEL_TSR",1)}break;case"LAMP":r.data&&(e.gm=r.data);break;case"B4W_REFRACTION":e.kb?e.rj=!0:(e.rj=!1,H.warn('Material "'+t.name+'" is not blend. Disabling refractions.')),R(e,"USE_POSITION_CLIP",1);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":i||(i=r.data.Ma);break;case"PARTICLE_INFO":"PARTICLES"==e.type&&r.data&&(e.mr=r.data);break;case"VECT_TRANSFORM":switch(Number(r.Ua[1][1])){case W.mC:R(e,"USE_MODEL_TSR_INVERSE",1);break;case W.lC:R(e,"USE_VIEW_TSR",1);break;case W.kC:R(e,"USE_MODEL_TSR",1);break;case W.jC:R(e,"USE_MODEL_TSR",1),R(e,"USE_VIEW_TSR",1);break;case W.iC:R(e,"USE_VIEW_TSR_INVERSE",1);break;case W.hC:R(e,"USE_MODEL_TSR_INVERSE",1),R(e,"USE_VIEW_TSR_INVERSE",1)}break;case"OBJECT_INFO":R(e,"USE_MODEL_TSR",1),e.po[1]=t.pass_index,e.po[2]=Math.random();break;case"B4W_VECTOR_VIEW":case"GEOMETRY_VW":R(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":R(e,"USE_VIEW_TSR_INVERSE",1);break;case"BUMP":case"DISPLACEMENT_BUMP":w(e,"a_tbn"),X.Vy()?R(e,"USE_DERIVATIVES_EXT",1):H.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+t.name+'" material.');break;case"BSDF_TRANSPARENT":e.kb=!0,e.rj=!0;break;case"BSDF_GLOSSY":case"BSDF_DIFFUSE":R(e,"USE_BSDF_SKY_DIM",1),X.LE()&&R(e,"USE_TEXTURE_LOD_EXT",1)}}),i&&k(e,i,"u_nodes_texture"),_||(e.Le=!0),a=e.Ra.He=W.kq(n.va),b(n.va,e),n=e.lf,r=e.kf,o=0;o<a.length;o++){var s=a[o];switch(s.id){case"VALUE":var c=s.ro[0];if(c)for(var l=0;l<n.length;l+=2)if(n[l]==c){s.Ua.push(["VALUE_IND",n[l+1]]);break}break;case"RGB":if(c=s.ro[0])for(l=0;l<r.length;l+=2)if(r[l]==c){s.Ua.push(["RGB_IND",r[l+1]]);break}}}return R(e,"NUM_VALUES",e.oh.length),R(e,"NUM_RGBS",e.Xd.length),!0}function v(e,t){var a=t.G.jl;if(""!=a.Wd){e.nb=!0,e.Wd=a.Wd;var r=W.uu(a.Wd).va;if(r){var n=null;q.X(r,function(t,a){switch(a.type){case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":k(e,a.data.value,a.data.name,a.data.Op);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":n||(n=a.data.Ma);break;case"VECT_TRANSFORM":switch(Number(a.Ua[1][1])){case W.mC:R(e,"USE_MODEL_TSR_INVERSE",1);break;case W.lC:R(e,"USE_VIEW_TSR",1);break;case W.kC:R(e,"USE_MODEL_TSR",1);break;case W.jC:R(e,"USE_MODEL_TSR",1),R(e,"USE_VIEW_TSR",1);break;case W.iC:R(e,"USE_VIEW_TSR_INVERSE",1);break;case W.hC:R(e,"USE_MODEL_TSR_INVERSE",1),R(e,"USE_VIEW_TSR_INVERSE",1)}break;case"B4W_VECTOR_VIEW":R(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":R(e,"USE_VIEW_TSR_INVERSE",1)}}),n&&k(e,n,"u_nodes_texture"),a=e.Ra.He=W.kq(r),b(r,e);for(var r=e.lf,o=e.kf,i=0;i<a.length;i++){var _=a[i];switch(_.id){case"VALUE":var s=_.ro[0];if(s)for(var c=0;c<r.length;c+=2)if(r[c]==s){_.Ua.push(["VALUE_IND",r[c+1]]);break}break;case"RGB":if(s=_.ro[0])for(c=0;c<o.length;c+=2)if(o[c]==s){_.Ua.push(["RGB_IND",o[c+1]]);break}}}R(e,"NUM_VALUES",e.oh.length),R(e,"NUM_RGBS",e.Xd.length)}else H.error('Failed to create node graph for world "'+t.world.name+'", disable nodes'),A(e,t.world.name)}}function b(e,t){var a=[],r=[],n=[],o=[];E(e,a,r,n,o),t.oh=a,t.lf=r,t.Xd=n,t.kf=o}function E(e,t,a,r,n){q.X(e,function(e,o){if("VALUE"==o.type){var i=""+o.name;t.push(o.outputs[0].Aa),a.push(i,a.length/2)}else if("RGB"==o.type){var i=""+o.name,_=o.outputs[0].Aa.slice(0,3);r.push(_[0],_[1],_[2]),n.push(i,n.length/2)}})}function A(e,t){switch(e.type){case"SHADOW":U(e,"shadow.glslv","shadow.glslf");break;case"COLOR_ID":U(e,"color_id.glslv","color_id.glslf");break;default:U(e,"main.glslv","main_stack.glslf")}if(R(e,"SHADELESS",1),w(e,"a_position"),w(e,"a_tbn"),_e.set(1,0,1,1,e.ud),t){var a=t.game_settings.alpha_blend;R(e,"ALPHA","OPAQUE"===a?0:1),R(e,"ALPHA_CLIP","CLIP"===a?1:0),R(e,"VERTEX_COLOR",0),e.ph=t.offset_z,u(e,t)}return!0}function x(e,t){return(!t||!t.b4w_lens_flares&&!t.b4w_do_not_render)&&(U(e,"debug_view.glslv","debug_view.glslf"),w(e,"a_position"),w(e,"a_tbn"),w(e,"a_polyindex"),e.Ya=!0,ie.set(0,0,0,e.wireframe_edge_color),!0)}function T(e,t){if(e.Rd=t.Rd,"PHYSICS"!==e.type){switch("DYNAMIC"==t.type?(t.nk?R(e,"AU_QUALIFIER","GLSL_IN"):R(e,"AU_QUALIFIER","uniform"),R(e,"STATIC_BATCH",0)):(R(e,"AU_QUALIFIER","GLSL_IN"),R(e,"STATIC_BATCH",1)),"DEBUG_VIEW"==e.type&&(X.Vy()?R(e,"WIREFRAME_QUALITY",1):R(e,"WIREFRAME_QUALITY",0),e.Ti?(R(e,"DEBUG_SPHERE",1),e.Mt?R(e,"DEBUG_SPHERE_DYNAMIC",1):R(e,"DEBUG_SPHERE_DYNAMIC",0)):R(e,"DEBUG_SPHERE",0),R(e,"ALPHA",1)),t.Me&&"PARTICLES"!=e.type&&!t.nk&&(e.Me=t.Me),t.ve?(""!==t.kj?(e.Fc.a_bending_col_main={Vl:!0,src:[{name:t.kj,Dg:4}]},w(e,"a_bending_col_main"),""!==t.Ce.yz&&""!==t.Ce.xz&&""!==t.Ce.eA?(e.Fc.a_bending_col_detail={Vl:!0,src:[{name:t.Ce.yz,Dg:4},{name:t.Ce.xz,Dg:2},{name:t.Ce.eA,Dg:1}]},w(e,"a_bending_col_detail"),w(e,"a_tbn"),R(e,"DETAIL_BEND",1)):R(e,"DETAIL_BEND",0),R(e,"MAIN_BEND_COL",1)):R(e,"MAIN_BEND_COL",0),t.wl?R(e,"BEND_CENTER_ONLY",1):R(e,"BEND_CENTER_ONLY",0),R(e,"WIND_BEND",1)):R(e,"WIND_BEND",0),R(e,"BILLBOARD_PRES_GLOB_ORIENTATION",0|t.Kp),t.pg?R(e,"BILLBOARD",1):R(e,"BILLBOARD",0),t.pg&&t.nk?R(e,"HAIR_BILLBOARD",1):R(e,"HAIR_BILLBOARD",0),t.Lp?R(e,"BILLBOARD_SPHERICAL",1):R(e,"BILLBOARD_SPHERICAL",0),t.Mp){case"RANDOM":R(e,"BILLBOARD_RANDOM",1),R(e,"BILLBOARD_JITTERED",0);break;case"JITTERED":R(e,"BILLBOARD_RANDOM",0),R(e,"BILLBOARD_JITTERED",1);break;default:R(e,"BILLBOARD_RANDOM",0),R(e,"BILLBOARD_JITTERED",0)}t.Dc&&se.Ns?R(e,"DYNAMIC_GRASS",1):R(e,"DYNAMIC_GRASS",0),e.Dc=t.Dc,"PARTICLES"!=e.type&&(e.fe=t.fe),e.Je=t.Je,e.pe=t.pe,e.Gd=t.Gd&&!e.Le&&!(e.kb&&se.yy),se.Fr?("MAIN"==e.type&&e.Gd||"SHADOW"==e.type)&&R(e,"RGBA_SHADOWS",1):R(e,"RGBA_SHADOWS",0),e.Yd=t.Yd,e.Dd=t.Dd,e.Cd=t.Cd,e.po[0]=t.Kv,e.Uf=t.Uf,e.Vf=t.Vf,e.ij=t.ij,e.jj=t.jj,e.Qd=t.Qd,e.zd=t.zd,t.qk?(w(e,"a_influence"),R(e,"SKINNED",1),se.fw?(R(e,"DISABLE_TANGENT_SKINNING",1),R(e,"FRAMES_BLENDING",0)):(R(e,"DISABLE_TANGENT_SKINNING",0),t.Sl?R(e,"FRAMES_BLENDING",1):R(e,"FRAMES_BLENDING",0)),R(e,"MAX_BONES",t.mh)):(R(e,"SKINNED",0),R(e,"FRAMES_BLENDING",0),R(e,"DISABLE_TANGENT_SKINNING",0)),t.Rc?(R(e,"VERTEX_ANIM",1),se.CI?R(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):R(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):R(e,"VERTEX_ANIM",0),t.qk&&t.Rc&&oe.F("Skinning and vertex animation are mutually exlusive")}}function y(e,t,a){if(t.length){for(var r=Y.wu(t,se.ssao&&a.b4w_enable_ssao),n=e.Ra,o=e.gm,i=0,_=0;_<e.Ra.He.length;_++){var s=e.Ra.He[_];if("LIGHTING_LAMP"==s.id){var c=t[i++%t.length],l=c.wb,f=Y.ya(c,a);if("SPOT"==l.type||"POINT"==l.type)var u=Math.cos(l.Cm/2);if("SPOT"==l.type)var d=l.Sr*(1-u);c=r.indexOf(c),s.Ua=[["LAMP_TYPE",l.type],["LAMP_IND",f.cr],["LAMP_SPOT_SIZE",ee.R(u||.01)],["LAMP_SPOT_BLEND",ee.R(d||.01)],["LAMP_LIGHT_DIST",ee.R(l.distance)],["LAMP_USE_SPHERE",l.wB?1:0],["LAMP_SHADOW_MAP_IND",c]]}else if("LAMP"==s.id&&o)for(var f=s.Ua[0][1],p=0;p<t.length;p++)c=t[p],o[c.Kj]==f&&(l=c.wb,"SPOT"!=l.type&&"POINT"!=l.type||(u=Math.cos(l.Cm/2)),"SPOT"==l.type&&(d=l.Sr*(1-u)),s.Ua.push(["LAMP_TYPE",l.type],["LAMP_SPOT_SIZE",ee.R(u||.01)],["LAMP_SPOT_BLEND",ee.R(d||.01)],["LAMP_LIGHT_DIST",ee.R(l.distance)],["LAMP_USE_SPHERE",l.wB?1:0]))}if(o){a=0;for(var m in o)a++;for(e.$n=new Float32Array(3*a),e.Yq=new Float32Array(3*a),e.Xq=new Float32Array(3*a),ee.ka(n,"NUM_LAMP_LIGHTS",a),_=0;_<t.length;_++)S(e,t[_])}}}function S(e,t){if(t.Kj in e.gm){var a=e.gm[t.Kj],r=re.get_trans_view(t.o.v);e.$n.set(r,3*a),e.Yq.set(t.wb.direction,3*a),e.Xq.set(t.wb.iq,3*a)}}function O(e,t){for(var a=0;a<t.length;a++){var r=t[a].settings.b4w_vcol_from_name,n=t[a].settings.b4w_vcol_to_name;""!==r&&""!==n&&(e.Fc[r]={Vl:!1,src:[{name:r,Dg:7}]})}}function w(e,t){var a=e.Oi;-1==a.indexOf(t)&&a.push(t),e.Oi=a.sort()}function R(e,t,a){ee.ka(e.Ra,t,a)}function L(e,t){if("PHYSICS"==e.type)"NAVMESH"==e.sb?e.ga=ne.IH(t,ne.Ym,[]):(0<t.fb.length&&ne.gU(t,t.$[0]),e.Id=t);else{var a=e.bh;e.Fu&&"PARTICLES"!=e.type&&(t=ne.HO(t)),e.ex&&(t=J.eP(e.fx,e.gx,e.dx)),a=ne.IH(t,a,e.Fc),e.ga=a,e.fe||e.Pe||e.Me||(a.Td=null,a.Yb.length=0),a=t.$.length,e.num_vertices=t.Na*a;var r;e:switch(e.bh){case ne.Ym:case ne.op:case ne.ws:r=!0;break e;default:r=!1}r?ne.GQ(t)?e.num_triangles=t.qa.length/3*a:e.num_triangles=t.Na/3*a:e.num_triangles=0}}function N(e,t,r,n,o,i,_,s,l,f,u,d){var p=e.Xa,m=[],g=s.b4w_dynamic_grass;if(!f&&g)return m;for(var h="INSTANCE"==s.b4w_wind_bend_inheritance,v="INSTANCE"==s.b4w_shadow_inheritance,b="INSTANCE"==s.b4w_reflection_inheritance,E=[],A=[],x=0;x<o.length;x++){var y=o[x].Xa.o,S=Y.fy(t);S.pg=s.b4w_hair_billboard,S.Mp=s.b4w_hair_billboard_type,S.Lp="SPHERICAL"==s.b4w_hair_billboard_geometry,S.Dc=g,S.nk=!0,h?(S.ve=y.ve,S.Wm=y.Wm,S.yf=y.yf,S.df=y.df,S.kj=y.kj,S.cf=y.cf,S.Xe=y.Xe,S.xf=y.xf,S.Ce=y.Ce,S.wl=!1):(S.ve=p.o.ve,S.Wm=p.o.Wm,S.yf=p.o.yf,S.df=p.o.df,S.kj=p.o.kj,S.cf=p.o.cf,S.Xe=p.o.Xe,S.xf=p.o.xf,S.Ce=p.o.Ce,S.wl=!0),v?(S.Je=y.Je,S.pe=y.pe,S.Gd=y.Gd):(S.Je=p.o.Je,S.pe=p.o.pe,S.Gd=p.o.Gd),b?(S.Yd=y.Yd,S.Dd=y.Dd,S.Cd=y.Cd,S.Qd=y.Qd,S.zd=y.zd,S.xh=y.xh):(S.Yd=p.o.Yd,S.Dd=p.o.Dd,S.Cd=p.o.Cd,S.Qd=p.o.Qd,S.zd=p.o.zd,S.xh=p.o.xh),E.push(S);var O=_[x];O||(O=new Float32Array),d&&oe.Pu(l.seed,u);var w=new Float32Array(3),L=new Float32Array([0,0,0,1]),N=[],C=Q.kD(se.Az)&&!s.b4w_initial_rand_rotation&&!s.b4w_hair_billboard,D=4;C&&(D=8);for(var U=0;U<O.length;U+=D){w[0]=O[U],w[1]=O[U+1],w[2]=O[U+2];var k=O[U+3]*re.get_scale(y.v);if(s.b4w_initial_rand_rotation){switch(s.b4w_rotation_type){case"XYZ":var P=new Float32Array([oe.Jg(u),oe.Jg(u),oe.Jg(u)]);ie.normalize(P,P);break;case"Z":P=new Float32Array([0,0,1]);break;default:oe.F("Unsupported random rotation type: "+s.b4w_rotation_type)}K.setAxisAngle(P,s.b4w_rand_rotation_strength*(2*Math.PI*oe.Jg(u)-Math.PI),L)}else if(C&&(L.set(O.subarray(U+4,U+8)),oe.oA(L,L),!s.use_whole_group))if(s.use_rotation_dupli){var j=re.get_quat_view(y.v);K.multiply(L,j,L)}else K.multiply(L,ue,L);var B=re.set_sep(w,k,L,re.create());N.push(B)}A.push(N)}for(var X={},q=0,x=0;x<o.length;x++)for(var z=o[x].data.materials,U=0;U<z.length;U++)z[U].name in X?X[z[U].name]++:(X[z[U].name]=1,q++);for(var q=q||1,W={},x=0;x<o.length;x++){var V=o[x],J=i[x],S=E[x],Z={};if(S.ve&&(Z.au_wind_bending_amp=[S.xf],Z.au_wind_bending_freq=[S.yf],Z.au_detail_bending_freq=[S.df],Z.au_detail_bending_amp=[S.cf],Z.au_branch_bending_amp=[S.Xe],S.xf=0,S.yf=0,S.df=0,S.cf=0,S.Xe=0),N=A[x],N.length){for(var $=V.data,z=$.materials,ee=Array(z.length),te=Array(z.length),U=0;U<z.length;U++)if(!F(p,U)&&!ne.XE($,U))for(var ae=0;ae<J.length;ae++){var _e=J[ae],ce=a(_e),le=z[U];if("MAIN"==_e?ee[U]=ce:"DEBUG_VIEW"==_e&&(te[U]=ce),ce.bq=e.b4w_cluster_data.cluster_id,I(ce,le)&&c(ce,le)){"SHADOW"==_e&&ee[U]&&(ce.Le=ee[U].Le),ce.bh=ne.Ym,T(ce,S),ce.zk=G(ce,S,s.uuid),ce.Vi=e.b4w_do_not_cull||s.b4w_dynamic_grass,"MAIN"==ce.type&&(ce.Jf=e.b4w_caustics),R(ce,"DISABLE_FOG",0|("COLOR_ID"!=_e&&"SHADOW"!=_e&&e.b4w_disable_fogging)),"JITTERED"==s.b4w_hair_billboard_type&&(ce.Xu=s.b4w_hair_billboard_jitter_amp,ce.Yu=s.b4w_hair_billboard_jitter_freq),g&&(ce.zu=s.b4w_dynamic_grass_scale_threshold),h||(delete ce.Fc.a_bending_col_main,delete ce.Fc.a_bending_col_detail);var fe=ne.$t($,U,ce.Oi,t.Oh,ce.Fc,ce.ui),de=p.o.v,pe=!0;if(1<X[le.name]){var me,ge=0;for(me in fe.$)ge++;pe=fe.qa.length*N.length*ge*X[le.name]>2e5*q}var he=se.xC&&pe&&"PHYSICS"!=ce.type;if(he){ce.fF=s.use_whole_group?2:1;var ve=ne.LM(fe);if(ne.$C(fe,ve,N),ve.Fe={$r:N,UA:de,BH:"STATIC"==t.type,vw:Z,so:{},St:g},S.ve&&S.wl){var be=ie.fromValues(0,0,0);re.transform_vec3(be,p.o.v,be);for(var Ee=[],Ae=0;Ae<N.length;Ae++)Ee.push(be[0],be[1],be[2]);ve.Fe.so.a_emitter_center={cc:3,data:Ee}}ne.$C(fe,fe,N),"STATIC"==t.type&&ne.VL(ve.Qc,de)}else{var xe=ve=ne.rR(fe,Z,N),Te=N;xe.oa.au_center_pos=new Float32Array(3*xe.Na);for(var ye=Te.length,Se=xe.Na/ye,Oe=0;Oe<ye;Oe++)for(var we=Te[Oe],Re=3*Se*Oe,Le=0;Le<Se;Le++)xe.oa.au_center_pos[Re+3*Le]=we[0],xe.oa.au_center_pos[Re+3*Le+1]=we[1],xe.oa.au_center_pos[Re+3*Le+2]=we[2];if(ve=xe,S.ve&&S.wl){var Ne=ve,Ie=p.o.v;Ne.oa.a_emitter_center=new Float32Array(3*Ne.Na);var Me=ie.fromValues(0,0,0);re.transform_vec3(Me,Ie,Me);for(var Ce=0;Ce<Ne.Na;Ce++)Ne.oa.a_emitter_center[3*Ce]=Me[0],Ne.oa.a_emitter_center[3*Ce+1]=Me[1],Ne.oa.a_emitter_center[3*Ce+2]=Me[2];ve=Ne}}var De=s.b4w_vcol_from_name,Ue=s.b4w_vcol_to_name,ke=ce,Pe=r,Ge=!h,Fe=$,je=[];if(""!==De&&""!==Ue){var Be,He=void 0,Xe=Ue,qe=ke.Fc,ze=[];for(He in qe)for(var We=qe[He].src,Ye=0,Ve=0;Ve<We.length;Ve++){var Je=We[Ve].Dg;Xe==We[Ve].name&&ze.push(He,Je,Ye),Ye+=oe.xm(Je)}if(Be=ze,0<Be.length)for(var Ke=0;Ke<Be.length;Ke+=3)je.push({Bq:De,Ut:7,Iv:Be[Ke],Jv:Be[Ke+1],Rt:Be[Ke+2]});else ne.hQ(ke.Oi,"a_color")&&Ue==Fe.active_vcol_name&&je.push({Bq:De,Ut:7,Iv:"a_color",Jv:7,Rt:0})}Ge&&("a_bending_col_main"in Pe&&je.push({Bq:"a_bending_col_main",Ut:4,Iv:"a_bending_col_main",Jv:4,Rt:0}),"a_bending_col_detail"in Pe&&je.push({Bq:"a_bending_col_detail",Ut:7,Iv:"a_bending_col_detail",Jv:7,Rt:0}));for(var Qe=ve,Ze=N,$e=n,et=je,tt=ce.Fc,at=he,rt=!1,nt=0;nt<et.length;nt++){var ot=et[nt].Bq,it=$e.oa[ot];if(it&&0<it.length){rt=!0;break}}if(at)var _t=Qe.Fe.so;if(rt){var st,ct=p.o.la,lt=$e.$[0].a_position,ft=Ze,ut=W,dt=new Float32Array(3),pt=new Float32Array(3),mt=new Uint32Array(ft.length);if(!("verts_indices"in ut)){ut.Mi=new Float32Array(3),ut.Hi=new Float32Array(3),ut.xB=new Uint32Array(lt.length/3),ut.jr=new Uint32Array(lt.length/3),ut.Mi[0]=(ct.max_x-ct.min_x)/20,ut.Mi[1]=(ct.max_y-ct.min_y)/20,ut.Mi[2]=(ct.max_z-ct.min_z)/20,ut.Hi[0]=ct.min_x,ut.Hi[1]=ct.min_y,ut.Hi[2]=ct.min_z;for(var gt=0;gt<lt.length/3;gt++){var ht=lt[3*gt+1],vt=lt[3*gt+2],bt=oe.trunc((lt[3*gt]-ut.Hi[0])/ut.Mi[0]),Et=oe.trunc((ht-ut.Hi[1])/ut.Mi[1]),At=oe.trunc((vt-ut.Hi[2])/ut.Mi[2]),bt=oe.clamp(bt,0,19),Et=oe.clamp(Et,0,19),At=oe.clamp(At,0,19);ut.xB[gt]=gt,ut.jr[gt]=At*Math.pow(20,2)+20*Et+bt}for(ne.PT(ut.jr,ut.xB,ne.yx,!0),ut.Qm=new Uint32Array(Math.pow(20,3)),gt=0;gt<ut.jr.length;gt++)ut.Qm[ut.jr[gt]]++;for(delete ut.jr,gt=1;gt<ut.Qm.length;gt++)ut.Qm[gt]+=ut.Qm[gt-1]}for(var xt=0;xt<ft.length;xt++){dt[0]=ft[xt][0],dt[1]=ft[xt][1],dt[2]=ft[xt][2];for(var Tt=1e10,yt=-1,St=oe.trunc((dt[0]-ut.Hi[0])/ut.Mi[0]),Ot=oe.trunc((dt[1]-ut.Hi[1])/ut.Mi[1]),wt=oe.trunc((dt[2]-ut.Hi[2])/ut.Mi[2]),St=oe.clamp(St,0,19),Ot=oe.clamp(Ot,0,19),wt=oe.clamp(wt,0,19),Rt=wt*Math.pow(20,2)+20*Ot+St,Lt=ut.Qm[Rt],Nt=0==Rt?0:ut.Qm[Rt-1];Nt<Lt;Nt++){var It=ut.xB[Nt];pt[0]=lt[3*It],pt[1]=lt[3*It+1],pt[2]=lt[3*It+2],ie.sub(pt,dt,pt);var Mt=ie.sqrLen(pt);Mt<=Tt&&(Tt=Mt,yt=It)}if(-1==yt)for(Nt=0;Nt<lt.length/3;Nt++)pt[0]=lt[3*Nt],pt[1]=lt[3*Nt+1],pt[2]=lt[3*Nt+2],ie.sub(pt,dt,pt),(Mt=ie.sqrLen(pt))<=Tt&&(Tt=Mt,yt=Nt);mt[xt]=yt}st=mt;for(var Ct=Qe.Na/Ze.length,nt=0;nt<et.length;nt++){var Dt=et[nt].Iv,Ut=et[nt].Jv,ot=et[nt].Bq,kt=et[nt].Ut,it=$e.oa[ot];switch(Dt){case"a_bending_col_main":var Pt=1;break;case"a_bending_col_detail":case"a_color":Pt=3;break;default:for(var Gt=Pt=0;Gt<tt[Dt].src.length;Gt++)Pt+=oe.xm(tt[Dt].src[Gt].Dg)}if(it&&0<it.length){var Ft=oe.xm(kt),jt=oe.xm(Ut),Bt=kt&Ut,Ht=oe.JG(Bt);if(Bt!=Ut&&H.error("Wrong color extraction from "+ot+" to "+Dt+"."),at)for(_t[Dt]={cc:Pt,data:[]},Gt=0;Gt<Ze.length;Gt++)for(Xt=st[Gt],qt=Xt*Ft,Vt=0;Vt<Ht.length;Vt++)Ht[Vt]&&(Jt=oe.Ao(kt,Vt),_t[Dt].data.push(it[qt+Jt]));else for("a_bending_col_main"!=Dt&&"a_bending_col_detail"!=Dt||(Qe.oa[Dt]=new Float32Array(Qe.Na*jt)),Gt=0;Gt<Ze.length;Gt++){var Xt=st[Gt],qt=Xt*Ft,zt=Gt*Ct*Pt;if(-1!=Xt)for(var Wt=0;Wt<Ct;Wt++)for(var Yt=Wt*Pt,Vt=0;Vt<Ht.length;Vt++)if(Ht[Vt]){var Jt=oe.Ao(kt,Vt);Qe.oa[Dt][zt+Yt+(et[nt].Rt+oe.Ao(Ut,Vt))]=it[qt+Jt]}}}else Qe.oa[Dt]=new Float32Array(0)}}ve=Qe,R(ce,"USE_INSTANCED_PARTCLS",ve.Fe?1:0),M(ce),m.push({ra:ce,Yf:t,Zs:S,Id:ve,Fg:[le.name],Ed:[e]})}}for(U=0;U<te.length;U++)te[U]&&(te[U].tn=ee[U].id,M(te[U]))}}return m}function I(e,t){var a=!0;return"NODES_GLOW"==e.type&&(a=W.iD(t)),a}function M(e){C(e,function(e){e.id=0,e.id=oe.aD(e)})}function C(e,t){for(var a=null,r=null,n=[],o=0;o<e.fa.length;o++){var i=e.fa[o],_=i.rg;_&&(a||(a={}),a[o]=_,i.rg=null),(_=i.Wa)&&(r||(r={}),r[o]=_,i.Wa=null),n.push(i.eG),i.eG=0}i=e.Ta,e.Ta=null,_=e.Ne,e.Ne=null;var s=e.ga;e.ga=null;var c=e.Id;if(e.Id=null,t(e),e.ga=s,e.Id=c,e.Ne=_,e.Ta=i,a)for(o in a)e.fa[o].rg=a[o];if(r)for(o in r)e.fa[o].Wa=r[o];for(o=0;o<e.fa.length;o++)e.fa[o].eG=n[o]}function D(e,t,r,n){var o=a("DEBUG_VIEW");if(U(o,"debug_view.glslv","debug_view.glslf"),o.Ti=!0,o.Ya=!0,o.zk=G(o,e,t),o.Mt=r,T(o,e),M(o),n.al){e=n.Ta.ye;var i=ie.create();t=J.Ky(1,i),r=ie.fromValues(ie.length(e.Ia),ie.length(e.Ja),ie.length(e.Ka)),ne.OG(t,r,i);var i=ie.normalize(e.Ia,de),_=ie.normalize(e.Ja,pe),s=ie.normalize(e.Ka,me);!r[0]&&r[1]&&r[2]?ie.cross(_,s,i):!r[1]&&r[0]&&r[2]?ie.cross(s,i,_):!r[2]&&r[0]&&r[1]&&ie.cross(i,_,s),r=oe.wO(i,_,s,ve),z.invert(r,r),r=K.fromMat3(r,ge),re.set_quat(r,he),re.set_scale(1,he),re.set_trans(e.N,he),ne.XA(t,he)}else e=n.Ta.ze,t=J.Ky(e.ab,e.N);return j.GD(n.Ta,o.Ta),ne.uw(t,1,!0),t.oa.a_polyindex=ne.Zt(t),L(o,t),o}function U(e,t,a){e.Ra.uf=t,e.Ra.ge=a,ee.eT(e.Ra)}function k(e,t,a,r){r=r||"",-1==e.rf.indexOf(a)&&(e.fa.push(t),e.rf.push(a),e.We.push(r)),e.ib&&Z.FC(e)}function P(e){e.Ra||oe.F("No shaders info for batch "+e.name),e.ib=ee.xP(e.Ra);var t=e.Ra;if(t.status===ee.gC){var a,r=e.ib.attributes,n=e.ga.xb;for(a in r)n[a]||oe.F('missing data for "'+a+'" attribute')}return t.status&ee.XI&&H.error("Texture limit exceeded for shader - "+t.ge+', materials: "'+e.Pb.join(", ")+'". Maximum texture count: '+ce.Iz+", actual texture count: "+t.Bw),t.status&ee.WI&&H.error("Fragment uniform limit exceeded for shader - "+t.ge+', materials: "'+e.Pb.join(", ")+'". '),t.status&ee.$I&&H.error("Vertex uniform limit exceeded for shader - "+t.uf+', materials: "'+e.Pb.join(", ")+'". '),t.status&ee.ZI&&H.error("Vertex attribute limit exceeded for shader - "+t.uf+', materials: "'+e.Pb.join(", ")+'". Maximum attribute count: '+ce.Jz+", actual attribute count: "+t.Us),t.status&ee.YI&&("MAIN"!=e.type||e.nb||H.error("Varying limit exceeded for shader - "+e.Ra.ge+', materials: "'+e.Pb.join(", ")+'"'),"MAIN"==e.type&&e.nb||"NODES_GLOW"==e.type)&&(n=r=0,e.ui&&(r=oe.$i(e.ui)),e.Fc&&(n=oe.$i(e.Fc)),H.error("Varying limit exceeded for node shader - "+e.Ra.ge+", uv: "+r+", vc: "+n+', materials: "'+e.Pb.join(", ")+'"')),t.status&ee.UI&&H.error("Shader compilation/linking error: "+t.uf+", "+t.ge+', materials: "'+e.Pb.join(", ")+'"'),e.Ra.status===ee.gC&&(Z.FL(e.ib),Z.Ts(e),Z.FC(e),!0)}function G(e,t,a){return"NAVMESH"==e.sb?a:t.fe?"_odd_id_"+oe.$H():a}function F(e,t){return 0<=t&&t<e.xc.bm.length&&e.xc.bm[t]}var j=t("__boundings"),B=t("__config"),H=t("__print"),X=t("__extensions"),q=t("__graph"),z=t("__mat3"),W=t("__nodemat"),Y=t("__obj_util"),V=t("__particles"),J=t("__primitives"),K=t("__quat"),Q=t("__reformer"),Z=t("__renderer"),$=t("__scenegraph"),ee=t("__shaders"),te=t("__subscene"),ae=t("__textures"),re=t("__tsr"),ne=t("__geometry"),oe=t("__util"),ie=t("__vec3"),_e=t("__vec4"),se=B.H,ce=B.Zg,le=B.Co,fe=B.$E,ue=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),de=new Float32Array(3),pe=new Float32Array(3),me=new Float32Array(3),ge=new Float32Array(4),he=re.create(),ve=z.create(),be={},Ee=new Float32Array(24);e.KL=function(e){return be[e]||null},e.LL=function(e,t){be[e]=t},e.IM=r,e.vE=function(e,t,a,r){var n;n=e.G.va;for(var s=[],c=0;c<t.length;c++){var l=t[c],f=l.Xa;f.Uq||s.push.apply(s,i(l,f.o,n))}for(n=_(s),s=0;s<n.length;s++)if(c=n[s].ra,c.Pb=n[s].Fg,L(c,n[s].Id),y(c,a,e),"STATIC"==n[s].o.type&&"COLOR_ID"!=c.type){var l=oe.cs("%meta%"+c.type+"%"+c.Pb.join("%")+"%"),u=Y.qn(l,"MESH");if(Y.BR(u,n[s].o),Y.Bp(u,e),Y.Ff(u,e,c),r.push(u),"MAIN"==c.type)for(f=0;f<n[s].Ed.length;f++)l=n[s].Ed[f].Xa,l.er.push(u)}else l=n[s].Ed[0].Xa,Y.Ff(l,e,c);if(se.debug_view){for(s=0;s<n.length;s++)if(a=n[s].o,"DYNAMIC"==a.type&&(l=n[s].Ed[0].Xa,c=n[s].ra,"MAIN"==c.type)){for(var f=Y.ya(l,e),u=f.U,d=!1,f=0;f<u.length;f++)u[f].Ti&&(d=!0);d||(a=D(a,l.name,!0,c),Y.Ff(l,e,a))}for(s=0;s<r.length;s++)l=r[s],a=l.o,f=Y.ya(l,e),c=f.U[0],"MAIN"==c.type&&(a=D(a,l.name,!1,c),Y.Ff(l,e,a));for(s=0;s<n.length;s++)c=n[s].ra,"DEBUG_VIEW"==c.type&&(c.Kt=s)}for(s=0;s<t.length;s++)for(f=Y.ya(t[s].Xa,e),u=f.U,f=0;f<u.length;f++)o(u[f]);for(s=0;s<r.length;s++)for(f=Y.ya(r[s],e),u=f.U,f=0;f<u.length;f++)o(u[f])},e.rL=function(e,t,n){var i=e.G.jl,_=a("MAIN");if(U(_,"sky.glslv","sky.glslf"),_.ej=!0,t.procedural_skydome)R(_,"PROCEDURAL_SKYDOME",1),_.Qt=!0;else{var s=i.Am;k(_,$.bc(e.G.va,te.ae).B.$b,"u_sky"),s&&(R(_,"WO_SKYTEX",1),s.invert&&R(_,"MTEX_NEGATIVE",1),s.uI&&R(_,"MTEX_RGBTOINT",1),R(_,"BLENDTYPE",s.SC),s.pI&&R(_,"WOMAP_BLEND",1),s.qI&&R(_,"WOMAP_HORIZ",1),s.sI&&R(_,"WOMAP_ZENUP",1),s.rI&&R(_,"WOMAP_ZENDOWN",1)),i.Jm&&R(_,"WO_SKYBLEND",1),i.Km&&R(_,"WO_SKYPAPER",1),i.Lm&&R(_,"WO_SKYREAL",1)}t.Yd&&(_.Yd=!0,t.Dd&&(_.Dd=!0)),w(_,"a_position"),t=J.iP(),L(_,t),o(_),_.Vi=!0,M(_),Y.Ff(n,e,_),$.bc(e.G.va,te.Sg)&&(i=r(_),i.type="DEBUG_VIEW",i.sb="",x(i),R(i,"DEBUG_VIEW_SPECIAL_SKYDOME",1),t.oa.a_polyindex=ne.Zt(t),L(i,t),i.tn=_.id,M(i),Y.Ff(n,e,i))},e.Ct=function(e,t,a){var n=Y.ya(e,a).U,o=[],i=$.bc(t,te.Nd),_=$.bc(t,te.kd),s=$.bc(t,te.Tg);t=$.bc(t,te.we);for(var c=0;c<n.length;c++){var l=n[c],f=null;"SHADOW"==l.type&&"RECEIVE"==l.sb&&l.Je&&(f=r(l),f.sb="CAST"),"MAIN"!=l.type&&"PARTICLES"!=l.type||!i&&!_||!l.Yd||(f=r(l),f.sb="REFLECT",f.rj=!1,f.Pe&&(f.Pe=!1,f.Ya=!1),f.Ba=l.Ba),"COLOR_ID"==l.type&&s&&e.o.Oc&&(t&&e.o.Kk?(f=r(l),f.sb="OUTLINE"):l.sb="OUTLINE"),f&&(f.wg=!0,M(f),o.push(f))}for(n=0;n<o.length;n++)Y.Ff(e,a,o[n])},e.MI=function(e,t,a){return(t=a*(t.max_z-t.min_z))?.5*(Math.sqrt(2*Math.sqrt(4*t*Math.tan(e)+1)+2)/2-1)/t:0},e.BV=function(e,t,a){return(t=a*(t.max_z-t.min_z))?(e*=2*t,Math.atan((Math.pow(e+1,4)-Math.pow(e+1,2))/t)):0},e.ML=function(e){var t=j.Be();return t.max_x=e.max_x,t.min_x=e.min_x,t.max_y=e.max_y,t.min_y=e.min_y,t.max_z=e.max_z,t.min_z=e.min_z,t},e.xU=A,e.wU=y,e.lT=S,e.EC=function(e,t){if(R(e,"CSM_SECTION1",0),R(e,"CSM_SECTION2",0),R(e,"CSM_SECTION3",0),R(e,"NUM_CAST_LAMPS",0),t){R(e,"NUM_CAST_LAMPS",t.lh.length),se.iv&&R(e,"MAC_OS_SHADOW_HACK",1);for(var a=1;a<t.csm_num;a++)R(e,"CSM_SECTION"+String(a),1);R(e,"SHADOW_TEX_RES",ee.R(t.csm_resolution)),R(e,"CSM_FADE_LAST_CASCADE",t.fade_last_cascade?1:0),R(e,"CSM_BLEND_BETWEEN_CASCADES",t.blend_between_cascades?1:0)}else R(e,"SHADOW_TEX_RES",0),R(e,"CSM_FADE_LAST_CASCADE",0),R(e,"CSM_BLEND_BETWEEN_CASCADES",0)},e.qb=R,e.$c=function(e,t){return ee.EP(e.Ra,t)},e.uU=L,e.vU=M,e.JU=function(e,t){e.Ta.ee=j.Nx(t,0,t.length,e.Ta.ee);var a=j.fE(e.Ta.ee,Ee);e.Ta.ye=j.zt(a,!0),e.Ta.ze=j.Bt(e.Ta.ye),e.al=j.hF(e.Ta.ye,e.Ta.ze)},e.Rs=U,e.Rj=k,e.CS=function(e,t,a){-1<(a=e.rf.indexOf(a))&&(e.fa[a]=t)},e.vN=function(e,t){var r=a("MAIN");return r.kb=!0,_e.set(t[0],t[1],t[2],.5,r.ud),r.bh=ne.op,L(r,e),U(r,"main.glslv","main_stack.glslf"),R(r,"SHADELESS",1),P(r),r},e.zc=P,e.uE=function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=a("LINE");U(i,"line.glslv","line.glslf"),i.kb=!0,i.Vi=!0;L(i,J.kP()),o(i),Y.Bp(n,e),Y.Ff(n,e,i),P(i)}},e.oM=function(e){return!!e.ib.nr.length&&!!e.ib.jA.u_cube_fog},e.dN=function(){var e=a("DEPTH_PACK");return e.gc=!0,e.Ya=!1,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf"),P(e),e},e.Dt=function(e){var t=a("POSTPROCESSING");switch(U(t,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf"),e){case"NONE":R(t,"POST_EFFECT","POST_EFFECT_NONE");break;case"GRAYSCALE":R(t,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case"X_BLUR":case"Y_BLUR":R(t,"POST_EFFECT","POST_EFFECT_BLUR");break;case"X_GLOW_BLUR":case"Y_GLOW_BLUR":case"X_BLOOM_BLUR":case"Y_BLOOM_BLUR":R(t,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case"X_DOF_BLUR":case"Y_DOF_BLUR":R(t,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case"X_ALPHA_BLUR":case"Y_ALPHA_BLUR":R(t,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case"X_EXTEND":case"Y_EXTEND":R(t,"POST_EFFECT","POST_EFFECT_EXTEND");break;case"FLIP_CUBEMAP_COORDS":R(t,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:oe.F("Wrong postprocessing effect: "+e)}return R(t,"SHADOW_USAGE","NO_SHADOWS"),t.gc=!0,t.Ya=!1,e=J.Zc(),L(t,e),P(t),t},e.yN=function(e){var t=a("SSAO");t.Ya=!1,t.gc=!0;var r=J.Zc();return L(t,r),U(t,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf"),R(t,"SSAO_QUALITY","SSAO_QUALITY_"+e.Dm),R(t,"SSAO_HEMISPHERE",e.No?1:0),R(t,"SHADOW_USAGE","NO_SHADOWS"),e={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])},r=ae.Zj(ae.Ug,!1),r.source="NODE_TEX",ae.fs(r,e,0),k(t,r,"u_ssao_special_tex"),P(t),t},e.zN=function(e){var t=a("SSAO_BLUR");return t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf"),R(t,"SSAO_BLUR_DEPTH",e.Ko?1:0),R(t,"SHADOW_USAGE","NO_SHADOWS"),P(t),t},e.$M=function(e){var t=a("COC");switch(t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf"),R(t,"DEPTH_RGBA",1),e){case"COC_ALL":R(t,"COC_TYPE","COC_ALL");break;case"COC_FOREGROUND":R(t,"COC_TYPE","COC_FOREGROUND");break;case"COC_COMBINE":R(t,"COC_TYPE","COC_COMBINE")}return R(t,"SHADOW_USAGE","NO_SHADOWS"),P(t),t},e.eN=function(e){var t=a("DOF");return t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf"),e.B.dof_bokeh?R(t,"DOF_TYPE","DOF_BOKEH"):(R(t,"DOF_TYPE","DOF_SIMPLE"),R(t,"DEPTH_RGBA",1)),R(t,"SHADOW_USAGE","NO_SHADOWS"),P(t),t},e.nN=function(){var e=a("OUTLINE");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf"),P(e),e},e.gN=function(){var e=a("GLOW_COMBINE");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf"),P(e),e},e.hN=function(e,t,r){var n=a("GOD_RAYS");return n.Ya=!1,n.gc=!0,L(n,J.dP()),U(n,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf"),R(n,"DEPTH_RGBA",e?1:0),R(n,"WATER_EFFECTS",t?1:0),R(n,"STEPS_PER_PASS",ee.R(r,1)),R(n,"SHADOW_USAGE","NO_SHADOWS"),P(n),n},e.iN=function(){var e=a("GOD_RAYS_COM");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf"),R(e,"SAFARI_CANVAS_ALPHA_HACK",se.NG?1:0),P(e),e},e.bN=function(e,t){var r=a("SKY");r.Ya=!1,r.gc=!1;var n=J.nP();return L(r,n),""!=t.jw?(U(r,"skybox.glslv","node_skybox.glslf"),R(r,"IS_WORLD",1),v(r,e)):t.procedural_skydome?(U(r,"skybox.glslv","proc_skybox.glslf"),R(r,"WATER_EFFECTS",1)):(U(r,"skybox.glslv","tex_skybox.glslf"),e&&(n=e.G.jl,n.lw&&k(r,ae.he(n.lw),"u_sky_texture",n.lw.texture.name),n.Am&&R(r,"WO_SKYTEX",1)),t.iw&&R(r,"MTEX_NEGATIVE",1),t.qw&&R(r,"MTEX_RGBTOINT",1),R(r,"BLENDTYPE",t.hw),t.mw&&R(r,"WOMAP_BLEND",1),t.nw&&R(r,"WOMAP_HORIZ",1),t.pw&&R(r,"WOMAP_ZENUP",1),t.ow&&R(r,"WOMAP_ZENDOWN",1),t.Jm&&R(r,"WO_SKYBLEND",1),t.Km&&R(r,"WO_SKYPAPER",1),t.Lm&&R(r,"WO_SKYREAL",1)),P(r),r},e.kL=function(e,t){var a=$.bc(e.G.va,te.ae);a&&Y.Ff(t,e,a.Pa[0].Ca[0].ra)},e.WM=function(e){var t=a("ANTIALIASING");return t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf"),se.xG?(R(t,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),R(t,"AA_QUALITY",e.ju)):R(t,"AA_METHOD","AA_METHOD_FXAA_LIGHT"),P(t),t},e.wN=function(e){var t=a("SMAA");return L(t,J.Zc()),U(t,"postprocessing/smaa.glslv","postprocessing/smaa.glslf"),R(t,"AA_METHOD","AA_METHOD_SMAA_HIGH"),R(t,"SMAA_PASS",e),R(t,"SMAA_PREDICATION",0),R(t,"SMAA_REPROJECTION",0),P(t),t.Ya=!1,t.gc=!0,t},e.aN=function(){var e=a("COMPOSITING");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf"),P(e),e},e.mN=function(){var e=a("MOTION_BLUR");return e.gc=!0,e.Ya=!1,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf"),P(e),e},e.AN=function(e){var t=a("STEREO");return t.gc=!0,t.Ya=!1,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf"),R(t,"ANAGLYPH","ANAGLYPH"===e?1:0),R(t,"DISTOR_SCALE",fe.nonwebvr.$D),P(t),t},e.jN=function(){var e=a("LUMINANCE");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf"),P(e),e},e.XM=function(){var e=a("LUMINANCE");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf"),P(e),e},e.kN=function(e){var t=a("LUMINANCE_X_BLUR");return t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf"),e&&ee.ka(t.Ra,"ADAPTIVE_BLOOM",1),P(t),t},e.ZM=function(e){var t=a("BLOOM");if(t.Ya=!1,t.gc=!0,L(t,J.Zc()),U(t,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf"),1==e)var r="BLUR_PASS_1";else 2==e?r="BLUR_PASS_2":3==e?r="BLUR_PASS_3":4==e?r="BLUR_PASS_4":5==e&&(r="BLUR_PASS_5");return ee.ka(t.Ra,"BLUR_PASS_NUM",r),P(t),t},e.YN=function(){var e=a("VELOCITY");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf"),P(e),e},e.VM=function(){var e=a("ANCHOR_VISIBILITY");return e.Ya=!0,e.gc=!0,e.bh=ne.op,U(e,"anchors.glslv","anchors.glslf"),L(e,J.tE(1)),R(e,"ANCHOR_NUM",1),P(e),e.ql=new Float32Array(3),e},e.pN=function(){var e=a("PERFORMANCE");return e.Ya=!1,e.gc=!0,L(e,J.Zc()),U(e,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf"),P(e),e},e.tU=function(e,t){var a=t.length/3;if(a!=e.ql.length/3){L(e,J.tE(a)),R(e,"ANCHOR_NUM",a),P(e)}e.ql=t},e.ou=function(e){return e.K.length?(e=e.K[0],e.U.length?e.U[0]:null):null},e.au=function(e,t){for(var a=e.K[0].U,r=0;r<a.length;r++)if("MAIN"==a[r].type&&-1!=a[r].Pb.indexOf(t))return a[r];return null},e.Va=function(e,t,a){e=e.K[0].U;for(var r=0;r<e.length;r++)if(e[r].type==a&&!e[r].wg&&-1!=e[r].Pb.indexOf(t))return e[r];return null},e.Of=function(e,t,a){e=e.K[0].U;for(var r=0;r<e.length;r++)if(e[r].type==a&&e[r].wg&&-1!=e[r].Pb.indexOf(t))return e[r];return null},e.uz=function(e,t,a,r){e=e.K[0].U;for(var n=0;n<e.length;n++){var o=e[n];if(-1!=o.Pb.indexOf(t)&&(!r||o.type==r)&&a(o))break}},e.QW=function(e,t){for(var a=e.K[0].U,r=0;r<a.length;r++)if(a[r].type==t)return!0;return!1},e.Mq=function(e,t){for(var a=(t?Y.ya(e,t):e.K[0]).U,r=0;r<a.length;r++)if("SKY"==a[r].type)return a[r];return null},e.vD=function(e){var t=e.fa;e.fa=[];for(var a=0;a<t.length;a++)ae.uD(t[a]);e.fa=t,e.ga&&e.ga.sg&&ne.CM(e.ga),e.sg&&e.Ne.length&&Z.FM(e),e.ib&&e.ib.sg&&ee.EM(e.ib),e.Wd&&(t=W.uu(e.Wd))&&t.tD&&W.DM(e.Wd)},e.mP=G,e.cleanup=function(){be={}}},a.module.__nodemat=function(e,t){function a(e,t,n,o,_){var s="";if(ye.Fa()&&(s=ye.get_active().uuid),(s=g(t,_,s))in Le)return Le[s];var c={va:null,id:s,tD:!0};if(n||(Ie={},Me=0),"SHADOW"!=_&&"COLOR_ID"!=_){t=ve.create();for(var l=e.nodes,f=0;f<l.length;f++)if(null==j(t,l[f],0,o,_))return Le[s]=null,c;if(n&&-1==P(e,t,"GROUP_OUTPUT","group"))return c;if(f=_e(t),l=n?e.links:e.links.slice(),!se(t,l,f))return c;if(n)return c.va=t,c;for(f=0;f<l.length;f++){n=l[f];for(var E=T(n.from_node,t),S=T(n.to_node,t),w=0;w<E.length;w++)for(var R=0;R<S.length;R++){var L=E[w],N=S[R],I=ve.Qa(t,L),M=ve.Qa(t,N);if(!oe(t,L,N,I,M,n))return Le[s]=null,c}}x(t),f=!1,l=-1,"GLOW"==_?l=P(e,t,"B4W_GLOW_OUTPUT","material",!0):(l=P(e,t,"OUTPUT","material",!1,!0),-1==l&&(l=P(e,t,"OUTPUT_MATERIAL","material",!1,!0)),-1==l&&(l=P(e,t,"OUTPUT_WORLD","material",!1,!0),f=!0)),-1==l&&(t=v(),l=0),y(t),e=ve.Rk(t,l,ve.Pj),f?(u(e),d(e,_),p(e),m(e)):(r(e,o),i(e,o)),b(e),O(e),D(e),A(e,o,_),pe(e)}else o=a(e,t,n,o,"MAIN"),o=ve.clone(o.va,function(e){var t=Se.aq(e);return t.inputs=Se.P(e.inputs),t.outputs=Se.P(e.outputs),t}),l=P(e,o,"OUTPUT","material",!1,!0),-1==l&&(l=P(e,o,"OUTPUT_MATERIAL","material",!1,!0)),h(o,l),e=ve.Rk(o,l,ve.Pj),b(e);return c.va=e,Le[s]=c}function r(e,t){var a=[];ve.X(e,function(e,t){"MATERIAL"!=t.type&&"MATERIAL_EXT"!=t.type||a.push({ne:e,node:t})});for(var r=0;r<a.length;++r){var o=a[r].ne,i=a[r].node,_=ve.Zi(e);ve.Yg(e,_,i.data.tR);var s=ve.Zi(e);ve.Yg(e,s,i.data.uR),ve.vc(e,_,s,[4,2]);for(var c={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},l=ve.ci(e,o),f=[],u=[],d=[],p={},m=0;m<l;m++){var g=ve.Rf(e,o,m);g in p||(p[g]=0);var h=ve.Ec(e,g,o,p[g]++);f.push([g,o,h]);var v=c[h[1]];if(v)switch(v[0]){case"MATERIAL_END":u.push([g,s,[h[0],v[1]]]);break;case"LIGHTING_APPLY":d.push([g,[h[0],v[1]]])}else u.push([g,_,h])}for(n(e,i.data.value,_,s,d,t),m=0;m<f.length;m++)ve.yh(e,f[m][0],f[m][1],f[m][2]);for(m=0;m<u.length;m++)ve.vc(e,u[m][0],u[m][1],u[m][2]);for(i=ve.Zf(e,o),_=[],c=[],l={},m=0;m<i;m++)f=ve.yg(e,o,m),f in l||(l[f]=0),h=ve.Ec(e,o,f,l[f]++),_.push([o,f,h]),c.push([s,f,h]);for(m=0;m<_.length;m++)ve.yh(e,_[m][0],_[m][1],_[m][2]);for(m=0;m<c.length;m++)ve.vc(e,c[m][0],c[m][1],c[m][2]);ve.nf(e,o)}}function n(e,t,a,r,n,i){var _={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},s=j(e,_,0,i,null),c=s;if(o(e,a,s,"E"),o(e,a,s,"A"),o(e,a,s,"D"),s=ye.get_active(),s=Ae.Hb(s,"LAMP",Ae.DATA_ID_ALL),!t.Le)for(var l,f,u,d=0;d<s.length;d++){for(u=s[d].wb,_={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},l=j(e,_,0,i,null),_={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},f=j(e,_,0,i,null),o(e,c,f,"color"),o(e,c,f,"specular"),o(e,l,f,"ldir"),o(e,a,f,"normal"),o(e,a,f,"D"),o(e,a,f,"S"),o(e,l,f,"lcolorint"),o(e,a,l,"shadow_factor"),c="SPECULAR_"+t.Qr,_={name:c,type:c,use_tangent_shading:t.Nm},c=j(e,_,0,i,null),o(e,l,c,"ldir"),o(e,l,c,"lfac"),o(e,a,c,"normal"),o(e,c,f,"sfactor"),o(e,l,c,"norm_fac"),o(e,a,c,"sp_params"),c="HEMI"==u.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+t.uq,_={name:c,type:c,use_tangent_shading:t.Nm},u=j(e,_,0,i,null),o(e,l,u,"ldir"),o(e,l,u,"lfac"),o(e,a,u,"normal"),o(e,l,u,"norm_fac"),o(e,u,f,"lfactor"),"DIFFUSE_LAMBERT"!=c&&o(e,a,u,"dif_params"),l=0;l<n.length;l++)ve.vc(e,n[l][0],f,n[l][1]);c=f}o(e,c,r,"color"),o(e,c,r,"specular")}function o(e,t,a,r){for(var n=ve.Qa(e,t),o=-1,i=ve.Qa(e,a).inputs,_=0;_<i.length;_++)if(r==i[_].identifier){o=_;break}if(-1!=o){for(var s=-1,n=n.outputs,_=0;_<n.length;_++)if(r==n[_].identifier){s=_;break}-1!=s&&(ve.vc(e,t,a,[s,o]),n[s].Da=!0,i[o].Da=!0)}}function i(e,t){var a=[];ve.X(e,function(e,t){"OUTPUT_MATERIAL"==t.type&&a.push({ne:e,node:t})});for(var r=0;r<a.length;++r){var n=a[r].ne,o=a[r].node,i=!1,s=!1,c=ve.Zi(e);ve.Yg(e,c,o.data.QR);for(var f=ve.ci(e,n),u=[],d=[],p={},m=0;m<f;m++){var g=ve.Rf(e,n,m);g in p||(p[g]=0);var h=ve.Ec(e,g,n,p[g]++);switch(u.push([g,n,h]),h[1]){case 0:i=!0,d.push([g,c,h]);break;case 2:var s=!0,v=ve.Zi(e);ve.Yg(e,v,o.data.mO),d.push([g,v,[h[0],0]])}}for(m=0;m<u.length;m++)ve.yh(e,u[m][0],u[m][1],u[m][2]);for(m=0;m<d.length;m++)ve.vc(e,d[m][0],d[m][1],d[m][2]);ve.nf(e,n),i?(s&&_(e,c,v),l(e,t)):(n=ve.Qa(e,c),e.V=[0,n],e.xa=[])}}function _(e,t,a){t=ve.Rk(e,t,ve.Pj);var r=c(t);if(r.length){a=ve.Rk(e,a,ve.Pj),a=ve.clone(a,F,ne),ve.X(a,function(e,t){t.name="displacement%join%"+t.name}),ve.AC(a,t,[],[]);var n=-1;for(ve.X(t,function(e,t){if("DISPLACEMENT_BUMP"==t.type)return n=e,1}),a=0;a<r.length;a++){var i=r[a],_=ve.Qa(t,i);o(t,n,i,"Normal"),s(_)}}e.V=t.V,e.xa=t.xa}function s(e){e=e.Ua;for(var t=0;t<e.length;t++){var a=e[t];"USE_NORMAL_IN"==a[0]&&(a[1]=1)}}function c(e){var t=[];return ve.X(e,function(e,a){for(var r=!1,n=a.inputs,o=0;o<n.length;o++)if("Normal"==n[o].identifier){r=!n[o].Da;break}r&&t.push(e)}),t}function l(e,t){var a=[];ve.X(e,function(e,t){"OUTPUT_SURFACE"==t.type&&a.push({ne:e,node:t})});var r=[];a.length&&ve.X(e,function(e,t){"MIX_SHADER"==t.type&&r.push({ne:e,node:t})});for(var n=0;n<a.length;++n){var o=a[n].ne,i=a[n].node,_=ve.Zi(e);ve.Yg(e,_,i.data.YL);var s=ve.Zi(e);ve.Yg(e,s,i.data.ZL),ve.vc(e,_,s,[4,2]);for(var c=ve.ci(e,o),l=[],u=[],d={},p=0;p<c;p++){var m=ve.Rf(e,o,p),g=ve.Qa(e,m);m in d||(d[m]=0);var h=ve.Ec(e,m,o,d[m]++);if(l.push([m,o,h]),u.push([m,_,h]),"BSDF_GLOSSY"==g.type||"BSDF_DIFFUSE"==g.type||"MIX_SHADER"==g.type||"EMISSION"==g.type||"BSDF_TRANSPARENT"==g.type)for(u.push([m,_,[1,1]]),u.push([m,_,[2,2]]),u.push([m,_,[3,3]]),u.push([m,_,[4,4]]),u.push([m,_,[5,5]]),u.push([m,_,[6,6]]),u.push([m,_,[7,7]]),u.push([m,_,[8,8]]),u.push([m,_,[9,9]]),u.push([m,_,[10,10]]),m=0;m<r.length;++m)for(var g=r[m].ne,h=ve.ci(e,g),v=0;v<h;v++){var b=ve.Rf(e,g,v),E=ve.Qa(e,b),A=ve.Ec(e,b,g,0);0==A[1]||"BSDF_GLOSSY"!=E.type&&"BSDF_DIFFUSE"!=E.type&&"MIX_SHADER"!=E.type&&"EMISSION"!=E.type&&"BSDF_TRANSPARENT"!=E.type||(E=1==A[1]?3:13,u.push([b,g,[1,E]]),u.push([b,g,[2,E+1]]),u.push([b,g,[3,E+2]]),u.push([b,g,[4,E+3]]),u.push([b,g,[5,E+4]]),u.push([b,g,[6,E+5]]),u.push([b,g,[7,E+6]]),u.push([b,g,[8,E+7]]),u.push([b,g,[9,E+8]]),u.push([b,g,[10,E+9]]))}}for(f(e,i.data.value,_,s,t),u.push([s,o,[0,0]]),p=0;p<l.length;p++)ve.yh(e,l[p][0],l[p][1],l[p][2]);for(p=0;p<u.length;p++)ve.vc(e,u[p][0],u[p][1],u[p][2])}}function f(e,t,a,r,n){var i=[],_={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},s=j(e,_,0,n,null),c=s;o(e,a,s,"E"),o(e,a,s,"A"),o(e,a,s,"D");for(var l,f,s=ye.get_active(),s=Ae.Hb(s,"LAMP",Ae.DATA_ID_ALL),u=0;u<s.length;u++){for(_={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},l=j(e,_,0,n,null),_={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},f=j(e,_,0,n,null),o(e,c,f,"color"),o(e,c,f,"specular"),o(e,l,f,"ldir"),o(e,a,f,"normal"),o(e,a,f,"D"),o(e,a,f,"S"),o(e,l,f,"lcolorint"),o(e,a,l,"shadow_factor"),c=t.$L,_={name:c,type:c},c=j(e,_,0,n,null),o(e,l,c,"ldir"),o(e,l,c,"lfac"),o(e,a,c,"normal"),o(e,l,c,"norm_fac"),o(e,a,c,"bsdf_params"),o(e,c,f,"lfactor"),o(e,c,f,"sfactor"),c=0;c<i.length;c++)ve.vc(e,i[c][0],f,i[c][1]);c=f}o(e,a,r,"bsdf_params"),o(e,a,r,"d_color"),o(e,a,r,"s_color"),o(e,a,r,"e_color"),o(e,a,r,"emission"),o(e,a,r,"a_color"),o(e,a,r,"alpha"),o(e,c,r,"color"),o(e,c,r,"specular")}function u(e){var t=[];ve.X(e,function(e,a){"OUTPUT_WORLD"==a.type&&t.push({ne:e,node:a})});for(var a=0;a<t.length;++a){var r=t[a].ne,n=t[a].node,o=ve.Zi(e);ve.Yg(e,o,n.data.RR);for(var n=ve.ci(e,r),i=[],_=[],s={},c=0;c<n;c++){var l=ve.Rf(e,r,c);l in s||(s[l]=0);var f=ve.Ec(e,l,r,s[l]++);switch(i.push([l,r,f]),f[1]){case 0:_.push([l,o,f])}}for(c=0;c<i.length;c++)ve.yh(e,i[c][0],i[c][1],i[c][2]);for(c=0;c<_.length;c++)ve.vc(e,_[c][0],_[c][1],_[c][2]);ve.nf(e,r)}}function d(e,t){var a=[];if(ve.X(e,function(e,t){"MIX_SHADER"!=t.type&&"ADD_SHADER"!=t.type||a.push({ne:e,node:t})}),a.length)for(var r={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},n=0;n<a.length;n++){var o=a[n].ne,i=a[n].node;switch(r.name=i.name,r.fac=i.inputs[0].Aa,r.fac_is_linked=i.inputs[0].Da,r.color1_is_linked=i.inputs[1].Da,r.color2_is_linked=i.inputs[2].Da,i.type){case"ADD_SHADER":r.type="ADD_WORLD_RGB";break;case"MIX_SHADER":r.type="MIX_WORLD_RGB"}for(var i=j(e,r,0,"",t),_=ve.ci(e,o),s=[],c=[],l={},f=0;f<_;f++){var u=ve.Rf(e,o,f);u in l||(l[u]=0);var d=ve.Ec(e,u,o,l[u]++);s.push([u,o,d]),c.push([u,i,d])}for(f=0;f<s.length;f++)ve.yh(e,s[f][0],s[f][1],s[f][2]);for(f=0;f<c.length;f++)ve.vc(e,c[f][0],c[f][1],c[f][2]);for(_=ve.Zf(e,o),s=[],c=[],l={},f=0;f<_;f++)u=ve.yg(e,o,f),u in l||(l[u]=0),d=ve.Ec(e,o,u,l[u]++),s.push([o,u,d]),c.push([i,u,d]);for(f=0;f<s.length;f++)ve.yh(e,s[f][0],s[f][1],s[f][2]);for(f=0;f<c.length;f++)ve.vc(e,c[f][0],c[f][1],c[f][2]);ve.nf(e,o)}}function p(e){var t=-1,a=[],r=[],n="OUTPUT_WORLD_SURFACE BACKGROUND RGB VALUE ADD_WORLD_RGB MIX_WORLD_RGB TEXTURE_ENVIRONMENT_EQUIRECTANGULAR TEXTURE_ENVIRONMENT_MIRROR_BALL GEOMETRY_NO GEOMETRY_TRN GEOMETRY_GL GEOMETRY_IN TEXTURE_COLOR TEX_COORD_GE TEX_COORD_OB TEX_COORD_NO COMBRGB COMBHSV CURVE_RGB CURVE_VEC B4W_LINEAR_TO_SRGB B4W_NORMAL_VIEW B4W_VECTOR_VIEW B4W_SRGB_TO_LINEAR B4W_REFLECT B4W_CLAMP B4W_TIME B4W_SMOOTHSTEP NORMAL MAPPING MATH_ADD MATH_SUBTRACT MATH_MULTIPLY MATH_DIVIDE MATH_SINE MATH_COSINE MATH_TANGENT MATH_ARCSINE MATH_ARCCOSINE MATH_ARCTANGENT MATH_POWER MATH_LOGARITHM MATH_MINIMUM MATH_MAXIMUM MATH_ROUND MATH_LESS_THAN MATH_GREATER_THAN MATH_MODULO MATH_ABSOLUTE MIX_RGB_MIX MIX_RGB_ADD MIX_RGB_MULTIPLY MIX_RGB_SUBTRACT MIX_RGB_SCREEN MIX_RGB_DIVIDE MIX_RGB_DIFFERENCE MIX_RGB_DARKEN MIX_RGB_LIGHTEN MIX_RGB_OVERLAY MIX_RGB_DODGE MIX_RGB_BURN MIX_RGB_HUE MIX_RGB_SATURATION MIX_RGB_VALUE MIX_RGB_COLOR MIX_RGB_SOFT_LIGHT MIX_RGB_LINEAR_LIGHT SEPRGB SEPHSV VALTORGB VECT_TRANSFORM VECT_MATH_ADD VECT_MATH_SUBTRACT VECT_MATH_AVERAGE VECT_MATH_DOT_PRODUCT VECT_MATH_CROSS_PRODUCT VECT_MATH_NORMALIZE".split(" ");ve.X(e,function(e,r){switch(n.indexOf(r.type)){case-1:a.push({ne:e,node:r});break;case 0:t=e}});for(var o=0;o<a.length;o++)for(var i=a[o].ne,_=ve.Zf(e,i),s={},c=0;c<_;c++){var l=ve.yg(e,i,c);l in s||(s[l]=0);var f=ve.Ec(e,i,l,s[l]++);r.push([i,l,f])}for(o=0;o<r.length;o++)ve.yh(e,r[o][0],r[o][1],r[o][2]);r.length&&(r=ve.Rk(e,t,ve.Pj),e.V=r.V,e.xa=r.xa)}function m(e){var t=-1,a=[],r=[];ve.X(e,function(e,r){switch(r.type){case"ADD_WORLD_RGB":case"MIX_WORLD_RGB":var n={ne:e,node:r};a.push(n);break;case"OUTPUT_WORLD_SURFACE":t=e,n={ne:e,node:r},a.push(n)}});for(var n=0;n<a.length;n++)for(var o=a[n].ne,i=a[n].node,_=ve.ci(e,o),s={},c=0;c<_;c++){var l=ve.Rf(e,o,c),f=ve.Qa(e,l);l in s||(s[l]=0);var u=ve.Ec(e,l,o,s[l]++);"OUTPUT_WORLD_SURFACE"!=i.type&&0==u[1]||"ADD_WORLD_RGB"==f.type||"MIX_WORLD_RGB"==f.type||"BACKGROUND"==f.type||r.push([l,o,u])}for(n=0;n<r.length;n++)ve.yh(e,r[n][0],r[n][1],r[n][2]);r.length&&(r=ve.Rk(e,t,ve.Pj),e.V=r.V,e.xa=r.xa)}function g(e,t,a){switch(t){case"GLOW":return e+a+"11";case"COLOR_ID":case"SHADOW":return e+a+"00";default:return e+a+"10"}}function h(e,t){ve.Pg(e,function(a,r,n){var o=ve.Qa(e,r);r==t&&"Color"==o.inputs[n[1]].identifier&&ve.yh(e,a,r,n)})}function v(){var e=ve.create();return ve.Yg(e,0,{data:null,Ua:[],Y:[],inputs:[{Aa:new Float32Array([0,0,0]),identifier:"Color",Da:!1,name:"Color"},{Aa:1,identifier:"Alpha",Da:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",ue:[]}),e}function b(e){ve.X(e,function(t,a){for(var r=a.inputs,n=a.outputs,o=0;o<r.length;o++)E(e,r[o],t,o,1);for(o=0;o<n.length;o++)E(e,n[o],t,o,0)})}function E(e,t,a,r,n){if(t.Da){var o=!0;ve.Pg(e,function(e,t,i){(!n&&e==a&&i[0]==r||n&&t==a&&i[1]==r)&&(o=!1)}),o&&(t.Da=!1)}}function A(e,t,a){var r=[];ve.Pg(e,function(n,o,i){var _=ve.Qa(e,n),s=ve.Qa(e,o),_=Se.is_vector(_.outputs[i[0]].Aa),s=Se.is_vector(s.inputs[i[1]].Aa);if(_!=s){var c,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},f={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};_&&!s?c=G("vector_to_scalar","B4W_VECTOSCAL",[l],[f]):!_&&s&&(c=G("scalar_to_vector","B4W_SCALTOVEC",[f],[l])),j(e,c,0,t,a),r.push([n,o,e.V[e.V.length-2],i])}});for(var n=0;n<r.length;++n)ve.yh(e,r[n][0],r[n][1],r[n][3]),ve.vc(e,r[n][0],r[n][2],[r[n][3][0],0]),ve.vc(e,r[n][2],r[n][1],[0,r[n][3][1]])}function x(e){var t=[];ve.X(e,function(a,r){switch(r.type){case"B4W_TRANSLUCENCY":ve.Pg(e,function(n,o,i){var _=ve.Qa(e,o);n==a&&"MATERIAL_EXT"==_.type&&"Translucency"==r.outputs[i[0]].name&&t.push(n,o,[i[0]+1,i[1]+1])})}});for(var a=0;a<t.length;a+=3)ve.vc(e,t[a],t[a+1],t[a+2])}function T(e,t){var a=[];if(ve.X(t,function(t,r){r.name==e.name&&a.push(t)}),a.length)return a;Se.F("Node not found")}function y(e){var t=[];ve.X(e,function(e,a){"B4W_PARALLAX"!=a.type&&"REROUTE"!=a.type||t.push(e,a)});for(var a=0;a<t.length;a+=2){var r=t[a],n=t[a+1];if("B4W_PARALLAX"==n.type)S(e,r,n);else if("REROUTE"==n.type){for(var o=ve.Rf(e,r,0),i=ve.Zf(e,r),_=[],s=[],c=[],l=0;l<i;l++){var f=ve.yg(e,r,l),u=s.indexOf(f),d=ve.Ec(e,r,f,0<=u?c[u]:0);if(d){var d=d[1],p=n.inputs[0].Aa,d=ve.Qa(e,f).inputs[d];switch(typeof p){case"number":if("object"==typeof d.Aa)for(var m=d.Aa,d=0;d<m.length;d++)m[d]=p;else"number"==typeof d.Aa&&(d.Aa=p);break;case"object":if("object"==typeof d.Aa)for(m=d.Aa,d=0;d<m.length;d++)m[d]=p[d];else"number"==typeof d.Aa&&(d.Aa=.35*p[0]+.45*p[1]+.2*p[2])}}for(p=n.outputs,d=0;d<p.length;d++)p[d].Aa=n.inputs[0].Aa;-1!=u?c[u]+=1:(s.push(f),c.push(1),_.push(r,f))}if(-1!=o)for(n=ve.Ec(e,o,r,0)[0],l=0;l<s.length;l++)for(d=0;d<c[l];d++)i=ve.Ec(e,r,s[l],d)[1],ve.vc(e,o,s[l],[n,i]);for(l=0;l<_.length;l+=2)ve.Jk(e,_[l],_[l+1],-1)}}}function S(e,t,a){var r;e:{r=e.xa;for(var n=0;n<r.length;n+=3)if(r[n+1]==t&&1==r[n+2][1]){r=r[n];break e}r=-1}-1!=r&&(n=ve.Qa(e,r),a.data=n.data,ve.Jk(e,r,t,-1),0==ve.Zf(e,r)&&(t=ve.Rf(e,r,0),-1!=t&&ve.Jk(e,t,r,-1),ve.nf(e,r))),a.inputs.splice(1,1)}function O(e){L(e),M(e),w(e)}function w(e){var t={};ve.X(e,function(e,a){if("GEOMETRY_UV"==a.type||"UVMAP"==a.type||"TEX_COORD_UV"==a.type){var r=a.data.value;r in t||(t[r]=[]),t[r].push(e,a)}});for(var a in t){var r=t[a];if(2<r.length)for(var n=R(a),n=j(e,n,0,"",void 0),o=ve.Qa(e,n),i=0;i<r.length;i+=2){for(var _=r[i],s=r[i+1],c=[],l={},f=ve.Zf(e,_),u=0;u<f;u++){var d=ve.yg(e,_,u);d in l||(l[d]=0);var p=ve.Ec(e,_,d,l[d]);switch(l[d]++,c.push(_,d,p),p=p.splice(0,p.length),s.type){case"GEOMETRY_UV":p[0]=0,o.outputs[0].Da=!0;break;case"UVMAP":case"TEX_COORD_UV":p[0]=1,o.outputs[1].Da=!0}ve.vc(e,n,d,p)}for(u=0;u<c.length;u+=3)ve.Jk(e,c[u],c[u+1],0);ve.nf(e,_)}}}function R(e){var t=G("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"}]);return t.uv_layer=e,t}function L(e){var t=[];ve.X(e,function(e,a){"GEOMETRY_VC"!=a.type&&"GEOMETRY_NO"!=a.type&&"GEOMETRY_FB"!=a.type&&"GEOMETRY_VW"!=a.type&&"GEOMETRY_GL"!=a.type&&"GEOMETRY_LO"!=a.type&&"GEOMETRY_OR"!=a.type&&"GEOMETRY_BF"!=a.type&&"GEOMETRY_IN"!=a.type||t.push(e,a)});for(var a=[],r=0;r<t.length;r+=2){for(var n=t[r],o=t[r+1],i=!0,_=0;_<a.length;_++){var s=a[_];if(C(o,s.Gf)){for(var i=[],_=ve.Zf(e,n),c=0;c<_;c++){var l=ve.yg(e,n,c),f=ve.Ec(e,n,l,0);i.push(n,l,f),ve.vc(e,s.id,l,f)}for(c=0;c<i.length;c+=3)ve.Jk(e,i[c],i[c+1],0);ve.nf(e,n),i=!1;break}}i&&(s={id:n,Gf:o},a.push(s))}}function N(e){for(var t={},a=0;a<e.V.length;a+=2){var r=e.V[a];t[r]={Ep:{},mF:!1}}for(a=0;a<e.xa.length;a+=3)t[e.xa[a+1]].Ep[e.xa[a]]=!0;for(r in t)I(r,t);for(r in t)t[r]=Object.keys(t[r].Ep).map(function(e){return parseInt(e,10)});return t}function I(e,t){var a=t[e];if(!a.mF){var r,n=Se.P(a);for(r in a.Ep){I(r,t);var o,a=t[r];for(o in a.Ep)n.Ep[o]=!0}n.mF=!0,t[e]=n}}function M(e){var t=[];if(ve.X(e,function(e,a){"TEXTURE_COLOR"!=a.type&&"TEXTURE_NORMAL"!=a.type||t.push(e,a)}),t.length){for(var a=N(e),r=[],n=0;n<t.length;n+=2){for(var o=t[n],i=t[n+1],_=!0,s=0;s<r.length;s++){var c=r[s];if(!(3<=c.eo.length||!C(i,c.Gf)||-1<a[o].indexOf(c.id)||-1<a[c.id].indexOf(o))){for(var l=!1,f=0;f<c.eo.length;f++){var u=c.eo[f].id;if(-1<a[o].indexOf(u)||-1<a[u].indexOf(o)){l=!0;break}}if(!l){for(var s=[],u=ve.ci(e,o),d={},f=0;f<u;f++)l=ve.Rf(e,o,f),l in d||(d[l]=0),_=ve.Ec(e,l,o,d[l]++),s.push(l,o,_);for(var u=[],d=ve.Zf(e,o),p={},f=0;f<d;f++)l=ve.yg(e,o,f),l in p||(p[l]=0),_=ve.Ec(e,o,l,p[l]++),u.push(o,l,_);for(_=s.concat(u),f=0;f<_.length;f+=3)ve.Jk(e,_[f],_[f+1],0);ve.nf(e,o),f={id:o,Gf:i,uO:s,vO:u},c.eo.push(f),_=!1;break}}}_&&(c={id:o,Gf:i,eo:[]},r.push(c))}for(n=0;n<r.length;n++){for(c=r[n],a=c.eo.length,s=0;s<a;s++){for(i=c.eo[s],f=i.Gf,o=i.uO,i=i.vO,c.Gf.inputs[s+1].Da=f.inputs[0].Da,c.Gf.inputs[s+1].Aa=f.inputs[0].Aa,c.Gf.outputs[2*(s+1)].Da=f.outputs[0].Da,c.Gf.outputs[2*(s+1)].Aa=f.outputs[0].Aa,c.Gf.outputs[2*(s+1)+1].Da=f.outputs[1].Da,c.Gf.outputs[2*(s+1)+1].Aa=f.outputs[1].Aa,f=0;f<o.length;f+=3)l=o[f],_=o[f+2],_[1]+=s+1,ve.vc(e,l,c.id,_);for(f=0;f<i.length;f+=3)l=i[f+1],_=i[f+2],_[0]+=2*(s+1),ve.vc(e,c.id,l,_);c.Gf.Ua.push(["USE_uv"+(s+2),1])}ve.nf(e,c.id),ve.Yg(e,c.id,c.Gf)}}}function C(e,t){if(e.type!==t.type)return!1;switch(e.type){case"GEOMETRY_VC":return e.data.value==t.data.value;case"GEOMETRY_NO":for(var a=e.Ua,r=-1,n=0;n<a.length;n++){var o=a[n];if("USE_NORMAL_IN"==o[0]){r=o[1];break}}for(a=t.Ua,o=-1,n=0;n<a.length;n++){var i=a[n];if("USE_NORMAL_IN"==i[0]){o=i[1];break}}return r===o;case"GEOMETRY_FB":case"GEOMETRY_VW":case"GEOMETRY_GL":case"GEOMETRY_LO":case"GEOMETRY_OR":case"GEOMETRY_BF":case"GEOMETRY_IN":return!0;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":return e.data.ft==t.data.ft&&e.data.value.Yl==t.data.value.Yl;case"VALUE":case"RGB":return e.qd==t.qd;default:return!1}}function D(e){var t=[],a=[];ve.X(e,function(e,r){"GEOMETRY_VC"==r.type&&t.push(e,r),"GEOMETRY_VW"==r.type&&a.push(e,r)}),U(e,t),k(e,a)}function U(e,t){for(var a=0;a<t.length;a+=2){for(var r=t[a],n=t[a+1],o=!1,i=[],_=[],s=[[],[],[]],c=ve.Zf(e,r),l=0;l<c;l++){var f=ve.yg(e,r,l);if("SEPRGB"!=ve.Qa(e,f).type){o=!1;break}i.push(r,f);for(var u={},d=ve.Zf(e,f),o=0;o<d;o++){var p=ve.yg(e,f,o);p in u||(u[p]=0);var m=ve.Ec(e,f,p,u[p]++);i.push(f,p),s[m[0]].push(r,p,m)}_.push(f),o=!0}if(o){for(l=r=c=0;l<s.length;l++)s[l].length&&(c++,r|=1<<2-l);if(c){for(n.type+=c,n.outputs=[],l=0;l<s.length;l++)if(s[l].length)for(n.outputs.push({Aa:0,identifier:"RGB"[l],Da:!0,name:"RGB"[l]}),o=0;o<s[l].length;o+=3)s[l][o+2][0]=Se.Ao(r,l);for(l=0;l<i.length;l+=2)ve.Jk(e,i[l],i[l+1],0);for(l=0;l<_.length;l++)ve.nf(e,_[l]);for(l=0;l<s.length;l++)for(o=0;o<s[l].length;o+=3)ve.vc(e,s[l][o],s[l][o+1],s[l][o+2])}}}}function k(e,t){for(var a=0;a<t.length;a+=2){for(var r=t[a],n=!0,o=[],i=ve.Zf(e,r),_=0;_<i;_++){var s=ve.yg(e,r,_);if("B4W_REFLECT"==ve.Qa(e,s).type){var c=ve.Ec(e,r,s,0),l=ve.Ec(e,r,s,1);c&&1==c[1]||l&&1==l[1]?n=!1:o.push(r,s)}else n=!1}for(_=0;_<o.length;_+=2)i=e,c=o[_],s=o[_+1],l=ve.Qa(i,s),l.type+="_WORLD",ve.Jk(i,c,s,0),l.inputs.splice(0,1),(c=ve.Rf(i,s,0))!=ve.wx&&(ve.Ec(i,c,s,0)[1]=0);n&&ve.nf(e,r)}}function P(e,t,a,r,n,o){e=e.nodes;for(var i=null,_=0;_<e.length;_++){var s=e[_];n?"GROUP"==s.type&&s.node_tree_name==a&&(i=s):s.type==a&&(i=s)}return i?T(i,t)[0]:(o||xe.error('No "'+a+'" node in node '+r),-1)}function G(e,t,a,r){return{name:e,type:t,inputs:a,outputs:r}}function F(e){var t={name:"",qd:"",type:"",ue:[],inputs:[],outputs:[],Y:[],data:null,Ua:[]};t.name=e.name,t.qd=e.qd,t.type=e.type;for(var a=t.ue,r=e.ue,n=0;n<r.length;n++)a.push(re(r[n]));for(a=t.Y,r=e.Y,n=0;n<r.length;n++)a.push(re(r[n]));for(a=t.inputs,r=e.inputs,n=0;n<r.length;n++)a.push($(r[n]));for(a=t.outputs,r=e.outputs,n=0;n<r.length;n++)a.push($(r[n]));for(a=t.Ua,r=e.Ua,n=0;n<r.length;n++)a.push(r[n].slice());return t.data=e.data,t}function j(e,t,a,r,n){var o=t.name,i=t.name,_=t.type,s=[],c=[],l=[],f=[],u=null,d=[];switch(_){case"BSDF_ANISOTROPIC":case"BSDF_GLASS":case"BSDF_HAIR":case"BSDF_TRANSLUCENT":case"BSDF_REFRACTION":case"BSDF_TOON":case"BSDF_VELVET":case"SUBSURFACE_SCATTERING":case"AMBIENT_OCCLUSION":case"VOLUME_ABSORPTION":case"VOLUME_SCATTER":case"BLACKBODY":case"WAVELENGTH":case"SEPXYZ":case"COMBXYZ":case"LIGHT_FALLOFF":case"TEX_SKY":case"TEX_NOISE":case"TEX_WAVE":case"TEX_MUSGRAVE":case"TEX_GRADIENT":case"TEX_MAGIC":case"TEX_CHECKER":case"TEX_BRICK":case"WIREFRAME":case"TANGENT":case"LIGHT_PATH":case"ATTRIBUTE":case"HOLDOUT":case"HAIR_INFO":case"SCRIPT":c=ee(t),l=te(t),xe.warn(_+" node is not fully supported.");break;case"BRIGHTCONTRAST":case"ADD_SHADER":c=ee(t),l=te(t);break;case"MIX_SHADER":c.push(J(t,"Fac"));var p=J(t,"Shader"),l=p.Da;c.push(p),(p=J(t,"Shader_001"))||(p=J(t,"Shader.001"));var m=p.Da;c.push(p),c.push(Z("d_color1","d_color1",[0,0,0],l)),c.push(Z("d_roughness1","d_roughness1",0,l)),c.push(Z("s_color1","s_color1",[0,0,0],l)),c.push(Z("s_roughness1","s_roughness1",0,l)),c.push(Z("metalness1","metalness1",0,l)),c.push(Z("normal1","normal1",[0,0,0],l)),c.push(Z("e_color1","e_color1",[0,0,0],l)),c.push(Z("emission1","emission1",0,l)),c.push(Z("a_color1","a_color1",[0,0,0],l)),c.push(Z("alpha1","alpha1",1,l)),c.push(Z("d_color2","d_color2",[0,0,0],m)),c.push(Z("d_roughness2","d_roughness2",0,m)),c.push(Z("s_color2","s_color2",[0,0,0],m)),c.push(Z("s_roughness2","s_roughness2",0,m)),c.push(Z("metalness2","metalness2",0,m)),c.push(Z("normal2","normal2",[0,0,0],m)),c.push(Z("e_color2","e_color2",[0,0,0],m)),c.push(Z("emission2","emission2",0,m)),c.push(Z("a_color2","a_color2",[0,0,0],m)),c.push(Z("alpha2","alpha2",1,m)),l=K(t,"Shader"),p=l.Da,l=[l,Z("d_color","d_color",[0,0,0],p),Z("d_roughness","d_roughness",0,p),Z("s_color","s_color",[0,0,0],p),Z("s_roughness","s_roughness",0,p),Z("metalness","metalness",0,p),Z("normal","normal",[0,0,0],p),Z("e_color","e_color",[0,0,0],p),Z("emission","emission",0,p),Z("a_color","a_color",[0,0,0],p),Z("alpha","alpha",1,p)];break;case"OBJECT_INFO":var c=ee(t),l=[],p=K(t,"Location"),m=K(t,"Object Index"),g=K(t,"Material Index"),h=K(t,"Random");l.push(p),l.push(m),l.push(g),l.push(h),d.push(["USE_LOCATION_OUT",0|p.Da]),d.push(["USE_OBJ_IND_OUT",0|m.Da]),d.push(["USE_MAT_IND_OUT",0|g.Da]),d.push(["USE_RANDOM_OUT",0|h.Da]);break;case"UVMAP":(p=t.uv_layer)||(_="EMPTY_UV"),"EMPTY_UV"!=_&&(u=q("param_"+_+"_a"),m=q("param_"+_+"_v"),s.push(ae(u)),s.push(ae(m)),f.push(ae(m)),u={name:u,value:p}),l=te(t);break;case"UV_MERGED":u=q("param_UV_MERGED_a"),m=q("param_UV_MERGED_v"),s.push(ae(u)),s.push(ae(m)),l.push(K(t,"UV_geom")),l.push(K(t,"UV_cycles")),f.push(ae(m)),u={name:u,value:t.uv_layer};break;case"CAMERA":c=[],l=te(t);break;case"COMBRGB":case"COMBHSV":c=ee(t),l=te(t);break;case"CURVE_RGB":case"CURVE_VEC":"CURVE_RGB"==_?(me(t,0,0)&&d.push(["READ_R",1]),me(t,1,0)&&d.push(["READ_G",1]),me(t,2,0)&&d.push(["READ_B",1]),me(t,3,0)&&d.push(["READ_A",1])):(me(t,0,-1)&&d.push(["READ_R",1]),me(t,1,-1)&&d.push(["READ_G",1]),me(t,2,-1)&&d.push(["READ_B",1])),c=ee(t),l=te(t),u={value:t};break;case"PARTICLE_INFO":for(c=ee(t),l=te(t),m=0;m<t.outputs.length;m++){var g=t.outputs[m],h=g.identifier,v=ae("v_param_PART_INFO_"+h.replace(" ",""));if(g.is_linked)switch(h){case"Size":d.push(["PART_INFO_SIZE",Te.R(1)]);break;case"Age":d.push(["PART_INFO_AGE",Te.R(1)]);break;case"Lifetime":d.push(["PART_INFO_LT",Te.R(1)]);break;case"Location":d.push(["PART_INFO_LOC",Te.R(1)]);break;case"Index":u=p=ae("a_param_PART_INFO_"+g.identifier.replace(" ","")),d.push(["PART_INFO_IND",Te.R(1)]);break;case"Velocity":d.push(["PART_INFO_VEL",Te.R(1)]);break;case"Angular Velocity":d.push(["PART_INFO_A_VEL",Te.R(1)])}"Age"!=h&&"Lifetime"!=h&&"Size"!=h&&(s.push(v),f.push(v))}p&&s.push(p);break;case"NEW_GEOMETRY":case"GEOMETRY":if(!z(t))return!0;if(!(_=W(t,a)))return xe.error("Geometry output is not supported"),null;switch(_){case"GEOMETRY_UV":(p=t.uv_layer)||(_="EMPTY_UV"),"EMPTY_UV"!=_&&(u=q("param_GEOMETRY_UV_a"),m=q("param_GEOMETRY_UV_v"),s.push(ae(u)),s.push(ae(m)),f.push(ae(m)),u={name:u,value:p}),l.push(K(t,"UV"));break;case"GEOMETRY_VC":(p=t.color_layer)||(_="EMPTY_VC"),"EMPTY_VC"!=_&&(u=q("param_GEOMETRY_VC_a"),m=q("param_GEOMETRY_VC_v"),s.push(ae(u)),s.push(ae(m)),f.push(ae(m)),u={name:u,value:p}),l.push(K(t,"Vertex Color"));break;case"GEOMETRY_NO":c.push(Z("Normal","Normal",[0,0,0],!1)),d.push(["USE_NORMAL_IN",0]),l.push(K(t,"Normal"));break;case"GEOMETRY_TRN":_="GEOMETRY_NO",c.push(Z("Normal","Normal",[0,0,0],!1)),l.push(K(t,"True Normal")),d.push(["USE_NORMAL_IN",0]),xe.warn("Geometry True Normal output is not fully supported.");break;case"GEOMETRY_FB":l.push(K(t,"Front/Back"));break;case"GEOMETRY_VW":l.push(K(t,"View"));break;case"GEOMETRY_GL":l.push(K(t,"Global")||K(t,"Position"));break;case"GEOMETRY_LO":l.push(K(t,"Local"));break;case"GEOMETRY_OR":p=q("param_GEOMETRY_OR_v"),s.push(ae(p)),l.push(K(t,"Orco")),f.push(ae(p));break;case"GEOMETRY_IN":l.push(K(t,"Incoming"));break;case"GEOMETRY_BF":l.push(K(t,"Backfacing"))}break;case"TEX_COORD":if(!z(t))return!0;switch(_=Y(t,a)){case"TEX_COORD_UV":(p=t.uv_layer)||(_="EMPTY_UV"),"EMPTY_UV"!=_&&(u=q("param_TEX_COORD_UV_a"),m=q("param_TEX_COORD_UV_v"),s.push(ae(u)),s.push(ae(m)),f.push(ae(m)),u={name:u,value:t.uv_layer}),l.push(K(t,"UV"));break;case"TEX_COORD_NO":l.push(K(t,"Normal"));break;case"TEX_COORD_GE":p=q("param_TEX_COORD_GE_v"),s.push(ae(p)),l.push(K(t,"Generated")),f.push(ae(p));break;case"TEX_COORD_OB":l.push(K(t,"Object"));break;case"TEX_COORD_CA":l.push(K(t,"Camera"));break;case"TEX_COORD_WI":l.push(K(t,"Window"));break;case"TEX_COORD_RE":l.push(K(t,"Reflection"))}break;case"GROUP":switch(p=t.node_tree_name){case"B4W_LINEAR_TO_SRGB":if(!B(t,[1],[1])){u=H(t,r,n);break}_="B4W_LINEAR_TO_SRGB";break;case"B4W_NORMAL_VIEW":case"B4W_VECTOR_VIEW":if(!B(t,[1],[1])){u=H(t,r,n);break}_="B4W_VECTOR_VIEW";break;case"B4W_SRGB_TO_LINEAR":if(!B(t,[1],[1])){u=H(t,r,n);break}_="B4W_SRGB_TO_LINEAR";break;case"B4W_REFLECT":if(!B(t,[1,1],[1])){u=H(t,r,n);break}_="B4W_REFLECT";break;case"B4W_REFRACTION":if(!B(t,[1,0],[1])){u=H(t,r,n);break}_="B4W_REFRACTION";break;case"B4W_PARALLAX":if(!B(t,[1,1,0,0,0],[1])){u=H(t,r,n);break}m=q("param_B4W_PARALLAX_texture"),f.push(ae(m)),_="B4W_PARALLAX";break;case"B4W_CLAMP":if(!B(t,[1],[1])){u=H(t,r,n);break}_="B4W_CLAMP";break;case"B4W_TRANSLUCENCY":if(!B(t,[0,0,0,0,0],[0])){u=H(t,r,n);break}_="B4W_TRANSLUCENCY";break;case"B4W_TIME":if(!B(t,[],[0])){u=H(t,r,n);break}_="B4W_TIME";break;case"B4W_SMOOTHSTEP":if(!B(t,[0,0,0],[0])){u=H(t,r,n);break}_="B4W_SMOOTHSTEP";break;case"B4W_GLOW_OUTPUT":_="B4W_GLOW_OUTPUT";break;default:u=H(t,r,n)}c=ee(t),l=te(t),"B4W_TRANSLUCENCY"==p&&(p=Z("TranslucencyParams","TranslucencyParams",[0,0,0,0]),p.Da=l[0].Da,l.push(p));break;case"LAMP":(p=t.lamp)?(p.uuid in Ie?d.push(["LAMP_INDEX",String(Ie[p.uuid])]):(Ie[p.uuid]=Me,d.push(["LAMP_INDEX",String(Me++)])),u=Ie):(xe.error("There is no lamp in node: "+t.name),d.push(["LAMP_INDEX",-1])),l.push(K(t,"Color")),l.push(K(t,"Light Vector")),l.push(K(t,"Distance")),l.push(K(t,"Visibility Factor"));break;case"LIGHTING_AMBIENT":c=[Z("E","E",[0,0,0],!0),Z("A","A",[0,0,0],!0),Z("D","D",[0,0,0],!0)],l=[Z("color","color",[0,0,0],!0),Z("specular","specular",[0,0,0],!0)];break;case"LIGHTING_BEGIN":l=[Z("E","E",[0,0,0],!0),Z("A","A",[0,0,0],!0),Z("D","D",[0,0,0],!0),Z("S","S",[0,0,0],!0),Z("normal","normal",[0,0,0],!0),Z("dif_params","dif_params",[0,0],!0),Z("sp_params","sp_params",[0,0],!0),Z("shadow_factor","shadow_factor",0,!0),Z("translucency_color","translucency_color",0,!0),Z("translucency_params","translucency_params",[0,0,0,0],!0)];break;case"LIGHTING_END":c=[Z("color","color",[0,0,0],!0),Z("specular","specular",[0,0,0],!0)];break;case"LIGHTING_LAMP":c=[Z("shadow_factor","shadow_factor",0,!0)],l=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("lcolorint","lcolorint",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0)];break;case"DIFFUSE_LAMBERT":c=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("normal","normal",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0)],l=[Z("lfactor","lfactor",0,!0)],d.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"DIFFUSE_FRESNEL":case"DIFFUSE_MINNAERT":case"DIFFUSE_OREN_NAYAR":case"DIFFUSE_TOON":c=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("normal","normal",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0),Z("dif_params","dif_params",[0,0],!0)],l=[Z("lfactor","lfactor",0,!0)],d.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_BLINN":case"SPECULAR_PHONG":case"SPECULAR_COOKTORR":c=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("normal","normal",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0),Z("sp_params","sp_params",[0,0],!0)],l=[Z("sfactor","sfactor",0,!0)],d.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_TOON":case"SPECULAR_WARDISO":c=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("normal","normal",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0),Z("sp_params","sp_params",[0,0],!0)],l=[Z("sfactor","sfactor",0,!0)],d.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"BSDF_COMPUTE":c=[Z("ldir","ldir",[0,0,0],!0),Z("lfac","lfac",[0,0],!0),Z("normal","normal",[0,0,0],!0),Z("norm_fac","norm_fac",0,!0),Z("bsdf_params","bsdf_params",[0,0,0,0],!0)],l=[Z("lfactor","lfactor",0,!0),Z("sfactor","sfactor",0,!0)];break;case"LIGHTING_APPLY":c=[Z("color","color",[0,0,0,0],!0),Z("specular","specular",[0,0,0],!0),Z("lfactor","lfactor",0,!0),Z("sfactor","sfactor",0,!0),Z("ldir","ldir",[0,0,0],!0),Z("normal","normal",[0,0,0],!0),Z("translucency_params","translucency_params",[0,0,0,0],!0),Z("D","D",[0,0,0],!0),Z("S","S",[0,0,0],!0),Z("lcolorint","lcolorint",[0,0,0],!0),Z("translucency_color","translucency_color",0,!0)],l=[Z("color","color",[0,0,0,0],!0),Z("specular","specular",[0,0,0],!0)];break;case"NORMAL":c=ee(t),l=te(t),p=K(t,"Normal"),f.push(ae(q("param_NORMAL_Normal"),p.Aa,3));break;case"MAPPING":p=t.vector_type,_="MAPPING",c.push(J(t,"Vector")),l.push(K(t,"Vector"));var m=Se.f32(t.rotation),g=Se.f32(t.scale),h=Se.f32(t.translation),v=be.create(),b=Se.BO(m);switch("TEXTURE"==p&&(g[0]=g[0]||1,g[1]=g[1]||1,g[2]=g[2]||1),be.multiply(b,new Float32Array([g[0],0,0,0,g[1],0,0,0,g[2]]),v),v=Se.sR(v,Ee.create()),p){case"POINT":v[12]=h[0],v[13]=h[1],v[14]=h[2];break;case"TEXTURE":v[12]=h[0],v[13]=h[1],v[14]=h[2],v=Ee.invert(v,v);break;case"NORMAL":Ee.invert(v,v),Ee.transpose(v,v)}switch(p){case"NORMAL":d.push(["MAPPING_IS_NORMAL",1]);case"TEXTURE":d.push(["MAPPING_TRS_MATRIX_DEF",1]),d.push(["MAPPING_TRS_MATRIX",Te.R(v,16)]);break;case"POINT":0!==Oe.length(m)?(d.push(["MAPPING_TRS_MATRIX_DEF",1]),d.push(["MAPPING_TRS_MATRIX",Te.R(v,16)])):(0!==Oe.length(g)&&(d.push(["MAPPING_SCALE_DEF",1]),d.push(["MAPPING_SCALE",Te.R(g,3)])),0!==Oe.length(h)&&(d.push(["MAPPING_TRANS_DEF",1]),d.push(["MAPPING_TRANS",Te.R(h,3)])));break;case"VECTOR":0!==Oe.length(m)?(d.push(["MAPPING_TRS_MATRIX_DEF",1]),d.push(["MAPPING_TRS_MATRIX",Te.R(v,16)])):0!==Oe.length(g)&&(d.push(["MAPPING_SCALE_DEF",1]),d.push(["MAPPING_SCALE",Te.R(g,3)]))}t.use_min&&(d.push(["MAPPING_MIN_CLIP_DEF",1]),d.push(["MAPPING_MIN_CLIP",Te.R(t.min,3)])),t.use_max&&(d.push(["MAPPING_MAX_CLIP_DEF",1]),d.push(["MAPPING_MAX_CLIP",Te.R(t.max,3)]));break;case"MATERIAL":case"MATERIAL_EXT":var u=[],p=[],m=[],g=[Z("E","E",[0,0,0],!0),Z("A","A",[0,0,0],!0),Z("D","D",[0,0,0],!0),Z("S","S",[0,0,0],!0),Z("normal","normal",[0,0,0],!0),Z("dif_params","dif_params",[0,0],!0),Z("sp_params","sp_params",[0,0],!0),Z("shadow_factor","shadow_factor",0,!0)],h=[Z("color","color",[0,0,0],!0),Z("specular","specular",[0,0,0],!0),Z("normal","normal",[0,0,0],!0)],v=[K(t,"Color"),K(t,"Alpha"),K(t,"Normal")],b=[],E=J(t,"Color");E.Aa.splice(3),m.push(E),c.push(E),E=J(t,"Spec"),E.Aa.splice(3),m.push(E),c.push(E),(E=J(t,"DiffuseIntensity"))||(E=J(t,"Refl")),E.Aa=t.diffuse_intensity,m.push(E),c.push(E);var A=J(t,"Normal");A.Aa.splice(3),m.push(A),c.push(A),"MATERIAL_EXT"==_?((E=J(t,"Emit"))||(E=Z("Emit","Emit",0)),m.push(E),c.push(E),(E=J(t,"Translucency"))?(E.Aa=0,E.name="Translucency",E.identifier="Translucency"):E=Z("Translucency","Translucency",0),c.push(E),(E=J(t,"Translucency"))?(E.Aa=[0,0,0,0],E.name="TranslucencyParams",E.identifier="TranslucencyParams"):E=Z("TranslucencyParams","TranslucencyParams",[0,0,0,0]),c.push(E),l=J(t,"Reflectivity"),E=J(t,"Ray Mirror"),l?(E=l,l="Reflectivity"):E?l="Ray Mirror":(E=l,l="Reflectivity"),E||(E=Z(l,l,0)),c.push(E),h.push(E),(E=J(t,"SpecTra"))||(E=Z("SpecTra","SpecTra",0)),c.push(E),h.push(E),(E=J(t,"Alpha"))||(E=Z("Alpha","Alpha",t.alpha)),c.push(E),h.push(E),v.push(K(t,"Diffuse")),v.push(K(t,"Spec")),u.push(["MATERIAL_EXT",1]),p.push(["MATERIAL_EXT",1])):(m.push(Z("emit_intensity","emit_intensity",0)),h.push(Z("reflect_factor","reflect_factor",0)),h.push(Z("specular_alpha","specular_alpha",0)),h.push(Z("alpha_in","alpha_in",0)),v.push(Z("diffuse_out","diffuse_out",0)),v.push(Z("spec_out","spec_out",0)),u.push(["MATERIAL_EXT",0]),p.push(["MATERIAL_EXT",0])),b.push(ae(q("param_MATERIAL_alpha"),t.alpha)),b.push(ae(q("param_MATERIAL_spec_alpha"),t.specular_alpha)),l=v,u.push(["USE_MATERIAL_NORMAL",0|A.Da]),t.use_diffuse&&(u.push(["USE_MATERIAL_DIFFUSE",1]),p.push(["USE_MATERIAL_DIFFUSE",1])),t.use_specular&&p.push(["USE_MATERIAL_SPECULAR",1]);var E=[],x=0;switch(t.specular_shader){case"COOKTORR":case"PHONG":A=t.specular_hardness;break;case"WARDISO":A=t.specular_slope;break;case"TOON":A=t.specular_toon_size,x=t.specular_toon_smooth;break;case"BLINN":A=t.specular_ior,x=t.specular_hardness;break;default:xe.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.material_name+'")'),A=t.specular_hardness}var T,y;switch(t.diffuse_shader){case"LAMBERT":y=T=0;break;case"OREN_NAYAR":T=t.roughness,y=0;break;case"FRESNEL":T=t.diffuse_fresnel,y=t.diffuse_fresnel_factor;break;case"MINNAERT":T=t.darkness,y=0;break;case"TOON":T=t.diffuse_toon_size,y=t.diffuse_toon_smooth;break;default:xe.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.material_name+'")'),y=T=0}E.push(ae(q("param_MATERIAL_diffuse"),[T,y],2)),E.push(ae(q("param_MATERIAL_spec"),[t.specular_intensity,A,x],3)),u.push(["SHADELESS_MAT",t.use_shadeless?1:0]),A={name:t.name,value:{Qr:t.specular_shader,uq:t.diffuse_shader,Le:t.use_shadeless,Nm:t.use_tangent_shading}},u={name:t.name,value:{Qr:t.specular_shader,uq:t.diffuse_shader,Le:t.use_shadeless,Nm:t.use_tangent_shading},tR:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:m,outputs:g,Y:E,data:A,Ua:u,ue:[]},uR:{name:"material_end",type:"MATERIAL_END",inputs:h,outputs:v,Y:b,data:A,Ua:p,ue:[]}};break;case"BSDF_DIFFUSE":c=ee(t),d.push(["USE_NORMAL_IN",0|c[2].Da]),l=K(t,"BSDF"),m=l.Da,l=[l,Z("d_color","d_color",[0,0,0],m),Z("d_roughness","d_roughness",0,m),Z("s_color","s_color",[0,0,0],m),Z("s_roughness","s_roughness",0,m),Z("metalness","metalness",0,m),Z("normal","normal",[0,0,0],m),Z("e_color","e_color",[0,0,0],m),Z("emisson","emisson",0,m),Z("a_color","a_color",[0,0,0],m),Z("alpha","alpha",1,m)];break;case"BSDF_GLOSSY":c=ee(t),d.push(["USE_NORMAL_IN",0|c[2].Da]),l=K(t,"BSDF"),m=l.Da,l=[l,Z("d_color","d_color",[0,0,0],m),Z("d_roughness","d_roughness",0,m),Z("s_color","s_color",[0,0,0],m),Z("s_roughness","s_roughness",0,m),Z("metalness","metalness",1,m),Z("normal","normal",[0,0,0],m),Z("e_color","e_color",[0,0,0],m),Z("emisson","emisson",0,m),Z("a_color","a_color",[0,0,0],m),Z("alpha","alpha",1,m)];break;case"BSDF_TRANSPARENT":c=ee(t),l=K(t,"BSDF"),m=l.Da,l=[l,Z("d_color","d_color",[0,0,0],m),Z("d_roughness","d_roughness",0,m),Z("s_color","s_color",[0,0,0],m),Z("s_roughness","s_roughness",0,m),Z("metalness","metalness",0,m),Z("normal","normal",[0,0,0],m),Z("e_color","e_color",[0,0,0],m),Z("emisson","emisson",0,m),Z("a_color","a_color",[0,0,0],m),Z("alpha","alpha",1,m)];break;case"EMISSION":c=ee(t),l=K(t,"Emission"),p=l.Da,l=[l,Z("d_color","d_color",[0,0,0],p),Z("d_roughness","d_roughness",0,p),Z("s_color","s_color",[0,0,0],p),Z("s_roughness","s_roughness",0,p),Z("metalness","metalness",1,p),Z("normal","normal",[0,0,0],p),Z("e_color","e_color",[0,0,0],p),Z("emisson","emisson",1,p),Z("a_color","a_color",[0,0,0],m),Z("alpha","alpha",1,m)];break;case"MATH":switch(t.operation){case"ADD":_="MATH_ADD";break;case"SUBTRACT":_="MATH_SUBTRACT";break;case"MULTIPLY":_="MATH_MULTIPLY";break;case"DIVIDE":_="MATH_DIVIDE";break;case"SINE":_="MATH_SINE";break;case"COSINE":_="MATH_COSINE";break;case"TANGENT":_="MATH_TANGENT";break;case"ARCSINE":_="MATH_ARCSINE";break;case"ARCCOSINE":_="MATH_ARCCOSINE";break;case"ARCTANGENT":_="MATH_ARCTANGENT";break;case"POWER":_="MATH_POWER";break;case"LOGARITHM":_="MATH_LOGARITHM";break;case"MINIMUM":_="MATH_MINIMUM";break;case"MAXIMUM":_="MATH_MAXIMUM";break;case"ROUND":_="MATH_ROUND";break;case"LESS_THAN":_="MATH_LESS_THAN";break;case"GREATER_THAN":_="MATH_GREATER_THAN";break;case"MODULO":_="MATH_MODULO";break;case"ABSOLUTE":_="MATH_ABSOLUTE";break;default:return xe.error("Unsupported MATH operation: "+t.operation),null}d.push(["MATH_USE_CLAMP",Number(t.use_clamp)]),c=ee(t),l=te(t);break;case"MIX_RGB":switch(t.blend_type){case"MIX":_="MIX_RGB_MIX";break;case"ADD":_="MIX_RGB_ADD";break;case"MULTIPLY":_="MIX_RGB_MULTIPLY";break;case"SUBTRACT":_="MIX_RGB_SUBTRACT";break;case"SCREEN":_="MIX_RGB_SCREEN";break;case"DIVIDE":_="MIX_RGB_DIVIDE";break;case"DIFFERENCE":_="MIX_RGB_DIFFERENCE";break;case"DARKEN":_="MIX_RGB_DARKEN";break;case"LIGHTEN":_="MIX_RGB_LIGHTEN";break;case"OVERLAY":_="MIX_RGB_OVERLAY";break;case"DODGE":_="MIX_RGB_DODGE";break;case"BURN":_="MIX_RGB_BURN";break;case"HUE":_="MIX_RGB_HUE";break;case"SATURATION":_="MIX_RGB_SATURATION";break;case"VALUE":_="MIX_RGB_VALUE";break;case"COLOR":_="MIX_RGB_COLOR";break;case"SOFT_LIGHT":_="MIX_RGB_SOFT_LIGHT";break;case"LINEAR_LIGHT":_="MIX_RGB_LINEAR_LIGHT";break;default:return xe.error("Unsupported MIX_RGB blend type: "+t.blend_type),null}d.push(["MIX_RGB_USE_CLAMP",Number(t.use_clamp)]),c=ee(t),l=te(t);break;case"MIX_WORLD_RGB":case"ADD_WORLD_RGB":c=[Z("Factor","Factor",t.fac,t.fac_is_linked),Z("Color1","Color1",[0,0,0],t.color1_is_linked),Z("Color2","Color1",[0,0,0],t.color2_is_linked)],l=[Z("Color","Color",[0,0,0],!0)];break;case"OUTPUT":c=ee(t),l=[];break;case"OUTPUT_MATERIAL":c=ee(t),l=[],u=J(t,"Surface"),p=u.Da,u={name:"output_surface",type:"OUTPUT_SURFACE",inputs:[u],outputs:[],Y:[],data:{value:{$L:"BSDF_COMPUTE"},YL:{name:"bsdf_begin",type:"BSDF_BEGIN",inputs:[u,Z("d_color","d_color",[0,0,0],p),Z("d_roughness","d_roughness",0,p),Z("s_color","s_color",[0,0,0],p),Z("s_roughness","s_roughness",0,p),Z("metalness","metalness",0,p),Z("normal","normal",[0,0,0],p),Z("e_color","e_color",[0,0,0],p),Z("emission","emission",0,p),Z("a_color","a_color",[0,0,0],p),Z("alpha","alpha",0,p)],outputs:[Z("E","E",[0,0,0],!0),Z("A","A",[0,0,0],!0),Z("D","D",[0,0,0],!0),Z("S","S",[0,0,0],!0),Z("normal","normal",[0,0,0],!0),Z("bsdf_params","bsdf_params",[0,0,0,0],!0),Z("shadow_factor","shadow_factor",0,!0),Z("d_color","d_color",[0,0,0],!0),Z("s_color","s_color",[0,0,0],!0),Z("e_color","e_color",[0,0,0],!0),Z("emission","emission",0,!0),Z("a_color","a_color",[0,0,0],!0),Z("alpha","alpha",0,!0)],Y:[],data:null,Ua:[],ue:[]},ZL:{name:"bsdf_end",type:"BSDF_END",inputs:[Z("color","color",[0,0,0],!0),Z("specular","specular",[0,0,0],!0),Z("normal","normal",[0,0,0],!0),Z("bsdf_params","bsdf_params",[0,0,0,0],!0),Z("d_color","d_color",[0,0,0],!0),Z("s_color","s_color",[0,0,0],!0),Z("e_color","e_color",[0,0,0],!0),Z("emission","emission",0,!0),Z("a_color","a_color",[0,0,0],!0),Z("alpha","alpha",0,!0)],outputs:[Z("color","color",[0,0,0],p)],Y:[],data:null,Ua:[],ue:[]}},Ua:[],ue:[]},u={name:t.name,QR:u,mO:{name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:[Z("Height","Height",0,!0)],outputs:[Z("Normal","Normal",[0,0,0],!1)],Y:[],data:null,Ua:[],ue:[]}};break;case"OUTPUT_WORLD":c=ee(t),l=te(t),u=J(t,"Surface"),u={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:[u],outputs:[],Y:[],data:null,Ua:[],ue:[]},u={name:t.name,RR:u};break;case"RGB":p=t.name,p={name:"-1",value:p},f.push(p),l.push(K(t,"Color"));break;case"SEPRGB":case"SEPHSV":c=ee(t),l=te(t);break;case"TEX_ENVIRONMENT":(p=t.image)?(_="TEXTURE_ENVIRONMENT_"+t.projection,"NONE"==t.color_space?d.push(["NON_COLOR",1]):d.push(["NON_COLOR",0]),c.push(J(t,"Vector")),d.push(["USE_VECTOR_IN",0|c[0].Da]),l.push(K(t,"Color")),m=q("param_TEXTURE_texture"),f.push(ae(m)),u=we.Zj(we.Ug,!1),u.repeat=!0,u.source="IMAGE",Ce.Jx&&(u.anisotropic_filtering=16),we.yC(u,p),u={Op:t.name,ft:"",name:m,value:u}):_="TEXTURE_EMPTY";break;case"TEX_IMAGE":if(p=t.image){for(_="TEXTURE_COLOR","NONE"==t.color_space?d.push(["NON_COLOR",1]):d.push(["NON_COLOR",0]),d.push(["CONVERT_UV",0]),m=0;4>m;++m)m?(E=Z("Vector"+m,"Vector"+m,[0,0,0],!1),g=Z("Color"+m,"Color"+m,[0,0,0],!1),h=Z("Alpha"+m,"Alpha"+m,0,!1)):(E=J(t,"Vector"),g=K(t,"Color"),h=K(t,"Alpha")),c.push(E),l.push(g),l.push(h);m=q("param_TEXTURE_texture"),f.push(ae(m)),u=we.Zj(we.Ug,!1),u.repeat="REPEAT"==t.extension,u.source="IMAGE",we.yC(u,p),u={Op:t.name,ft:"",name:m,value:u}}else _="TEXTURE_EMPTY";break;case"TEXTURE":if("TEXTURE_EMPTY"==(_=V(t)))l.push(K(t,"Color")),l.push(K(t,"Normal")),l.push(K(t,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==_)c.push(J(t,"Vector")),l.push(K(t,"Color")),l.push(K(t,"Value"));else{if("TEXTURE_NORMAL"==_&&"ENVIRONMENT_MAP"==t.texture.type)return xe.error("Wrong output for ENVIRONMENT_MAP texture: "+t.name),null;for("TEXTURE_COLOR"==_&&(p=!1,m=t.texture.image,!m||"Non-Color"!=m.colorspace_settings_name&&"Non-Colour Data"!=m.colorspace_settings_name||(p=!0),d.push(["NON_COLOR",Number(p)]),d.push(["CONVERT_UV",1])),m=0;4>m;++m)p="TEXTURE_COLOR"==_?"Color":"Normal",m?(E=Z("Vector"+m,"Vector"+m,[0,0,0],!1),g=Z(p+m,p+m,[0,0,0],!1),h=Z("Value"+m,"Value"+m,0,!1)):(E=J(t,"Vector"),g=K(t,p),h=K(t,"Value")),c.push(E),l.push(g),l.push(h)}"TEXTURE_EMPTY"!=_&&(m=q("param_TEXTURE_texture"),f.push(ae(m)),u=t.texture.G,u={Op:t.texture.name,ft:t.texture.uuid,name:m,value:u});break;case"VALTORGB":c=ee(t),l=te(t),u={value:t},p=t.color_ramp.interpolation,"CONSTANT"!=p&&"LINEAR"!=p&&xe.warn("Color Ramp node is not fully supported.");break;case"VALUE":_="VALUE",p=t.name,p={name:"-1",value:p},f.push(p),l.push(K(t,"Value"));break;case"VECT_MATH":switch(t.operation){case"ADD":_="VECT_MATH_ADD";break;case"SUBTRACT":_="VECT_MATH_SUBTRACT";break;case"AVERAGE":_="VECT_MATH_AVERAGE";break;case"DOT_PRODUCT":_="VECT_MATH_DOT_PRODUCT";break;case"CROSS_PRODUCT":_="VECT_MATH_CROSS_PRODUCT";break;case"NORMALIZE":_="VECT_MATH_NORMALIZE";break;default:return xe.error("Unsupported VECT_MATH operation: "+t.operation),null}c=ee(t),l=te(t);break;case"VECT_TRANSFORM":switch(t.vector_type){case"POINT":d.push(["VECTOR_TYPE",Te.R(0)]);break;case"VECTOR":d.push(["VECTOR_TYPE",Te.R(1)]);break;case"NORMAL":d.push(["VECTOR_TYPE",Te.R(2)]);break;default:return xe.error("Unsupported VECT_TRANSFORM vector_type: "+t.vector_type),null}if(c=t.convert_from,l=t.convert_to,"WORLD"==c)if("WORLD"==l)c=0;else if("OBJECT"==l)c=1;else{if("CAMERA"!=l)return xe.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;c=2}else if("OBJECT"==c)if("WORLD"==l)c=3;else if("OBJECT"==l)c=4;else{if("CAMERA"!=l)return xe.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;c=5}else{if("CAMERA"!=c)return xe.error("Unsupported VECT_TRANSFORM convert_from: "+t.convert_from),null;if("WORLD"==l)c=6;else if("OBJECT"==l)c=7;else{if("CAMERA"!=l)return xe.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;c=8}}d.push(["CONVERT_TYPE",Te.R(c)]),c=ee(t),l=te(t);break;case"NORMAL_MAP":switch(t.space){case"TANGENT":p=0;break;case"OBJECT":p=1;break;case"WORLD":p=2;break;case"BLENDER_OBJECT":p=3;break;case"BLENDER_WORLD":p=4;break;default:return xe.error("Unsupported NORMAL_MAP space: "+t.space),null}d.push(["SPACE",Te.R(p)]),c.push(J(t,"Strength")),c.push(J(t,"Color")),c.push(Z("Normal","Normal",[0,0,0],!1)),d.push(["USE_NORMAL_IN",0]),l.push(K(t,"Normal"));break;case"FRESNEL":A=J(t,"Normal"),c.push(J(t,"IOR")),c.push(A),l.push(K(t,"Fac")),d.push(["USE_FRESNEL_NORMAL",0|A.Da]);break;case"LAYER_WEIGHT":A=J(t,"Normal"),c.push(J(t,"Blend")),c.push(A),l=te(t),d.push(["USE_NORMAL_IN",0|A.Da]);break;case"BUMP":A=J(t,"Normal"),d.push(["INVERT",t.invert?1:0]),d.push(["USE_NORMAL_IN",0|A.Da]),c=ee(t),l=te(t);break;case"BACKGROUND":c=ee(t),l=te(t);break;default:c=ee(t),l=te(t)}if(i={name:o,qd:i,type:_,ue:s,inputs:c,outputs:l,Y:f,data:u,Ua:d},o=ve.Zi(e),ve.Yg(e,o,i),!(i="GEOMETRY"!=t.type&&"TEX_COORD"!=t.type&&"NEW_GEOMETRY"!=t.type)){e:{for(i=t.outputs,s=_=0;s<i.length;s++)if(i[s].is_linked&&_++>a){i=!0;break e}i=!1}i=!i}return i||null!=j(e,t,++a,r,n)?o:null}function B(e,t,a){for(var r=e.inputs,n=e.outputs,o=e.node_tree_name,i=0;i<t.length;i++){var _=r[i],s=t[i];if(!_||_.default_value instanceof Array!=s)return xe.warn('Wrong inputs for custom node group "'+e.name+'" of type: "',o,'".Processing as general node group.'),!1}for(i=0;i<a.length;i++)if(t=n[i],r=a[i],!t||t.default_value instanceof Array!=r)return xe.warn('Wrong outputs for custom node group "'+e.name+'" of type: "',o,'".Processing as general node group.'),!1;return!0}function H(e,t,r){var n,o=e.node_group.node_tree,i={};for(n in o)if("links"==n||"nodes"==n){i[n]=[];for(var _=0;_<o[n].length;_++){i[n][_]={};for(var s in o[n][_])if("links"==n){i[n][_][s]={};for(var c in o[n][_][s])i[n][_][s][c]=X(o[n][_][s][c])}else i[n][_][s]=X(o[n][_][s])}}else i[n]=X(o[n]);for(_=e.node_tree_name,"B4W_REPLACE"!=_&&"B4W_LEVELS_OF_QUALITY"!=_||(o=G("Group input","GROUP_INPUT",[],e.inputs),n=G("Group output","GROUP_OUTPUT",e.outputs,[]),_="B4W_REPLACE"==_||"B4W_LEVELS_OF_QUALITY"==_&&(Ce.quality==ge.P_LOW||Ce.lE)?{from_node:o,from_socket:o.outputs[1],to_node:n,to_socket:n.inputs[0]}:{from_node:o,from_socket:o.outputs[0],to_node:n,to_socket:n.inputs[0]},i.nodes=[o,n],i.links=[_]),o=e.name,n=i.nodes,_=i.links,s=0;s<n.length;s++)n[s].name=ie(n[s].type,o,n[s].name);for(s=0;s<_.length;s++)_[s].from_node.name=ie(_[s].from_node.type,o,_[s].from_node.name),_[s].to_node.name=ie(_[s].to_node.type,o,_[s].to_node.name);return{JR:a(i,e.node_group.uuid,!0,t,r).va,KR:i.links}}function X(e){var t=typeof e;return"string"!=t&&"number"!=t&&"boolean"!=t&&e?Se.aq(e):e}function q(e){Re[e]||(Re[e]=0);var t=e+"_"+Re[e],t=t.replace(/ /g,"_").replace(/\//g,"_");return Re[e]++,t}function z(e){e=e.outputs;for(var t=0;t<e.length;t++)if(e[t].is_linked)return!0;return!1}function W(e,t){for(var a=e.outputs,r=0,n=0;n<a.length;n++){var o=a[n];if(o.is_linked&&!(r++<t))switch(o.identifier){case"UV":return"GEOMETRY_UV";case"Vertex Color":return"GEOMETRY_VC";case"Normal":return"GEOMETRY_NO";case"True Normal":return"GEOMETRY_TRN";case"Front/Back":return"GEOMETRY_FB";case"View":return"GEOMETRY_VW";case"Global":case"Position":return"GEOMETRY_GL";case"Local":return"GEOMETRY_LO";case"Orco":return"GEOMETRY_OR";case"Incoming":return"GEOMETRY_IN";case"Backfacing":return"GEOMETRY_BF";default:return null}}}function Y(e,t){for(var a=e.outputs,r=0,n=0;n<a.length;n++){var o=a[n];if(o.is_linked&&!(r++<t))switch(o.identifier){case"Camera":return"TEX_COORD_CA";case"Generated":return"TEX_COORD_GE";case"Normal":return"TEX_COORD_NO";case"Object":return"TEX_COORD_OB";case"Reflection":return"TEX_COORD_RE";case"UV":return"TEX_COORD_UV";case"Window":return"TEX_COORD_WI";default:return null}}}function V(e){if(!e.texture||!e.texture.G)return"TEXTURE_EMPTY";for(var t=e.outputs,a=!1,r=!1,n=!1,o=0;o<t.length;o++){var i=t[o];if(i.is_linked)switch(i.identifier){case"Color":a=!0;break;case"Normal":r=!0;break;case"Value":n=!0;break;default:Se.F("Unknown texture output")}}return a?(r&&xe.warn('Node "'+e.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"):r?"TEXTURE_NORMAL":n?"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR":void 0}function J(e,t){for(var a=e.inputs,r=0;r<a.length;r++){var n=a[r];if(n.identifier==t)return Q(n)}return null}function K(e,t){for(var a=e.outputs,r=0;r<a.length;r++){var n=a[r];if(n.identifier==t)return Q(n)}return null}function Q(e){var t=e.name,a=e.identifier,r=e.is_linked;return e=e.default_value,e=Se.is_vector(e)?e.slice(0):e,{name:t,identifier:a,Da:r,Aa:e}}function Z(e,t,a,r){return{name:e,identifier:t,Da:r,Aa:a}}function $(e){return Z(e.name,e.identifier,e.Aa,e.Da)}function ee(e){for(var t=[],a=0;a<e.inputs.length;a++){var r=Q(e.inputs[a]);r.Aa.length&&r.Aa.splice(3),t.push(r)}return t}function te(e){for(var t=[],a=0;a<e.outputs.length;a++){var r=Q(e.outputs[a]);t.push(r)}return t}function ae(e,t,a){return t=null===t||void 0===t?null:Te.R(t,a),{name:e,value:t}}function re(e){return{name:e.name,value:e.value}}function ne(e){return e.slice()}function oe(e,t,a,r,n,o){var i=[],_=o.from_socket.identifier;o=o.to_socket.identifier;var s=r.outputs;for(r=0;r<s.length;r++)if(s[r].identifier==_){i.push(r);break}for(n=n.inputs,r=0;r<n.length;r++)if(n[r].identifier==o){i.push(r);break}return 2==i.length&&ve.vc(e,t,a,i),!0}function ie(e,t,a){return"GROUP_INPUT"==e?t+"*GI*"+a:"GROUP_OUTPUT"==e?t+"*GO*"+a:t+"%join%"+a}function _e(e){var t=[];return ve.X(e,function(e,a){"GROUP"==a.type&&t.push(a)}),t}function se(e,t,a){for(var r=0;r<a.length;r++){var n=a[r].data.JR,o=a[r].data.KR;if(!n)return!1;for(ve.X(n,function(t,a){ve.Yg(e,ve.Zi(e),a)}),n=0;n<o.length;n++)t.push(o[n]);de(a[r],t,e)}return!0}function ce(e,t,a,r,n,o){switch(e.type){case"GROUP":e.name==t&&r.push(a);break;case"GROUP_INPUT":e.name.indexOf(t+"*GI*")||n.push(a);break;case"GROUP_OUTPUT":e.name.indexOf(t+"*GO*")||o.push(a)}}function le(e,t,a){for(var r=[],n=0;n<a.length;n++){for(var o=a[n],i=null,_=0;_<t.length;_++)if(o.from_socket.identifier==t[_].to_socket.identifier){i=t[_];break}i?(o.from_node=i.from_node,o.from_socket=i.from_socket):r.push(o)}for(n=0;n<t.length;n++)e.splice(e.indexOf(t[n]),1);return r}function fe(e,t){if(t.length)for(var a=t[0].from_node.name,r=0;r<e.length;r++)e[r].from_node.name==a&&t.push(e[r])}function ue(e,t,a,r){for(var n=0;n<r.length;n++){for(var o,i=r[n],_=0;_<a.inputs.length;_++)if(i.from_socket.identifier==a.inputs[_].identifier){o=a.inputs[_].Aa;break}for(var _=i,s=t,c=o,l=T(_.to_node,s),f=0;f<l.length;f++)for(var u=ve.Qa(s,l[f]),d=0;d<u.inputs.length;d++){var p=u.inputs[d];if(p.identifier==_.to_socket.identifier){if(u=p.Aa instanceof Object?0:1,(c instanceof Object?0:1)==u)p.Aa=c;else switch(u){case 0:p=p.Aa,p[0]=p[1]=p[2]=c;break;case 1:p.Aa=(c[0]+c[1]+c[2])/3}break}}i=e.indexOf(i),-1!=i&&e.splice(i,1)}}function de(e,t,a){for(var r=e.name,n=[],o=[],i=[],_=[],s=0;s<t.length;s++){var c=t[s];ce(c.from_node,r,c,n,i,_),ce(c.to_node,r,c,o,i,_)}if(o=le(t,o,i),n=le(t,_,n),fe(t,o),ue(t,a,e,o),n.length){var l;ve.X(a,function(e,t){"GROUP_OUTPUT"!=t.type||t.name.indexOf(r+"*GO*")||(l=t)}),ue(t,a,l,n)}}function pe(e){var t=[],a=[];ve.X(e,function(e,r){switch(r.type){case"VALTORGB":t.push(r);break;case"CURVE_VEC":case"CURVE_RGB":a.push(r)}});var r=0,n=e=null,o=t.length+a.length;if(t.length){e=we.FO(t,we.TI);for(var i=0;i<t.length;i++)t[i].Ua.push(["NODE_TEX_ROW",Te.R((r+.5)/o)]),r++}if(a.length)for(n=we.JO(a,we.IB),i=0;i<a.length;i++)a[i].Ua.push(["NODE_TEX_ROW",Te.R((r+.5)/o)]),r++;for(i=null,e&&n?(i=new Uint8Array(e.length+n.length),i.set(e),i.set(n,e.length)):i=e||n,e=i?we.HD(i,we.IB):null,i=0;i<t.length;i++)t[i].data.Ma=e;for(i=0;i<a.length;i++)a[i].data.Ma=e}function me(e,t,a){return e=e.curve_mapping.curves_data[t],!(2==e.length&&e[0][0]<a+.01&&e[0][1]<a+.01&&.99<e[1][0]&&.99<e[1][1])}var ge=t("__config"),he=t("__debug"),ve=t("__graph"),be=t("__mat3"),Ee=t("__mat4"),Ae=t("__objects"),xe=t("__print"),Te=t("__shaders"),ye=t("__scenes"),Se=t("__util"),Oe=t("__vec3"),we=t("__textures"),Re={},Le={},Ne={},Ie={},Me=0,Ce=ge.H;e.fW=0,e.mC=1,e.lC=2,e.kC=3,e.eW=4,e.jC=5,e.iC=6,e.hC=7,e.dW=8,e.MJ=0,e.LJ=1,e.XV=2,e.KJ=3,e.WV=4,e.uu=function(e){return Le[e]},e.DM=function(e){delete Le[e]},e.AD=a,e.my=function(e,t,a){var r=ye.get_active();if((e=g(e,"MAIN",r.uuid))in Ne)return Ne[e];var r=ve.create(),o={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},i=j(r,o,0,t,null),o={name:"LIGHTING_END",type:"LIGHTING_END"},o=j(r,o,0,t,null);return n(r,a,i,o,[[i,[8,10]],[i,[9,6]]],t),b(r),Ne[e]=r},e.kq=function(e){var t=[],a={};Re={};var r=ve.fB(e);return ve.X(r,function(e,r){var n;n=[];for(var o=[],i=[],_=[],s=[],c=[],l=0;l<r.inputs.length;l++){var f=r.inputs[l];if(f.Da)n.push(null),o.push(null);else{n.push(q("in_"+r.type+"_"+f.identifier.replace(/\./g,"")));var u=Te.R(f.Aa,0);Ce.JA&&(0<=r.type.indexOf("MIX_RGB_")&&("Color1"==f.identifier||"Color2"==f.identifier||"Fac"==f.identifier)||0<=r.type.indexOf("MATH_")&&("Value"==f.identifier||"Value_001"==f.identifier||"Value.001"==f.identifier)||0<=r.type.indexOf("VECT_MATH_")&&("Vector_001"==f.identifier||"Vector.001"==f.identifier)||0<=r.type.indexOf("LIGHTING_APPLY")||0<=r.type.indexOf("MATERIAL_END")||0<=r.type.indexOf("MATERIAL_BEGIN"))&&(f=u,f=f.replace(/(,)/g,"$1 "),f=f.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),f=f.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),u=f=f.replace(/\s+/g,"")),o.push(u)}}for(l=0;l<r.outputs.length;l++)f=r.outputs[l],f.Da?i.push(null):i.push(q("out_"+r.type+"_"+f.identifier.replace(/\./g,"")));for(l=0;l<r.Y.length;l++)f=r.Y[l],_.push(f.name),s.push(f.value);for(l=0;l<r.ue.length;l++)c.push(r.ue[l].name);n={id:r.type,inputs:n,mz:o,outputs:i,Y:_,ro:s,ue:c,Ua:JSON.parse(JSON.stringify(r.Ua))},t.push(n),a[e]=n}),ve.Pg(r,function(e,t,n){var o=ve.Qa(r,e),i=o.outputs[n[0]];e=a[e].outputs,t=a[t].inputs,o=e[n[0]]||q("out_"+o.type+"_"+i.identifier.replace(/\./g,"")),e[n[0]]=o,t[n[1]]=o}),t},e.iD=function(e){if(e.node_tree)for(var t=0;t<e.node_tree.nodes.length;t++){var a=e.node_tree.nodes[t];if("GROUP"==a.type&&"B4W_GLOW_OUTPUT"==a.node_tree_name)return!0}return!1},e.oY=function(e,t){xe.log("\n================ MATERIAL: "+t+" ================\n"+he.LR(e)+"\n============================================================")},e.cleanup=function(){for(var e in Le)delete Le[e];for(e in Ne)delete Ne[e];for(var t in Ie)delete Ie[t];Me=0},e.UP=function(e){var t=-1;return ve.X(e,function(e,a){"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"!=a.type&&"TEXTURE_ENVIRONMENT_MIRROR_BALL"!=a.type||(t=Math.max(t,a.data.value.height))}),t}},a.module.__animation=function(e,t){function a(e,t){var a=e.ia[t];a&&a.cu&&a.Cq&&(a.Cq=!1,a.cu(e,t))}function r(e,t,a){a=e.ia[a],a.type=30;var r=t.sa,n=t.Za-r+1;for(a.start=r,a.length=n,a.Kf=r,a.Gi=t.name,n=r=0;n<e.Rc.length;n++){var o=e.Rc[n];if(o==t)break;r+=o.Za-o.sa+1}a.xI=r}function n(e,t){e.type=50,e.Gi=t.name,e.start=t.sa,e.length=t.Za-e.start,t.cyclic||(e.length+=t.ar)}function o(e){return e.replace(/_B4W_BAKED$/,"")}function i(e,t){return{io:e,action:t}}function _(e,t,a){if(e.animation_data){var r=e.animation_data.action;r&&60==r.G.type&&t.push(i(a,r))}for(e=e.nodes,r=0;r<e.length;r++){var n=e[r];if(n.node_group){var o=n.node_group.node_tree;if(o){var s=a.slice();s.push(n.name),_(o,t,s)}}}}function s(e){return!(!B.is_mesh(e)||!e.o.Rc)}function c(e,t,a){var r=e.ia;if(-1==a)for(a=0;8>a;a++){var n=r[a];n&&(n.Kf=t,f(e,0,a,!0))}else(n=r[a])&&(n.Kf=t,f(e,0,a,!0))}function l(e,t,a){if(-1==t)for(t=0;8>t;t++){var r=e[t];r&&a(r)}else(r=e[t])&&a(r)}function f(e,t,r,n){v(e,t,r,n),a(e,r),e.o.Fi&&(T(e,t),E(e,t))}function u(e,t,a,r){var n=a.frame_range;if(n[0]>n[1])return q.warn('Incompatible action "'+a.name+'" has been applied to object "'+e.name+'"'),!1;var o=a.G,i=e.ia[r];switch(i.Gi=a.name,i.Dx=n,i.vC=o.pG,i.tC=o.OC,i.Ni.set(o.Ni),i.start=n[0],i.length=n[1]-n[0],i.Kf=n[0],o.type){case 10:if(B.is_armature(e)){i.type=10;var _=d(e,t,a);if(!_){for(var _=e.o.qg,n=[],s=[],c=[],l=[],f=a.G.Xz,u=0;u<f;u++){for(var v in _){var b=_[v],E=b.as,A=a.G.Tx[v];A?Z.copy(A.subarray(8*u,8*u+8),E):Z.identity(E),b.Kw=!1}b=y(_),n.push(b.trans),s.push(b.Fb),c.push(b.Li),l.push(b.Ki)}_={trans:n,Fb:s,Li:c,Ki:l},p(e,t,a,_)}i.trans=_.trans,i.Fb=_.Fb,i.Ki=_.Ki,i.Li=_.Li,t=_,i=e.o,_=i.Go,n=e.ia[r],v=n.OA;e:{for(s=i.ew,c=0;c<s.length;c+=2)if(a==s[c]){s=s[c+1];break e}s=null}if(s)n.OA=s;else{for(n=0;n<_.length;n++){for(s=_[n].Oh,c=[],l=[],f=t.trans,u=t.Fb,b=0;b<f.length;b++)E=S(f[b],u[b],s),c.push(E.trans),l.push(E.Fb);v.push({trans:c,Fb:l})}i.ew.push(a,v)}i.Fi&&(a=i.Mh,r>a[1]?(t=a[1],a[1]=r,a[0]=t):r>a[0]&&r<a[1]&&(a[0]=r),m(e))}break;case 40:B.is_speaker(e)&&(i.volume=o.Y.volume||null,i.pitch=o.Y.pitch||null,i.type=40);break;case 70:B.is_lamp(e)&&(i.color=o.Y.color||null,i.Mf=o.Y.energy||null,i.type=70);break;case 60:if("MESH"==e.type||"WORLD"==e.type){if(i.type=60,v=B.is_world(e),!(n=d(e,t,a))){n=[],s=[],c=[],l=[],f=[],u=a.G,b=t?t[0]:null;for(_ in u.Y){if(E=t,A=_.match(/"(.*?)"/)[1],E&&1<E.length){for(var x=E[1],T=2;T<E.length;T++)x=x+"%join%"+E[T];x+="%join%"+A}else x=A;for(E=x,A=0;A<e.K.length;A++)for(x=e.K[A].U,T=0;T<x.length;T++){var O=x[T];if(v||!b||-1!=O.Pb.indexOf(b)){var w=O.kf,R=h(_,E,u,s,n,O.lf),w=h(_,E,u,l,c,w);(R||w)&&f.push(O)}}}n={nV:n,values:s,HS:c,IS:l,yk:f},p(e,t,a,n)}i.lf=n.nV,i.bG=n.values,i.kf=n.HS,i.aG=n.IS,i.yk=n.yk}break;case 20:if(!(_=o.Y.tsr))return q.warn('Incompatible action "'+a.name+'" has been applied to object "'+e.name+'"'),!1;if(i.type=20,!(v=d(e,t,a))){for(v=a.G.Xz,n=[],s=[],c=0;c<v;c++)n.push(_.subarray(8*c,8*c+4)),s.push(_.subarray(8*c+4,8*c+8));v={trans:n,Fb:s},p(e,t,a,v)}i.trans=v.trans,i.Fb=v.Fb,H.Yz(e)&&H.aV(e,i.trans[0],i.Fb[0]);break;case 80:B.is_world(e)&&(i.Mf=o.Y["light_settings.environment_energy"]||null,i.yd=o.Y.horizon_color||null,i.Ld=o.Y.zenith_color||null,i.fog_intensity=o.Y["mist_settings.intensity"]||null,i.fog_depth=o.Y["mist_settings.depth"]||null,i.fog_start=o.Y["mist_settings.start"]||null,i.fog_height=o.Y["mist_settings.height"]||null,i.kE=o.Y.b4w_fog_color||null,i.type=80)}return B.is_armature(e)&&10!=o.type&&g(e,r),!0}function d(e,t,a){e=e.en,t=t?t.join("%join%"):null;for(var r=0;r<e.length;r+=3)if(a==e[r]&&t==e[r+1])return e[r+2];return null}function p(e,t,a,r){e.en.push(a,t?t.join("%join%"):null,r)}function m(e){var t=e.o.Mh;if(-1!=t[0]&&-1!=t[1]){var a=e.ia;e=a[t[1]].Kf;var r=Math.floor(e),n=e-r,t=a[t[0]];e=t.Kf,r=Math.floor(e),t.Kf=r+n}}function g(e,t){var a=e.o.Mh,r=a[1];if(a[0]=-1,a[1]=-1,-1!=t)for(var n=e.ia;0<=r;r--){var o=n[r];if(o&&10==o.type){if(!(r>a[1])){r>a[0]&&(a[1]=r);break}a[1]=r}}}function h(e,t,a,r,n,o){if(!o)return!1;for(var i=!1,_=0;_<o.length;_+=2)t==o[_]&&(n.push(o[_+1]),r.push(new Float32Array(a.Y[e])),i=!0);return i}function v(e,t,a,r){if((a=e.ia[a])&&null!=a.type&&(a.play||r)){var n=e.o,o=a.Kf,i=a.start,_=a.length,o=o+a.speed*t*K.pd(),s=a.type,c=a.speed;if(0<=c&&o>=i+_||0>c&&o<i)switch(r||(a.Cq=!0),a.behavior){case 10:o=0<=c?(o-i)%_+i:i+_-1e-6;break;case 20:o=0<=c?i:i+_-1e-6,a.play=!1;break;case 30:o=0<=c?i+_-1e-6:i,a.play=!1}switch(a.Kf=o,s){case 10:if(!n.Fi){r=b(a),t=r[0];var l=r[1];r=r[2],n.Bd=a.Fb[t],n.oe=a.Fb[l],n.Jd=a.trans[t],n.te=a.trans[l],n.gf=r,r=n.Go,a=a.OA;for(var f=0;f<r.length;f++){var u=r[f],d=a[f];u.Bd=d.Fb[t],u.oe=d.Fb[l],u.Jd=d.trans[t],u.te=d.trans[l],u.gf=n.gf}Q.O(e)}break;case 20:r=b(a);var n=ne,l=r[0],f=r[1],u=r[2],d=a.trans,p=d[l][1],o=d[l][2],i=d[f][1],_=d[f][2];n[0]=(1-u)*d[l][0]+u*d[f][0],n[1]=(1-u)*p+u*i,n[2]=(1-u)*o+u*_,l=le,o=r[0],f=r[1],u=r[2],d=a.Fb,p=fe,p[0]=d[o][0],p[1]=d[o][1],p[2]=d[o][2],p[3]=d[o][3],o=ue,o[0]=d[f][0],o[1]=d[f][1],o[2]=d[f][2],o[3]=d[f][3],z.slerp(p,o,u,l),f=r[2],u=a.trans,r=(1-f)*u[r[0]][3]+f*u[r[1]][3],e.parent&&e.Lv&&(f=pe,Z.set_sep(n,r,l,f),Z.multiply(e.Lv,f,f),Z.Cb(f,n),Z.mb(f,l),r=Z.get_scale(f)),a.oB&&(f=oe,Q.get_translation(e,f),$.smooth_v(n,f,t,a.oB,n)),a.pA&&(f=fe,Q.get_rotation(e,f),$.uH(l,f,t,a.pA,l)),o=a.Ni,o[0]&&Q.set_translation_rel(e,n),o[1]&&Q.set_rotation_rel(e,l),o[2]&&Q.set_scale_rel(e,r),Q.O(e),X.sync_transform(e);break;case 30:r=a.Kf-a.start,0>r&&(r=0),r>=a.length&&(r=a.length),e=Math.floor(r),t=e+1,r-=e,10!=a.behavior&&t==a.length&&(t=--e,r=1),a=a.xI,re[0]=e+a,re[1]=t+a,re[2]=r,r=re,n.Uw=r[0],n.Vw=r[2];break;case 40:r=b(a),t=r[0],n=r[1],r=r[2],a.volume&&V.set_volume(e,(1-r)*a.volume[t]+r*a.volume[n]),a.pitch&&V.playrate(e,(1-r)*a.pitch[t]+r*a.pitch[n]);break;case 50:t=10==a.behavior?(o-i)/K.pd():o/K.pd(),H.AT(e,a.Gi,t);break;case 60:for(r=b(a),t=r[0],n=r[1],r=r[2],p=a.bG,o=a.lf,l=a.aG,f=a.kf,u=a.yk,a=0;a<o.length;a++)for(i=p[a],d=o[a],_=(1-r)*i[t]+r*i[n],i=0;i<u.length;i++)u[i].oh[d]=_;for(a=0;a<f.length;a++)for(p=l[a],d=f[a],p=ee.lerp(p.subarray(3*t,3*t+3),p.subarray(3*n,3*n+3),r,ne),i=0;i<u.length;i++)u[i].Xd[3*d]=p[0],u[i].Xd[3*d+1]=p[1],u[i].Xd[3*d+2]=p[2];B.is_world(e)&&Y.Nw(e);break;case 70:for(r=b(a),t=r[0],n=r[1],r=r[2],o=a.Ni,(_=a.Mf)&&o[0]&&j.set_light_energy(e.wb,(1-r)*_[t]+r*_[n]),(a=a.color)&&o[1]&&(ne[0]=(1-r)*a[3*t]+r*a[3*n],ne[1]=(1-r)*a[3*t+1]+r*a[3*n+1],ne[2]=(1-r)*a[3*t+2]+r*a[3*n+2],j.set_light_color(e.wb,ne)),i=e.K,a=0;a<i.length;a++)Y.HU(e,i[a].eb);break;case 80:r=b(a),t=r[0],n=r[1],r=r[2],o=a.Ni,i=e.K,c=Y.Ib(i[0].eb,J.Gb),_=a.Mf,_=o[0]?(1-r)*_[t]+r*_[n]:c.Mf,s=a.yd,o[1]?(ne[0]=(1-r)*s[3*t]+r*s[3*n],ne[1]=(1-r)*s[3*t+1]+r*s[3*n+1],ne[2]=(1-r)*s[3*t+2]+r*s[3*n+2],s=ne):s=c.yd;var m=a.Ld;for(o[2]?(oe[0]=(1-r)*m[3*t]+r*m[3*n],oe[1]=(1-r)*m[3*t+1]+r*m[3*n+1],oe[2]=(1-r)*m[3*t+2]+r*m[3*n+2],c=oe):c=c.Ld,m=a.fog_intensity,o[3]&&(l=(1-r)*m[t]+r*m[n]),m=a.fog_depth,o[4]&&(f=(1-r)*m[t]+r*m[n]),m=a.fog_start,o[5]&&(u=(1-r)*m[t]+r*m[n]),m=a.fog_height,o[6]&&(d=(1-r)*m[t]+r*m[n]),a=a.kE,o[7]&&(le[0]=(1-r)*a[3*t]+r*a[3*n],le[1]=(1-r)*a[3*t+1]+r*a[3*n+1],le[2]=(1-r)*a[3*t+2]+r*a[3*n+2],p=le),a=0;a<i.length;a++)t=e.K[a].eb,(o[0]||o[1]||o[2])&&Y.set_environment_colors(t,_,s,c),o[3]&&Y.XG(t,l),o[4]&&Y.VG(t,f),o[5]&&Y.YG(t,u),o[6]&&Y.WG(t,d),o[7]&&Y.set_fog_color_density(t,p);break;default:$.F("Unknown animation type:"+s)}}}function b(e){var t=e.Dx[0],a=e.Dx[1]-t,t=e.Kf-t;return 0>t&&(t=0),t>=a&&(t=a),t/=e.vC,a=Math.floor(t),e=e.tC[a]?t-a:0,t=Math.ceil(a+e),re[0]=a,re[1]=t,re[2]=e,re}function E(e,t){var a=e.o,r=a.Ue,n=a.Mh,o=n[0],n=n[1];if(-1!=n){if(-1!=o){var i=e.ia[o];if(i.play||0==t||a.nh){var _=b(i),s=_[0],c=_[1];a.gf=_[2];var _=i.Fb[s],l=i.Fb[c],f=i.trans[s],u=i.trans[c]}else r=1}else r=1;if(n=e.ia[n],n.play||0==t||a.nh){var o=b(n),d=o[0],p=o[1];a.gf=o[2]}else{if(-1==o||!i.play)return;r=0}var o=n.Fb[d],m=n.Fb[p],g=n.trans[d],h=n.trans[p];if(1!=r||a.nh)if(0!=r||a.nh){if(r=a.qg,a.nh&&!a.Vk&&!a.Gk){a.Vk=new Float32Array(a.Jd.length),a.Gk=new Float32Array(a.Bd.length);for(var v in r)_=r[v],_.tm||x(a,_)}for(v in r)_=r[v],_.tm||A(a,_,i,n,s,c,d,p)}else a.Bd.set(_),a.oe.set(l),a.Jd.set(f),a.te.set(u);else a.Bd.set(o),a.oe.set(m),a.Jd.set(g),a.te.set(h);Q.O(e),G.YU(e)}}function A(e,t,a,r,n,o,i,_){var s=t.tm,c=e.Ue,l=le,f=fe,u=ie,d=_e,p=ue,m=de,g=se,h=ce,v=4*t.Nh,b=r.Ki[i],E=r.Li[i],x=r.Ki[_],T=r.Li[_];if(!e.nh)var y=a.Ki[n],S=a.Li[n],O=a.Ki[o],w=a.Li[o];for(var R=0;4>R;R++)f[R]=b[v+R],d[R]=E[v+R],m[R]=x[v+R],h[R]=T[v+R],e.nh?(l[R]=e.Gk[v+R],u[R]=e.Vk[v+R],p[R]=e.Gk[v+R],g[R]=e.Vk[v+R]):(l[R]=y[v+R],u[R]=S[v+R],p[R]=O[v+R],g[R]=w[v+R]);for(z.slerp(l,f,c,l),$.at(u,d,c,u),Z.set_transcale(u,pe),Z.set_quat(l,pe),s&&Z.multiply(s.Mw,pe,pe),Z.copy(pe,t.Mw),Z.multiply(pe,t.rB,pe),Z.Oq(pe,u),Z.mb(pe,l),z.slerp(p,m,c,p),$.at(g,h,c,g),Z.set_transcale(g,pe),Z.set_quat(p,pe),s&&Z.multiply(s.Lw,pe,pe),Z.copy(pe,t.Lw),Z.multiply(pe,t.rB,pe),Z.Oq(pe,g),Z.mb(pe,p),R=0;4>R;R++)e.Bd[v+R]=l[R],e.Jd[v+R]=u[R],e.oe[v+R]=p[R],e.te[v+R]=g[R];for(t=t.Ot,R=0;R<t.length;R++)A(e,t[R],a,r,n,o,i,_)}function x(e,t){for(var a=4*t.Nh,r=t.tm,n=e.Ue,o=ie,i=le,_=_e,s=fe,c=0;4>c;c++)o[c]=e.Jd[a+c],i[c]=e.Bd[a+c],_[c]=e.te[a+c],s[c]=e.oe[a+c];for(Z.set_transcale(o,pe),Z.set_quat(i,pe),Z.multiply(pe,t.Dh,pe),Z.copy(pe,t.Mw),r&&(Z.invert(r.Mw,me),Z.multiply(me,pe,pe)),Z.Oq(pe,o),Z.mb(pe,i),Z.set_transcale(_,pe),Z.set_quat(s,pe),Z.multiply(pe,t.Dh,pe),Z.copy(pe,t.Lw),r&&(Z.invert(r.Lw,me),Z.multiply(me,pe,pe)),Z.Oq(pe,_),Z.mb(pe,s),z.slerp(i,s,n,i),$.at(o,_,n,o),c=0;4>c;c++)e.Gk[a+c]=i[c],e.Vk[a+c]=o[c];for(a=t.Ot,c=0;c<a.length;c++)x(e,a[c])}function T(e,t){var a=e.o,r=a.Ue,n=a.gn;if(0!=n){!a.nh||a.Vk||a.Gk||(r=a.Ue=0);var r=a.fn-r,o=n*t;$.sign(r)==$.sign(n)&&Math.abs(o)<Math.abs(r)?a.Ue+=o:(a.Ue=a.fn,a.gn=0,a.Ei&&(a.Ei(),a.Ei=null),a.nh&&(a.Vk=null,a.Gk=null,a.nh=!1))}}function y(e){var t,a=[],r=[],n=[],o=[],i=new Float32Array(4),_=new Float32Array(4);for(t in e){var s=e[t],c=i,l=_,f=s.ot,u=f[f.length-1],d=u.qB;for(u.Kw||Z.identity(d),u=f.length-1;0<=u;u--){var p=f[u],m=p.qB;if(p.Kw)d=m;else{var g=p.Dh,h=p.as;Z.invert(g,pe),Z.multiply(h,pe,pe),Z.multiply(g,pe,pe),Z.multiply(d,pe,m),d=m,p.Kw=!0}}for(f=p.qB,c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],l[0]=f[4],l[1]=f[5],l[2]=f[6],l[3]=f[7],z.normalize(l,l),c=s.Nh,Z.multiply(s.Yo,s.as,pe),s=0;4>s;s++)l=4*c+s,a[l]=i[s],r[l]=_[s],n[l]=pe[s],o[l]=pe[s+4]}return{trans:a,Fb:r,Li:n,Ki:o}}function S(e,t,a){var r,n=[],o=[];for(r in a)for(var i=a[r],_=i.Nh,i=i.wy,s=0;4>s;s++){var c=4*i+s,l=4*_+s;n[c]=e[l],o[c]=t[l]}return n=new Float32Array(n),o=new Float32Array(o),{trans:n,Fb:o}}function O(e){var t,a=e.G;if(a.Tx)t=10;else if(a.Y)if("volume"in a.Y||"pitch"in a.Y)t=40;else{var r;e:{if(r=e.G.Y)for(var n in r)if(-1!=n.indexOf("nodes")){r=!0;break e}r=!1}if(r)t=60;else{var o;e:{if(e.G.Y){r=e.fcurves;for(o in r)if("color"==o&&!r[o][3]){o=!0;break e}if("energy"==o){o=!0;break e}}o=!1}if(o)t=70;else if("light_settings.environment_energy"in(o=e.G.Y)||"horizon_color"in o||"zenith_color"in o||"mist_settings.intensity"in o||"mist_settings.depth"in o||"mist_settings.start"in o||"mist_settings.height"in o||"b4w_fog_color"in o)t=80;else{e:{if(e.G.Y)for(t in e=e.fcurves)if("location"==t||"rotation_quaternion"==t||"scale"==t){t=!0;break e}t=!1}t=t?20:0}}}else t=0;a.type=t}function w(e,t){t[0]=t[1]=t[2]=0;for(var a in e)"location"==a?t[0]=1:"rotation_quaternion"==a?t[1]=1:"scale"==a&&(t[2]=1)}function R(e,t){t[0]=t[1]=0;for(var a in e)"energy"==a?t[0]=1:"color"==a&&(t[1]=1)}function L(e,t){t[0]=t[1]=t[2]=0,t[3]=t[4]=t[5]=0,t[6]=t[7]=0;for(var a in e)"light_settings.environment_energy"==a?t[0]=1:"horizon_color"==a?t[1]=1:"zenith_color"==a?t[2]=1:"mist_settings.intensity"==a?t[3]=1:"mist_settings.depth"==a?t[4]=1:"mist_settings.start"==a?t[5]=1:"mist_settings.height"==a?t[6]=1:"b4w_fog_color"==a&&(t[7]=1)}function N(e,t,a,r,n,o,i){var _=e+(t-e)/2,s=I(_,r,n,o,i)-a;return.02>Math.abs(s)?_:0<s?N(e,_,a,r,n,o,i):N(_,t,a,r,n,o,i)}function I(e,t,a,r,n){var o=1-e;return t*o*o*o+3*a*o*o*e+3*r*o*e*e+n*e*e*e}function M(e,t){var a={type:null,Gi:null,Dx:null,vC:0,tC:null,Ni:new Int8Array(8),Fb:null,trans:null,Ki:null,Li:null,OA:[],play:!1,behavior:20,Kf:0,start:0,length:0,oB:0,pA:0,Cq:!1,xI:null,speed:1,volume:null,pitch:null,color:null,Mf:null,Ld:null,yd:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,kE:null,bG:[],lf:[],aG:[],kf:[],yk:null};if(!e.ia.length)for(var r=0;8>r;r++)e.ia.push(null);e.ia[t]=a,-1==ge.indexOf(e)&&ge.push(e)}function C(e,t){Q.O(e),X.sync_transform(e),f(e,0,t,!0)}function D(e,t,a,o){if(o=o||0,B.is_mesh(e)){var i=U(e,a);if(i)return M(e,o),r(e,i,o),C(e,o),!0;if((i=k(e,a))&&"EMITTER"==i.Fv){M(e,o),t=i.name,a=o;for(var i=e.K,_=0;_<i.length;_++)for(var s=i[_].U,c=0;c<s.length;c++){var l=s[c].Ba;l&&l.name==t&&n(e.ia[a],l)}return C(e,o),!0}}if(i=$.keysearch("name",a,he)||$.keysearch("name",a+"_B4W_BAKED",he)){if(M(e,o),u(e,t,i,o))return C(e,o),!0;e.ia[o]=null}return q.error('Unsupported object: "'+e.name+'" or animation name: "'+a+'"'),!1}function U(e,t){for(var a=0;a<e.Rc.length;a++){var r=e.Rc[a];if(r.name===t)return r}return null}function k(e,t){for(var a=e.K,r=0;r<a.length;r++)for(var n=a[r].U,o=0;o<n.length;o++){var i=n[o].Ba;if(i&&i.name===t)return i}return null}function P(e){e=e.modifiers;for(var t=0;t<e.length;t++){var a=e[t];if("ARMATURE"==a.type)return a.object}return null}var G=t("__armature"),F=t("__config"),j=t("__lights"),B=t("__obj_util"),H=t("__particles"),X=t("__physics"),q=t("__print"),z=t("__quat"),W=t("__reformer"),Y=t("__scenes"),V=t("__sfx"),J=t("__subscene"),K=t("__time"),Q=t("__transform"),Z=t("__tsr"),$=t("__util"),ee=t("__vec3"),te=F.sl,ae=F.Zg;e.mJ=1e-6,e.OBJ_ANIM_TYPE_NONE=0,e.OBJ_ANIM_TYPE_ARMATURE=10,e.OBJ_ANIM_TYPE_OBJECT=20,e.OBJ_ANIM_TYPE_VERTEX=30,e.OBJ_ANIM_TYPE_SOUND=40,e.OBJ_ANIM_TYPE_PARTICLES=50,e.OBJ_ANIM_TYPE_MATERIAL=60,e.YJ=70,e.XJ=80,e.SLOT_0=0,e.SLOT_1=1,e.SLOT_2=2,e.SLOT_3=3,e.SLOT_4=4,e.SLOT_5=5,e.SLOT_6=6,e.SLOT_7=7,e.SLOT_ALL=-1,e.AB_CYCLIC=10,e.AB_FINISH_RESET=20,e.AB_FINISH_STOP=30;var re=Array(3),ne=new Float32Array(3),oe=new Float32Array(3),ie=new Float32Array(4),_e=new Float32Array(4),se=new Float32Array(4),ce=new Float32Array(4),le=new Float32Array(4),fe=new Float32Array(4),ue=new Float32Array(4),de=new Float32Array(4),pe=Z.create(),me=Z.create(),ge=[],he=[];e.GE=function(){return $.trunc((ae.mv-50)/4)},e.frame_to_sec=function(e){return e/K.pd()},e.update=function(e){for(var t=0;t<ge.length;t++){for(var r=ge[t],n=0;8>n;n++)v(r,e,n);r.o.Fi&&(T(r,e),E(r,e))}for(t=0;t<ge.length;t++)for(r=ge[t],n=0;8>n&&r.ia.length;n++)a(r,n)},e.pP=function(){return he},e.get_anim_names=function(e){var t=[];if(s(e))for(var a=0;a<e.Rc.length;a++)t.push(e.Rc[a].name);for(var r=[],a=0;a<he.length;a++){var n=he[a],i=n.G;20==i.type?r.push(n):60!=n.G.type||"MESH"!=e.type&&"WORLD"!=e.type?10==i.type&&"ARMATURE"==e.type?r.push(n):40==i.type&&"SPEAKER"==e.type?r.push(n):80==i.type&&"WORLD"==e.type&&r.push(n):r.push(n)}for(a=0;a<r.length;a++)t.push(o(r[a].name));if(H.Yz(e)&&H.gG(e))for(e=e.K,a=0;a<e.length;a++)for(r=e[a].U,n=0;n<r.length;n++)(i=r[n].Ba)&&t.push(i.name);return t},e.GH=o,e.get_anim_type=function(e,t){var a=e.ia[t];return a?a.type:0},e.apply_def=function(e){for(var t=0,a=e.K,o=0;o<a.length;o++)for(var i=a[o].U,_=0;_<i.length;_++){var c=i[_].Ba;c&&"EMITTER"==c.Fv&&!i[_].wg&&(M(e,t),n(e.ia[t],c),C(e,t),c.cyclic?e.ia[t].behavior=10:e.ia[t].behavior=e.rl,t++)}for(a=e.Kl.slice(),o=0;o<a.length;o++)_=a[o],i=_.io,_=_.action,M(e,t),u(e,i,_,t)?(C(e,t),e.ia[t].behavior=e.rl,t++):e.ia[t]=null;s(e)&&(M(e,t),r(e,e.Rc[0],t),C(e,t),e.ia[t].behavior=e.rl)},e.Ix=function(e){switch(e){case"CYCLIC":return 10;case"FINISH_RESET":return 20;case"FINISH_STOP":return 30;default:$.F("Wrong animation behavior")}},e.tP=function(e){var t=[];e=e.data.materials;for(var a=0;a<e.length;a++){var r=e[a],n=r.node_tree;n&&_(n,t,[r.name])}return t},e.uP=function(e){var t=[],a=e.node_tree;return a&&_(a,t,[e.name]),t},e.dF=i,e.play=function(e,t,a){l(e.ia,a,function(e){e.play=!0,e.cu=t||null,e.Cq=!1}),e.o.Fi&&m(e)},e.stop=function(e,t){l(e.ia,t,function(e){e.play=!1,e.cu=null,e.Cq=!1})},e.is_play=function(e,t){var a=e.ia;if(-1==t){for(var r=0;8>r;r++)if(a[r]&&a[r].play)return!0}else if(a=a[t])return a.play;return!1},e.set_frame=c,e.set_first_frame=function(e,t){t=t||0,l(e.ia,t,function(a){c(e,a.start,t)})},e.Py=function(e,t){var a=e.ia[t];return a&&a.Kf?a.Kf:0},e.is_cyclic=function(e,t){var a=e.ia[t];return a&&10==a.behavior},e.set_behavior=function(e,t,a){l(e.ia,a,function(e){e.behavior=t})},e.get_behavior=function(e,t){var a=e.ia[t];return a&&a.behavior},e.apply_smoothing=function(e,t,a,r){l(e.ia,r,function(e){e.oB=t||0,e.pA=a||0})},e.remove_slot_animation=function(e,t){if(-1==t)for(var a=0;8>a;a++)e.ia[a]=null;else e.ia[t]=null;e.o.Fi&&g(e,t)},e.NU=f,e.iG=function(e){if("ARMATURE"==e.type||e.Ss||"WORLD"==e.type)return!0;for(var t=0;t<e.Kl.length;t++){var a=e.Kl[t].action.G.type;if(20==a||10==a||40==a&&"SPEAKER"==e.type||70==a&&"LAMP"==e.type||60==a&&"MESH"==e.type)return!0}return!!(H.Yz(e)&&H.gG(e)||"MESH"==e.type&&e.Rc.length)},e.UC=function(e){if(P(e))return!0;if(e.dn)for(var t=0;t<e.dn.length;t++){var a=e.dn[t].action.G.type;if(20==a||60==a&&"MESH"==e.type)return!0}return!!(H.XL(e)&&H.WL(e)||"MESH"==e.type&&e.data.b4w_vertex_anim.length)},e.is_animated=function(e){return!!e.ia.length},e.iO=function(e,t){for(var a=e.en,r=[],n=0;n<a.length;n+=3)(60!=a[n].G.type||null!==a[n+1]&&a[n+1].split("%join%")[0]!=t)&&r.push(a[n],a[n+1],a[n+2]);e.en=r},e.fM=y,e.IO=S,e.gL=function(e){function t(e,t){for(var a=0;a<t;a++){var r=e.subarray(8*a+4,8*a+8);z.normalize(r,r)}}var a=new RegExp(/pose.bones\[\".+\"\]/g),r=Z.create(),n=e.G={type:0,Xz:0,pG:0,Y:null,Tx:null,OC:null,Ni:new Int8Array(8)};n.pG=1/te.Rl;var o,i=e.fcurves,_={},s={},c=0;for(o in i){var l,f=i[o];for(l in f){var u=f[l],d=u.Ef;W.nM(u,e),u=u.num_channels,c||(c=d.length);for(var u=function(e,t,n,o,i){if(-1<n.search(a)){e=t,n=n.split('"')[1];var _=r}else 8==i?(n="tsr",_=r):_=1<i?new Float32Array(i):0;if(!e[n]){if(i=e,t=n,"object"==typeof _&&_.length)for(var s=_.length,c=new Float32Array(o*s),l=0;l<o;l++)for(var f=0;f<s;f++)c[l*s+f]=_[f];else if("number"==typeof _)for(c=new Float32Array(o),l=0;l<o;l++)c[l]=_;else $.F("Wrong storage default value");i[t]=c}return e[n]}(_,s,o,c,u),p=u.length/c,m=function(e,t){if(-1<e.indexOf("location"))var a=0,r=t;else-1<e.indexOf("rotation_quaternion")?(a=4,r=0==t?3:t-1):-1<e.indexOf("scale")?(a=3,r=0):(a=0,r=t);return a+r}(o,0|l),g=0;g<c;g++)u[g*p+m]=d[g]}}if($.$i(_)){for(var h in _)"tsr"==h&&t(_[h],c);n.Y=_}if($.$i(s)){for(var v in s)t(s[v],c);n.Tx=s}n.Xz=c,n.OC=e.YK,"tsr"in _&&w(i,n.Ni),("color"in _||"energy"in _)&&R(i,n.Ni),("light_settings.environment_energy"in _||"horizon_color"in _||"zenith_color"in _||"mist_settings.intensity"in _||"mist_settings.depth"in _||"mist_settings.start"in _||"mist_settings.height"in _||"b4w_fog_color"in _)&&L(i,n.Ni),O(e),he.push(e)},e.sP=function(e,t){return(t-e)*te.Rl+1},e.AL=function(e,t,a,r,n,o){var i=new Float32Array(2),_=new Float32Array(2),s=new Float32Array(2),c=new Float32Array(2),l=t[1],f=t[2],u=t[e.last_frame_offset+1];e=t[e.last_frame_offset+2];for(var d=0,p=0,m=null;n<=o;n++)if(n<l)for(var g=0;g<te.Rl;g++)a[d++]=f;else if(n>u)for(g=0;g<te.Rl;g++)a[d++]=e;else{var h=t[p],v=3;0===h&&(v+=2),0===m&&(v+=2);var b=2===h?0:1;if(t[p+1]==t[p+v+1])m=h,p+=v;else{if(g=0,n==t[p+1]&&(b&&(r[d]=1),a[d]=t[p+2],d++,g++),n==u)for(;g<te.Rl;g++)a[d++]=e;else for(i[0]=t[p+1],i[1]=t[p+2],0!==h?(_[0]=0,_[1]=0):0===m?(_[0]=t[p+5],_[1]=t[p+6]):(_[0]=t[p+3],_[1]=t[p+4]),0!==h?(s[0]=0,s[1]=0):(s[0]=t[p+v+3],s[1]=t[p+v+4]),c[0]=t[p+v+1],c[1]=t[p+v+2];g<te.Rl;g++){var E=n+g/te.Rl;switch(h){case 0:var A,x,T,y=i,S=_,O=s,w=c,R=[],L=[];R[0]=y[0]-S[0],R[1]=y[1]-S[1],L[0]=w[0]-O[0],L[1]=w[1]-O[1],A=w[0]-y[0],T=Math.abs(R[0]),x=Math.abs(L[0]),T+x&&T+x>A&&(A/=T+x,S[0]=y[0]-A*R[0],S[1]=y[1]-A*R[1],O[0]=w[0]-A*L[0],O[1]=w[1]-A*L[1]),b&&(r[d]=1),a[d]=I(N(0,1,E,i[0],_[0],s[0],c[0]),i[1],_[1],s[1],c[1]),d++;break;case 1:b&&(r[d]=1),y=i[0],S=i[1],O=(c[1]-S)/(c[0]-y),a[d]=O*E+(S-O*y),d++;break;case 2:b&&(r[d]=1),a[d]=t[p+2],d++;break;default:$.F("Unknown keyframe interpolation mode: "+h)}}n+1==t[p+v+1]&&(m=h,p+=v)}}},e.apply=D,e.xL=function(e,t,a,r){r=r||0;var n=$.keysearch("uuid",a,he);if(n){if(M(e,r),u(e,t,n,r))return void C(e,r);e.ia[r]=null}q.error('Unsupported object: "'+e.name+'" or animation uuid: "'+a+'"')},e.yI=function(e,t){var a=$.keysearch("name",t,he)||$.keysearch("name",t+"_B4W_BAKED",he);if(a){if(0==a.G.type)return!1}else if(!(k(e,t)||B.is_mesh(e)&&U(e,t)))return!1;return!0},e.get_slot_num_by_anim=function(e,t){for(var a=e.ia,r=0;r<a.length;r++){var n=a[r];if(n&&o(n.Gi)==o(t))return r}return-1},e.rP=function(e,t){var a=e.ia[t];return a&&a.Gi?o(a.Gi):null},e.remove=function(e){e.ia.length=0,-1!=(e=ge.indexOf(e))&&ge.splice(e,1)},e.rS=function(e){for(var t=he.length-1;0<=t;t--)he[t].ZK==e&&he.splice(t,1)},e.apply_to_first_empty_slot=function(e,t){if(!e.ia.length)return D(e,null,t,0)?0:-1;for(var a=0;a<e.ia.length;a++)if(!e.ia[a])return D(e,null,t,a)?a:-1},e.set_skel_mix_factor=function(e,t,a,r){e=e.o,e.gn=(t-e.Ue)/a,e.fn=t,e.Ei&&e.Ei(),e.Ei=r},e.mix_from_cur_pos=function(e,t,a,r){e=e.o,e.Mh[1]=t,e.gn=1/a,e.fn=1,e.Ei&&e.Ei(),e.Ei=r,e.Vk=null,e.Gk=null,e.nh=!0},e.set_speed=function(e,t,a){l(e.ia,a,function(e){e.speed=t})},e.get_speed=function(e,t){return e.ia[t].speed},e.get_anim_start_frame=function(e,t){return e.ia[t].start},e.get_anim_length=function(e,t){return e.ia[t].length},e.cleanup=function(){ge.length=0,he.length=0},e.LO=function(e){var t=(e[0]||e[1]||e[2]).Ef.length,a=le,r=ne,n=!!e[0];n||(e[0]={Ef:new Float32Array(t),num_channels:8});var o=!!e[1];o||(e[1]={Ef:new Float32Array(t),num_channels:8});var i=!!e[2];i||(e[2]={Ef:new Float32Array(t),num_channels:8}),e[3]={Ef:new Float32Array(t),num_channels:8};for(var _=0;_<t;_++)r[0]=n?e[0].Ef[_]:0,r[1]=o?e[1].Ef[_]:0,r[2]=i?e[2].Ef[_]:0,$.euler_to_quat(r,a),e[0].Ef[_]=a[3],e[1].Ef[_]=a[0],e[2].Ef[_]=a[1],e[3].Ef[_]=a[2]},e.BE=P,e.LT=function(e,t){for(var a=7,r=0,n=0;n<he.length;n++){var o=he[n];if(o.name==t){r=o.G.type;break}}for(0==r&&(U(e,t)?r=30:(n=k(e,t))&&"EMITTER"==n.Fv&&(r=50)),n=0;8>n;n++)if(o=e.ia[n]){if(o.type==r)return n}else n<a&&(a=n);return a}},a.module.__time=function(e,t){function a(){return-1!==r.sl.hu?r.sl.hu:l}var r=t("__config"),n=0,o=0,i=[],_=0,s=0,c=[],l=-1,f=0;e.gH=function(e){for(n=e,o=performance.now(),e=0;e<i.length;e++){var t=i[e];n>t.Ey&&(i.splice(e,1),e--,t.callback())}for(e=0;e<c.length;e++){var t=c[e],a=1-(t.Ey-n)/t.duration,a=Math.min(a,1);t.callback(t.from+a*(t.to-t.from)),1==a&&(c.splice(e,1),e--)}},e.get_timeline=function(){return n},e.fT=function(e){f=e},e.CP=function(){return f},e.set_timeout=function(e,t){var a;return _++,a=_,i.push({id:a,callback:e,Ey:n+(performance.now()-o+t)/1e3}),a},e.clear_timeout=function(e){for(var t=0;t<i.length;t++)if(i[t].id==e){i.splice(t,1);break}},e.clear_animation=function(e){for(var t=c.length;t--;)if(c[t].id==e){c.splice(t,1);break}},e.animate=function(e,t,a,r){a/=1e3;var o;return s++,o=s,c.push({id:o,callback:r,from:e,to:t,Ey:n+a,duration:a}),r(e),o},e.reset=function(){o=n=0,i.length=0,s=_=c.length=0},e.pd=a,e.iT=function(e){l=e},e.get_frame=function(e){return e*a()}},a.module.__transform=function(e,t){function a(e,t){u.zg(e)?v.set_trans(t,u.xg(e)):v.set_trans(t,e.o.v)}function r(e,t){var a=e.o;if(u.zg(e)){v.set_quat(t,a.v);var r=u.mu(e),r=v.invert(r,y);v.multiply(r,a.v,u.xg(e))}else v.set_quat(t,a.v)}function n(e,t){u.zg(e)?v.set_quat(t,u.xg(e)):v.set_quat(t,e.o.v)}function o(e,t){return v.mb(e.o.v,t),t}function i(e,t){return u.zg(e)?v.mb(u.xg(e),t):v.mb(e.o.v,t),t}function _(e,t){u.zg(e)?v.copy(t,u.xg(e)):v.copy(t,e.o.v)}function s(e,t){return u.zg(e)?v.copy(u.xg(e),t):v.copy(e.o.v,t),t}function c(e){var t=e.o,a=e.K,r=e.type;"CAMERA"==r&&f.cI(e),u.EU(e,O),"CAMERA"==r&&f.CU(e),l.nn(t.la,t.v,t.og),l.et(t.hc,t.v,t.Pd);for(var n=0;n<a.length;n++)for(var o=a[n].U,i=0;i<o.length;i++)m.mI(o[i],t.v,a[n].If[i]);switch(r){case"MESH":e.YF&&v.invert(e.o.v,e.o.jx),(o=e.Ss)&&(v.invert(o.o.v,y),v.multiply(y,t.v,y),v.Oq(y,t.Dp),v.mb(y,t.Cp)),t.Gq=!0;break;case"CAMERA":for(n=0;n<a.length;n++)f.DU(e,a[n]);break;case"SPEAKER":h.TT(e,O,w);break;case"LAMP":d.IU(e)}for(var o=v.Cb(t.v,A),_=v.mb(t.v,T),n=0;n<a.length;n++)if(i=a[n],i.Ru){var s=i.eb,E=s.G;switch(r){case"MESH":t.Je&&g.EA(s),E=i.Ri,null!=t.Qd&&E&&g.dI(E,o);break;case"EMPTY":p.GU(e);break;case"CAMERA":if(g.get_active()==s&&g.gk(s)==e){if(g.TS(s),E.Pc){(E.Pc.enable_csm||E.Pc.tO)&&g.EA(s);var x=m.ya(e,s).ba[0];g.XU(x,E.va)}h.gR(s,o,_,O,w)}break;case"LAMP":g.es(e,s)}if(E=i.li,x=e.Cr,x.length)for(i=0;i<E.length;i++){var S=E[i].B;g.fI(E[i],o,_),m.gI(x,S.nc),f.CT(S,g.gk(s)),b.Ol(S.gd,S.ih)}}for(t=e.Ze,n=0;n<t.length;n++)c(t[n]);for(e=e.ky,n=0;n<e.length;n++)t=e[n],o=t[0],u.zU(o,t[1])}var l=t("__boundings"),f=t("__camera"),u=t("__constraints"),d=t("__lights"),p=t("__objects"),m=t("__obj_util"),g=t("__scenes"),h=t("__sfx"),v=t("__tsr"),b=t("__util"),E=t("__vec3"),A=new Float32Array(3),x=new Float32Array(3),T=new Float32Array(4),y=v.create(),S=v.create(),O=0,w=0;e.update=function(e){O=e,w++},e.set_translation=function(e,t){var a=e.o;if(u.zg(e)){v.set_trans(t,a.v);var r=u.mu(e),r=v.invert(r,y);v.multiply(r,a.v,u.xg(e))}else v.set_trans(t,a.v)},e.set_translation_rel=a,e.get_translation=function(e,t){return v.Cb(e.o.v,t),t},e.get_translation_rel=function(e,t){return u.zg(e)?v.Cb(u.xg(e),t):v.Cb(e.o.v,t),t},e.set_rotation=r,e.set_rotation_rel=n,e.get_rotation=o,e.get_rotation_rel=i,e.set_rotation_euler=function(e,t){r(e,b.euler_to_quat(t,T))},e.set_rotation_euler_rel=function(e,t){n(e,b.euler_to_quat(t,T))},e.get_rotation_euler=function(e,t){var a=o(e,T);return t=b.quat_to_euler(a,t)},e.get_rotation_euler_rel=function(e,t){var a=i(e,T);return t=b.quat_to_euler(a,t)},e.set_scale=function(e,t){var a=e.o;if(u.zg(e)){var a=u.xg(e),r=v.get_scale(u.mu(e));v.set_scale(t/r,a)}else v.set_scale(t,a.v)},e.set_scale_rel=function(e,t){var a=e.o;u.zg(e)?v.set_scale(t,u.xg(e)):v.set_scale(t,a.v)},e.get_scale=function(e){return v.get_scale(e.o.v)},e.get_scale_rel=function(e){return u.zg(e)?v.get_scale(u.xg(e)):v.get_scale(e.o.v)},e.set_tsr=function(e,t){if(v.copy(t,e.o.v),u.zg(e)){var a=u.mu(e),a=v.invert(a,y);v.multiply(a,e.o.v,u.xg(e))}},e.set_tsr_rel=_,e.get_tsr=function(e,t){return v.copy(e.o.v,t)},e.get_tsr_rel=s,e.get_object_size=function(e){var t=e.o;e=t.Ii;var a=v.get_scale(t.v),t=a*(e.max_x-e.min_x),r=a*(e.max_y-e.min_y);return e=a*(e.max_z-e.min_z),.5*Math.sqrt(t*t+r*r+e*e)},e.get_object_center=function(e,t,a){return t?(e=e.o,E.copy(e.Pd.N,a)):(e=e.o,t=e.Ii,a[0]=(t.max_x+t.min_x)/2,a[1]=(t.max_y+t.min_y)/2,a[2]=(t.max_z+t.min_z)/2,v.transform_vec3(a,e.v,a)),a},e.move_local=function(e,t,r,n){var o=s(e,y),i=A;i[0]=t,i[1]=r,i[2]=n,v.transform_vec3(i,o,i),a(e,i)},e.zA=function(e,t){var a=s(e,y),r=v.set_quat(t,v.identity(S));v.multiply(a,r,r),_(e,r)},e.O=c,e.distance=function(e,t){var a=v.Cb(e.o.v,A),r=v.Cb(t.o.v,x);return E.dist(a,r)},e.ir=function(e,t){var a=v.Cb(e.o.v,A);return E.dist(a,t)}},a.module.__tsr=function(e,t){function a(){var e=new Float32Array(8);return e[3]=1,e[7]=1,e}function r(){var e=new Float32Array(9);return e[3]=1,e[7]=1,e}function n(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function o(e,t,a,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t,r[4]=a[0],r[5]=a[1],r[6]=a[2],r[7]=a[3],r}function i(e,t){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}function _(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],_=t[4],s=t[5],c=t[6];t=t[7];var l=e[0]*i,f=e[1]*i,u=e[2]*i;e=t*l+s*u-c*f;var i=t*f+c*l-_*u,d=t*u+_*f-s*l,l=-_*l-s*f-c*u;return a[0]=e*t+l*-_+i*-c-d*-s,a[1]=i*t+l*-s+d*-_-e*-c,a[2]=d*t+l*-c+e*-s-i*-_,a[0]+=r,a[1]+=n,a[2]+=o,a}var s=t("__mat4"),c=t("__quat"),l=t("__util"),f=t("__vec3"),u=Math.sin(-Math.PI/4),d=-u,p=new Float32Array(3),m=new Float32Array(4),g=new Float32Array(16);e.create=a,e.clone=function(e){var t=a();return n(e,t),t},e.from_values=function(e,t,r,n,o,i,_,s){var c=a();return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=o,c[5]=i,c[6]=_,c[7]=s,c},e.Gl=r,e.WW=function(e){var t=r();return n(e,t),t},e.rX=function(e,t,a,n,o,i,_,s){var c=r();return c[0]=e,c[1]=t,c[2]=a,c[3]=n,c[4]=o,c[5]=i,c[6]=_,c[7]=s,c},e.copy=n,e.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=1,e},e.set_sep=o,e.set_trans=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set_scale=function(e,t){return t[3]=e,t},e.set_transcale=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set_quat=function(e,t){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.get_trans_view=function(e){return e.subarray(0,3)},e.Cb=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.get_scale=function(e){return e[3]},e.Oq=function(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]},e.get_quat_view=function(e){return e.subarray(4,8)},e.mb=i,e.invert=function(e,t){var a=1/e[3];if(!a)return null;var r=e[0],n=e[1],o=e[2];m[0]=e[4],m[1]=e[5],m[2]=e[6],m[3]=e[7],c.invert(m,m);var i=m[0],_=m[1],s=m[2],l=m[3],r=r*a,n=n*a,f=o*a,o=l*r+_*f-s*n,u=l*n+s*r-i*f,d=l*f+i*n-_*r,r=-i*r-_*n-s*f;return t[0]=-(o*l+r*-i+u*-s-d*-_),t[1]=-(u*l+r*-_+d*-i-o*-s),t[2]=-(d*l+r*-s+o*-_-u*-i),t[3]=a,t[4]=i,t[5]=_,t[6]=s,t[7]=l,t},e.to_mat4=function(e,t){var a=e[3];s.fromRotationTranslation(e.subarray(4,8),e.subarray(0,3),t);for(var r=0;12>r;r++)t[r]*=a;return t},e.from_mat4=function(e,t){return o(l.Dz(e,p),l.PF(e),l.matrix_to_quat(e,m),t),t},e.multiply=function(e,t,a){_(t,e,a),a[3]=e[3]*t[3];var r=e[4],n=e[5],o=e[6];e=e[7];var i=t[4],s=t[5],c=t[6];return t=t[7],a[4]=r*t+e*i+n*c-o*s,a[5]=n*t+e*s+o*i-r*c,a[6]=o*t+e*c+r*s-n*i,a[7]=e*t-r*i-n*s-o*c,a},e.oU=function(e,t,a){var r=t[3];t=s.fromRotationTranslation(t.subarray(4,8),t.subarray(0,3),g);for(var n=0;12>n;n++)t[n]*=r;return s.multiply(t,e,a),a},e.transform_vec3=_,e.transform_vec3_inv=function(e,t,a){var r=t[3],n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2];e=t[4];var _=t[5],s=t[6];t=t[7];var c=e*e+_*_+s*s+t*t,c=c?1/c:0;e=-e*c,_=-_*c,s=-s*c,t*=c;var c=t*n+_*i-s*o,l=t*o+s*n-e*i,f=t*i+e*o-_*n,n=-e*n-_*o-s*i;return a[0]=c*t+n*-e+l*-s-f*-_,a[1]=l*t+n*-_+f*-e-c*-s,a[2]=f*t+n*-s+c*-_-l*-e,a[0]/=r,a[1]/=r,a[2]/=r,a},e.transform_vectors=function(e,t,a,r){r||(r=0);var n=e.length,o=t[0],i=t[1],_=t[2],s=t[3],c=t[4],l=t[5],f=t[6];t=t[7];for(var u=0;u<n;u+=3){var d=e[u]*s,p=e[u+1]*s,m=e[u+2]*s,g=t*d+l*m-f*p,h=t*p+f*d-c*m,v=t*m+c*p-l*d,d=-c*d-l*p-f*m;a[r+u]=g*t+d*-c+h*-f-v*-l,a[r+u+1]=h*t+d*-l+v*-c-g*-f,a[r+u+2]=v*t+d*-f+g*-l-h*-c,a[r+u]+=o,a[r+u+1]+=i,a[r+u+2]+=_}return a},e.transform_dir_vectors=function(e,t,a,r){r||(r=0);var n=e.length,o=t[3],i=t[4],_=t[5],s=t[6];t=t[7];for(var c=0;c<n;c+=3){var l=e[c]*o,f=e[c+1]*o,u=e[c+2]*o,d=t*l+_*u-s*f,p=t*f+s*l-i*u,m=t*u+i*f-_*l,l=-i*l-_*f-s*u;a[r+c]=d*t+l*-i+p*-s-m*-_,a[r+c+1]=p*t+l*-_+m*-i-d*-s,a[r+c+2]=m*t+l*-s+d*-_-p*-i}return a},e.transform_dir_vec3=function(e,t,a){var r=t[3],n=t[4],o=t[5],i=t[6];t=t[7];var _=e[0]*r,s=e[1]*r,c=e[2]*r;e=t*_+o*c-i*s;var r=t*s+i*_-n*c,l=t*c+n*s-o*_,_=-n*_-o*s-i*c;return a[0]=e*t+_*-n+r*-i-l*-o,a[1]=r*t+_*-o+l*-n-e*-i,a[2]=l*t+_*-i+e*-o-r*-n,a},e.transform_tangents=function(e,t,a,r){r||(r=0);var n=e.length,o=t[3],i=t[4],_=t[5],s=t[6];t=t[7];for(var c=0;c<n;c+=4){var l=e[c]*o,f=e[c+1]*o,u=e[c+2]*o,d=t*l+_*u-s*f,p=t*f+s*l-i*u,m=t*u+i*f-_*l,l=-i*l-_*f-s*u;a[r+c]=d*t+l*-i+p*-s-m*-_,a[r+c+1]=p*t+l*-_+m*-i-d*-s,a[r+c+2]=m*t+l*-s+d*-_-p*-i,a[r+c+3]=e[c+3]}return a},e.VH=function(e,t,a){t=i(t,m),c.multiply(t,e,a)},e.pU=function(e,t,a,r){r=r||0,t=i(t,m),l.nS(e,t,a,r)},e.translate=function(e,t,a){var r=e[3],n=e[4],o=e[5],i=e[6],_=e[7],s=t[0]*r,c=t[1]*r,l=t[2]*r;t=_*s+o*l-i*c;var r=_*c+i*s-n*l,f=_*l+n*c-o*s,s=-n*s-o*c-i*l;return a[0]=e[0]+t*_+s*-n+r*-i-f*-o,a[1]=e[1]+r*_+s*-o+f*-n-t*-i,a[2]=e[2]+f*_+s*-i+t*-o-r*-n,a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a},e.interpolate=function(e,t,a,r){f.lerp(e.subarray(0,3),t.subarray(0,3),a,r.subarray(0,3));var n=e[3];return r[3]=n+a*(t[3]-n),c.slerp(e.subarray(4,8),t.subarray(4,8),a,r.subarray(4,8)),r},e.jX=function(e,t,a,r){var n=e.subarray(0,3),o=t.subarray(0,3),i=r.subarray(0,3);return i[0]=o[0]*(a+1)-n[0]*a,i[1]=o[1]*(a+1)-n[1]*a,i[2]=o[2]*(a+1)-n[2]*a,r[3]=t[3]*(a+1)-e[3]*a,e=e.subarray(4,8),t=t.subarray(4,8),n=r.subarray(4,8),n[0]=t[0]*(a+1)-e[0]*a,n[1]=t[1]*(a+1)-e[1]*a,n[2]=t[2]*(a+1)-e[2]*a,n[3]=t[3]*(a+1)-e[3]*a,c.normalize(n,n),r},e.AQ=function(e,t,a,r,n){n[0]=e[0]+t*a[0],n[1]=e[1]+t*a[1],n[2]=e[2]+t*a[2],n[3]=e[3],a=r[0];var o=r[1];r=r[2];var i=e[4],_=e[5],s=e[6],c=e[7];n[4]=.5*(a*c+o*s-r*_),n[5]=.5*(o*c+r*i-a*s),n[6]=.5*(r*c+a*_-o*i),n[7]=.5*(-a*i-o*_-r*s),n[4]=e[4]+n[4]*t,n[5]=e[5]+n[5]*t,n[6]=e[6]+n[6]*t,n[7]=e[7]+n[7]*t,e=n[4],t=n[5],a=n[6],o=n[7],0<(e=e*e+t*t+a*a+o*o)&&(e=1/Math.sqrt(e),n[4]*=e,n[5]*=e,n[6]*=e,n[7]*=e)},e.MY=function(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3];var a=e[4],r=e[5],n=e[6],o=e[7];t[4]=a*d+o*u,t[5]=r*d+n*u,t[6]=n*d-r*u,t[7]=o*d-a*u},e.LY=function(e,t){t[0]=e[0],t[1]=-e[2],t[2]=e[1],t[3]=e[3],t[4]=e[4],t[5]=-e[6],t[6]=e[5],t[7]=e[7]}},a.module.__util=function(e,t){function a(e){return 0<e?1:0>e?-1:0}function r(e,t,a){var r=e[0],n=e[1];e=e[2];var o=Math.cos(r/2),i=Math.cos(n/2),_=Math.cos(e/2),s=Math.sin(r/2),n=Math.sin(n/2),c=Math.sin(e/2);if(-1<_e.indexOf(t))var l=Math.cos((r+e)/2),f=Math.sin((r+e)/2),u=Math.cos((r-e)/2),d=Math.sin((r-e)/2),p=Math.cos((e-r)/2),m=Math.sin((e-r)/2);switch(t){case 0:a[0]=i*f,a[1]=n*u,a[2]=n*d,a[3]=i*l;break;case 1:a[0]=n*d,a[1]=i*f,a[2]=n*u,a[3]=i*l;break;case 2:a[0]=n*u,a[1]=n*d,a[2]=i*f,a[3]=i*l;break;case 3:a[0]=i*f,a[1]=n*m,a[2]=n*p,a[3]=i*l;break;case 4:a[0]=n*p,a[1]=i*f,a[2]=n*m,a[3]=i*l;break;case 5:a[0]=n*m,a[1]=n*p,a[2]=i*f,a[3]=i*l;break;case 6:a[0]=s*i*_+o*n*c,a[1]=o*n*_-s*i*c,a[2]=o*i*c+s*n*_,a[3]=o*i*_-s*n*c;break;case 7:a[0]=o*i*c+s*n*_,a[1]=s*i*_+o*n*c,a[2]=o*n*_-s*i*c,a[3]=o*i*_-s*n*c;break;case 8:a[0]=o*n*_-s*i*c,a[1]=o*i*c+s*n*_,a[2]=s*i*_+o*n*c,a[3]=o*i*_-s*n*c;break;case 9:a[0]=s*i*_-o*n*c,a[1]=o*i*c-s*n*_,a[2]=o*n*_+s*i*c,a[3]=o*i*_+s*n*c;break;case 10:a[0]=o*n*_+s*i*c,a[1]=s*i*_-o*n*c,a[2]=o*i*c-s*n*_,a[3]=o*i*_+s*n*c;break;case 11:a[0]=o*i*c-s*n*_,a[1]=o*n*_+s*i*c,a[2]=s*i*_-o*n*c,a[3]=o*i*_+s*n*c}return a}function n(e,t,a){var r=e[0],n=e[1],o=e[2];switch(e=e[3],t){case 0:a[0]=Math.atan2(r*n+o*e,n*e-r*o),a[1]=Math.acos(1-2*(n*n+o*o)),a[2]=Math.atan2(r*n-o*e,r*o+n*e);break;case 1:a[0]=Math.atan2(r*e+n*o,o*e-r*n),a[1]=Math.acos(1-2*(r*r+o*o)),a[2]=Math.atan2(n*o-r*e,r*n+o*e);break;case 2:a[0]=Math.atan2(r*o+n*e,r*e-n*o),a[1]=Math.acos(1-2*(r*r+n*n)),a[2]=Math.atan2(r*o-n*e,r*e+n*o);break;case 3:a[0]=Math.atan2(r*o-n*e,r*n+o*e),a[1]=Math.acos(1-2*(n*n+o*o)),a[2]=Math.atan2(r*o+n*e,o*e-r*n);break;case 4:a[0]=Math.atan2(r*n-o*e,r*e+n*o),a[1]=Math.acos(1-2*(r*r+o*o)),a[2]=Math.atan2(r*n+o*e,r*e-n*o);break;case 5:a[0]=Math.atan2(n*o-r*e,r*o+n*e),a[1]=Math.acos(1-2*(r*r+n*n)),a[2]=Math.atan2(r*e+n*o,n*e-r*o);break;case 6:a[0]=Math.atan2(2*(r*e-n*o),1-2*(r*r+n*n)),a[1]=Math.asin(2*(r*o+n*e)),a[2]=Math.atan2(2*(o*e-r*n),1-2*(n*n+o*o));break;case 7:t=r*n+o*e,.499999<t?(a[0]=0,a[1]=Math.PI/2,a[2]=2*Math.atan2(r,e)):-.499999>t?(a[0]=0,a[1]=-Math.PI/2,a[2]=-2*Math.atan2(r,e)):(a[0]=Math.atan2(2*(n*e-r*o),1-2*(n*n+o*o)),a[1]=Math.asin(2*(r*n+o*e)),a[2]=Math.atan2(2*(r*e-n*o),1-2*(r*r+o*o)));break;case 8:a[0]=Math.atan2(2*(o*e-r*n),1-2*(r*r+o*o)),a[1]=Math.asin(2*(r*e+n*o)),a[2]=Math.atan2(2*(n*e-r*o),1-2*(r*r+n*n));break;case 9:a[0]=Math.atan2(2*(r*e+n*o),1-2*(r*r+o*o)),a[1]=Math.asin(2*(o*e-r*n)),a[2]=Math.atan2(2*(r*o+n*e),1-2*(n*n+o*o));break;case 10:a[0]=Math.atan2(2*(r*o+n*e),1-2*(r*r+n*n)),a[1]=Math.asin(2*(r*e-n*o)),a[2]=Math.atan2(2*(r*n+o*e),1-2*(r*r+o*o));break;case 11:t=n*e-r*o,.499999<t?(a[0]=0,a[1]=Math.PI/2,a[2]=-2*Math.atan2(o,e)):-.499999>t?(a[0]=0,a[1]=-Math.PI/2,a[2]=2*Math.atan2(o,e)):(a[0]=Math.atan2(2*(r*n+o*e),1-2*(n*n+o*o)),a[1]=Math.asin(2*(n*e-r*o)),a[2]=Math.atan2(2*(r*e+n*o),1-2*(r*r+n*n)))}return a}function o(e,t,a){return a||(a=new Float32Array(3)),I.transformQuat(t,e,a),a}function i(e,t){t||(t=new Float32Array(4)),y.fromMat4(e,z);var a=z[0],r=z[3],n=z[6],o=z[1],i=z[4],_=z[7],s=z[2],c=z[5],l=z[8],a=Math.sqrt(a*a+r*r+n*n)||1,o=Math.sqrt(o*o+i*i+_*_)||1,s=Math.sqrt(s*s+c*c+l*l)||1;return z[0]/=a,z[3]/=a,z[6]/=a,z[1]/=o,z[4]/=o,z[7]/=o,z[2]/=s,z[5]/=s,z[8]/=s,N.fromMat3(z,t),N.normalize(t,t),t}function _(e){var t=e[0],a=e[1],r=e[2],n=e[3],o=Math.sqrt(t*t+a*a+r*r),o=1/o;e[0]=t*o,e[1]=a*o,e[2]=r*o,e[3]=n*o}function s(e,t){var a=t;switch(typeof e){case"object":if(e)switch(e.constructor){case Object:for(var r in e)a=s(e[r],a);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(r=0;r<e.length;r++)a=c(e[r],a);break;case Array:for(r=0;r<e.length;r++)a=s(e[r],a);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:a=c(0,a);break;default:h("Wrong object constructor:",e.constructor)}else a=c(0,a);return a;case"number":return c(e,a);case"boolean":return c(0|e,a);case"string":return l(e,a);case"function":case"undefined":return c(0,a)}}function c(e,t){var a=t;return K[0]=e,a=(a<<5)-a+Q[0],a&=a,(a=(a<<5)-a+Q[1])&a}function l(e,t){for(var a=t,r=0;r<e.length;r++)a=(a<<5)-a+e.charCodeAt(r),a&=a;return a}function f(e){return(34*e+1)*e%289}function u(e){return e-Math.floor(e)}function d(e){return p((34*e+5)*e)}function p(e){return e-289*Math.floor(e/289)}function m(e){return e-7*Math.floor(e/7)}function g(e,t,a){return e<t&&(e=t),e>a&&(e=a),e}function h(e){throw e&&w.error.apply(w,arguments),"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/"}function v(e,t,a){return e-=t,a-=t,t+(e-Math.floor(e/a)*a)}function b(e){return v(e,0,2*Math.PI)}function E(e,t){if(e&&t){var a=e instanceof Array;if(a!=t instanceof Array)return!1;var r=e.buffer instanceof ArrayBuffer&&"undefined"!==e.byteLength;if(r!=(t.buffer instanceof ArrayBuffer&&"undefined"!==t.byteLength))return!1;if(a){if(e.length!=t.length)return!1;for(a=0;a<e.length;a++)if(!A(e[a],t[a]))return!1}else if(r){if(e.length!=t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!=t[a])return!1}else{switch(e.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return e==t}for(var n in e)if(!A(e[n],t[n]))return!1;for(n in t)if(!(n in e))return!1}return!0}return!(e||t)}function A(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"number":case"string":case"boolean":return e==t;case"object":return E(e,t);default:return!0}}function x(e,t,a){var r=U,n=I.dot(e,t);return-.9999999>n?(I.cross(te,e,r),1e-6>I.length(r)&&I.cross(ae,e,r),I.normalize(r,r),N.setAxisAngle(r,Math.PI,a)):(I.cross(e,t,r),a.set(r),a[3]=1+n,N.normalize(a,a)),a}function T(e){if(""==e)return".";var t=0==e.indexOf("/")|0;t&&0==e.indexOf("//")&&0!=e.indexOf("///")&&(t=2),e=e.split("/");for(var a=[],r=0;r<e.length;r++){var n=e[r];""!=n&&"."!=n&&(".."!=n||!t&&!a.length||a.length&&".."==a[a.length-1]?a.push(n):a.length&&a.pop())}for(e=a.join("/"),r=0;r<t;r++)e="/"+e;return e||"."}var y=t("__mat3"),S=t("__mat4"),O=t("__math"),w=t("__print"),R=t("__tbn"),L=t("__tsr"),N=t("__quat"),I=t("__vec3"),M=t("__vec4"),C=0,D={},U=new Float32Array(3),k=new Float32Array(3),P=new Float32Array(3),G=new Float32Array(3),F=new Float32Array(3),j=new Float32Array(3),B=new Float32Array(3),H=new Float32Array(3),X=new Float32Array(4),q=new Float32Array(4),z=new Float32Array(9),W=new Float32Array(16),Y=new Float32Array(16),V=N.create(),J=N.create(),K=new Float64Array(1),Q=new Uint32Array(K.buffer),Z=new Float32Array([0,0,0,1]),$=new Float32Array([0,0,0,1,0,0,0,1]),ee=new Float32Array([1,1,1]),te=new Float32Array([1,0,0]),ae=new Float32Array([0,1,0]),re=new Float32Array([0,0,1]),ne=new Float32Array([-1,0,0]),oe=new Float32Array([0,-1,0]),ie=new Float32Array([0,0,-1]),_e=[0,1,2,4,5],se=Math.floor(44488.07041494893),ce=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];e.Ax=new Float32Array([0,0,0]),e.zs=Z,e.$V=$,e.Bx=ee,e.AXIS_X=te,e.AXIS_Y=ae,e.AXIS_Z=re,e.AXIS_MX=ne,e.AXIS_MY=oe,e.AXIS_MZ=ie,e.XYX=0,e.YZY=1,e.ZXZ=2,e.XZX=3,e.YXY=4,e.ZYZ=5,e.XYZ=6,e.YZX=7,e.ZXY=8,e.XZY=9,e.YXZ=10,e.ZYX=11,e.aJ=ce,e.lx=1,e.tp=2,e.xi=4,e.MB=4,e.Ud=function(e){return"undefined"!=typeof e},e.keyfind=function(e,t,a){for(var r=[],n=a.length,o=0;o<n;o++){var i=a[o];i[e]==t&&r.push(i)}return r},e.f32=function(e){return new Float32Array(e)},e.RO=function(e,t){var a=e.length,r=new Float32Array(a+t.length);return r.set(e),r.set(t,a),r},e.qU=function(e,t){var a=e.length,r=new Uint32Array(a+t.length);return r.set(e),r.set(t,a),r},e.uM=function(){return 255==new DataView(new Uint16Array([255]).buffer).getUint16(0,!0)},e.BL=function(e,t){var a,r,n=[],o={},i=t.length;for(a=0;a<i;a++)o[t[a]]=!0;for(i=e.length,a=0;a<i;a++)(r=e[a])in o&&n.push(r);return n},e.sign=a,e.fY=function(e,t,a){for(var r=a.length,n=0;n<r;n++)if(a[n][e]==t)return!0;return!1},e.keysearch=function(e,t,a){for(var r=0;r<a.length;r++){var n=a[r];if(n[e]===t)return n}return null},e.dY=function(e,t,a,r,n){for(var o=0;o<n.length;o++){var i=n[o];if(i[e]==t&&i[a]==r)return i}return null},e.QP=function(e,t){for(var a=0;a<e.length;a++)if(e[a].uuid==t)return a;return-1},e.wL=function(e,t){for(var a=0;a<e.length;a++)if(e[a]==t)return;e.push(t)},e.TW=function(e){for(var t=0;t<e.length-1;t++)for(var a=e[t],r=t+1;r<e.length;r++)if(a==e[r])return!1;return!0},e.lU=function(e,t,a,r){r||(r=new Float32Array(16)),S.identity(r),r[12]=e,r[13]=t,r[14]=a};var le=1;e.oS=function(){return le=(69069*le+5)%Math.pow(2,32),Math.round(le/65536)%32768/32767},e.$T=function(e){le=e},e.Jg=function(e){var t=e[0]%se*48271-3399*Math.floor(e[0]/se);return e[0]=0<t?t:t+2147483647,(e[0]-1)/2147483646},e.Pu=function(e,t){return t||(t=[]),t[0]=5e4+Math.floor(e),t},e.euler_to_quat=function(e,t){var a=U;return a[0]=e[2],a[1]=e[1],a[2]=e[0],r(a,11,t),t},e.ordered_angles_to_quat=r,e.quat_to_ordered_angles=n,e.BO=function(e){var t=y.create(),a=Math.cos(e[0]),r=Math.cos(e[1]),n=Math.cos(e[2]),o=Math.sin(e[0]),i=Math.sin(e[1]);e=Math.sin(e[2]);var _=a*n,s=a*e,c=o*n,l=o*e;return t[0]=r*n,t[1]=r*e,t[2]=-i,t[3]=i*c-s,t[4]=i*l+_,t[5]=r*o,t[6]=i*_+l,t[7]=i*s-c,t[8]=r*a,t},e.quat_to_euler=function(e,t){var a=n(e,11,U);return t[0]=a[2],t[1]=a[1],t[2]=a[0],t},e.quat_to_dir=o,e.dir_to_quat=function(e,t,a){a||(a=new Float32Array(4)),e=I.normalize(e,U);var r=I.dot(t,e);return e=I.cross(t,e,k),r=Math.acos(r),a[0]=e[0]*Math.sin(r/2),a[1]=e[1]*Math.sin(r/2),a[2]=e[2]*Math.sin(r/2),a[3]=Math.cos(r/2),a},e.mU=function(e,t,a,r){r||(r=new Float32Array(4)),I.transformQuat(a,t,r),r[3]=-I.dot(e,r)},e.lO=function(e){var t=L.get_quat_view(e.o.v),a=U;switch(e.type){case"CAMERA":a[0]=0,a[1]=-1,a[2]=0,I.transformQuat(a,t,a),k[0]=0,k[1]=0,k[2]=-1;break;case"MESH":a[0]=0,a[1]=0,a[2]=1,I.transformQuat(a,t,a),k[0]=0,k[1]=0,k[2]=1;break;case"EMPTY":a[0]=0,a[1]=1,a[2]=0,I.transformQuat(a,t,a),k[0]=0,k[1]=1,k[2]=0}return a[1]=0,I.normalize(a,a),e=I.dot(a,k),Math.acos(e)*(0<-a[0]*k[2]?-1:1)},e.at=function(e,t,a,r){if(0!=a){r=r||[];for(var n=0;n<e.length;n++)r[n]=(1-a)*e[n]+a*t[n]}},e.$H=function(){return C++,C.toString(10)},e.cs=function(e){D[e]||(D[e]=0);var t=e+D[e];return D[e]++,t},e.Sh=function(){return{a_position:new Float32Array(0),a_tbn:R.create(0)}},e.P=function(t){if(!(t instanceof Object))return t;var a;switch(a=t.constructor){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:a=new a(t);break;case Array:a=new a(t.length);for(var r=0;r<t.length;r++)a[r]=e.P(t[r]);break;default:for(r in a=new a,t)t.hasOwnProperty(r)&&(a[r]=e.P(t[r]))}return a},e.aq=function(e){var t,a=e instanceof Array?[]:{};for(t in e)if(e.hasOwnProperty(t))if(e[t]instanceof Object){var r=e[t].constructor;switch(r){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:a[t]=new r(e[t]);break;case Array:a[t]=e[t].slice(0);break;default:a[t]=e[t]}}else a[t]=e[t];return a},e.matrix_to_quat=i,e.Dz=function(e,t){return t||(t=new Float32Array(3)),t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.PF=function(e){return X[0]=.577350269189626,X[1]=.577350269189626,X[2]=.577350269189626,X[3]=0,M.transformMat4(X,e,X),M.length(X)},e.Ol=function(e,t){var a=t.left,r=t.right,n=t.top,o=t.bottom,i=t.near,s=t.far;a[0]=e[3]+e[0],a[1]=e[7]+e[4],a[2]=e[11]+e[8],a[3]=e[15]+e[12],r[0]=e[3]-e[0],r[1]=e[7]-e[4],r[2]=e[11]-e[8],r[3]=e[15]-e[12],n[0]=e[3]-e[1],n[1]=e[7]-e[5],n[2]=e[11]-e[9],n[3]=e[15]-e[13],o[0]=e[3]+e[1],o[1]=e[7]+e[5],o[2]=e[11]+e[9],o[3]=e[15]+e[13],i[0]=e[3]+e[2],i[1]=e[7]+e[6],i[2]=e[11]+e[10],i[3]=e[15]+e[14],s[0]=e[3]-e[2],s[1]=e[7]-e[6],s[2]=e[11]-e[10],s[3]=e[15]-e[14],_(a),_(r),_(n),_(o),_(i),_(s)},e.VT=function(e,t,a){return a<-O.point_plane_dist(e,t.near)||a<-O.point_plane_dist(e,t.left)||a<-O.point_plane_dist(e,t.right)||a<-O.point_plane_dist(e,t.top)||a<-O.point_plane_dist(e,t.bottom)||a<-O.point_plane_dist(e,t.far)},e.xO=function(e,t,a,r,n){var o=I.dot(a,t.far),i=I.dot(r,t.far),_=I.dot(n,t.far),o=Math.sqrt(o*o+i*i+_*_);return o<-O.point_plane_dist(e,t.near)||o<-O.point_plane_dist(e,t.far)||(o=I.dot(a,t.left),i=I.dot(r,t.left),_=I.dot(n,t.left),Math.sqrt(o*o+i*i+_*_)<-O.point_plane_dist(e,t.left)||(o=I.dot(a,t.right),i=I.dot(r,t.right),_=I.dot(n,t.right),Math.sqrt(o*o+i*i+_*_)<-O.point_plane_dist(e,t.right)||(o=I.dot(a,t.top),i=I.dot(r,t.top),_=I.dot(n,t.top),Math.sqrt(o*o+i*i+_*_)<-O.point_plane_dist(e,t.top)||(o=I.dot(a,t.bottom),i=I.dot(r,t.bottom),_=I.dot(n,t.bottom),Math.sqrt(o*o+i*i+_*_)<-O.point_plane_dist(e,t.bottom)))))},e.wo=function(e,t,a,r){r||(r=0);for(var n=e.length,o=0;o<n;o+=3){var i=e[o],_=e[o+1],s=e[o+2];a[r+o]=t[0]*i+t[4]*_+t[8]*s+t[12],a[r+o+1]=t[1]*i+t[5]*_+t[9]*s+t[13],a[r+o+2]=t[2]*i+t[6]*_+t[10]*s+t[14]}},e.VY=function(e,t,a,r){r||(r=0);for(var n=e.length,o=0;o<n;o+=3){var i=e[o],_=e[o+1],s=e[o+2];a[r+o]=t[0]*i+t[4]*_+t[8]*s,a[r+o+1]=t[1]*i+t[5]*_+t[9]*s,a[r+o+2]=t[2]*i+t[6]*_+t[10]*s}return a},e.nS=function(e,t,a,r){r=r||0;for(var n=e.length,o=0;o<n;o+=4){V[0]=e[o],V[1]=e[o+1],V[2]=e[o+2],V[3]=e[o+3];var i=0<V[3];N.multiply(t,V,V),(i&&0>V[3]||!i&&0<V[3])&&M.scale(V,-1,V),a[r+o]=V[0],a[r+o+1]=V[1],a[r+o+2]=V[2],a[r+o+3]=V[3]}},e.oV=function(e,t,a){a||(a=new Float32Array(3)),X[0]=e[0],X[1]=e[1],X[2]=e[2],X[3]=0,M.transformMat4(X,t,X),a[0]=X[0],a[1]=X[1],a[2]=X[2]},e.lX=function(e,t){var a=e.length;a||h("flatten(): Wrong or empty array");var r=e[0].length;r||h("flatten(): Wrong or empty subarray"),t||(t=new Float32Array(a*r));for(var n=0;n<a;n++)for(var o=0;o<r;o++)t[n*r+o]=e[n][o];return t},e.pV=function(e){for(var t=[],a=0;a<e.length;a+=3)t[a/3]=new Float32Array([e[a],e[a+1],e[a+2]]);return t},e.$s=function(t,a,r,n){if(n<r)return r;var o=r+Math.floor((n-r)/2);return t[o]>a?e.$s(t,a,r,o-1):t[o]<a?e.$s(t,a,o+1,n):o},e.Vj=function(e,t){for(var a=0;a<e.length;a++)if(e[a]!=t[a])return!1;return!0},e.XW=function(e,t,a){for(var r=0;r<e.length;r++)if(Math.abs(e[r]-t[r])>a)return!1;return!0},e.wY=function(e,t,a){a||(a=new Float32Array(16));for(var r=0;12>r;r++)a[r]=e[r]*t;return a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},e.oU=function(e,t,a,r,n){return n||(n=new Float32Array(16)),t=S.fromRotationTranslation(a,r,W),S.multiply(t,e,n),n},e.transform_vec3=function(e,t,a,r,n){return n||(n=new Float32Array(3)),a=S.fromRotationTranslation(a,r,W),1!==t&&(r=S.identity(Y),t=I.set(t,t,t,U),S.scale(r,t,r),S.multiply(a,r,a)),I.transformMat4(e,a,n),n},e.OY=function(e,t,a,r,n){return n||(n=new Float32Array(4)),t=S.fromRotationTranslation(a,r,W),M.transformMat4(e,t,n),n},e.YX=function(e,t,a,r,n){return n||(n=new Float32Array(3)),t=S.fromRotationTranslation(a,r,W),S.invert(t,t),I.transformMat4(e,t,n),n},e.NY=function(e,t,a){for(a||(a=new Float32Array(16)),S.fromRotationTranslation(t,e,a),e=e[3],t=0;12>t;t++)a[t]*=e;return a},e.jY=function(t,a,r){e.Dz(t,a),a[3]=e.PF(t),i(t,r)},e.FW=function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);return JSON.stringify(t)},e.MS=function(e,t,a,r){r||(r=new Float32Array(3));var n=U;I.subtract(t,e,n),I.transformQuat(n,a,n),I.subtract(t,n,r)},e.fP=function(){var e=U;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),a=new Float32Array(16),r=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16),i=new Float32Array(16);return S.lookAt(e,[-1,0,0],[0,-1,0],t),S.scale(t,[-1,1,1],t),S.scale(t,[-1,1,-1],a),S.lookAt(e,[0,-1,0],[0,0,-1],r),S.scale(r,[1,1,-1],r),S.scale(r,[1,-1,-1],n),S.lookAt(e,[0,0,-1],[0,-1,0],o),S.scale(o,[-1,1,1],o),S.scale(o,[-1,1,-1],i),[t,a,r,n,o,i]},e.jP=function(){var e=U;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),a=new Float32Array(16),r=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16),i=new Float32Array(16);return S.lookAt(e,[1,0,0],[0,-1,0],t),S.scale(t,[-1,1,-1],a),S.lookAt(e,[0,1,0],[0,0,1],r),S.scale(r,[1,-1,-1],n),S.lookAt(e,[0,0,1],[0,-1,0],o),S.scale(o,[-1,1,-1],i),[t,a,r,n,o,i]},e.aD=function(e){return s(e,0)},e.hash_code=s,e.NX=l,e.sR=function(e,t){return t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},e.quat_to_angle_axis=function(e,t){t||(t=e);var a=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return 0<a?(t[3]=2*Math.acos(e[3]),a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a):(t[3]=0,t[0]=1,t[1]=0,t[2]=0),t},e.trunc=function(e){return isNaN(e)||"undefined"==typeof e?NaN:0|e},e.deg_to_rad=function(e){return e*Math.PI/180},e.rad_to_deg=function(e){return 180*e/Math.PI},e.PA=function(e){var t=.366025403784439*e[0]+.366025403784439*e[1],a=Math.floor(e[0]+t),r=Math.floor(e[1]+t),n=.211324865405187*a+.211324865405187*r,t=e[0]-a+n;e=e[1]-r+n;var o=t>e?1:0,i=1-o,n=t+.211324865405187-o,_=e+.211324865405187-i,s=t+-.577350269189626,c=e+-.577350269189626,a=a%289,r=r%289,l=Math.max(.5-(t*t+e*e),0),d=Math.max(.5-(n*n+_*_),0),p=Math.max(.5-(s*s+c*c),0),m=2*u(.024390243902439*f(f(r)+a))-1,o=2*u(.024390243902439*f(f(r+i)+a+o))-1,g=2*u(.024390243902439*f(f(r+1)+a+1))-1,a=Math.abs(m)-.5,r=Math.abs(o)-.5,i=Math.abs(g)-.5,m=m-Math.floor(m+.5),o=o-Math.floor(o+.5),g=g-Math.floor(g+.5);return 130*(l*l*l*l*(1.79284291400159-.85373472095314*(m*m+a*a))*(m*t+a*e)+d*d*d*d*(1.79284291400159-.85373472095314*(o*o+r*r))*(o*n+r*_)+p*p*p*p*(1.79284291400159-.85373472095314*(g*g+i*i))*(g*s+i*c))},e.fD=function(e){var t=1/7,a=t/2,r=p(Math.floor(e[0])),n=p(Math.floor(e[1])),o=u(e[0]);e=u(e[1]);var i=o-.5,_=o-1.5,o=e-.5;e-=1.5;var s=d(r),c=d(r+1),l=s,r=c,s=d(s+n),c=d(c+n),l=d(l+n+1),r=d(r+n+1),n=i+.7*(m(s)*t+a),f=_+.7*(m(c)*t+a),i=i+.7*(m(l)*t+a),_=_+.7*(m(r)*t+a),s=o+.7*(m(Math.floor(s*t))*t+a),o=o+.7*(m(Math.floor(c*t))*t+a),l=e+.7*(m(Math.floor(l*t))*t+a),t=e+.7*(m(Math.floor(r*t))*t+a);return Math.min(n*n+s*s,f*f+o*o,i*i+l*l,_*_+t*t)},e.quat_project=function(e,t,a,r,n){n||(n=new Float32Array(4)),e=I.transformQuat(t,e,U),t=a[0];var o=a[1];a=a[2];var i=z;return i[0]=o*o+a*a,i[1]=-o*t,i[2]=-a*t,i[3]=-t*o,i[4]=t*t+a*a,i[5]=-a*o,i[6]=-t*a,i[7]=-o*a,i[8]=t*t+o*o,I.transformMat3(e,i,e),I.normalize(e,e),N.rotationTo(r,e,n),n},e.cam_quat_to_mesh_quat=function(e,t){t||(t=new Float32Array(4));var a,r;return a=N.setAxisAngle([0,0,1],Math.PI,N.create()),r=N.setAxisAngle([1,0,0],Math.PI/2,N.create()),N.multiply(a,r,a),N.multiply(e,a,t),t},e.cleanup=function(){C=0,D={}},e.clamp=g,e.smooth=function(e,t,a,r){return(1-(a=Math.exp(-a/r)))*e+a*t},e.smooth_v=function(e,t,a,r,n){for(n||(n=new Float32Array(e.length)),a=Math.exp(-a/r),r=0;r<n.length;r++)n[r]=(1-a)*e[r]+a*t[r];return n},e.uH=function(e,t,a,r,n){n||(n=new Float32Array(e.length)),N.slerp(e,t,Math.exp(-a/r),n)},e.pz=function(e){return!!("object"===typeof e&&e.buffer&&e.buffer instanceof ArrayBuffer)},e.is_vector=function(e,t){return!(!(e instanceof Array||e.buffer&&e.buffer instanceof ArrayBuffer)||(!t||t!=e.length)&&t)},e.correct_cam_quat_up=function(e,t){var a=y.fromQuat(e,z),r=U;r[0]=a[6],r[1]=a[7],r[2]=a[8],r=I.cross(re,r,r),I.normalize(r,r);var n=a[4];!t&&0<n&&(r[0]*=-1,r[1]*=-1,r[2]*=-1),k[0]=a[0],k[1]=a[1],k[2]=a[2],I.normalize(k,k),N.rotationTo(k,r,q),N.multiply(q,e,e)},e.AE=function(e,t,a,r){a=a*t-.5,r=r*t-.5;var n=a-Math.floor(a),o=r-Math.floor(r);a=Math.floor(a),r=Math.floor(r);var i=t-1;return(e[r*t+a]*(1-n)+e[r*t+Math.min(a+1,i)]*n)*(1-o)+(e[Math.min(r+1,i)*t+a]*(1-n)+e[Math.min(r+1,i)*t+Math.min(a+1,i)]*n)*o},e.xm=function(e){for(var t=0,a=0;3>a;a++)0<(e&1<<a)&&t++;return t},e.JG=function(e){for(var t=[0,0,0],a=0;3>a;a++)0<(e&1<<a)&&(t[2-a]=1);return t},e.Ao=function(e,t){var a=0;return(1==t||2==t)&&0<(4&e)&&a++,2==t&&0<(2&e)&&a++,a},e.lu=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},e.$i=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},e.random_from_array=function(e){return e.length?e[Math.floor(Math.random()*e.length)]:null},e.horizontal_direction=function(e,t,a){a||(a=new Float32Array(3)),a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=0,I.normalize(a,a)},e.nU=function(e,t,a){var r=e[0],n=e[1];e=e[2];var o=t[0],i=t[1],_=t[2];t=t[3];var s=i*e-_*n,c=_*r-o*e,l=o*n-i*r;a[0]=r+2*s*t+2*(i*l-_*c),a[1]=n+2*c*t+2*(_*s-o*l),a[2]=e+2*l*t+2*(o*c-i*s)},e.assert=function(e){e||h("Assertion failed")},e.F=h,e.angle_wrap_periodic=v,e.angle_wrap_0_2pi=b,e.Sy=function(e){return/(?:\.([^.]+))?$/.exec(e)[1]},e.cU=function(e,t){for(var a in e){var r=!0,n=e[a],o=t[a];switch(typeof n){case"number":case"string":case"boolean":r=n==o;break;case"object":r=E(n,o)}if(!r)return!1}return!0},e.oA=function(e,t){var a=e[0],r=e[2],n=e[3];t[0]=e[1],t[1]=r,t[2]=n,t[3]=a},e.qE=function(e){132651<++e&&w.error("Color ID pool depleted");var t=Math.floor(e/2601);return e%=2601,new Float32Array([t/51,Math.floor(e/51)/51,e%51/51])},e.line_plane_intersect=function(e,t,a,r){return X.set(e),X[3]=t,U[0]=a[3],U[1]=a[4],U[2]=a[5],q.set(U),q[3]=0,0==(e=M.dot(X,q))?null:(I.copy(a,U),q.set(U),q[3]=1,e=-M.dot(X,q)/e,r[0]=a[0]+e*a[3],r[1]=a[1]+e*a[4],r[2]=a[2]+e*a[5],r)},e.YP=function(e,t,a,r){var n=t[0]-e[0],o=a[0]-e[0],i=t[1]-e[1],_=a[1]-e[1];return t=t[2]-e[2],e=a[2]-e[2],r[0]=i*e-t*_,r[1]=o*t-n*e,r[2]=n*_-i*o,r},e.ZW=function(e,t){for(var a=0;a<e.length;a++)t[a]=e[a];return t},e.MG=x,e.zl=function(e,t,a){return t==a?a-e:(e=b(e),t=b(t),a=b(a),t=2*Math.PI-t,a=b(a+t),e=b(e+t),e>a?(a-=e,e=2*Math.PI-e,-a>e?e:a):0)},e.smooth_step=function(e,t,a){return isFinite(t)&&isFinite(a)&&(e=g(e,t,a)),e*e*(3-2*e)},e.lerp=function(e,t,a){return t+e*(a-t)},e.CL=function(e,t){for(var a=0;a<e.length;a++)for(var r=0;r<t.length;r++)if(t[r]==e[a])return!0;return!1},e.dX=function(e){for(var t=Array(e),a=0;a<e;a++)t[a]=0;return t},e.BI=function(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;n++){var o=a((n>=e.length?0:e[n])-(n>=t.length?0:t[n]));if(o)return o}return 0},e.el=function(e){return e.join(".")},e.EH=function(e){return e.split(".").map(function(e){return 0|e})},e.AH=function(e,t){t[0]=Math.pow(e[0],2.2),t[1]=Math.pow(e[1],2.2),t[2]=Math.pow(e[2],2.2)},e.zz=function(e,t){return t[0]=Math.pow(e[0],1/2.2),t[1]=Math.pow(e[1],1/2.2),t[2]=Math.pow(e[2],1/2.2),t},e.ji=function(e){var t=e.split("://",2);return 1<t.length?(t[1]=T(t[1]),t.join("://")):T(e)},e.Yp=function(e){return!!parseInt(e.toString(2).substr(1),2)},e.wO=function(e,t,a,r){return r[0]=e[0],r[1]=t[0],r[2]=a[0],r[3]=e[1],r[4]=t[1],r[5]=a[1],r[6]=e[2],r[7]=t[2],r[8]=a[2],r},e.Yj=function(){var e=[{}];return e.length=0,e},e.Hn=function(e){return e=Math.round(32767.5*(e+1)-32768),g(e||0,-32768,32767)},e.rH=function(e){return g((e+32768)/32767.5-1,-1,1)},e.ZH=function(e){return g(Math.round(255*e),0,255)},e.YH=function(e){return g(e/255,0,1)},e.oO=function(e,t,a,r){var n=I.subtract(a,t,U),o=I.subtract(r,a,k),i=I.subtract(t,r,P);return t=I.subtract(e,t,G),a=I.subtract(e,a,F),e=I.subtract(e,r,j),r=I.cross(n,o,B),0<=I.dot(I.cross(r,n,H),t)&&0<=I.dot(I.cross(r,o,H),a)&&0<=I.dot(I.cross(r,i,H),e)?(i=I.length(r),o=I.dot(r,t),Math.abs(o/i)):(n=I.scale(n,g(I.dot(n,t)/I.length(n),0,1),H),t=I.length(I.subtract(t,n,H)),o=I.scale(o,g(I.dot(o,a)/I.length(o),0,1),H),o=I.length(I.subtract(a,o,H)),i=I.scale(i,g(I.dot(i,e)/I.length(i),0,1),H),i=I.length(I.subtract(e,i,H)),Math.min(Math.min(t,o),i))},e.NS=function(e,t,a,r,n){if(a||r){var i=N.identity(V);a&&(t=N.setAxisAngle(t,a,J),N.multiply(i,t,i)),e=N.copy(e,n),r&&(n=o(e,te,U),r=N.setAxisAngle(n,r,J),N.normalize(r,r),N.multiply(i,r,i)),N.multiply(i,e,e),N.normalize(e,e)}},e.Tv=function(e,t,a,r){o(t,r,k),I.normalize(k,k),I.subtract(a,e,P),I.normalize(P,P),e=x(k,P,X),N.multiply(e,t,t),N.normalize(t,t)},e.mS=function(e,t,a,r){t=I.transformQuat(t,e,k);var n=I.dot(r,a);r=I.scale(r,n,P),a=I.subtract(a,r,P),r=N.identity(V),I.normalize(a,a),.999999>Math.abs(I.dot(t,a))&&x(t,a,r),N.normalize(r,r),N.multiply(r,e,e)},e.RE=function(e){var t=te,r=I.transformQuat(t,e,U);return.999999<Math.abs(I.dot(r,ae))&&(t=re,r=I.transformQuat(t,e,U)),r[1]=0,I.normalize(r,r),e=Math.acos(I.dot(t,r)),t=I.cross(t,r,k),t=a(I.dot(t,ae)),e*t},e.QE=function(e){var t=ae,r=I.transformQuat(t,e,U);return.999999<Math.abs(I.dot(r,te))&&(t=re,r=I.transformQuat(t,e,U)),r[0]=0,I.normalize(r,r),e=Math.acos(I.dot(t,r)),t=I.cross(t,r,k),t=a(I.dot(t,te)),e*t},e.SE=function(e){var t=te,r=I.transformQuat(t,e,U);return.999999<Math.abs(I.dot(r,re))&&(t=ae,r=I.transformQuat(t,e,U)),r[2]=0,I.normalize(r,r),e=Math.acos(I.dot(t,r)),t=I.cross(t,r,k),t=a(I.dot(t,re)),e*t},e.OM=function(e,t){for(var a=2*Math.PI,r=[],n=0;3>n;n++)r[n]=e[n]-t[n],5.1<r[n]?(e[n]-=r[n]/a*a,r[n]=e[n]-t[n]):-5.1>r[n]&&(e[n]+=-r[n]/a*a,r[n]=e[n]-t[n]);3.2<Math.abs(r[0])&&1.6>Math.abs(r[1])&&1.6>Math.abs(r[2])&&(e[0]=0<r[0]?e[0]-a:e[0]+a),3.2<Math.abs(r[1])&&1.6>Math.abs(r[2])&&1.6>Math.abs(r[0])&&(e[1]=0<r[1]?e[1]-a:e[1]+a),3.2<Math.abs(r[2])&&1.6>Math.abs(r[0])&&1.6>Math.abs(r[1])&&(e[2]=0<r[2]?e[2]-a:e[2]+a)}},a.module.__sfx=function(e,t){function a(){var e=window.AudioContext||window.webkitAudioContext;if(e){try{var t=new e}catch(e){return b.error('Unable to initialize AudioContext: "'+e+'". The audio is disabled.'),null}return t.createGain?t:(b.warn("deprecated WebAudio implementation"),null)}return b.warn("WebAudio is not supported"),null}function r(e,t,a){var r=e.Z;if("NONE"!=r.behavior){var o=r.loop,l=r.pitch;if(r.src&&(o||0<=a)){r.Mx=Math.floor(5e4*Math.random());var f=M.currentTime+t,f=Math.max(0,f);r.pf=f,r.state=20;var u=C.Hc;"POSITIONAL"==r.behavior&&"none"==u.wq&&(r.behavior="BACKGROUND_SOUND"),n(e,C.Hc),"POSITIONAL"==r.behavior||"BACKGROUND_SOUND"==r.behavior?(t=M.createBufferSource(),t.buffer=r.src,t.playbackRate.value=l,o?(r.ec&&r.ec.disconnect(),r.Hd&&r.Hd.disconnect(),t.loop=!0,t.loopStart=r.LF,(t.loopEnd=r.hv)&&(a=M.createBufferSource(),a.buffer=r.src,a.playbackRate.value=l,r.Hd=a,a.connect(r.Ad)),t.start(f),r.duration=0):(o=t.buffer?t.buffer.duration:0,a>o?(o=f+a+r.De,t.loop=!0,t.start(f),t.stop(o),r.duration=a):(t.loop=!1,t.start(f),r.duration=o)),t.connect(r.Ad),r.ec=t,i(r),_(r),s(r)):"BACKGROUND_MUSIC"==r.behavior&&(A.clear_timeout(r.Px),A.clear_timeout(r.Qx),a=function(){var t=e.Z,a=t.src;a&&(a.volume=1,a.loop=t.loop,t.ec=t.ec||M.createMediaElementSource(a),t.ec.connect(t.Ad),20==t.state&&(a.currentTime&&(a.currentTime=0),a.play()))},0==t?a():r.Px=A.set_timeout(a,1e3*t),r.duration=o?0:h(e)),c(r,f)}}}function n(e,t){var a=e.Z;if(!a.Ad){var r=x.get_trans_view(e.o.v),n=x.get_quat_view(e.o.v);if(O.pv){var o=M.createBiquadFilter();o.type="peaking"}else o=null;var i=M.createGain();switch(a.behavior){case"POSITIONAL":var _=M.createPanner();"string"!=typeof _.panningModel?(_.panningModel=_.EQUALPOWER,_.distanceModel=_.INVERSE_DISTANCE):(_.panningModel="equalpower",_.distanceModel=t.wq),_.setPosition(r[0],r[1],r[2]),y.copy(r,a.wz),r=w,T.quat_to_dir(n,T.AXIS_MZ,r),_.setOrientation(r[0],r[1],r[2]),_.refDistance=a.dist_ref,_.maxDistance=a.dist_max,_.rolloffFactor=a.attenuation,_.coneInnerAngle=a.BD,_.coneOuterAngle=a.CD,_.coneOuterGain=a.DD;var s=M.createGain();if(s.gain.value=g(a),o?(_.connect(o),o.connect(s)):_.connect(s),s.connect(i),a.Ad=_,a.Rm){var c=M.createGain();i.connect(c),c.connect(t.Ad)}else c=null,i.connect(t.Ad);break;case"BACKGROUND_SOUND":_=null,s=M.createGain(),s.gain.value=g(a),o?(a.Ad=o,o.connect(s)):a.Ad=s,s.connect(i),a.Rm?(c=M.createGain(),i.connect(c),c.connect(t.Ad)):(c=null,i.connect(t.Ad));break;case"BACKGROUND_MUSIC":c=_=null,s=M.createGain(),s.gain.value=g(a),o?(a.Ad=o,o.connect(s)):a.Ad=s,s.connect(i),i.connect(t.Ad)}a.fA=_,a.fh=o,a.Nn=s,a.dk=i,a.qA=c}}function o(e){var t=e.Z;r(e,t.delay+t.WD*Math.random(),t.duration)}function i(e){var t=e.Hd||e.ec;T.Ud(t.onended)&&(t.onended=function(){e.state=50})}function _(e){e.Rm&&e.qA.gain.cancelScheduledValues(e.pf),e.vo&&(e.ec.playbackRate.cancelScheduledValues(e.pf),e.Hd&&e.Hd.playbackRate.cancelScheduledValues(e.pf)),e.rs=e.pf}function s(e){if(e.Rm||e.vo){var t=e.qA,a=e.ec,r=a.buffer?a.buffer.duration:0;if(r){var n=e.pf;U[0]=e.Mx;for(var o=0;5>o;){var i=e.pitch+e.vo*T.Jg(U);if(n>=e.rs){if(e.Rm){var _=1-T.clamp(e.Rm,0,1)*Math.random();t.gain.setValueAtTime(_,n)}e.vo&&(a.playbackRate.setValueAtTime(i,n),e.Hd&&e.Hd.playbackRate.setValueAtTime(i,n)),o++}n+=r/i}e.rs=n-.001}}}function c(e,t){if(e.Wi||e.De){var a=e.dk;a.gain.cancelScheduledValues(t),e.Wi?(a.gain.setValueAtTime(0,t),a.gain.linearRampToValueAtTime(1,t+e.Wi)):a.gain.setValueAtTime(1,t),e.De&&!e.loop&&(a.gain.setValueAtTime(1,t+e.duration),a.gain.linearRampToValueAtTime(0,t+e.duration+e.De))}}function l(e){"SPEAKER"!=e.type&&T.F("Wrong object type");var t=e.Z;if(50==t.state)t.state=30;else if(20==t.state||40==t.state){var a=t.dk,r=M.currentTime;t.De&&(a.gain.setValueAtTime(a.gain.value,r),a.gain.linearRampToValueAtTime(0,r+t.De)),"BACKGROUND_MUSIC"==t.behavior?t.src&&(A.clear_timeout(t.Px),A.clear_timeout(t.Qx),t.Qx=A.set_timeout(function(){var t=e.Z.src;t&&(t.currentTime&&(t.currentTime=0),t.pause())},1e3*t.De)):(a=t.ec,a.onended=function(){},t.duration<a.buffer.duration?t.De&&20==t.state?a.stop(r+t.De):20==t.state&&(a.stop(0),a.disconnect()):a.disconnect(),t.pf=0,t.hA=0,t.ht=0),t.state=30}}function f(e){if(e=e.Z,20==e.state){var t=M.currentTime;e.hA=t,"BACKGROUND_MUSIC"==e.behavior?(t=e.src)&&t.pause():(t>e.pf?e.ht=u(e,t):e.ht=0,e.ec.onended=function(){},e.ec.stop(0),e.ec.disconnect(),_(e)),e.state=40}}function u(e,t){U[0]=e.Mx;for(var a,r=e.ec.buffer.duration,n=e.pf;n<t;)a=e.pitch+e.vo*T.Jg(U),n+=r/a;return(r/a-(n-t))*a}function d(e){var t=e.Z;if(40==t.state){var a=M.currentTime;if(t.pf+=a-t.hA,"BACKGROUND_MUSIC"==t.behavior)t.src.play();else{e=e.Z;var r=M.createBufferSource();r.loop=e.ec.loop,r.loopStart=e.ec.loopStart,r.loopEnd=e.ec.loopEnd,r.buffer=e.ec.buffer,r.playbackRate.value=e.ec.playbackRate.value,r.connect(e.Ad),e.ec=r,e.Hd&&(r=M.createBufferSource(),r.loop=e.Hd.loop,r.buffer=e.Hd.buffer,r.playbackRate.value=e.Hd.playbackRate.value,r.connect(e.Ad),e.Hd=r),t.rs=a,a=t.ec,i(t),a.start(t.pf,t.ht),s(t)}c(t,t.pf),t.state=20}}function p(e,t,a){var r;if(0<(r=t.pO)){var n=t.UT;if(0!=y.dot(e.Xw,e.Xw)||0!=y.dot(t.km,t.km)){var o=y.subtract(e.wz,t.gi,w),i=y.length(o);t=y.dot(o,t.km)/i,o=y.dot(o,e.Xw)/i,i=n/r,t=Math.min(-t,i),o=Math.min(-o,i),r=(n-r*t)/(n-r*o),isFinite(r)||(r=0),r=Math.min(r,16),r=Math.max(r,.125),r=T.smooth(r,e.AF,a,.3),e.ec.playbackRate.value=r,e.AF=r}}}function m(e){return!(!(e=e.Z)||20!=e.state&&40!=e.state&&30!=e.state&&50!=e.state)}function g(e){return e.muted?0:e.volume}function h(e){return e=e.Z,(e=e.src)?e.duration:0}var v=t("__config"),b=t("__print"),E=t("__quat"),A=t("__time"),x=t("__tsr"),T=t("__util"),y=t("__vec3"),S=v.H,O=v.Z,w=new Float32Array(3),R=new Float32Array(3),L=E.create(),N=[],I=[],M=null,C=null,D=[],U=[1],k=null;e.GB=10,e.kx=20,e.FB=30,e.uN=function(){return{Kj:-1,Zh:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1e4,BD:360,CD:360,DD:1,autoplay:!1,cyclic:!1,loop:!1,LF:0,hv:0,delay:0,WD:0,Rm:0,vo:0,Wi:0,De:0,pf:0,hA:0,ht:0,duration:0,rs:0,Mx:1,src:null,state:10,wz:new Float32Array(3),Xw:new Float32Array(3),Vt:!1,AF:1,Px:-1,Qx:-1,Nl:0,Ad:null,ec:null,Hd:null,fA:null,fh:null,Nn:null,dk:null,qA:null,Zk:0}},e.init=function(){var e=document.createElement("audio"),t=document.createElement("video");e.canPlayType&&(""!=e.canPlayType("audio/ogg")&&(N.push("ogg"),N.push("ogv"),N.push("oga")),""!=e.canPlayType("audio/mpeg")&&N.push("mp3"),""!=e.canPlayType("audio/mp4")&&(N.push("mp4"),N.push("m4v"),N.push("m4a")),""!=e.canPlayType("audio/webm")&&N.push("webm")),t.canPlayType&&(""!=t.canPlayType("video/ogg")&&(I.push("ogv"),I.push("ogg"),I.push("oga")),""!=t.canPlayType("video/mp4")&&(I.push("m4v"),I.push("mp4")),""!=t.canPlayType("video/webm")&&I.push("webm"),""!=t.canPlayType("video/mpeg")&&I.push("mp3"))},e.IL=function(e){if(O.AB&&!M&&(M=a())&&b.log("%cINIT WEBAUDIO: "+M.sampleRate+"Hz","color: #00a"),M){var t={gi:new Float32Array(3),km:new Float32Array(3),Zk:0},r=M.createGain(),n=M.createGain();if(t.Nn=r,t.dk=n,r.connect(n),n.connect(M.destination),e.b4w_enable_dynamic_compressor){var n=M.createDynamicsCompressor(),o=e.b4w_dynamic_compressor_settings;n.threshold.value=o.threshold,n.knee.value=o.knee,n.ratio.value=o.ratio,n.attack.value=o.attack,n.release.value=o.release,n.connect(r),t.mq=n,t.Ad=n}else t.mq=null,t.Ad=r;switch(e.audio_distance_model){case"INVERSE":case"INVERSE_CLAMPED":t.wq="inverse";break;case"LINEAR":case"LINEAR_CLAMPED":t.wq="linear";break;case"EXPONENT":case"EXPONENT_CLAMPED":t.wq="exponential";break;case"NONE":t.wq="none";break;default:T.F("Wrong audio distance model")}t.pO=e.audio_doppler_factor,t.UT=e.audio_doppler_speed,t.muted=!1,t.volume=e.audio_volume,r.gain.value=g(t),t.Nl=0}else t=null;e.Hc=t},e.YS=function(e){C=e},e.detect_audio_container=function(e){return e||(e="ogg"),-1<N.indexOf(e)?e:-1<N.indexOf("m4a")?"m4a":-1<N.indexOf("oga")?"oga":""},e.detect_video_container=function(e){return e||(e="webm"),-1<I.indexOf(e)?e:-1<I.indexOf("m4v")?"m4v":-1<I.indexOf("webm")?"webm":""},e.$k=function(e,t){var a=e.data,r=t.Z;if(e.data.sound){switch(r.Kj=e.data.sound.uuid,r.Zh=e.data.sound.filepath,a.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":r.behavior=M?a.b4w_behavior:"NONE";break;case"BACKGROUND_MUSIC":var n;M?(window.MediaElementAudioSourceNode?n=!0:(b.warn("MediaElementAudioSourceNode not found"),n=!1),n=n&&!S.nD?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):n="NONE",r.behavior=n;break;default:T.F("Wrong speaker behavior")}a.sound||(r.behavior="NONE"),r.Vt=a.b4w_enable_doppler,r.muted=a.muted,r.volume=a.volume,r.pitch=a.pitch,r.attenuation=a.attenuation,r.dist_ref=a.distance_reference,r.dist_max=a.distance_max||1e4,r.BD=a.cone_angle_inner,r.CD=a.cone_angle_outer,r.DD=a.cone_volume_outer,r.autoplay=a.b4w_auto_play,r.cyclic=a.b4w_cyclic_play,r.loop=a.b4w_loop,r.LF=a.b4w_loop_start,r.hv=a.b4w_loop_end,r.delay=a.b4w_delay,r.WD=a.b4w_delay_random,r.Rm=a.b4w_volume_random,r.vo=a.b4w_pitch_random,r.Wi=a.b4w_fade_in,r.De=a.b4w_fade_out,D.push(t)}},e.wH=function(t){switch("SPEAKER"!=t.type&&T.F("Wrong object type"),t.Z.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":return e.kx;case"BACKGROUND_MUSIC":return e.FB;case"NONE":return e.GB;default:T.F("Wrong speaker behavior")}},e.$U=function(e,t){var a=e.Z;switch(a.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":case"BACKGROUND_MUSIC":a.src=t;break;case"NONE":break;default:T.F("Wrong speaker behavior")}},e.rG=function(){var e=M.createBufferSource();e.buffer=M.createBuffer(1,22050,22050),e.connect(M.destination),e.start(0)},e.hO=function(e,t,a){M?M.decodeAudioData(e,t,a):a()},e.RT=function(e){l(e),e.Z=null,D.splice(D.indexOf(e),1)},e.cleanup=function(){for(var e=0;e<D.length;e++){var t=D[e].Z;"BACKGROUND_MUSIC"==t.behavior?(t=t.src)&&t.pause():(t.ec&&t.ec.disconnect(),t.Hd&&t.Hd.disconnect())}C&&C.Hc&&(e=C.Hc,e.gi[0]=0,e.gi[1]=0,e.gi[2]=0,e.km[0]=0,e.km[1]=0,e.km[2]=0),C=null,D.splice(0),k=null},e.update=function(e){if(M&&D.length){for(var t=0;t<D.length;t++){var a=D[t],r=a.Z,n=r.ec,i=M.currentTime;!r.loop&&20==r.state&&r.duration&&r.pf+r.duration<i&&("BACKGROUND_MUSIC"==r.behavior||n&&!T.Ud(n.onended))&&(r.state=50),r.cyclic&&50==r.state&&o(a),20==r.state&&3>r.rs-i&&s(r)}k&&k.zj.length&&(-1==k.active||e>k.wC+k.aE[k.active])&&(t=k,-1<t.active&&l(t.zj[t.active]),a=-1==t.active&&t.random?Math.round(Math.random()*(t.zj.length-1)):t.random?(t.active+(1+Math.round(Math.random()*(t.zj.length-2))))%t.zj.length:(t.active+1)%t.zj.length,o(t.zj[a]),t.active=a,t.wC=e)}},e.play=r,e.play_def=o,e.stop=l,e.is_playing=function(e){return 20==e.Z.state},e.QT=f,e.ST=d,e.loop_stop=function(e,t){var a=e.Z,r=a.Hd;if(m(e)&&("POSITIONAL"==a.behavior||"BACKGROUND_SOUND"==a.behavior)&&r){var n=M.currentTime+t;a.ec.stop(n),r.start(n,a.hv)}},e.playrate=function(e,t){var a=e.Z;a.pitch=t,!m(e)||"POSITIONAL"!=a.behavior&&"BACKGROUND_SOUND"!=a.behavior||(a.ec.playbackRate.value=t,a.Hd&&(a.Hd.playbackRate.value=t),_(a),s(a))},e.get_playrate=function(e){return e.Z.pitch},e.cyclic=function(e,t){e.Z.cyclic=!!t},e.BQ=function(e){return e.Z.autoplay},e.is_cyclic=function(e){return e.Z.cyclic},e.gR=function(e,t,a,r,n){if(e=e.Hc){var o=w;if(o[0]=0,o[1]=0,o[2]=-1,y.transformQuat(o,a,o),R[0]=0,R[1]=1,R[2]=0,y.transformQuat(R,a,R),a=M.listener,a.setPosition(t[0],t[1],t[2]),a.setOrientation(o[0],o[1],o[2],R[0],R[1],R[2]),r&&e.Zk!=n){if(e.listener_stride)e.listener_stride=!1,y.copy(t,e.gi);else for(a=e.km,a[0]=(t[0]-e.gi[0])/r,a[1]=(t[1]-e.gi[1])/r,a[2]=(t[2]-e.gi[2])/r,y.copy(t,e.gi),t=0;t<D.length;t++)a=D[t],o=a.Z,m(a)&&"POSITIONAL"==o.behavior&&o.Vt&&p(o,e,r);e.Zk=n}else y.copy(t,e.gi)}},e.listener_stride=function(){var e=C.Hc;e&&(e.listener_stride=!0)},e.TT=function(e,t,a){var r=e.Z;if(m(e)&&"POSITIONAL"==r.behavior){var n=x.Cb(e.o.v,w);e=x.mb(e.o.v,L);var o=r.fA;o.setPosition(n[0],n[1],n[2]),T.quat_to_dir(e,T.AXIS_MZ,R),o.setOrientation(R[0],R[1],R[2]),r.Vt&&(e=r.wz,t&&r.Zk!=a?(r.Cj?(y.copy(n,e),r.Cj=!1):(o=r.Xw,o[0]=(n[0]-e[0])/t,o[1]=(n[1]-e[1])/t,o[2]=(n[2]-e[2])/t,y.copy(n,e),p(r,C.Hc,t)),r.Zk=a):y.copy(n,e))}},e.speaker_stride=function(e){var t=e.Z;m(e)&&"POSITIONAL"==t.behavior&&t.Vt&&(t.Cj=!0)},e.Uy=function(e){return e.Z.behavior},e.check_active_speakers=function(){for(var e=0;e<D.length;e++)if(m(D[e]))return!0;return!1},e.qT=function(e){var t=C.Hc;t&&(t.volume=e,M&&(t.Nn.gain.value=g(t)))},e.TP=function(){var e=C.Hc;return e?e.volume:0},e.set_volume=function(e,t){var a=e.Z;a.volume=t,m(e)&&(a.Nn.gain.value=g(a))},e.get_volume=function(e){return e.Z.volume},e.mute=function(e,t){e.Z.muted=!!t,m(e)&&(e.Z.Nn.gain.value=g(e.Z))},e.is_muted=function(e){return e.Z.muted},e.GR=function(e){var t=C.Hc;t&&(t.muted=!!e,M&&(t.Nn.gain.value=g(t)))},e.IQ=function(){var e=C.Hc;return!!e&&e.muted},e.get_speaker_objects=function(){return D},e.pause=function(){for(var e=0;e<D.length;e++)f(D[e])},e.resume=function(){for(var e=0;e<D.length;e++)d(D[e])},e.set_compressor_params=function(e,t){if(e.Hc&&e.Hc.mq){var a=e.Hc.mq;a.threshold.value=t.threshold,a.knee.value=t.knee,a.ratio.value=t.ratio,a.attack.value=t.attack,a.release.value=t.release}},e.get_compressor_params=function(e){return e.Hc&&e.Hc.mq?(e=e.Hc.mq,{threshold:e.threshold.value,knee:e.knee.value,ratio:e.ratio.value,attack:e.attack.value,release:e.release.value}):null},e.duck=function(e,t,a){if(m(e)){e=e.Z;var r=e.dk,n=M.currentTime;r.gain.setValueAtTime(r.gain.value,n),r.gain.linearRampToValueAtTime(t,n+a),e.Nl=a}},e.unduck=function(e){if(m(e)){e=e.Z;var t=e.dk,a=M.currentTime;t.gain.setValueAtTime(t.gain.value,a),t.gain.linearRampToValueAtTime(1,a+e.Nl),e.Nl=0}},e.sO=function(e,t){if(M){var a=C.Hc,r=a.dk,n=M.currentTime;r.gain.setValueAtTime(r.gain.value,n),r.gain.linearRampToValueAtTime(e,n+t),a.Nl=t}},e.rU=function(){if(M){var e=C.Hc,t=e.dk,a=M.currentTime;t.gain.setValueAtTime(t.gain.value,a),t.gain.linearRampToValueAtTime(1,a+e.Nl),e.Nl=0}},e.apply_playlist=function(e,t,a){for(k={active:-1,wC:0,random:a,zj:[],aE:[]},a=0;a<e.length;a++){var r=e[a],n=h(r);0==n?b.warn("Ignoring speaker with zero duration: "+r.name):(l(r),r.Z.cyclic=!1,k.zj.push(r),k.aE.push(n+t))}},e.get_duration=h,e.clear_playlist=function(){if(k)for(var e=k.zj,t=0;t<e.length;t++)l(e[t]);k=null},e.get_positional_params=function(e){return(e=e.Z)&&"POSITIONAL"==e.behavior?{dist_ref:e.dist_ref,dist_max:e.dist_max,attenuation:e.attenuation}:null},e.set_positional_params=function(e,t){var a=e.Z;if(a&&"POSITIONAL"==a.behavior){a.dist_ref=t.dist_ref,a.dist_max=t.dist_max,a.attenuation=t.attenuation;var r=a.fA;r&&(r.refDistance=a.dist_ref,r.maxDistance=a.dist_max,r.rolloffFactor=a.attenuation)}},e.set_filter_params=function(e,t){var a=e.Z;a&&a.fh&&(a.fh.frequency.value=t.freq,a.fh.Q.value=t.Q,a.fh.gain.value=t.gain)},e.get_filter_params=function(e){return(e=e.Z)&&e.fh?{freq:e.fh.frequency.value,Q:e.fh.Q.value,gain:e.fh.gain.value}:null},e.get_filter_freq_response=function(e,t,a,r){if(!(e=e.Z)||!e.fh)return null;e.fh.getFrequencyResponse(t,a,r)},e.reset=function(){N.length=0,I.length=0,M=null}},a.module.__input=function(e,t){function a(e){var t=U.detect_mobile();return!(!(20!=e||navigator.getVRDevices||navigator.getVRDisplays||t&&D())||!(10!=e||t&&window.DeviceOrientationEvent))}function r(e,t){if(!a(e))return null;var r={type:e,ag:!1,Ig:[],qh:[],lj:[],Vd:[],mj:[],nj:[],Wq:[],xF:[],fj:[],Hj:[],Gj:[],Fj:[],element:t,mi:!0,Xb:[],tv:new Float32Array(2),DR:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Dr:null,Vm:null,wi:null,jd:null,orientation:B.create(),position:X.create(),hh:window.VRFrameData?new VRFrameData:null,SA:j.create(),Xi:new Float32Array(4),Yi:new Float32Array(4),kh:0,Kh:0,Gr:0,il:0,bi:0,Lh:0,Ul:[],fk:[0,0,0,0,0,0,0,0,0,0,0,0],oE:[0,0,0,0,0,0,0,0,0,0,0,0],ku:[]};return r.Xi[0]=r.Xi[1]=r.Xi[2]=r.Xi[3]=Math.PI/4,r.Yi[0]=r.Yi[1]=r.Yi[2]=r.Yi[3]=Math.PI/4,30==e||40==e||50==e?(r.ag=!!t,50==e?document.addEventListener("touchstart",function(){}):40==e&&(r.mi=!1)):10==e?r.ag=!0:20==e&&o(r),r}function n(t,a){10==t||20==t?a=window:a||(a=40==t?document:k.get_container());for(var n=0;n<re.length;n++)if(re[n].type==t&&re[n].element==a)return re[n];return n=r(t,a),60!=t&&70!=t&&80!=t&&90!=t||n.ku.push(e.GMPD_BUTTON_0,e.GMPD_BUTTON_1,e.GMPD_BUTTON_2,e.GMPD_BUTTON_3,e.GMPD_BUTTON_4,e.GMPD_BUTTON_5,e.GMPD_BUTTON_6,e.GMPD_BUTTON_7,e.GMPD_BUTTON_8,e.GMPD_BUTTON_9,e.GMPD_BUTTON_10,e.GMPD_BUTTON_11,e.GMPD_BUTTON_12,e.GMPD_BUTTON_13,e.GMPD_BUTTON_14,e.GMPD_BUTTON_15,e.GMPD_BUTTON_16,e.GMPD_BUTTON_17,e.GMPD_BUTTON_18,e.GMPD_BUTTON_19,e.GMPD_BUTTON_20,e.GMPD_BUTTON_21,e.GMPD_BUTTON_22,e.GMPD_BUTTON_23,e.GMPD_BUTTON_24,e.GMPD_BUTTON_25,e.GMPD_AXIS_0,e.GMPD_AXIS_1,e.GMPD_AXIS_2,e.GMPD_AXIS_3,e.GMPD_AXIS_4,e.GMPD_AXIS_5,e.GMPD_AXIS_6,e.GMPD_AXIS_7,e.GMPD_AXIS_8,e.GMPD_AXIS_9,e.GMPD_AXIS_10,e.GMPD_AXIS_11),n&&re.push(n),n}function o(e){20==e.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(t){0<t.length&&(e.jd=t[0],e.ag=!0,e.jd.getFrameData(e.hh),e.Dr&&e.Dr())},function(){F.da("WebVR displays are not found."),e.ag=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(t){c(e,t),t.length&&(e.ag=!0),e.Dr&&e.Dr()},function(){F.da("WebVR devices are not found."),e.ag=!1}),_(e,W.webvr)):(i(e),e.ag=!0))}function i(e){var t=W.nonwebvr;e.il=t.il,e.bi=t.bi,e.Lh=t.Lh,_(e,t),e.kh=t.kh,e.Kh=t.Kh,e.Gr=t.Gr,s(e)}function _(e,t){e.distortion_coefs[0]=t.distortion_coefs[0],e.distortion_coefs[1]=t.distortion_coefs[1],e.chromatic_aberration_coefs[0]=t.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1]=t.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2]=t.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]=t.chromatic_aberration_coefs[3]}function s(e){var t=Math.atan(e.kh/2/e.Gr*W.nonwebvr.$D);t&&(e.Xi[0]=e.Yi[0]=Math.min(t,Math.PI/3)),t&&(e.Xi[1]=e.Yi[3]=Math.min(t,Math.PI/3)),t&&(e.Xi[2]=e.Yi[2]=Math.min(t,Math.PI/3)),t&&(e.Xi[3]=e.Yi[1]=Math.min(t,Math.PI/3))}function c(e,t){var a=t.filter(function(e){return e instanceof HMDVRDevice}),r=null;a.length&&(r=a[0]),a=null,r&&(a=t.filter(function(e){return-1!==e.deviceName.toLowerCase().indexOf("oculus")&&e.hardwareUnitId==r.hardwareUnitId&&e instanceof PositionSensorVRDevice})),e.Vm=r,e.wi=a}function l(e,t,a){switch(e.type){case 20:var r=u(e,0);if(1&r){var n="left"==t?e.Xi:e.Yi;q.copy(n,a)}else(n=e.jd||e.Vm)&&(n=n.getEyeParameters(t),(n=n.fieldOfView||n.currentFieldOfView)?(a[0]=H.deg_to_rad(n.upDegrees),a[1]=H.deg_to_rad(n.rightDegrees),a[2]=H.deg_to_rad(n.downDegrees),a[3]=H.deg_to_rad(n.leftDegrees)):16&r&&(r=J,"left"==t?G.copy(e.hh.leftProjectionMatrix,r):G.copy(e.hh.rightProjectionMatrix,r),e=G.invert(r,r),X.transformMat4([1,1,-1],e,Z),a[0]=Math.atan(-Z[1]/Z[2]),a[1]=Math.atan(-Z[0]/Z[2]),X.transformMat4([-1,-1,-1],e,Z),a[2]=Math.atan(Z[1]/Z[2]),a[3]=Math.atan(Z[0]/Z[2])));break;default:F.error("fov is undefined for device: ",e.type)}return a}function f(e,t,a){switch(e.type){case 20:e.jd&&("left"==t?G.copy(e.hh.leftProjectionMatrix,a):"right"==t?G.copy(e.hh.rightProjectionMatrix,a):F.error("Unknown type of eye: ",t));break;default:F.error("Projection matrix is undefined for device: ",e.type)}return a}function u(e,t){switch(t){case 0:var a=0;return navigator.getVRDisplays&&(a|=8,e.hh&&(a|=16)),navigator.getVRDevices&&(a=z.is_mobile_device?4|a:2|a),a||1;case 23:var r=e.jd||e.Vm;return r?(a=r.getEyeParameters("left"),r=r.getEyeParameters("right"),e.jd?r.offset[0]-a.offset[0]:r.eyeTranslation.x-a.eyeTranslation.x):e.kh}}function d(e,t){if(e){for(var a=0;a<e.buttons.length;a++)t.Ul[a]=e.buttons[a].value||+e.buttons[a].pressed;if(e.axes)for(a=0;a<e.axes.length;a++)t.fk[a]=e.axes[a];if(a=e.pose){var r=n(20).SA;a.position&&j.transform_vec3(a.position,r,t.position),a.orientation&&j.VH(a.orientation,r,t.orientation)}}}function p(e){for(var t=0;t<e.Ul;t++)e.Ul[t]=0;for(t=0;t<e.fk.length;t++)e.oE[t]=e.fk[t],e.fk[t]=0;e.position.set(H.Ax),e.orientation.set(H.zs)}function m(e,t){var a=e.indexOf(t);0<=a&&(e[a]=null)}function g(e){return null===e}function h(e,t,a,r){switch(t){case 130:a&&m(e.Ig,a),(r||e.qh.every(g)&&e.Ig.every(g))&&(e.Ig.length=0,e.qh.length=0,0<=(t=e.Xb.indexOf(141))&&(e.Xb.splice(t,1),e.element.removeEventListener("deviceorientation",b,!1)));break;case 140:a&&m(e.qh,a),(r||e.qh.every(g)&&e.Ig.every(g))&&(e.Ig.length=0,e.qh.length=0,0<=(t=e.Xb.indexOf(141))&&(e.Xb.splice(t,1),e.element.removeEventListener("deviceorientation",b,!1)));break;case 50:a&&m(e.lj,a),(r||e.lj.every(g))&&(e.lj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("mousedown",T,!1)));break;case 40:a&&m(e.Vd,a),(r||e.Vd.every(g))&&(e.Vd.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("mousemove",A,!1)));break;case 41:a&&m(e.Vd,a),(r||e.Vd.every(g))&&(e.Vd.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("mousemove",x,!1)));break;case 60:a&&m(e.mj,a),(r||e.mj.every(g))&&(e.mj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("mouseout",y,!1),e.element.removeEventListener("mouseup",S,!1)));break;case 70:a&&m(e.nj,a),(r||e.nj.every(g))&&(e.nj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("wheel",O,!1)));break;case 90:a&&m(e.Wq,a),(r||e.Wq.every(g))&&(e.Wq.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("keydown",w,!1)));break;case 80:a&&m(e.fj,a),(r||e.fj.every(g))&&(e.fj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("keyup",R,!1)));break;case 100:a&&m(e.Hj,a),(r||e.Hj.every(g))&&(e.Hj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("touchstart",L,!1)));break;case 110:a&&m(e.Gj,a),(r||e.Gj.every(g))&&(e.Gj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("touchmove",N,!1)));break;case 120:a&&m(e.Fj,a),(r||e.Fj.every(g))&&(e.Fj.length=0,0<=(t=e.Xb.indexOf(t))&&(e.Xb.splice(t,1),e.element.removeEventListener("touchend",I,!1)))}}function v(e,t){if(H.ordered_angles_to_quat(e,H.ZXY,t),"orientation"in window)var a=H.deg_to_rad(window.orientation);else a="orientation"in window.screen?H.deg_to_rad(window.screen.orientation.angle):0;return a=B.setAxisAngle(H.AXIS_MZ,a,Q),B.multiply(t,a,t),t}function b(e){var t=Z;null===e.alpha||null===e.beta||null===e.gamma?t[0]=t[1]=t[2]=0:(t[0]=H.deg_to_rad(e.alpha),t[1]=H.deg_to_rad(e.beta),t[2]=H.deg_to_rad(e.gamma)),e=n(10,e.currentTarget);for(var a=0;a<e.qh.length;a++){var r=e.qh[a];r&&(X.copy(t,ee),r(ee))}if(e.Ig.length)for(t=v(t,K),a=0;a<e.Ig.length;a++)(r=e.Ig[a])&&(B.copy(t,te),r(te));for(a=0;a<e.Ig.length;a++)e.Ig[a]||e.Ig.splice(a,1);for(a=0;a<e.qh.length;a++)e.qh[a]||e.qh.splice(a,1)}function E(e,t){switch(e.type){case 30:e.tv[0]=t.clientX,e.tv[1]=t.clientY,e.DR=t.which}}function A(e){if(!ae||!(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||5==e.mozInputSource)){var t=n(30,e.currentTarget);E(t,e);for(var a=0;a<t.Vd.length;a++){var r=t.Vd[a];r&&($[0]=e.clientX,$[1]=e.clientY,r($))}for(t.mi&&e.preventDefault(),a=0;a<t.Vd.length;a++)t.Vd[a]||t.Vd.splice(a,1)}}function x(e){if(!ae||!(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||5==e.mozInputSource)){var t=n(30,e.currentTarget);E(t,e);for(var a=0;a<t.Vd.length;a++){var r=t.Vd[a];if(r){if("number"==typeof e.movementX)var o=e.movementX,i=e.movementY;else"number"==typeof e.webkitMovementX?(o=e.webkitMovementX,i=e.webkitMovementY):"number"==typeof e.mozMovementX?(o=e.mozMovementX,i=e.mozMovementY):i=o=0;$[0]=o,$[1]=i,r($)}}for(t.mi&&e.preventDefault(),a=0;a<t.Vd.length;a++)t.Vd[a]||t.Vd.splice(a,1)}}function T(e){if(!ae||!(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||5==e.mozInputSource)){var t=n(30,e.currentTarget);E(t,e);for(var a=0;a<t.lj.length;a++){var r=t.lj[a];r&&r(e.which)}for(t.mi&&(window.frameElement&&window.frameElement.focus(),e.preventDefault()),a=0;a<t.lj.length;a++)t.lj[a]||t.lj.splice(a,1)}}function y(e){!k.lF(e.relatedTarget)&&e.which&&S(e)}function S(e){if(!ae||!(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||5==e.mozInputSource)){var t=n(30,e.currentTarget);E(t,e);for(var a=0;a<t.mj.length;a++){var r=t.mj[a];r&&r(e.which)}for(t.mi&&e.preventDefault(),a=0;a<t.mj.length;a++)t.mj[a]||t.mj.splice(a,1)}}function O(e){for(var t=n(30,e.currentTarget),a=0;a<t.nj.length;a++){var r=t.nj[a];if(r){var o;o=e;var i=0;o.wheelDelta?i=o.wheelDelta%120?H.sign(o.wheelDelta):o.wheelDelta/120:o.deltaY&&(i=o.deltaY%3?-H.sign(o.deltaY):-o.deltaY/3),o=H.clamp(100*i,-2e3,2e3),r(o)}}for(t.mi&&e.preventDefault(),a=0;a<t.nj.length;a++)t.nj[a]||t.nj.splice(a,1)}function w(e){for(var t=n(40,e.currentTarget),a=e.ctrlKey||e.altKey||e.metaKey?t.xF:t.Wq,r=0;r<a.length;r++){var o=a[r];o?o(e.keyCode):a.splice(r--,1)}t.mi&&e.preventDefault()}function R(e){for(var t=n(40,e.currentTarget),a=0;a<t.fj.length;a++){var r=t.fj[a];r&&r(e.keyCode)}for(t.mi&&e.preventDefault(),a=0;a<t.fj.length;a++)t.fj[a]||t.fj.splice(a,1)}function L(e){for(var t=n(50,e.currentTarget),a=0;a<t.Hj.length;a++){var r=t.Hj[a];r&&r(e.targetTouches)}for(a=0;a<t.Hj.length;a++)t.Hj[a]||t.Hj.splice(a,1)}function N(e){for(var t=n(50,e.currentTarget),a=0;a<t.Gj.length;a++){var r=t.Gj[a];r&&r(e.targetTouches)}for(t.mi&&e.preventDefault(),a=0;a<t.Gj.length;a++)t.Gj[a]||t.Gj.splice(a,1)}function I(e){for(var t=n(50,e.currentTarget),a=0;a<t.Fj.length;a++){var r=t.Fj[a];r&&r(e.targetTouches)}for(a=0;a<t.Fj.length;a++)t.Fj[a]||t.Fj.splice(a,1)}function M(e){switch(e){case 0:e=60;break;case 1:e=70;break;case 2:e=80;break;case 3:e=90;break;default:e=60}return e}function C(e){function t(){document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a?e.value=1:(e.value=0,document.removeEventListener("pointerlockchange",t,!1),document.removeEventListener("webkitpointerlockchange",t,!1),document.removeEventListener("mozpointerlockchange",t,!1))}var a=e.element;document.addEventListener("pointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1);var r=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof r&&r.apply(a)}function D(){return!!(window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled)}var U=t("__compat"),k=t("__container"),P=t("__config"),G=t("__mat4"),F=t("__print"),j=t("__tsr"),B=t("__quat"),H=t("__util"),X=t("__vec3"),q=t("__vec4"),z=P.H,W=P.$E,Y=j.create(),V=j.create(),J=G.create();e.DEVICE_GYRO=10,e.DEVICE_HMD=20,e.DEVICE_MOUSE=30,e.DEVICE_KEYBOARD=40,e.DEVICE_TOUCH=50,e.vs=60,e.px=70,e.qx=80,e.rx=90,e.HMD_WEBVR_DESKTOP=2,e.HMD_WEBVR_MOBILE=4,e.HMD_NON_WEBVR=1,e.HMD_WEBVR1=8,e.HMD_WEBVR1_1=16,e.HMD_WEBVR_TYPE=0,e.HMD_ORIENTATION_QUAT=10,e.HMD_POSITION=20,e.KB=21,e.LB=22,e.HMD_EYE_DISTANCE=23,e.HMD_DISTORTION=24,e.HMD_BASELINE_DIST=25,e.HMD_SCREEN_LENS_DIST=26,e.HMD_SCREEN_WIDTH=27,e.HMD_SCREEN_HEIGHT=28,e.HMD_BEVEL_SIZE=29,e.TV=30,e.UV=31,e.MOUSE_LOCATION=40,e.TB=41,e.MOUSE_DOWN_WHICH=50,e.MOUSE_UP_WHICH=60,e.MOUSE_WHEEL=70,e.KEYBOARD_UP=80,e.KEYBOARD_DOWN=90,e.SB=91,e.TOUCH_START=100,e.TOUCH_MOVE=110,e.TOUCH_END=120,e.GYRO_ORIENTATION_QUAT=130,e.GYRO_ORIENTATION_ANGLES=140,e.GMPD_BUTTON_0=300,e.GMPD_BUTTON_1=301,e.GMPD_BUTTON_2=302,e.GMPD_BUTTON_3=303,e.GMPD_BUTTON_4=304,e.GMPD_BUTTON_5=305,e.GMPD_BUTTON_6=306,e.GMPD_BUTTON_7=307,e.GMPD_BUTTON_8=308,e.GMPD_BUTTON_9=309,e.GMPD_BUTTON_10=310,e.GMPD_BUTTON_11=311,e.GMPD_BUTTON_12=312,e.GMPD_BUTTON_13=313,e.GMPD_BUTTON_14=314,e.GMPD_BUTTON_15=315,e.GMPD_BUTTON_16=316,e.GMPD_BUTTON_17=317,e.GMPD_BUTTON_18=318,e.GMPD_BUTTON_19=319,e.GMPD_BUTTON_20=320,e.GMPD_BUTTON_21=321,e.GMPD_BUTTON_22=322,e.GMPD_BUTTON_23=323,e.GMPD_BUTTON_24=324,e.GMPD_BUTTON_25=325,e.GMPD_TRACKPAD_BUTTON=300,e.GMPD_TRIGGER_BUTTON=301,e.GMPD_GRIPS_BUTTON=302,e.GMPD_MENU_BUTTON=303,e.GMPD_AXIS_0=326,e.GMPD_AXIS_1=327,e.GMPD_AXIS_2=328,e.GMPD_AXIS_3=329,e.GMPD_AXIS_4=330,e.GMPD_AXIS_5=331,e.GMPD_AXIS_6=332,e.GMPD_AXIS_7=333,e.GMPD_AXIS_8=334,e.GMPD_AXIS_9=335,e.GMPD_AXIS_10=336,e.GMPD_AXIS_11=337;var K=B.create(),Q=B.create(),Z=X.create(),$=new Float32Array(2),ee=X.create(),te=B.create(),ae="ontouchstart"in document.documentElement,re=[];e.can_use_device=a,e.init=function(){if("HMD"==z.stereo||"NONE"==z.stereo&&z.is_mobile_device){var e=n(20);e&&document.addEventListener("onvrdisplayconnect",function(t){e.jd=t.display,e.ag=!0,e.jd.getFrameData(e.hh)})}},e.get_device_by_type_element=n,e.FS=o,e.switch_prevent_default=function(e,t){e.mi=t},e.reset_device=function(e){switch(e.type){case 20:if(e.ag)if(e.jd)e.jd.resetPose();else if(e.wi)for(var t=0;t<e.wi.length;t++)e.wi[t].resetSensor();break;default:F.error("reset_device() is undefined for device: ",e.type)}},e.get_vector_param=function(e,t,a){switch(t){case 10:e:switch(e.type){case 20:if(X.copy(H.zs,a),e.jd)a[0]=e.orientation[0],a[1]=e.orientation[1],a[2]=e.orientation[2],a[3]=e.orientation[3];else if(e.wi)for(t=0;t<e.wi.length;t++){var r=e.wi[t],r=r.getState&&r.getState()||r.getImmediateState&&r.getImmediateState();r.orientation&&(a[0]=r.orientation.x,a[1]=r.orientation.y,a[2]=r.orientation.z,a[3]=r.orientation.w)}e=a;break e;default:F.error("orientation_quat is undefined for device: ",e.type),e=a}return e;case 20:e:switch(e.type){case 20:if(X.copy(H.Bx,a),e.jd)a[0]=e.position[0],a[1]=e.position[1],a[2]=e.position[2];else if(e.wi)for(t=0;t<e.wi.length;t++)r=e.wi[t],r=r.getState&&r.getState()||r.getImmediateState&&r.getImmediateState(),r.position&&(a[0]=r.position.x,a[1]=-r.position.z,a[2]=r.position.y);e=a;break e;default:F.error("position is undefined for device: ",e.type),e=a}return e;case 21:return l(e,"left",a);case 22:return l(e,"right",a);case 30:return f(e,"left",a);case 31:return f(e,"right",a);case 40:case 41:return a[0]=e.tv[0],a[1]=e.tv[1],a}},e.get_value_param=u,e.set_config=function(e,t,a){switch(e.type){case 20:if(8&u(e,0))break;switch(t){case 24:e.distortion_coefs[0]=a[0],e.distortion_coefs[1]=a[1];break;case 23:e.kh=a,s(e);break;case 25:e.Kh=a,s(e);break;case 26:e.Gr=a,s(e);break;case 27:e.il=a,s(e);break;case 28:e.bi=a,s(e);break;case 29:e.Lh=a,s(e)}break;case 60:case 70:case 80:case 90:e.ku[t]=a}},e.OP=function(e,t){var a=t-300;return a<e.Ul.length&&e.Ul[e.ku[a]-300]},e.NP=function(e,t){return t-326<e.fk.length?e.fk[e.ku[t-300]-326]:0},e.get_gamepad_position=function(e,t){return t.set(e.position),t},e.get_gamepad_orientation=function(e,t){return t.set(e.orientation),t},e.update=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<re.length;t++){var a=re[t];switch(a.type){case 60:p(a),d(e[0],a);break;case 70:p(a),d(e[1],a);break;case 80:p(a),d(e[2],a);break;case 90:p(a),d(e[3],a);break;case 20:if(a.jd){var r=a.jd;if(a.hh&&r.getFrameData(a.hh)){var n=a.hh.pose,o=H.Dz(a.hh.leftViewMatrix,Z);a.kh=2*X.length(o)}else n=r.getPose();n&&(o=B.setAxisAngle(H.AXIS_X,Math.PI/2,K),r.stageParameters&&r.stageParameters.sittingToStandingTransform?(r=j.from_mat4(r.stageParameters.sittingToStandingTransform,Y),j.identity(V),o=j.set_quat(o,V),r=j.multiply(o,r,a.SA)):(j.identity(Y),r=j.set_quat(o,a.SA)),n.orientation&&j.VH(n.orientation,r,a.orientation),n.position&&j.transform_vec3(n.position,r,a.position))}}}},e.attach_param_cb=function(e,t,a){switch(t){case 130:e.Ig.push(a),t=141;break;case 140:e.qh.push(a),t=141;break;case 50:e.lj.push(a);break;case 40:case 41:e.Vd.push(a);break;case 60:e.mj.push(a);break;case 70:e.nj.push(a);break;case 90:e.Wq.push(a);break;case 91:e.xF.push(a),t=90;break;case 80:e.fj.push(a);break;case 100:e.Hj.push(a);break;case 110:e.Gj.push(a);break;case 120:e.Fj.push(a)}if(-1==e.Xb.indexOf(t)&&(e.Xb.push(t),e.ag))switch(t){case 50:/iPad|iPhone|iPod/.test(navigator.platform)||e.element.addEventListener("mousedown",T,!1);break;case 40:e.element.addEventListener("mousemove",A,!1);break;case 41:e.element.addEventListener("mousemove",x,!1);break;case 60:/iPad|iPhone|iPod/.test(navigator.platform)||(e.element!=window&&e.element.addEventListener("mouseout",y,!1),e.element.addEventListener("mouseup",S,!1));break;case 70:e.element.addEventListener("wheel",O,!1);break;case 90:e.element.addEventListener("keydown",w,!1);break;case 80:e.element.addEventListener("keyup",R,!1);break;case 100:e.element.addEventListener("touchstart",L,!1);break;case 110:e.element.addEventListener("touchmove",N,!1);break;case 120:e.element.addEventListener("touchend",I,!1);break;case 141:e.element.addEventListener("deviceorientation",b,!1)}},e.detach_param_cb=function(e,t,a){h(e,t,a,!1)},e.gQ=v,e.cleanup=function(){for(var e=0;e<re.length;e++)for(var t=re[e],a=0;a<t.Xb.length;a++)h(t,t.Xb[a],null,!0);re.length=0},e.get_pressed_gmpd_btn=function(e){e=n(M(e));for(var t=0;t<e.Ul.length;t++)if(e.Ul[t])return t+300;return-1},e.get_moved_gmpd_axis=function(e){e=n(M(e));for(var t=0;t<e.fk.length;t++)if(e.oE[t]-e.fk[t])return t+326;return-1},e.pu=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)if(e[t])return t;return 0},e.dQ=function(){var e=n(20);return e&&e.jd},e.bL=function(e){e.element.addEventListener("mousedown",function(){e.value||C(e)},!1)},e.add_click_listener=function(e,t){z.is_mobile_device?e.addEventListener("touchend",t):e.addEventListener("mouseup",t)},e.remove_click_listener=function(e,t){z.is_mobile_device?e.removeEventListener("touchend",t):e.removeEventListener("mouseup",t)},e.check_fullscreen=D},a.module.__tbn=function(e,t){function a(e,t,a){return e=c(e,t||0,a),d.normalize(e,a),a}function r(e,t,a){a=a||0;var r=c(e,a,T),n=d.length(r),o=h.sign(r[3])*h.sign(t[3])||1;return d.scale(t,o*n,r),31e-6>Math.abs(r[3])&&(r[3]=0<r[3]?31e-6:-31e-6),l(e,r,a),e}function n(e,t){return h.sign(e[4*(t||0)+3])}function o(e,t,a){a=a||0;var r=c(e,a,T);0>h.sign(r[3])*t&&d.scale(r,-1,r),l(e,r,a)}function i(e,t,a){a=a||0;var r=c(e,a,T);d.normalize(r,r),d.scale(r,t,r),31e-6>Math.abs(r[3])&&(r[3]=0<r[3]?r[3]+31e-6:r[3]-31e-6),l(e,r,a)}function _(e,t){var a=c(e,t||0,T);return d.length(a)}function s(e){e=0!==e?e||1:0;for(var t=new Float32Array(4*e),a=0;a<e;a++)t[4*a+3]=.5;return t}function c(e,t,a){return a[0]=e[4*t],a[1]=e[4*t+1],a[2]=e[4*t+2],a[3]=e[4*t+3],a}function l(e,t,a){return e[4*a]=t[0],e[4*a+1]=t[1],e[4*a+2]=t[2],e[4*a+3]=t[3],e}function f(e){return e.length/4}function u(e,t,s){for(var c=f(e),l=0;l<c;l++){var u=n(e,l),p=_(e,l),m=a(e,l,b),m=d.multiply(t,m,b);r(s,m,l),i(s,p,l),o(s,u,l)}}e.fC=4;var d=t("__quat"),p=t("__tsr"),m=t("__vec3"),g=t("__vec4"),h=t("__util"),v=d.create(),b=d.create(),E=m.create(),A=m.create(),x=m.create(),T=g.create(),y=g.create();e.Tl=function(e,t,a){var n=!(!t||!t.length),_=e.length/3;a=a||s(_);for(var c=0;c<_;++c){var l=E;if(l[0]=e[3*c],l[1]=e[3*c+1],l[2]=e[3*c+2],m.normalize(l,l),n){var f=y;f[0]=t[4*c],f[1]=t[4*c+1],f[2]=t[4*c+2],f[3]=t[4*c+3],m.normalize(f,f);var u=m.cross(f,l,A);m.normalize(u,u);var p=d.rotationTo(h.AXIS_Z,u,v),g=m.transformQuat(h.AXIS_Y,p,x),g=d.rotationTo(g,l,b),p=d.multiply(g,p,v);d.normalize(p,p),g=.5,u=m.cross(l,u,x),(31e-6<Math.abs(u[0]-f[0])||31e-6<Math.abs(u[1]-f[1])||31e-6<Math.abs(u[2]-f[2]))&&(g=Math.acos(m.dot(l,f))/Math.PI),r(a,p,c),o(a,h.sign(f[3]),c),i(a,g,c)}else p=d.rotationTo(h.AXIS_Y,l,v),r(a,p,c)}return a},e.copy=function(e,t,a,r){if(0!==a){t=4*t||0,a=a||e.length;for(var n=0,o=0;n<4*a;n+=4,o+=4)r[o]=e[t+n],r[o+1]=e[t+n+1],r[o+2]=e[t+n+2],r[o+3]=e[t+n+3]}},e.mb=a,e.set_quat=r,e.WP=function(e,t,r){return e=a(e,t,v),m.transformQuat(h.AXIS_Y,e,r)},e.create=s,e.identity=function(e){for(var t=0;t<e.length;t+=4)e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=.5;return e},e.Wl=c,e.oi=l,e.tu=f,e.Sz=u,e.WF=function(e,t,a){t=p.mb(t,v),u(e,t,a)},e.slerp=function(e,t,s,c){var l=n(t,0),f=a(e,0,v),u=a(t,0,b);return e=_(e),t=_(t),f=d.slerp(f,u,s,b),d.normalize(f,f),r(c,f,0),i(c,s*(e-t)+t),o(c,l,0),c},e.vv=function(e,t,s){var c=n(t,0),l=a(e,0,v),f=a(t,0,b);return e=_(e,0),t=_(t,0),l=d.multiply(l,f,v),r(s,l,0),i(s,e+t-.5),o(s,c,0),s},e.FR=function(e,t,s){var c=n(t,0),l=a(e,0,v),f=a(t,0,b);e=_(e),t=_(t),f=d.invert(f,b),l=d.multiply(l,f,v),r(s,l,0),i(s,e-t+.5),o(s,c,0)}},a.module.__vec3=function(e){var t="undefined"!==typeof Float32Array?Float32Array:Array,a=Math.random;e.create=function(){var e=new t(3);return e[0]=0,e[1]=0,e[2]=0,e},e.clone=function(e){var a=new t(3);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a},e.fromValues=function(e,a,r){var n=new t(3);return n[0]=e,n[1]=a,n[2]=r,n},e.copy=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(e,t,a,r){return r[0]=e,r[1]=t,r[2]=a,r},e.add=function(e,t,a){return a[0]=e[0]+t[0],a[1]=e[1]+t[1],a[2]=e[2]+t[2],a},e.subtract=function(e,t,a){return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],a},e.sub=e.subtract,e.multiply=function(e,t,a){return a[0]=e[0]*t[0],a[1]=e[1]*t[1],a[2]=e[2]*t[2],a},e.mul=e.multiply,e.divide=function(e,t,a){return a[0]=e[0]/t[0],a[1]=e[1]/t[1],a[2]=e[2]/t[2],a},e.div=e.divide,e.min=function(e,t,a){return a[0]=Math.min(e[0],t[0]),a[1]=Math.min(e[1],t[1]),a[2]=Math.min(e[2],t[2]),a},e.max=function(e,t,a){return a[0]=Math.max(e[0],t[0]),a[1]=Math.max(e[1],t[1]),a[2]=Math.max(e[2],t[2]),a},e.scale=function(e,t,a){return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*t,a},e.scaleAndAdd=function(e,t,a,r){return r[0]=e[0]+t[0]*a,r[1]=e[1]+t[1]*a,r[2]=e[2]+t[2]*a,r},e.distance=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(a*a+r*r+n*n)},e.dist=e.distance,e.squaredDistance=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return a*a+r*r+n*n},e.sqrDist=e.squaredDistance,e.length=function(e){var t=e[0],a=e[1];return e=e[2],Math.sqrt(t*t+a*a+e*e)},e.len=e.length,e.squaredLength=function(e){var t=e[0],a=e[1];return e=e[2],t*t+a*a+e*e},e.sqrLen=e.squaredLength,e.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=function(e,t){var a=e[0],r=e[1],n=e[2],a=a*a+r*r+n*n;return 0<a&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.cross=function(e,t,a){var r=e[0],n=e[1];e=e[2];var o=t[0],i=t[1];return t=t[2],a[0]=n*t-e*i,a[1]=e*o-r*t,a[2]=r*i-n*o,a},e.lerp=function(e,t,a,r){var n=e[0],o=e[1];return e=e[2],r[0]=n+a*(t[0]-n),r[1]=o+a*(t[1]-o),r[2]=e+a*(t[2]-e),r},e.OX=function(e,t,a,r,n,o){var i=n*n,_=i*(2*n-3)+1,s=i*(n-2)+n,c=i*(n-1);return n=i*(3-2*n),o[0]=e[0]*_+t[0]*s+a[0]*c+r[0]*n,o[1]=e[1]*_+t[1]*s+a[1]*c+r[1]*n,o[2]=e[2]*_+t[2]*s+a[2]*c+r[2]*n,o},e.NC=function(e,t,a,r,n,o){var i=1-n,_=i*i,s=n*n,c=_*i,_=3*n*_,i=3*s*i;return n*=s,o[0]=e[0]*c+t[0]*_+a[0]*i+r[0]*n,o[1]=e[1]*c+t[1]*_+a[1]*i+r[1]*n,o[2]=e[2]*c+t[2]*_+a[2]*i+r[2]*n,o},e.random=function(e,t){e=e||1;var r=2*a()*Math.PI,n=2*a()-1,o=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*e,t},e.transformMat4=function(e,t,a){var r=e[0],n=e[1];e=e[2];var o=t[3]*r+t[7]*n+t[11]*e+t[15],o=o||1;return a[0]=(t[0]*r+t[4]*n+t[8]*e+t[12])/o,a[1]=(t[1]*r+t[5]*n+t[9]*e+t[13])/o,a[2]=(t[2]*r+t[6]*n+t[10]*e+t[14])/o,a},e.transformMat3=function(e,t,a){var r=e[0],n=e[1];return e=e[2],a[0]=r*t[0]+n*t[3]+e*t[6],a[1]=r*t[1]+n*t[4]+e*t[7],a[2]=r*t[2]+n*t[5]+e*t[8],a},e.transformQuat=function(e,t,a){var r=e[0],n=e[1],o=e[2];e=t[0];var i=t[1],_=t[2];t=t[3];var s=t*r+i*o-_*n,c=t*n+_*r-e*o,l=t*o+e*n-i*r,r=-e*r-i*n-_*o;return a[0]=s*t+r*-e+c*-_-l*-i,a[1]=c*t+r*-i+l*-e-s*-_,a[2]=l*t+r*-_+s*-i-c*-e,a},e.rotateX=function(e,t,a,r){var n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[0],o[1]=n[1]*Math.cos(a)-n[2]*Math.sin(a),o[2]=n[1]*Math.sin(a)+n[2]*Math.cos(a),r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},e.rotateY=function(e,t,a,r){var n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[2]*Math.sin(a)+n[0]*Math.cos(a),o[1]=n[1],o[2]=n[2]*Math.cos(a)-n[0]*Math.sin(a),r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},e.rotateZ=function(e,t,a,r){var n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[0]*Math.cos(a)-n[1]*Math.sin(a),o[1]=n[0]*Math.sin(a)+n[1]*Math.cos(a),o[2]=n[2],r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},e.forEach=function(){var t=e.create();return function(e,a,r,n,o,i){var _;for(a||(a=3),r||(r=0),_=n?Math.min(n*a+r,e.length):e.length;r<_;r+=a)t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],o(t,i,t),e[r]=t[0],e[r+1]=t[1],e[r+2]=t[2];return e}}(),e.angle=function(t,a){var r=e.fromValues(t[0],t[1],t[2]),n=e.fromValues(a[0],a[1],a[2]);return e.normalize(r,r),e.normalize(n,n),r=e.dot(r,n),1<r?0:Math.acos(r)},e.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}},a.module.vec3=a.module.__vec3,a.module.__vec4=function(e){var t="undefined"!==typeof Float32Array?Float32Array:Array,a=Math.random;e.create=function(){var e=new t(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},e.clone=function(e){var a=new t(4);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a},e.fromValues=function(e,a,r,n){var o=new t(4);return o[0]=e,o[1]=a,o[2]=r,o[3]=n,o},e.copy=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(e,t,a,r,n){return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n},e.add=function(e,t,a){return a[0]=e[0]+t[0],a[1]=e[1]+t[1],a[2]=e[2]+t[2],a[3]=e[3]+t[3],a},e.subtract=function(e,t,a){return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],a[3]=e[3]-t[3],a},e.sub=e.subtract,e.multiply=function(e,t,a){return a[0]=e[0]*t[0],a[1]=e[1]*t[1],a[2]=e[2]*t[2],a[3]=e[3]*t[3],a},e.mul=e.multiply,e.divide=function(e,t,a){return a[0]=e[0]/t[0],a[1]=e[1]/t[1],a[2]=e[2]/t[2],a[3]=e[3]/t[3],a},e.div=e.divide,e.min=function(e,t,a){return a[0]=Math.min(e[0],t[0]),a[1]=Math.min(e[1],t[1]),a[2]=Math.min(e[2],t[2]),a[3]=Math.min(e[3],t[3]),a},e.max=function(e,t,a){return a[0]=Math.max(e[0],t[0]),a[1]=Math.max(e[1],t[1]),a[2]=Math.max(e[2],t[2]),a[3]=Math.max(e[3],t[3]),a},e.scale=function(e,t,a){return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*t,a[3]=e[3]*t,a},e.scaleAndAdd=function(e,t,a,r){return r[0]=e[0]+t[0]*a,r[1]=e[1]+t[1]*a,r[2]=e[2]+t[2]*a,r[3]=e[3]+t[3]*a,r},e.distance=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(a*a+r*r+n*n+o*o)},e.dist=e.distance,e.squaredDistance=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return a*a+r*r+n*n+o*o},e.sqrDist=e.squaredDistance,e.length=function(e){var t=e[0],a=e[1],r=e[2];return e=e[3],Math.sqrt(t*t+a*a+r*r+e*e)},e.len=e.length,e.squaredLength=function(e){var t=e[0],a=e[1],r=e[2];return e=e[3],t*t+a*a+r*r+e*e},e.sqrLen=e.squaredLength,e.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=a*a+r*r+n*n+o*o;return 0<i&&(i=1/Math.sqrt(i),t[0]=a*i,t[1]=r*i,t[2]=n*i,t[3]=o*i),t},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.lerp=function(e,t,a,r){var n=e[0],o=e[1],i=e[2];return e=e[3],r[0]=n+a*(t[0]-n),r[1]=o+a*(t[1]-o),r[2]=i+a*(t[2]-i),r[3]=e+a*(t[3]-e),r},e.random=function(t,r){return t=t||1,r[0]=a(),r[1]=a(),r[2]=a(),r[3]=a(),e.normalize(r,r),e.scale(r,t,r),r},e.transformMat4=function(e,t,a){var r=e[0],n=e[1],o=e[2];return e=e[3],a[0]=t[0]*r+t[4]*n+t[8]*o+t[12]*e,a[1]=t[1]*r+t[5]*n+t[9]*o+t[13]*e,a[2]=t[2]*r+t[6]*n+t[10]*o+t[14]*e,a[3]=t[3]*r+t[7]*n+t[11]*o+t[15]*e,a},e.transformQuat=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=t[0],_=t[1],s=t[2];t=t[3];var c=t*r+_*o-s*n,l=t*n+s*r-i*o,f=t*o+i*n-_*r,r=-i*r-_*n-s*o;return a[0]=c*t+r*-i+l*-s-f*-_,a[1]=l*t+r*-_+f*-i-c*-s,a[2]=f*t+r*-s+c*-_-l*-i,a[3]=e[3],a},e.forEach=function(){var t=e.create();return function(e,a,r,n,o,i){var _;for(a||(a=4),r||(r=0),_=n?Math.min(n*a+r,e.length):e.length;r<_;r+=a)t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],o(t,i,t),e[r]=t[0],e[r+1]=t[1],e[r+2]=t[2],e[r+3]=t[3];return e}}(),e.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}},a.module.vec4=a.module.__vec4,a.module.__quat=function(e,t){var a=t("__vec3"),r=t("__vec4"),n=t("__mat3"),o="undefined"!==typeof Float32Array?Float32Array:Array;e.create=function(){var e=new o(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},e.rotationTo=function(){var t=a.create(),r=a.fromValues(1,0,0),n=a.fromValues(0,1,0);return function(o,i,_){var s=a.dot(o,i);return-.9999999>s?(a.cross(r,o,t),1e-6>a.length(t)&&a.cross(n,o,t),a.normalize(t,t),e.setAxisAngle(t,Math.PI,_),_):.9999999<s?(_[0]=0,_[1]=0,_[2]=0,_[3]=1,_):(a.cross(o,i,t),_[0]=t[0],_[1]=t[1],_[2]=t[2],_[3]=1+s,e.normalize(_,_))}}(),e.setAxes=function(){var t=n.create();return function(a,r,n,o){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-a[0],t[5]=-a[1],t[8]=-a[2],e.normalize(e.fromMat3(t,o),o)}}(),e.clone=r.clone,e.fromValues=r.fromValues,e.copy=r.copy,e.set=r.set,e.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},e.setAxisAngle=function(e,t,a){t*=.5;var r=Math.sin(t);return a[0]=r*e[0],a[1]=r*e[1],a[2]=r*e[2],a[3]=Math.cos(t),a},e.add=r.add,e.multiply=function(e,t,a){var r=e[0],n=e[1],o=e[2];e=e[3];var i=t[0],_=t[1],s=t[2];return t=t[3],a[0]=r*t+e*i+n*s-o*_,a[1]=n*t+e*_+o*i-r*s,a[2]=o*t+e*s+r*_-n*i,a[3]=e*t-r*i-n*_-o*s,a},e.mul=e.multiply,e.scale=r.scale,e.rotateX=function(e,t,a){t*=.5;var r=e[0],n=e[1],o=e[2];e=e[3];var i=Math.sin(t);return t=Math.cos(t),a[0]=r*t+e*i,a[1]=n*t+o*i,a[2]=o*t-n*i,a[3]=e*t-r*i,a},e.rotateY=function(e,t,a){t*=.5;var r=e[0],n=e[1],o=e[2];e=e[3];var i=Math.sin(t);return t=Math.cos(t),a[0]=r*t-o*i,a[1]=n*t+e*i,a[2]=o*t+r*i,a[3]=e*t-n*i,a},e.rotateZ=function(e,t,a){t*=.5;var r=e[0],n=e[1],o=e[2];e=e[3];var i=Math.sin(t);return t=Math.cos(t),a[0]=r*t+n*i,a[1]=n*t-r*i,a[2]=o*t+e*i,a[3]=e*t-o*i,a},e.calculateW=function(e,t){var a=e[0],r=e[1],n=e[2];return t[0]=a,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-a*a-r*r-n*n)),t},e.dot=r.dot,e.lerp=r.lerp,e.slerp=function(e,t,a,r){var n=e[0],o=e[1],i=e[2];e=e[3];var _=t[0],s=t[1],c=t[2];t=t[3];var l,f,u;return f=n*_+o*s+i*c+e*t,0>f&&(f=-f,_=-_,s=-s,c=-c,t=-t),1e-6<1-f?(l=Math.acos(f),u=Math.sin(l),f=Math.sin((1-a)*l)/u,a=Math.sin(a*l)/u):f=1-a,r[0]=f*n+a*_,r[1]=f*o+a*s,r[2]=f*i+a*c,r[3]=f*e+a*t,r},e.IY=function(){var t=e.create(),a=e.create();return function(r,n,o,i,_,s){return e.slerp(r,i,_,t),e.slerp(n,o,_,a),e.slerp(t,a,2*_*(1-_),s),s}}(),e.invert=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=a*a+r*r+n*n+o*o,i=i?1/i:0;return t[0]=-a*i,t[1]=-r*i,t[2]=-n*i,t[3]=o*i,t},e.conjugate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.length=r.length,e.len=e.length,e.squaredLength=r.squaredLength,e.sqrLen=e.squaredLength,e.normalize=r.normalize,e.fromMat3=function(e,t){var a=e[0]+e[4]+e[8];if(0<a)a=Math.sqrt(a+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var n=(r+1)%3,o=(r+2)%3,a=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*o+o]+1);t[r]=.5*a,a=.5/a,t[3]=(e[3*n+o]-e[3*o+n])*a,t[n]=(e[3*n+r]+e[3*r+n])*a,t[o]=(e[3*o+r]+e[3*r+o])*a}return t},e.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}},a.module.quat=a.module.__quat,a.module.__mat3=function(e){var t="undefined"!==typeof Float32Array?Float32Array:Array;e.create=function(){var e=new t(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromMat4=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(e){var a=new t(9);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a},e.copy=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.transpose=function(e,t){if(t===e){var a=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=a,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],_=e[5],s=e[6],c=e[7],l=e[8],f=l*i-_*c,u=-l*o+_*s,d=c*o-i*s,p=a*f+r*u+n*d;return p?(p=1/p,t[0]=f*p,t[1]=(-l*r+n*c)*p,t[2]=(_*r-n*i)*p,t[3]=u*p,t[4]=(l*a-n*s)*p,t[5]=(-_*a+n*o)*p,t[6]=d*p,t[7]=(-c*a+r*s)*p,t[8]=(i*a-r*o)*p,t):null},e.adjoint=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],_=e[5],s=e[6],c=e[7],l=e[8];return t[0]=i*l-_*c,t[1]=n*c-r*l,t[2]=r*_-n*i,t[3]=_*s-o*l,t[4]=a*l-n*s,t[5]=n*o-a*_,t[6]=o*c-i*s,t[7]=r*s-a*c,t[8]=a*i-r*o,t},e.determinant=function(e){var t=e[3],a=e[4],r=e[5],n=e[6],o=e[7],i=e[8];return e[0]*(i*a-r*o)+e[1]*(-i*t+r*n)+e[2]*(o*t-a*n)},e.multiply=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=e[3],_=e[4],s=e[5],c=e[6],l=e[7];e=e[8];var f=t[0],u=t[1],d=t[2],p=t[3],m=t[4],g=t[5],h=t[6],v=t[7];return t=t[8],a[0]=f*r+u*i+d*c,a[1]=f*n+u*_+d*l,a[2]=f*o+u*s+d*e,a[3]=p*r+m*i+g*c,a[4]=p*n+m*_+g*l,a[5]=p*o+m*s+g*e,a[6]=h*r+v*i+t*c,a[7]=h*n+v*_+t*l,a[8]=h*o+v*s+t*e,a},e.mul=e.multiply,e.translate=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=e[3],_=e[4],s=e[5],c=e[6],l=e[7];e=e[8];var f=t[0];return t=t[1],a[0]=r,a[1]=n,a[2]=o,a[3]=i,a[4]=_,a[5]=s,a[6]=f*r+t*i+c,a[7]=f*n+t*_+l,a[8]=f*o+t*s+e,a},e.rotate=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=e[3],_=e[4],s=e[5],c=e[6],l=e[7];e=e[8];var f=Math.sin(t);return t=Math.cos(t),a[0]=t*r+f*i,a[1]=t*n+f*_,a[2]=t*o+f*s,a[3]=t*i-f*r,a[4]=t*_-f*n,a[5]=t*s-f*o,a[6]=c,a[7]=l,a[8]=e,a},e.scale=function(e,t,a){var r=t[0];return t=t[1],a[0]=r*e[0],a[1]=r*e[1],a[2]=r*e[2],a[3]=t*e[3],a[4]=t*e[4],a[5]=t*e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a},e.aP=function(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.ZO=function(e,t){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=a,t[2]=0,t[3]=-a,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.$O=function(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=a+a,_=r+r,s=n+n,a=a*i,c=r*i,r=r*_,l=n*i,f=n*_,n=n*s,i=o*i,_=o*_,o=o*s;return t[0]=1-r-n,t[3]=c-o,t[6]=l+_,t[1]=c+o,t[4]=1-a-n,t[7]=f-i,t[2]=l-_,t[5]=f+i,t[8]=1-a-r,t},e.normalFromMat4=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],_=e[5],s=e[6],c=e[7],l=e[8],f=e[9],u=e[10],d=e[11],p=e[12],m=e[13],g=e[14],h=e[15],v=a*_-r*i,b=a*s-n*i,E=a*c-o*i,A=r*s-n*_,x=r*c-o*_,T=n*c-o*s,y=l*m-f*p,S=l*g-u*p,l=l*h-d*p,O=f*g-u*m,f=f*h-d*m,u=u*h-d*g,d=v*u-b*f+E*O+A*l-x*S+T*y;return d?(d=1/d,t[0]=(_*u-s*f+c*O)*d,t[1]=(s*l-i*u-c*S)*d,t[2]=(i*f-_*l+c*y)*d,t[3]=(n*f-r*u-o*O)*d,t[4]=(a*u-n*l+o*S)*d,t[5]=(r*l-a*f-o*y)*d,t[6]=(m*T-g*x+h*A)*d,t[7]=(g*E-p*T-h*b)*d,t[8]=(p*x-m*E+h*v)*d,t):null},e.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},e.YO=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}},a.module.mat3=a.module.__mat3,a.module.__mat4=function(e){var t="undefined"!==typeof Float32Array?Float32Array:Array;e.create=function(){var e=new t(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.clone=function(e){var a=new t(16);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},e.copy=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.transpose=function(e,t){if(t===e){var a=e[1],r=e[2],n=e[3],o=e[6],i=e[7],_=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=a,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=i,t[14]=_}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],_=e[5],s=e[6],c=e[7],l=e[8],f=e[9],u=e[10],d=e[11],p=e[12],m=e[13],g=e[14],h=e[15],v=a*_-r*i,b=a*s-n*i,E=a*c-o*i,A=r*s-n*_,x=r*c-o*_,T=n*c-o*s,y=l*m-f*p,S=l*g-u*p,O=l*h-d*p,w=f*g-u*m,R=f*h-d*m,L=u*h-d*g,N=v*L-b*R+E*w+A*O-x*S+T*y;return N?(N=1/N,t[0]=(_*L-s*R+c*w)*N,t[1]=(n*R-r*L-o*w)*N,t[2]=(m*T-g*x+h*A)*N,t[3]=(u*x-f*T-d*A)*N,t[4]=(s*O-i*L-c*S)*N,t[5]=(a*L-n*O+o*S)*N,t[6]=(g*E-p*T-h*b)*N,t[7]=(l*T-u*E+d*b)*N,t[8]=(i*R-_*O+c*y)*N,t[9]=(r*O-a*R-o*y)*N,t[10]=(p*x-m*E+h*v)*N,t[11]=(f*E-l*x-d*v)*N,t[12]=(_*S-i*w-s*y)*N,t[13]=(a*w-r*S+n*y)*N,t[14]=(m*b-p*A-g*v)*N,t[15]=(l*A-f*b+u*v)*N,t):null},e.adjoint=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],_=e[5],s=e[6],c=e[7],l=e[8],f=e[9],u=e[10],d=e[11],p=e[12],m=e[13],g=e[14],h=e[15];return t[0]=_*(u*h-d*g)-f*(s*h-c*g)+m*(s*d-c*u),t[1]=-(r*(u*h-d*g)-f*(n*h-o*g)+m*(n*d-o*u)),t[2]=r*(s*h-c*g)-_*(n*h-o*g)+m*(n*c-o*s),t[3]=-(r*(s*d-c*u)-_*(n*d-o*u)+f*(n*c-o*s)),t[4]=-(i*(u*h-d*g)-l*(s*h-c*g)+p*(s*d-c*u)),t[5]=a*(u*h-d*g)-l*(n*h-o*g)+p*(n*d-o*u),t[6]=-(a*(s*h-c*g)-i*(n*h-o*g)+p*(n*c-o*s)),t[7]=a*(s*d-c*u)-i*(n*d-o*u)+l*(n*c-o*s),t[8]=i*(f*h-d*m)-l*(_*h-c*m)+p*(_*d-c*f),t[9]=-(a*(f*h-d*m)-l*(r*h-o*m)+p*(r*d-o*f)),t[10]=a*(_*h-c*m)-i*(r*h-o*m)+p*(r*c-o*_),t[11]=-(a*(_*d-c*f)-i*(r*d-o*f)+l*(r*c-o*_)),t[12]=-(i*(f*g-u*m)-l*(_*g-s*m)+p*(_*u-s*f)),t[13]=a*(f*g-u*m)-l*(r*g-n*m)+p*(r*u-n*f),t[14]=-(a*(_*g-s*m)-i*(r*g-n*m)+p*(r*s-n*_)),t[15]=a*(_*u-s*f)-i*(r*u-n*f)+l*(r*s-n*_),t},e.determinant=function(e){var t=e[0],a=e[1],r=e[2],n=e[3],o=e[4],i=e[5],_=e[6],s=e[7],c=e[8],l=e[9],f=e[10],u=e[11],d=e[12],p=e[13],m=e[14];return e=e[15],(t*i-a*o)*(f*e-u*m)-(t*_-r*o)*(l*e-u*p)+(t*s-n*o)*(l*m-f*p)+(a*_-r*i)*(c*e-u*d)-(a*s-n*i)*(c*m-f*d)+(r*s-n*_)*(c*p-l*d)},e.multiply=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=e[3],_=e[4],s=e[5],c=e[6],l=e[7],f=e[8],u=e[9],d=e[10],p=e[11],m=e[12],g=e[13],h=e[14];e=e[15];var v=t[0],b=t[1],E=t[2],A=t[3];return a[0]=v*r+b*_+E*f+A*m,a[1]=v*n+b*s+E*u+A*g,a[2]=v*o+b*c+E*d+A*h,a[3]=v*i+b*l+E*p+A*e,v=t[4],b=t[5],E=t[6],A=t[7],a[4]=v*r+b*_+E*f+A*m,a[5]=v*n+b*s+E*u+A*g,a[6]=v*o+b*c+E*d+A*h,a[7]=v*i+b*l+E*p+A*e,v=t[8],b=t[9],E=t[10],A=t[11],a[8]=v*r+b*_+E*f+A*m,a[9]=v*n+b*s+E*u+A*g,a[10]=v*o+b*c+E*d+A*h,a[11]=v*i+b*l+E*p+A*e,v=t[12],b=t[13],E=t[14],A=t[15],a[12]=v*r+b*_+E*f+A*m,a[13]=v*n+b*s+E*u+A*g,a[14]=v*o+b*c+E*d+A*h,a[15]=v*i+b*l+E*p+A*e,a},e.mul=e.multiply,e.translate=function(e,t,a){var r=t[0],n=t[1];t=t[2];var o,i,_,s,c,l,f,u,d,p,m,g;return e===a?(a[12]=e[0]*r+e[4]*n+e[8]*t+e[12],a[13]=e[1]*r+e[5]*n+e[9]*t+e[13],a[14]=e[2]*r+e[6]*n+e[10]*t+e[14],a[15]=e[3]*r+e[7]*n+e[11]*t+e[15]):(o=e[0],i=e[1],_=e[2],s=e[3],c=e[4],l=e[5],f=e[6],u=e[7],d=e[8],p=e[9],m=e[10],g=e[11],a[0]=o,a[1]=i,a[2]=_,a[3]=s,a[4]=c,a[5]=l,a[6]=f,a[7]=u,a[8]=d,a[9]=p,a[10]=m,a[11]=g,a[12]=o*r+c*n+d*t+e[12],a[13]=i*r+l*n+p*t+e[13],a[14]=_*r+f*n+m*t+e[14],a[15]=s*r+u*n+g*t+e[15]),a},e.scale=function(e,t,a){var r=t[0],n=t[1];return t=t[2],a[0]=e[0]*r,a[1]=e[1]*r,a[2]=e[2]*r,a[3]=e[3]*r,a[4]=e[4]*n,a[5]=e[5]*n,a[6]=e[6]*n,a[7]=e[7]*n,a[8]=e[8]*t,a[9]=e[9]*t,a[10]=e[10]*t,a[11]=e[11]*t,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},e.rotate=function(e,t,a,r){var n=a[0],o=a[1];a=a[2];var i,_,s,c,l,f,u,d,p,m,g,h,v,b,E,A,x,T,y,S,O=Math.sqrt(n*n+o*o+a*a);return 1e-7>Math.abs(O)?null:(O=1/O,n*=O,o*=O,a*=O,i=Math.sin(t),_=Math.cos(t),s=1-_,t=e[0],O=e[1],c=e[2],l=e[3],f=e[4],u=e[5],d=e[6],p=e[7],m=e[8],g=e[9],h=e[10],v=e[11],b=n*n*s+_,E=o*n*s+a*i,A=a*n*s-o*i,x=n*o*s-a*i,T=o*o*s+_,y=a*o*s+n*i,S=n*a*s+o*i,n=o*a*s-n*i,o=a*a*s+_,r[0]=t*b+f*E+m*A,r[1]=O*b+u*E+g*A,r[2]=c*b+d*E+h*A,r[3]=l*b+p*E+v*A,r[4]=t*x+f*T+m*y,r[5]=O*x+u*T+g*y,r[6]=c*x+d*T+h*y,r[7]=l*x+p*T+v*y,r[8]=t*S+f*n+m*o,r[9]=O*S+u*n+g*o,r[10]=c*S+d*n+h*o,r[11]=l*S+p*n+v*o,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)},e.rotateX=function(e,t,a){var r=Math.sin(t);t=Math.cos(t);var n=e[4],o=e[5],i=e[6],_=e[7],s=e[8],c=e[9],l=e[10],f=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=n*t+s*r,a[5]=o*t+c*r,a[6]=i*t+l*r,a[7]=_*t+f*r,a[8]=s*t-n*r,a[9]=c*t-o*r,a[10]=l*t-i*r,a[11]=f*t-_*r,a},e.rotateY=function(e,t,a){var r=Math.sin(t);t=Math.cos(t);var n=e[0],o=e[1],i=e[2],_=e[3],s=e[8],c=e[9],l=e[10],f=e[11];return e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=n*t-s*r,a[1]=o*t-c*r,a[2]=i*t-l*r,a[3]=_*t-f*r,a[8]=n*r+s*t,a[9]=o*r+c*t,a[10]=i*r+l*t,a[11]=_*r+f*t,a},e.rotateZ=function(e,t,a){var r=Math.sin(t);t=Math.cos(t);var n=e[0],o=e[1],i=e[2],_=e[3],s=e[4],c=e[5],l=e[6],f=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=n*t+s*r,a[1]=o*t+c*r,a[2]=i*t+l*r,a[3]=_*t+f*r,a[4]=s*t-n*r,a[5]=c*t-o*r,a[6]=l*t-i*r,a[7]=f*t-_*r,a},e.aP=function(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.$O=function(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.ZO=function(e,t,a){var r=t[0],n=t[1];t=t[2];var o,i=Math.sqrt(r*r+n*n+t*t);return 1e-7>Math.abs(i)?null:(i=1/i,r*=i,n*=i,t*=i,i=Math.sin(e),e=Math.cos(e),o=1-e,a[0]=r*r*o+e,a[1]=n*r*o+t*i,a[2]=t*r*o-n*i,a[3]=0,a[4]=r*n*o-t*i,a[5]=n*n*o+e,a[6]=t*n*o+r*i,a[7]=0,a[8]=r*t*o+n*i,a[9]=n*t*o-r*i,a[10]=t*t*o+e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},e.oX=function(e,t){var a=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.pX=function(e,t){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.qX=function(e,t){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(e,t,a){var r=e[0],n=e[1],o=e[2],i=e[3],_=r+r,s=n+n,c=o+o;e=r*_;var l=r*s,r=r*c,f=n*s,n=n*c,o=o*c,_=i*_,s=i*s,i=i*c;return a[0]=1-(f+o),a[1]=l+i,a[2]=r-s,a[3]=0,a[4]=l-i,a[5]=1-(e+o),a[6]=n+_,a[7]=0,a[8]=r+s,a[9]=n-_,a[10]=1-(e+f),a[11]=0,a[12]=t[0],a[13]=t[1],a[14]=t[2],a[15]=1,a},e.mX=function(e,t,a,r){var n=e[0],o=e[1],i=e[2],_=e[3],s=n+n,c=o+o,l=i+i;e=n*s;var f=n*c,n=n*l,u=o*c,o=o*l,i=i*l,s=_*s,c=_*c,_=_*l,l=a[0],d=a[1];return a=a[2],r[0]=(1-(u+i))*l,r[1]=(f+_)*l,r[2]=(n-c)*l,r[3]=0,r[4]=(f-_)*d,r[5]=(1-(e+i))*d,r[6]=(o+s)*d,r[7]=0,r[8]=(n+c)*a,r[9]=(o-s)*a,r[10]=(1-(e+u))*a,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},e.nX=function(e,t,a,r,n){var o=e[0],i=e[1],_=e[2],s=e[3],c=o+o,l=i+i,f=_+_;e=o*c;var u=o*l,o=o*f,d=i*l,i=i*f,_=_*f,c=s*c,l=s*l,s=s*f,f=a[0],p=a[1];a=a[2];var m=r[0],g=r[1];return r=r[2],n[0]=(1-(d+_))*f,n[1]=(u+s)*f,n[2]=(o-l)*f,n[3]=0,n[4]=(u-s)*p,n[5]=(1-(e+_))*p,n[6]=(i+c)*p,n[7]=0,n[8]=(o+l)*a,n[9]=(i-c)*a,n[10]=(1-(e+d))*a,n[11]=0,n[12]=t[0]+m-(n[0]*m+n[4]*g+n[8]*r),n[13]=t[1]+g-(n[1]*m+n[5]*g+n[9]*r),n[14]=t[2]+r-(n[2]*m+n[6]*g+n[10]*r),n[15]=1,n},e.fromQuat=function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=a+a,_=r+r,s=n+n,a=a*i,c=r*i,r=r*_,l=n*i,f=n*_,n=n*s,i=o*i,_=o*_,o=o*s;return t[0]=1-r-n,t[1]=c+o,t[2]=l-_,t[3]=0,t[4]=c-o,t[5]=1-a-n,t[6]=f+i,t[7]=0,t[8]=l+_,t[9]=f-i,t[10]=1-a-r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(e,t,a,r,n,o,i){var _=1/(t-e),s=1/(r-a),c=1/(n-o);return i[0]=2*n*_,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*n*s,i[6]=0,i[7]=0,i[8]=(t+e)*_,i[9]=(r+a)*s,i[10]=(o+n)*c,i[11]=-1,i[12]=0,i[13]=0,i[14]=o*n*2*c,i[15]=0,i},e.perspective=function(e,t,a,r,n){e=1/Math.tan(e/2);var o=1/(a-r);return n[0]=e/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(r+a)*o,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*r*a*o,n[15]=0,n},e.nY=function(e,t,a,r){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180);e=Math.tan(e.rightDegrees*Math.PI/180);var _=2/(i+e),s=2/(n+o);return r[0]=_,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=-(i-e)*_*.5,r[9]=(n-o)*s*.5,r[10]=a/(t-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=a*t/(t-a),r[15]=0,r},e.ortho=function(e,t,a,r,n,o,i){var _=1/(e-t),s=1/(a-r),c=1/(n-o);return i[0]=-2*_,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*c,i[11]=0,i[12]=(e+t)*_,i[13]=(r+a)*s,i[14]=(o+n)*c,i[15]=1,i},e.lookAt=function(t,a,r,n){var o,i,_,s,c,l,f,u,d=t[0],p=t[1];return t=t[2],_=r[0],s=r[1],i=r[2],f=a[0],r=a[1],o=a[2],1e-7>Math.abs(d-f)&&1e-7>Math.abs(p-r)&&1e-7>Math.abs(t-o)?e.identity(n):(a=d-f,r=p-r,f=t-o,u=1/Math.sqrt(a*a+r*r+f*f),a*=u,r*=u,f*=u,o=s*f-i*r,i=i*a-_*f,_=_*r-s*a,(u=Math.sqrt(o*o+i*i+_*_))?(u=1/u,o*=u,i*=u,_*=u):_=i=o=0,s=r*_-f*i,c=f*o-a*_,l=a*i-r*o,(u=Math.sqrt(s*s+c*c+l*l))?(u=1/u,s*=u,c*=u,l*=u):l=c=s=0,n[0]=o,n[1]=s,n[2]=a,n[3]=0,n[4]=i,n[5]=c,n[6]=r,n[7]=0,n[8]=_,n[9]=l,n[10]=f,n[11]=0,n[12]=-(o*d+i*p+_*t),n[13]=-(s*d+c*p+l*t),n[14]=-(a*d+r*p+f*t),n[15]=1,n)},e.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},e.YO=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}},a.module.mat4=a.module.__mat4,a.module.__md5=function(e){function t(e,t){var i=e[0],_=e[1],s=e[2],c=e[3],i=r(i,_,s,c,t[0],7,-680876936),c=r(c,i,_,s,t[1],12,-389564586),s=r(s,c,i,_,t[2],17,606105819),_=r(_,s,c,i,t[3],22,-1044525330),i=r(i,_,s,c,t[4],7,-176418897),c=r(c,i,_,s,t[5],12,1200080426),s=r(s,c,i,_,t[6],17,-1473231341),_=r(_,s,c,i,t[7],22,-45705983),i=r(i,_,s,c,t[8],7,1770035416),c=r(c,i,_,s,t[9],12,-1958414417),s=r(s,c,i,_,t[10],17,-42063),_=r(_,s,c,i,t[11],22,-1990404162),i=r(i,_,s,c,t[12],7,1804603682),c=r(c,i,_,s,t[13],12,-40341101),s=r(s,c,i,_,t[14],17,-1502002290),_=r(_,s,c,i,t[15],22,1236535329),i=n(i,_,s,c,t[1],5,-165796510),c=n(c,i,_,s,t[6],9,-1069501632),s=n(s,c,i,_,t[11],14,643717713),_=n(_,s,c,i,t[0],20,-373897302),i=n(i,_,s,c,t[5],5,-701558691),c=n(c,i,_,s,t[10],9,38016083),s=n(s,c,i,_,t[15],14,-660478335),_=n(_,s,c,i,t[4],20,-405537848),i=n(i,_,s,c,t[9],5,568446438),c=n(c,i,_,s,t[14],9,-1019803690),s=n(s,c,i,_,t[3],14,-187363961),_=n(_,s,c,i,t[8],20,1163531501),i=n(i,_,s,c,t[13],5,-1444681467),c=n(c,i,_,s,t[2],9,-51403784),s=n(s,c,i,_,t[7],14,1735328473),_=n(_,s,c,i,t[12],20,-1926607734),i=a(_^s^c,i,_,t[5],4,-378558),c=a(i^_^s,c,i,t[8],11,-2022574463),s=a(c^i^_,s,c,t[11],16,1839030562),_=a(s^c^i,_,s,t[14],23,-35309556),i=a(_^s^c,i,_,t[1],4,-1530992060),c=a(i^_^s,c,i,t[4],11,1272893353),s=a(c^i^_,s,c,t[7],16,-155497632),_=a(s^c^i,_,s,t[10],23,-1094730640),i=a(_^s^c,i,_,t[13],4,681279174),c=a(i^_^s,c,i,t[0],11,-358537222),s=a(c^i^_,s,c,t[3],16,-722521979),_=a(s^c^i,_,s,t[6],23,76029189),i=a(_^s^c,i,_,t[9],4,-640364487),c=a(i^_^s,c,i,t[12],11,-421815835),s=a(c^i^_,s,c,t[15],16,530742520),_=a(s^c^i,_,s,t[2],23,-995338651),i=o(i,_,s,c,t[0],6,-198630844),c=o(c,i,_,s,t[7],10,1126891415),s=o(s,c,i,_,t[14],15,-1416354905),_=o(_,s,c,i,t[5],21,-57434055),i=o(i,_,s,c,t[12],6,1700485571),c=o(c,i,_,s,t[3],10,-1894986606),s=o(s,c,i,_,t[10],15,-1051523),_=o(_,s,c,i,t[1],21,-2054922799),i=o(i,_,s,c,t[8],6,1873313359),c=o(c,i,_,s,t[15],10,-30611744),s=o(s,c,i,_,t[6],15,-1560198380),_=o(_,s,c,i,t[13],21,1309151649),i=o(i,_,s,c,t[4],6,-145523070),c=o(c,i,_,s,t[11],10,-1120210379),s=o(s,c,i,_,t[2],15,718787259),_=o(_,s,c,i,t[9],21,-343485551);e[0]=i+e[0]&4294967295,e[1]=_+e[1]&4294967295,e[2]=s+e[2]&4294967295,e[3]=c+e[3]&4294967295}function a(e,t,a,r,n,o){return((t=(t+e&4294967295)+(r+o&4294967295)&4294967295)<<n|t>>>32-n)+a&4294967295}function r(e,t,r,n,o,i,_){return a(t&r|~t&n,e,t,o,i,_)}function n(e,t,r,n,o,i,_){return a(t&n|r&~n,e,t,o,i,_)}function o(e,t,r,n,o,i,_){return a(r^(t|~n),e,t,o,i,_)}var i="0123456789abcdef".split("");e.YE=function(e){var a=e,r=a.length;e=[1732584193,-271733879,-1732584194,271733878];var n;for(n=64;n<=a.length;n+=64){var o,_=a.substring(n-64,n),s=[];for(o=0;64>o;o+=4)s[o>>2]=_.charCodeAt(o)+(_.charCodeAt(o+1)<<8)+(_.charCodeAt(o+2)<<16)+(_.charCodeAt(o+3)<<24);t(e,s)}for(a=a.substring(n-64),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<a.length;n++)o[n>>2]|=a.charCodeAt(n)<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),55<n)for(t(e,o),n=0;16>n;n++)o[n]=0;for(o[14]=8*r,t(e,o),a=0;a<e.length;a++){for(r=e[a],n="",o=0;4>o;o++)n+=i[r>>8*o+4&15]+i[r>>8*o&15];e[a]=n}return e.join("")}},a.module.__pako_inflate=function(e){!function(e){var t;t="undefined"!==typeof window?window:"undefined"!==typeof self?self:this,t.SR=function(){return function e(t,a,r){function n(i){if(!a[i]){if(!t[i]){if(o)return o(i,!0);var _=Error("Cannot find module '"+i+"'");throw _.code="MODULE_NOT_FOUND",_}_=a[i]={eh:{}},t[i][0].call(_.eh,function(e){var a=t[i][1][e];return n(a||e)},_,_.eh,e,t,a,r)}return a[i].eh}for(var o=!1,i=0;i<r.length;i++)n(r[i]);return n}({1:[function(e,t,a){e="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array,a.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var a=t.shift();if(a){if("object"!==typeof a)throw new TypeError(a+"must be non-object");for(var r in a)a.hasOwnProperty(r)&&(e[r]=a[r])}}return e},a.sH=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={ul:function(e,t,a,r,n){if(t.subarray&&e.subarray)e.set(t.subarray(a,a+r),n);else for(var o=0;o<r;o++)e[n+o]=t[a+o]},jE:function(e){var t,a,r,n,o;for(t=r=0,a=e.length;t<a;t++)r+=e[t].length;for(o=new Uint8Array(r),t=r=0,a=e.length;t<a;t++)n=e[t],o.set(n,r),r+=n.length;return o}},n={ul:function(e,t,a,r,n){for(var o=0;o<r;o++)e[n+o]=t[a+o]},jE:function(e){return[].concat.apply([],e)}};a.XS=function(e){e?(a.kl=Uint8Array,a.mp=Uint16Array,a.np=Int32Array,a.assign(a,r)):(a.kl=Array,a.mp=Array,a.np=Array,a.assign(a,n))},a.XS(e)},{}],2:[function(e,t,a){function r(e,t){if(65537>t&&(e.subarray&&i||!e.subarray&&o))return String.fromCharCode.apply(null,n.sH(e,t));for(var a="",r=0;r<t;r++)a+=String.fromCharCode(e[r]);return a}var n=e("./common"),o=!0,i=!0,_=new n.kl(256);for(e=0;256>e;e++)_[e]=252<=e?6:248<=e?5:240<=e?4:224<=e?3:192<=e?2:1;_[254]=_[254]=1,a.dU=function(e){var t,a,r,o,i,_=e.length,s=0;for(o=0;o<_;o++)a=e.charCodeAt(o),55296===(64512&a)&&o+1<_&&56320===(64512&(r=e.charCodeAt(o+1)))&&(a=65536+(a-55296<<10)+(r-56320),o++),s+=128>a?1:2048>a?2:65536>a?3:4;for(t=new n.kl(s),o=i=0;i<s;o++)a=e.charCodeAt(o),55296===(64512&a)&&o+1<_&&56320===(64512&(r=e.charCodeAt(o+1)))&&(a=65536+(a-55296<<10)+(r-56320),o++),128>a?t[i++]=a:(2048>a?t[i++]=192|a>>>6:(65536>a?t[i++]=224|a>>>12:(t[i++]=240|a>>>18,t[i++]=128|a>>>12&63),t[i++]=128|a>>>6&63),t[i++]=128|63&a);return t},a.OW=function(e){return r(e,e.length)},a.SL=function(e){for(var t=new n.kl(e.length),a=0,r=t.length;a<r;a++)t[a]=e.charCodeAt(a);return t},a.aM=function(e,t){var a,n,o,i,s=t||e.length,c=Array(2*s);for(a=n=0;a<s;)if(128>(o=e[a++]))c[n++]=o;else if(4<(i=_[o]))c[n++]=65533,a+=i-1;else{for(o&=2===i?31:3===i?15:7;1<i&&a<s;)o=o<<6|63&e[a++],i--;1<i?c[n++]=65533:65536>o?c[n++]=o:(o-=65536,c[n++]=55296|o>>10&1023,c[n++]=56320|1023&o)}return r(c,n)},a.mV=function(e,t){var a;for(t=t||e.length,t>e.length&&(t=e.length),a=t-1;0<=a&&128===(192&e[a]);)a--;return 0>a||!a?t:a+_[e[a]]>t?a:t}},{"./common":1}],3:[function(e,t){t.eh=function(e,t,a,r){var n=65535&e|0;e=e>>>16&65535|0;for(var o;0!==a;){o=2e3<a?2e3:a,a-=o;do{n=n+t[r++]|0,e=e+n|0}while(--o);n%=65521,e%=65521}return n|e<<16|0}},{}],4:[function(e,t){t.eh={nC:0,uW:1,oC:2,rW:3,Js:4,jW:5,yW:6,bn:0,Ks:1,XK:2,oW:-1,wW:-2,kW:-3,WK:-5,tW:0,hW:1,gW:9,lW:-1,pW:1,sW:2,vW:3,qW:4,mW:0,iW:0,xW:1,zW:2,nW:8}},{}],5:[function(e,t){var a=function(){for(var e,t=[],a=0;256>a;a++){e=a;for(var r=0;8>r;r++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t}();t.eh=function(e,t,r,n){for(r=n+r,e^=-1;n<r;n++)e=e>>>8^a[255&(e^t[n])];return-1^e}},{}],6:[function(e,t){t.eh=function(){this.OR=this.DV=this.time=this.text=0,this.od=null,this.Fy=0,this.jy=this.name="",this.lQ=0,this.done=!1}},{}],7:[function(e,t){t.eh=function(e,t){var a,r,n,o,i,_,s,c,l,f,u,d,p,m,g,h,v,b,E,A,x,T,y,S;a=e.state,r=e.xk,y=e.input,n=r+(e.Hf-5),o=e.me,S=e.th,i=o-(t-e.md),_=o+(e.md-257),s=a.Pt,c=a.Af,l=a.Oj,f=a.zf,u=a.window,d=a.hk,p=a.Vc,m=a.hj,g=a.Ll,h=(1<<a.ei)-1,v=(1<<a.zn)-1;e:do{t:for(15>p&&(d+=y[r++]<<p,p+=8,d+=y[r++]<<p,p+=8),b=m[d&h];;){if(E=b>>>24,d>>>=E,p-=E,E=b>>>16&255){if(!(16&E)){if(64&E){32&E?a.mode=12:(e.msg="invalid literal/length code",a.mode=30);break e}b=m[(65535&b)+(d&(1<<E)-1)];continue t}for(A=65535&b,(E&=15)&&(p<E&&(d+=y[r++]<<p,p+=8),A+=d&(1<<E)-1,d>>>=E,p-=E),15>p&&(d+=y[r++]<<p,p+=8,d+=y[r++]<<p,p+=8),b=g[d&v];;){if(E=b>>>24,d>>>=E,p-=E,16&(E=b>>>16&255)){if(b&=65535,E&=15,p<E&&(d+=y[r++]<<p,(p+=8)<E&&(d+=y[r++]<<p,p+=8)),(b+=d&(1<<E)-1)>s){e.msg="invalid distance too far back",a.mode=30;break e}if(d>>>=E,p-=E,E=o-i,b>E){if((E=b-E)>l&&a.BA){e.msg="invalid distance too far back",a.mode=30;break e}if(x=0,T=u,0===f){if(x+=c-E,E<A){A-=E;do{S[o++]=u[x++]}while(--E);x=o-b,T=S}}else if(f<E){if(x+=c+f-E,(E-=f)<A){A-=E;do{S[o++]=u[x++]}while(--E);if(x=0,f<A){E=f,A-=E;do{S[o++]=u[x++]}while(--E);x=o-b,T=S}}}else if(x+=f-E,E<A){A-=E;do{S[o++]=u[x++]}while(--E);x=o-b,T=S}for(;2<A;)S[o++]=T[x++],S[o++]=T[x++],S[o++]=T[x++],A-=3;A&&(S[o++]=T[x++],1<A&&(S[o++]=T[x++]))}else{x=o-b;do{S[o++]=S[x++],S[o++]=S[x++],S[o++]=S[x++],A-=3}while(2<A);A&&(S[o++]=S[x++],1<A&&(S[o++]=S[x++]))}break}if(64&E){e.msg="invalid distance code",a.mode=30;break e}b=g[(65535&b)+(d&(1<<E)-1)]}}else S[o++]=65535&b;break}}while(r<n&&o<_);A=p>>3,r-=A,p-=A<<3,e.xk=r,e.me=o,e.Hf=r<n?n-r+5:5-(r-n),e.md=o<_?_-o+257:257-(o-_),a.hk=d&(1<<p)-1,a.Vc=p}},{}],8:[function(e,t,a){function r(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function n(){this.mode=0,this.$u=!1,this.Gh=0,this.hz=!1,this.total=this.check=this.Pt=this.Kc=0,this.head=null,this.zf=this.Oj=this.Af=this.kp=0,this.window=null,this.od=this.offset=this.length=this.Vc=this.hk=0,this.Ll=this.hj=null,this.Ag=this.gr=this.mo=this.XF=this.zn=this.ei=0,this.next=null,this.je=new u.mp(320),this.us=new u.mp(288),this.ZD=this.CF=null,this.yV=this.back=this.BA=0}function o(e){var t;return e&&e.state?(t=e.state,e.gB=e.Zr=t.total=0,e.msg="",t.Gh&&(e.pl=1&t.Gh),t.mode=1,t.$u=0,t.hz=0,t.Pt=32768,t.head=null,t.hk=0,t.Vc=0,t.hj=t.CF=new u.np(852),t.Ll=t.ZD=new u.np(592),t.BA=1,t.back=-1,0):-2}function i(e){var t;return e&&e.state?(t=e.state,t.Af=0,t.Oj=0,t.zf=0,o(e)):-2}function _(e,t){var a,r;return e&&e.state?(r=e.state,0>t?(a=0,t=-t):(a=1+(t>>4),48>t&&(t&=15)),t&&(8>t||15<t)?-2:(null!==r.window&&r.kp!==t&&(r.window=null),r.Gh=a,r.kp=t,i(e))):-2}function s(e,t){var a;return e?(a=new n,e.state=a,a.window=null,a=_(e,t),0!==a&&(e.state=null),a):-2}function c(e,t,a,r){var n=e.state;return null===n.window&&(n.Af=1<<n.kp,n.zf=0,n.Oj=0,n.window=new u.kl(n.Af)),r>=n.Af?(u.ul(n.window,t,a-n.Af,n.Af,0),n.zf=0,n.Oj=n.Af):(e=n.Af-n.zf,e>r&&(e=r),u.ul(n.window,t,a-r,e,n.zf),(r-=e)?(u.ul(n.window,t,a-r,r,0),n.zf=r,n.Oj=n.Af):(n.zf+=e,n.zf===n.Af&&(n.zf=0),n.Oj<n.Af&&(n.Oj+=e))),0}var l,f,u=e("../utils/common"),d=e("./adler32"),p=e("./crc32"),m=e("./inffast"),g=e("./inftrees"),h=!0;a.TX=i,a.UX=_,a.VX=o,a.RX=function(e){return s(e,15)},a.qQ=s,a.Vn=function(e,t){var a,n,o,i,_,s,v,b,E,A,x,T,y,S,O,w,R,L,N=new u.kl(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.th||!e.input&&0!==e.Hf)return-2;a=e.state,12===a.mode&&(a.mode=13),_=e.me,o=e.th,v=e.md,i=e.xk,n=e.input,s=e.Hf,b=a.hk,E=a.Vc,A=s,x=v,L=0;e:for(;;)switch(a.mode){case 1:if(0===a.Gh){a.mode=13;break}for(;16>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(2&a.Gh&&35615===b){a.check=0,N[0]=255&b,N[1]=b>>>8&255,a.check=p(a.check,N,2,0),E=b=0,a.mode=2;break}if(a.Kc=0,a.head&&(a.head.done=!1),!(1&a.Gh)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",a.mode=30;break}if(8!==(15&b)){e.msg="unknown compression method",a.mode=30;break}if(b>>>=4,E-=4,y=8+(15&b),0===a.kp)a.kp=y;else if(y>a.kp){e.msg="invalid window size",a.mode=30;break}a.Pt=1<<y,e.pl=a.check=1,a.mode=512&b?10:12,E=b=0;break;case 2:for(;16>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(a.Kc=b,8!==(255&a.Kc)){e.msg="unknown compression method",a.mode=30;break}if(57344&a.Kc){e.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=b>>8&1),512&a.Kc&&(N[0]=255&b,N[1]=b>>>8&255,a.check=p(a.check,N,2,0)),E=b=0,a.mode=3;case 3:for(;32>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.head&&(a.head.time=b),512&a.Kc&&(N[0]=255&b,N[1]=b>>>8&255,N[2]=b>>>16&255,N[3]=b>>>24&255,a.check=p(a.check,N,4,0)),E=b=0,a.mode=4;case 4:for(;16>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.head&&(a.head.DV=255&b,a.head.OR=b>>8),512&a.Kc&&(N[0]=255&b,N[1]=b>>>8&255,a.check=p(a.check,N,2,0)),E=b=0,a.mode=5;case 5:if(1024&a.Kc){for(;16>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.length=b,a.head&&(a.head.Fy=b),512&a.Kc&&(N[0]=255&b,N[1]=b>>>8&255,a.check=p(a.check,N,2,0)),E=b=0}else a.head&&(a.head.od=null);a.mode=6;case 6:if(1024&a.Kc&&(T=a.length,T>s&&(T=s),T&&(a.head&&(y=a.head.Fy-a.length,a.head.od||(a.head.od=Array(a.head.Fy)),u.ul(a.head.od,n,i,T,y)),512&a.Kc&&(a.check=p(a.check,n,T,i)),s-=T,i+=T,a.length-=T),a.length))break e;a.length=0,a.mode=7;case 7:if(2048&a.Kc){if(0===s)break e;T=0;do{y=n[i+T++],a.head&&y&&65536>a.length&&(a.head.name+=String.fromCharCode(y))}while(y&&T<s);if(512&a.Kc&&(a.check=p(a.check,n,T,i)),s-=T,i+=T,y)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.Kc){if(0===s)break e;T=0;do{y=n[i+T++],a.head&&y&&65536>a.length&&(a.head.jy+=String.fromCharCode(y))}while(y&&T<s);if(512&a.Kc&&(a.check=p(a.check,n,T,i)),s-=T,i+=T,y)break e}else a.head&&(a.head.jy=null);a.mode=9;case 9:if(512&a.Kc){for(;16>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(b!==(65535&a.check)){e.msg="header crc mismatch",a.mode=30;break}E=b=0}a.head&&(a.head.lQ=a.Kc>>9&1,a.head.done=!0),e.pl=a.check=0,a.mode=12;break;case 10:for(;32>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}e.pl=a.check=r(b),E=b=0,a.mode=11;case 11:if(0===a.hz)return e.me=_,e.md=v,e.xk=i,e.Hf=s,a.hk=b,a.Vc=E,2;e.pl=a.check=1,a.mode=12;case 12:if(5===t||6===t)break e;case 13:if(a.$u){b>>>=7&E,E-=7&E,a.mode=27;break}for(;3>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}switch(a.$u=1&b,b>>>=1,--E,3&b){case 0:a.mode=14;break;case 1:if(y=a,h){for(l=new u.np(512),f=new u.np(32),T=0;144>T;)y.je[T++]=8;for(;256>T;)y.je[T++]=9;for(;280>T;)y.je[T++]=7;for(;288>T;)y.je[T++]=8;for(g(1,y.je,0,288,l,0,y.us,{Vc:9}),T=0;32>T;)y.je[T++]=5;g(2,y.je,0,32,f,0,y.us,{Vc:5}),h=!1}if(y.hj=l,y.ei=9,y.Ll=f,y.zn=5,a.mode=20,6===t){b>>>=2,E-=2;break e}break;case 2:a.mode=17;break;case 3:e.msg="invalid block type",a.mode=30}b>>>=2,E-=2;break;case 14:for(b>>>=7&E,E-=7&E;32>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if((65535&b)!==(b>>>16^65535)){e.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&b,E=b=0,a.mode=15,6===t)break e;case 15:a.mode=16;case 16:if(T=a.length){if(T>s&&(T=s),T>v&&(T=v),0===T)break e;u.ul(o,n,i,T,_),s-=T,i+=T,v-=T,_+=T,a.length-=T;break}a.mode=12;break;case 17:for(;14>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(a.mo=257+(31&b),b>>>=5,E-=5,a.gr=1+(31&b),b>>>=5,E-=5,a.XF=4+(15&b),b>>>=4,E-=4,286<a.mo||30<a.gr){e.msg="too many length or distance symbols",a.mode=30;break}a.Ag=0,a.mode=18;case 18:for(;a.Ag<a.XF;){for(;3>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.je[I[a.Ag++]]=7&b,b>>>=3,E-=3}for(;19>a.Ag;)a.je[I[a.Ag++]]=0;if(a.hj=a.CF,a.ei=7,T={Vc:a.ei},L=g(0,a.je,0,19,a.hj,0,a.us,T),a.ei=T.Vc,L){e.msg="invalid code lengths set",a.mode=30;break}a.Ag=0,a.mode=19;case 19:for(;a.Ag<a.mo+a.gr;){for(;O=a.hj[b&(1<<a.ei)-1],T=O>>>24,O&=65535,!(T<=E);){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(16>O)b>>>=T,E-=T,a.je[a.Ag++]=O;else{if(16===O){for(y=T+2;E<y;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(b>>>=T,E-=T,0===a.Ag){e.msg="invalid bit length repeat",a.mode=30;break}y=a.je[a.Ag-1],T=3+(3&b),b>>>=2,E-=2}else if(17===O){for(y=T+3;E<y;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}b>>>=T,E-=T,y=0,T=3+(7&b),b>>>=3,E-=3}else{for(y=T+7;E<y;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}b>>>=T,E-=T,y=0,T=11+(127&b),b>>>=7,E-=7}if(a.Ag+T>a.mo+a.gr){e.msg="invalid bit length repeat",a.mode=30;break}for(;T--;)a.je[a.Ag++]=y}}if(30===a.mode)break;if(0===a.je[256]){e.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.ei=9,T={Vc:a.ei},L=g(1,a.je,0,a.mo,a.hj,0,a.us,T),a.ei=T.Vc,L){e.msg="invalid literal/lengths set",a.mode=30;break}if(a.zn=6,a.Ll=a.ZD,T={Vc:a.zn},L=g(2,a.je,a.mo,a.gr,a.Ll,0,a.us,T),a.zn=T.Vc,L){e.msg="invalid distances set",a.mode=30;break}if(a.mode=20,6===t)break e;case 20:a.mode=21;case 21:if(6<=s&&258<=v){e.me=_,e.md=v,e.xk=i,e.Hf=s,a.hk=b,a.Vc=E,m(e,x),_=e.me,o=e.th,v=e.md,i=e.xk,n=e.input,s=e.Hf,b=a.hk,E=a.Vc,12===a.mode&&(a.back=-1);break}for(a.back=0;O=a.hj[b&(1<<a.ei)-1],T=O>>>24,y=O>>>16&255,O&=65535,!(T<=E);){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(y&&!(240&y)){for(S=T,w=y,R=O;O=a.hj[R+((b&(1<<S+w)-1)>>S)],T=O>>>24,y=O>>>16&255,O&=65535,!(S+T<=E);){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}b>>>=S,E-=S,a.back+=S}if(b>>>=T,E-=T,a.back+=T,a.length=O,!y){a.mode=26;break}if(32&y){a.back=-1,a.mode=12;break}if(64&y){e.msg="invalid literal/length code",a.mode=30;break}a.od=15&y,a.mode=22;case 22:if(a.od){for(y=a.od;E<y;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.length+=b&(1<<a.od)-1,b>>>=a.od,E-=a.od,a.back+=a.od}a.yV=a.length,a.mode=23;case 23:for(;O=a.Ll[b&(1<<a.zn)-1],T=O>>>24,y=O>>>16&255,O&=65535,!(T<=E);){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(!(240&y)){for(S=T,w=y,R=O;O=a.Ll[R+((b&(1<<S+w)-1)>>S)],T=O>>>24,y=O>>>16&255,O&=65535,!(S+T<=E);){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}b>>>=S,E-=S,a.back+=S}if(b>>>=T,E-=T,a.back+=T,64&y){e.msg="invalid distance code",a.mode=30;break}a.offset=O,a.od=15&y,a.mode=24;case 24:if(a.od){for(y=a.od;E<y;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}a.offset+=b&(1<<a.od)-1,b>>>=a.od,E-=a.od,a.back+=a.od}if(a.offset>a.Pt){e.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(0===v)break e;if(T=x-v,a.offset>T){if((T=a.offset-T)>a.Oj&&a.BA){e.msg="invalid distance too far back",a.mode=30;break}T>a.zf?(T-=a.zf,y=a.Af-T):y=a.zf-T,T>a.length&&(T=a.length),S=a.window}else S=o,y=_-a.offset,T=a.length;T>v&&(T=v),v-=T,a.length-=T;do{o[_++]=S[y++]}while(--T);0===a.length&&(a.mode=21);break;case 26:if(0===v)break e;o[_++]=a.length,v--,a.mode=21;break;case 27:if(a.Gh){for(;32>E;){if(0===s)break e;s--,b|=n[i++]<<E,E+=8}if(x-=v,e.Zr+=x,a.total+=x,x&&(e.pl=a.check=a.Kc?p(a.check,o,x,_-x):d(a.check,o,x,_-x)),x=v,(a.Kc?b:r(b))!==a.check){e.msg="incorrect data check",a.mode=30;break}E=b=0}a.mode=28;case 28:if(a.Gh&&a.Kc){for(;32>E;){if(0===s)break e;s--,b+=n[i++]<<E,E+=8}if(b!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=30;break}E=b=0}a.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return-2}return e.me=_,e.md=v,e.xk=i,e.Hf=s,a.hk=b,a.Vc=E,(a.Af||x!==e.md&&30>a.mode&&(27>a.mode||4!==t))&&c(e,e.th,e.me,x-e.md)?(a.mode=31,-4):(A-=e.Hf,x-=e.md,e.gB+=A,e.Zr+=x,a.total+=x,a.Gh&&x&&(e.pl=a.check=a.Kc?p(a.check,o,x,e.me-x):d(a.check,o,x,e.me-x)),e.dO=a.Vc+(a.$u?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0),(0===A&&0===x||4===t)&&0===L&&(L=-5),L)},a.oQ=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},a.pQ=function(e,t){var a;e&&e.state&&(a=e.state,2&a.Gh&&(a.head=t,t.done=!1))},a.rQ=function(e,t){var a,r=t.length;return e&&e.state?(a=e.state,0!==a.Gh&&11!==a.mode?-2:11===a.mode&&d(1,t,r,0)!==a.check?-3:c(e,t,r,r)?(a.mode=31,-4):(a.hz=1,0)):-2},a.QX="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t){var a=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.eh=function(e,t,_,s,c,l,f,u){var d,p,m,g,h,v,b,E,A,x,T,y,S,O,w=u.Vc,R=0,L=new a.mp(16);h=new a.mp(16);var N,I,M,C,D=0;for(d=0;15>=d;d++)L[d]=0;for(p=0;p<s;p++)L[t[_+p]]++;for(g=w,m=15;1<=m&&0===L[m];m--);if(g>m&&(g=m),!m)return c[l++]=20971520,c[l++]=20971520,u.Vc=1,0;for(w=1;w<m&&0===L[w];w++);for(g<w&&(g=w),d=v=1;15>=d;d++)if(v<<=1,0>(v-=L[d]))return-1;if(0<v&&(0===e||1!==m))return-1;for(h[1]=0,d=1;15>d;d++)h[d+1]=h[d]+L[d];for(p=0;p<s;p++)0!==t[_+p]&&(f[h[t[_+p]]++]=p);if(0===e?(S=N=f,O=19):1===e?(S=r,R-=257,N=n,D-=257,O=256):(S=o,N=i,O=-1),p=E=0,d=w,y=l,s=g,h=0,x=-1,b=1<<g,T=b-1,1===e&&852<b||2===e&&592<b)return 1;for(;;){I=d-h,f[p]<O?(M=0,C=f[p]):f[p]>O?(M=N[D+f[p]],C=S[R+f[p]]):(M=96,C=0),v=1<<d-h,w=A=1<<s;do{A-=v,c[y+(E>>h)+A]=I<<24|M<<16|C|0}while(A);for(v=1<<d-1;E&v;)v>>=1;if(v?(E&=v-1,E+=v):E=0,p++,!--L[d]){if(d===m)break;d=t[_+f[p]]}if(d>g&&(E&T)!==x){for(0===h&&(h=g),y+=w,s=d-h,v=1<<s;s+h<m&&!(0>=(v-=L[s+h]));)s++,v<<=1;if(b+=1<<s,1===e&&852<b||2===e&&592<b)return 1;x=E&T,c[x]=g<<24|s<<16|y-l|0}}return E&&(c[y+E]=d-h<<24|4194304),u.Vc=g,0}},{"../utils/common":1}],10:[function(e,t){t.eh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t){t.eh=function(){this.input=null,this.gB=this.Hf=this.xk=0,this.th=null,this.Zr=this.md=this.me=0,this.msg="",this.state=null,this.dO=2,this.pl=0}},{}],"/lib/inflate.js":[function(e,t,a){function r(e){if(!(this instanceof r))return new r(e);var t=this.options=i.assign({BM:16384,$d:0,to:""},e||{});if(t.raw&&0<=t.$d&&16>t.$d&&(t.$d=-t.$d,t.$d||(t.$d=-15)),!(0<=t.$d&&16>t.$d)||e&&e.$d||(t.$d+=32),15<t.$d&&48>t.$d&&!(15&t.$d)&&(t.$d|=15),this.Dy=0,this.msg="",this.ended=!1,this.qt=[],this.Em=new l,this.Em.md=0,(e=o.qQ(this.Em,t.$d))!==s.bn)throw Error(c[e]);this.mQ=new f,o.pQ(this.Em,this.mQ)}function n(e,t){var a=new r(t);if(a.push(e,!0),a.Dy)throw a.msg||c[a.Dy];return a.result}var o=e("./zlib/inflate"),i=e("./utils/common"),_=e("./utils/strings"),s=e("./zlib/constants"),c=e("./zlib/messages"),l=e("./zlib/zstream"),f=e("./zlib/gzheader"),u=Object.prototype.toString;r.prototype.push=function(e,t){var a,r,n,c,l,f,d=this.Em,p=this.options.BM,m=this.options.gX,g=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?s.Js:s.nC,"string"===typeof e?d.input=_.SL(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.xk=0,d.Hf=d.input.length;do{if(0===d.md&&(d.th=new i.kl(p),d.me=0,d.md=p),a=o.Vn(d,s.nC),a===s.XK&&m&&(f="string"===typeof m?_.dU(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,a=o.rQ(this.Em,f)),a===s.WK&&!0===g&&(a=s.bn,g=!1),a!==s.Ks&&a!==s.bn)return this.aA(a),this.ended=!0,!1;!d.me||0!==d.md&&a!==s.Ks&&(0!==d.Hf||r!==s.Js&&r!==s.oC)||("string"===this.options.to?(n=_.mV(d.th,d.me),c=d.me-n,l=_.aM(d.th,n),d.me=c,d.md=p-c,c&&i.ul(d.th,d.th,n,c,0),this.kG(l)):this.kG(i.sH(d.th,d.me))),0===d.Hf&&0===d.md&&(g=!0)}while((0<d.Hf||0===d.md)&&a!==s.Ks);return a===s.Ks&&(r=s.Js),r===s.Js?(a=o.oQ(this.Em),this.aA(a),this.ended=!0,a===s.bn):(r===s.oC&&(this.aA(s.bn),d.md=0),!0)},r.prototype.kG=function(e){this.qt.push(e)},r.prototype.aA=function(e){e===s.bn&&(this.result="string"===this.options.to?this.qt.join(""):i.jE(this.qt)),this.qt=[],this.Dy=e,this.msg=this.Em.msg},a.VV=r,a.Vn=n,a.SX=function(e,t){return t=t||{},t.raw=!0,n(e,t)},a.QY=n},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}()}(),e.Vn=window.SR.Vn},a.module.shader_texts=function(e){e["anchors.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]},e["anchors.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]},e["color_id.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"include",A:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["color_id.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:6},{a:"logical_and_expr",l:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ; vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( u_model_tsr , U ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Z = at ( u_camera_eye , aq , N ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = au ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( O - ao , ao , V , ae , W , U , Z ) ; ax . ao = aq ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ay ( ax . O , ax . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 az = T ( a_tbn , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 az = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ay ( ax . O , ax . ao , az , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = aA ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = ax . O ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = ax . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float aB = ( dot ( cross ( ax . U , ax . V ) , ax . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( ax . V , aB ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = ax . aC ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ap ( N , ax . O ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = aD ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ap ( N , ax . O ) , 1.0 ) ; }".split(" ")}]},e["debug_view.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 aE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float aF = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE_DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"const vec3 aG = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 aG = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 aH = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 aI = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 aJ = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 aK = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aL = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float aQ ( ) { float aM = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WIREFRAME_QUALITY",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aN = sign ( aE - vec3 ( 0.02 * aF ) ) ; if ( aN . x < 0.0 || aN . y < 0.0 || aN . z < 0.0 ) aM = 0.0 ;".split(" ")}]}},{a:"elif",i:["WIREFRAME_QUALITY",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aO = fwidth ( aE ) ; vec3 aP = smoothstep ( vec3 ( 0.0 ) , aO * aF , aE ) ; aM = min ( min ( aP . x , aP . y ) , aP . z ) ; aM = clamp ( aM , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aM",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aR = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"vec3 aN = sign ( aE - vec3 ( 0.02 * aF ) ) ; if ( aN . x < 0.0 || aN . y < 0.0 || aN . z < 0.0 ) { aR = aG ; J = 1.0 ; } else discard ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aM = aQ ( ) ; aR = vec3 ( mix ( u_wireframe_edge_color , aJ , aM ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aM = aQ ( ) ; aR = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aM ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aM = aQ ( ) ; if ( gl_FrontFacing ) aR = mix ( u_wireframe_edge_color , aH , aM ) ; else aR = mix ( u_wireframe_edge_color , aI , aM ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aS = u_cluster_id + u_debug_colors_seed + 2.0 ; aR = vec3 ( fract ( aS * 19.73 ) , fract ( aS * 6.34 ) , fract ( aS * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aS = u_batch_debug_id_color + u_debug_colors_seed ; aR = vec3 ( fract ( aS * 19.73 ) , fract ( aS * 6.34 ) , fract ( aS * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aT ; if ( u_debug_render_time_threshold > 0.0 ) aT = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aT = 1.0 ; float aU = clamp ( 2.0 * aT , 0.0 , 1.0 ) ; float aV = clamp ( 2.0 * aT - 1.0 , 0.0 , 1.0 ) ; float aW = aT ; aR = mix ( aK , aL , vec3 ( aU , aV , aW ) ) ; J = 1.0 ; }".split(" ")}]}}]},{a:"txt",b:["aX","(","aR",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["debug_view.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","aE",";"]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"include",A:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) aE = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aE = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aE = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_VIEW_SPECIAL_SKYDOME"],j:{a:"grp",f:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Z = aZ ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]},{a:"txt",b:"mat3 N = u_view_tsr ; vec3 O = a_position ; vec4 S = R ( a_tbn ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ; an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"av ax = a_ ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Z = at ( u_camera_eye , aq , N ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bc = aq ; Z = au ( u_wind , u_time , u_jitter_amp , u_jitter_freq , bc , Z ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( O - ao , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; ax . ao = aq ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( O , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"ay ( ax . O , ax . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ap ( N , ax . O ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["error.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]},e["error.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * bd ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]},e["grass_map.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","be",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","be",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","be",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","be",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( be , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , be ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]},e["grass_map.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","be",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","be",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","be",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , vec3 ( 0.0 ) ) ; mat3 Z = at ( u_camera_eye , aq , N ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = au ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; ax . ao = aq ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( N , ax . O ) , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:"be = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["be","=","a_grass_size",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["be","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]},e["halo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_sun_intensity",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","bf",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float bh ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",A:"color_util.glslf"},{a:"include",A:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 bj = bi ( ) ; vec3 aR = bj . rgb ; float aN = bj . a ; aX ( aR ) ; aY ( aR , aN ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aR , aN ) ; }".split(" ")}]},e["halo.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float bh ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","bf",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; vec3 O = ap ( Z , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; bh = a_random_vals ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"mat3 bl = bk ( O , N ) ; mat3 bm = N ; bm [ 0 ] [ 0 ] = 0.0 ; bm [ 0 ] [ 1 ] = 0.0 ; bm [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 bl = bk ( O , N ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 bn = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bo = vec3 ( bn [ 0 ] , 0.0 , bn [ 1 ] ) ; vec3 bp = ap ( bl , bo ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( bm , bp ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bf = vec4 ( bp , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( N , bp ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]},e["lens_flares.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aR = GLSL_TEXTURE ( u_sampler , A ) ; aX ( aR . rgb ) ; aY ( aR . rgb , aR . a ) ; GLSL_OUT_FRAG_COLOR = aR ; }".split(" ")}]},e["lens_flares.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 bq = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( _ ( u_view_tsr , bq ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bs = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bt = vec2 ( a_lf_bb_vertex . x / bs , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bu = 1.9 ; bt *= ( 1.0 + bu * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bt , 0.999999 , 1.0 ) ; }".split(" ")}]},e["line.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aR = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aX ( aR ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["line.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; av ax = aw ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , Z ) ; vec4 bv = u_proj_matrix * vec4 ( ap ( N , ax . O ) , 1.0 ) ; bv . xyz /= bv . w ; vec4 bw = u_proj_matrix * vec4 ( ap ( N , ax . O + ax . U ) , 1.0 ) ; bw . xyz /= bw . w ; float bs = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bx = ( bw - bv ) . xy ; bx . x *= bs ; float by = M_PI / 2.0 ; mat2 bz = mat2 ( cos ( by ) , sin ( by ) , - sin ( by ) , cos ( by ) ) ; bx = bz * bx ; bx = normalize ( bx ) ; vec2 bA = ( u_line_width / u_height ) * vec2 ( 1.0 / bs , 1.0 ) ; gl_Position = vec4 ( bv . xy + bx . xy * bA / 2.0 , bv . z , 1.0 ) ; gl_Position *= bv . w ; }".split(" ")}]},e["main.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"USE_BSDF_SKY_DIM",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_TEXTURE_LOD_EXT",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"var",c:"FF_COMPOSITING_HACK",b:["0"]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_TEXTURE_LOD_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"include",A:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",A:"caustics.glslf"}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS"],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_BSDF_SKY_DIM",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",A:"nodes.glslf"},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"float bB = length ( i ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bC = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aR = D ; float J = H ; vec3 U = F ; vec4 bD = G ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",b:"aR = max ( aR - sqrt ( 0.01 * - min ( bC , 0.0 ) ) , 0.5 * aR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bE ( aR , bC , u_time , bD , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bB ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bF ( aR , bB , C , bC ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bF ( aR , bB , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bG = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aR = vec3 ( bG ) ;".split(" ")}]}}]},{a:"txt",b:"aR = max ( vec3 ( 0.0 ) , aR ) ; aX ( aR ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},"FF_COMPOSITING_HACK",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"aR = clamp ( aR , 0.0 , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["main.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",l:9}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bH",";"]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["mat4","bJ","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 bJ = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","N","=","u_view_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Z = aZ ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","O","=","a_position",";"]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:14}],j:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 bK = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:["vec3","U","=","bK",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{a:"elif",i:["NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bL = ap ( Z , O ) ; vec3 ac = normalize ( _ ( Z , bK ) ) ; vec3 C = bL - u_camera_eye ; vec3 W = cross ( C , ac ) ; vec3 V = cross ( ac , W ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( Z , bK ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",l:10}],j:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:"U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"av ax = a_ ( O , V , ae , W , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"O = ( bJ * vec4 ( O , 1.0 ) ) . xyz ; ao = ( bJ * vec4 ( ao , 1.0 ) ) . xyz ; aq = ( bJ * vec4 ( aq , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Z = at ( u_camera_eye , aq , N ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bc = aq ; Z = au ( u_wind , u_time , u_jitter_amp , u_jitter_freq , bc , Z ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( O - ao , ao , V , ae , W , U , Z ) ; ax . ao = aq ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float aB = ( dot ( cross ( ax . U , ax . V ) , ax . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( ax . V , aB ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = ax . aC ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"ay ( ax . O , ax . ao , U , bJ ) ;".split(" ")}]}}]},{a:"txt",b:"h = ax . O ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"j = ax . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bH = u_camera_eye - ax . O ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"A = aA ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"bI = ax . aR ;".split(" ")}]}},{a:"elif",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["bI","=","a_color",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 bM = bJ * vec4 ( ax . O , 1.0 ) ; bM . xyz = ap ( N , bM . xyz ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 bM = vec4 ( ap ( N , ax . O ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["i","=","bM",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bM ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"l = aD ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bN ( ax . O , ax . U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bM . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]},e["main_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_PLANE"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"include",A:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",A:"caustics.glslf"}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS"],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bH",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","bI",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},{a:"include",A:"mirror.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"include",A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"lighting_nodes.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float bB = length ( i ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bC = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["vec2","bO","=","A",";"]}]}}]},{a:"txt",b:"vec3 bP = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bP = bP ; else bP = - bP ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( bP , k . xyz ) * k . w ; mat3 bQ = mat3 ( k . xyz , W , bP ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"vec2 bR = normalize ( _ ( N , j ) ) . st ; bR = bR * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( bB < PARALLAX_LOD_DIST ) { float bS = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bB ) , 0.0 , 1.0 ) ; float bT = u_parallax_scale * bS ; vec3 bU = normalize ( bH * bQ ) ; float bV = 1.0 / PARALLAX_STEPS ; vec2 bW = bU . xy * bT / ( PARALLAX_STEPS * bU . z ) ; float bX = 1.0 ; float bY ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec2","bZ","=","bR",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bZ","=","bO",";"]}]}}]},{a:"txt",b:"bY = GLSL_TEXTURE ( u_normalmap0 , bZ ) . a ; for ( float b_ = 1.0 ; b_ <= PARALLAX_STEPS ; b_ ++ ) { if ( bY < bX ) { bX -= bV ; bZ -= bW ; bY = GLSL_TEXTURE ( u_normalmap0 , bZ ) . a ; } } vec2 ca = bZ + bW ; float cb = GLSL_TEXTURE ( u_normalmap0 , ca ) . a - ( bX + bV ) ; float cc = bY - bX ; float cd = cc / ( cc - cb ) ; bZ = cd * ca + ( 1.0 - cd ) * bZ ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bO += bZ - bR ;".split(" ")}]}}]},{a:"txt",b:["bR","=","bZ",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bR += bZ - bO ;".split(" ")}]}}]},{a:"txt",b:["bO","=","bZ",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","ce",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ce = GLSL_TEXTURE ( u_normalmap0 , bR ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"ce = GLSL_TEXTURE ( u_normalmap0 , bO ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cf = ce . rgb - 0.5 ; cf = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , cf , u_normal_factor ) ; vec3 U = bQ * cf ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","U","=","bP",";"]}]}}]},{a:"txt",b:"U = normalize ( U ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bR = normalize ( _ ( N , U ) ) . st ; bR = bR * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bH ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 cg = bI ; ch ( cg ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ci = vec4 ( cg , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","ci","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","cj","=","1.0",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ck = GLSL_TEXTURE ( u_colormap0 , bR ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ck = GLSL_TEXTURE ( u_colormap0 , bO ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ch ( ck . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:["vec4","cl",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cl = GLSL_TEXTURE ( u_colormap1 , bR ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cl = GLSL_TEXTURE ( u_colormap1 , bO ) ;".split(" ")}]}}]},{a:"txt",b:"ch ( cl . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 cm = GLSL_TEXTURE ( u_stencil0 , bR ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 cm = GLSL_TEXTURE ( u_stencil0 , bO ) ;".split(" ")}]}}]},{a:"txt",b:"ck = mix ( ck , cl , cm . r ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ci . rgb = mix ( ci . rgb , ck . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ck . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; ci . a = mix ( L , 1.0 , u_diffuse_color . a ) ; cj = ck . a ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ci . rgb *= mix ( vec3 ( 1.0 ) , ck . rgb , u_diffuse_color_factor ) ; ci . a = ck . a ; cj = ck . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS"],j:{a:"grp",f:[{a:"txt",b:"vec3 aR = ci . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cn = u_diffuse_intensity * ci . rgb ; vec3 cp = u_environment_energy * co ( U ) ; vec3 cq = u_ambient * cp ; vec4 bD = cr ( cn ) ; vec3 cs = u_emit * ci . rgb ; vec3 ct = u_specular_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_AS_SPEC"],j:{a:"grp",f:[{a:"txt",b:"vec3 cu = vec3 ( cj ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 cu = GLSL_TEXTURE ( u_specmap0 , bR ) . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cu = GLSL_TEXTURE ( u_specmap0 , bO ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"ch ( cu . rgb ) ; ct = mix ( ct , cu , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cv = u_specular_params [ 0 ] ; vec2 cw = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cx = cv * ct ; vec3 aR ; vec3 cy ; cz ( cs , cq , cn , cx , h , U , C , cw , u_diffuse_params , bD , 0.0 , vec4 ( 0.0 ) , aR , cy ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cA ( aR , C , U , u_reflect_factor , N ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cA ( aR , C , U , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cA ( aR , C , U , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["aR","+=","cy",";"]}]}}]},{a:"txt",b:"float J = ci . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",b:"aR = max ( aR - sqrt ( 0.01 * - min ( bC , 0.0 ) ) , 0.5 * aR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bE ( aR , bC , u_time , bD , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bB ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float t = max ( max ( cy . r , cy . g ) , cy . b ) * u_specular_alpha ; J = ci . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"vec2 cB = - ( _ ( N , U ) ) . xy ; aR = mix ( cC ( l , cB * u_refr_bump ) , aR , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bF ( aR , bB , C , bC ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bF ( aR , bB , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bG = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aR = vec3 ( bG ) ;".split(" ")}]}}]},{a:"txt",b:["aX","(","aR",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["node_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 cD ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",A:"nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{a:"logical_or_expr",l:9}],j:{a:"grp",f:[{a:"txt",b:"vec3 C = - normalize ( cD ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","C",";"]}]}}]},{a:"txt",b:"vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; D = max ( vec3 ( 0.0 ) , D ) ; aX ( D ) ; GLSL_OUT_FRAG_COLOR = vec4 ( D , _1_0 ) ; }".split(" ")}]},e["particle_system.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_TEXTURE_LOD_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_TEXTURE_LOD_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aR = D ; float J = H ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bF ( aR , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"float cE = - i . z / u_view_max_depth ; vec4 cF = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cH = cG ( cF ) ; float cI = cH - cE ; float cJ = u_view_max_depth / SOFT_STRENGTH * cI ; J = J * min ( cJ , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aX","(","aR",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["particle_system.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","cK",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bH",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","bh",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","j",";"]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["WORLD_SPACE",{a:"logic_negative_expr",l:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"particles.glslv"},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cN ( vec2 cL , vec2 cM ) { return ( atan ( cM . y , cM . x ) - atan ( cL . y , cL . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["mat4","bJ","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 bJ = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 N = u_view_tsr ; cO pp ; pp = cP ( ) ; float cQ ; mat3 bl = cR ( ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 cS = ( bJ * vec4 ( pp . O , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cS = pp . O ;".split(" ")}]}}]},{a:"txt",b:"vec3 U = vec3 ( 0.0 , - 1.0 , 0.0 ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cQ = pp . by ; bl = bk ( cS , N ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cQ = cN ( vec2 ( EPSILON , 1.0 ) , vec2 ( U . x , - U . y ) ) + pp . by ; bl [ 0 ] = cS ; vec4 cT = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ; bl = cU ( cT , bl ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cQ = pp . by ; bl [ 0 ] = cS ; vec4 cV = X ( UP_VECTOR , M_PI / 2.0 ) ; bl = cU ( cV , bl ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cQ = pp . by ; bl [ 0 ] = cS ; } vec3 bo = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cW * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cW * u_p_size ) ; float cX = a_p_data [ 2 ] ; float cY = u_p_tilt * u_p_tilt_rand * ( 2.0 * cX - 1.0 ) ; float cZ = ( cY + u_p_tilt ) * M_PI ; vec4 c_ = X ( TOWARD_VECTOR , cZ + cQ ) ; vec3 bp = ap ( bl , T ( c_ , bo ) ) ; vec4 bM = vec4 ( ap ( N , bp ) , 1.0 ) ; vec4 f = u_proj_matrix * bM ;".split(" ")},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["bh","=","cX",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 da = cR ( ) ; c_ = X ( TOWARD_VECTOR , cQ ) ; da = cU ( c_ , da ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},"USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 W = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , V , vec3 ( 0.0 ) , W , U , aZ ( bl , da ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float aB = ( dot ( cross ( ax . U , ax . V ) , ax . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( ax . V , aB ) ;".split(" ")}]}}]},{a:"txt",b:"I ( pp . O , pp . db , pp . dc , pp . dd , pp . cW , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , aZ ( bl , da ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cK = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bI = pp . aR ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"j = ax . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = aD ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["i","=","bM",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bp ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bH = u_camera_eye - bp ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["particle_system_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","cK",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bI",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","bH",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","bh",";"]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","bf",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",A:"lighting_nodes.glslf"},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"include",A:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( bH ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"vec4 bj = bi ( ) ; vec3 aR = bj . rgb * bI ; float de = 0.9 * length ( A ) ; float df = smoothstep ( u_p_alpha_start , u_p_alpha_end , de ) ; float J = bj . a * ( 1.0 - df ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","ci","=","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"vec4 ck = GLSL_TEXTURE ( u_sampler , A ) ; ch ( ck . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ci . rgb = mix ( ci . rgb , ck . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ci . rgb *= mix ( vec3 ( 1.0 ) , ck . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"ci . a = ck . a ;".split(" ")}]}}]},{a:"txt",b:"ci . rgb *= bI ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 cn = u_diffuse_intensity * ci . rgb ; vec3 cs = u_emit * ci . rgb ; vec3 U = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",l:1},"SKY_COLOR",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 cp = u_environment_energy * co ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cp = u_environment_energy * co ( U ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cq = u_ambient * cp ; float cv = u_specular_params [ 0 ] ; vec2 cw = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cx = cv * u_specular_color ; vec3 aR ; vec3 cy ; cz ( cs , cq , cn , cx , h , U , C , cw , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aR , cy ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 aR = ci . rgb ;".split(" ")}]}}]},{a:"txt",b:"float J = ci . a * cK ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bF ( aR , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"float cE = - i . z / u_view_max_depth ; vec4 cF = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cH = cG ( cF ) ; float cI = cH - cE ; float cJ = u_view_max_depth / SOFT_STRENGTH * cI ; J = J * min ( cJ , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aX","(","aR",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["proc_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cD ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float dg = 0.99 ; const float dh = 1.8 ; const int di = 8 ; float dn ( vec3 O , vec3 bq ) { float a = dot ( bq , bq ) ; float b = 2.0 * dot ( bq , O ) ; float dj = dot ( O , O ) - 1.0 ; float dk = b * b - 4.0 * a * dj ; float dl = sqrt ( dk ) ; float q = ( - b - dl ) / 2.0 ; float dm = dj / q ; return dm ; } float dq ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float dj = 1.0 + J * J ; float dp = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; dp = max ( dp , 0.00001 ) ; return ( a / b ) * ( dj / dp ) ; } float dv ( vec3 O , vec3 bq , float dr ) { float ds = dot ( bq , - O ) ; if ( ds < 0.0 ) { return 1.0 ; } vec3 dt = O + ds * bq ; if ( length ( dt ) < dr ) { return 0.0 ; } else if ( length ( dt ) >= dr ) { vec3 cM = normalize ( dt ) * dr - O ; float du = acos ( dot ( normalize ( cM ) , bq ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( du * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dw ( float aN , vec3 aR , float aM ) { return aR - aR * pow ( u_sky_color , vec3 ( aM / aN ) ) ; } void main ( ) { vec3 dx = normalize ( cD ) ; vec3 dy = u_sun_direction ; float J = dot ( dx , dy ) ; float dz = dq ( J , - 0.01 ) * u_rayleigh_brightness * dy . z ; float dA = dq ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dy . z ) ; float dB = smoothstep ( 0.0 , 100.0 , dq ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dC = vec3 ( 0.0 , 0.0 , dg ) ; float dD = dn ( dC , dx ) ; float dE = dD / float ( di ) ; float dF = dv ( dC , dx , dg - 0.3 ) ; vec3 dG = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dH = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int b_ = 0 ; b_ < di ; b_ ++ ) { float dI = dE * float ( b_ ) ; vec3 O = dC + dx * dI ; float dJ = dv ( O , dy , dg - 0.2 ) ; float dK = dn ( O , dy ) ; vec3 dL = dw ( dK , vec3 ( dh ) , u_scatter_strength ) * dJ ; dG += dw ( sqrt ( dI ) , u_sky_color * dL , u_rayleigh_strength ) ; dH += dw ( dI , dL , u_mie_strength ) ; } dG = dG * dF * pow ( dD , u_rayleigh_collection_power ) / float ( di ) ; dH = ( dH * dF * pow ( dD , u_mie_collection_power ) ) / float ( di ) ; vec3 aR = vec3 ( dB * dH + dA * dH + dz * dG ) ; aX ( aR ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aR , 1.0 ) ; }".split(" ")}]},e["shadow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"cond",f:[{a:"if",i:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS"],j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"},{a:"include",A:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"include",A:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},"RGBA_SHADOWS",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_LOD_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS"],j:{a:"grp",f:[{a:"txt",b:"float dN = dM ( - i . z , u_camera_range ) ; GLSL_OUT_FRAG_COLOR = dO ( dN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dP ( i . z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]},e["shadow.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},"RGBA_SHADOWS",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 bK = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 U = bK ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Z = aZ ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( Z , bK ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"av ax = a_ ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["HAIR_BILLBOARD",{a:"logic_negative_expr",l:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["mat3","dQ","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","dQ","=","N",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = as ( u_camera_eye , aq , dQ , Z ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Z = at ( u_camera_eye , aq , dQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Z = au ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},{a:"txt",b:"av ax = aw ( O - ao , ao , V , ae , W , U , Z ) ; ax . ao = aq ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"av ax = aw ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","az","=","bK",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 az = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ay ( ax . O , ax . ao , az , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = ax . O ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = ax . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float aB = ( dot ( cross ( ax . U , ax . V ) , ax . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( ax . V , aB ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = ax . aC ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bM = vec4 ( ap ( N , ax . O ) , 1.0 ) ; vec4 f = u_proj_matrix * bM ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = aD ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bM . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = aA ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bN ( ax . O , ax . U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},"RGBA_SHADOWS",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["i","=","bM",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dR = ( u_proj_matrix * vec4 ( N [ 0 ] , 1.0 ) ) . xy ; float dS = SHADOW_TEX_RES / 2.0 ; dR = floor ( dR * dS + 0.5 ) / dS - dR ; f . xy += dR ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]},e["sky.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cD",";"]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dT ; vec3 dx = normalize ( cD ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","dU","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dU = abs ( A . y ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dU = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dV = u_horizon_color ; vec3 dW = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec3 dX = vec3 ( A , 0.0 ) ; vec4 dY = GLSL_TEXTURE_CUBE ( u_sky , dx ) ; ch ( dY . rgb ) ; dT = dZ ( dV , dW , dY , dU , dX ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dT = mix ( dV , dW , dU ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dT = GLSL_TEXTURE_CUBE ( u_sky , dx ) . rgb ; ch ( dT ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float d_ = WATER_LEVEL - u_camera_eye_frag . z ; vec3 ea = vec3 ( 0.0 ) ; vec3 eb = mix ( u_underwater_fog_color_density . rgb , ea , min ( - dx . z , 1.0 ) ) ; eb *= min ( 1.0 - min ( 0.03 * d_ , 0.8 ) , 1.0 ) ; float aM = clamp ( sign ( 0.01 * d_ - dx . z ) , 0.0 , 1.0 ) ; dT = mix ( dT , eb , aM ) ;".split(" ")}]}}]},{a:"txt",b:"aX ( dT ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dT , 1.0 ) ; }".split(" ")}]},e["sky.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cD ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dx = u_sky_vp_inverse * O ; cD = dx . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","O",";","}"]}]},e["skybox.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cD ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dx = u_cube_view_matrix * O ; cD = dx . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","O",";","}"]}]},e["tex_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cD ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dx = normalize ( cD ) ; vec3 dT ; float dU = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYPAPER"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"dT = GLSL_TEXTURE_CUBE ( u_sky_texture , dx ) . xyz ; ch ( dT ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dT = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"float J = acos ( dx . z ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dU = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dU = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dV = u_horizon_color ; vec3 dW = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec4 dY = GLSL_TEXTURE_CUBE ( u_sky_texture , dx ) ; ch ( dY . rgb ) ; vec3 dX = vec3 ( cD . xy , 0.0 ) ; dT = dZ ( dV , dW , dY , dU , dX ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"dT = mix ( dV , dW , dU ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["dT","=","dV",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aX ( dT ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dT , 1.0 ) ; }".split(" ")}]},e["water.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:"const float aF = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bH ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 ec ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","ed",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","ee",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","aE",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:"vec3 em ( in vec2 ef , in vec3 U , in vec3 eg , in vec3 eh , out float ei , in float ej ) { ei = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 ek = ef . xy + U . xy * REFL_BUMP / m ; ei = u_reflect_factor ; vec3 el ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"el = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"el = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { el = GLSL_TEXTURE ( u_plane_reflection , ek ) . rgb ; ch ( el ) ; }".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ei = u_mirror_factor ; vec3 el = eh * GLSL_TEXTURE_CUBE ( u_mirrormap , eg ) . rgb ; ch ( el ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"ei = u_reflect_factor ; vec3 el = eh * vec3 ( 0.3 , 0.5 , 1.0 ) ; ch ( el ) ;".split(" ")}]}}]},{a:"txt",b:"ei = min ( ei * ej , 1.0 ) ; return el ; }".split(" ")},{a:"include",A:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 bQ = mat3 ( k , ec , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 U = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC","FOAM",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bC = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bC = h . z ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"vec2 bO = vec2 ( ed . x , - ed . y ) + 0.5 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 bO = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bO","=","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 en = vec3 ( 0.0 ) ; en += GLSL_TEXTURE ( u_normalmap0 , bO * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"en += GLSL_TEXTURE ( u_normalmap0 , bO * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"en += GLSL_TEXTURE ( u_normalmap0 , bO * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"en += GLSL_TEXTURE ( u_normalmap0 , bO * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"U = mix ( U , normalize ( bQ * en ) , 0.3 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"U = mix ( U , normalize ( bQ * en ) , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"U = normalize ( U ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bH ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 ef = l . xy / l . z ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 ef = vec2 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"vec2 eo = ef + U . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cF = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cH = cG ( cF ) ; float cI = max ( cH - m , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"float eq = ep ( cH , eo , ef ) ; float er = max ( eq - m , 0.0 ) ; float es = u_view_max_depth / ABSORB * er ; float et = min ( J * es , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cI , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float cJ = u_view_max_depth / ABSORB * cI ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cJ , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["float","et","=","J",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) et = 0.0 ; vec3 eu = GLSL_TEXTURE ( u_refractmap , eo ) . rgb ; ch ( eu ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float ev = pow ( min ( ee . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 ci = mix ( u_shallow_water_col , u_diffuse_color . rgb , ev ) ; ev = pow ( min ( ee . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; ci = mix ( u_shore_water_col , ci , ev ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ci = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float ew = max ( 1.0 - u_view_max_depth * cI , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float ew = 1.0 - J ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float ex = max ( bC / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 ey = normalize ( vec3 ( ee . rg , 0.0 ) ) ; vec3 ez = normalize ( mix ( UP_VECTOR , ey , 0.8 ) ) ; float eA = 1.25 * max ( dot ( U , ez ) - 0.2 , 0.0 ) ; eA += max ( dot ( U , - UP_VECTOR ) , 0.0 ) ; ew += eA * ( 1.0 - ee . b ) ; ex *= ( 1.0 - 0.95 * pow ( ee . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"ew += ex ; ew = min ( u_foam_factor * ew , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 eB = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bO * u_foam_scale ) ;".split(" ")}]}}]},{a:"txt",b:"float cv = u_specular_params [ 0 ] ; vec2 cw = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cx = cv * u_specular_color ; vec3 cp = u_environment_energy * co ( U ) ; vec3 cq = u_ambient * cp ; vec3 eh = cq + u_sun_intensity ; float ei ; vec3 eg = reflect ( - C , U ) ; vec3 eC = normalize ( eg + C ) ; float eD = 1.0 - dot ( C , eC ) ; float eE = u_fresnel_params [ 3 ] ; float eF = u_fresnel_params [ 2 ] ; float eG = eE + ( 1.0 - eE ) * pow ( eD , eF ) ; vec3 el = em ( ef , U , eg , eh , ei , eG ) ; vec3 cn = u_diffuse_intensity * ci ; vec3 aR ; vec3 cy ; cz ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cn , cx , h , U , C , cw , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aR , cy ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float eH = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; eH = clamp ( SSS_STRENGTH * eH , 0.0 , 1.0 ) ; aR = mix ( aR , u_shallow_water_col , eH ) ; aR = mix ( aR , u_shore_water_col , eH ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"aR = mix ( eu , aR , et ) ;".split(" ")}]}}]},{a:"txt",b:"aR = mix ( aR , el , ei ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"float eI = mix ( eB . g , eB . r , max ( 4.0 * ( ew - 0.75 ) , 0.0 ) ) ; eI = mix ( eB . b , eI , max ( 2.0 * ew - 1.0 , 0.0 ) ) ; eI = mix ( 0.0 , eI , ew ) ; aR = mix ( aR , eh , eI ) ;".split(" ")}]}}]},{a:"txt",b:["aR","+=","cy",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float eJ = m * u_view_max_depth ; float eK = 1.0 ; if ( u_cam_water_depth > 1.0 ) eK = 2.0 ; bF ( aR , eJ , C , eK ) ;".split(" ")}]}}]},{a:"txt",b:["aX","(","aR",")",";"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"J = max ( J , cy . r ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["J","+=","eI",";"]}]}}]}]}},{a:"elif",i:["SHORE_SMOOTHING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aY ( aR , J ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aO = fwidth ( aE ) ; vec3 aP = smoothstep ( vec3 ( 0.0 ) , aO * aF , aE ) ; float eL = min ( min ( aP . x , aP . y ) , aP . z ) ; eL = clamp ( eL , 0.0 , 1.0 ) ; aR = mix ( u_wireframe_edge_color , aR , eL ) ; J = mix ( 1.0 , J , eL ) ;".split(" ")}]}},{a:"elif",i:["DEBUG_WIREFRAME",2,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aN = sign ( aE - vec3 ( 0.02 * aF ) ) ; float eL = 1.0 ; if ( aN . x < 0.0 || aN . y < 0.0 || aN . z < 0.0 ) eL = 0.0 ; aR = mix ( u_wireframe_edge_color , aR , eL ) ; J = mix ( 1.0 , J , eL ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR , J ) ; }".split(" ")}]},e["water.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"DYNAMIC",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn",";"]}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bH ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 ec ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","ed",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","ee",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","aE",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 eS ( in vec2 eM ) { vec2 eN = 0.5 + vec2 ( ( eM . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eM . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eO = GLSL_TEXTURE ( u_shore_dist_map , eN ) ; const vec2 eP = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eQ = dot ( eO . ba , eP ) ; vec2 eR = normalize ( eO . rg * 2.0 - 1.0 ) ; return vec3 ( eR , eQ ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void fg ( inout vec3 eM , in float eT , in vec3 eO ) { float eV = eU ( DST_NOISE_SCALE_0 * ( eM . xy + DST_NOISE_FREQ_0 * eT ) ) * eU ( DST_NOISE_SCALE_1 * ( eM . yx - DST_NOISE_FREQ_1 * eT ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float eW = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eQ = eO . b ; float eX = sqrt ( eQ ) ; float eY = max ( eQ , DIR_MIN_SHR_FAC ) * sin ( eX / eW + DIR_FREQ * eT ) ; float eZ = max ( eU ( DIR_NOISE_SCALE * ( eM . xy + DIR_NOISE_FREQ * eT ) ) , DIR_MIN_NOISE_FAC ) ; eY *= eZ ; float e_ = WAVES_HEIGHT * mix ( eY , eV , max ( eX , DST_MIN_FAC ) ) ; vec2 eR = eO . rg ; float fa = WAVES_HOR_FAC * eY * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eQ ) , 0.0 ) ; vec2 fb = fa * eR ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float e_ = WAVES_HEIGHT * eV ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec2 fc = 1.0 * ( eM . xy - 0.3 * eT ) ; vec2 fd = 0.7 * ( eM . yx + 0.07 * eT ) ; float ff = fe ( fc ) . x + fe ( fd ) . x - 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"eM . xy += fb ; ff *= eQ ;".split(" ")}]}}]},{a:"txt",b:"e_ += SMALL_WAVES_FAC * ff ;".split(" ")}]}}]},{a:"txt",b:"eM . z += e_ ; }".split(" ")}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:"if ( a_polyindex == 0.0 ) aE = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aE = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aE = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec3 O = a_position ; float fh = abs ( O . z ) ; vec2 fi = u_camera_eye . xy - mod ( u_camera_eye . xy , fh ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"O . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"O . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"O . xy += fi ; vec3 bL = O ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"av ax = aw ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bL = ax . O ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"ee = eS ( bL . xy ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float fj = length ( u_wind ) ; if ( fj == 0.0 ) fj = 1.0 ; float fk = u_time ; fk *= fj ;".split(" ")},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"float fl = fh ; vec3 fm = bL + vec3 ( fl , 0.0 , 0.0 ) ; vec3 fn = bL + vec3 ( 0.0 , fl , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["ed","=","bL",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 fm = bL + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fn = bL + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 fo = eS ( fm . xy ) ; vec3 fp = eS ( fn . xy ) ; fg ( fm , fk , fo ) ; fg ( fn , fk , fp ) ; fg ( bL , fk , ee ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"fg ( fm , fk , vec3 ( 0.0 ) ) ; fg ( fn , fk , vec3 ( 0.0 ) ) ; fg ( bL , fk , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bL . z = WATER_LEVEL - 1.0 ; fm . z = bL . z ; fn . z = bL . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fq = normalize ( fm - bL ) ; vec3 V = normalize ( fn - bL ) ; j = normalize ( cross ( fq , V ) ) ; float fr = dot ( j , UP_VECTOR ) ; float aM = clamp ( 0.8 - fr , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aM ) ;".split(" ")}]}},{a:"elif",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec4 S = R ( a_tbn ) ; j = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},{a:"elif",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = V ; ec = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bL ; bH = u_camera_eye - bL ; vec4 bM = vec4 ( ap ( u_view_tsr , bL ) , 1.0 ) ; vec4 f = u_proj_matrix * bM ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float fs = f . x ; float ft = f . y ; float fu = f . w ; l . x = ( fs + fu ) / 2.0 ; l . y = ( ft + fu ) / 2.0 ; l . z = fu ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"m = - bM . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]},e["postprocessing/antialiasing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fw ( float x , float y ) { vec2 fv = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fv ) ; } vec4 fP ( ) { vec4 fx = fw ( - 1.0 , - 1.0 ) ; vec4 fy = fw ( 1.0 , - 1.0 ) ; vec4 fz = fw ( - 1.0 , 1.0 ) ; vec4 fA = fw ( 1.0 , 1.0 ) ; vec4 fB = fw ( 0.0 , 0.0 ) ; float fD = fC ( fB ) ; float fE = fC ( fx ) ; float fF = fC ( fy ) ; float fG = fC ( fz ) ; float fH = fC ( fA ) ; float fI = min ( fD , min ( min ( fE , fF ) , min ( fG , fH ) ) ) ; float fJ = max ( fD , max ( max ( fE , fF ) , max ( fG , fH ) ) ) ; vec2 bq ; bq . x = - ( ( fE + fF ) - ( fG + fH ) ) ; bq . y = ( ( fE + fG ) - ( fF + fH ) ) ; float fK = max ( ( fE + fF + fG + fH ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fL = 1.0 / ( min ( abs ( bq . x ) , abs ( bq . y ) ) + fK ) ; bq = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , bq * fL ) ) * u_texel_size ; vec4 fM = 0.5 * ( GLSL_TEXTURE ( u_color , A + bq * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + bq * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fN = fM * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + bq * - 0.5 ) + GLSL_TEXTURE ( u_color , A + bq * 0.5 ) ) ; float fO = fC ( fN ) ; if ( ( fO < fI ) || ( fO > fJ ) ) return fM ; else return fN ; }".split(" ")}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",A:"fxaa.glslf"},{a:"cond",f:[{a:"if",i:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fP ( ) ;".split(" ")}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fQ = u_texel_size ; GLSL_OUT_FRAG_COLOR = fR ( A , u_color , fQ , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["postprocessing/bloom_combine.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"var",c:"BLUR_PASS_NUM",b:["BLUR_PASS_5"]},{a:"txt",b:["uniform","sampler2D","u_main",";"]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_1",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_2",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_3",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_4",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_5",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fS = GLSL_TEXTURE ( u_main , A ) ; vec4 fT = vec4 ( 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_1",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fT += GLSL_TEXTURE ( u_bloom_level_0 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_2",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fT += GLSL_TEXTURE ( u_bloom_level_1 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_3",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fT += GLSL_TEXTURE ( u_bloom_level_2 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_4",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fT += GLSL_TEXTURE ( u_bloom_level_3 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BLUR_PASS_NUM","BLUR_PASS_5",{a:"ge_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fT += GLSL_TEXTURE ( u_bloom_level_4 , A ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS + fT ; }".split(" ")}]},e["postprocessing/coc.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aR = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float dN = fU ( u_depth , A , u_camera_range ) ; dN *= u_view_max_depth ; float fV = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 fW = GLSL_TEXTURE ( u_coc_fg , A ) ; float fX = fW . a ;".split(" ")}]}}]},{a:"txt",b:"if ( dN < u_dof_dist ) fV = ( u_dof_dist - dN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"else fV = ( dN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},{a:"txt",b:"fV = clamp ( fV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fV = max ( fV , fX ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fV ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aR . xyz * fV , fV ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aR . xyz , 0.0 ) ; }".split(" ")}]},e["postprocessing/compositing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fY = GLSL_TEXTURE ( u_color , A ) ; vec3 aR = fY . rgb ; if ( u_brightness < 0.0 ) aR = aR * ( 1.0 + u_brightness ) ; else aR = aR + ( ( 1.0 - aR ) * u_brightness ) ; aR = ( aR - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aR *= u_exposure ; float dh = fC ( vec4 ( aR , 0.0 ) ) ; aR = mix ( vec3 ( dh ) , aR , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aR , fY . a ) ; }".split(" ")}]},e["postprocessing/depth_pack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = dO ( clamp ( fU ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]},e["postprocessing/dof.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fV ; vec4 f_ = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 gc = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 gd = min ( f_ . rgba , gc . rgba ) ; fV = gd . a ; if ( fV > 0.0 ) { gd = vec4 ( gd . rgb / fV , fZ . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fZ , gd , min ( fV * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fZ ;".split(" ")}]}},{a:"elif",i:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float dN = fU ( u_depth , A , u_camera_range ) ; dN *= u_view_max_depth ; float ge ; if ( dN < u_dof_dist ) ge = ( u_dof_dist - dN ) / u_dof_front_end ; else ge = ( dN - u_dof_dist ) / u_dof_rear_end ; ge = clamp ( ge , 0.0 , 1.0 ) ; vec4 gf = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fZ , gf , ge ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fZ",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fZ ; }".split(" ")}]},e["postprocessing/glow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gh = GLSL_TEXTURE ( u_src_color , A ) ; vec4 gi = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gj = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = gh ; if ( gj . a != 0.0 ) { float gk = u_glow_mask_large_coeff * gj . a ; gk = clamp ( gk , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gj . rgb / gj . a , gk ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gk ) ; } if ( gi . a != 0.0 ) { float gl = u_glow_mask_small_coeff * gi . a ; gl = clamp ( gl , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gi . rgb / gi . a , gl ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gl ) ; } }".split(" ")}]},e["postprocessing/god_rays.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"include",A:"procedural.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN float gm ; GLSL_IN vec2 gn ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 go ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cI = ( go . xy - A ) ; float aN = length ( cI ) ; vec2 gp = u_radial_blur_step * cI / aN ; float gq = aN / u_radial_blur_step ; gp *= min ( gq , STEPS_PER_PASS ) / STEPS_PER_PASS ; gq = max ( gq , STEPS_PER_PASS ) ; vec2 gs = A ; float gt = 0.0 ; const int gu = int ( STEPS_PER_PASS ) ; int gv = int ( gq + 0.5 ) ; for ( int b_ = 0 ; b_ < gu ; b_ += 1 ) { if ( b_ <= gv ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:"float dN = fU ( u_input , gs , u_camera_range ) ; gt += max ( ( 1.0 - pow ( aN , 0.3 ) ) * step ( 0.9 , dN ) , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 gw = GLSL_TEXTURE ( u_input , gs ) ; gt += cG ( gw ) ;".split(" ")}]}}]},{a:"txt",b:"} gs += gp ; }".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 bO = A + gn ; float gx = fe ( vec2 ( 2.5 * ( bO . x ) , 2.5 * ( bO . y ) + 1.0 * u_time ) ) . x + 0.75 * fe ( vec2 ( 5.0 * ( bO . x ) - 0.66 * u_time , 5.0 * ( bO . y ) + 0.66 * u_time ) ) . x + 0.5 * eU ( vec2 ( 7.5 * ( bO . x ) + 0.33 * u_time , 7.5 * ( bO . y ) - 0.33 * u_time ) ) ; gx *= clamp ( 1.2 - sqrt ( 0.2 * aN ) , 0.0 , 1.0 ) * gm ; gt = max ( gx , gt ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dO ( gt / STEPS_PER_PASS ) ; }".split(" ")}]},e["postprocessing/god_rays.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT float gm ; GLSL_OUT vec2 gn ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 go ; void main ( ) { A = a_bb_vertex ; vec3 bq = normalize ( u_sun_direction ) ; go = u_view_proj_matrix * vec4 ( bq , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) { gm = 1.0 ; vec3 gy = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gz = T ( u_camera_quat , gy ) ; gz = normalize ( gz ) ; float gA = dot ( gz , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gB = atan ( gz . x , gz . z ) ; gn = vec2 ( - gB , acos ( gA ) ) ; } else { gm = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"go . xy = 0.5 * ( go . xy / go . w + 1.0 ) ; go += 99999.0 * step ( go . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]},e["postprocessing/god_rays_combine.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gC = GLSL_TEXTURE ( u_main , A ) ; vec3 gD = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; ch ( gC . rgb ) ; float gE = cG ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gF = gC . rgb + u_god_rays_intensity * vec3 ( gE ) * gD ; aX ( gF ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SAFARI_CANVAS_ALPHA_HACK"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gF , max ( 0.01 , gC . a ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gF , gC . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["postprocessing/luminance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fS = GLSL_TEXTURE ( u_input , A ) ; float gG = dot ( fS . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gG ) , 1.0 ) ; }".split(" ")}]},e["postprocessing/luminance_av.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; uniform float u_mipmap_1x1 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gH = max ( GLSL_TEXTURE ( u_input , A , u_mipmap_1x1 ) . r , 0.01 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gH ) , 1.0 ) ; }".split(" ")}]},e["postprocessing/luminance_truncated.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"var",c:"ADAPTIVE_BLOOM",b:["0"]},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; uniform float u_bloom_key ;".split(" ")},{a:"cond",f:[{a:"if",i:["ADAPTIVE_BLOOM",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_average_lum_val",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["ADAPTIVE_BLOOM"],j:{a:"grp",f:[{a:"txt",b:"float gH = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","gH","=","u_average_lum_val",";"]}]}}]},{a:"txt",b:"float gI = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aR = GLSL_TEXTURE ( u_main , A ) ; float gJ = gI / gH ; float gK = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aR * u_bloom_key * smoothstep ( gK , gK + 1.2 , gJ ) ; }".split(" ")}]},e["postprocessing/motion_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gL = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gM = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gN = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gM - gN ) > u_motion_blur_decay_threshold ) { vec4 gO = ( 1.0 - u_motion_blur_exp ) * gM + u_motion_blur_exp * gN ; vec4 gP = gO - gN ; vec4 gQ = gM - gN ; vec4 cI = min ( max ( abs ( gP ) , vec4 ( gL ) ) , abs ( gQ ) ) * sign ( gP ) ; GLSL_OUT_FRAG_COLOR = gN + cI ; } else { GLSL_OUT_FRAG_COLOR = gM ; } }".split(" ")}]},e["postprocessing/outline.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gR ; if ( u_draw_outline != 0.0 ) { vec4 gS = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gT = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gU = gT . a - gS . a ; if ( gU != 0.0 ) { float gV = smoothstep ( 0.0 , 1.0 , gT . a ) ; if ( gS . a == 0.0 ) { vec3 gW = u_outline_color ; aX ( gW ) ; vec4 gX = vec4 ( clamp ( gW , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gR , gX , gV ) ; } } } }".split(" ")}]},e["postprocessing/performance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aR = vec4 ( 0.0 ) ; for ( int b_ = 0 ; b_ < 10 ; b_ ++ ) { vec2 gY = vec2 ( fract ( A * vec2 ( b_ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aR += 0.01 * GLSL_TEXTURE ( u_color , gY ) ; } GLSL_OUT_FRAG_COLOR = aR ; }".split(" ")}]},e["postprocessing/postprocessing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 dj = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( dj . r + dj . g + dj . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fg = vec2 ( 0.0 , 0.0 ) ; vec2 cI = u_texel_size ; vec4 aR ; aR = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aR * 0.2270270270 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.1945945946 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.1945945946 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.1216216216 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.1216216216 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.0540540541 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.0540540541 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.0162162162 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * 0.0162162162 ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fg = vec2 ( 0.0 , 0.0 ) ; vec2 cI = u_texel_size ; vec4 aR ; aR = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.152507 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.141763 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.141763 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.113861 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.113861 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.079019 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.079019 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.047383 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.047383 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.024549 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.024549 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.01099 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.01099 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.00425 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.00425 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.00142 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; GLSL_OUT_FRAG_COLOR += aR * ( 1.0 - step ( 0.0 , - aR . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fg = vec2 ( 0.0 , 0.0 ) ; vec2 cI = u_texel_size ; vec4 aR ; vec4 gZ ; vec4 g_ ; float fV ; float ha = u_dof_bokeh_intensity ; aR = GLSL_TEXTURE ( u_color , A ) ; gZ = aR ; g_ = aR ; fV = aR . a ; cI = fV * cI ; for ( int b_ = 0 ; b_ < 12 ; b_ += 2 ) { fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; gZ += aR ; g_ = max ( g_ , aR ) ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; gZ += aR ; g_ = max ( g_ , aR ) ; } gZ /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( gZ , g_ , ha ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fg = vec2 ( 0.0 , 0.0 ) ; vec2 cI = u_texel_size ; vec4 aR ; vec4 gZ ; vec4 g_ ; aR = GLSL_TEXTURE ( u_color , A ) ; g_ = max ( g_ , aR ) ; gZ = aR ; gZ . a = aR . a * 0.2270270270 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.1945945946 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.1945945946 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.1216216216 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.1216216216 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.0540540541 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.0540540541 ; fg += cI ; aR = GLSL_TEXTURE ( u_color , A + fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.0162162162 ; aR = GLSL_TEXTURE ( u_color , A - fg ) ; g_ . a = max ( g_ . a , aR . a ) ; gZ . a += aR . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( gZ , g_ , 0.5 ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 cI = u_texel_size ; vec4 aR = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aR ; if ( aR . a == 0.0 ) { aR = GLSL_TEXTURE ( u_color , A + cI ) ; if ( aR . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aR . a ) ; else { aR = GLSL_TEXTURE ( u_color , A - cI ) ; if ( aR . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aR . a ) ; } }".split(" ")}]}},{a:"elif",i:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float hb = u_delta [ 0 ] ; float hc = u_delta [ 1 ] ; float hd = 1.0 / 3.0 ; float he = 0.5 ; vec2 hf = vec2 ( hd , he ) ; if ( u_tex_number == 0 ) { vec2 bO = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hf + vec2 ( 2.0 * hd , he ) ; bO [ 0 ] = max ( bO [ 0 ] , 2.0 * hd + hb ) ; bO [ 1 ] = max ( bO [ 1 ] , hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bO [ 0 ] , he - bO [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bO = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hf + vec2 ( 0.0 , he ) ; bO [ 0 ] = max ( bO [ 0 ] , hb ) ; bO [ 1 ] = min ( bO [ 1 ] , he - hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hd - bO [ 0 ] , bO [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bO = A * hf + vec2 ( 2.0 * hd , he ) ; bO [ 0 ] = max ( bO [ 0 ] , 2.0 * hd + hb ) ; bO [ 1 ] = min ( bO [ 1 ] , 1.0 - hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bO [ 0 ] , 1.5 - bO [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bO = A * hf + vec2 ( hd , 0.0 ) ; bO [ 0 ] = max ( bO [ 0 ] , hd + hb ) ; bO [ 0 ] = min ( bO [ 0 ] , 2.0 * hd - hb ) ; bO [ 1 ] = min ( bO [ 1 ] , he - hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bO [ 0 ] , bO [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bO = A * hf + vec2 ( hd , he ) ; bO [ 0 ] = max ( bO [ 0 ] , hd + hb ) ; bO [ 0 ] = min ( bO [ 0 ] , 2.0 * hd - hb ) ; bO [ 1 ] = min ( bO [ 1 ] , 1.0 - hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bO [ 0 ] , 3.0 * he - bO [ 1 ] ) ) ; } else { vec2 bO = A * hf + vec2 ( 0.0 , he ) ; bO [ 0 ] = max ( bO [ 0 ] , hb ) ; bO [ 1 ] = min ( bO [ 1 ] , 1.0 - hc ) ; bO [ 1 ] = max ( bO [ 1 ] , he + hc ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hd - bO [ 0 ] , bO [ 1 ] ) ) ; }".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["postprocessing/postprocessing.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]},e["postprocessing/smaa.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",b:["0"]},{a:"var",c:"SMAA_DISABLE_CORNER_DETECTION",b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_ULTRA"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2},"SMAA_PREDICATION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","hg",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 hh ; GLSL_IN vec4 hi ; GLSL_IN vec4 hj ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","hk",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",j:{a:"grp",f:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",j:{a:"grp",f:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ho ( vec2 bO , sampler2D hl ) { float p = GLSL_TEXTURE ( hl , bO ) . r ; float hm = GLSL_TEXTURE ( hl , hh . xy ) . r ; float hn = GLSL_TEXTURE ( hl , hh . zw ) . r ; return vec3 ( p , hm , hn ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hs ( vec2 bO , sampler2D hp ) { vec3 hq = ho ( bO , hp ) ; vec2 cI = abs ( hq . xx - hq . yz ) ; vec2 hr = step ( SMAA_PREDICATION_THRESHOLD , cI ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hr ) ; }".split(" ")}]}}]},{a:"txt",b:"void hw ( bvec2 ht , inout vec2 hu , vec2 hv ) { if ( ht . x ) hu . x = hv . x ; if ( ht . y ) hu . y = hv . y ; } void hw ( bvec4 ht , inout vec4 hu , vec4 hv ) { hw ( ht . xy , hu . xy , hv . xy ) ; hw ( ht . zw , hu . zw , hv . zw ) ; } vec2 hx ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hx ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hK ( vec2 bO , sampler2D hy".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","hp"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:"vec2 hz = hs ( bO , hp ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hz = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hA = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hB = dot ( GLSL_TEXTURE ( hy , bO ) . rgb , hA ) ; float hC = dot ( GLSL_TEXTURE ( hy , hh . xy ) . rgb , hA ) ; float hD = dot ( GLSL_TEXTURE ( hy , hh . zw ) . rgb , hA ) ; vec4 cI ; cI . xy = abs ( hB - vec2 ( hC , hD ) ) ; vec2 hr = step ( hz , cI . xy ) ; if ( dot ( hr , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hE = dot ( GLSL_TEXTURE ( hy , hi . xy ) . rgb , hA ) ; float hF = dot ( GLSL_TEXTURE ( hy , hi . zw ) . rgb , hA ) ; cI . zw = abs ( hB - vec2 ( hE , hF ) ) ; vec2 hG = max ( cI . xy , cI . zw ) ; float hH = dot ( GLSL_TEXTURE ( hy , hj . xy ) . rgb , hA ) ; float hI = dot ( GLSL_TEXTURE ( hy , hj . zw ) . rgb , hA ) ; cI . zw = abs ( vec2 ( hC , hD ) - vec2 ( hH , hI ) ) ; hG = max ( hG . xy , cI . zw ) ; float hJ = max ( hG . x , hG . y ) ; hr . xy *= step ( hJ , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cI . xy ) ; return hr ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 hM ( vec2 hL ) { hL . r = hL . r * abs ( 5.0 * hL . r - 5.0 * 0.75 ) ; return hx ( hL ) ; } vec4 hM ( vec4 hL ) { hL . rb = hL . rb * abs ( 5.0 * hL . rb - 5.0 * 0.75 ) ; return hx ( hL ) ; } vec2 hO ( sampler2D hN , vec2 bO , vec2 bq , out vec2 hL ) { vec4 fv = vec4 ( bO , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS_DIAG ; b_ ++ ) { if ( fv . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fv . w > 0.9 ) { fv . xyz += t * vec3 ( bq , 1.0 ) ; hL = GLSL_TEXTURE ( hN , fv . xy , 0.0 ) . rg ; fv . w = dot ( hL , vec2 ( 0.5 , 0.5 ) ) ; } } return fv . zw ; } vec2 hP ( sampler2D hN , vec2 bO , vec2 bq , out vec2 hL ) { vec4 fv = vec4 ( bO , - 1.0 , 1.0 ) ; fv . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS_DIAG ; b_ ++ ) { if ( fv . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fv . w > 0.9 ) { fv . xyz = t * vec3 ( bq , 1.0 ) + fv . xyz ; hL = GLSL_TEXTURE ( hN , fv . xy , 0.0 ) . rg ; hL = hM ( hL ) ; fv . w = dot ( hL , vec2 ( 0.5 , 0.5 ) ) ; } } return fv . zw ; } vec2 hR ( sampler2D hQ , vec2 aN , vec2 hL , float fg ) { vec2 bO = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hL + aN ; bO = SMAA_AREATEX_PIXEL_SIZE * bO + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bO . x += 0.5 ; bO . y += SMAA_AREATEX_SUBTEX_SIZE * fg ; return GLSL_TEXTURE ( hQ , bO , 0.0 ) . rg ; } vec2 hW ( sampler2D hN , sampler2D hQ , vec2 bO , vec2 hL , vec4 hS ) { vec2 hA = vec2 ( 0.0 , 0.0 ) ; vec4 dp ; vec2 hT ; if ( hL . r > 0.0 ) { dp . xz = hO ( hN , bO , vec2 ( - 1.0 , 1.0 ) , hT ) ; dp . x += float ( hT . y > 0.9 ) ; } else dp . xz = vec2 ( 0.0 , 0.0 ) ; dp . yw = hO ( hN , bO , vec2 ( 1.0 , - 1.0 ) , hT ) ; if ( dp . x + dp . y > 2.0 ) { vec4 hU = vec4 ( - dp . x + 0.25 , dp . x , dp . y , - dp . y - 0.25 ) * u_texel_size . xyxy + bO . xyxy ; vec4 dj ; dj . xy = GLSL_TEXTURE ( hN , hU . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; dj . zw = GLSL_TEXTURE ( hN , hU . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; dj . yxwz = hM ( dj . xyzw ) ; vec2 hV = vec2 ( 2.0 , 2.0 ) * dj . xz + dj . yw ; hw ( bvec2 ( step ( 0.9 , dp . zw ) ) , hV , vec2 ( 0.0 , 0.0 ) ) ; hA += hR ( hQ , dp . xy , hV , hS . z ) ; } dp . xz = hP ( hN , bO , vec2 ( - 1 , - 1 ) , hT ) ; if ( GLSL_TEXTURE ( hN , bO + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { dp . yw = hP ( hN , bO , vec2 ( 1 , 1 ) , hT ) ; dp . y += float ( hT . y > 0.9 ) ; } else dp . yw = vec2 ( 0.0 , 0.0 ) ; if ( dp . x + dp . y > 2.0 ) { vec4 hU = vec4 ( - dp . x , - dp . x , dp . y , dp . y ) * u_texel_size . xyxy + bO . xyxy ; vec4 dj ; dj . x = GLSL_TEXTURE ( hN , hU . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; dj . y = GLSL_TEXTURE ( hN , hU . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; dj . zw = GLSL_TEXTURE ( hN , hU . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 hV = vec2 ( 2.0 , 2.0 ) * dj . xz + dj . yw ; hw ( bvec2 ( step ( 0.9 , dp . zw ) ) , hV , vec2 ( 0 , 0 ) ) ; hA += hR ( hQ , dp . xy , hV , hS . w ) . gr ; } return hA ; }".split(" ")}]}}]},{a:"txt",b:"float hZ ( sampler2D hX , vec2 hL , float fg ) { vec2 hf = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 hY = SMAA_SEARCHTEX_SIZE * vec2 ( fg , 1.0 ) ; hf += vec2 ( - 1.0 , 1.0 ) ; hY += vec2 ( 0.5 , - 0.5 ) ; hf *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; hY *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( hX , hf * hL + hY , 0.0 ) . r ; } float h_ ( sampler2D hN , sampler2D hX , vec2 bO , float hT ) { vec2 hL = vec2 ( 0.0 , 1.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS ; b_ ++ ) { if ( bO . x > hT && hL . g > 0.8281 && hL . r == 0.0 ) { hL = GLSL_TEXTURE ( hN , bO , 0.0 ) . rg ; bO = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bO ; } } float fg = - ( 255.0 / 127.0 ) * hZ ( hX , hL , 0.0 ) + 3.25 ; return u_texel_size . x * fg + bO . x ; } float ia ( sampler2D hN , sampler2D hX , vec2 bO , float hT ) { vec2 hL = vec2 ( 0.0 , 1.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS ; b_ ++ ) { if ( bO . x < hT && hL . g > 0.8281 && hL . r == 0.0 ) { hL = GLSL_TEXTURE ( hN , bO , 0.0 ) . rg ; bO = vec2 ( 2.0 , 0.0 ) * u_texel_size + bO ; } } float fg = - ( 255.0 / 127.0 ) * hZ ( hX , hL , 0.5 ) + 3.25 ; return - u_texel_size . x * fg + bO . x ; } float ib ( sampler2D hN , sampler2D hX , vec2 bO , float hT ) { vec2 hL = vec2 ( 1.0 , 0.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS ; b_ ++ ) { if ( bO . y > hT && hL . r > 0.8281 && hL . g == 0.0 ) { hL = GLSL_TEXTURE ( hN , bO , 0.0 ) . rg ; bO = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bO ; } } float fg = - ( 255.0 / 127.0 ) * hZ ( hX , hL . gr , 0.0 ) + 3.25 ; return u_texel_size . y * fg + bO . y ; } float ic ( sampler2D hN , sampler2D hX , vec2 bO , float hT ) { vec2 hL = vec2 ( 1.0 , 0.0 ) ; for ( int b_ = 0 ; b_ < SMAA_MAX_SEARCH_STEPS ; b_ ++ ) { if ( bO . y < hT && hL . r > 0.8281 && hL . g == 0.0 ) { hL = GLSL_TEXTURE ( hN , bO , 0.0 ) . rg ; bO = vec2 ( 0.0 , 2.0 ) * u_texel_size + bO ; } } float fg = - ( 255.0 / 127.0 ) * hZ ( hX , hL . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * fg + bO . y ; } vec2 ig ( sampler2D hQ , vec2 aN , float id , float ie , float fg ) { vec2 bO = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hx ( 4.0 * vec2 ( id , ie ) ) + aN ; bO = SMAA_AREATEX_PIXEL_SIZE * bO + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bO . y = SMAA_AREATEX_SUBTEX_SIZE * fg + bO . y ; return GLSL_TEXTURE ( hQ , bO , 0.0 ) . rg ; } void ij ( sampler2D hN , inout vec2 hA , vec4 bO , vec2 dp ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 ih = step ( dp . xy , dp . yx ) ; vec2 ii = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ih ; ii /= ih . x + ih . y ; vec2 aM = vec2 ( 1.0 , 1.0 ) ; aM . x -= ii . x * GLSL_TEXTURE ( hN , bO . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aM . x -= ii . y * GLSL_TEXTURE ( hN , bO . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aM . y -= ii . x * GLSL_TEXTURE ( hN , bO . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aM . y -= ii . y * GLSL_TEXTURE ( hN , bO . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hA *= clamp ( aM , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"} void ik ( sampler2D hN , inout vec2 hA , vec4 bO , vec2 dp ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 ih = step ( dp . xy , dp . yx ) ; vec2 ii = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ih ; ii /= ih . x + ih . y ; vec2 aM = vec2 ( 1.0 , 1.0 ) ; aM . x -= ii . x * GLSL_TEXTURE ( hN , bO . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aM . x -= ii . y * GLSL_TEXTURE ( hN , bO . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aM . y -= ii . x * GLSL_TEXTURE ( hN , bO . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aM . y -= ii . y * GLSL_TEXTURE ( hN , bO . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hA *= clamp ( aM , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 io ( vec2 bO , vec2 il , sampler2D hN , sampler2D hQ , sampler2D hX , vec4 hS ) { vec4 hA = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hL = GLSL_TEXTURE ( hN , bO ) . rg ; if ( hL . g > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"hA . rg = hW ( hN , hQ , bO , hL , hS ) ; if ( hA . r == - hA . g ) {".split(" ")}]}}]},{a:"txt",b:"vec2 dp ; vec3 hU ; hU . x = h_ ( hN , hX , hh . xy , hj . x ) ; hU . y = hi . y ; dp . x = hU . x ; float id = GLSL_TEXTURE ( hN , hU . xy , 0.0 ) . r ; hU . z = ia ( hN , hX , hh . zw , hj . y ) ; dp . y = hU . z ; dp = abs ( hx ( dp / u_texel_size . xx - il . xx ) ) ; vec2 im = sqrt ( dp ) ; float ie = GLSL_TEXTURE ( hN , hU . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hA . rg = ig ( hQ , im , id , ie , hS . y ) ; hU . y = bO . y ; ij ( hN , hA . rg , hU . xyzy , dp ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"} else hL . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hL . r > 0.0 ) { vec2 dp ; vec3 hU ; hU . y = ib ( hN , hX , hi . xy , hj . z ) ; hU . x = hh . x ; dp . x = hU . y ; float id = GLSL_TEXTURE ( hN , hU . xy , 0.0 ) . g ; hU . z = ic ( hN , hX , hi . zw , hj . w ) ; dp . y = hU . z ; dp = abs ( hx ( dp / u_texel_size . yy - il . yy ) ) ; vec2 im = sqrt ( dp ) ; float ie = GLSL_TEXTURE ( hN , hU . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hA . ba = ig ( hQ , im , id , ie , hS . x ) ; hU . x = bO . x ; ik ( hN , hA . ba , hU . xyxz , dp ) ; } return hA ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ix ( vec2 bO , sampler2D hy , sampler2D ip".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iq"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( ip , hg . xy ) . a ; a . y = GLSL_TEXTURE ( ip , hg . zw ) . g ; a . wz = GLSL_TEXTURE ( ip , bO ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aR = GLSL_TEXTURE ( hy , bO , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 ir = GLSL_TEXTURE ( iq , A ) ; vec2 db = 2.0 * is ( ir ) - 1.0 ; aR . a = sqrt ( 2.0 * length ( db ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aR ; } else { bool bY = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 it = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iu = a . yw ; hw ( bvec4 ( bY , bY , bY , bY ) , it , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hw ( bvec2 ( bY , bY ) , iu , a . xz ) ; iu /= dot ( iu , vec2 ( 1.0 , 1.0 ) ) ; vec4 iv = it * vec4 ( u_texel_size , - u_texel_size ) + bO . xyxy ; vec4 aR = iu . x * GLSL_TEXTURE ( hy , iv . xy , 0.0 ) ; aR += iu . y * GLSL_TEXTURE ( hy , iv . zw , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 ir = GLSL_TEXTURE ( iq , iv . xy ) ; vec2 iw = 2.0 * is ( ir ) - 1.0 ; vec2 db = iu . x * iw ; ir = GLSL_TEXTURE ( iq , iv . zw ) ; iw = 2.0 * is ( ir ) - 1.0 ; db += iu . y * iw ; aR . a = sqrt ( 2.0 * length ( db ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aR",";","}","}"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 iC ( vec2 bO , sampler2D iy , sampler2D iz".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iq"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 ir = GLSL_TEXTURE ( iq , A ) ; vec2 db ; db = 2.0 * is ( ir ) - 1.0 ; vec4 iA = GLSL_TEXTURE ( iy , bO ) ; vec4 iB = GLSL_TEXTURE ( iz , bO - db ) ; float cI = abs ( iA . a * iA . a - iB . a * iB . a ) / 2.0 ; float cd = 0.5 * clamp ( 1.0 - sqrt ( cI ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aR = mix ( iA , iB , cd ) ; aR . a = 1.0 ; return aR ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 iA = GLSL_TEXTURE ( iy , bO ) ; vec4 iB = GLSL_TEXTURE ( iz , bO ) ; return mix ( iA , iB , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aR = vec4 ( hK ( A , u_color".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aR = io ( A , hk , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aR = ix ( A , u_color , u_blend".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aR = vec4 ( iC ( A , u_color , u_color_prev".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 aR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aR",";","}"]}]},e["postprocessing/smaa.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform PRECISION vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","hg",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec4 hh ; GLSL_OUT vec4 hi ; GLSL_OUT vec4 hj ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","hk",";"]}]}}]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iD ( vec2 bO ) { hh = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bO . xyxy ; hi = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bO . xyxy ; hj = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bO . xyxy ; }".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iE ( vec2 bO , out vec2 il ) { il = bO / u_texel_size ; hh = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bO . xyxy ; hi = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bO . xyxy ; hj = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hh . xz , hi . yw ) ; }".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iF ( vec2 bO ) { hg = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bO . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iD","(","A",")",";"]}]}},{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"iE ( A , hk ) ;".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iF","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]},e["postprocessing/ssao.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iG ( in vec2 fv ) { return fU ( u_depth , fv , u_camera_range ) ; } void main ( ) { vec3 fY = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_WHITE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fY , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iH = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float dN = iG ( A ) ; float iI = dN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iJ = 8.0 ; const int iK = 1 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iJ = 16.0 ; const int iK = 2 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iJ = 24.0 ; const int iK = 3 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iJ = 32.0 ; const int iK = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iL = u_ssao_radius_increase * 0.001 ; const float iM = 1.0 + 2.4 / iJ ; float iN = 0.0 ; for ( int b_ = 0 ; b_ < iK ; b_ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iO = reflect ( normalize ( vec3 ( x , y , z ) ) , iH ) * ( iL *= iM ) ; vec3 iP = vec3 ( A , iI ) ; iP += vec3 ( iO . xy , iO . z * iI * 2.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iP . z -= 1.4 * ( iP . z - iI ) * step ( iI , iP . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iQ = iG ( iP . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iR = clamp ( ( iI - iQ ) / iQ , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iN += mix ( 1.0 , iR , step ( iQ , iP . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iN += mix ( step ( iP . z , iQ ) , 0.5 , iR ) ;".split(" ")}]}}]},{a:"txt",b:"} iN = iN / iJ ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iN = clamp ( iN * iN + 0.6 * iN , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iN = clamp ( iN * iN + iN , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iS = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * dN ) ; iN = mix ( 1.0 , iN , iS ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fY , iN ) ; }".split(" ")}]},e["postprocessing/ssao_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iG ( in vec2 fv ) { return fU ( u_depth , fv , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iT = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float iU = iG ( A ) ; float cd = 0.0 ; float iV = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 iW = vec2 ( - 2.0 ) ; for ( int b_ = 0 ; b_ < 4 ; ++ b_ ) { for ( int iX = 0 ; iX < 4 ; ++ iX ) { vec2 fg = ( iW + vec2 ( float ( b_ ) , float ( iX ) ) ) * u_texel_size ; float iY = GLSL_TEXTURE ( u_ssao_mask , A + fg ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float iZ = iG ( A + fg ) ; float i_ = 1.0 - clamp ( abs ( iZ - iU ) * iV , 0.0 , 1.0 ) ; iT += iY * i_ ; cd += i_ ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["iT","+=","iY",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iT / cd ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iT / 16.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["postprocessing/stereo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"DISTOR_SCALE",b:["0.8"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["ANAGLYPH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jj ( vec2 bO , vec2 ao , float cW , sampler2D ja ) { vec2 jb = ( bO - ao ) * 4.0 * u_texel_size [ 0 ] / u_texel_size [ 1 ] / cW ; float jc = jb . x * jb . x + jb . y * jb . y ; vec2 jd = jb * ( 1.0 + u_distortion_params [ 0 ] * jc + u_distortion_params [ 1 ] * jc * jc ) ; vec2 je = jd * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jf = je * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jc * u_chromatic_aberration_coefs [ 1 ] ) + 0.5 ; vec2 jg = je + 0.5 ; vec2 jh = je * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jc * u_chromatic_aberration_coefs [ 3 ] ) + 0.5 ; if ( clamp ( jh , 0.0 , 1.0 ) != jh ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 ji = GLSL_TEXTURE ( ja , jg ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( ja , jf ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = ji . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( ja , jh ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = ji . w ; } } else { je += 0.5 ; if ( clamp ( je , 0.0 , 1.0 ) != je ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( ja , je ) ; } } }".split(" ")}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ANAGLYPH"],j:{a:"grp",f:[{a:"txt",b:"vec4 jk = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jl = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jm = vec3 ( jk [ 0 ] , jk [ 1 ] , jk [ 2 ] ) ; ch ( jm ) ; vec3 jn = vec3 ( jl [ 0 ] , jl [ 1 ] , jl [ 2 ] ) ; ch ( jn ) ; mat3 jo = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jp = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aR = clamp ( jo * jm , 0.0 , 1.0 ) + clamp ( jp * jn , 0.0 , 1.0 ) ; aX ( aR ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aR , jk [ 3 ] + jl [ 3 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( abs ( u_distortion_params [ 0 ] ) > EPSILON || abs ( u_distortion_params [ 1 ] ) > EPSILON ) if ( A [ 0 ] < 0.5 ) { vec2 bO = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cW = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jj ( bO , ao , cW , u_sampler_left ) ; } else { vec2 bO = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cW = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jj ( bO , ao , cW , u_sampler_right ) ; } else if ( A [ 0 ] < 0.5 ) { vec2 bO = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , bO ) ; } else { vec2 bO = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , bO ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},{a:"txt",b:["}"]}]},e["postprocessing/velocity.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float dN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 jq = vec4 ( A * 2.0 - 1.0 , 2.0 * dN - 1.0 , 1.0 ) ; vec4 cn = u_view_proj_inverse * jq ; vec4 jr = cn / cn . w ; vec4 js = u_view_proj_prev * jr ; js /= js . w ; vec2 db = ( jq . xy - js . xy ) / 4.0 + 0.5 ; db = clamp ( db , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = dO ( db ) ; }".split(" ")}]},e["include/blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 ju ( vec3 rgb ) { vec4 jt = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jt . wz ) , vec4 ( rgb . gb , jt . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dp = q . x - min ( q . w , q . y ) ; float hL = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dp + hL ) ) , dp / ( q . x + hL ) , q . x ) ; } vec3 jw ( vec3 jv ) { vec4 jt = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jv . r , jv . r , jv . r ) + jt . xyz ) * 6.0 - jt . www ) ; return jv . b * mix ( jt . xxx , clamp ( p - jt . xxx , _0_0 , _1_0 ) , jv . g ) ; } vec3 jA ( vec3 jx , vec3 jy , float jz ) { return mix ( jx , jy , jz ) ; } vec3 jB ( vec3 jx , vec3 jy , float jz ) { return jz * jx + jy ; } vec3 jC ( vec3 jx , vec3 jy , float jz ) { return jy - jz * jx ; } vec3 jE ( vec3 jx , vec3 jy , float jz ) { float jD = _1_0 - jz ; return ( vec3 ( jD ) + jz * jx ) * jy ; } vec3 jF ( vec3 jx , vec3 jy , float jz ) { vec3 jD = vec3 ( _1_0 - jz ) ; return vec3 ( _1_0 ) - ( jD + jz * ( vec3 ( _1_0 ) - jx ) ) * ( vec3 ( _1_0 ) - jy ) ; } vec3 jG ( vec3 jx , vec3 jy , float jz ) { vec3 jD = vec3 ( _1_0 - jz ) ; return mix ( jy * ( jD + 2.0 * jz * jx ) , vec3 ( _1_0 ) - ( jD + 2.0 * jz * ( vec3 ( _1_0 ) - jx ) ) * ( vec3 ( _1_0 ) - jy ) , step ( 0.5 , jy ) ) ; } vec3 jH ( vec3 jx , vec3 jy , float jz ) { return mix ( jy , abs ( jx - jy ) , jz ) ; } vec3 jI ( vec3 jx , vec3 jy , float jz ) { return mix ( jy , jy / ( jx + step ( jx , vec3 ( _0_0 ) ) ) , jz ) ; } vec3 jJ ( vec3 jx , vec3 jy , float jz ) { return mix ( jy , min ( jx , jy ) , jz ) ; } vec3 jK ( vec3 jx , vec3 jy , float jz ) { return max ( jz * jx , jy ) ; } vec3 jO ( vec3 jx , vec3 jy , float jz ) { vec3 jL = ju ( jy ) ; if ( jL . y != _0_0 ) { vec3 jM = ju ( jx ) ; vec3 jN = jw ( vec3 ( jL . x , jM . yz ) ) ; return mix ( jx , jN , jz ) ; } return jx ; } vec3 jP ( vec3 jx , vec3 jy , float jz ) { vec3 jL = ju ( jx ) ; if ( jL . y != _0_0 ) { vec3 jM = ju ( jy ) ; return jw ( vec3 ( jL . x , mix ( jL . y , jM . y , jz ) , jL . z ) ) ; } return jx ; } vec3 jQ ( vec3 jx , vec3 jy , float jz ) { vec3 jL = ju ( jx ) ; vec3 jM = ju ( jy ) ; return jw ( vec3 ( jL . xy , mix ( jL . z , jM . z , jz ) ) ) ; } vec3 jR ( vec3 jx , vec3 jy , float jz ) { vec3 jL = ju ( jy ) ; if ( jL . y != _0_0 ) { vec3 jM = ju ( jx ) ; vec3 jN = jw ( vec3 ( jL . xy , jM . z ) ) ; return mix ( jx , jN , jz ) ; } return jx ; } vec3 jT ( vec3 jx , vec3 jy , float jz ) { vec3 jS = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jy ) * ( vec3 ( _1_0 ) - jx ) ; return mix ( jx , ( ( vec3 ( _1_0 ) - jx ) * jy * jx ) + jx * jS , jz ) ; } vec3 jU ( vec3 jx , vec3 jy , float jz ) { return jx + jz * ( 2.0 * jy - _1_0 ) ; } float jY ( float jV , float jW , float jz , float jX ) { float jD = _1_0 - jX ; return ( jD + jz * jV ) * jW ; } float jZ ( float jV , float jW , float jz , float jX ) { float jD = _1_0 - jX ; return _1_0 - ( jD + jz * ( _1_0 - jV ) ) * ( _1_0 - jW ) ; } float j_ ( float jV , float jW , float jz , float jX ) { float jD = _1_0 - jX ; return mix ( jW * ( jD + 2.0 * jz * jV ) , _1_0 - ( jD + 2.0 * jz * ( _1_0 - jV ) ) * ( _1_0 - jW ) , step ( 0.5 , jW ) ) ; }".split(" ")}]}}]}]},e["include/caustics.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"CAUSTICS_GLSLF",j:{a:"grp",f:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",A:"procedural.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bE ( inout vec3 aR , float ka , float eT , vec4 bD , vec3 U , vec3 kb , vec3 kc , vec4 kd , vec3 bp , float bB ) { if ( bB > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ke = bp + U ; ke . xz = 10.0 * sin ( 0.1 * ke . xz ) ; vec3 kg = T ( kf ( kd ) , ke ) ; vec2 bO = kg . xz ; vec3 kh = kb ; float ki = max ( dot ( U , kh ) , 0.0 ) ; float kj = 0.025 ; vec2 kk = CAUST_SPEED * eT ; bO . s += 0.25 * sin ( dot ( bp + eT , vec3 ( 1.0 ) ) ) ; bO . t += 0.35 * ( - sin ( dot ( bp - eT , vec3 ( - 0.7 ) ) ) ) ; bO . st += 0.15 * cos ( 4.0 * ka - kk . x ) + 1.5 * sin ( ka - 0.3 * kk . y ) ; float hf = CAUST_SCALE * ( 1.0 + max ( 0.1 * ka , 0.0 ) ) ; vec3 km = kl ( ( bO / hf ) , kj ) ; km *= CAUST_BRIGHT ; km *= km ; float kn = min ( 0.25 * ka , - ka ) + 1.0 ; kn = max ( kn , 0.0 ) ; float ko = bD [ SUN_NUM ] * ki ; float kp = max ( sign ( ka ) , 0.0 ) ; ko = ko + max ( 0.5 * sign ( - U . y ) * kp , 0.0 ) ; ko = min ( ko , 1.0 ) ; aR += kc * km * kn * ko ; }".split(" ")}]}}]}]},e["include/color_util.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",j:{a:"grp",f:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",A:"std.glsl"},{a:"txt",b:"void ch ( inout float aR ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aR = pow ( aR , 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( aR < 0.04045 ) aR = aR / 12.92 ; else aR = pow ( aR * ( 1.0 / 1.055 ) + 0.0521327 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aX ( inout float aR ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aR = pow ( aR , 1.0 / 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( aR < 0.0031308 ) aR = aR * 12.92 ; else aR = 1.055 * pow ( aR , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",b:"} void ch ( inout vec3 aR ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aR = pow ( aR , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ch ( aR . r ) ; ch ( aR . g ) ; ch ( aR . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aX ( inout vec3 aR ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aR = pow ( aR , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aX ( aR . r ) ; aX ( aR . g ) ; aX ( aR . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aY ( inout vec3 aR , in float J ) {".split(" ")},{a:"cond",f:[{a:"if",i:["PREMULTIPLY_ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aR = aR * J ;".split(" ")}]}}]},{a:"txt",b:"} float fC ( vec4 aR ) { vec3 kq = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kr = dot ( aR . rgb , kq ) ; return kr ; }".split(" ")}]}}]}]},e["include/coverage.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"COVERAGE_GLSLF",j:{a:"grp",f:[{a:"define",c:"COVERAGE_GLSLF",b:[""]},{a:"include",A:"procedural.glslf"},{a:"txt",b:"const float ks = 1000.0 ; bool M ( float J , float kt ) { if ( kt < 0.0 ) J = 1.0 - J ; float ku = floor ( J * ks ) ; float kw = floor ( kv ( gl_FragCoord . xy ) * ks ) ; if ( kt > 0.0 ) return kw < ku ; else return kw >= ku ; }".split(" ")}]}}]}]},e["include/depth_fetch.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",j:{a:"grp",f:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"include",A:"std.glsl"},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float dM ( in float kx , in vec2 ky ) { float dt = ky . x ; float kz = ky . y ;".split(" ")},{a:"cond",f:[{a:"if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kz * ( 1.0 - dt / kx ) / ( kz - dt ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return ( kx - dt ) / ( kz - dt ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float fU ( in sampler2D kA , in vec2 fv , in vec2 ky ) { float dN = GLSL_TEXTURE ( kA , fv ) . r ; float dt = ky . x ; float kz = ky . y ; float kx = 2.0 * dt / ( dt + kz - ( 2.0 * dN - 1.0 ) * ( kz - dt ) ) ; return kx ; }".split(" ")}]}}]}]}}]}]},e["include/dynamic_grass.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",j:{a:"grp",f:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"vec2 kE ( vec3 O , float kB , vec2 kC ) { vec2 kD = vec2 ( ( O . x - kC . x ) / kB , ( O . y - kC . y ) / kB ) ; return fract ( kD ) ; } vec2 kF ( vec2 gs , float kB , vec2 kC ) { return vec2 ( gs . x * kB , gs . y * kB ) + kC ; } av kG ( ) { return av ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"vec4 kQ ( sampler2D kH , vec2 kI ) { float kJ = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kK = GLSL_TEXTURE ( kH , kI ) ; vec4 kL = GLSL_TEXTURE ( kH , kI + vec2 ( kJ , 0.0 ) ) ; vec4 kM = GLSL_TEXTURE ( kH , kI + vec2 ( 0.0 , kJ ) ) ; vec4 kN = GLSL_TEXTURE ( kH , kI + vec2 ( kJ , kJ ) ) ; float a = fract ( kI . x * GRASS_TEXTURE_SIZE ) ; vec4 kO = mix ( kK , kL , a ) ; vec4 kP = mix ( kM , kN , a ) ; float b = fract ( kI . y * GRASS_TEXTURE_SIZE ) ; return mix ( kO , kP , b ) ; }".split(" ")}]}}]},{a:"txt",b:"av a_ ( vec3 O , vec3 V , vec3 kR , vec3 W , vec3 U , vec3 ao , PRECISION sampler2D kS , sampler2D kT , vec3 kU , float kV , vec3 kW , vec4 kX , mat3 N ) { vec3 kY = T ( kX , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kZ = - kY . x ; float k_ = kY . y ; vec2 kC = vec2 ( kW . x - kV * ( 1.0 + kZ ) / 2.0 , kW . y - kV * ( 1.0 - k_ ) / 2.0 ) ; vec2 la = kE ( ao , kV , kC ) ; float lb = kV / 2.0 ; vec2 lc = abs ( kF ( la - vec2 ( 0.5 ) , kV , vec2 ( 0.0 ) ) ) ; float ld = lb * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lc ) > ld ) return kG ( ) ; float le = kV / kU . z ; vec2 lf = ( la - vec2 ( 0.5 ) ) * le + vec2 ( 0.5 ) ; vec3 lg = kY * ( kV / kU . z - 1.0 ) / 2.0 ; lf . x += lg . x ; lf . y += lg . y ; vec4 lh = GLSL_TEXTURE ( kT , lf ) ; float hf = lh . r ; if ( hf < u_scale_threshold ) return kG ( ) ; float li = kU . y - kU . x ;".split(" ")},{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"float bX = kU . y - ( kQ ( kS , lf ) ) . r * li ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bX = kU . y - ( GLSL_TEXTURE ( kS , lf ) ) . r * li ;".split(" ")}]}}]},{a:"txt",b:"vec2 lj = O . xy - ao . xy ; ao . xy = kF ( la , kV , kC ) ; ao . z = bX ; O . xy = ao . xy + lj ; O . z *= hf ; O . z += bX ; vec3 aR = lh . gba ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"O -= ao ; mat3 lk = at ( kW , ao , N ) ; av ax = aw ( O , ao , V , kR , W , U , lk ) ; ax . ao = ao ; ax . aR = aR ; return ll ( ax ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return ll ( av ( O , ao , V , kR , W , U , aR ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]},e["include/environment.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",j:{a:"grp",f:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 co ( vec3 U ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SKY_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , U ) . rgb ;".split(" ")}]}},{a:"elif",i:["SKY_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float lm = 0.5 * U . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , lm ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]},e["include/fog.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"FOG_GLSLF",j:{a:"grp",f:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:"void lr ( inout vec3 aR , in float ln , in float bX , in vec4 lo ) { float lp = clamp ( ( ln - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOG_TYPE","QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["lp","*=","lp",";"]}]}},{a:"elif",i:["FOG_TYPE","LINEAR",{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"lp = sqrt ( lp ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bX > u_fog_params . w ) lp = 0.0 ; else { float lq = ( u_fog_params . w - max ( bX , 0.0 ) ) / u_fog_params . w ; lp *= lq * lq ; } } lo . a = 1.0 - ( 1.0 - lp ) * ( 1.0 - u_fog_params . x ) ; aR = mix ( aR , lo . rgb , lo . a ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 lw ( in mat4 ls , in vec3 C ) { vec3 lt = mix ( ls [ 0 ] . rgb , ls [ 1 ] . rgb , ( C . x + 1.0 ) / 2.0 ) ; vec3 lu = mix ( ls [ 2 ] . rgb , ls [ 3 ] . rgb , ( C . y + 1.0 ) / 2.0 ) ; vec3 lv = vec3 ( ls [ 0 ] . a , ls [ 1 ] . a , ls [ 2 ] . a ) ; vec3 aR = mix ( lt , lu , abs ( C . y ) ) ; aR = mix ( aR , lv , abs ( C . z ) ) ; ch ( aR ) ; return aR ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"void ly ( inout float lx ) { lx -= 0.5 ; lx = 4.0 * ( lx * lx * lx ) + 0.5 ; } void lE ( inout vec3 aR , in float ln , in vec3 C , in float d_ , in vec4 lz , in float eK ) { float lA = max ( C . z , 0.0 ) ; float lB = max ( ln - max ( d_ / lA , 0.0 ) , 0.0 ) ; float lC = lz . w * lB ; vec3 ea = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lD = lz . rgb ; lC = min ( lC , 1.0 ) ; ly ( lC ) ; lC *= clamp ( 2.0 - eK , 0.0 , 1.0 ) ; vec3 eb = mix ( lD , ea , min ( lA , 1.0 ) ) ; d_ = clamp ( - d_ * 0.03 , 0.0 , 0.8 ) ; eb *= 1.0 - d_ ; aR = mix ( aR , eb , lC ) ; }".split(" ")}]}}]},{a:"txt",b:"void bF ( inout vec3 aR , float ln , vec3 C , float bC ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 ls = lw ( u_cube_fog , C ) ; vec4 eb = vec4 ( ls , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","eb","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lr ( aR , ln , h . z , eb ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"lE ( aR , ln , C , u_cam_water_depth , u_underwater_fog_color_density , bC ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]},e["include/fxaa.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSLF",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PS3",j:{a:"grp",f:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_360",j:{a:"grp",f:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_360_OPT",j:{a:"grp",f:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC",j:{a:"grp",f:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC_CONSOLE",j:{a:"grp",f:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_120",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_130",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_3",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_4",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_5",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_EARLY_EXIT",j:{a:"grp",f:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_DISCARD",j:{a:"grp",f:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"cond",f:[{a:"ifdef",c:"GL_EXT_gpu_shader4",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["FXAA_HLSL_5",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["2.0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",12,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",23,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",A:"color_util.glslf"},{a:"txt",b:"float lF ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_BLEND4WEB",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 lG ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lI ( sampler2D t , vec2 p , vec2 lH , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lH * r ) ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 fR ( vec2 eM , sampler2D hl , vec2 lJ , float lK , float lL , float lM ) { vec2 lN ; lN . x = eM . x ; lN . y = eM . y ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 lO = lG ( hl , lN ) ; float fD = fC ( lO ) ; float lP = fC ( lI ( hl , lN , vec2 ( 0 , 1 ) , lJ . xy ) ) ; float lQ = fC ( lI ( hl , lN , vec2 ( 1 , 0 ) , lJ . xy ) ) ; float lR = fC ( lI ( hl , lN , vec2 ( 0 , - 1 ) , lJ . xy ) ) ; float lS = fC ( lI ( hl , lN , vec2 ( - 1 , 0 ) , lJ . xy ) ) ;".split(" ")}]}}]},{a:"txt",b:"float lT = max ( lP , fD ) ; float lU = min ( lP , fD ) ; float lV = max ( lQ , lT ) ; float lW = min ( lQ , lU ) ; float lX = max ( lR , lS ) ; float lY = min ( lR , lS ) ; float lZ = max ( lX , lV ) ; float l_ = min ( lY , lW ) ; float ma = lZ * lL ; float mb = lZ - l_ ; float mc = max ( lM , ma ) ; bool md = mb < mc ; if ( md ) return lO ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fE = fC ( lI ( hl , lN , vec2 ( - 1 , - 1 ) , lJ . xy ) ) ; float fH = fC ( lI ( hl , lN , vec2 ( 1 , 1 ) , lJ . xy ) ) ; float fF = fC ( lI ( hl , lN , vec2 ( 1 , - 1 ) , lJ . xy ) ) ; float fG = fC ( lI ( hl , lN , vec2 ( - 1 , 1 ) , lJ . xy ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[]}}]},{a:"txt",b:"float me = lR + lP ; float mf = lS + lQ ; float mg = 1.0 / mb ; float mh = me + mf ; float mi = ( - 2.0 * fD ) + me ; float mj = ( - 2.0 * fD ) + mf ; float mk = fF + fH ; float ml = fE + fF ; float mm = ( - 2.0 * lQ ) + mk ; float mn = ( - 2.0 * lR ) + ml ; float mo = fE + fG ; float mp = fG + fH ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( abs ( mj ) * 2.0 ) + abs ( mn ) ; float ms = ( - 2.0 * lS ) + mo ; float mt = ( - 2.0 * lP ) + mp ; float mu = abs ( ms ) + mq ; float mv = abs ( mt ) + mr ; float mw = mo + mk ; float mx = lJ . x ; bool my = mu >= mv ; float mz = mh * 2.0 + mw ; if ( ! my ) lR = lS ; if ( ! my ) lP = lQ ; if ( my ) mx = lJ . y ; float mA = ( mz * ( 1.0 / 12.0 ) ) - fD ; float mB = lR - fD ; float mC = lP - fD ; float mD = lR + fD ; float mE = lP + fD ; bool mF = abs ( mB ) >= abs ( mC ) ; float mG = max ( abs ( mB ) , abs ( mC ) ) ; if ( mF ) mx = - mx ; float mH = lF ( abs ( mA ) * mg ) ; vec2 mI ; mI . x = lN . x ; mI . y = lN . y ; vec2 mJ ; mJ . x = ( ! my ) ? 0.0 : lJ . x ; mJ . y = ( my ) ? 0.0 : lJ . y ; if ( ! my ) mI . x += mx * 0.5 ; if ( my ) mI . y += mx * 0.5 ; vec2 mK ; mK . x = mI . x - mJ . x * FXAA_QUALITY_P0 ; mK . y = mI . y - mJ . y * FXAA_QUALITY_P0 ; vec2 mL ; mL . x = mI . x + mJ . x * FXAA_QUALITY_P0 ; mL . y = mI . y + mJ . y * FXAA_QUALITY_P0 ; float mM = ( ( - 2.0 ) * mH ) + 3.0 ; float mN = fC ( lG ( hl , mK ) ) ; float mO = mH * mH ; float mP = fC ( lG ( hl , mL ) ) ; if ( ! mF ) mD = mE ; float mQ = mG * 1.0 / 4.0 ; float mR = fD - mD * 0.5 ; float mS = mM * mO ; bool mT = mR < 0.0 ; mN -= mD * 0.5 ; mP -= mD * 0.5 ; bool mU = abs ( mN ) >= mQ ; bool mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P1 ; bool mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P1 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P1 ; if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P2 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P2 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P2 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P3 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P3 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P3 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",4,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P4 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P4 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P4 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",5,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P5 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P5 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P5 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",6,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P6 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P6 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P6 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",7,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P7 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P7 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P7 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",8,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P8 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P8 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P8 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",9,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P9 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P9 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P9 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",10,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P10 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P10 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P10 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",11,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P11 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P11 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P11 ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",12,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mW ) { if ( ! mU ) mN = fC ( lG ( hl , mK . xy ) ) ; if ( ! mV ) mP = fC ( lG ( hl , mL . xy ) ) ; if ( ! mU ) mN = mN - mD * 0.5 ; if ( ! mV ) mP = mP - mD * 0.5 ; mU = abs ( mN ) >= mQ ; mV = abs ( mP ) >= mQ ; if ( ! mU ) mK . x -= mJ . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y -= mJ . y * FXAA_QUALITY_P12 ; mW = ( ! mU ) || ( ! mV ) ; if ( ! mV ) mL . x += mJ . x * FXAA_QUALITY_P12 ; if ( ! mV ) mL . y += mJ . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mX = lN . x - mK . x ; float mY = mL . x - lN . x ; if ( ! my ) mX = lN . y - mK . y ; if ( ! my ) mY = mL . y - lN . y ; bool mZ = ( mN < 0.0 ) != mT ; float m_ = ( mY + mX ) ; bool na = ( mP < 0.0 ) != mT ; float nb = 1.0 / m_ ; bool nc = mX < mY ; float nd = min ( mX , mY ) ; bool ne = nc ? mZ : na ; float nf = mS * mS ; float ng = ( nd * ( - nb ) ) + 0.5 ; float nh = nf * lK ; float ni = ne ? ng : 0.0 ; float nj = max ( ni , nh ) ; if ( ! my ) lN . x += nj * mx ; if ( my ) lN . y += nj * mx ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_DISCARD",1,{a:"equal_expr",l:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return lG ( hl , lN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( lG ( hl , lN ) . xyz , fD ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]},e["include/halo_color.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"HALO_COLOR_GLSLF",j:{a:"grp",f:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const int nk = NUM_RINGS ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const int nk = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nl ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"void ns ( inout float nm , in float nn [ nk ] , in float no ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float np = 40.0 * nn [ a ] ; float nq = 300.0 * ( nl ( np ) - 0.005 ) ; float nr = np ; float lp = abs ( nr * ( u_halo_size * nq - no ) ) ; nm += 1.0 - min ( lp , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"void nx ( inout float nt , in float nn [ nk ] , in float aN ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nu = nn [ a ] ; float nv = nu ; float nw = 1000.0 * ( nl ( nu ) - 0.005 ) ; float lp = 20.0 * abs ( nv * A . x + nw * A . y ) ; nt += 1.0 - min ( lp , 1.0 ) ; } nt *= aN ; }".split(" ")}]}}]},{a:"txt",b:"void nB ( inout float aN , in vec2 bO ) { float ny , by ; by = atan ( bO . y , bO . x ) ; by *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float nz = cos ( by ) ; float nA = sin ( by ) ; by = ( nz * bO . x + nA * bO . y ) * ( nz * bO . y - nA * bO . x ) ; ny = abs ( by ) ; if ( ny < 1.0 ) { ny = ( 0.01 * u_halo_size ) / ( ny ) ; aN *= sqrt ( min ( ny , 1.0 ) ) ; } } vec4 bi ( ) { float aN = ( A . x * A . x + A . y * A . y ) ; float no = sqrt ( aN ) ; aN = max ( 1.0 - aN , 0.0 ) ; aN = pow ( aN , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float nn [ nk ] ; for ( int b_ = 0 ; b_ < nk ; b_ ++ ) { nn [ b_ ] = fract ( bh / float ( b_ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"float nm = 0.0 ; ns ( nm , nn , no ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"float nt = 0.0 ; nx ( nt , nn , aN ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_STARS"],j:{a:"grp",f:[{a:"txt",b:"nB ( aN , A ) ;".split(" ")}]}}]},{a:"txt",b:"aN *= J ; vec3 aR = u_diffuse_color . rgb ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"nm *= aN ; aR += u_halo_rings_color * nm ; aN += nm ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"nt *= J ; aR += u_halo_lines_color * nt ; aN += nt ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"aN *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float kn = u_halo_stars_blend * ( bf . y - u_halo_stars_height ) ; aN *= clamp ( kn , 0.0 , 1.0 ) ; aN *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nC = vec4 ( aR , aN ) ; return nC ; }".split(" ")}]}}]}]},e["include/lighting_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",A:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",u:[],s:[{a:"node_out",c:"nQ",h:["vec3"],g:!1},{a:"node_out",c:"nR",h:["vec3"],g:!1},{a:"node_out",c:"nS",h:["vec3"],g:!1},{a:"node_out",c:"nT",h:["vec3"],g:!0},{a:"node_out",c:"nU",h:["vec3"],g:!0},{a:"node_out",c:"nV",h:["vec2"],g:!0},{a:"node_out",c:"nW",h:["vec2"],g:!0},{a:"node_out",c:"nX",h:["vec4"],g:!0},{a:"node_out",c:"nY",h:["float"],g:!0},{a:"node_out",c:"nZ",h:["vec4"],g:!0}],m:[{a:"txt",b:"nQ = nD ; nR = nE ; nS = nF ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nT"],m:[{a:"txt",b:["nT","=","nG",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nU"],m:[{a:"txt",b:["nU","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nW"],m:[{a:"txt",b:["nW","=","nK",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nV"],m:[{a:"txt",b:["nV","=","nL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nX"],m:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nY"],m:[{a:"txt",b:["nY","=","nN",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nZ"],m:[{a:"txt",b:["nZ","=","nO",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_in",c:"ob",h:["vec3"],g:!1},{a:"node_out",c:"oc",h:["vec4"],g:!1},{a:"node_out",c:"od",h:["vec3"],g:!1}],m:[{a:"txt",b:"oc = vec4 ( n_ + ob * oa , _0_0 ) ; od = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"oe",h:["vec4"],g:!1},{a:"node_out",c:"of",h:["vec3"],g:!1},{a:"node_out",c:"og",h:["vec2"],g:!1},{a:"node_out",c:"oh",h:["vec3"],g:!1},{a:"node_out",c:"oi",h:["float"],g:!1}],m:[{a:"txt",b:"og = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oi","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oi","=","_0_0",";"]}]}]},{a:"txt",b:"oh = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"oh *= oe [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oj = u_light_positions [ LAMP_IND ] . xyz ; of = oj - nH ; float aN = length ( of ) ; float ok = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aN * aN ) ; of = normalize ( of ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ol = u_light_directions [ LAMP_IND ] ; float om = dot ( of , ol ) ; om *= smoothstep ( _0_0 , _1_0 , ( om - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; ok *= om ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"ok *= max ( LAMP_LIGHT_DIST - aN , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["oh","*=","ok",";"]}]},{a:"node_else",m:[{a:"txt",b:"of = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"on",h:["vec3"],g:!1},{a:"node_in",c:"oo",h:["vec2"],g:!1},{a:"node_in",c:"op",h:["vec3"],g:!1},{a:"node_in",c:"oq",h:["float"],g:!1},{a:"node_in",c:"or",h:["vec2"],g:!1},{a:"node_out",c:"os",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( on , B . xyz ) ; op = cross ( ot , B . xyz ) ; op = - normalize ( op ) ;".split(" ")}]}]},{a:"txt",b:"os = _0_0 ; if ( oo . r != _0_0 ) { float ou = ( _1_0 - oq ) * dot ( op , on ) + oq ; if ( or [ 0 ] == _0_0 ) { os = _1_0 ; } else { float t = _1_0 + abs ( ou ) ; t = or [ 1 ] + ( _1_0 - or [ 1 ] ) * pow ( t , or [ 0 ] ) ; os = clamp ( t , _0_0 , _1_0 ) ; } os = max ( os , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ov",h:["vec3"],g:!1},{a:"node_in",c:"ow",h:["vec2"],g:!1},{a:"node_in",c:"ox",h:["vec3"],g:!1},{a:"node_in",c:"oy",h:["float"],g:!1},{a:"node_out",c:"oz",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( ov , B . xyz ) ; ox = cross ( ot , B . xyz ) ; ox = - normalize ( ox ) ;".split(" ")}]}]},{a:"txt",b:"oz = _0_0 ; if ( ow . r != _0_0 ) { float ou = ( _1_0 - oy ) * dot ( ox , ov ) + oy ; oz = max ( ou , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oA",h:["vec3"],g:!1},{a:"node_in",c:"oB",h:["vec2"],g:!1},{a:"node_in",c:"oC",h:["vec3"],g:!1},{a:"node_in",c:"oD",h:["float"],g:!1},{a:"node_in",c:"oE",h:["vec2"],g:!1},{a:"node_out",c:"oF",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oA , B . xyz ) ; oC = cross ( ot , B . xyz ) ; oC = - normalize ( oC ) ;".split(" ")}]}]},{a:"txt",b:"oF = _0_0 ; if ( oB . r != _0_0 ) { float ou = ( _1_0 - oD ) * dot ( oC , oA ) + oD ; if ( oE [ 0 ] > _0_0 ) { float oG = max ( dot ( oC , nJ ) , _0_0 ) ; float oH = oE [ 0 ] * oE [ 0 ] ; float cq = _1_0 - _0_5 * ( oH / ( oH + 0.33 ) ) ; vec3 oI = oA - ou * oC ; vec3 oJ = nJ - oG * oC ; if ( length ( oI ) == _0_0 || length ( oJ ) == _0_0 || abs ( ou ) > _1_0 || abs ( oG ) > _1_0 ) oF = ou * cq ; else { float oK = acos ( ou ) ; float oL = acos ( oG ) ; vec3 oM = normalize ( oI ) ; vec3 oN = normalize ( oJ ) ; float a , b ; a = max ( oK , oL ) ; b = min ( oK , oL ) ; b *= 0.95 ; float t = max ( dot ( oM , oN ) , _0_0 ) ; float oO = 0.45 * ( oH / ( oH + 0.09 ) ) ; oF = ou * ( cq + ( oO * t * sin ( a ) * tan ( b ) ) ) ; } } else oF = ou ; oF = max ( oF , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oP",h:["vec3"],g:!1},{a:"node_in",c:"oQ",h:["vec2"],g:!1},{a:"node_in",c:"oR",h:["vec3"],g:!1},{a:"node_in",c:"oS",h:["float"],g:!1},{a:"node_in",c:"oT",h:["vec2"],g:!1},{a:"node_out",c:"oU",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oP , B . xyz ) ; oR = cross ( ot , B . xyz ) ; oR = - normalize ( oR ) ;".split(" ")}]}]},{a:"txt",b:"oU = _0_0 ; if ( oQ . r != _0_0 ) { float ou = ( _1_0 - oS ) * dot ( oR , oP ) + oS ; float oG = max ( dot ( oR , nJ ) , _0_0 ) ; if ( oT [ 0 ] <= _1_0 ) oU = ou * pow ( max ( oG * ou , 0.1 ) , oT [ 0 ] - _1_0 ) ; else oU = ou * pow ( 1.0001 - oG , oT [ 0 ] - _1_0 ) ; oU = max ( oU , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oV",h:["vec3"],g:!1},{a:"node_in",c:"oW",h:["vec2"],g:!1},{a:"node_in",c:"oX",h:["vec3"],g:!1},{a:"node_in",c:"oY",h:["float"],g:!1},{a:"node_in",c:"oZ",h:["vec2"],g:!1},{a:"node_out",c:"o_",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oV , B . xyz ) ; oX = cross ( ot , B . xyz ) ; oX = - normalize ( oX ) ;".split(" ")}]}]},{a:"txt",b:"o_ = _0_0 ; if ( oW . r != _0_0 ) { float ou = ( _1_0 - oY ) * dot ( oX , oV ) + oY ; float pa = acos ( ou ) ; if ( pa < oZ [ 0 ] ) o_ = _1_0 ; else if ( pa > ( oZ [ 0 ] + oZ [ 1 ] ) || oZ [ 1 ] == _0_0 ) o_ = _0_0 ; else o_ = _1_0 - ( ( pa - oZ [ 0 ] ) / oZ [ 1 ] ) ; o_ = max ( o_ , _0_0 ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pb",h:["vec3"],g:!1},{a:"node_in",c:"pc",h:["vec2"],g:!1},{a:"node_in",c:"pd",h:["vec3"],g:!1},{a:"node_in",c:"pe",h:["float"],g:!1},{a:"node_in",c:"pf",h:["vec2"],g:!1},{a:"node_out",c:"pg",h:["float"],g:!1}],m:[{a:"txt",b:"pg = _0_0 ; if ( pc . g != _0_0 ) { vec3 ph = normalize ( pb + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pe == _0_0 ) { pg = dot ( B . xyz , ph ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pg = ( _1_0 - pe ) * max ( dot ( pd , ph ) , _0_0 ) + pe ;".split(" ")}]}]},{a:"txt",b:"pg = pow ( pg , pf [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pi",h:["vec3"],g:!1},{a:"node_in",c:"pj",h:["vec2"],g:!1},{a:"node_in",c:"pk",h:["vec3"],g:!1},{a:"node_in",c:"pl",h:["float"],g:!1},{a:"node_in",c:"pm",h:["vec2"],g:!1},{a:"node_out",c:"pn",h:["float"],g:!1}],m:[{a:"txt",b:"pn = _0_0 ; if ( pj . g != _0_0 ) { vec3 ph = normalize ( pi + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pl == _0_0 ) { pn = dot ( B . xyz , ph ) ; pn = sqrt ( _1_0 - pn * pn ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pn = max ( dot ( pk , ph ) , _0_0 ) ; pn = ( _1_0 - pl ) * pn + pl ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oG = max ( dot ( B . xyz , nJ ) , _0_0 ) ; oG = sqrt ( _1_0 - oG * oG ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oG = max ( dot ( pk , nJ ) , _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"pn = pow ( pn , pm [ 0 ] ) ; pn = pn / ( 0.1 + oG ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"po",h:["vec3"],g:!1},{a:"node_in",c:"pr",h:["vec2"],g:!1},{a:"node_in",c:"pu",h:["vec3"],g:!1},{a:"node_in",c:"pv",h:["float"],g:!1},{a:"node_in",c:"pw",h:["vec2"],g:!1},{a:"node_out",c:"px",h:["float"],g:!1}],m:[{a:"txt",b:"px = _0_0 ; if ( pr . g != _0_0 ) { vec3 ph = normalize ( po + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = _0_0 ; float oG = _0_0 ; float pz = _0_0 ; if ( pv == _0_0 ) { py = dot ( B . xyz , ph ) ; oG = dot ( B . xyz , nJ ) ; pz = dot ( B . xyz , po ) ; py = sqrt ( _1_0 - py * py ) ; oG = sqrt ( _1_0 - oG * oG ) ; pz = sqrt ( _1_0 - pz * pz ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = max ( dot ( pu , ph ) , 0.01 ) ; float oG = max ( dot ( pu , nJ ) , 0.01 ) ; float pz = max ( dot ( pu , po ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float by = tan ( acos ( py ) ) ; float J = max ( pw [ 0 ] , 0.01 ) ; px = pz * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( by * by ) / ( J * J ) ) / ( sqrt ( oG * pz ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pA",h:["vec3"],g:!1},{a:"node_in",c:"pB",h:["vec2"],g:!1},{a:"node_in",c:"pC",h:["vec3"],g:!1},{a:"node_in",c:"pD",h:["float"],g:!1},{a:"node_in",c:"pE",h:["vec2"],g:!1},{a:"node_out",c:"pF",h:["float"],g:!1}],m:[{a:"txt",b:"pF = _0_0 ; if ( pB . g != _0_0 ) { vec3 bY = normalize ( pA + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pG = dot ( bY , B . xyz ) ; float by = pE [ 0 ] + pE [ 1 ] ; if ( pD == _0_0 ) by = acos ( sqrt ( _1_0 - pG * pG ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float by = acos ( dot ( bY , pC ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( by < pE [ 0 ] ) pF = _1_0 ; else if ( by >= pE [ 0 ] + pE [ 1 ] || pE [ 1 ] == _0_0 ) pF = _0_0 ; else pF = _1_0 - ( by - pE [ 0 ] ) / pE [ 1 ] ; }".split(" ")}]},{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pH",h:["vec3"],g:!1},{a:"node_in",c:"pI",h:["vec2"],g:!1},{a:"node_in",c:"pJ",h:["vec3"],g:!1},{a:"node_in",c:"pK",h:["float"],g:!1},{a:"node_in",c:"pL",h:["vec2"],g:!1},{a:"node_out",c:"pM",h:["float"],g:!1}],m:[{a:"txt",b:"float pN = pL [ 0 ] ; float pO = pL [ 1 ] ; pM = _0_0 ; if ( pI . g != _0_0 ) { if ( pN < 1.0 || pO == _0_0 ) pM = _0_0 ; else { if ( pO < 100.0 ) pO = sqrt ( 1.0 / pO ) ; else pO = 10.0 / pO ; vec3 ph = normalize ( nJ + pH ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = 0.0 ; if ( pK == _0_0 ) { float pP = dot ( B . xyz , ph ) ; py = sqrt ( _1_0 - pP * pP ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = ( _1_0 - pK ) * max ( dot ( pJ , ph ) , _0_0 ) + pK ;".split(" ")}]}]},{a:"txt",b:"if ( py < _0_0 ) pM = _0_0 ; else { float oG = max ( dot ( pJ , nJ ) , 0.01 ) ; float pz = dot ( pJ , pH ) ; if ( pz <= 0.01 ) pM = _0_0 ; else { float pQ = max ( dot ( nJ , ph ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * py * oG ) / pQ ; float dj = ( 2.0 * py * pz ) / pQ ; float g = min ( min ( a , b ) , dj ) ; float p = sqrt ( pow ( pN , 2.0 ) + pow ( pQ , 2.0 ) - _1_0 ) ; float lx = pow ( p - pQ , 2.0 ) / pow ( p + pQ , 2.0 ) * ( _1_0 + pow ( pQ * ( p + pQ ) - _1_0 , 2.0 ) / pow ( pQ * ( p - pQ ) + _1_0 , 2.0 ) ) ; float pa = acos ( py ) ; pM = max ( lx * g * exp ( - pow ( pa , 2.0 ) / ( 2.0 * pow ( pO , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pR",h:["vec4"],g:!1},{a:"node_in",c:"pS",h:["vec3"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["float"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec3"],g:!1},{a:"node_in",c:"pX",h:["vec4"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["vec3"],g:!1},{a:"node_in",c:"qa",h:["float"],g:!1},{a:"node_out",c:"qb",h:["vec4"],g:!1},{a:"node_out",c:"qc",h:["vec3"],g:!1}],m:[{a:"txt",b:"qc = pS + p_ * pZ * pU ; qb = pR + vec4 ( p_ * pY * pT , pU ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",u:[],s:[{a:"node_in",c:"qd",h:["vec4"],g:!1},{a:"node_in",c:"qe",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = qd . rgb ; nP = qe ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cz ( vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec3 nJ , vec2 nK , vec2 nL , vec4 nM , float nN , vec4 nO , out vec3 D , out vec3 nP ) {".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]},e["include/math.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MATH_GLSLV",j:{a:"grp",f:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"struct av { vec3 O ; vec3 ao ; vec3 V ; vec3 aC ; vec3 W ; vec3 U ; vec3 aR ; } ; bool qf ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 T ( in vec4 q , in vec3 ke ) { return ke + 2.0 * cross ( q . xyz , cross ( q . xyz , ke ) + q . w * ke ) ; } vec4 kf ( in vec4 qg ) { return vec4 ( - qg . xyz , qg . w ) ; } vec4 qi ( in vec4 a , in vec4 b ) { vec4 qh ; qh . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; qh . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; qh . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; qh . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return qh ; } vec4 X ( in vec3 qj , in float qk ) { vec4 qh ; qk = qk * 0.5 ; float s = sin ( qk ) ; qh . x = s * qj [ 0 ] ; qh . y = s * qj [ 1 ] ; qh . z = s * qj [ 2 ] ; qh . w = cos ( qk ) ; return qh ; } vec4 qn ( in vec3 bq , in vec3 ql ) { vec4 qh ; float dp = dot ( ql , bq ) ; vec3 qm = cross ( ql , bq ) ; qh . xyz = qm . xyz ; qh . w = 1.0 + dp ; return normalize ( qh ) ; } vec3 qu ( vec4 qo , vec4 qg , vec3 qr ) { vec3 qh = qr * qo . w ; qh = T ( qg , qh ) ; qh += qo . xyz ; return qh ; } vec3 ap ( mat3 qv , vec3 qr ) { vec3 qh = qr * qv [ 1 ] [ 0 ] ; vec4 qg = vec4 ( qv [ 1 ] [ 1 ] , qv [ 1 ] [ 2 ] , qv [ 2 ] [ 0 ] , qv [ 2 ] [ 1 ] ) ; qh = T ( qg , qh ) ; qh += qv [ 0 ] ; return qh ; } vec3 qw ( vec4 qo , vec4 qg , vec3 bq ) { vec3 qh = bq * qo . w ; qh = T ( qg , qh ) ; return qh ; } vec3 _ ( mat3 qv , vec3 bq ) { vec3 qh = bq * qv [ 1 ] [ 0 ] ; vec4 qg = vec4 ( qv [ 1 ] [ 1 ] , qv [ 1 ] [ 2 ] , qv [ 2 ] [ 0 ] , qv [ 2 ] [ 1 ] ) ; qh = T ( qg , qh ) ; return qh ; } vec3 qx ( vec4 qo , vec4 qg , vec3 qr ) { vec3 qh = qr - qo . xyz ; qh = T ( kf ( qg ) , qh ) ; qh /= qo . w ; return qh ; } vec3 qy ( vec4 qo , vec4 qg , vec3 bq ) { return T ( kf ( qg ) , bq ) / qo . w ; } mat4 qz ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qA ( float by ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( by ) , sin ( by ) , _0_0 , _0_0 , - sin ( by ) , cos ( by ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qB ( float by ) { return mat4 ( cos ( by ) , _0_0 , - sin ( by ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( by ) , _0_0 , cos ( by ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qC ( float by ) { return mat4 ( cos ( by ) , sin ( by ) , _0_0 , _0_0 , - sin ( by ) , cos ( by ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } av ll ( in av ke ) { return av ( ke . O , ke . ao , normalize ( ke . V ) , normalize ( ke . aC ) , normalize ( ke . W ) , normalize ( ke . U ) , ke . aR ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 aD ( vec4 f ) { float fs = f . x ; float ft = f . y ; float fu = f . w ; vec3 qD ; qD . x = ( fs + fu ) / 2.0 ; qD . y = ( ft + fu ) / 2.0 ; qD . z = fu ; return qD ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cR ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 bd ( mat3 t ) { mat4 qE ; qE [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qE [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 0 ] [ 3 ] = _0_0 ; qE [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qE [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 1 ] [ 3 ] = _0_0 ; qE [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qE [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qE [ 2 ] [ 3 ] = _0_0 ; qE [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qE [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qE [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qE [ 3 ] [ 3 ] = 1.0 ; return qE ; } mat3 aZ ( in mat3 qv , in mat3 qF ) { mat3 qh ; vec3 qr = qF [ 0 ] ; vec4 qo = vec4 ( qv [ 0 ] , qv [ 1 ] [ 0 ] ) ; vec4 qg = vec4 ( qv [ 1 ] [ 1 ] , qv [ 1 ] [ 2 ] , qv [ 2 ] [ 0 ] , qv [ 2 ] [ 1 ] ) ; qh [ 0 ] = qu ( qo , qg , qr ) ; qh [ 1 ] [ 0 ] = qv [ 1 ] [ 0 ] * qF [ 1 ] [ 0 ] ; qh [ 1 ] [ 1 ] = qv [ 1 ] [ 1 ] * qF [ 2 ] [ 1 ] + qv [ 2 ] [ 1 ] * qF [ 1 ] [ 1 ] + qv [ 1 ] [ 2 ] * qF [ 2 ] [ 0 ] - qv [ 2 ] [ 0 ] * qF [ 1 ] [ 2 ] ; qh [ 1 ] [ 2 ] = qv [ 1 ] [ 2 ] * qF [ 2 ] [ 1 ] + qv [ 2 ] [ 1 ] * qF [ 1 ] [ 2 ] + qv [ 2 ] [ 0 ] * qF [ 1 ] [ 1 ] - qv [ 1 ] [ 1 ] * qF [ 2 ] [ 0 ] ; qh [ 2 ] [ 0 ] = qv [ 2 ] [ 0 ] * qF [ 2 ] [ 1 ] + qv [ 2 ] [ 1 ] * qF [ 2 ] [ 0 ] + qv [ 1 ] [ 1 ] * qF [ 1 ] [ 2 ] - qv [ 1 ] [ 2 ] * qF [ 1 ] [ 1 ] ; qh [ 2 ] [ 1 ] = qv [ 2 ] [ 1 ] * qF [ 2 ] [ 1 ] - qv [ 1 ] [ 1 ] * qF [ 1 ] [ 1 ] - qv [ 1 ] [ 2 ] * qF [ 1 ] [ 2 ] - qv [ 2 ] [ 0 ] * qF [ 2 ] [ 0 ] ; return qh ; } mat3 cU ( in vec4 qg , in mat3 qv ) { mat3 qh ; qh [ 0 ] = qv [ 0 ] ; qh [ 1 ] [ 0 ] = qv [ 1 ] [ 0 ] ; qh [ 1 ] [ 1 ] = qg [ 0 ] ; qh [ 1 ] [ 2 ] = qg [ 1 ] ; qh [ 2 ] [ 0 ] = qg [ 2 ] ; qh [ 2 ] [ 1 ] = qg [ 3 ] ; return qh ; } vec4 R ( in vec4 qG ) { return normalize ( qG ) ; } vec4 R ( in vec4 qG , out float P , out float Q ) { vec4 qg = R ( qG ) ; P = length ( qG ) * M_PI ; Q = sign ( qG [ 3 ] ) ; return R ( qG ) ; }".split(" ")}]}}]}]},e["include/mirror.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MIRROR_GLSLF",j:{a:"grp",f:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_BSDF_SKY_DIM",b:[""]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qH ( in vec3 C , vec3 eg , float eF , float eE ) { vec3 eC = normalize ( eg + C ) ; float eD = 1.0 - dot ( C , eC ) ; float r = eE + ( 1.0 - eE ) * pow ( eD , eF ) ; return r ; } void cA ( inout vec3 qI , vec3 C , vec3 U , float qJ , mat3 N ) { vec3 eg = reflect ( - C , U ) ; float eF = u_fresnel_params [ 2 ] ; float eE = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( eF != 0.0 ) r = qH ( C , eg , eF , eE ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 el = GLSL_TEXTURE_CUBE ( u_cube_reflection , eg ) . xyz ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qK = u_refl_plane . xyz * dot ( U , u_refl_plane . xyz ) ; vec3 qL = U - qK ; vec2 qM = _ ( N , qL ) . xy ; vec2 qN = l . xy / l . z ; qN += qM * REFL_BUMP ; vec3 el = GLSL_TEXTURE ( u_plane_reflection , qN ) . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 el = vec3 ( 1.0 ) ; qJ = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 el = GLSL_TEXTURE_CUBE ( u_mirrormap , eg ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"ch ( el . rgb ) ; qI = mix ( qI , el , qJ * r ) ; } vec3 qX ( vec3 qI , vec3 qO , vec3 C , vec3 U , float qP , float qQ , mat3 N ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},"USE_BSDF_SKY_DIM",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float qR = max ( dot ( U , C ) , _0_0 ) ; float qS = qP + ( max ( _1_0 - qQ , qP ) - qP ) * pow ( _1_0 - qR , 5.0 ) ; vec3 eg = reflect ( - C , U ) ; float qT = 2.0 / ( qQ * qQ ) - 2.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"txt",b:["float","qU","=","u_bsdf_cube_sky_dim",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float qU = float ( textureSize ( u_cube_reflection , 0 ) . x ) ;".split(" ")}]}}]},{a:"txt",b:"float qV = log2 ( qU * sqrt ( 3.0 ) ) - _0_5 * log2 ( qT + _1_0 ) ; vec3 el = GLSL_TEXTURE_CUBE_LOD ( u_cube_reflection , eg , qV ) . xyz ; ch ( el ) ; el *= qO ; vec3 qW = GLSL_TEXTURE_CUBE_LOD ( u_cube_reflection , U , 100.0 ) . xyz ; ch ( qW ) ; qW *= qI ; return qW + qS * el ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qK = u_refl_plane . xyz * dot ( U , u_refl_plane . xyz ) ; vec3 qL = U - qK ; vec2 qM = _ ( N , qL ) . xy ; vec2 qN = l . xy / l . z ; qN += qM * REFL_BUMP ; vec3 el = GLSL_TEXTURE ( u_plane_reflection , qN ) . rgb ; ch ( el ) ; el *= qO ; return mix ( qI , el , qP ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 el = qO ; return mix ( qI , el , qP ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]},e["include/nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"IS_WORLD",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"mirror.glslf"},{a:"include",A:"shadow.glslf"},{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","qY",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"vec3 rc ( in vec3 qZ , in float q_ ) { vec3 eu = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"eu = cC ( l , qZ . xy * q_ ) ;".split(" ")}]}},{a:"elif",i:["HAS_REFRACT_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"eu = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; ch ( eu ) ;".split(" ")}]}}]},{a:"txt",b:["return","eu",";","}"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 ju ( vec3 rgb ) { vec4 jt = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jt . wz ) , vec4 ( rgb . gb , jt . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dp = q . x - min ( q . w , q . y ) ; float hL = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dp + hL ) ) , dp / ( q . x + hL ) , q . x ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jw ( vec3 jv ) { vec4 jt = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jv . r , jv . r , jv . r ) + jt . xyz ) * 6.0 - jt . www ) ; return jv . b * mix ( jt . xxx , clamp ( p - jt . xxx , _0_0 , _1_0 ) , jv . g ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 rd ( vec2 gs ) { return vec3 ( gs * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 re ( vec3 qr ) { return vec2 ( qr . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float rk ( vec3 rf , vec3 rh , float ri ) { float dj = abs ( dot ( rf , rh ) ) ; float g = ri * ri - _1_0 + dj * dj ; float rj ; if ( g > _0_0 ) { g = sqrt ( g ) ; float cq = ( g - dj ) / ( g + dj ) ; float oO = ( dj * ( g + dj ) - _1_0 ) / ( dj * ( g - dj ) + _1_0 ) ; rj = _0_5 * cq * cq * ( _1_0 + oO * oO ) ; } else { rj = _1_0 ; } return rj ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",u:[],s:[{a:"node_out",c:"rK",h:["vec3"],g:!0},{a:"node_out",c:"rL",h:["float"],g:!0},{a:"node_out",c:"rM",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rK"],m:[{a:"txt",b:"rK = normalize ( rH . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rL"],m:[{a:"txt",b:"rL = abs ( rH . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rM"],m:[{a:"txt",b:"rM = length ( rH . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"rN",h:["float"],g:!1},{a:"node_in",c:"rO",h:["float"],g:!1},{a:"node_in",c:"rP",h:["float"],g:!1},{a:"node_out",c:"rQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"rQ = vec3 ( rN , rO , rP ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"rR",h:["float"],g:!1},{a:"node_in",c:"rS",h:["float"],g:!1},{a:"node_in",c:"rT",h:["float"],g:!1},{a:"node_out",c:"rU",h:["vec3"],g:!1}],m:[{a:"txt",b:"rU = jw ( vec3 ( rR , rS , rT ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rW",h:["vec3"],g:!1}],m:[{a:"txt",b:"rW = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rX",h:["vec3"],g:!1},{a:"node_param",c:"rl",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"rX = rd ( rl ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rY",h:["vec3"],g:!1}],m:[{a:"txt",b:"rY = 2.0 * qY - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_out",c:"rZ",h:["vec3"],g:!1},{a:"node_param",c:"rm",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"rZ = max ( vec3 ( _0_0 ) , rm ) ; ch ( rZ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"r_",h:["float"],g:!1},{a:"node_param",c:"rn",h:["GLSL_IN","float"],g:!1}],m:[{a:"txt",b:"r_ = max ( _0_0 , rn ) ; ch ( r_ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1},{a:"node_param",c:"ro",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"sa = max ( _0_0 , ro [ 0 ] ) ; sb = max ( _0_0 , ro [ 1 ] ) ; ch ( sa ) ; ch ( sb ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"sc",h:["float"],g:!1},{a:"node_out",c:"sd",h:["float"],g:!1},{a:"node_out",c:"se",h:["float"],g:!1},{a:"node_param",c:"rp",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"sc = max ( _0_0 , rp [ 0 ] ) ; sd = max ( _0_0 , rp [ 1 ] ) ; se = max ( _0_0 , rp [ 2 ] ) ; ch ( sc ) ; ch ( sd ) ; ch ( se ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"sf",h:["vec3"],g:!1},{a:"node_out",c:"sg",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["sg","=","sf",";"]}]},{a:"node_else",m:[{a:"txt",b:"sg = rA . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"sh",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",u:[],s:[{a:"node_out",c:"si",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"si = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"si = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"sj",h:["vec3"],g:!1}],m:[{a:"txt",b:"sj = - _ ( u_view_tsr_frag , nJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk = rH . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"sl",h:["vec3"],g:!1}],m:[{a:"txt",b:["sl","=","nH",";"]}]},{a:"node",c:"GEOMETRY_IN",u:[],s:[{a:"node_out",c:"sm",h:["vec3"],g:!1}],m:[{a:"txt",b:["sm","=","nJ",";"]}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"sn",h:["vec3"],g:!1},{a:"node_out",c:"so",h:["vec3"],g:!1},{a:"node_out",c:"sr",h:["vec3"],g:!1},{a:"node_out",c:"su",h:["vec3"],g:!1},{a:"node_out",c:"sv",h:["vec3"],g:!1},{a:"node_out",c:"sw",h:["vec3"],g:!1},{a:"node_out",c:"sx",h:["float"],g:!1},{a:"node_out",c:"sy",h:["float"],g:!1}],m:[{a:"txt",b:"sn = vec3 ( _0_0 ) ; so = vec3 ( _0_0 ) ; sr = vec3 ( _0_0 ) ; su = vec3 ( _0_0 ) ; sv = vec3 ( _0_0 ) ; sw = vec3 ( _0_0 ) ; sx = _0_0 ; sy = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sz",h:["float"],g:!1},{a:"node_in",c:"sA",h:["float"],g:!1},{a:"node_in",c:"sB",h:["float"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_out",c:"sE",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jv = ju ( sD ) ; jv [ 0 ] += ( sz - _0_5 ) ; if ( jv [ 0 ] > _1_0 ) jv [ 0 ] -= _1_0 ; else if ( jv [ 0 ] < _0_0 ) jv [ 0 ] += _1_0 ; jv *= vec3 ( _1_0 , sA , sB ) ; jv = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jv , step ( vec3 ( _0_0 ) , jv ) ) , step ( jv , vec3 ( _1_0 ) ) ) ; sE = mix ( sD , jw ( jv ) , sC ) ;".split(" ")}]},{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_out",c:"sH",h:["vec3"],g:!1}],m:[{a:"txt",b:"sH = mix ( sG , vec3 ( _1_0 ) - sG , sF ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",c:"sI",h:["vec3"],g:!0},{a:"node_out",c:"sJ",h:["vec3"],g:!1},{a:"node_out",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["LAMP_INDEX",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sI"],m:[{a:"txt",b:"sI = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sM = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sN = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sJ = - h + sN ; sK = length ( sJ ) ; sJ = normalize ( sJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sL"],m:[{a:"txt",b:"sL = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sK * sK ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float om = dot ( sJ , sM ) ; om *= smoothstep ( _0_0 , _1_0 , ( om - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sL *= om ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"sL *= max ( LAMP_LIGHT_DIST - sK , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sJ"],m:[{a:"txt",b:["sJ","=","sM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sK"],m:[{a:"txt",b:"sK = length ( sN - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sL"],m:[{a:"txt",b:["sL","=","_1_0",";"]}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sI"],m:[{a:"txt",b:"sI = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"sJ = vec3 ( _0_0 ) ; sK = 0.0 ;".split(" ")}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!0},{a:"node_out",c:"sQ",h:["float"],g:!0},{a:"node_param",c:"rq",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sP"],m:[{a:"txt",b:["sP","=","rq",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sQ"],m:[{a:"txt",b:"sQ = - dot ( sO , rq ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sR",h:["vec3"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1}],m:[{a:"txt",b:"sS = - _ ( u_view_tsr_frag , sR ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",u:[],s:[{a:"node_in",c:"sT",h:["vec3"],g:!1},{a:"node_in",c:"sU",h:["vec3"],g:!1},{a:"node_in",c:"sV",h:["float"],g:!1},{a:"node_in",c:"sW",h:["vec3"],g:!1},{a:"node_in",c:"sX",h:["float"],g:!1},{a:"node_in",c:"sY",h:["float"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",c:"ta",h:["float"],g:!1},{a:"node_in",c:"tb",h:["vec3"],g:!1},{a:"node_in",c:"tc",h:["float"],g:!1},{a:"node_out",c:"td",h:["vec3"],g:!1},{a:"node_out",c:"te",h:["vec3"],g:!1},{a:"node_out",c:"tf",h:["vec3"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1},{a:"node_out",c:"th",h:["vec3"],g:!1},{a:"node_out",c:"ti",h:["vec4"],g:!1},{a:"node_out",c:"tj",h:["vec4"],g:!1},{a:"node_out",c:"tk",h:["vec3"],g:!1},{a:"node_out",c:"tl",h:["vec3"],g:!1},{a:"node_out",c:"tm",h:["vec3"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["vec3"],g:!1},{a:"node_out",c:"tr",h:["float"],g:!1}],m:[{a:"txt",b:"tf = sU ; tg = sW ; th = sZ ; tk = sU ; tl = sW ; tm = s_ ; tn = ta ; to = tb ; tr = tc ; td = rI * tf ; te = rJ * u_environment_energy * co ( th ) ; tj = cr ( tf ) ; G = tj ; ti [ 0 ] = sV ; ti [ 1 ] = sX ; ti [ 2 ] = sY ;".split(" ")}]},{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"tu",h:["vec4"],g:!1},{a:"node_in",c:"tv",h:["vec3"],g:!1},{a:"node_in",c:"tw",h:["vec3"],g:!1},{a:"node_in",c:"tx",h:["vec4"],g:!1},{a:"node_in",c:"ty",h:["vec3"],g:!1},{a:"node_in",c:"tz",h:["vec3"],g:!1},{a:"node_in",c:"tA",h:["vec3"],g:!1},{a:"node_in",c:"tB",h:["float"],g:!1},{a:"node_in",c:"tC",h:["vec3"],g:!1},{a:"node_in",c:"tD",h:["float"],g:!1},{a:"node_out",c:"tE",h:["vec3"],g:!1}],m:[{a:"txt",b:"float tF = clamp ( tx [ 1 ] , _0_0 , _1_0 ) ; float qP = tx [ 2 ] ; tE = tu . rgb ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"tE += qX ( ty , tz , nJ , tw , qP , tF , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"tE += qX ( ty , tz , nJ , tw , qP , u_view_tsr_frag ) ;".split(" ")}]}]},{a:"txt",b:"tE += tv ; tE = mix ( tE , tA , tB ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],m:[{a:"txt",b:"vec3 tG = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; ch ( tG ) ; tC = tC * tG ; tE += tC ;".split(" ")}]}]},{a:"txt",b:["tw",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["vec2"],g:!1},{a:"node_in",c:"tJ",h:["vec3"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec4"],g:!1},{a:"node_out",c:"tM",h:["float"],g:!1},{a:"node_out",c:"tN",h:["float"],g:!1}],m:[{a:"txt",b:"vec3 rh = tJ ; float tO = clamp ( tL [ 0 ] , _0_0 , _1_0 ) ; float tF = clamp ( tL [ 1 ] , _0_0 , _1_0 ) ; float qP = tL [ 2 ] ; vec3 ph = normalize ( nJ + tH ) ; float ou = ( _1_0 - tK ) * dot ( rh , tH ) + tK ; float tP = ( _1_0 - tK ) * max ( dot ( tH , ph ) , _0_0 ) + tK ; float tQ = ( _1_0 - tK ) * max ( dot ( tJ , ph ) , _0_0 ) + tK ; tM = _0_0 ; if ( tI . r != _0_0 ) { if ( tO > _0_0 ) { float oG = max ( dot ( rh , nJ ) , _0_0 ) ; float oH = tO * tO ; float cq = _1_0 - _0_5 * ( oH / ( oH + 0.33 ) ) ; vec3 oI = tH - ou * rh ; vec3 oJ = nJ - oG * rh ; if ( length ( oI ) == _0_0 || length ( oJ ) == _0_0 || abs ( ou ) > _1_0 || abs ( oG ) > _1_0 ) tM = ou * cq ; else { float oK = acos ( ou ) ; float oL = acos ( oG ) ; vec3 oM = normalize ( oI ) ; vec3 oN = normalize ( oJ ) ; float a , b ; a = max ( oK , oL ) ; b = min ( oK , oL ) ; b *= 0.95 ; float t = max ( dot ( oM , oN ) , _0_0 ) ; float oO = 0.45 * ( oH / ( oH + 0.09 ) ) ; tM = ou * ( cq + ( oO * t * sin ( a ) * tan ( b ) ) ) ; } } else tM = ou ; tM = max ( tM , _0_0 ) / M_PI ; } float J = tF ; float tR = J * J ; float tS = ( tQ * tR - tQ ) * tQ + _1_0 ; float cn = tR / ( M_PI * tS * tS ) ; float tT ; float tU ; float tV = pow ( _1_0 - tP , 5.0 ) ; tT = _1_0 ; tU = tV ; float jt = J / 2.0 ; float tW = jt * jt ; float tX = _1_0 - tW ; float tY = _1_0 / ( tP * tP * tX + tW ) ; tT *= tY ; tU *= tY ; float tZ = mix ( 0.04 , _1_0 , qP ) ; float t_ = mix ( tU , tT , tZ ) ; tN = max ( ou * cn * t_ , _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"ua",h:["vec3"],g:!1},{a:"node_in",c:"ub",h:["float"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_in",c:"uf",h:["vec3"],g:!1},{a:"node_out",c:"ug",h:["vec3"],g:!1}],m:[{a:"txt",b:"ug = ua ; ub ; uc ; ud ; ue ; uf ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"uh",h:["vec3"],g:!1},{a:"node_in",c:"ui",h:["float"],g:!1},{a:"node_in",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["vec3"],g:!1},{a:"node_out",c:"um",h:["float"],g:!1},{a:"node_out",c:"un",h:["vec3"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["float"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["vec3"],g:!1},{a:"node_out",c:"us",h:["float"],g:!1},{a:"node_out",c:"ut",h:["vec3"],g:!1},{a:"node_out",c:"uu",h:["float"],g:!1}],m:[{a:"txt",b:"ul = uh ; um = ui ; up = _0_0 ; us = _0_0 ; uu = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["uq","=","uj",";"]}]},{a:"node_else",m:[{a:"txt",b:["uq","=","nI",";"]}]}]},{a:"txt",b:"uk ; un = vec3 ( _0_0 ) ; uo = _0_0 ; ur = vec3 ( _0_0 ) ; ut = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"uv",h:["vec3"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",c:"ux",h:["float"],g:!1},{a:"node_in",c:"uy",h:["vec3"],g:!1},{a:"node_out",c:"uz",h:["vec3"],g:!1}],m:[{a:"txt",b:"uz = uv ; uw ; ux ; uy ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"uA",h:["vec3"],g:!1},{a:"node_in",c:"uB",h:["float"],g:!1},{a:"node_in",c:"uC",h:["vec3"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["vec3"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["float"],g:!1},{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["vec3"],g:!1},{a:"node_out",c:"uL",h:["float"],g:!1},{a:"node_out",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["float"],g:!1}],m:[{a:"txt",b:"uG = uA ; uH = uB ; uI = _1_0 ; uL = _0_0 ; uN = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["uJ","=","uC",";"]}]},{a:"node_else",m:[{a:"txt",b:["uJ","=","nI",";"]}]}]},{a:"txt",b:"uD ; uE = vec3 ( _0_0 ) ; uF = _0_0 ; uK = vec3 ( _0_0 ) ; uM = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["float"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS = uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_out",c:"uU",h:["vec3"],g:!1},{a:"node_out",c:"uV",h:["vec3"],g:!1},{a:"node_out",c:"uW",h:["float"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1},{a:"node_out",c:"uY",h:["float"],g:!1},{a:"node_out",c:"uZ",h:["float"],g:!1},{a:"node_out",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1},{a:"node_out",c:"vb",h:["float"],g:!1},{a:"node_out",c:"vc",h:["vec3"],g:!1},{a:"node_out",c:"vd",h:["float"],g:!1}],m:[{a:"txt",b:"vc = uT ; uZ = _0_0 ; vb = _0_0 ; vd = _0_0 ; u_ = nI ; uU ; uV = vec3 ( _0_0 ) ; uW = _0_0 ; uX = vec3 ( _0_0 ) ; uY = _0_0 ; va = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"ve",h:["vec3"],g:!1},{a:"node_in",c:"vf",h:["vec3"],g:!1},{a:"node_out",c:"vg",h:["vec3"],g:!1}],m:[{a:"txt",b:"vg = ve ; vf ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"vh",h:["vec3"],g:!1},{a:"node_in",c:"vi",h:["float"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_in",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1}],m:[{a:"txt",b:"vl [ 0 ] = vl [ 1 ] = vl [ 2 ] = _0_0 ; vh ; vi ; vj ; vk ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"vm",h:["vec3"],g:!1},{a:"node_in",c:"vn",h:["float"],g:!1},{a:"node_in",c:"vo",h:["float"],g:!1},{a:"node_in",c:"vp",h:["vec3"],g:!1},{a:"node_out",c:"vq",h:["vec3"],g:!1}],m:[{a:"txt",b:"vq = vm ; vn ; vo ; vp ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"vr",h:["vec3"],g:!1},{a:"node_in",c:"vs",h:["float"],g:!1},{a:"node_in",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["vec3"],g:!1}],m:[{a:"txt",b:"vu = vr ; vs ; vt ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_in",c:"vw",h:["float"],g:!1},{a:"node_in",c:"vx",h:["vec3"],g:!1},{a:"node_in",c:"vy",h:["float"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_in",c:"vA",h:["vec3"],g:!1},{a:"node_out",c:"vB",h:["vec3"],g:!1}],m:[{a:"txt",b:"vB [ 0 ] = vB [ 1 ] = vB [ 2 ] = _0_0 ; vv ; vx ; vy ; vz ; vA ; vw ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vC",h:["vec3"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],g:!1},{a:"node_out",c:"vF",h:["vec3"],g:!1},{a:"node_out",c:"vG",h:["float"],g:!1},{a:"node_out",c:"vH",h:["vec3"],g:!1},{a:"node_out",c:"vI",h:["float"],g:!1},{a:"node_out",c:"vJ",h:["float"],g:!1},{a:"node_out",c:"vK",h:["vec3"],g:!1},{a:"node_out",c:"vL",h:["vec3"],g:!1},{a:"node_out",c:"vM",h:["float"],g:!1},{a:"node_out",c:"vN",h:["vec3"],g:!1},{a:"node_out",c:"vO",h:["float"],g:!1}],m:[{a:"txt",b:"vL = vD * vC ; vJ = _0_0 ; vM = _1_0 ; vO = _1_0 ; vK = nI ; vE ; vF = vec3 ( _0_0 ) ; vG = _0_0 ; vH = vec3 ( _0_0 ) ; vI = _0_0 ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vP",h:["vec3"],g:!1},{a:"node_out",c:"vQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ; vP ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"vR [ 0 ] = vR [ 1 ] = vR [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vS",h:["vec3"],g:!1},{a:"node_in",c:"vT",h:["float"],g:!1},{a:"node_out",c:"vU",h:["vec3"],g:!1}],m:[{a:"txt",b:"vU [ 0 ] = vU [ 1 ] = vU [ 2 ] = _0_0 ; vS ; vT ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vV",h:["vec3"],g:!1},{a:"node_in",c:"vW",h:["float"],g:!1},{a:"node_in",c:"vX",h:["float"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"BUMP",u:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vZ",h:["float"],g:!1},{a:"node_in",c:"v_",h:["float"],g:!1},{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_in",c:"wb",h:["vec3"],g:!1},{a:"node_out",c:"wc",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aN = v_ ; float ge = vZ ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["INVERT"],m:[{a:"txt",b:["aN","=","-","_1_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["vec3","U","=","wb",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","U","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 wd = dFdx ( nH ) ; vec3 we = dFdy ( nH ) ; vec3 wf = cross ( we , U ) ; vec3 wg = cross ( U , wd ) ; float dk = dot ( wd , wf ) ; float wh = abs ( dk ) ; vec3 wi = dFdx ( wa ) * wf + dFdy ( wa ) * wg ; ge = max ( ge , _0_0 ) ; wc = normalize ( wh * U - aN * sign ( dk ) * wi ) ; wc = normalize ( ge * wc + ( _1_0 - ge ) * U ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["wc","=","U",";"]}]}]}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"wj",h:["float"],g:!1},{a:"node_out",c:"wk",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aN = 0.1 ; vec3 U = nI ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 wd = dFdx ( nH ) ; vec3 we = dFdy ( nH ) ; vec3 wf = cross ( we , U ) ; vec3 wg = cross ( U , wd ) ; float dk = dot ( wd , wf ) ; float wh = abs ( dk ) ; vec3 wi = dFdx ( wj ) * wf + dFdy ( wj ) * wg ; wk = normalize ( wh * U - aN * sign ( dk ) * wi ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["wk","=","U",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["vec4"],g:!1},{a:"node_in",c:"wn",h:["vec3"],g:!1},{a:"node_out",c:"wo",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["vec3","wp","=","wn",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","wp","=","rC",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo = rG * wo ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo . yz *= - _1_0 ; wo = _ ( u_model_tsr , wo ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo . yz *= - _1_0 ;".split(" ")}]}]},{a:"txt",b:"float lp = max ( wl , _0_0 ) ; wo = normalize ( mix ( wp , wo , lp ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"wq",h:["vec3"],g:!1},{a:"node_out",c:"wr",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],m:[{a:"txt",b:["wr","=","wq",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr , wq ) ; wr = ap ( u_view_tsr_frag , wr ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_inverse , wq ) ; wr = ap ( u_model_tsr_inverse , wr ) ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr , wq ) ; wr = _ ( u_view_tsr_frag , wr ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_inverse , wq ) ; wr = _ ( u_model_tsr_inverse , wr ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = normalize ( wr ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"ws",h:["float"],g:!1},{a:"node_out",c:"wt",h:["vec3"],g:!1}],m:[{a:"txt",b:"wt [ 0 ] = wt [ 1 ] = wt [ 2 ] = _0_0 ; ws ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wu",h:["float"],g:!1},{a:"node_out",c:"wv",h:["vec3"],g:!1}],m:[{a:"txt",b:"wv [ 0 ] = wv [ 1 ] = wv [ 2 ] = _0_0 ; wu ;".split(" ")}]},{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wA",h:["vec3"],g:!1},{a:"node_out",c:"wB",h:["float"],g:!1},{a:"node_out",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["float"],g:!1}],m:[{a:"txt",b:"wB = wA [ 0 ] ; wC = wA [ 1 ] ; wD = wA [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wE",h:["float"],g:!1},{a:"node_in",c:"wF",h:["float"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_out",c:"wH",h:["vec3"],g:!1}],m:[{a:"txt",b:"wH [ 0 ] = wE ; wH [ 1 ] = wF ; wH [ 2 ] = wG ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",u:[],s:[{a:"node_in",c:"wI",h:["vec3"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_in",c:"wK",h:["float"],g:!1},{a:"node_out",c:"wL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wJ - wK * _0_5 ; wL = max ( ( _1_0 + wK ) * wI + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wM",h:["float"],g:!1},{a:"node_in",c:"wN",h:["float"],g:!1},{a:"node_out",c:"wO",h:["float"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1},{a:"node_out",c:"wQ",h:["float"],g:!1}],m:[{a:"txt",b:"wO = wP = wQ = _0_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_SKY",u:[],s:[{a:"node_in",c:"wR",h:["vec3"],g:!1},{a:"node_out",c:"wS",h:["vec3"],g:!1}],m:[{a:"txt",b:"wS [ 0 ] = wS [ 1 ] = wS [ 2 ] = _0_0 ; wR ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wT",h:["vec3"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_in",c:"w_",h:["float"],g:!1},{a:"node_in",c:"xa",h:["float"],g:!1},{a:"node_in",c:"xb",h:["float"],g:!1},{a:"node_in",c:"xc",h:["float"],g:!1},{a:"node_out",c:"xd",h:["vec3"],g:!1},{a:"node_out",c:"xe",h:["float"],g:!1}],m:[{a:"txt",b:"xd [ 0 ] = xd [ 1 ] = xd [ 2 ] = _0_0 ; xe = _1_0 ; wZ ; w_ ; xa ; xb ; xc ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"xf",h:["vec3"],g:!1},{a:"node_in",c:"xg",h:["float"],g:!1},{a:"node_out",c:"xh",h:["vec3"],g:!1},{a:"node_out",c:"xi",h:["float"],g:!1}],m:[{a:"txt",b:"xh [ 0 ] = xh [ 1 ] = xh [ 2 ] = _0_0 ; xi = _1_0 ; xf ; xg ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"xj",h:["vec3"],g:!1},{a:"node_in",c:"xk",h:["float"],g:!1},{a:"node_in",c:"xl",h:["float"],g:!1},{a:"node_in",c:"xm",h:["float"],g:!1},{a:"node_in",c:"xn",h:["float"],g:!1},{a:"node_in",c:"xo",h:["float"],g:!1},{a:"node_in",c:"xp",h:["float"],g:!1},{a:"node_out",c:"xq",h:["vec3"],g:!1},{a:"node_out",c:"xr",h:["float"],g:!1}],m:[{a:"txt",b:"xq [ 0 ] = xq [ 1 ] = xq [ 2 ] = _0_0 ; xr = _1_0 ; xj ; xk ; xl ; xm ; xn ; xo ; xp ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"xs",h:["vec3"],g:!1},{a:"node_out",c:"xt",h:["vec3"],g:!1},{a:"node_out",c:"xu",h:["float"],g:!1}],m:[{a:"txt",b:"xt [ 0 ] = xt [ 1 ] = xt [ 2 ] = _0_0 ; xu = _1_0 ; xs ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xv",h:["vec3"],g:!1},{a:"node_in",c:"xA",h:["float"],g:!1},{a:"node_in",c:"xB",h:["float"],g:!1},{a:"node_out",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["float"],g:!1}],m:[{a:"txt",b:"xC [ 0 ] = xC [ 1 ] = xC [ 2 ] = _0_0 ; xD = _1_0 ; xv ; xA ; xB ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xE",h:["vec3"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["float"],g:!1},{a:"node_out",c:"xI",h:["vec3"],g:!1},{a:"node_out",c:"xJ",h:["float"],g:!1}],m:[{a:"txt",b:"xI [ 0 ] = xI [ 1 ] = xI [ 2 ] = _0_0 ; xJ = _1_0 ; xE ; xF ; xG ; xH ;".split(" ")}]},{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xK",h:["vec3"],g:!1},{a:"node_in",c:"xL",h:["vec3"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["float"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",c:"xR",h:["float"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_out",c:"xT",h:["vec3"],g:!1},{a:"node_out",c:"xU",h:["float"],g:!1}],m:[{a:"txt",b:"xT [ 0 ] = xT [ 1 ] = xT [ 2 ] = _0_0 ; xU = _1_0 ; xK ; xL ; xM ; xN ; xO ; xP ; xQ ; xR ; xS ;".split(" ")}]},{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xV",h:["vec3"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_out",c:"xX",h:["vec3"],g:!1}],m:[{a:"txt",b:"xX = clamp ( xV + xW , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",u:[],s:[{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["vec3"],g:!1},{a:"node_in",c:"ya",h:["vec3"],g:!1},{a:"node_in",c:"yb",h:["float"],g:!1},{a:"node_in",c:"yc",h:["vec3"],g:!1},{a:"node_in",c:"yd",h:["float"],g:!1},{a:"node_in",c:"ye",h:["float"],g:!1},{a:"node_in",c:"yf",h:["vec3"],g:!1},{a:"node_in",c:"yg",h:["vec3"],g:!1},{a:"node_in",c:"yh",h:["float"],g:!1},{a:"node_in",c:"yi",h:["vec3"],g:!1},{a:"node_in",c:"yj",h:["float"],g:!1},{a:"node_in",c:"yk",h:["vec3"],g:!1},{a:"node_in",c:"yl",h:["float"],g:!1},{a:"node_in",c:"ym",h:["vec3"],g:!1},{a:"node_in",c:"yn",h:["float"],g:!1},{a:"node_in",c:"yo",h:["float"],g:!1},{a:"node_in",c:"yp",h:["vec3"],g:!1},{a:"node_in",c:"yq",h:["vec3"],g:!1},{a:"node_in",c:"yr",h:["float"],g:!1},{a:"node_in",c:"ys",h:["vec3"],g:!1},{a:"node_in",c:"yt",h:["float"],g:!1},{a:"node_out",c:"yu",h:["vec3"],g:!1},{a:"node_out",c:"yv",h:["vec3"],g:!1},{a:"node_out",c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["vec3"],g:!1},{a:"node_out",c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["float"],g:!1},{a:"node_out",c:"yE",h:["vec3"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["float"],g:!1},{a:"node_out",c:"yH",h:["vec3"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( xY , _0_0 , _1_0 ) ; yv = mix ( ya , yk , yJ ) ; yA = mix ( yb , yl , yJ ) ; if ( ye > _0_0 ) { if ( yo > _0_0 ) { yB = mix ( yc , ym , yJ ) ; yC = mix ( yd , yn , yJ ) ; } else { yB = yc ; yC = yd ; } } else { yB = ym ; yC = yn ; } if ( yh > _0_0 ) { if ( yr > _0_0 ) { yF = mix ( yg , yq , yJ ) ; } else { yF = yg ; } } else { yF = yq ; } yD = mix ( ye , yo , yJ ) ; yE = mix ( yf , yp , yJ ) ; yG = mix ( yh , yr , yJ ) ; yH = mix ( yi , ys , yJ ) ; yI = mix ( yj , yt , yJ ) ;".split(" ")}]},{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"yK",h:["vec3"],g:!1},{a:"node_out",c:"yL",h:["vec3"],g:!1},{a:"node_param",c:"rs",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yK"],m:[{a:"txt",b:"yK = rd ( rs ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yL"],m:[{a:"txt",b:"yL = vec3 ( rs , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yM",h:["vec3"],g:!1},{a:"node_param",c:"rt",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"yM = vec3 ( rt , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yN",h:["vec3"],g:!1}],m:[{a:"txt",b:["yN","=","nI",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yO",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["IS_WORLD",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["yO","=","qY",";"]}]},{a:"node_else",m:[{a:"txt",b:["yO","=","rz",";"]}]}]}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yP",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["IS_WORLD",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:"yP = ap ( u_model_tsr_inverse , nH ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["yP","=","rz",";"]}]}]}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"yQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"yQ . xy = rH . xy ; yQ . z = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR . xy = l . xy / l . z ; yR . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yS",h:["vec3"],g:!1}],m:[{a:"txt",b:"yS = reflect ( - nJ , nI ) ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yT",h:["vec3"],g:!1},{a:"node_param",c:"ru",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"yT = vec3 ( ru , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1},{a:"node_out",c:"yW",h:["float"],g:!1},{a:"node_out",c:"yX",h:["vec3"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["vec3"],g:!1},{a:"node_out",c:"y_",h:["vec3"],g:!1}],m:[{a:"txt",b:"yU = _0_0 ; yV = _0_0 ; yW = _0_0 ; yX = vec3 ( _0_0 ) ; yY = _0_0 ; yZ = yX ; y_ = yX ;".split(" ")}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["vec3"],g:!1}],m:[{a:"txt",b:"za = _0_0 ; zb = _0_0 ; zc = _0_0 ; zd = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],s:[{a:"node_out",c:"ze",h:["vec3"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1},{a:"node_out",c:"zg",h:["float"],g:!1},{a:"node_out",c:"zh",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_LOCATION_OUT"],m:[{a:"txt",b:"ze = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OBJ_IND_OUT"],m:[{a:"txt",b:"zf = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MAT_IND_OUT"],m:[{a:"txt",b:"zg = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_RANDOM_OUT"],m:[{a:"txt",b:"zh = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"zi",h:["float"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:["zj","=","zi",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"zk",h:["vec3"],g:!1}],m:[{a:"txt",b:"zk = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"zl",h:["float"],g:!1},{a:"node_in",c:"zm",h:["vec3"],g:!1},{a:"node_out",c:"zn",h:["float"],g:!1},{a:"node_out",c:"zo",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 cf = normalize ( zm ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","cf","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 zp = normalize ( nJ ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","zp","=","u_camera_direction",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_zn"],m:[{a:"txt",b:"float ri = max ( _1_0 - zl , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"ri = gl_FrontFacing == false ? ri : _1_0 / ri ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"ri = gl_FrontFacing ? ri : _1_0 / ri ;".split(" ")}]}]},{a:"txt",b:"zn = rk ( zp , cf , ri ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["zn","=","_0_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_zo"],m:[{a:"txt",b:"zo = abs ( dot ( zp , cf ) ) ; float dU = zl ; if ( dU != _0_5 ) { dU = clamp ( dU , _0_0 , 0.99999 ) ; dU = ( dU < _0_5 ) ? 2.0 * dU : _0_5 / ( _1_0 - dU ) ; zo = pow ( zo , dU ) ; } zo = _1_0 - zo ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["zo","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["float"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1},{a:"node_out",c:"zt",h:["float"],g:!1},{a:"node_out",c:"zu",h:["float"],g:!1},{a:"node_out",c:"zv",h:["float"],g:!1},{a:"node_out",c:"zA",h:["float"],g:!1},{a:"node_out",c:"zB",h:["float"],g:!1},{a:"node_out",c:"zC",h:["float"],g:!1},{a:"node_out",c:"zD",h:["float"],g:!1},{a:"node_out",c:"zE",h:["float"],g:!1}],m:[{a:"txt",b:"zq = zr = zs = _0_0 ; zt = zu = zv = _0_0 ; zA = zE = zC = zD = _0_0 ; zB = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zF",h:["vec3"],g:!1},{a:"node_out",c:"zG",h:["vec3"],g:!1},{a:"node_out",c:"zH",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zG = vec3 ( _0_0 ) ; zH = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zI",h:["float"],g:!1},{a:"node_in",c:"zJ",h:["vec3"],g:!1},{a:"node_out",c:"zK",h:["vec3"],g:!1}],m:[{a:"txt",b:["zK","=","zJ",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zK . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zK . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zK . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zK = mix ( zJ , zK , zI ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zL",h:["float"],g:!1},{a:"node_in",c:"zM",h:["vec3"],g:!1},{a:"node_out",c:"zN",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float r = zM . r ; float g = zM . g ; float b = zM . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zN . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zN . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . g = g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zN . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . b = b ;".split(" ")}]}]},{a:"txt",b:"zN = mix ( zM , zN , zL ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zO",h:["float"],g:!1},{a:"node_out",c:"zP",h:["vec3"],g:!1},{a:"node_out",c:"zQ",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zO , NODE_TEX_ROW ) ) ; zP = zR . rgb ; zQ = zR . a ;".split(" ")}]},{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zS",h:["vec3"],g:!1},{a:"node_out",c:"zT",h:["vec3"],g:!1}],m:[{a:"txt",b:["zT","=","zS",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zT = zT * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zT = zT + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],m:[{a:"txt",b:"zT = ( MAPPING_TRS_MATRIX * vec4 ( zT , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zT = max ( zT , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zT = min ( zT , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zT = normalize ( zT ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zU",h:["float"],g:!1},{a:"node_in",c:"zV",h:["float"],g:!1},{a:"node_out",c:"zW",h:["float"],g:!1}],m:[{a:"txt",b:"zW = zU + zV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zX",h:["float"],g:!1},{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_out",c:"zZ",h:["float"],g:!1}],m:[{a:"txt",b:"zZ = zX - zY ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zZ = clamp ( zZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"z_",h:["float"],g:!1},{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_out",c:"Ab",h:["float"],g:!1}],m:[{a:"txt",b:"Ab = z_ * Aa ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ab = clamp ( Ab , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ac",h:["float"],g:!1},{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_out",c:"Ae",h:["float"],g:!1}],m:[{a:"txt",b:"Ae = ( Ad != _0_0 ) ? Ac / Ad : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ae = clamp ( Ae , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Af",h:["float"],g:!1},{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_out",c:"Ah",h:["float"],g:!1}],m:[{a:"txt",b:"Ah = sin ( Af ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ag",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ai",h:["float"],g:!1},{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_out",c:"Ak",h:["float"],g:!1}],m:[{a:"txt",b:"Ak = cos ( Ai ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ak = clamp ( Ak , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aj",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Al",h:["float"],g:!1},{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_out",c:"An",h:["float"],g:!1}],m:[{a:"txt",b:"An = tan ( Al ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"An = clamp ( An , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Am",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ao",h:["float"],g:!1},{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_out",c:"Aq",h:["float"],g:!1}],m:[{a:"txt",b:"Aq = ( Ao <= _1_0 && Ao >= - _1_0 ) ? asin ( Ao ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Aq = clamp ( Aq , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ap",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ar",h:["float"],g:!1},{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_out",c:"At",h:["float"],g:!1}],m:[{a:"txt",b:"At = ( Ar <= _1_0 && Ar >= - _1_0 ) ? acos ( Ar ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"At = clamp ( At , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["As",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Au",h:["float"],g:!1},{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_out",c:"Aw",h:["float"],g:!1}],m:[{a:"txt",b:"Aw = atan ( Au ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Aw = clamp ( Aw , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Av",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ax",h:["float"],g:!1},{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_out",c:"Az",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ax < _0_0 && Ay != floor ( Ay ) ) Az = _0_0 ; else if ( Ay == _0_0 ) Az = _1_0 ; else if ( Ax < _0_0 ) Az = mix ( _1_0 , - _1_0 , sign ( mod ( - Ay , 2.0 ) ) ) * pow ( - Ax , Ay ) ; else if ( Ax == _0_0 ) Az = _0_0 ; else Az = pow ( Ax , Ay ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Az = clamp ( Az , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AA",h:["float"],g:!1},{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_out",c:"AC",h:["float"],g:!1}],m:[{a:"txt",b:"AC = ( AA > _0_0 && AB > _0_0 ) ? log2 ( AA ) / log2 ( AB ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AD",h:["float"],g:!1},{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_out",c:"AF",h:["float"],g:!1}],m:[{a:"txt",b:"AF = min ( AD , AE ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AF = clamp ( AF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AG",h:["float"],g:!1},{a:"node_in",c:"AH",h:["float"],g:!1},{a:"node_out",c:"AI",h:["float"],g:!1}],m:[{a:"txt",b:"AI = max ( AG , AH ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AI = clamp ( AI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AJ",h:["float"],g:!1},{a:"node_in",c:"AK",h:["float"],g:!1},{a:"node_out",c:"AL",h:["float"],g:!1}],m:[{a:"txt",b:"AL = floor ( AJ + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AK",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["float"],g:!1},{a:"node_out",c:"AO",h:["float"],g:!1}],m:[{a:"txt",b:"AO = ( AM < AN ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AO = clamp ( AO , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AP",h:["float"],g:!1},{a:"node_in",c:"AQ",h:["float"],g:!1},{a:"node_out",c:"AR",h:["float"],g:!1}],m:[{a:"txt",b:"AR = ( AP > AQ ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AR = clamp ( AR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AS",h:["float"],g:!1},{a:"node_in",c:"AT",h:["float"],g:!1},{a:"node_out",c:"AU",h:["float"],g:!1}],m:[{a:"txt",b:"AU = abs ( AT ) > 0.000001 ? mod ( AS , AT ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AU = clamp ( AU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AV",h:["float"],g:!1},{a:"node_in",c:"AW",h:["float"],g:!1},{a:"node_out",c:"AX",h:["float"],g:!1}],m:[{a:"txt",b:"AX = abs ( AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AW",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AY",h:["float"],g:!1},{a:"node_in",c:"AZ",h:["vec3"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_out",c:"Ba",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( AY , _0_0 , _1_0 ) ; Ba = mix ( AZ , A_ , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ba = clamp ( Ba , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bb",h:["float"],g:!1},{a:"node_in",c:"Bc",h:["vec3"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_out",c:"Be",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bb , _0_0 , _1_0 ) ; Be = mix ( Bc , Bc + Bd , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Be = clamp ( Be , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bf",h:["float"],g:!1},{a:"node_in",c:"Bg",h:["vec3"],g:!1},{a:"node_in",c:"Bh",h:["vec3"],g:!1},{a:"node_out",c:"Bi",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bf , _0_0 , _1_0 ) ; Bi = mix ( Bg , Bg * Bh , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bi = clamp ( Bi , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bj",h:["float"],g:!1},{a:"node_in",c:"Bk",h:["vec3"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_out",c:"Bm",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bj , _0_0 , _1_0 ) ; Bm = mix ( Bk , Bk - Bl , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bm = clamp ( Bm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bn",h:["float"],g:!1},{a:"node_in",c:"Bo",h:["vec3"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_out",c:"Bq",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bn , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Bq = vec3 ( _1_0 ) - ( vec3 ( Br ) + yJ * ( vec3 ( _1_0 ) - Bp ) ) * ( vec3 ( _1_0 ) - Bo ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bq = clamp ( Bq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bs",h:["float"],g:!1},{a:"node_in",c:"Bt",h:["vec3"],g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_out",c:"Bv",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bs , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Bu += step ( Bu , vec3 ( _0_0 ) ) ; Bv = Br * Bt + yJ * Bt / Bu ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bv = clamp ( Bv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bw",h:["float"],g:!1},{a:"node_in",c:"Bx",h:["vec3"],g:!1},{a:"node_in",c:"By",h:["vec3"],g:!1},{a:"node_out",c:"Bz",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bw , _0_0 , _1_0 ) ; Bz = mix ( Bx , abs ( Bx - By ) , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bz = clamp ( Bz , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BA",h:["float"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_in",c:"BC",h:["vec3"],g:!1},{a:"node_out",c:"BD",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BA , _0_0 , _1_0 ) ; BD = min ( BB . rgb , BC . rgb * yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BD = clamp ( BD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BE",h:["float"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_in",c:"BG",h:["vec3"],g:!1},{a:"node_out",c:"BH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BE , _0_0 , _1_0 ) ; BH = max ( BF . rgb , BG . rgb * yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BH = clamp ( BH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BI , _0_0 , _1_0 ) ; vec3 BM = vec3 ( _1_0 - yJ ) ; BL = mix ( BJ * ( BM + 2.0 * yJ * BK ) , vec3 ( _1_0 ) - ( BM + 2.0 * yJ * ( vec3 ( _1_0 ) - BK ) ) * ( vec3 ( _1_0 ) - BJ ) , step ( _0_5 , BJ ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BN",h:["float"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_in",c:"BP",h:["vec3"],g:!1},{a:"node_out",c:"BQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BN , _0_0 , _1_0 ) ; vec3 BR = vec3 ( _1_0 ) - yJ * BP ; vec3 BS = clamp ( BO / BR , _0_0 , _1_0 ) ; BQ = mix ( mix ( BS , vec3 ( _1_0 ) , step ( BR , vec3 ( _0_0 ) ) ) , BO , step ( BO , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BQ = clamp ( BQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BT",h:["float"],g:!1},{a:"node_in",c:"BU",h:["vec3"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_out",c:"BW",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BT , _0_0 , _1_0 ) ; vec3 jD = vec3 ( _1_0 - yJ ) ; vec3 BR = jD + yJ * BV ; vec3 BS = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BU ) / BR , _0_0 , _1_0 ) ; BW = mix ( BS , vec3 ( _0_0 ) , step ( BR , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BW = clamp ( BW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BX",h:["float"],g:!1},{a:"node_in",c:"BY",h:["vec3"],g:!1},{a:"node_in",c:"BZ",h:["vec3"],g:!1},{a:"node_out",c:"B_",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BX , _0_0 , _1_0 ) ; vec3 jv , Ca , BR ; B_ = BY ; Ca = ju ( BZ ) ; if ( Ca . y != _0_0 ) { jv = ju ( B_ ) ; jv . x = Ca . x ; BR = jw ( jv ) ; B_ = mix ( B_ , BR , yJ ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"B_ = clamp ( B_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cb",h:["float"],g:!1},{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["vec3"],g:!1},{a:"node_out",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cb , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Ce = Cc ; vec3 jv , Ca ; jv = ju ( Ce ) ; if ( jv . y != _0_0 ) { Ca = ju ( Cd ) ; jv . y = Br * jv . y + yJ * Ca . y ; Ce = jw ( jv ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ce = clamp ( Ce , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["float"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["vec3"],g:!1},{a:"node_out",c:"Ci",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cf , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; vec3 jv , Ca ; jv = ju ( Cg ) ; Ca = ju ( Ch ) ; jv . z = Br * jv . z + yJ * Ca . z ; Ci = jw ( jv ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ci = clamp ( Ci , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cj",h:["float"],g:!1},{a:"node_in",c:"Ck",h:["vec3"],g:!1},{a:"node_in",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cj , _0_0 , _1_0 ) ; vec3 jv , Ca , BR ; Cm = Ck ; Ca = ju ( Cl ) ; if ( Ca . y != _0_0 ) { jv = ju ( Cm ) ; jv . x = Ca . x ; jv . y = Ca . y ; BR = jw ( jv ) ; Cm = mix ( Cm , BR , yJ ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cm = clamp ( Cm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cn",h:["float"],g:!1},{a:"node_in",c:"Co",h:["vec3"],g:!1},{a:"node_in",c:"Cp",h:["vec3"],g:!1},{a:"node_out",c:"Cq",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cn , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; vec3 Cr = Cp + Co - Cp * Co ; Cq = Co * ( vec3 ( Br ) + vec3 ( yJ ) * ( ( vec3 ( _1_0 ) - Co ) * Cp + Cr ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cq = clamp ( Cq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["float"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_out",c:"Cv",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cs , _0_0 , _1_0 ) ; Cv = Ct + yJ * ( 2.0 * Cu - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cv = clamp ( Cv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_WORLD_RGB",u:[],s:[{a:"node_in",c:"Cw",h:["float"],g:!1},{a:"node_in",c:"Cx",h:["vec3"],g:!1},{a:"node_in",c:"Cy",h:["vec3"],g:!1},{a:"node_out",c:"Cz",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cw , _0_0 , _1_0 ) ; Cz = mix ( Cx , Cy , yJ ) ;".split(" ")}]},{a:"node",c:"ADD_WORLD_RGB",u:[],s:[{a:"node_in",c:"CA",h:["float"],g:!1},{a:"node_in",c:"CB",h:["vec3"],g:!1},{a:"node_in",c:"CC",h:["vec3"],g:!1},{a:"node_out",c:"CD",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( CA , _0_0 , _1_0 ) ; CD = mix ( CB , CB + CC , yJ ) ;".split(" ")}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"CE",h:["vec3"],g:!1},{a:"node_in",c:"CF",h:["float"],g:!1}],m:[{a:"txt",b:"D = CE ; H = CF ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"CG",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = CG ; H = _1_0 ;".split(" ")}]},{a:"node",c:"OUTPUT_WORLD_SURFACE",u:[],s:[{a:"node_in",c:"CH",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = CH ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"CI",h:["vec3"],g:!1},{a:"node_in",c:"CJ",h:["vec3"],g:!1},{a:"node_in",c:"CK",h:["float"],g:!1},{a:"node_in",c:"CL",h:["vec3"],g:!0},{a:"node_in",c:"CM",h:["float"],g:!0},{a:"node_out",c:"CN",h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["vec3"],g:!1},{a:"node_out",c:"CP",h:["vec3"],g:!1},{a:"node_out",c:"CQ",h:["vec3"],g:!1},{a:"node_out",c:"CR",h:["vec3"],g:!1},{a:"node_out",c:"CS",h:["vec2"],g:!1},{a:"node_out",c:"CT",h:["vec2"],g:!1},{a:"node_out",c:"CU",h:["vec4"],g:!1},{a:"node_param",c:"rv",h:["const","vec2"],g:!1},{a:"node_param",c:"rw",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"CP = clamp ( CI , _0_0 , _1_0 ) ; CQ = rw [ 0 ] * clamp ( CJ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"CR = normalize ( CL ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["CR","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"CN = CM * CP ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"CN = rI * CP ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["CP","*=","CK",";"]}]}]},{a:"txt",b:"CO = rJ * u_environment_energy * co ( CR ) ; CU = cr ( CP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"CS = vec2 ( rv [ 0 ] , rv [ 1 ] ) ; CT = vec2 ( rw [ 1 ] , rw [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","CU",";"]}]},{a:"node_else",m:[{a:"txt",b:"CN = vec3 ( _0_0 ) ; CO = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"CV",h:["vec4"],g:!1},{a:"node_in",c:"CW",h:["vec3"],g:!1},{a:"node_in",c:"CX",h:["vec3"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!0},{a:"node_in",c:"CZ",h:["float"],g:!0},{a:"node_in",c:"C_",h:["float"],g:!0},{a:"node_out",c:"Da",h:["vec3"],g:!0},{a:"node_out",c:"Db",h:["float"],g:!0},{a:"node_out",c:"Dc",h:["vec3"],g:!0},{a:"node_out",c:"Dd",h:["vec3"],g:!0},{a:"node_out",c:"De",h:["vec3"],g:!0},{a:"node_param",c:"rx",h:["float"],g:!1},{a:"node_param",c:"ry",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Da"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Da = CV . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Da = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"cA ( Da , nJ , CX , CY , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"cA ( Da , nJ , CX , CY , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Da","+=","CW",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dc"],m:[{a:"txt",b:["Dc","=","CX",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dd"],m:[{a:"txt",b:"Dd = CV . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_De"],m:[{a:"txt",b:["De","=","CW",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Db"],m:[{a:"txt",b:"Db = clamp ( C_ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( CW . r , CW . g ) , CW . b ) * CZ ; Db = clamp ( C_ * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Db"],m:[{a:"txt",b:"Db = clamp ( rx , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( CW . r , CW . g ) , CW . b ) * ry ; Db = rx * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","CW",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","CX",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_in",c:"ob",h:["vec3"],g:!1},{a:"node_out",c:"oc",h:["vec4"],g:!1},{a:"node_out",c:"od",h:["vec3"],g:!1}],m:[{a:"txt",b:"oc = vec4 ( n_ + ob * oa , _0_0 ) ; od = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"oe",h:["vec4"],g:!1},{a:"node_out",c:"of",h:["vec3"],g:!1},{a:"node_out",c:"og",h:["vec2"],g:!1},{a:"node_out",c:"oh",h:["vec3"],g:!1},{a:"node_out",c:"oi",h:["float"],g:!1}],m:[{a:"txt",b:"og = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oi","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oi","=","_0_0",";"]}]}]},{a:"txt",b:"oh = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"oh *= oe [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oj = u_light_positions [ LAMP_IND ] . xyz ; of = oj - nH ; float aN = length ( of ) ; oh *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aN * aN ) ; of = normalize ( of ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ol = u_light_directions [ LAMP_IND ] ; float om = dot ( of , ol ) ; om *= smoothstep ( _0_0 , _1_0 , ( om - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oh *= om ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"oh *= max ( LAMP_LIGHT_DIST - aN , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"txt",b:"of = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"on",h:["vec3"],g:!1},{a:"node_in",c:"oo",h:["vec2"],g:!1},{a:"node_in",c:"op",h:["vec3"],g:!1},{a:"node_in",c:"oq",h:["float"],g:!1},{a:"node_in",c:"or",h:["vec2"],g:!1},{a:"node_out",c:"os",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","rh","=","op",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( on , B . xyz ) ; rh = cross ( ot , B . xyz ) ; rh = - normalize ( rh ) ;".split(" ")}]}]},{a:"txt",b:"os = _0_0 ; if ( oo . r != _0_0 ) { float ou = ( _1_0 - oq ) * dot ( rh , on ) + oq ; if ( or [ 0 ] == _0_0 ) { os = _1_0 ; } else { float t = _1_0 + abs ( ou ) ; t = or [ 1 ] + ( _1_0 - or [ 1 ] ) * pow ( t , or [ 0 ] ) ; os = clamp ( t , _0_0 , _1_0 ) ; } os = max ( os , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ov",h:["vec3"],g:!1},{a:"node_in",c:"ow",h:["vec2"],g:!1},{a:"node_in",c:"ox",h:["vec3"],g:!1},{a:"node_in",c:"oy",h:["float"],g:!1},{a:"node_out",c:"oz",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","rh","=","ox",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( ov , B . xyz ) ; rh = cross ( ot , B . xyz ) ; rh = - normalize ( rh ) ;".split(" ")}]}]},{a:"txt",b:"oz = _0_0 ; if ( ow . r != _0_0 ) { float ou = ( _1_0 - oy ) * dot ( rh , ov ) + oy ; oz = max ( ou , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oA",h:["vec3"],g:!1},{a:"node_in",c:"oB",h:["vec2"],g:!1},{a:"node_in",c:"oC",h:["vec3"],g:!1},{a:"node_in",c:"oD",h:["float"],g:!1},{a:"node_in",c:"oE",h:["vec2"],g:!1},{a:"node_out",c:"oF",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","rh","=","oC",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oA , B . xyz ) ; rh = cross ( ot , B . xyz ) ; rh = - normalize ( rh ) ;".split(" ")}]}]},{a:"txt",b:"oF = _0_0 ; if ( oB . r != _0_0 ) { float ou = ( _1_0 - oD ) * dot ( rh , oA ) + oD ; if ( oE [ 0 ] > _0_0 ) { float oG = max ( dot ( rh , nJ ) , _0_0 ) ; float oH = oE [ 0 ] * oE [ 0 ] ; float cq = _1_0 - _0_5 * ( oH / ( oH + 0.33 ) ) ; vec3 oI = oA - ou * rh ; vec3 oJ = nJ - oG * rh ; if ( length ( oI ) == _0_0 || length ( oJ ) == _0_0 || abs ( ou ) > _1_0 || abs ( oG ) > _1_0 ) oF = ou * cq ; else { float oK = acos ( ou ) ; float oL = acos ( oG ) ; vec3 oM = normalize ( oI ) ; vec3 oN = normalize ( oJ ) ; float a , b ; a = max ( oK , oL ) ; b = min ( oK , oL ) ; b *= 0.95 ; float t = max ( dot ( oM , oN ) , _0_0 ) ; float oO = 0.45 * ( oH / ( oH + 0.09 ) ) ; oF = ou * ( cq + ( oO * t * sin ( a ) * tan ( b ) ) ) ; } } else oF = ou ; oF = max ( oF , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oP",h:["vec3"],g:!1},{a:"node_in",c:"oQ",h:["vec2"],g:!1},{a:"node_in",c:"oR",h:["vec3"],g:!1},{a:"node_in",c:"oS",h:["float"],g:!1},{a:"node_in",c:"oT",h:["vec2"],g:!1},{a:"node_out",c:"oU",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","rh","=","oR",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oP , B . xyz ) ; rh = cross ( ot , B . xyz ) ; rh = - normalize ( rh ) ;".split(" ")}]}]},{a:"txt",b:"oU = _0_0 ; if ( oQ . r != _0_0 ) { float ou = ( _1_0 - oS ) * dot ( rh , oP ) + oS ; float oG = max ( dot ( rh , nJ ) , _0_0 ) ; if ( oT [ 0 ] <= _1_0 ) oU = ou * pow ( max ( oG * ou , 0.1 ) , oT [ 0 ] - _1_0 ) ; else oU = ou * pow ( 1.0001 - oG , oT [ 0 ] - _1_0 ) ; oU = max ( oU , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oV",h:["vec3"],g:!1},{a:"node_in",c:"oW",h:["vec2"],g:!1},{a:"node_in",c:"oX",h:["vec3"],g:!1},{a:"node_in",c:"oY",h:["float"],g:!1},{a:"node_in",c:"oZ",h:["vec2"],g:!1},{a:"node_out",c:"o_",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","rh","=","oX",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oV , B . xyz ) ; rh = cross ( ot , B . xyz ) ; rh = - normalize ( rh ) ;".split(" ")}]}]},{a:"txt",b:"o_ = _0_0 ; if ( oW . r != _0_0 ) { float ou = ( _1_0 - oY ) * dot ( rh , oV ) + oY ; float pa = acos ( ou ) ; if ( pa < oZ [ 0 ] ) o_ = _1_0 ; else if ( pa > ( oZ [ 0 ] + oZ [ 1 ] ) || oZ [ 1 ] == _0_0 ) o_ = _0_0 ; else o_ = _1_0 - ( ( pa - oZ [ 0 ] ) / oZ [ 1 ] ) ; o_ = max ( o_ , _0_0 ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pb",h:["vec3"],g:!1},{a:"node_in",c:"pc",h:["vec2"],g:!1},{a:"node_in",c:"pd",h:["vec3"],g:!1},{a:"node_in",c:"pe",h:["float"],g:!1},{a:"node_in",c:"pf",h:["vec2"],g:!1},{a:"node_out",c:"pg",h:["float"],g:!1}],m:[{a:"txt",b:"pg = _0_0 ; if ( pc . g == _1_0 ) { vec3 ph = normalize ( pb + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pe == _0_0 ) { pg = dot ( B . xyz , ph ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pg = ( _1_0 - pe ) * max ( dot ( pd , ph ) , _0_0 ) + pe ;".split(" ")}]}]},{a:"txt",b:"pg = pow ( pg , pf [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pi",h:["vec3"],g:!1},{a:"node_in",c:"pj",h:["vec2"],g:!1},{a:"node_in",c:"pk",h:["vec3"],g:!1},{a:"node_in",c:"pl",h:["float"],g:!1},{a:"node_in",c:"pm",h:["vec2"],g:!1},{a:"node_out",c:"pn",h:["float"],g:!1}],m:[{a:"txt",b:"pn = _0_0 ; if ( pj . g != _0_0 ) { vec3 ph = normalize ( pi + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pl == _0_0 ) { pn = dot ( B . xyz , ph ) ; pn = sqrt ( _1_0 - pn * pn ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pn = max ( dot ( pk , ph ) , _0_0 ) ; pn = ( _1_0 - pl ) * pn + pl ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oG = max ( dot ( B . xyz , nJ ) , _0_0 ) ; oG = sqrt ( _1_0 - oG * oG ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oG = max ( dot ( pk , nJ ) , _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"pn = pow ( pn , pm [ 0 ] ) ; pn = pn / ( 0.1 + oG ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"po",h:["vec3"],g:!1},{a:"node_in",c:"pr",h:["vec2"],g:!1},{a:"node_in",c:"pu",h:["vec3"],g:!1},{a:"node_in",c:"pv",h:["float"],g:!1},{a:"node_in",c:"pw",h:["vec2"],g:!1},{a:"node_out",c:"px",h:["float"],g:!1}],m:[{a:"txt",b:"px = _0_0 ; if ( pr . g == _1_0 ) { vec3 ph = normalize ( po + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = _0_0 ; float oG = _0_0 ; float pz = _0_0 ; if ( pv == _0_0 ) { py = dot ( B . xyz , ph ) ; oG = dot ( B . xyz , nJ ) ; pz = dot ( B . xyz , po ) ; py = sqrt ( _1_0 - py * py ) ; oG = sqrt ( _1_0 - oG * oG ) ; pz = sqrt ( _1_0 - pz * pz ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = max ( dot ( pu , ph ) , 0.01 ) ; float oG = max ( dot ( pu , nJ ) , 0.01 ) ; float pz = max ( dot ( pu , po ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float by = tan ( acos ( py ) ) ; float J = max ( pw [ 0 ] , 0.01 ) ; px = pz * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( by * by ) / ( J * J ) ) / ( sqrt ( oG * pz ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pA",h:["vec3"],g:!1},{a:"node_in",c:"pB",h:["vec2"],g:!1},{a:"node_in",c:"pC",h:["vec3"],g:!1},{a:"node_in",c:"pD",h:["float"],g:!1},{a:"node_in",c:"pE",h:["vec2"],g:!1},{a:"node_out",c:"pF",h:["float"],g:!1}],m:[{a:"txt",b:"pF = _0_0 ; if ( pB . g == _1_0 ) { vec3 bY = normalize ( pA + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pG = dot ( bY , B . xyz ) ; float by = pE [ 0 ] + pE [ 1 ] ; if ( pD == _0_0 ) by = acos ( sqrt ( _1_0 - pG * pG ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float by = acos ( dot ( bY , pC ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( by < pE [ 0 ] ) pF = _1_0 ; else if ( by >= pE [ 0 ] + pE [ 1 ] || pE [ 1 ] == _0_0 ) pF = _0_0 ; else pF = _1_0 - ( by - pE [ 0 ] ) / pE [ 1 ] ; }".split(" ")}]},{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pH",h:["vec3"],g:!1},{a:"node_in",c:"pI",h:["vec2"],g:!1},{a:"node_in",c:"pJ",h:["vec3"],g:!1},{a:"node_in",c:"pK",h:["float"],g:!1},{a:"node_in",c:"pL",h:["vec2"],g:!1},{a:"node_out",c:"pM",h:["float"],g:!1}],m:[{a:"txt",b:"float pN = pL [ 0 ] ; float pO = pL [ 1 ] ; pM = _0_0 ; if ( pI . g == _1_0 ) { if ( pN < _1_0 || pO == _0_0 ) pM = _0_0 ; else { if ( pO < 100.0 ) pO = sqrt ( _1_0 / pO ) ; else pO = 10.0 / pO ; vec3 ph = normalize ( nJ + pH ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = _0_0 ; if ( pK == _0_0 ) { float pP = dot ( B . xyz , ph ) ; py = sqrt ( _1_0 - pP * pP ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = ( _1_0 - pK ) * max ( dot ( pJ , ph ) , _0_0 ) + pK ;".split(" ")}]}]},{a:"txt",b:"if ( py < _0_0 ) pM = _0_0 ; else { float oG = max ( dot ( pJ , nJ ) , 0.01 ) ; float pz = dot ( pJ , pH ) ; if ( pz <= 0.01 ) pM = _0_0 ; else { float pQ = max ( dot ( nJ , ph ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * py * oG ) / pQ ; float dj = ( 2.0 * py * pz ) / pQ ; float g = min ( min ( a , b ) , dj ) ; float p = sqrt ( pow ( pN , 2.0 ) + pow ( pQ , 2.0 ) - _1_0 ) ; float lx = pow ( p - pQ , 2.0 ) / pow ( p + pQ , 2.0 ) * ( _1_0 + pow ( pQ * ( p + pQ ) - _1_0 , 2.0 ) / pow ( pQ * ( p - pQ ) + _1_0 , 2.0 ) ) ; float pa = acos ( py ) ; pM = max ( lx * g * exp ( - pow ( pa , 2.0 ) / ( 2.0 * pow ( pO , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pR",h:["vec4"],g:!1},{a:"node_in",c:"pS",h:["vec3"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["float"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec3"],g:!1},{a:"node_in",c:"pX",h:["vec4"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["vec3"],g:!1},{a:"node_in",c:"qa",h:["float"],g:!1},{a:"node_out",c:"qb",h:["vec4"],g:!1},{a:"node_out",c:"qc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pV , pW ) * dot ( nJ , pW ) < _0_0 ) { float Df = pX . x ; float Dg = pX . y ; float Dh = pX . z ; float Di = pX . w ; float Dj = clamp ( abs ( dot ( pV , pW ) ) , _0_0 , _1_0 ) ; float Dk = clamp ( dot ( nJ , - pV ) , _0_0 , _1_0 ) ; float Dl = pow ( Dk , Dg ) ; qb = pR + qa * vec4 ( p_ * Dj * pow ( pY , vec3 ( Df ) ) , _1_0 ) ; qb += Dh * mix ( vec4 ( pY , _1_0 ) , vec4 ( _1_0 ) , Di ) * qa * vec4 ( p_ * Dj * vec3 ( Dl ) , _1_0 ) ; } else { qb = pR + vec4 ( p_ * pY * pT , pU ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"qb = pR + vec4 ( p_ * pY * pT , pU ) ;".split(" ")}]}]},{a:"txt",b:"qc = pS + p_ * pZ * pU ;".split(" ")}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"Dm",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dm = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!1},{a:"node_out",c:"Do",h:["float"],g:!1}],m:[{a:"txt",b:"Do = dot ( Dn , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"Dp",h:["vec3"],g:!1},{a:"node_out",c:"Dq",h:["float"],g:!0},{a:"node_out",c:"Dr",h:["float"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dq"],m:[{a:"txt",b:"Dq = Dp . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = Dp . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = Dp . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"Dt",h:["vec3"],g:!1},{a:"node_out",c:"Du",h:["float"],g:!0},{a:"node_out",c:"Dv",h:["float"],g:!0},{a:"node_out",c:"Dw",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 Dx = ju ( Dt ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = Dx . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = Dx . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",b:"Dw = Dx . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"Dy",h:["float"],g:!1},{a:"node_in",c:"Dz",h:["float"],g:!1},{a:"node_in",c:"DA",h:["float"],g:!1},{a:"node_out",c:"DB",h:["float"],g:!1}],m:[{a:"txt",b:"DB = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Dy - DA ) * Dz ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"DC",h:["vec3"],g:!1},{a:"node_in",c:"DD",h:["float"],g:!1},{a:"node_out",c:"DE",h:["vec3"],g:!1}],m:[{a:"txt",b:"DE = DC ; if ( DE . x > _0_0 ) DE . x = pow ( DC . x , DD ) ; if ( DE . y > _0_0 ) DE . y = pow ( DC . y , DD ) ; if ( DE . z > _0_0 ) DE . z = pow ( DC . z , DD ) ;".split(" ")}]},{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"DF",h:["vec3"],g:!1},{a:"node_out",c:"DG",h:["vec3"],g:!1}],m:[{a:"txt",b:"DG = max ( vec3 ( _0_0 ) , DF ) ; DG = pow ( DG , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"DH",h:["vec3"],g:!1},{a:"node_out",c:"DI",h:["vec3"],g:!1}],m:[{a:"txt",b:"DI = max ( vec3 ( _0_0 ) , DH ) ; DI = pow ( DI , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"DJ",h:["vec3"],g:!1},{a:"node_out",c:"DK",h:["vec3"],g:!1},{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],m:[{a:"txt",b:"DJ [ 2 ] = DJ [ 1 ] = DJ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK [ 2 ] = DK [ 1 ] = DK [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DL"],m:[{a:"txt",b:["DL","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT_CUBE",u:[],s:[{a:"node_in",c:"DM",h:["vec3"],g:!1},{a:"node_out",c:"DN",h:["vec3"],g:!0},{a:"node_out",c:"DO",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec3 DP = vec3 ( DM . x , DM . y , DM . z ) ; vec4 zR = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_CUBE_var_texture , DP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DN"],m:[{a:"txt",b:"DN = zR . xyz ; ch ( DN ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DO"],m:[{a:"txt",b:"DO = zR . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",u:[{a:"node_var",c:"USE_VECTOR_IN",b:["0"]}],s:[{a:"node_in",c:"DQ",h:["vec3"],g:!1},{a:"node_out",c:"DR",h:["vec3"],g:!1},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_VECTOR_IN"],m:[{a:"txt",b:"vec3 DS = normalize ( DQ ) ;".split(" ")}]},{a:"node_elif",i:["IS_WORLD"],m:[{a:"txt",b:["vec3","DS","=","rz",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","DS","=","nI",";"]}]}]},{a:"txt",b:"float ds = - atan ( DS . y , DS . x ) / ( 2.0 * M_PI ) + _0_5 ; float ke = atan ( DS . z , sqrt ( DS . x * DS . x + DS . y * DS . y ) ) / M_PI + _0_5 ; vec4 zR = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture , vec2 ( ds , ke ) ) ; DR = zR . xyz ; ch ( DR ) ;".split(" ")}]},{a:"node",c:"TEXTURE_ENVIRONMENT_MIRROR_BALL",u:[{a:"node_var",c:"USE_VECTOR_IN",b:["0"]}],s:[{a:"node_in",c:"DT",h:["vec3"],g:!1},{a:"node_out",c:"DU",h:["vec3"],g:!1},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_VECTOR_IN"],m:[{a:"txt",b:"vec3 DS = normalize ( DT ) ;".split(" ")}]},{a:"node_elif",i:["IS_WORLD"],m:[{a:"txt",b:["vec3","DS","=","rz",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","DS","=","nI",";"]}]}]},{a:"txt",b:"DS . y -= _1_0 ; float DV = 2.0 * sqrt ( max ( - _0_5 * DS . y , _0_0 ) ) ; if ( DV > _0_0 ) DS /= DV ; float ds = _0_5 * ( DS . x + _1_0 ) ; float ke = _0_5 * ( DS . z + _1_0 ) ; vec4 zR = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture , vec2 ( ds , ke ) ) ; DU = zR . xyz ; ch ( DU ) ;".split(" ")}]},{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"DW",h:["vec3"],g:!0},{a:"node_in",c:"DX",h:["vec3"],g:!0},{a:"node_in",c:"DY",h:["vec3"],g:!0},{a:"node_in",c:"DZ",h:["vec3"],g:!0},{a:"node_out",c:"D_",h:["vec3"],g:!0},{a:"node_out",c:"Ea",h:["float"],g:!0},{a:"node_out",c:"Eb",h:["vec3"],g:!0},{a:"node_out",c:"Ec",h:["float"],g:!0},{a:"node_out",c:"Ed",h:["vec3"],g:!0},{a:"node_out",c:"Ee",h:["float"],g:!0},{a:"node_out",c:"Ef",h:["vec3"],g:!0},{a:"node_out",c:"Eg",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DW ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DW . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_D_"],m:[{a:"txt",b:"D_ = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","D_",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = zR . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DX ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DX . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eb"],m:[{a:"txt",b:"Eb = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Eb",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ec"],m:[{a:"txt",b:"Ec = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DY ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DY . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ed"],m:[{a:"txt",b:"Ed = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Ed",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DZ ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DZ . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ef"],m:[{a:"txt",b:"Ef = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Ef",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eg"],m:[{a:"txt",b:"Eg = zR . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Eh",h:["vec3"],g:!0},{a:"node_in",c:"Ei",h:["vec3"],g:!0},{a:"node_in",c:"Ej",h:["vec3"],g:!0},{a:"node_in",c:"Ek",h:["vec3"],g:!0},{a:"node_out",c:"El",h:["vec3"],g:!0},{a:"node_out",c:"Em",h:["float"],g:!0},{a:"node_out",c:"En",h:["vec3"],g:!0},{a:"node_out",c:"Eo",h:["float"],g:!0},{a:"node_out",c:"Ep",h:["vec3"],g:!0},{a:"node_out",c:"Eq",h:["float"],g:!0},{a:"node_out",c:"Er",h:["vec3"],g:!0},{a:"node_out",c:"Es",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Eh ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_El"],m:[{a:"txt",b:"El = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Em"],m:[{a:"txt",b:"Em = zR . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ei ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_En"],m:[{a:"txt",b:"En = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eo"],m:[{a:"txt",b:"Eo = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ej ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ep"],m:[{a:"txt",b:"Ep = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eq"],m:[{a:"txt",b:"Eq = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ek ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Er"],m:[{a:"txt",b:"Er = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Es"],m:[{a:"txt",b:"Es = zR . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",b:["0"]}],s:[{a:"node_out",c:"Et",h:["float"],g:!1}],m:[{a:"txt",b:"Et = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"Eu",h:["vec3"],g:!1},{a:"node_in",c:"Ev",h:["vec3"],g:!1},{a:"node_out",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["float"],g:!0}],m:[{a:"txt",b:"Ew = Eu + Ev ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ex"],m:[{a:"txt",b:"Ex = ( abs ( Ew [ 0 ] ) + abs ( Ew [ 1 ] ) + abs ( Ew [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["vec3"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1},{a:"node_out",c:"EB",h:["float"],g:!0}],m:[{a:"txt",b:"EA = Ey - Ez ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EB"],m:[{a:"txt",b:"EB = ( abs ( EA [ 0 ] ) + abs ( EA [ 1 ] ) + abs ( EA [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"EC",h:["vec3"],g:!1},{a:"node_in",c:"ED",h:["vec3"],g:!1},{a:"node_out",c:"EE",h:["vec3"],g:!1},{a:"node_out",c:"EF",h:["float"],g:!0}],m:[{a:"txt",b:"EE = EC + ED ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EF"],m:[{a:"txt",b:"EF = length ( EE ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EE"],m:[{a:"txt",b:"EE = normalize ( EE ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"EG",h:["vec3"],g:!1},{a:"node_in",c:"EH",h:["vec3"],g:!1},{a:"node_out",c:"EI",h:["vec3"],g:!1},{a:"node_out",c:"EJ",h:["float"],g:!0}],m:[{a:"txt",b:"EI = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EJ"],m:[{a:"txt",b:"EJ = dot ( EG , EH ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"EK",h:["vec3"],g:!1},{a:"node_in",c:"EL",h:["vec3"],g:!1},{a:"node_out",c:"EM",h:["vec3"],g:!1},{a:"node_out",c:"EN",h:["float"],g:!0}],m:[{a:"txt",b:"EM = cross ( EK , EL ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EN"],m:[{a:"txt",b:"EN = length ( EM ) ; EM /= EN ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"EM = normalize ( EM ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"EO",h:["vec3"],g:!1},{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",h:["vec3"],g:!1},{a:"node_out",c:"ER",h:["float"],g:!0}],m:[{a:"txt",b:"EQ = normalize ( EO ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ER"],m:[{a:"txt",b:"ER = length ( EO ) ;".split(" ")}]}]},{a:"txt",b:["EP",";"]}]},{a:"node",c:"FRESNEL",u:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],s:[{a:"node_in",c:"ES",h:["float"],g:!1},{a:"node_in",c:"ET",h:["vec3"],g:!1},{a:"node_out",c:"EU",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_FRESNEL_NORMAL"],m:[{a:"txt",b:"vec3 cf = normalize ( ET ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","cf","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 zp = normalize ( nJ ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","zp","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float ri = max ( ES , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"ri = gl_FrontFacing == false ? ri : _1_0 / ri ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"ri = gl_FrontFacing ? ri : _1_0 / ri ;".split(" ")}]}]},{a:"txt",b:"EU = rk ( zp , cf , ri ) ;".split(" ")}]},{a:"node",c:"BACKGROUND",u:[],s:[{a:"node_in",c:"EV",h:["vec3"],g:!1},{a:"node_in",c:"EW",h:["float"],g:!1},{a:"node_out",c:"EX",h:["vec3"],g:!1}],m:[{a:"txt",b:"EX = EV * EW ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"EY",h:["vec3"],g:!1},{a:"node_in",c:"EZ",h:["vec3"],g:!1},{a:"node_out",c:"E_",h:["vec3"],g:!1}],m:[{a:"txt",b:"E_ = reflect ( _ ( u_view_tsr_inverse , EY ) , EZ ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Fa",h:["vec3"],g:!1},{a:"node_out",c:"Fb",h:["vec3"],g:!1}],m:[{a:"txt",b:"Fb = reflect ( - nJ . xyz , Fa ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Fc",h:["vec3"],g:!1},{a:"node_in",c:"Fd",h:["float"],g:!1},{a:"node_in",c:"Fe",h:["const","float"],g:!1},{a:"node_in",c:"Ff",h:["const","float"],g:!1},{a:"node_out",c:"Fg",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bB = length ( rH ) ; if ( bB < Ff ) { vec2 bO = re ( Fc ) ; float bS = clamp ( _0_5 * ( Ff - bB ) , _0_0 , _1_0 ) ; float hf = Fd * bS ; vec3 bU = normalize ( nJ * rE ) ; float bV = _1_0 / Fe ; vec2 bW = bU . xy * hf / ( Fe * bU . z ) ; float bX = _1_0 ; float bY = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a ; for ( float b_ = _1_0 ; b_ <= Fe ; b_ ++ ) { if ( bY < bX ) { bX -= bV ; bO -= bW ; bY = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a ; } } vec2 ca = bO + bW ; float cb = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ca ) . a - ( bX + bV ) ; float cc = bY - bX ; float cd = cc / ( cc - cb ) ; bO = cd * ca + ( _1_0 - cd ) * bO ; Fg = rd ( bO ) ; } else Fg = Fc ;".split(" ")}]},{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Fh",h:["vec3"],g:!1},{a:"node_out",c:"Fi",h:["vec3"],g:!1}],m:[{a:"txt",b:"Fi = clamp ( Fh , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Fj",h:["vec3"],g:!1},{a:"node_in",c:"Fk",h:["float"],g:!1},{a:"node_out",c:"Fl",h:["vec3"],g:!1}],m:[{a:"txt",b:"Fl = rc ( Fj , Fk ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"Fm",h:["float"],g:!1},{a:"node_in",c:"Fn",h:["float"],g:!1},{a:"node_in",c:"Fo",h:["float"],g:!1},{a:"node_in",c:"Fp",h:["float"],g:!1},{a:"node_in",c:"Fq",h:["float"],g:!1},{a:"node_out",c:"Fr",h:["float"],g:!0},{a:"node_out",c:"Fs",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Fr"],m:[{a:"txt",b:["Fr","=","Fm",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Fs"],m:[{a:"txt",b:"Fs = vec4 ( Fn , Fo , Fp , Fq ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"Ft",h:["float"],g:!1}],m:[{a:"txt",b:["Ft","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",u:[],s:[{a:"node_in",c:"Fu",h:["float"],g:!1},{a:"node_in",c:"Fv",h:["float"],g:!1},{a:"node_in",c:"Fw",h:["float"],g:!1},{a:"node_out",c:"Fx",h:["float"],g:!1}],m:[{a:"txt",b:"Fx = smoothstep ( Fv , Fw , Fu ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"Fy",h:["vec3"],g:!1},{a:"node_in",c:"Fz",h:["float"],g:!1}],m:[{a:"txt",b:"D = Fy ; H = Fz ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"FA",h:["vec3"],g:!1},{a:"node_out",c:"FB",h:["float"],g:!1}],m:[{a:"txt",b:"FB = ( FA . r + FA . g + FA . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"FC",h:["float"],g:!1},{a:"node_out",c:"FD",h:["vec3"],g:!1}],m:[{a:"txt",b:"FD [ 0 ] = FC ; FD [ 1 ] = FC ; FD [ 2 ] = FC ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nJ , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["IS_WORLD"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"vec3 rz = - nJ ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_GL"],j:{a:"grp",f:[{a:"txt",b:"vec3 nH = - nJ ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEX_COORD_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","nI","=","nJ",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rA","=","nJ",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:["vec3","rB","=","j",";"]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"rB = rB ; else rB = - rB ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_NORMAL_MAP"],j:{a:"grp",f:[{a:"txt",b:["vec3","rC","=","rB",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"vec3 rD = normalize ( rB ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nI","=","rD",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 nI = normalize ( j ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rA","=","rD",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rD , k . xyz ) * k . w ; mat3 rE = mat3 ( k . xyz , W , rD ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_NORMAL_MAP"],j:{a:"grp",f:[{a:"txt",b:"vec3 rF = cross ( rB , k . xyz ) * k . w ; mat3 rG = mat3 ( k . xyz , rF , rB ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 nH = h ; vec4 rH = i ; float rI = u_emit ; float rJ = u_ambient ;".split(" ")}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]},e["include/nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLV",b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2},"PARTICLE_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qY ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rt",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rt","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rs",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rs","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_param",c:"node_UVMAP_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"ru",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["ru","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rl",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rl","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"FE",h:["GLSL_OUT","vec3"],g:!1}],m:[{a:"txt",b:["FE","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",h:["GLSL_IN","float"],g:!1},{a:"node_param",c:"FF",h:["GLSL_OUT","float"],g:!1}],m:[{a:"txt",b:["FF","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"FG",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["FG","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"FH",h:["GLSL_OUT","vec3"],g:!1}],m:[{a:"txt",b:["FH","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["qY","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]},e["include/pack.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PACK_GLSLF",j:{a:"grp",f:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 dO ( const in float hv ) { vec4 eP = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 FI = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iN = fract ( hv * eP ) ; iN -= iN . xxyz * FI ; return iN ; } float cG ( const in vec4 FJ ) { float dN ; vec4 eP = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; dN = dot ( FJ , eP ) ; return dN ; } vec4 dO ( const in vec2 qr ) { vec2 eP = vec2 ( _255_0 , _1_0 ) ; vec2 FI = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iN = fract ( qr . xxyy * eP . xyxy ) ; iN -= iN . xxzz * FI . xyxy ; if ( qr . r == _1_0 ) iN . rg = vec2 ( _0_0 , _1_0 ) ; if ( qr . g == _1_0 ) iN . ba = vec2 ( _0_0 , _1_0 ) ; return iN ; } vec2 is ( const in vec4 FK ) { vec2 qr ; vec2 eP = vec2 ( _1_0 / _255_0 , _1_0 ) ; qr . r = dot ( FK . rg , eP ) ; qr . g = dot ( FK . ba , eP ) ; return qr ; }".split(" ")}]}}]}]},e["include/particles.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",A:"math.glslv"},{a:"txt",b:"struct cO { float cW ; vec3 O ; float J ; vec3 aR ; float by ; vec3 db ; vec3 dc ; float dd ; } ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void FO ( inout vec3 aR , float FL , vec4 jo , vec4 jp ) { float FM = jp . x - jo . x ; float FN = ( FL - jo . x ) / FM ; aR = mix ( aR , jp . yzw , clamp ( FN , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 FR ( float t , float FP , vec4 FQ [ COLOR_RAMP_LENGTH ] ) { float FL = t / FP ; vec3 aR = FQ [ 0 ] . yzw ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"FO ( aR , FL , FQ [ 0 ] , FQ [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"FO ( aR , FL , FQ [ 1 ] , FQ [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"FO ( aR , FL , FQ [ 2 ] , FQ [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aR",";","}"]}]}}]},{a:"txt",b:"float FX ( float t , float FP , float FS , float FT ) { float FU = max ( 0.01 , min ( FP , FS ) ) ; float FV = max ( 0.01 , min ( FP , FT ) ) ; float FW = FP - FV ; float J = clamp ( t / FU , 0.0 , 1.0 ) - step ( FW , t ) * ( t - FW ) / FV ; return J ; } cO cP ( ) { cO sp ; float t ; float FP = a_p_data [ 0 ] ; float FY = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - FY ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - FY ; } if ( t < 0.0 || t >= FP ) { sp . cW = 0.0001 ; sp . O = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= FP ) ) { vec4 S = R ( a_tbn ) ; vec3 bK = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WORLD_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 eM = a_position ; vec3 rh = bK ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 eM = ap ( u_model_tsr , a_position ) ; vec3 rh = _ ( u_model_tsr , bK ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 FZ = u_p_nfactor * rh ; FZ += a_p_vels . xyz ; FZ . z -= u_p_gravity * t / 2.0 ; float F_ = max ( u_p_mass , EPSILON ) ; FZ += ( u_p_wind_fac * u_wind / F_ ) * t / 2.0 ; sp . dd = t ; sp . db = FZ ; sp . dc = bK * a_p_vels . w ; sp . O = eM + FZ * t ; sp . by = a_p_vels . w * t ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],j:{a:"grp",f:[{a:"txt",b:"sp . cW = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . cW = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"sp . aR = FR ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . aR = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = FX ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]},e["include/particles_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"environment.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 ju ( vec3 rgb ) { vec4 jt = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jt . wz ) , vec4 ( rgb . gb , jt . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dp = q . x - min ( q . w , q . y ) ; float hL = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dp + hL ) ) , dp / ( q . x + hL ) , q . x ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jw ( vec3 jv ) { vec4 jt = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jv . r , jv . r , jv . r ) + jt . xyz ) * 6.0 - jt . www ) ; return jv . b * mix ( jt . xxx , clamp ( p - jt . xxx , _0_0 , _1_0 ) , jv . g ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 rd ( vec2 gs ) { return vec3 ( gs * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 re ( vec3 qr ) { return vec2 ( qr . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",u:[],s:[{a:"node_out",c:"rK",h:["vec3"],g:!0},{a:"node_out",c:"rL",h:["float"],g:!0},{a:"node_out",c:"rM",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rK"],m:[{a:"txt",b:"rK = normalize ( rH . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rL"],m:[{a:"txt",b:"rL = abs ( rH . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rM"],m:[{a:"txt",b:"rM = length ( rH . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"rN",h:["float"],g:!1},{a:"node_in",c:"rO",h:["float"],g:!1},{a:"node_in",c:"rP",h:["float"],g:!1},{a:"node_out",c:"rQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"rQ = vec3 ( rN , rO , rP ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"rR",h:["float"],g:!1},{a:"node_in",c:"rS",h:["float"],g:!1},{a:"node_in",c:"rT",h:["float"],g:!1},{a:"node_out",c:"rU",h:["vec3"],g:!1}],m:[{a:"txt",b:"rU = jw ( vec3 ( rR , rS , rT ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rW",h:["vec3"],g:!1}],m:[{a:"txt",b:"rW = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rX",h:["vec3"],g:!1}],m:[{a:"txt",b:"rX = rd ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rY",h:["vec3"],g:!1}],m:[{a:"txt",b:"rY = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_out",c:"rZ",h:["vec3"],g:!1}],m:[{a:"txt",b:"rZ = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"r_",h:["float"],g:!1}],m:[{a:"txt",b:["r_","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1}],m:[{a:"txt",b:"sa = _1_0 ; sb = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"sc",h:["float"],g:!1},{a:"node_out",c:"sd",h:["float"],g:!1},{a:"node_out",c:"se",h:["float"],g:!1}],m:[{a:"txt",b:"sc = _1_0 ; sd = _1_0 ; se = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"sf",h:["vec3"],g:!1},{a:"node_out",c:"sg",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["sg","=","sf",";"]}]},{a:"node_else",m:[{a:"txt",b:"sg = rA . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"sh",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"sj",h:["vec3"],g:!1}],m:[{a:"txt",b:"sj = - _ ( u_view_tsr_frag , nJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk [ 0 ] = rH [ 0 ] ; sk [ 1 ] = rH [ 1 ] ; sk [ 2 ] = rH [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"sl",h:["vec3"],g:!1}],m:[{a:"txt",b:"sl = vec3 ( nH . r , nH . g , nH . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"sn",h:["vec3"],g:!1},{a:"node_out",c:"so",h:["vec3"],g:!1},{a:"node_out",c:"sr",h:["vec3"],g:!1},{a:"node_out",c:"su",h:["vec3"],g:!1},{a:"node_out",c:"sv",h:["vec3"],g:!1},{a:"node_out",c:"sw",h:["vec3"],g:!1},{a:"node_out",c:"sx",h:["float"],g:!1},{a:"node_out",c:"sy",h:["float"],g:!1}],m:[{a:"txt",b:"sn = vec3 ( _0_0 ) ; so = vec3 ( _0_0 ) ; sr = vec3 ( _0_0 ) ; su = vec3 ( _0_0 ) ; sv = vec3 ( _0_0 ) ; sw = vec3 ( _0_0 ) ; sx = _0_0 ; sy = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sz",h:["float"],g:!1},{a:"node_in",c:"sA",h:["float"],g:!1},{a:"node_in",c:"sB",h:["float"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_out",c:"sE",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jv = ju ( sD ) ; jv [ 0 ] += ( sz - _0_5 ) ; if ( jv [ 0 ] > _1_0 ) jv [ 0 ] -= _1_0 ; else if ( jv [ 0 ] < _0_0 ) jv [ 0 ] += _1_0 ; jv *= vec3 ( _1_0 , sA , sB ) ; jv = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jv , step ( vec3 ( _0_0 ) , jv ) ) , step ( jv , vec3 ( _1_0 ) ) ) ; sE = mix ( sD , jw ( jv ) , sC ) ;".split(" ")}]},{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_out",c:"sH",h:["vec3"],g:!1}],m:[{a:"txt",b:"sH = mix ( sG , vec3 ( _1_0 ) - sG , sF ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",c:"sI",h:["vec3"],g:!0},{a:"node_out",c:"sJ",h:["vec3"],g:!1},{a:"node_out",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sI"],m:[{a:"txt",b:"sI = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sM = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sN = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sJ = - h + sN ; sK = length ( sJ ) ; sJ = normalize ( sJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sL"],m:[{a:"txt",b:"sL = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sK * sK ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float om = dot ( sJ , sM ) ; om *= smoothstep ( _0_0 , _1_0 , ( om - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sL *= om ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"sL *= max ( LAMP_LIGHT_DIST - sK , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sJ"],m:[{a:"txt",b:["sJ","=","sM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sK"],m:[{a:"txt",b:"sK = length ( sN - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sL"],m:[{a:"txt",b:["sL","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!0},{a:"node_out",c:"sQ",h:["float"],g:!0},{a:"node_param",c:"rq",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sP"],m:[{a:"txt",b:["sP","=","rq",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sQ"],m:[{a:"txt",b:"sQ = - dot ( sO , rq ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sR",h:["vec3"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1}],m:[{a:"txt",b:"sS = - _ ( u_view_tsr_frag , sR ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",u:[],s:[{a:"node_in",c:"sT",h:["vec3"],g:!1},{a:"node_in",c:"sU",h:["vec3"],g:!1},{a:"node_in",c:"sV",h:["float"],g:!1},{a:"node_in",c:"sW",h:["vec3"],g:!1},{a:"node_in",c:"sX",h:["float"],g:!1},{a:"node_in",c:"sY",h:["float"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",c:"ta",h:["float"],g:!1},{a:"node_in",c:"tb",h:["vec3"],g:!1},{a:"node_in",c:"tc",h:["float"],g:!1},{a:"node_out",c:"td",h:["vec3"],g:!1},{a:"node_out",c:"te",h:["vec3"],g:!1},{a:"node_out",c:"tf",h:["vec3"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1},{a:"node_out",c:"th",h:["vec3"],g:!1},{a:"node_out",c:"ti",h:["vec4"],g:!1},{a:"node_out",c:"tj",h:["vec4"],g:!1},{a:"node_out",c:"tk",h:["vec3"],g:!1},{a:"node_out",c:"tl",h:["vec3"],g:!1},{a:"node_out",c:"tm",h:["vec3"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["vec3"],g:!1},{a:"node_out",c:"tr",h:["float"],g:!1}],m:[{a:"txt",b:"tf = sU ; tg = sW ; th = sZ ; tk = sU ; tl = sW ; metalness_out = sY ; tm = s_ ; tn = ta ; to = tb ; tr = tc ; td = rI * tf ; te = rJ * u_environment_energy * co ( th ) ; tj = cr ( tf ) ; G = tj ; ti [ 0 ] = sV ; ti [ 1 ] = sX ; ti [ 2 ] = sY ;".split(" ")}]},{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"tu",h:["vec4"],g:!1},{a:"node_in",c:"tv",h:["vec3"],g:!1},{a:"node_in",c:"tw",h:["vec3"],g:!1},{a:"node_in",c:"tx",h:["vec4"],g:!1},{a:"node_in",c:"ty",h:["vec3"],g:!1},{a:"node_in",c:"tz",h:["vec3"],g:!1},{a:"node_in",c:"tA",h:["vec3"],g:!1},{a:"node_in",c:"tB",h:["float"],g:!1},{a:"node_in",c:"tC",h:["vec3"],g:!1},{a:"node_in",c:"tB",h:["float"],g:!1},{a:"node_in",c:"tD",h:["float"],g:!1},{a:"node_out",c:"tE",h:["vec3"],g:!1}],m:[{a:"txt",b:"tE = tu . rgb + tv ; tE = mix ( tE , tA , tB ) ; H = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],m:[{a:"txt",b:"vec3 tG = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; ch ( tG ) ; tC = tC * tG ; tE += tC ;".split(" ")}]}]},{a:"txt",b:["tw",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["vec2"],g:!1},{a:"node_in",c:"tJ",h:["vec3"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec4"],g:!1},{a:"node_out",c:"tM",h:["float"],g:!1},{a:"node_out",c:"tN",h:["float"],g:!1}],m:[{a:"txt",b:"vec3 rh = tJ ; float tO = clamp ( tL [ 0 ] , _0_0 , _1_0 ) ; float tF = clamp ( tL [ 1 ] , _0_0 , _1_0 ) ; float qP = tL [ 2 ] ; vec3 ph = normalize ( nJ + tH ) ; float ou = ( _1_0 - tK ) * dot ( rh , tH ) + tK ; float tP = ( _1_0 - tK ) * max ( dot ( tH , ph ) , _0_0 ) + tK ; float tQ = ( _1_0 - tK ) * max ( dot ( tJ , ph ) , _0_0 ) + tK ; tM = _0_0 ; if ( tI . r != _0_0 ) { if ( tO > _0_0 ) { float oG = max ( dot ( rh , nJ ) , _0_0 ) ; float oH = tO * tO ; float cq = _1_0 - _0_5 * ( oH / ( oH + 0.33 ) ) ; vec3 oI = tH - ou * rh ; vec3 oJ = nJ - oG * rh ; if ( length ( oI ) == _0_0 || length ( oJ ) == _0_0 || abs ( ou ) > _1_0 || abs ( oG ) > _1_0 ) tM = ou * cq ; else { float oK = acos ( ou ) ; float oL = acos ( oG ) ; vec3 oM = normalize ( oI ) ; vec3 oN = normalize ( oJ ) ; float a , b ; a = max ( oK , oL ) ; b = min ( oK , oL ) ; b *= 0.95 ; float t = max ( dot ( oM , oN ) , _0_0 ) ; float oO = 0.45 * ( oH / ( oH + 0.09 ) ) ; tM = ou * ( cq + ( oO * t * sin ( a ) * tan ( b ) ) ) ; } } else tM = ou ; tM = max ( tM , _0_0 ) ; } float J = tF ; float tR = J * J ; float tS = ( tQ * tR - tQ ) * tQ + _1_0 ; float cn = tR / ( M_PI * tS * tS ) ; float tT ; float tU ; float tV = pow ( _1_0 - tP , 5.0 ) ; tT = _1_0 ; tU = tV ; float jt = J / 2.0 ; float tW = jt * jt ; float tX = _1_0 - tW ; float tY = _1_0 / ( tP * tP * tX + tW ) ; tT *= tY ; tU *= tY ; float tZ = mix ( 0.04 , _1_0 , qP ) ; float t_ = mix ( tU , tT , tZ ) ; tN = max ( ou * cn * t_ , _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"ua",h:["vec3"],g:!1},{a:"node_in",c:"ub",h:["float"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_in",c:"uf",h:["vec3"],g:!1},{a:"node_out",c:"ug",h:["vec3"],g:!1}],m:[{a:"txt",b:"ug = ua ; ub ; uc ; ud ; ue ; uf ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"uh",h:["vec3"],g:!1},{a:"node_in",c:"ui",h:["float"],g:!1},{a:"node_in",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["vec3"],g:!1},{a:"node_out",c:"um",h:["float"],g:!1},{a:"node_out",c:"un",h:["vec3"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["float"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["vec3"],g:!1},{a:"node_out",c:"us",h:["float"],g:!1},{a:"node_out",c:"ut",h:["vec3"],g:!1},{a:"node_out",c:"uu",h:["float"],g:!1}],m:[{a:"txt",b:"ul = uh ; um = ui ; up = _0_0 ; us = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["uq","=","uj",";"]}]},{a:"node_else",m:[{a:"txt",b:["uq","=","nI",";"]}]}]},{a:"txt",b:"uk ; un ; uo ; ur ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"uv",h:["vec3"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",c:"ux",h:["float"],g:!1},{a:"node_in",c:"uy",h:["vec3"],g:!1},{a:"node_out",c:"uz",h:["vec3"],g:!1}],m:[{a:"txt",b:"uz = uv ; uw ; ux ; uy ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"uA",h:["vec3"],g:!1},{a:"node_in",c:"uB",h:["float"],g:!1},{a:"node_in",c:"uC",h:["vec3"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["vec3"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["float"],g:!1},{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["vec3"],g:!1},{a:"node_out",c:"uL",h:["float"],g:!1},{a:"node_out",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["float"],g:!1}],m:[{a:"txt",b:"uG = uA ; uH = uB ; uI = _1_0 ; uL = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["uJ","=","uC",";"]}]},{a:"node_else",m:[{a:"txt",b:["uJ","=","nI",";"]}]}]},{a:"txt",b:"uD ; uE ; uF ; uK ; uM ; uN ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["float"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS = uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_out",c:"uU",h:["vec3"],g:!1},{a:"node_out",c:"uV",h:["vec3"],g:!1},{a:"node_out",c:"uW",h:["float"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1},{a:"node_out",c:"uY",h:["float"],g:!1},{a:"node_out",c:"uZ",h:["float"],g:!1},{a:"node_out",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1},{a:"node_out",c:"vb",h:["float"],g:!1},{a:"node_out",c:"vc",h:["vec3"],g:!1},{a:"node_out",c:"vd",h:["float"],g:!1}],m:[{a:"txt",b:"vc = uT ; uZ = _0_0 ; vb = _0_0 ; vd = _0_0 ; u_ = nI ; uU ; uV ; uW ; uX ; uY ; va ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"ve",h:["vec3"],g:!1},{a:"node_in",c:"vf",h:["vec3"],g:!1},{a:"node_out",c:"vg",h:["vec3"],g:!1}],m:[{a:"txt",b:"vg = ve ; vf ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"vh",h:["vec3"],g:!1},{a:"node_in",c:"vi",h:["float"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_in",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1}],m:[{a:"txt",b:"vl [ 0 ] = vl [ 1 ] = vl [ 2 ] = _0_0 ; vh ; vi ; vj ; vk ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"vm",h:["vec3"],g:!1},{a:"node_in",c:"vn",h:["float"],g:!1},{a:"node_in",c:"vo",h:["float"],g:!1},{a:"node_in",c:"vp",h:["vec3"],g:!1},{a:"node_out",c:"vq",h:["vec3"],g:!1}],m:[{a:"txt",b:"vq = vm ; vn ; vo ; vp ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"vr",h:["vec3"],g:!1},{a:"node_in",c:"vs",h:["float"],g:!1},{a:"node_in",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["vec3"],g:!1}],m:[{a:"txt",b:"vu = vr ; vs ; vt ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_in",c:"vw",h:["float"],g:!1},{a:"node_in",c:"vx",h:["vec3"],g:!1},{a:"node_in",c:"vy",h:["float"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_in",c:"vA",h:["vec3"],g:!1},{a:"node_out",c:"vB",h:["vec3"],g:!1}],m:[{a:"txt",b:"vB [ 0 ] = vB [ 1 ] = vB [ 2 ] = _0_0 ; vv ; vx ; vy ; vz ; vA ; vw ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vC",h:["vec3"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],g:!1},{a:"node_out",c:"vF",h:["vec3"],g:!1},{a:"node_out",c:"vG",h:["float"],g:!1},{a:"node_out",c:"vH",h:["vec3"],g:!1},{a:"node_out",c:"vI",h:["float"],g:!1},{a:"node_out",c:"vJ",h:["float"],g:!1},{a:"node_out",c:"vK",h:["vec3"],g:!1},{a:"node_out",c:"vL",h:["vec3"],g:!1},{a:"node_out",c:"vM",h:["float"],g:!1},{a:"node_out",c:"vN",h:["vec3"],g:!1},{a:"node_out",c:"vO",h:["float"],g:!1}],m:[{a:"txt",b:"vL = vD * vC ; vJ = _0_0 ; vM = _1_0 ; vK = nI ; vE ; vF ; vG ; vH ; vI ; vN ; vO ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vP",h:["vec3"],g:!1},{a:"node_out",c:"vQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ; vP ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"vR [ 0 ] = vR [ 1 ] = vR [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vS",h:["vec3"],g:!1},{a:"node_in",c:"vT",h:["float"],g:!1},{a:"node_out",c:"vU",h:["vec3"],g:!1}],m:[{a:"txt",b:"vU [ 0 ] = vU [ 1 ] = vU [ 2 ] = _0_0 ; vS ; vT ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vV",h:["vec3"],g:!1},{a:"node_in",c:"vW",h:["float"],g:!1},{a:"node_in",c:"vX",h:["float"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"BUMP",u:[],s:[{a:"node_in",c:"Ge",h:["float"],g:!1},{a:"node_in",c:"Gf",h:["float"],g:!1},{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_in",c:"Gg",h:["vec3"],g:!1},{a:"node_out",c:"wc",h:["vec3"],g:!1}],m:[{a:"txt",b:"wc = Gg ; Ge ; Gf ; wa ;".split(" ")}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"wj",h:["float"],g:!1},{a:"node_out",c:"wk",h:["vec3"],g:!1}],m:[{a:"txt",b:"wk = nI ; wj ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["vec4"],g:!1},{a:"node_in",c:"wn",h:["vec3"],g:!1},{a:"node_out",c:"wo",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["vec3","wp","=","wn",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","wp","=","rC",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo = rG * wo ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo . yz *= - _1_0 ; wo = _ ( u_model_tsr , wo ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"wo = 2.0 * wm . xyz - _1_0 ; wo . yz *= - _1_0 ;".split(" ")}]}]},{a:"txt",b:"float lp = max ( wl , _0_0 ) ; wo = normalize ( mix ( wp , wo , lp ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"wq",h:["vec3"],g:!1},{a:"node_out",c:"wr",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],m:[{a:"txt",b:["wr","=","wq",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_model_tsr , wq ) ; wr = ap ( u_view_tsr_frag , wr ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = ap ( u_view_tsr_inverse , wq ) ; wr = ap ( u_model_tsr_inverse , wr ) ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_model_tsr , wq ) ; wr = _ ( u_view_tsr_frag , wr ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_inverse , wq ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = _ ( u_view_tsr_inverse , wq ) ; wr = _ ( u_model_tsr_inverse , wr ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",l:2}],m:[{a:"txt",b:"wr = normalize ( wr ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"ws",h:["float"],g:!1},{a:"node_out",c:"wt",h:["vec3"],g:!1}],m:[{a:"txt",b:"wt [ 0 ] = wt [ 1 ] = wt [ 2 ] = _0_0 ; ws ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wu",h:["float"],g:!1},{a:"node_out",c:"wv",h:["vec3"],g:!1}],m:[{a:"txt",b:"wv [ 0 ] = wv [ 1 ] = wv [ 2 ] = _0_0 ; wu ;".split(" ")}]},{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wA",h:["vec3"],g:!1},{a:"node_out",c:"wB",h:["float"],g:!1},{a:"node_out",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["float"],g:!1}],m:[{a:"txt",b:"wB = wA [ 0 ] ; wC = wA [ 1 ] ; wD = wA [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wE",h:["float"],g:!1},{a:"node_in",c:"wF",h:["float"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_out",c:"wH",h:["vec3"],g:!1}],m:[{a:"txt",b:"wH [ 0 ] = wE ; wH [ 1 ] = wF ; wH [ 2 ] = wG ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",u:[],s:[{a:"node_in",c:"wI",h:["vec3"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_in",c:"wK",h:["float"],g:!1},{a:"node_out",c:"wL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wJ - wK * _0_5 ; wL = max ( ( _1_0 + wK ) * wI + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wM",h:["float"],g:!1},{a:"node_in",c:"wN",h:["float"],g:!1},{a:"node_out",c:"wO",h:["float"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1},{a:"node_out",c:"wQ",h:["float"],g:!1}],m:[{a:"txt",b:"wO = wP = wQ = _0_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",u:[],s:[{a:"node_in",c:"Gh",h:["vec3"],g:!1},{a:"node_out",c:"Gi",h:["vec3"],g:!1},{a:"node_out",c:"Gj",h:["float"],g:!1}],m:[{a:"txt",b:"Gi [ 0 ] = Gi [ 1 ] = Gi [ 2 ] = _0_0 ; Gj = _1_0 ; Gh ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Gk",h:["vec3"],g:!1},{a:"node_out",c:"Gl",h:["vec3"],g:!1}],m:[{a:"txt",b:"Gl [ 0 ] = Gl [ 1 ] = Gl [ 2 ] = _0_0 ; Gk ;".split(" ")}]},{a:"node",c:"TEX_SKY",u:[],s:[{a:"node_in",c:"wR",h:["vec3"],g:!1},{a:"node_out",c:"wS",h:["vec3"],g:!1}],m:[{a:"txt",b:"wS [ 0 ] = wS [ 1 ] = wS [ 2 ] = _0_0 ; wR ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wT",h:["vec3"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_in",c:"w_",h:["float"],g:!1},{a:"node_in",c:"xa",h:["float"],g:!1},{a:"node_in",c:"xb",h:["float"],g:!1},{a:"node_in",c:"xc",h:["float"],g:!1},{a:"node_out",c:"xd",h:["vec3"],g:!1},{a:"node_out",c:"xe",h:["float"],g:!1}],m:[{a:"txt",b:"xd [ 0 ] = xd [ 1 ] = xd [ 2 ] = _0_0 ; xe = _1_0 ; wZ ; w_ ; xa ; xb ; xc ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"xf",h:["vec3"],g:!1},{a:"node_in",c:"xg",h:["float"],g:!1},{a:"node_out",c:"xh",h:["vec3"],g:!1},{a:"node_out",c:"xi",h:["float"],g:!1}],m:[{a:"txt",b:"xh [ 0 ] = xh [ 1 ] = xh [ 2 ] = _0_0 ; xi = _1_0 ; xf ; xg ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"xj",h:["vec3"],g:!1},{a:"node_in",c:"xk",h:["float"],g:!1},{a:"node_in",c:"xl",h:["float"],g:!1},{a:"node_in",c:"xm",h:["float"],g:!1},{a:"node_in",c:"xn",h:["float"],g:!1},{a:"node_in",c:"xo",h:["float"],g:!1},{a:"node_in",c:"xp",h:["float"],g:!1},{a:"node_out",c:"xq",h:["vec3"],g:!1},{a:"node_out",c:"xr",h:["float"],g:!1}],m:[{a:"txt",b:"xq [ 0 ] = xq [ 1 ] = xq [ 2 ] = _0_0 ; xr = _1_0 ; xj ; xk ; xl ; xm ; xn ; xo ; xp ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"xs",h:["vec3"],g:!1},{a:"node_out",c:"xt",h:["vec3"],g:!1},{a:"node_out",c:"xu",h:["float"],g:!1}],m:[{a:"txt",b:"xt [ 0 ] = xt [ 1 ] = xt [ 2 ] = _0_0 ; xu = _1_0 ; xs ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xv",h:["vec3"],g:!1},{a:"node_in",c:"xA",h:["float"],g:!1},{a:"node_in",c:"xB",h:["float"],g:!1},{a:"node_out",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["float"],g:!1}],m:[{a:"txt",b:"xC [ 0 ] = xC [ 1 ] = xC [ 2 ] = _0_0 ; xD = _1_0 ; xv ; xA ; xB ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xE",h:["vec3"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["float"],g:!1},{a:"node_out",c:"xI",h:["vec3"],g:!1},{a:"node_out",c:"xJ",h:["float"],g:!1}],m:[{a:"txt",b:"xI [ 0 ] = xI [ 1 ] = xI [ 2 ] = _0_0 ; xJ = _1_0 ; xE ; xF ; xG ; xH ;".split(" ")}]},{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xK",h:["vec3"],g:!1},{a:"node_in",c:"xL",h:["vec3"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["float"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",c:"xR",h:["float"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_out",c:"xT",h:["vec3"],g:!1},{a:"node_out",c:"xU",h:["float"],g:!1}],m:[{a:"txt",b:"xT [ 0 ] = xT [ 1 ] = xT [ 2 ] = _0_0 ; xU = _1_0 ; xK ; xL ; xM ; xN ; xO ; xP ; xQ ; xR ; xS ;".split(" ")}]},{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xV",h:["vec3"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_out",c:"xX",h:["vec3"],g:!1}],m:[{a:"txt",b:"xX = clamp ( xV + xW , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",u:[],s:[{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["vec3"],g:!1},{a:"node_in",c:"ya",h:["vec3"],g:!1},{a:"node_in",c:"yb",h:["float"],g:!1},{a:"node_in",c:"yc",h:["vec3"],g:!1},{a:"node_in",c:"yd",h:["float"],g:!1},{a:"node_in",c:"ye",h:["float"],g:!1},{a:"node_in",c:"yf",h:["vec3"],g:!1},{a:"node_in",c:"yg",h:["vec3"],g:!1},{a:"node_in",c:"yh",h:["float"],g:!1},{a:"node_in",c:"yi",h:["vec3"],g:!1},{a:"node_in",c:"yj",h:["float"],g:!1},{a:"node_in",c:"yk",h:["vec3"],g:!1},{a:"node_in",c:"yl",h:["float"],g:!1},{a:"node_in",c:"ym",h:["vec3"],g:!1},{a:"node_in",c:"yn",h:["float"],g:!1},{a:"node_in",c:"yo",h:["float"],g:!1},{a:"node_in",c:"yp",h:["vec3"],g:!1},{a:"node_in",c:"yq",h:["vec3"],g:!1},{a:"node_in",c:"yr",h:["float"],g:!1},{a:"node_in",c:"ys",h:["vec3"],g:!1},{a:"node_in",c:"yt",h:["float"],g:!1},{a:"node_out",c:"yu",h:["vec3"],g:!1},{a:"node_out",c:"yv",h:["vec3"],g:!1},{a:"node_out",c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["vec3"],g:!1},{a:"node_out",c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["float"],g:!1},{a:"node_out",c:"yE",h:["vec3"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["float"],g:!1},{a:"node_out",c:"yH",h:["vec3"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( xY , _0_0 , _1_0 ) ; yv = mix ( ya , yk , yJ ) ; yA = mix ( yb , yl , yJ ) ; if ( ye > _0_0 ) { if ( yo > _0_0 ) { yB = mix ( yc , ym , yJ ) ; yC = mix ( yd , yn , yJ ) ; } else { yB = yc ; yC = yd ; } } else { yB = ym ; yC = yn ; } if ( yh > _0_0 ) { if ( yr > _0_0 ) { yF = mix ( yg , yq , yJ ) ; } else { yF = yg ; } } else { yF = yq ; } yD = mix ( ye , yo , yJ ) ; yE = mix ( yf , yp , yJ ) ; yG = mix ( yh , yr , yJ ) ; yH = mix ( yi , ys , yJ ) ; yI = mix ( yj , yt , yJ ) ;".split(" ")}]},{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"yK",h:["vec3"],g:!1},{a:"node_out",c:"yL",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yK"],m:[{a:"txt",b:"yK = rd ( A ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yL"],m:[{a:"txt",b:"yL = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yM",h:["vec3"],g:!1}],m:[{a:"txt",b:"yM = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yN",h:["vec3"],g:!1}],m:[{a:"txt",b:["yN","=","nI",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yO",h:["vec3"],g:!1}],m:[{a:"txt",b:"yO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yP",h:["vec3"],g:!1}],m:[{a:"txt",b:"yP [ 0 ] = yP [ 1 ] = yP [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"yQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"yQ [ 0 ] = rH [ 0 ] ; yQ [ 1 ] = rH [ 1 ] ; yQ [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR [ 0 ] = yR [ 1 ] = yR [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yS",h:["vec3"],g:!1}],m:[{a:"txt",b:"yS [ 0 ] = yS [ 1 ] = yS [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yT",h:["vec3"],g:!1}],m:[{a:"txt",b:"yT = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1},{a:"node_out",c:"yW",h:["float"],g:!1},{a:"node_out",c:"yX",h:["vec3"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["vec3"],g:!1},{a:"node_out",c:"y_",h:["vec3"],g:!1},{a:"node_param",c:"Ga",h:["GLSL_IN","vec4"],g:!0},{a:"node_param",c:"Gb",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Gc",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Gd",h:["GLSL_IN","vec3"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PARTICLE_BATCH"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yU"],m:[{a:"txt",b:"yU = Ga [ 0 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yV"],m:[{a:"txt",b:"yV = Ga [ 1 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yW"],m:[{a:"txt",b:"yW = Ga [ 2 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yX"],m:[{a:"txt",b:["yX","=","Gb",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yY"],m:[{a:"txt",b:"yY = Ga [ 3 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yZ"],m:[{a:"txt",b:["yZ","=","Gc",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_y_"],m:[{a:"txt",b:["y_","=","Gd",";"]}]}]}]},{a:"node_else",m:[{a:"txt",b:"yU = _0_0 ; yV = _0_0 ; yW = _0_0 ; yX = vec3 ( _0_0 ) ; yY = _0_0 ; yZ = yX ; y_ = yX ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["vec3"],g:!1}],m:[{a:"txt",b:"za = _0_0 ; zb = _0_0 ; zc = _0_0 ; zd = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[],s:[{a:"node_out",c:"ze",h:["vec3"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1},{a:"node_out",c:"zg",h:["float"],g:!1},{a:"node_out",c:"zh",h:["float"],g:!1}],m:[{a:"txt",b:"zf = _0_0 ; zg = _0_0 ; zh = _0_0 ; ze = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"zi",h:["float"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:["zj","=","zi",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"zk",h:["vec3"],g:!1}],m:[{a:"txt",b:"zk = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",u:[],s:[{a:"node_in",c:"Gm",h:["float"],g:!1},{a:"node_in",c:"Gn",h:["vec3"],g:!1},{a:"node_out",c:"zn",h:["float"],g:!1},{a:"node_out",c:"zo",h:["float"],g:!1}],m:[{a:"txt",b:"zn = zo = _0_0 ; Gn ; Gm ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["float"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1},{a:"node_out",c:"zt",h:["float"],g:!1},{a:"node_out",c:"zu",h:["float"],g:!1},{a:"node_out",c:"zv",h:["float"],g:!1},{a:"node_out",c:"zA",h:["float"],g:!1},{a:"node_out",c:"zB",h:["float"],g:!1},{a:"node_out",c:"zC",h:["float"],g:!1},{a:"node_out",c:"zD",h:["float"],g:!1}],m:[{a:"txt",b:"zq = zr = zs = _0_0 ; zt = zu = zv = _0_0 ; zA = zA = zC = zD = _0_0 ; zB = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zF",h:["vec3"],g:!1},{a:"node_out",c:"zG",h:["vec3"],g:!1},{a:"node_out",c:"zH",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zG = vec3 ( _0_0 ) ; zH = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],s:[{a:"node_in",c:"zI",h:["float"],g:!1},{a:"node_in",c:"zJ",h:["vec3"],g:!1},{a:"node_out",c:"zK",h:["vec3"],g:!1}],m:[{a:"txt",b:["zK","=","zJ",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zK . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zK . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zK . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zJ . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zK = mix ( zJ , zK , zI ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zL",h:["float"],g:!1},{a:"node_in",c:"zM",h:["vec3"],g:!1},{a:"node_out",c:"zN",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zM . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float r = zM . r ; float g = zM . g ; float b = zM . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zN . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zN . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . g = g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zN . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zN . b = b ;".split(" ")}]}]},{a:"txt",b:"zN = mix ( zM , zN , zL ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zO",h:["float"],g:!1},{a:"node_out",c:"zP",h:["vec3"],g:!1},{a:"node_out",c:"zQ",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zO , NODE_TEX_ROW ) ) ; zP = zR . rgb ; zQ = zR . a ;".split(" ")}]},{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zS",h:["vec3"],g:!1},{a:"node_out",c:"zT",h:["vec3"],g:!1}],m:[{a:"txt",b:["zT","=","zS",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zT = zT * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zT = zT + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],m:[{a:"txt",b:"zT = ( MAPPING_TRS_MATRIX * vec4 ( zT , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zT = max ( zT , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zT = min ( zT , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zT = normalize ( zT ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zU",h:["float"],g:!1},{a:"node_in",c:"zV",h:["float"],g:!1},{a:"node_out",c:"zW",h:["float"],g:!1}],m:[{a:"txt",b:"zW = zU + zV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zX",h:["float"],g:!1},{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_out",c:"zZ",h:["float"],g:!1}],m:[{a:"txt",b:"zZ = zX - zY ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zZ = clamp ( zZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"z_",h:["float"],g:!1},{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_out",c:"Ab",h:["float"],g:!1}],m:[{a:"txt",b:"Ab = z_ * Aa ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ab = clamp ( Ab , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ac",h:["float"],g:!1},{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_out",c:"Ae",h:["float"],g:!1}],m:[{a:"txt",b:"Ae = ( Ad != _0_0 ) ? Ac / Ad : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ae = clamp ( Ae , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Af",h:["float"],g:!1},{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_out",c:"Ah",h:["float"],g:!1}],m:[{a:"txt",b:"Ah = sin ( Af ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ag",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ai",h:["float"],g:!1},{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_out",c:"Ak",h:["float"],g:!1}],m:[{a:"txt",b:"Ak = cos ( Ai ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ak = clamp ( Ak , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aj",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Al",h:["float"],g:!1},{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_out",c:"An",h:["float"],g:!1}],m:[{a:"txt",b:"An = tan ( Al ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"An = clamp ( An , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Am",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ao",h:["float"],g:!1},{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_out",c:"Aq",h:["float"],g:!1}],m:[{a:"txt",b:"Aq = ( Ao <= _1_0 && Ao >= - _1_0 ) ? asin ( Ao ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Aq = clamp ( Aq , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ap",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ar",h:["float"],g:!1},{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_out",c:"At",h:["float"],g:!1}],m:[{a:"txt",b:"At = ( Ar <= _1_0 && Ar >= - _1_0 ) ? acos ( Ar ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"At = clamp ( At , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["As",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Au",h:["float"],g:!1},{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_out",c:"Aw",h:["float"],g:!1}],m:[{a:"txt",b:"Aw = atan ( Au ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Aw = clamp ( Aw , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Av",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ax",h:["float"],g:!1},{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_out",c:"Az",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ax < _0_0 && Ay != floor ( Ay ) ) Az = _0_0 ; else if ( Ay == _0_0 ) Az = _1_0 ; else if ( Ax < _0_0 ) Az = mix ( _1_0 , - _1_0 , sign ( mod ( - Ay , 2.0 ) ) ) * pow ( - Ax , Ay ) ; else if ( Ax == _0_0 ) Az = _0_0 ; else Az = pow ( Ax , Ay ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Az = clamp ( Az , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AA",h:["float"],g:!1},{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_out",c:"AC",h:["float"],g:!1}],m:[{a:"txt",b:"AC = ( AA > _0_0 && AB > _0_0 ) ? log2 ( AA ) / log2 ( AB ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AD",h:["float"],g:!1},{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_out",c:"AF",h:["float"],g:!1}],m:[{a:"txt",b:"AF = min ( AD , AE ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AF = clamp ( AF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AG",h:["float"],g:!1},{a:"node_in",c:"AH",h:["float"],g:!1},{a:"node_out",c:"AI",h:["float"],g:!1}],m:[{a:"txt",b:"AI = max ( AG , AH ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AI = clamp ( AI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AJ",h:["float"],g:!1},{a:"node_in",c:"AK",h:["float"],g:!1},{a:"node_out",c:"AL",h:["float"],g:!1}],m:[{a:"txt",b:"AL = floor ( AJ + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AK",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["float"],g:!1},{a:"node_out",c:"AO",h:["float"],g:!1}],m:[{a:"txt",b:"AO = ( AM < AN ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AO = clamp ( AO , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AP",h:["float"],g:!1},{a:"node_in",c:"AQ",h:["float"],g:!1},{a:"node_out",c:"AR",h:["float"],g:!1}],m:[{a:"txt",b:"AR = ( AP > AQ ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AR = clamp ( AR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AS",h:["float"],g:!1},{a:"node_in",c:"AT",h:["float"],g:!1},{a:"node_out",c:"AU",h:["float"],g:!1}],m:[{a:"txt",b:"AU = abs ( AT ) > 0.000001 ? mod ( AS , AT ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AU = clamp ( AU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AV",h:["float"],g:!1},{a:"node_in",c:"AW",h:["float"],g:!1},{a:"node_out",c:"AX",h:["float"],g:!1}],m:[{a:"txt",b:"AX = abs ( AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AW",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AY",h:["float"],g:!1},{a:"node_in",c:"AZ",h:["vec3"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_out",c:"Ba",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( AY , _0_0 , _1_0 ) ; Ba = mix ( AZ , A_ , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ba = clamp ( Ba , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bb",h:["float"],g:!1},{a:"node_in",c:"Bc",h:["vec3"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_out",c:"Be",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bb , _0_0 , _1_0 ) ; Be = mix ( Bc , Bc + Bd , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Be = clamp ( Be , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bf",h:["float"],g:!1},{a:"node_in",c:"Bg",h:["vec3"],g:!1},{a:"node_in",c:"Bh",h:["vec3"],g:!1},{a:"node_out",c:"Bi",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bf , _0_0 , _1_0 ) ; Bi = mix ( Bg , Bg * Bh , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bi = clamp ( Bi , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bj",h:["float"],g:!1},{a:"node_in",c:"Bk",h:["vec3"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_out",c:"Bm",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bj , _0_0 , _1_0 ) ; Bm = mix ( Bk , Bk - Bl , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bm = clamp ( Bm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bn",h:["float"],g:!1},{a:"node_in",c:"Bo",h:["vec3"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_out",c:"Bq",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bn , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Bq = vec3 ( _1_0 ) - ( vec3 ( Br ) + yJ * ( vec3 ( _1_0 ) - Bp ) ) * ( vec3 ( _1_0 ) - Bo ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bq = clamp ( Bq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bs",h:["float"],g:!1},{a:"node_in",c:"Bt",h:["vec3"],g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_out",c:"Bv",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bs , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Bu += step ( Bu , vec3 ( _0_0 ) ) ; Bv = Br * Bt + yJ * Bt / Bu ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bv = clamp ( Bv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bw",h:["float"],g:!1},{a:"node_in",c:"Bx",h:["vec3"],g:!1},{a:"node_in",c:"By",h:["vec3"],g:!1},{a:"node_out",c:"Bz",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Bw , _0_0 , _1_0 ) ; Bz = mix ( Bx , abs ( Bx - By ) , yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bz = clamp ( Bz , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BA",h:["float"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_in",c:"BC",h:["vec3"],g:!1},{a:"node_out",c:"BD",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BA , _0_0 , _1_0 ) ; BD = min ( BB . rgb , BC . rgb * yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BD = clamp ( BD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BE",h:["float"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_in",c:"BG",h:["vec3"],g:!1},{a:"node_out",c:"BH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BE , _0_0 , _1_0 ) ; BH = max ( BF . rgb , BG . rgb * yJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BH = clamp ( BH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BI , _0_0 , _1_0 ) ; vec3 BM = vec3 ( _1_0 - yJ ) ; BL = mix ( BJ * ( BM + 2.0 * yJ * BK ) , vec3 ( _1_0 ) - ( BM + 2.0 * yJ * ( vec3 ( _1_0 ) - BK ) ) * ( vec3 ( _1_0 ) - BJ ) , step ( _0_5 , BJ ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BN",h:["float"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_in",c:"BP",h:["vec3"],g:!1},{a:"node_out",c:"BQ",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BN , _0_0 , _1_0 ) ; vec3 BR = vec3 ( _1_0 ) - yJ * BP ; vec3 BS = clamp ( BO / BR , _0_0 , _1_0 ) ; BQ = mix ( mix ( BS , vec3 ( _1_0 ) , step ( BR , vec3 ( _0_0 ) ) ) , BO , step ( BO , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BQ = clamp ( BQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BT",h:["float"],g:!1},{a:"node_in",c:"BU",h:["vec3"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_out",c:"BW",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BT , _0_0 , _1_0 ) ; vec3 jD = vec3 ( _1_0 - yJ ) ; vec3 BR = jD + yJ * BV ; vec3 BS = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BU ) / BR , _0_0 , _1_0 ) ; BW = mix ( BS , vec3 ( _0_0 ) , step ( BR , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BW = clamp ( BW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BX",h:["float"],g:!1},{a:"node_in",c:"BY",h:["vec3"],g:!1},{a:"node_in",c:"BZ",h:["vec3"],g:!1},{a:"node_out",c:"B_",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( BX , _0_0 , _1_0 ) ; vec3 jv , Ca , BR ; B_ = BY ; Ca = ju ( BZ ) ; if ( Ca . y != _0_0 ) { jv = ju ( B_ ) ; jv . x = Ca . x ; BR = jw ( jv ) ; B_ = mix ( B_ , BR , yJ ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"B_ = clamp ( B_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cb",h:["float"],g:!1},{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["vec3"],g:!1},{a:"node_out",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cb , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; Ce = Cc ; vec3 jv , Ca ; jv = ju ( Ce ) ; if ( jv . y != _0_0 ) { Ca = ju ( Cd ) ; jv . y = Br * jv . y + yJ * Ca . y ; Ce = jw ( jv ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ce = clamp ( Ce , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["float"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["vec3"],g:!1},{a:"node_out",c:"Ci",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cf , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; vec3 jv , Ca ; jv = ju ( Cg ) ; Ca = ju ( Ch ) ; jv . z = Br * jv . z + yJ * Ca . z ; Ci = jw ( jv ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Ci = clamp ( Ci , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cj",h:["float"],g:!1},{a:"node_in",c:"Ck",h:["vec3"],g:!1},{a:"node_in",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cj , _0_0 , _1_0 ) ; vec3 jv , Ca , BR ; Cm = Ck ; Ca = ju ( Cl ) ; if ( Ca . y != _0_0 ) { jv = ju ( Cm ) ; jv . x = Ca . x ; jv . y = Ca . y ; BR = jw ( jv ) ; Cm = mix ( Cm , BR , yJ ) ; }".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cm = clamp ( Cm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cn",h:["float"],g:!1},{a:"node_in",c:"Co",h:["vec3"],g:!1},{a:"node_in",c:"Cp",h:["vec3"],g:!1},{a:"node_out",c:"Cq",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cn , _0_0 , _1_0 ) ; float Br = _1_0 - yJ ; vec3 Cr = Cp + Co - Cp * Co ; Cq = Co * ( vec3 ( Br ) + vec3 ( yJ ) * ( ( vec3 ( _1_0 ) - Co ) * Cp + Cr ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cq = clamp ( Cq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["float"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_out",c:"Cv",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yJ = clamp ( Cs , _0_0 , _1_0 ) ; Cv = Ct + yJ * ( 2.0 * Cu - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cv = clamp ( Cv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"CE",h:["vec3"],g:!1},{a:"node_in",c:"CF",h:["float"],g:!1}],m:[{a:"txt",b:"D = CE ; H = CF ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"CG",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = CG ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"CI",h:["vec3"],g:!1},{a:"node_in",c:"CJ",h:["vec3"],g:!1},{a:"node_in",c:"CK",h:["float"],g:!1},{a:"node_in",c:"CL",h:["vec3"],g:!0},{a:"node_in",c:"CM",h:["float"],g:!0},{a:"node_out",c:"CN",h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["vec3"],g:!1},{a:"node_out",c:"CP",h:["vec3"],g:!1},{a:"node_out",c:"CQ",h:["vec3"],g:!1},{a:"node_out",c:"CR",h:["vec3"],g:!1},{a:"node_out",c:"CS",h:["vec2"],g:!1},{a:"node_out",c:"CT",h:["vec2"],g:!1},{a:"node_out",c:"CU",h:["vec4"],g:!1},{a:"node_param",c:"rv",h:["const","vec2"],g:!0},{a:"node_param",c:"rw",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"CP = clamp ( CI , _0_0 , _1_0 ) ; CQ = rw [ 0 ] * clamp ( CJ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"CR = normalize ( CL ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["CR","=","nI",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"CN = CM * CP ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"CN = rI * CP ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["CP","*=","CK",";"]}]}]},{a:"txt",b:"CO = rJ * u_environment_energy * co ( CR ) ; CU = vec4 ( _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"CS = vec2 ( rv [ 0 ] , rv [ 1 ] ) ; CT = vec2 ( rw [ 1 ] , rw [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","CU",";"]}]},{a:"node_else",m:[{a:"txt",b:"CN = vec3 ( _0_0 ) ; CO = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"CV",h:["vec4"],g:!1},{a:"node_in",c:"CW",h:["vec3"],g:!1},{a:"node_in",c:"CX",h:["vec3"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!0},{a:"node_in",c:"CZ",h:["float"],g:!0},{a:"node_in",c:"C_",h:["float"],g:!0},{a:"node_out",c:"Da",h:["vec3"],g:!0},{a:"node_out",c:"Db",h:["float"],g:!0},{a:"node_out",c:"Dc",h:["vec3"],g:!0},{a:"node_out",c:"Dd",h:["vec3"],g:!0},{a:"node_out",c:"De",h:["vec3"],g:!0},{a:"node_param",c:"rx",h:["float"],g:!1},{a:"node_param",c:"ry",h:["float"],g:!1}],m:[{a:"txt",b:["CY",";"]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Da"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Da = CV . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Da = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Da","+=","CW",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dc"],m:[{a:"txt",b:["Dc","=","CX",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dd"],m:[{a:"txt",b:"Dd = CV . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_De"],m:[{a:"txt",b:["De","=","CW",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Db"],m:[{a:"txt",b:"Db = clamp ( C_ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( CW . r , CW . g ) , CW . b ) * CZ ; Db = clamp ( C_ * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Db"],m:[{a:"txt",b:"Db = clamp ( rx , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( CW . r , CW . g ) , CW . b ) * ry ; Db = rx * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","CW",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","CX",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_in",c:"ob",h:["vec3"],g:!1},{a:"node_out",c:"oc",h:["vec4"],g:!1},{a:"node_out",c:"od",h:["vec3"],g:!1}],m:[{a:"txt",b:"oc = vec4 ( n_ + ob * oa , _0_0 ) ; od = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],s:[{a:"node_in",c:"oe",h:["vec4"],g:!1},{a:"node_out",c:"of",h:["vec3"],g:!1},{a:"node_out",c:"og",h:["vec2"],g:!1},{a:"node_out",c:"oh",h:["vec3"],g:!1},{a:"node_out",c:"oi",h:["float"],g:!1}],m:[{a:"txt",b:"og = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oi","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oi","=","_0_0",";"]}]}]},{a:"txt",b:"oh = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"oh *= oe [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oj = u_light_positions [ LAMP_IND ] . xyz ; of = oj - nH ; float aN = length ( of ) ; oh *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aN * aN ) ; of = normalize ( of ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ol = u_light_directions [ LAMP_IND ] ; float om = dot ( of , ol ) ; om *= smoothstep ( _0_0 , _1_0 , ( om - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oh *= om ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"txt",b:"of = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"on",h:["vec3"],g:!1},{a:"node_in",c:"oo",h:["vec2"],g:!1},{a:"node_in",c:"op",h:["vec3"],g:!1},{a:"node_in",c:"oq",h:["float"],g:!1},{a:"node_in",c:"or",h:["vec2"],g:!1},{a:"node_out",c:"os",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( on , k . xyz ) ; op = cross ( ot , k . xyz ) ; op = - normalize ( op ) ;".split(" ")}]}]},{a:"txt",b:"os = _0_0 ; if ( oo . r != _0_0 ) { float ou = ( _1_0 - oq ) * dot ( op , on ) + oq ; if ( or [ 0 ] == _0_0 ) { os = _1_0 ; } else { float t = _1_0 + abs ( ou ) ; t = or [ 1 ] + ( _1_0 - or [ 1 ] ) * pow ( t , or [ 0 ] ) ; os = clamp ( t , _0_0 , _1_0 ) ; } os = max ( os , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ov",h:["vec3"],g:!1},{a:"node_in",c:"ow",h:["vec2"],g:!1},{a:"node_in",c:"ox",h:["vec3"],g:!1},{a:"node_in",c:"oy",h:["float"],g:!1},{a:"node_out",c:"oz",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( ov , k . xyz ) ; ox = cross ( ot , k . xyz ) ; ox = - normalize ( ox ) ;".split(" ")}]}]},{a:"txt",b:"oz = _0_0 ; if ( ow . r != _0_0 ) { float ou = ( _1_0 - oy ) * dot ( ox , ov ) + oy ; oz = max ( ou , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oA",h:["vec3"],g:!1},{a:"node_in",c:"oB",h:["vec2"],g:!1},{a:"node_in",c:"oC",h:["vec3"],g:!1},{a:"node_in",c:"oD",h:["float"],g:!1},{a:"node_in",c:"oE",h:["vec2"],g:!1},{a:"node_out",c:"oF",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oA , k . xyz ) ; oC = cross ( ot , k . xyz ) ; oC = - normalize ( oC ) ;".split(" ")}]}]},{a:"txt",b:"oF = _0_0 ; if ( oB . r != _0_0 ) { float ou = ( _1_0 - oD ) * dot ( oC , oA ) + oD ; if ( oE [ 0 ] > _0_0 ) { float oG = max ( dot ( oC , nJ ) , _0_0 ) ; float oH = oE [ 0 ] * oE [ 0 ] ; float cq = _1_0 - _0_5 * ( oH / ( oH + 0.33 ) ) ; vec3 oI = oA - ou * oC ; vec3 oJ = nJ - oG * oC ; if ( length ( oI ) == _0_0 || length ( oJ ) == _0_0 || abs ( ou ) > _1_0 || abs ( oG ) > _1_0 ) oF = ou * cq ; else { float oK = acos ( ou ) ; float oL = acos ( oG ) ; vec3 oM = normalize ( oI ) ; vec3 oN = normalize ( oJ ) ; float a , b ; a = max ( oK , oL ) ; b = min ( oK , oL ) ; b *= 0.95 ; float t = max ( dot ( oM , oN ) , _0_0 ) ; float oO = 0.45 * ( oH / ( oH + 0.09 ) ) ; oF = ou * ( cq + ( oO * t * sin ( a ) * tan ( b ) ) ) ; } } else oF = ou ; oF = max ( oF , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oP",h:["vec3"],g:!1},{a:"node_in",c:"oQ",h:["vec2"],g:!1},{a:"node_in",c:"oR",h:["vec3"],g:!1},{a:"node_in",c:"oS",h:["float"],g:!1},{a:"node_in",c:"oT",h:["vec2"],g:!1},{a:"node_out",c:"oU",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oP , k . xyz ) ; oR = cross ( ot , k . xyz ) ; oR = - normalize ( oR ) ;".split(" ")}]}]},{a:"txt",b:"oU = _0_0 ; if ( oQ . r != _0_0 ) { float ou = ( _1_0 - oS ) * dot ( oR , oP ) + oS ; float oG = max ( dot ( oR , nJ ) , _0_0 ) ; if ( oT [ 0 ] <= _1_0 ) oU = ou * pow ( max ( oG * ou , 0.1 ) , oT [ 0 ] - _1_0 ) ; else oU = ou * pow ( 1.0001 - oG , oT [ 0 ] - _1_0 ) ; oU = max ( oU , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oV",h:["vec3"],g:!1},{a:"node_in",c:"oW",h:["vec2"],g:!1},{a:"node_in",c:"oX",h:["vec3"],g:!1},{a:"node_in",c:"oY",h:["float"],g:!1},{a:"node_in",c:"oZ",h:["vec2"],g:!1},{a:"node_out",c:"o_",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 ot = cross ( oV , k . xyz ) ; oX = cross ( ot , k . xyz ) ; oX = - normalize ( oX ) ;".split(" ")}]}]},{a:"txt",b:"o_ = _0_0 ; if ( oW . r != _0_0 ) { float ou = ( _1_0 - oY ) * dot ( oX , oV ) + oY ; float pa = acos ( ou ) ; if ( pa < oZ [ 0 ] ) o_ = _1_0 ; else if ( pa > ( oZ [ 0 ] + oZ [ 1 ] ) || oZ [ 1 ] == _0_0 ) o_ = _0_0 ; else o_ = _1_0 - ( ( pa - oZ [ 0 ] ) / oZ [ 1 ] ) ; o_ = max ( o_ , _0_0 ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pb",h:["vec3"],g:!1},{a:"node_in",c:"pc",h:["vec2"],g:!1},{a:"node_in",c:"pd",h:["vec3"],g:!1},{a:"node_in",c:"pe",h:["float"],g:!1},{a:"node_in",c:"pf",h:["vec2"],g:!1},{a:"node_out",c:"pg",h:["float"],g:!1}],m:[{a:"txt",b:"pg = _0_0 ; if ( pc . g == _1_0 ) { vec3 ph = normalize ( pb + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pe == _0_0 ) { pg = dot ( k . xyz , ph ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pg = ( _1_0 - pe ) * max ( dot ( pd , ph ) , _0_0 ) + pe ;".split(" ")}]}]},{a:"txt",b:"pg = pow ( pg , pf [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pi",h:["vec3"],g:!1},{a:"node_in",c:"pj",h:["vec2"],g:!1},{a:"node_in",c:"pk",h:["vec3"],g:!1},{a:"node_in",c:"pl",h:["float"],g:!1},{a:"node_in",c:"pm",h:["vec2"],g:!1},{a:"node_out",c:"pn",h:["float"],g:!1}],m:[{a:"txt",b:"pn = _0_0 ; if ( pj . g != _0_0 ) { vec3 ph = normalize ( pi + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pl == _0_0 ) { pn = dot ( B . xyz , ph ) ; pn = sqrt ( _1_0 - pn * pn ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pn = max ( dot ( pk , ph ) , _0_0 ) ; pn = ( _1_0 - pl ) * pn + pl ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oG = max ( dot ( B . xyz , nJ ) , _0_0 ) ; oG = sqrt ( _1_0 - oG * oG ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oG = max ( dot ( pk , nJ ) , _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"pn = pow ( pn , pm [ 0 ] ) ; pn = pn / ( 0.1 + oG ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"po",h:["vec3"],g:!1},{a:"node_in",c:"pr",h:["vec2"],g:!1},{a:"node_in",c:"pu",h:["vec3"],g:!1},{a:"node_in",c:"pv",h:["float"],g:!1},{a:"node_in",c:"pw",h:["vec2"],g:!1},{a:"node_out",c:"px",h:["float"],g:!1}],m:[{a:"txt",b:"px = _0_0 ; if ( pr . g == _1_0 ) { vec3 ph = normalize ( po + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = _0_0 ; float oG = _0_0 ; float pz = _0_0 ; if ( pv == _0_0 ) { py = dot ( k . xyz , ph ) ; oG = dot ( k . xyz , nJ ) ; pz = dot ( k . xyz , po ) ; py = sqrt ( _1_0 - py * py ) ; oG = sqrt ( _1_0 - oG * oG ) ; pz = sqrt ( _1_0 - pz * pz ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = max ( dot ( pu , ph ) , 0.01 ) ; float oG = max ( dot ( pu , nJ ) , 0.01 ) ; float pz = max ( dot ( pu , po ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float by = tan ( acos ( py ) ) ; float J = max ( pw [ 0 ] , 0.01 ) ; px = pz * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( by * by ) / ( J * J ) ) / ( sqrt ( oG * pz ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pA",h:["vec3"],g:!1},{a:"node_in",c:"pB",h:["vec2"],g:!1},{a:"node_in",c:"pC",h:["vec3"],g:!1},{a:"node_in",c:"pD",h:["float"],g:!1},{a:"node_in",c:"pE",h:["vec2"],g:!1},{a:"node_out",c:"pF",h:["float"],g:!1}],m:[{a:"txt",b:"pF = _0_0 ; if ( pB . g == _1_0 ) { vec3 bY = normalize ( pA + nJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pG = dot ( bY , k . xyz ) ; float by = pE [ 0 ] + pE [ 1 ] ; if ( pD == _0_0 ) by = acos ( sqrt ( _1_0 - pG * pG ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float by = acos ( dot ( bY , pC ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( by < pE [ 0 ] ) pF = _1_0 ; else if ( by >= pE [ 0 ] + pE [ 1 ] || pE [ 1 ] == _0_0 ) pF = _0_0 ; else pF = _1_0 - ( by - pE [ 0 ] ) / pE [ 1 ] ; }".split(" ")}]},{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pH",h:["vec3"],g:!1},{a:"node_in",c:"pI",h:["vec2"],g:!1},{a:"node_in",c:"pJ",h:["vec3"],g:!1},{a:"node_in",c:"pK",h:["float"],g:!1},{a:"node_in",c:"pL",h:["vec2"],g:!1},{a:"node_out",c:"pM",h:["float"],g:!1}],m:[{a:"txt",b:"pM = _0_0 ; if ( pI . g == _1_0 ) { if ( pL [ 0 ] < _1_0 || pL [ 1 ] == _0_0 ) pM = _0_0 ; else { if ( pL [ 1 ] < 100.0 ) pL [ 1 ] = sqrt ( _1_0 / pL [ 1 ] ) ; else pL [ 1 ] = 10.0 / pL [ 1 ] ; vec3 ph = normalize ( nJ + pH ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float py = _0_0 ; if ( pK == _0_0 ) { float pP = dot ( k . xyz , ph ) ; py = sqrt ( _1_0 - pP * pP ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float py = ( _1_0 - pK ) * max ( dot ( pJ , ph ) , _0_0 ) + pK ;".split(" ")}]}]},{a:"txt",b:"if ( py < _0_0 ) pM = _0_0 ; else { float oG = max ( dot ( pJ , nJ ) , 0.01 ) ; float pz = dot ( pJ , pH ) ; if ( pz <= 0.01 ) pM = _0_0 ; else { float pQ = max ( dot ( nJ , ph ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * py * oG ) / pQ ; float dj = ( 2.0 * py * pz ) / pQ ; float g = min ( min ( a , b ) , dj ) ; float p = sqrt ( pow ( pL [ 0 ] , 2.0 ) + pow ( pQ , 2.0 ) - _1_0 ) ; float lx = pow ( p - pQ , 2.0 ) / pow ( p + pQ , 2.0 ) * ( _1_0 + pow ( pQ * ( p + pQ ) - _1_0 , 2.0 ) / pow ( pQ * ( p - pQ ) + _1_0 , 2.0 ) ) ; float pa = acos ( py ) ; pM = max ( lx * g * exp ( - pow ( pa , 2.0 ) / ( 2.0 * pow ( pL [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pR",h:["vec4"],g:!1},{a:"node_in",c:"pS",h:["vec3"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["float"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec3"],g:!1},{a:"node_in",c:"pX",h:["vec4"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["vec3"],g:!1},{a:"node_in",c:"qa",h:["float"],g:!1},{a:"node_out",c:"qb",h:["vec4"],g:!1},{a:"node_out",c:"qc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pV , pW ) * dot ( nJ , pW ) < _0_0 ) { float Df = pX . x ; float Dg = pX . y ; float Dh = pX . z ; float Di = pX . w ; float Dj = clamp ( abs ( dot ( pV , pW ) ) , _0_0 , _1_0 ) ; float Dk = clamp ( dot ( nJ , - pV ) , _0_0 , _1_0 ) ; float Dl = pow ( Dk , Dg ) ; qb = pR + qa * vec4 ( p_ * Dj * pow ( pY , vec3 ( Df ) ) , _1_0 ) ; qb += Dh * mix ( vec4 ( pY , _1_0 ) , vec4 ( _1_0 ) , Di ) * qa * vec4 ( p_ * Dj * vec3 ( Dl ) , _1_0 ) ; } else { qb = pR + vec4 ( p_ * pY * pT , pU ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"qb = pR + vec4 ( p_ * pY * pT , pU ) ;".split(" ")}]}]},{a:"txt",b:"qc = pS + p_ * pZ * pU ;".split(" ")}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"Dm",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dm = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!1},{a:"node_out",c:"Do",h:["float"],g:!1}],m:[{a:"txt",b:"Do = dot ( Dn , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"Dp",h:["vec3"],g:!1},{a:"node_out",c:"Dq",h:["float"],g:!0},{a:"node_out",c:"Dr",h:["float"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dq"],m:[{a:"txt",b:"Dq = Dp . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = Dp . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = Dp . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"Dt",h:["vec3"],g:!1},{a:"node_out",c:"Du",h:["float"],g:!0},{a:"node_out",c:"Dv",h:["float"],g:!0},{a:"node_out",c:"Dw",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 Dx = ju ( Dt ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = Dx . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = Dx . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",b:"Dw = Dx . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"Dy",h:["float"],g:!1},{a:"node_in",c:"Dz",h:["float"],g:!1},{a:"node_in",c:"DA",h:["float"],g:!1},{a:"node_out",c:"DB",h:["float"],g:!1}],m:[{a:"txt",b:"DB = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Dy - DA ) * Dz ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"DC",h:["vec3"],g:!1},{a:"node_in",c:"DD",h:["float"],g:!1},{a:"node_out",c:"DE",h:["vec3"],g:!1}],m:[{a:"txt",b:"DE = DC ; if ( DE . x > _0_0 ) DE . x = pow ( DC . x , DD ) ; if ( DE . y > _0_0 ) DE . y = pow ( DC . y , DD ) ; if ( DE . z > _0_0 ) DE . z = pow ( DC . z , DD ) ;".split(" ")}]},{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"DF",h:["vec3"],g:!1},{a:"node_out",c:"DG",h:["vec3"],g:!1}],m:[{a:"txt",b:"DG = max ( vec3 ( _0_0 ) , DF ) ; DG = pow ( DG , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"DH",h:["vec3"],g:!1},{a:"node_out",c:"DI",h:["vec3"],g:!1}],m:[{a:"txt",b:"DI = max ( vec3 ( _0_0 ) , DH ) ; DI = pow ( DI , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"DJ",h:["vec3"],g:!1},{a:"node_out",c:"DK",h:["vec3"],g:!1},{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],m:[{a:"txt",b:"DJ [ 2 ] = DJ [ 1 ] = DJ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK [ 2 ] = DK [ 1 ] = DK [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DL"],m:[{a:"txt",b:["DL","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Go",h:["vec3"],g:!1},{a:"node_out",c:"Gp",h:["vec3"],g:!0},{a:"node_out",c:"Gq",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Go ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Gp"],m:[{a:"txt",b:"Gp = zR . xyz ; ch ( Gp ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Gq"],m:[{a:"txt",b:"Gq = zR . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"DW",h:["vec3"],g:!0},{a:"node_in",c:"DX",h:["vec3"],g:!0},{a:"node_in",c:"DY",h:["vec3"],g:!0},{a:"node_in",c:"DZ",h:["vec3"],g:!0},{a:"node_out",c:"D_",h:["vec3"],g:!0},{a:"node_out",c:"Ea",h:["float"],g:!0},{a:"node_out",c:"Eb",h:["vec3"],g:!0},{a:"node_out",c:"Ec",h:["float"],g:!0},{a:"node_out",c:"Ed",h:["vec3"],g:!0},{a:"node_out",c:"Ee",h:["float"],g:!0},{a:"node_out",c:"Ef",h:["vec3"],g:!0},{a:"node_out",c:"Eg",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DW ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_D_"],m:[{a:"txt",b:"D_ = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","D_",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = zR . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DX ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eb"],m:[{a:"txt",b:"Eb = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Eb",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ec"],m:[{a:"txt",b:"Ec = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DY ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ed"],m:[{a:"txt",b:"Ed = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Ed",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , re ( DZ ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ef"],m:[{a:"txt",b:"Ef = zR . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["ch","(","Ef",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eg"],m:[{a:"txt",b:"Eg = zR . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Eh",h:["vec3"],g:!0},{a:"node_in",c:"Ei",h:["vec3"],g:!0},{a:"node_in",c:"Ej",h:["vec3"],g:!0},{a:"node_in",c:"Ek",h:["vec3"],g:!0},{a:"node_out",c:"El",h:["vec3"],g:!0},{a:"node_out",c:"Em",h:["float"],g:!0},{a:"node_out",c:"En",h:["vec3"],g:!0},{a:"node_out",c:"Eo",h:["float"],g:!0},{a:"node_out",c:"Ep",h:["vec3"],g:!0},{a:"node_out",c:"Eq",h:["float"],g:!0},{a:"node_out",c:"Er",h:["vec3"],g:!0},{a:"node_out",c:"Es",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Eh ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_El"],m:[{a:"txt",b:"El = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Em"],m:[{a:"txt",b:"Em = zR . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ei ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_En"],m:[{a:"txt",b:"En = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eo"],m:[{a:"txt",b:"Eo = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ej ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ep"],m:[{a:"txt",b:"Ep = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Eq"],m:[{a:"txt",b:"Eq = zR . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zR = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , re ( Ek ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Er"],m:[{a:"txt",b:"Er = normalize ( rE * ( zR . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Es"],m:[{a:"txt",b:"Es = zR . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",b:["0"]}],s:[{a:"node_out",c:"Et",h:["float"],g:!1}],m:[{a:"txt",b:"Et = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"Eu",h:["vec3"],g:!1},{a:"node_in",c:"Ev",h:["vec3"],g:!1},{a:"node_out",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["float"],g:!0}],m:[{a:"txt",b:"Ew = Eu + Ev ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ex"],m:[{a:"txt",b:"Ex = ( abs ( Ew [ 0 ] ) + abs ( Ew [ 1 ] ) + abs ( Ew [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["vec3"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1},{a:"node_out",c:"EB",h:["float"],g:!0}],m:[{a:"txt",b:"EA = Ey - Ez ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EB"],m:[{a:"txt",b:"EB = ( abs ( EA [ 0 ] ) + abs ( EA [ 1 ] ) + abs ( EA [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"EC",h:["vec3"],g:!1},{a:"node_in",c:"ED",h:["vec3"],g:!1},{a:"node_out",c:"EE",h:["vec3"],g:!1},{a:"node_out",c:"EF",h:["float"],g:!0}],m:[{a:"txt",b:"EE = EC + ED ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EF"],m:[{a:"txt",b:"EF = length ( EE ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EE"],m:[{a:"txt",b:"EE = normalize ( EE ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"EG",h:["vec3"],g:!1},{a:"node_in",c:"EH",h:["vec3"],g:!1},{a:"node_out",c:"EI",h:["vec3"],g:!1},{a:"node_out",c:"EJ",h:["float"],g:!0}],m:[{a:"txt",b:"EI = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EJ"],m:[{a:"txt",b:"EJ = dot ( EG , EH ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"EK",h:["vec3"],g:!1},{a:"node_in",c:"EL",h:["vec3"],g:!1},{a:"node_out",c:"EM",h:["vec3"],g:!1},{a:"node_out",c:"EN",h:["float"],g:!0}],m:[{a:"txt",b:"EM = cross ( EK , EL ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EN"],m:[{a:"txt",b:"EN = length ( EM ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"EO",h:["vec3"],g:!1},{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",h:["vec3"],g:!1},{a:"node_out",c:"ER",h:["float"],g:!0}],m:[{a:"txt",b:"EQ = normalize ( EO ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ER"],m:[{a:"txt",b:"ER = length ( EO ) ;".split(" ")}]}]},{a:"txt",b:["EP",";"]}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"EY",h:["vec3"],g:!1},{a:"node_in",c:"EZ",h:["vec3"],g:!1},{a:"node_out",c:"E_",h:["vec3"],g:!1}],m:[{a:"txt",b:"E_ = reflect ( _ ( u_view_tsr_inverse , EY ) , EZ ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Fa",h:["vec3"],g:!1},{a:"node_out",c:"Fb",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 Gr = - nJ . xyz ; Fb = reflect ( Gr , Fa ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Fc",h:["vec3"],g:!1},{a:"node_in",c:"Fd",h:["float"],g:!1},{a:"node_in",c:"Fe",h:["const","float"],g:!1},{a:"node_in",c:"Ff",h:["const","float"],g:!1},{a:"node_out",c:"Fg",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bB = length ( rH ) ; if ( bB < Ff ) { vec2 bO = re ( Fc ) ; float bS = clamp ( _0_5 * ( Ff - bB ) , _0_0 , _1_0 ) ; float hf = Fd * bS ; vec3 bU = normalize ( nJ * rE ) ; float bV = _1_0 / Fe ; vec2 bW = bU . xy * hf / ( Fe * bU . z ) ; float bX = _1_0 ; float bY = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a ; for ( float b_ = _1_0 ; b_ <= Fe ; b_ ++ ) { if ( bY < bX ) { bX -= bV ; bO -= bW ; bY = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a ; } } vec2 ca = bO + bW ; float cb = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ca ) . a - ( bX + bV ) ; float cc = bY - bX ; float cd = cc / ( cc - cb ) ; bO = cd * ca + ( _1_0 - cd ) * bO ; Fg = rd ( bO ) ; } else Fg = Fc ;".split(" ")}]},{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Fh",h:["vec3"],g:!1},{a:"node_out",c:"Fi",h:["vec3"],g:!1}],m:[{a:"txt",b:"Fi = clamp ( Fh , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Fj",h:["vec3"],g:!1},{a:"node_in",c:"Fk",h:["float"],g:!1},{a:"node_out",c:"Fl",h:["vec3"],g:!1}],m:[{a:"txt",b:["Fl","=","Fj",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"Fm",h:["float"],g:!1},{a:"node_in",c:"Fn",h:["float"],g:!1},{a:"node_in",c:"Fo",h:["float"],g:!1},{a:"node_in",c:"Fp",h:["float"],g:!1},{a:"node_in",c:"Fq",h:["float"],g:!1},{a:"node_out",c:"Fr",h:["float"],g:!0},{a:"node_out",c:"Fs",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Fr"],m:[{a:"txt",b:["Fr","=","Fm",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Fs"],m:[{a:"txt",b:"Fs = vec4 ( Fn , Fo , Fp , Fq ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"Ft",h:["float"],g:!1}],m:[{a:"txt",b:["Ft","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",u:[],s:[{a:"node_in",c:"Fu",h:["float"],g:!1},{a:"node_in",c:"Fv",h:["float"],g:!1},{a:"node_in",c:"Fw",h:["float"],g:!1},{a:"node_out",c:"Fx",h:["float"],g:!1}],m:[{a:"txt",b:"Fx = smoothstep ( Fv , Fw , Fu ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"Fy",h:["vec3"],g:!1},{a:"node_in",c:"Fz",h:["float"],g:!1}],m:[{a:"txt",b:"D = Fy ; H = Fz ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"FA",h:["vec3"],g:!1},{a:"node_out",c:"FB",h:["float"],g:!1}],m:[{a:"txt",b:"FB = ( FA . r + FA . g + FA . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"FC",h:["float"],g:!1},{a:"node_out",c:"FD",h:["vec3"],g:!1}],m:[{a:"txt",b:"FD [ 0 ] = FC ; FD [ 1 ] = FC ; FD [ 2 ] = FC ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nJ , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:["vec3","rB","=","j",";"]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"rB = rB ; else rB = - rB ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_NORMAL_MAP"],j:{a:"grp",f:[{a:"txt",b:["vec3","rC","=","rB",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"vec3 rD = normalize ( rB ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nI","=","rD",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 nI = normalize ( j ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rA","=","rD",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rD , k . xyz ) * k . w ; mat3 rE = mat3 ( k . xyz , W , rD ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_NORMAL_MAP"],j:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rB , k . xyz ) * k . w ; mat3 rG = mat3 ( k . xyz , W , rB ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 nH = h ; vec4 rH = i ; float rI = u_emit ; float rJ = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]},e["include/particles_nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLV",b:[""]},{a:"node",c:"TEX_COORD_UV",u:[],s:[],m:[{a:"txt",b:["A","=","Gx",";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[],m:[{a:"txt",b:["A","=","Gx",";"]}]},{a:"node",c:"UVMAP",u:[],s:[],m:[{a:"txt",b:["A","=","Gx",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[],m:[{a:"txt",b:["A","=","Gx",";"]}]},{a:"node",c:"PARTICLE_INFO",u:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],s:[{a:"node_param",c:"Ga",h:["GLSL_OUT","vec4"],g:!0},{a:"node_param",c:"Gb",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Gc",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Gd",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",h:["GLSL_IN","float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_SIZE"],m:[{a:"txt",b:"Ga [ 3 ] = Gw ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_AGE"],m:[{a:"txt",b:"Ga [ 1 ] = Gv ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LT"],m:[{a:"txt",b:"Ga [ 2 ] = Gy ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LOC"],m:[{a:"txt",b:["Gb","=","Gs",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_IND"],m:[{a:"txt",b:"Ga [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_VEL"],m:[{a:"txt",b:["Gc","=","Gt",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_A_VEL"],m:[{a:"txt",b:["Gd","=","Gu",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 Gs , in vec3 Gt , in vec3 Gu , in float Gv , in float Gw , in vec2 Gx , in float Gy ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","Gx",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]},e["include/precision_statement.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",j:{a:"grp",f:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]},e["include/procedural.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PROCEDURAL_GLSLF",j:{a:"grp",f:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Gz ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Gz ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Gz ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 GA ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 GB ( vec4 x ) { return Gz ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 fe ( vec2 GC ) { vec2 GD = Gz ( floor ( GC ) ) ; vec2 GE = fract ( GC ) ; vec4 GF = GE . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 GG = GE . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = GB ( GD . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = GB ( p + GD . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 GH = GA ( p ) * K + K2 ; vec4 GI = GA ( floor ( p * K ) ) * K + K2 ; vec4 GJ = GF + JITTER * GH ; vec4 GK = GG + JITTER * GI ; vec4 dp = GJ * GJ + GK * GK ;".split(" ")},{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"txt",b:"dp . xy = min ( dp . xy , dp . zw ) ; dp . x = min ( dp . x , dp . y ) ; return dp . xx ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dp . xy = ( dp . x < dp . y ) ? dp . xy : dp . yx ; dp . xz = ( dp . x < dp . z ) ? dp . xz : dp . zx ; dp . xw = ( dp . x < dp . w ) ? dp . xw : dp . wx ; dp . y = min ( dp . y , dp . z ) ; dp . y = min ( dp . y , dp . w ) ; return sqrt ( dp . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kl ( vec2 GC , float GL ) { vec2 GD = Gz ( floor ( GC ) ) ; vec2 GE = fract ( GC ) ; vec4 GF = GE . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 GG = GE . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = GB ( GD . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = GB ( p + GD . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 GH = GA ( p ) * K + K2 ; vec4 GI = GA ( floor ( p * K ) ) * K + K2 ; vec4 GJ = GF + JITTER * GH ; vec4 GK = GG + JITTER * GI ; vec4 GM = GJ * GJ + GK * GK ; GJ += GL ; GK += GL ; vec4 GN = GJ * GJ + GK * GK ; GJ += GL ; GK += GL ; vec4 GO = GJ * GJ + GK * GK ; GM . xy = min ( GM . xy , GM . zw ) ; GM . x = min ( GM . x , GM . y ) ; GN . xy = min ( GN . xy , GN . zw ) ; GN . x = min ( GN . x , GN . y ) ; GO . xy = min ( GO . xy , GO . zw ) ; GO . x = min ( GO . x , GO . y ) ; return vec3 ( GM . x , GN . x , GO . x ) ; } vec3 GP ( vec3 x ) { return Gz ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eU ( vec2 ke ) { const vec4 GQ = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 b_ = floor ( ke + dot ( ke , GQ . yy ) ) ; vec2 GR = ke - b_ + dot ( b_ , GQ . xx ) ; vec2 GS ; GS = ( GR . x > GR . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 GT = GR . xyxy + GQ . xxzz ; GT . xy -= GS ; b_ = Gz ( b_ ) ; vec3 p = GP ( GP ( b_ . y + vec3 ( _0_0 , GS . y , _1_0 ) ) + b_ . x + vec3 ( _0_0 , GS . x , _1_0 ) ) ; vec3 aB = max ( 0.5 - vec3 ( dot ( GR , GR ) , dot ( GT . xy , GT . xy ) , dot ( GT . zw , GT . zw ) ) , _0_0 ) ; aB = aB * aB ; aB = aB * aB ; vec3 x = 2.0 * fract ( p * GQ . www ) - _1_0 ; vec3 bY = abs ( x ) - 0.5 ; vec3 GH = floor ( x + 0.5 ) ; vec3 GU = x - GH ; aB *= 1.79284291400159 - 0.85373472095314 * ( GU * GU + bY * bY ) ; vec3 g ; g . x = GU . x * GR . x + bY . x * GR . y ; g . yz = GU . yz * GT . xz + bY . yz * GT . yw ; return 130.0 * dot ( aB , g ) ; } vec2 GX ( vec2 fv ) { float GM = dot ( fv , vec2 ( 12.9898 , 78.233 ) ) ; float GN = dot ( fv , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float GV = fract ( sin ( GM ) * 43758.5453 ) * 2.0 - _1_0 ; float GW = fract ( sin ( GN ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( GV , GW ) ; } float kv ( vec2 GY ) { return fract ( sin ( dot ( GY , vec2 ( 12.9898 , 78.233 ) ) ) * 43758.5453 ) ; }".split(" ")}]}}]}]},e["include/refraction.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"REFRACTION_GLSLF",j:{a:"grp",f:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"float ep ( in float cH , inout vec2 eo , in vec2 ef ) { vec4 GZ = GLSL_TEXTURE ( u_scene_depth , eo ) ; float eq = cG ( GZ ) ; if ( eq < m ) { eo = ef ; return cH ; } else { return eq ; } return cH ; }".split(" ")}]}}]},{a:"txt",b:"vec3 cC ( in vec3 qD , in vec2 G_ ) { vec2 ef = qD . xy / qD . z ; vec2 eo = ef + G_ ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 cF = GLSL_TEXTURE_PROJ ( u_scene_depth , qD ) ; float cH = cG ( cF ) ; ep ( cH , eo , ef ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eu = GLSL_TEXTURE ( u_refractmap , eo ) . rgb ; ch ( eu ) ; return eu ; }".split(" ")}]}}]}]}}]}]},e["include/scale_texcoord.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",j:{a:"grp",f:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 aA ( vec2 bO , vec3 Ha ) { return ( bO + 0.5 ) * Ha . xy - 0.5 ; }".split(" ")}]}}]}]},e["include/shadow.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLF",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"procedural.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float Hb = 0.1 ; const float Hc = 0.1 ; const float Hd = - 0.01 ; const float He = 0.05 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 Hf = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Hg = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Hh = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Hi = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Hj = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Hk = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Hl = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Hm = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},{a:"elif",i:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Hf = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Hg = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Hh = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Hi = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Hj = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Hk = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Hl = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Hm = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",i:["POISSON_DISK_NUM","POISSON_X_4",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Hf = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Hg = vec2 ( 0.5741194 , 0.0 ) ; vec2 Hh = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Hi = vec2 ( 0.82934988 , 0.0 ) ; vec2 Hj = vec2 ( 0.70009436 , 0.0 ) ; vec2 Hk = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Hl = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Hm = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Ho ( vec2 hU , float Hn ) { return all ( lessThanEqual ( hU , vec2 ( 1.0 + Hn ) ) ) && all ( greaterThanEqual ( hU , vec2 ( 0.0 - Hn ) ) ) ; } float Hv ( float Hp , float Hq , mat2 Hr , vec3 Hs , float Ht , PRECISION GLSL_SMPLR2D_SHDW Hu ) {".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hU , fg ; fg . x = Hp ; fg . y = Hq ; fg = Hr * fg ; hU = Hs . xy + fg * Ht / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hU = Hs . xy ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"if ( ! Ho ( hU , Hd ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["RGBA_SHADOWS"],j:{a:"grp",f:[{a:"txt",b:"float dN = cG ( GLSL_TEXTURE ( Hu , hU ) ) ; return step ( Hs . z , dN ) ;".split(" ")}]}},{a:"elif",i:["COMPARED_MODE"],j:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE ( Hu , vec3 ( hU , Hs . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return step ( Hs . z , GLSL_TEXTURE ( Hu , hU ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float HA ( vec3 Hs , PRECISION GLSL_SMPLR2D_SHDW Hu , float Ht ) { float Hw = 0.0 ; Hs . z = clamp ( Hs . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hx = GX ( Hs . xy ) . x * M_PI ; float Hy = cos ( Hx ) ; float Hz = sin ( Hx ) ; mat2 Hr = mat2 ( Hy , Hz , - Hz , Hy ) ; for ( int b_ = 0 ; b_ < POISSON_DISK_NUM ; b_ ++ ) { Hw += Hv ( Hf [ b_ ] , Hj [ b_ ] , Hr , Hs , Ht , Hu ) ; Hw += Hv ( Hg [ b_ ] , Hk [ b_ ] , Hr , Hs , Ht , Hu ) ; Hw += Hv ( Hh [ b_ ] , Hl [ b_ ] , Hr , Hs , Ht , Hu ) ; Hw += Hv ( Hi [ b_ ] , Hm [ b_ ] , Hr , Hs , Ht , Hu ) ; } return clamp ( Hw / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return Hv ( 0.0 , 0.0 , mat2 ( 0.0 ) , Hs , Ht , Hu ) ;".split(" ")}]}}]},{a:"txt",b:"} float HJ ( vec3 HB , PRECISION GLSL_SMPLR2D_SHDW HC , vec3 HD , PRECISION GLSL_SMPLR2D_SHDW HE , float HF , float HG , float aM ) { float HH , HI ; HB . z = clamp ( HB . z , 0.0 , 1.0 ) ; HD . z = clamp ( HD . z , 0.0 , 1.0 ) ; HH = 0.0 ; HI = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hx = GX ( HB . xy ) . x * M_PI ; float Hy = cos ( Hx ) ; float Hz = sin ( Hx ) ; mat2 Hr = mat2 ( Hy , Hz , - Hz , Hy ) ; for ( int b_ = 0 ; b_ < POISSON_DISK_NUM ; b_ ++ ) { HH += Hv ( Hf [ b_ ] , Hj [ b_ ] , Hr , HB , HF , HC ) ; HH += Hv ( Hg [ b_ ] , Hk [ b_ ] , Hr , HB , HF , HC ) ; HH += Hv ( Hh [ b_ ] , Hl [ b_ ] , Hr , HB , HF , HC ) ; HH += Hv ( Hi [ b_ ] , Hm [ b_ ] , Hr , HB , HF , HC ) ; } for ( int b_ = 0 ; b_ < POISSON_DISK_NUM ; b_ ++ ) { HI += Hv ( Hf [ b_ ] , Hj [ b_ ] , Hr , HD , HG , HE ) ; HI += Hv ( Hg [ b_ ] , Hk [ b_ ] , Hr , HD , HG , HE ) ; HI += Hv ( Hh [ b_ ] , Hl [ b_ ] , Hr , HD , HG , HE ) ; HI += Hv ( Hi [ b_ ] , Hm [ b_ ] , Hr , HD , HG , HE ) ; } HH = mix ( HH , HI , aM ) ; HH /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"HH += Hv ( 0.0 , 0.0 , mat2 ( 0.0 ) , HB , HF , HC ) ; HI += Hv ( 0.0 , 0.0 , mat2 ( 0.0 ) , HD , HG , HE ) ; HH = mix ( HH , HI , aM ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( HH , 0.0 , 1.0 ) ; } float HK ( vec2 hU ) { float a = min ( hU . x , hU . y ) ; float b = min ( 1.0 - hU . x , 1.0 - hU . y ) ; return min ( a , b ) ; } float HM ( float tY , float HL ) { if ( HL >= 0.0 && HL <= Hc ) tY = ( tY - 1.0 ) / Hc * HL + 1.0 ; return tY ; } float HR ( vec3 HN , vec3 HO , PRECISION GLSL_SMPLR2D_SHDW HC , PRECISION GLSL_SMPLR2D_SHDW HE , float HF , float HG , float HP , float dN ) { float tY ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_BLEND_BETWEEN_CASCADES"],j:{a:"grp",f:[{a:"txt",b:"float HL = HK ( HN . xy ) ; if ( - dN > HP && HL >= 0.0 && HL <= Hb && Ho ( HO . xy , 0.0 ) ) { float HQ = 1.0 - HL / Hb ; tY = HJ ( HN , HC , HO , HE , HF , HG , HQ ) ; } else".split(" ")}]}}]},{a:"txt",b:"tY = HA ( HN , HC , HF ) ; return tY ; } float HT ( vec3 HS , PRECISION GLSL_SMPLR2D_SHDW Hu , float Ht , float HP , float dN ) { float tY = HA ( HS , Hu , Ht ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_FADE_LAST_CASCADE"],j:{a:"grp",f:[{a:"txt",b:"if ( - dN > HP ) { float HL = HK ( HS . xy ) ; tY = HM ( tY , HL ) ; }".split(" ")}]}}]},{a:"txt",b:"return tY ; } vec4 dP ( float dN ) { float tY = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","HU","=","u_pcf_blur_radii",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 HU = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 HB = n . xyz / n . w ; if ( n . w < 0.0 ) HB . z = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 HD = o . xyz / o . w ; if ( o . w < 0.0 ) HD . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 HV = u . xyz / u . w ; if ( u . w < 0.0 ) HV . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 HW = v . xyz / v . w ; if ( v . w < 0.0 ) HW . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"if ( Ho ( HB . xy , 0.0 ) ) { tY = HR ( HB , HD , u_shadow_map0 , u_shadow_map1 , HU [ 0 ] , HU [ 1 ] , u_csm_center_dists [ 0 ] , dN ) ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( Ho ( HB . xy , He ) ) { tY = HT ( HB , u_shadow_map0 , HU [ 0 ] , u_csm_center_dists [ 0 ] , dN ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Ho ( HD . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"tY = HR ( HD , HV , u_shadow_map1 , u_shadow_map2 , HU [ 1 ] , HU [ 2 ] , u_csm_center_dists [ 1 ] , dN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tY = HT ( HD , u_shadow_map1 , HU [ 1 ] , u_csm_center_dists [ 1 ] , dN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Ho ( HV . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"tY = HR ( HV , HW , u_shadow_map2 , u_shadow_map3 , HU [ 2 ] , HU [ 3 ] , u_csm_center_dists [ 2 ] , dN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tY = HT ( HV , u_shadow_map2 , HU [ 2 ] , u_csm_center_dists [ 2 ] , dN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Ho ( HW . xy , 0.0 ) ) tY = HT ( HW , u_shadow_map3 , HU [ 3 ] , u_csm_center_dists [ 3 ] , dN ) ; }".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float HX = HA ( HD , u_shadow_map1 , HU [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","HX","=","0.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float HY = HA ( HV , u_shadow_map2 , HU [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","HY","=","0.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float HZ = HA ( HW , u_shadow_map3 , HU [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","HZ","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tY , HX , HY , HZ ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 cr ( inout vec3 cn ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 Hw = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"l_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cn *= Hw . a ;".split(" ")}]}}]},{a:"txt",b:["return","Hw",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 Hw = dP ( i . z ) ; return Hw ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]},e["include/shadow.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLV",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"txt",b:"vec4 Ic ( mat4 H_ , vec4 Ia , mat4 Ib ) { vec2 dR = ( H_ * Ib [ 3 ] ) . xy ; float dS = SHADOW_TEX_RES / 2.0 ; dR = floor ( dR * dS + 0.5 ) / dS - dR ; vec4 Hs = H_ * Ia ; Hs . xy += dR ; Hs . xyz = 0.5 * ( Hs . xyz + Hs . w ) ; return Hs ; } void bN ( vec3 eM , vec3 Id ) {".split(" ")},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"mat4 Ib = bd ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 Ib = bd ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 Ie = Ib * vec4 ( eM + u_normal_offset * Id , 1.0 ) ; n = Ic ( u_p_light_matrix0 , Ie , Ib ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Ie = Ib * vec4 ( eM + u_normal_offset * Id , 1.0 ) ; o = Ic ( u_p_light_matrix1 , Ie , Ib ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Ie = Ib * vec4 ( eM + u_normal_offset * Id , 1.0 ) ; u = Ic ( u_p_light_matrix2 , Ie , Ib ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = bd ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Ie = Ib * vec4 ( eM + u_normal_offset * Id , 1.0 ) ; v = Ic ( u_p_light_matrix3 , Ie , Ib ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"o = Ic ( u_p_light_matrix1 , Ie , Ib ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"u = Ic ( u_p_light_matrix2 , Ie , Ib ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"v = Ic ( u_p_light_matrix3 , Ie , Ib ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]},e["include/skin.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKIN_GLSLV",j:{a:"grp",f:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 Im ( in vec4 qg , in vec4 If , in float Ig ) { float Ih = qg [ 0 ] * If [ 0 ] + qg [ 1 ] * If [ 1 ] + qg [ 2 ] * If [ 2 ] + qg [ 3 ] * If [ 3 ] ; if ( Ih < 0.0 ) { If *= - 1.0 ; Ih = - Ih ; } if ( abs ( Ih ) >= 1.0 ) return qg ; float Ii = acos ( Ih ) ; float Ij = sqrt ( 1.0 - Ih * Ih ) ; if ( abs ( Ij ) < 0.001 ) return vec4 ( qg * 0.5 + If * 0.5 ) ; float Ik = sin ( ( 1.0 - Ig ) * Ii ) / Ij ; float Il = sin ( Ig * Ii ) / Ij ; return qg * Ik + If * Il ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"vec3 IA ( in vec3 O , in vec4 In , in vec4 Io , in vec4 Ip , in vec4 Iq , in float Ir ) { vec3 Is = qu ( u_arm_rel_trans , u_arm_rel_quat , O ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 qg = Im ( In , Io , Ir ) ; vec4 It = mix ( Ip , Iq , Ir ) ; vec3 Iu = T ( qg , Is ) ; vec3 Iv = Iu * It . w + It . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Iw = T ( In , Is ) ; vec3 Ix = T ( Io , Is ) ; vec3 Iy = Iw * Ip . w + Ip . xyz ; vec3 Iz = Ix * Iq . w + Iq . xyz ; vec3 Iv = mix ( Iy , Iz , Ir ) ;".split(" ")}]}}]},{a:"txt",b:"return qx ( u_arm_rel_trans , u_arm_rel_quat , Iv ) ; } vec3 IG ( in vec3 IB , in vec4 In , in vec4 Io , in float Ir ) { vec3 IC = qw ( u_arm_rel_trans , u_arm_rel_quat , IB ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 qg = Im ( In , Io , Ir ) ; vec3 ID = T ( qg , IC ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IE = T ( In , IC ) ; vec3 IF = T ( Io , IC ) ; vec3 ID = mix ( IE , IF , Ir ) ;".split(" ")}]}}]},{a:"txt",b:"return qy ( u_arm_rel_trans , u_arm_rel_quat , ID ) ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IA ( in vec3 O , in vec4 In , in vec4 Ip ) { vec3 Is = qu ( u_arm_rel_trans , u_arm_rel_quat , O ) ; vec3 Iu = T ( In , Is ) ; vec3 Iv = Iu * Ip . w + Ip . xyz ; return qx ( u_arm_rel_trans , u_arm_rel_quat , Iv ) ; } vec3 IG ( in vec3 IB , in vec4 In ) { vec3 IC = qw ( u_arm_rel_trans , u_arm_rel_quat , IB ) ; vec3 ID = T ( In , IC ) ; return qy ( u_arm_rel_trans , u_arm_rel_quat , ID ) ; }".split(" ")}]}}]},{a:"txt",b:"void an ( inout vec3 O , inout vec3 V , inout vec3 W , inout vec3 U ) {".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:["float","IH","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iP = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 II = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 IJ = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 IK = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 IL = a_influence ; for ( int b_ = 0 ; b_ < 4 ; b_ ++ ) { int IM = int ( IL [ b_ ] ) ; float IN = fract ( IL [ b_ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"II += IN * IG ( V , u_quatsb [ IM ] , u_quatsa [ IM ] , IH ) ; IJ += IN * IG ( W , u_quatsb [ IM ] , u_quatsa [ IM ] , IH ) ; IK += IN * IG ( U , u_quatsb [ IM ] , u_quatsa [ IM ] , IH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iP += IN * IA ( O , u_quatsb [ IM ] , u_transb [ IM ] ) ; IK += IN * IG ( U , u_quatsb [ IM ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"II += IN * IG ( V , u_quatsb [ IM ] ) ; IJ += IN * IG ( W , u_quatsb [ IM ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"int IM = int ( IL [ 0 ] ) ; float IN = fract ( IL [ 0 ] ) ; iP += IN * IA ( O , u_quatsb [ IM ] , u_quatsa [ IM ] , u_transb [ IM ] , u_transa [ IM ] , IH ) ; IM = int ( IL [ 1 ] ) ; IN = fract ( IL [ 1 ] ) ; iP += IN * IA ( O , u_quatsb [ IM ] , u_quatsa [ IM ] , u_transb [ IM ] , u_transa [ IM ] , IH ) ; IM = int ( IL [ 2 ] ) ; IN = fract ( IL [ 2 ] ) ; iP += IN * IA ( O , u_quatsb [ IM ] , u_quatsa [ IM ] , u_transb [ IM ] , u_transa [ IM ] , IH ) ; IM = int ( IL [ 3 ] ) ; IN = fract ( IL [ 3 ] ) ; iP += IN * IA ( O , u_quatsb [ IM ] , u_quatsa [ IM ] , u_transb [ IM ] , u_transa [ IM ] , IH ) ;".split(" ")}]}}]},{a:"txt",b:"O = iP ; U = IK ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"V = II ; W = IJ ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int IO = int ( a_influence [ 0 ] - 1.0 ) ; if ( IO > - 1 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"O = IA ( O , u_quatsb [ IO ] , u_quatsa [ IO ] , u_transb [ IO ] , u_transa [ IO ] , IH ) ; V = IG ( V , u_quatsb [ IO ] , u_quatsa [ IO ] , IH ) ; W = IG ( W , u_quatsb [ IO ] , u_quatsa [ IO ] , IH ) ; U = IG ( U , u_quatsb [ IO ] , u_quatsa [ IO ] , IH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"O = IA ( O , u_quatsb [ IO ] , u_transb [ IO ] ) ; U = IG ( U , u_quatsb [ IO ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"V = IG ( V , u_quatsb [ IO ] ) ; W = IG ( W , u_quatsb [ IO ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]},e["include/sky_blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"SKY_BLENDING_GLSLF",b:[""]},{a:"include",A:"std.glsl"},{a:"include",A:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 IP ( vec3 jx , vec3 jy , float aM , float jX ) { float jz = aM * jX ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE","MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jA ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jB ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jC ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jE ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jF ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jG ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jH ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jI ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jJ ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jK ( jx , jy , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","HUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jO ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SATURATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jP ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","VALUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jQ ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","COLOR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jR ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jT ( jy , jx , jz ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jU ( jy , jx , jz ) ;".split(" ")}]}}]},{a:"txt",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float IQ ( float jV , float jW , float aM , float jX ) { vec3 jx = vec3 ( jV ) , jy = vec3 ( jW ) ; float jz = aM * jX ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE","MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jA ( jy , jx , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jB ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jC ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jY ( jV , jW , jz , jX ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jZ ( jV , jW , jz , jX ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return j_ ( jV , jW , jz , jX ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jH ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jI ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jJ ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jK ( jx , jy , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jT ( jy , jx , jz ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jU ( jy , jx , jz ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dZ ( vec3 dV , vec3 dW , vec4 dY , float dU , vec3 dX ) { float IR = 1.0 ; IR = dY . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"IR = fC ( dY ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["MTEX_NEGATIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"dY = vec4 ( vec3 ( 1.0 ) - dY . rgb , dY . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"IR = 1.0 - IR ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"dY = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"IR = dY . a ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ"],j:{a:"grp",f:[{a:"txt",b:"dV = IP ( dY . rgb , dV , IR , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","IS","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"if ( dot ( dX , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],j:{a:"grp",f:[{a:"txt",b:"IS = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"else IS = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],j:{a:"grp",f:[{a:"txt",b:"IS = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"IS = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( IS != 0.0 ) dW = IP ( dY . rgb , dW , IR , IS ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_BLEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"IR = dot ( dY . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dU = IQ ( u_sky_tex_dvar , dU , IR , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"vec3 dT = mix ( dV , dW , dU ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","dT","=","dV",";"]}]}}]},{a:"txt",b:["return","dT",";","}"]}]}}]}]},e["include/std.glsl"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"STD_ENUMS_GLSL",j:{a:"grp",f:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"BLUR_PASS_1",b:["1"]},{a:"define",c:"BLUR_PASS_2",b:["2"]},{a:"define",c:"BLUR_PASS_3",b:["3"]},{a:"define",c:"BLUR_PASS_4",b:["4"]},{a:"define",c:"BLUR_PASS_5",b:["5"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["25"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["24"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["23"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["26"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},{a:"cond",f:[{a:"if",i:["CONSTANTS_HACK"],j:{a:"grp",f:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]},e["include/to_world.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"TO_WORLD_GLSLV",j:{a:"grp",f:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",A:"math.glslv"},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 bk ( vec3 IT , mat3 N ) { vec4 IU = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 IV = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 IV = X ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},{a:"txt",b:"IU = qi ( IV , IU ) ; IU = kf ( IU ) ; mat3 bl = cR ( ) ; bl [ 0 ] = IT ; bl = cU ( IU , bl ) ; return bl ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 IX ( vec3 kW , vec3 IT ) { vec3 IW = kW - IT ; IW . z = 0.0 ; IW = normalize ( IW ) ; vec4 IU = qn ( IW , TOWARD_VECTOR ) ; mat3 bl = cR ( ) ; bl [ 0 ] = IT ; bl = cU ( IU , bl ) ; return bl ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"mat3 au ( in vec3 IY , float IZ , float I_ , float Ja , vec3 bc , mat3 Z ) { float GY = fract ( length ( bc ) / 0.17 ) ; float Jb = Ja + GY / 10.0 ; float Jc = GY ; if ( Ja != 0.0 ) Jc /= Ja ; IY *= 1.0 + 0.5 * sin ( IZ ) ; float Jd = length ( IY ) * I_ * sin ( 2.0 * 3.14 * IZ * Jb + Jc ) ; vec4 Je = X ( TOWARD_VECTOR , Jd ) ; vec4 Jf = vec4 ( Z [ 1 ] [ 1 ] , Z [ 1 ] [ 2 ] , Z [ 2 ] [ 0 ] , Z [ 2 ] [ 1 ] ) ; Jf = qi ( Jf , Je ) ; Z = cU ( Jf , Z ) ; return Z ; }".split(" ")}]}}]},{a:"txt",b:"mat3 at ( in vec3 kW , in vec3 aq , in mat3 N ) {".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 lk = bk ( aq , N ) ;".split(" ")}]}},{a:"elif",i:["BILLBOARD_RANDOM"],j:{a:"grp",f:[{a:"txt",b:"float GY = fract ( ( aq . x * 1.43 - aq . z * 0.123 + aq . y * 6.1 ) ) ; float Jg = 2.0 * M_PI * GY ; vec4 Jh = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ; float Ji = asin ( 2.0 * ( Jh . x * Jh . y - Jh . z * Jh . w ) ) ; float gU = Ji - Jg ; if ( gU < 0.0 ) gU = 2.0 * M_PI + gU ; float Jj = Jg ; if ( gU <= MAX_BILLBOARD_ANGLE ) Jj += gU ; else if ( gU <= M_PI - MAX_BILLBOARD_ANGLE ) Jj += MAX_BILLBOARD_ANGLE * ( 2.0 * gU - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gU <= M_PI + MAX_BILLBOARD_ANGLE ) Jj += gU - M_PI ; else if ( gU <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Jj += MAX_BILLBOARD_ANGLE * ( 2.0 * gU - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Jj += gU - 2.0 * M_PI ; vec4 Jk = X ( UP_VECTOR , Jj ) ; mat3 lk ; lk [ 0 ] = aq ; lk [ 1 ] [ 0 ] = 1.0 ; lk = cU ( Jk , lk ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 lk = IX ( kW , aq ) ;".split(" ")}]}}]},{a:"txt",b:["return","lk",";","}"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 as ( in vec3 kW , in vec3 aq , in mat3 N , in mat3 Z ) { mat3 lk = at ( kW , aq , N ) ; Z [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"lk [ 1 ] [ 0 ] *= Z [ 1 ] [ 0 ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"lk = aZ ( lk , Z ) ;".split(" ")}]}}]},{a:"txt",b:["return","lk",";","}"]}]}}]},{a:"txt",b:"av aw ( in vec3 eM , in vec3 Jl , in vec3 Jm , in vec3 Jn , in vec3 Jo , in vec3 Jp , in mat3 Z ) { eM = ap ( Z , eM ) ; Jl = ap ( Z , Jl ) ; Jm = _ ( Z , Jm ) ; Jn = _ ( Z , Jn ) ; Jo = _ ( Z , Jo ) ; Jp = _ ( Z , Jp ) ; return ll ( av ( eM , Jl , Jm , Jn , Jo , Jp , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]},e["include/wind_bending.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"WIND_BENDING_GLSLV",j:{a:"grp",f:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"void JC ( inout vec3 bp , in vec3 Jq , in float Jr , in float Js , in float eT , in vec3 IY , in float Jt , in mat4 bJ ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Ju = ( bJ * vec4 ( bp , 1.0 ) ) . xyz ; vec3 Jv = ( bJ * vec4 ( Jq , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Ju = bp ; vec3 Jv = Jq ;".split(" ")}]}}]},{a:"txt",b:"float dq = length ( Jv ) ; float Jw = Js * ( 1.0 + 0.1 * fract ( dq ) ) ; float Jx = Jr * Jt * ( 1.0 + sin ( 2.0 * 3.14 * eT * Jw + dq ) ) ; float Jy = ( Ju . z - Jv . z ) * abs ( Jx ) ; Jy += 1.0 ; Jy *= Jy ; Jy = Jy * Jy - Jy ; vec3 Jz = Ju ; Jz . xy += IY . xy * Jy * sign ( Jx ) ; vec3 JA = Jz - Jv ; if ( all ( equal ( JA , vec3 ( 0.0 ) ) ) ) bp = Jq ; else {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"JA = ( bJ * vec4 ( JA , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float JB = length ( Ju - Jv ) ; bp = Jq + normalize ( JA ) * JB ; } }".split(" ")},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"vec4 JD ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 JE ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 JF ( vec4 x ) { return JD ( JE ( x ) ) ; } void JR ( inout vec3 bp , in float eT , in vec3 U , in vec3 IY , in vec3 Jq , in float JG , in float JH , in float JI , in vec3 JJ , in mat4 bJ ) { float JK ; float JL ; float JM ; vec2 JN ; vec4 JO ; vec2 JP ; vec3 JQ ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Ju = ( bJ * vec4 ( bp , 1.0 ) ) . xyz ; vec3 Jv = ( bJ * vec4 ( Jq , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Ju = bp ; vec3 Jv = Jq ;".split(" ")}]}}]},{a:"txt",b:"JK = dot ( Jv , vec3 ( 1.0 ) ) ; JL = JK + JJ . g ; JM = dot ( Ju , vec3 ( JJ . g ) ) ; JN = ( eT + vec2 ( JM , JL ) ) ; JO = ( ( fract ( ( JN . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( IY ) * JG ; JO = JF ( JO ) ; JP = JO . xz + JO . yw ; JP . y = 0.5 - JP . y ; JQ = JP . xxy * JJ . rrb * vec3 ( JH * U . x , JH * U . y , JI ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"JQ = ( bJ * vec4 ( JQ , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bp","+=","JQ",";","}"]}]}}]},{a:"txt",b:"void ay ( inout vec3 O , inout vec3 ao , in vec3 U , in mat4 bJ ) { vec3 JS = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"vec3 JT = ao ; vec3 JU = a_emitter_center ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"JU = ( bJ * vec4 ( JU , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 JT = O ; vec3 JU = ao ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"JR ( JT , u_time , U , JS , JU , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , bJ ) ;".split(" ")}]}}]},{a:"txt",b:"JC ( JT , JU , au_wind_bending_amp , au_wind_bending_freq , u_time , JS , a_bending_col_main , bJ ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"JC ( JT , JU , au_wind_bending_amp , au_wind_bending_freq , u_time , JS , 1.0 , bJ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"O += JT - ao ; ao = JT ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"O = JT ; ao = JU ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}},a.module.animation=function(e,t){var a=t("__animation"),r=t("__obj_util"),n=t("__print");e.SLOT_0=a.SLOT_0,e.SLOT_1=a.SLOT_1,e.SLOT_2=a.SLOT_2,e.SLOT_3=a.SLOT_3,e.SLOT_4=a.SLOT_4,e.SLOT_5=a.SLOT_5,e.SLOT_6=a.SLOT_6,e.SLOT_7=a.SLOT_7,e.SLOT_ALL=a.SLOT_ALL,e.OBJ_ANIM_TYPE_NONE=a.OBJ_ANIM_TYPE_NONE,e.OBJ_ANIM_TYPE_ARMATURE=a.OBJ_ANIM_TYPE_ARMATURE,e.OBJ_ANIM_TYPE_OBJECT=a.OBJ_ANIM_TYPE_OBJECT,e.OBJ_ANIM_TYPE_VERTEX=a.OBJ_ANIM_TYPE_VERTEX,e.OBJ_ANIM_TYPE_SOUND=a.OBJ_ANIM_TYPE_SOUND,e.OBJ_ANIM_TYPE_PARTICLES=a.OBJ_ANIM_TYPE_PARTICLES,e.OBJ_ANIM_TYPE_MATERIAL=a.OBJ_ANIM_TYPE_MATERIAL,e.OBJ_ANIM_TYPE_STATIC=a.OBJ_ANIM_TYPE_STATIC,e.AB_CYCLIC=a.AB_CYCLIC,e.AB_FINISH_RESET=a.AB_FINISH_RESET,e.AB_FINISH_STOP=a.AB_FINISH_STOP,e.is_animated=function(e){return a.is_animated(e)},e.get_anim_names=function(e){return a.iG(e)?a.get_anim_names(e):[]},e.get_current_anim_name=function(e,t){return a.is_animated(e)?(t=t||a.SLOT_0,a.rP(e,t)):null},e.apply=function(e,t,r){if(r>a.SLOT_7)n.error("Can't apply animation to slot "+r+' for object "'+e.name+'". Object can have maximum of 8 animation slots');else{if(r=r||a.SLOT_0,a.is_animated(e)){var o=a.get_slot_num_by_anim(e,t);if(-1!=o&&o!=r)return void n.error('Animation "'+t+'" is already applied to object "'+e.name+'" (slot "'+o+'").')}a.yI(e,t)?a.apply(e,null,t,r):n.error('No fcurves in action "'+t+'"')}},e.apply_ext=function(e,t,r){if(r>a.SLOT_7)n.error("Can't apply animation to slot "+r+' for object "'+e.name+'". Object can have maximum of 8 animation slots');else{r=r||a.SLOT_0;var o=t[0];if(a.is_animated(e)){var i=a.get_slot_num_by_anim(e,o);if(-1!=i&&i!=r)return void n.error('Animation "'+o+'" is already applied to object "'+e.name+'" (slot "'+i+'").')}a.yI(e,o)?a.apply(e,t.slice(1),o,r):n.error('No fcurves in action "'+o+'"')}},e.remove=function(e){a.remove(e)},e.remove_slot_animation=function(e,t){a.is_animated(e)&&(t=t||a.SLOT_0,a.remove_slot_animation(e,t))},e.apply_def=function(e){a.apply_def(e)},e.play=function(e,t,r){a.is_animated(e)?(r=r||a.SLOT_0,a.play(e,t,r),a.NU(e,0,r,!0)):n.error('Object "'+e.name+'" has no applied animation')},e.stop=function(e,t){a.is_animated(e)&&(t=t||a.SLOT_0,a.stop(e,t))},e.is_play=function(e,t){return!!a.is_animated(e)&&(t=t||a.SLOT_0,a.is_play(e,t))},e.set_frame=function(e,t,r){a.is_animated(e)&&(r=r||a.SLOT_0,a.set_frame(e,t,r))},e.set_first_frame=function(e,t){a.is_animated(e)&&a.set_first_frame(e,t)},e.set_last_frame=function(e,t){if(a.is_animated(e)){t=t||a.SLOT_0;var r=a.get_anim_start_frame(e,t),n=a.get_anim_length(e,t);a.set_frame(e,r+n-a.mJ,t)}},e.get_frame=function(e,t){return a.is_animated(e)?(t=t||a.SLOT_0,a.Py(e,t)):0},e.set_speed=function(e,t,r){a.is_animated(e)&&(r=r||a.SLOT_0,a.set_speed(e,t||1,r))},e.get_speed=function(e,t){return a.is_animated(e)?(t=t||a.SLOT_0,e.ia[t]?a.get_speed(e,t):0):0},e.get_anim_start_frame=function(e,t){return a.is_animated(e)&&(t=t||a.SLOT_0,e.ia[t])?a.get_anim_start_frame(e,t):-1},e.get_anim_length=function(e,t){return a.is_animated(e)&&(t=t||a.SLOT_0,e.ia[t])?a.get_anim_length(e,t):-1},e.set_behavior=function(e,t,r){a.is_animated(e)&&(r=r||a.SLOT_0,a.set_behavior(e,t,r))},e.get_behavior=function(e,t){return a.is_animated(e)?(t=t||a.SLOT_0,a.get_behavior(e,t)):null},e.apply_smoothing=function(e,t,r,n){n=n||a.SLOT_0,a.is_animated(e)&&a.apply_smoothing(e,t,r,n)},e.frame_to_sec=function(e){return a.frame_to_sec(e)},e.get_slot_num_by_anim=function(e,t){return a.is_animated(e)&&t?a.get_slot_num_by_anim(e,t):-1},e.get_anim_type=function(e,t){return a.is_animated(e)?a.get_anim_type(e,t):null},e.apply_to_first_empty_slot=function(e,t){return a.apply_to_first_empty_slot(e,t)},e.get_skel_mix_factor=function(e){return e.o.Ue},e.set_skel_mix_factor=function(e,t,o,i){r.is_armature(e)?(t=Math.min(Math.max(t,0),1),e.o.Ue!=t&&a.set_skel_mix_factor(e,t,o||0,i||null)):n.error("Can't blend animation. Object \""+e.name+'" is not armature')},e.set_skeletal_slots=function(e,t,a,r){t=void 0==t?-1:t,a=void 0==t?-1:a;var n=e.o.Mh;0<=t&&(n[0]=t),0<=a&&(n[1]=a),e.o.Ue=r||0},e.get_first_skeletal_slot=function(e){return e.o.Mh[0]},e.get_second_skeletal_slot=function(e){return e.o.Mh[1]},e.mix_from_cur_pos=function(e,t,r,n){a.mix_from_cur_pos(e,t,r||0,n||null)}},a.module.anchors=function(e,t){var a=t("__anchors");e.attach_move_cb=a.attach_move_cb,e.detach_move_cb=a.detach_move_cb,e.is_anchor=a.is_anchor,e.get_element_id=a.get_element_id,e.update=function(){a.update(!0)}},a.module.armature=function(e,t){var a=t("__armature"),r=t("__obj_util"),n=t("__transform"),o=t("__print");e.get_bone_tsr=function(e,t,n){return r.is_armature(e)?a.pt(e,t)?(n||(n=new Float32Array(8)),a.get_bone_tsr(e,t,!1,!1,n),n):(o.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},e.get_bone_tsr_rel=function(e,t,n){return r.is_armature(e)?a.pt(e,t)?(n||(n=new Float32Array(8)),a.get_bone_tsr(e,t,!1,!0,n),n):(o.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},e.set_bone_tsr=function(e,t,i){r.is_armature(e)&&(a.pt(e,t)?(a.set_bone_tsr(e,t,i,!1),n.O(e)):o.error('There is no bone: "',t,'" in "',e.name,'".'))},e.set_bone_tsr_rel=function(e,t,i){r.is_armature(e)&&(a.pt(e,t)?(a.set_bone_tsr(e,t,i,!0),n.O(e)):o.error('There is no bone: "',t,'" in "',e.name,'".'))}},a.module.assets=function(e,t){var a=t("__assets");e.AT_ARRAYBUFFER=a.AT_ARRAYBUFFER,e.AT_ARRAYBUFFER_ZIP=a.AT_ARRAYBUFFER_ZIP,e.AT_JSON=a.AT_JSON,e.AT_JSON_ZIP=a.AT_JSON_ZIP,e.AT_TEXT=a.AT_TEXT,e.AT_AUDIOBUFFER=a.AT_AUDIOBUFFER,e.AT_IMAGE_ELEMENT=a.AT_IMAGE_ELEMENT,e.AT_AUDIO_ELEMENT=a.AT_AUDIO_ELEMENT,e.AT_VIDEO_ELEMENT=a.AT_VIDEO_ELEMENT,e.AT_SEQ_VIDEO_ELEMENT=a.AT_SEQ_VIDEO_ELEMENT,e.enqueue=function(e,t,r,n){e.length&&a.enqueue(e,t,r,n)}},a.module.camera=function(e,t){function a(e,t){if(!_.is_camera(e))return c.error("get_view_vector(): Wrong camera object"),null;t=t||new Float32Array(3);var a=u.get_quat_view(e.o.v);return d.quat_to_dir(a,d.AXIS_MZ,t),t}var r=t("__camera"),n=t("__container"),o=t("__mat4"),i=t("__math"),_=t("__obj_util"),s=t("__physics"),c=t("__print"),l=t("__scenes"),f=t("__transform"),u=t("__tsr"),d=t("__util"),p=t("__vec3"),m=t("__vec4"),g=t("__quat"),h=new Float32Array(2),v=new Float32Array(3),b=new Float32Array(3),E=new Float32Array(4),A=g.create(),x={},T={};e.MS_STATIC=r.MS_STATIC,e.MS_TARGET_CONTROLS=r.MS_TARGET_CONTROLS,e.MS_EYE_CONTROLS=r.MS_EYE_CONTROLS,e.MS_HOVER_CONTROLS=r.MS_HOVER_CONTROLS,e.static_setup=function(e,t){if(_.is_camera(e)){if(r.ts(e),e.o.hb=r.MS_STATIC,t){var a=t.pos||u.get_trans_view(e.o.v);t.look_at?r.dH(e,a,t.look_at):f.set_translation(e,a)}f.O(e),s.sync_transform(e),r.Wn(e)}else c.error("static_setup(): Wrong camera object")},e.static_set_look_at=function(e,t,a){r.is_static_camera(e)?(t=t||u.get_trans_view(e.o.v),a?r.dH(e,t,a):f.set_translation(e,t),f.O(e),s.sync_transform(e)):c.error("static_set_look_at(): Wrong camera object or camera move style")},e.static_set_rotation=function(e,t){r.is_static_camera(e)?(f.set_rotation(e,t),f.O(e),s.sync_transform(e)):c.error("static_set_rotation(): Wrong camera object or camera move style")},e.static_get_rotation=function(e,t){return r.is_static_camera(e)?(t=t||new Float32Array(4),f.get_rotation(e,t)):(c.error("static_get_rotation(): Wrong camera object or camera move style"),null)},e.eye_setup=function(e,t){if(_.is_camera(e))if(t&&t.horiz_rot_lim&&("number"!=typeof t.horiz_rot_lim.left||"number"!=typeof t.horiz_rot_lim.right))c.error("eye_setup(): Wrong horizontal limits object.");else if(t&&t.vert_rot_lim&&("number"!=typeof t.vert_rot_lim.down||"number"!=typeof t.vert_rot_lim.up))c.error("eye_setup(): Wrong vertical limits object.");else{if(r.ts(e),e.o.hb=r.MS_EYE_CONTROLS,t){var a=t.pos||u.get_trans_view(e.o.v);r.jH(e,a,t.look_at,t.horiz_rot_lim,t.vert_rot_lim)}f.O(e),s.sync_transform(e),r.Wn(e)}else c.error("eye_setup(): Wrong camera object")},e.eye_set_look_at=function(e,t,a){r.is_eye_camera(e)?(t=t||u.get_trans_view(e.o.v),a?r.pT(e,t,a):f.set_translation(e,t),r.correct_up(e,e.o.Zd,!0),f.O(e),s.sync_transform(e)):c.error("eye_set_look_at(): Wrong camera object or camera move style")},e.eye_rotate=function(t,a,n,o){c.xd("eye_rotate","rotate_camera"),r.is_eye_camera(t)?e.rotate_camera(t,a,n,o||!1):c.error("eye_rotate(): Wrong camera object or camera move style")},e.eye_set_vertical_limits=function(e,t){r.is_eye_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.cw(e,t),f.O(e),s.sync_transform(e)):c.error("eye_set_vertical_limits(): Incorrect limits object."):c.error("eye_set_vertical_limits(): Wrong camera object or camera move style")},e.eye_get_vertical_limits=function(e,t,a){return r.is_eye_camera(e)?(e=e.o,e.Ha?(t=t||{},a?(t.down=e.Ha.Bn,t.up=e.Ha.Zo):(t.down=e.Ha.down,t.up=e.Ha.up),t.camera_space=a||!1,t):null):(c.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null)},e.eye_set_horizontal_limits=function(e,t){r.is_eye_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.aw(e,t),f.O(e),s.sync_transform(e)):c.error("eye_set_horizontal_limits(): Incorrect limits object."):c.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")},e.eye_get_horizontal_limits=function(e,t,a){return r.is_eye_camera(e)?(e=e.o,e.Bb?(t=t||{},a?(t.left=e.Bb.ao,t.right=e.Bb.Bo):(t.left=e.Bb.left,t.right=e.Bb.right),t.camera_space=a||!1,t):null):(c.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null)},e.target_setup=function(e,t){if(_.is_camera(e))if(!t.horiz_rot_lim||"number"==typeof t.horiz_rot_lim.left&&"number"==typeof t.horiz_rot_lim.right)if(!t.vert_rot_lim||"number"==typeof t.vert_rot_lim.down&&"number"==typeof t.vert_rot_lim.up){if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void c.error("target_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.pr&&("number"!=typeof t.pr.min_y||"number"!=typeof t.pr.max_y||t.pr.min_y>t.pr.max_y))c.error("target_setup(): Wrong pivot limits object");else{r.ts(e),e.o.hb=r.MS_TARGET_CONTROLS;var n=t.pos||u.get_trans_view(e.o.v),o=t.pivot;o||(o=a(e,v),o=p.add(n,o,o)),r.lH(e,n,o,t.horiz_rot_lim,t.vert_rot_lim,t.dist_lim,t.pr,t.use_panning||!1),f.O(e),s.sync_transform(e),r.Wn(e)}}else c.error("target_setup(): Wrong vertical limits object");else c.error("target_setup(): Wrong horizontal limits object");else c.error("target_setup(): Wrong camera object")},e.target_rotate=function(t,a,n,o){c.xd("target_rotate","rotate_camera"),r.is_target_camera(t)?e.rotate_camera(t,a,n,o||!1):c.error("target_rotate(): Wrong camera object or camera move style")},e.target_set_trans_pivot=function(e,t,a){r.is_target_camera(e)?(t=t||u.get_trans_view(e.o.v),a=a||e.o.pivot,r.HA(e,t,a),f.O(e),s.sync_transform(e)):c.error("target_set_trans_pivot(): Wrong camera object or camera move style")},e.target_set_pivot_translation=function(e,t){r.is_target_camera(e)?(r.yT(e,t),f.O(e),s.sync_transform(e)):c.error("target_set_pivot_translation(): Wrong camera object or camera move style")},e.target_set_distance=function(e,t){if(r.is_target_camera(e)){var a=f.ir(e,e.o.pivot);f.move_local(e,0,0,Math.max(0,t)-a),f.O(e),s.sync_transform(e)}else c.error("target_set_distance(): Wrong camera object or camera move style")},e.target_get_distance=function(e){return r.is_target_camera(e)?f.ir(e,e.o.pivot):(c.error("target_get_distance(): Wrong camera object or camera move style"),0)},e.target_zoom_object=function(e,t){if(r.is_target_camera(e)){var a=f.get_object_center(t,!1,v),n=f.get_object_size(t),o=l.get_active(),o=_.ya(e,o).ba[0],o=r.qP(o)/2,n=n/Math.sin(o),o=f.ir(e,a);r.HA(e,u.get_trans_view(e.o.v),a),f.O(e),f.move_local(e,0,0,n-o),f.O(e),s.sync_transform(e)}else c.error("target_zoom_object(): Wrong camera object or camera move style")},e.target_get_pivot=function(e,t){return r.is_target_camera(e)?(t=t||new Float32Array(3),p.copy(e.o.pivot,t),t):(c.error("target_get_pivot(): Wrong camera object or camera move style"),null)},e.target_set_distance_limits=function(e,t){if(r.is_target_camera(e)){if(t){if("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)return void c.error("target_set_distance_limits(): Wrong limits object");t.min=Math.max(t.min,0),t.max=Math.max(t.max,0)}r.UG(e,t),f.O(e),s.sync_transform(e)}else c.error("target_set_distance_limits(): Wrong camera object or camera move style")},e.target_get_distance_limits=function(e,t){if(!r.is_target_camera(e))return c.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var a=e.o;return a.vb?(t=t||{},t.min=a.vb.min,t.max=a.vb.max,t):null},e.target_set_vertical_limits=function(e,t){r.is_target_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.cw(e,t),f.O(e),s.sync_transform(e)):c.error("target_set_vertical_limits(): Wrong limits object"):c.error("target_set_vertical_limits(): Wrong camera object or camera move style")},e.target_get_vertical_limits=function(e,t,a){return r.is_target_camera(e)?(e=e.o,e.Ha?(t=t||{},a?(t.down=e.Ha.Bn,t.up=e.Ha.Zo):(t.down=e.Ha.down,t.up=e.Ha.up),t.camera_space=a||!1,t):null):(c.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null)},e.target_set_horizontal_limits=function(e,t){r.is_target_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.aw(e,t),f.O(e),s.sync_transform(e)):c.error("target_set_horizontal_limits(): Wrong limits object"):c.error("target_set_horizontal_limits(): Wrong camera object or camera move style")},e.target_get_horizontal_limits=function(e,t,a){return r.is_target_camera(e)?(e=e.o,e.Bb?(t=t||{},a?(t.left=e.Bb.ao,t.right=e.Bb.Bo):(t.left=e.Bb.left,t.right=e.Bb.right),t.camera_space=a||!1,t):null):(c.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null)},e.target_set_pivot_limits=function(e,t){r.is_target_camera(e)?t&&("number"!=typeof t.min_z||"number"!=typeof t.max_z||t.min_z>t.max_z)?c.error("target_set_pivot_limits(): Wrong limits object"):(r.fH(e,t),f.O(e),s.sync_transform(e)):c.error("target_set_pivot_limits(): Wrong camera object or camera move style")},e.target_get_pivot_limits=function(e,t){if(!r.is_target_camera(e))return c.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var a=e.o;return a.rd?(t=t||{},t.min_z=a.rd.min_z,t.max_z=a.rd.max_z,t):null},e.target_pan_pivot=function(e,t,a){if(r.is_target_camera(e)){var n=e.o;n.use_panning&&(v[0]=t,v[1]=-a,v[2]=0,u.transform_dir_vec3(v,n.v,v),p.add(n.pivot,v,n.pivot),t=u.get_trans_view(n.v),p.add(t,v,t),f.O(e),s.sync_transform(e))}else c.error("target_pan_pivot(): wrong object")},e.target_switch_panning=function(e,t){if(!r.is_target_camera(e))return c.error("target_switch_panning(): Wrong camera object or camera move style"),null;e.o.use_panning=t},e.hover_setup_rel=function(t,a){e.hover_setup(t,{pos:a.pos,pivot:a.pivot});var n="undefined"==typeof a.dist_interval?0:Math.max(a.dist_interval,0),o="undefined"==typeof a.angle_interval?0:Math.max(a.angle_interval,0),i="undefined"==typeof a.t?.5:d.clamp(a.t,0,1),_=e.hover_get_distance_limits(t,x);_.min=Math.max(_.min-i*n,0),_.max+=(1-i)*n,n=e.hover_get_vertical_limits(t,T),n.down=d.clamp(n.down+i*o,-Math.PI/2,0),n.up=d.clamp(n.up-(1-i)*o,-Math.PI/2,0),r.hover_set_distance_limits(t,_),r.hover_set_vertical_limits(t,n),f.O(t),s.sync_transform(t),r.Wn(t)},e.hover_setup=function(e,t){if(_.is_camera(e)){if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void c.error("hover_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.hover_angle_lim&&("number"!=typeof t.hover_angle_lim.down||"number"!=typeof t.hover_angle_lim.up||t.hover_angle_lim.down<t.hover_angle_lim.up))c.error("hover_setup(): Wrong hover angle limits object");else if(t.horiz_trans_lim&&("number"!=typeof t.horiz_trans_lim.min||"number"!=typeof t.horiz_trans_lim.max||t.horiz_trans_lim.min>t.horiz_trans_lim.max))c.error("hover_setup(): Wrong horizontal translation limits object");else if(t.vert_trans_lim&&("number"!=typeof t.vert_trans_lim.min||"number"!=typeof t.vert_trans_lim.max||t.vert_trans_lim.min>t.vert_trans_lim.max))c.error("hover_setup(): Wrong vertical translation limits object");else{r.ts(e),e.o.hb=r.MS_HOVER_CONTROLS;var a=t.pos||u.get_trans_view(e.o.v);r.kH(e,a,t.pivot,t.dist_lim,t.hover_angle_lim,t.horiz_trans_lim,t.vert_trans_lim,t.enable_horiz_rot||!1),f.O(e),s.sync_transform(e),r.Wn(e)}}else c.error("hover_setup(): Wrong camera object")},e.hover_rotate=function(t,a,n,o){c.xd("hover_rotate","rotate_camera"),r.is_hover_camera(t)?e.rotate_camera(t,a,n,o||!1):c.error("hover_rotate(): Wrong camera object or camera move style")},e.hover_set_pivot_translation=function(e,t){r.is_hover_camera(e)?(r.cH(e,t),f.O(e),s.sync_transform(e)):c.error("hover_set_pivot_translation(): Wrong camera object or camera move style")},e.hover_get_pivot=function(e,t){return r.is_hover_camera(e)?(t=t||new Float32Array(3),p.copy(e.o.mc,t),t):(c.error("hover_get_pivot(): Wrong camera object or camera move style"),null)},e.hover_get_distance=function(e){return r.is_hover_camera(e)?f.ir(e,e.o.mc):(c.error("hover_get_distance(): Wrong camera object or camera move style"),0)},e.hover_set_vertical_limits=function(e,t){r.is_hover_camera(e)?"number"!=typeof t.down||"number"!=typeof t.up||t.down<t.up?c.error("hover_set_vertical_limits(): Wrong limits object"):(r.hover_set_vertical_limits(e,t),f.O(e),s.sync_transform(e)):c.error("hover_set_vertical_limits(): Wrong camera object or camera move style")},e.hover_get_vertical_limits=function(e,t){if(!r.is_hover_camera(e))return c.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var a=e.o;return t=t||{},t.down=a.Ha.down,t.up=a.Ha.up,t},e.hover_set_distance_limits=function(e,t){r.is_hover_camera(e)?"number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max?c.error("hover_set_distance_limits(): Wrong limits object"):(t.min=Math.max(t.min,0),t.max=Math.max(t.max,0),r.hover_set_distance_limits(e,t),f.O(e),s.sync_transform(e)):c.error("hover_set_distance_limits(): Wrong camera object or camera move style")},e.hover_get_distance_limits=function(e,t){if(!r.is_hover_camera(e))return c.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var a=e.o;return t=t||{},t.min=a.vb.min,t.max=a.vb.max,t},e.hover_set_vert_trans_limits=function(e,t){r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?c.error("hover_set_vert_trans_limits(): Wrong limits object"):(r.hH(e,t),f.O(e),s.sync_transform(e)):c.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")},e.hover_get_vert_trans_limits=function(e,t){if(!r.is_hover_camera(e))return c.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var a=e.o;return a.Mc?(t=t||{},t.min=a.Mc.min,t.max=a.Mc.max,t):null},e.hover_set_horiz_trans_limits=function(e,t){r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?c.error("hover_set_horiz_trans_limits(): Wrong limits object"):(r.bH(e,t),f.O(e),s.sync_transform(e)):c.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")},e.hover_get_horiz_trans_limits=function(e,t){if(!r.is_hover_camera(e))return c.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var a=e.o;return a.Lc?(t=t||{},t.min=a.Lc.min,t.max=a.Lc.max,t):null},e.hover_switch_horiz_rotation=function(e,t){if(!r.is_hover_camera(e))return c.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;e.o.tg=t},e.is_static_camera=r.is_static_camera,e.is_target_camera=r.is_target_camera,e.is_eye_camera=r.is_eye_camera,e.is_hover_camera=r.is_hover_camera,e.get_move_style=function(e){return _.is_camera(e)?r.get_move_style(e):(c.error("get_move_style(): Wrong camera object"),null)},e.set_translation=function(e,t){if(_.is_camera(e)){var a=e.o;if(r.is_target_camera(e)){var n=u.get_trans_view(a.v),n=p.subtract(t,n,v);p.add(n,a.pivot,a.pivot)}else r.is_hover_camera(e)&&(n=u.get_trans_view(a.v),n=p.subtract(t,n,v),p.add(n,a.mc,a.mc));f.set_translation(e,t),f.O(e),s.sync_transform(e)}else c.error("set_translation(): Wrong camera object")},e.get_translation=function(e,t){return _.is_camera(e)?(t=t||new Float32Array(3),f.get_translation(e,t)):(c.error("get_translation(): Wrong camera object"),null)},e.rotate_camera=function(e,t,a,n){_.is_camera(e)?(n?r.vT(e,t):r.LS(e,t,a),f.O(e),s.sync_transform(e)):c.error("rotate_camera(): Wrong camera object")},e.set_velocities=function(e,t){if(_.is_camera(e)){var a=e.o;"number"==typeof t.trans&&(a.fp=d.clamp(t.trans,0,1/0)),"number"==typeof t.rot&&(a.ep=d.clamp(t.rot,0,1/0)),"number"==typeof t.zoom&&(a.gp=d.clamp(t.zoom,0,.99))}else c.error("set_velocities(): Wrong camera object")},e.get_velocities=function(e,t){if(!_.is_camera(e))return c.error("get_velocities(): Wrong camera object"),null;var a=e.o;return t=t||{},t.trans=a.fp,t.rot=a.ep,t.zoom=a.gp,t},e.is_look_up=function(e){return _.is_camera(e)?(e=u.get_quat_view(e.o.v),0<=d.quat_to_dir(e,d.AXIS_MZ,v)[1]):(c.error("is_look_up(): Wrong camera object"),!1)},e.get_camera_angles=function(e,t){return _.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles(e,t),t):(c.error("get_camera_angles(): Wrong camera object"),null)},e.get_camera_angles_char=function(e,t){return _.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles_char(e,t),t):(c.error("get_camera_angles_char(): Wrong camera object"),null)},e.get_camera_angles_dir=function(e,t){t=t||new Float32Array(2);var a=p.normalize(e,v),a=d.MG(d.AXIS_MZ,a,A);return d.correct_cam_quat_up(a,!0),r.Oy(a,t),t},e.set_stereo_distance=function(e,t){if(_.is_camera(e))for(var a=l.get_active(),a=_.ya(e,a).ba,n=0;n<a.length;n++){var o=a[n];o.type!=r.tc&&o.type!=r.Bc&&o.type!=r.Re&&o.type!=r.xe||r.xT(o,t,o.qf)}else c.error("set_stereo_distance(): Wrong camera object")},e.get_stereo_distance=function(e){if(!_.is_camera(e))return c.error("get_stereo_distance(): Wrong camera object"),0;var t=l.get_active();for(e=_.ya(e,t).ba,t=0;t<e.length;t++){var a=e[t];if(a.type==r.tc||a.type==r.Bc)return a.Qk}return 0},e.set_eye_distance=function(e,t){if(_.is_camera(e)){var a=l.get_active(),a=_.ya(e,a).ba;r.set_eye_distance(a,t)}else c.error("set_eye_distance(): Wrong camera object")},e.get_eye_distance=function(e){if(!_.is_camera(e))return c.error("get_eye_distance(): Wrong camera object"),0;var t=l.get_active();for(e=_.ya(e,t).ba,t=0;t<e.length;t++){var a=e[t];if(a.type==r.tc||a.type==r.Bc||a.type==r.Re||a.type==r.xe)return a.qf}return 0},e.set_vertical_axis=function(e,t){_.is_camera(e)?(p.copy(t,e.o.Zd),f.O(e),s.sync_transform(e)):c.error("set_vertical_axis(): Wrong camera object")},e.get_vertical_axis=function(e,t){if(_.is_camera(e))return t||(t=p.create()),p.copy(e.o.Zd,t),t;c.error("get_vertical_axis(): Wrong camera object")},e.translate_view=function(e,t,a,n){if(_.is_camera(e)){var i=l.get_active();for(e=_.ya(e,i).ba,i=0;i<e.length;i++){var s=e[i];s.nc||r.set_projection(s,!1);var f=v;f[0]=-t,f[1]=-a,f[2]=0,o.translate(s.pb,f,s.pb),o.rotateZ(s.pb,n,s.pb),r.bD(s),r.Yx(s)}}else c.error("translate_view(): Wrong camera object")},e.get_view_vector=a,e.get_fov=function(e){if(!_.is_camera(e))return c.error("get_fov(): Wrong camera object"),0;var t=l.get_active();return e=_.ya(e,t).ba,r.get_fov(e[0])},e.set_fov=function(e,t){if(_.is_camera(e))for(var a=l.get_active(),a=_.ya(e,a).ba,n=0;n<a.length;n++){var o=a[n];r.set_fov(o,t),o.nc||r.set_projection(o,!1),r.bD(o),r.Yx(o)}else c.error("set_fov(): Wrong camera object")},e.set_hmd_fov=function(){c.da("set_hmd_fov() deprecated")},e.correct_up=function(e,t,a){_.is_camera(e)?(t=t||e.o.Zd,r.correct_up(e,t,a||!1),f.O(e),s.sync_transform(e)):c.error("correct_up(): Wrong camera object")},e.set_ortho_scale=function(e,t){if(_.is_camera(e)&&r.is_ortho_camera(e)){var a=e.o;if(r.is_target_camera(e)){var n=u.get_trans_view(a.v),n=p.dist(n,a.pivot);a.lk=t/2*a.kk/n}else r.is_hover_camera(e)?(n=u.get_trans_view(a.v),n=p.distance(n,a.mc),a.lk=t/2*a.kk/n):(a=l.get_active(),_.ya(e,a).ba[0].top=t/2);r.QU(e)}else c.error("set_ortho_scale(): Wrong camera object")},e.get_ortho_scale=function(e){if(!_.is_camera(e)||!r.is_ortho_camera(e))return c.error("get_ortho_scale(): Wrong camera object"),0;var t=l.get_active();return 2*_.ya(e,t).ba[0].top},e.is_ortho_camera=function(e){return _.is_camera(e)?r.is_ortho_camera(e):(c.error("is_ortho_camera(): Wrong camera object"),!1)},e.calc_ray=function(e,t,a,o){if(!_.is_camera(e))return c.error("calc_ray(): Wrong camera object"),null;var s=l.get_active(),m=_.ya(e,s).ba[0];switch(o&&3==o.length?c.da('dest parameter in the function "calc_ray" should be type of parametric line.'):o=o||new Float32Array(6),m.type){case r.Gc:case r.Se:case r.tc:case r.Bc:var g=Math.tan(r.bQ(m)/2),A=g*m.jb,s=v;return t=n.Tp(t,a,h,m),s[0]=(2*t[0]/m.width-1)*A,s[1]=(1-2*t[1]/m.height)*g,s[2]=-1,u.transform_dir_vec3(s,e.o.v,s),p.normalize(s,s),3==o.length?p.copy(s,o):(e=f.get_translation(e,b),i.set_pline_initial_point(o,e),i.set_pline_directional_vec(o,s)),o;case r.ce:return s=v,t=n.Tp(t,a,h,m),s[0]=(2*t[0]/m.width-1)*m.top*m.jb,s[1]=(1-2*t[1]/m.height)*m.top,s[2]=0,u.transform_vec3(s,e.o.v,s),p.copy(s,o),e=u.get_quat_view(e.o.v,E),p.transformQuat(d.AXIS_MZ,e,s),i.set_pline_directional_vec(o,s),o;default:return c.error("calc_ray(): Non-compatible camera"),o}},e.project_point=function(e,t,a){return _.is_camera(e)?(a=a||new Float32Array(2),r.project_point(e,t,a)):(c.error("project_point(): Wrong camera object"),null)},e.has_distance_limits=function(e){return(r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.o.vb},e.has_vertical_rot_limits=function(e){return(r.is_eye_camera(e)||r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.o.Ha},e.has_horizontal_rot_limits=function(e){return(r.is_target_camera(e)||r.is_eye_camera(e))&&null!==e.o.Bb},e.has_vertical_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.o.Mc},e.has_horizontal_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.o.Lc},e.get_frustum_planes=function(e,t){if(!_.is_camera(e))return c.error("get_frustum_planes(): Wrong camera object"),null;var a=l.get_active(),a=_.ya(e,a).ba[0].ih;return m.copy(a.left,t.left),m.copy(a.right,t.right),m.copy(a.top,t.top),m.copy(a.bottom,t.bottom),m.copy(a.near,t.near),m.copy(a.far,t.far),t},e.set_projection=function(e,t){_.is_camera(e)?r.sT(e,t):c.error("set_projection(): Wrong camera object")}},a.module.config=function(e,t){var a=t("__config"),r=t("__compat"),n=t("__debug"),o=t("__data"),i=t("__print");e.P_LOW=a.P_LOW,e.P_HIGH=a.P_HIGH,e.P_ULTRA=a.P_ULTRA,e.P_CUSTOM=a.P_CUSTOM,e.P_AUTO=a.P_AUTO,e.set=a.set,e.get=a.get,e.reset=a.reset,e.reset_limits=a.reset_limits,e.get_std_assets_path=a.get_assets_path,e.get_assets_path=a.get_assets_path,e.apply_quality=function(e){o.is_primary_loaded()?i.error("Cannot change quality profile after a scene is loaded."):(a.set("quality",e),n.qu()&&(a.apply_quality(),r.aH(n.qu(),!1)))}},a.module.controls=function(e,t){var a=t("__controls"),r=t("__physics"),n=t("__print");e.CT_POSITIVE=a.CT_POSITIVE,e.CT_CONTINUOUS=a.CT_CONTINUOUS,e.CT_TRIGGER=a.CT_TRIGGER,e.CT_SHOT=a.CT_SHOT,e.CT_LEVEL=a.CT_LEVEL,e.CT_CHANGE=a.CT_CHANGE,e.KEY_BACKSPACE=8,e.KEY_TAB=9,e.KEY_ENTER=13,e.KEY_SHIFT=16,e.KEY_CTRL=17,e.KEY_ALT=18,e.KEY_PAUSE=19,e.KEY_CAPSLOCK=20,e.KEY_ESC=27,e.KEY_SPACE=32,e.KEY_LEFT=37,e.KEY_UP=38,e.KEY_RIGHT=39,e.KEY_DOWN=40,e.KEY_1=49,e.KEY_2=50,e.KEY_3=51,e.KEY_4=52,e.KEY_5=53,e.KEY_6=54,e.KEY_7=55,e.KEY_8=56,e.KEY_9=57,e.KEY_A=65,e.KEY_B=66,e.KEY_C=67,e.KEY_D=68,e.KEY_E=69,e.KEY_F=70,e.KEY_G=71,e.KEY_H=72,e.KEY_I=73,e.KEY_J=74,e.KEY_K=75,e.KEY_L=76,e.KEY_M=77,e.KEY_N=78,e.KEY_O=79,e.KEY_P=80,e.KEY_Q=81,e.KEY_R=82,e.KEY_S=83,e.KEY_T=84,e.KEY_U=85,e.KEY_V=86,e.KEY_W=87,e.KEY_X=88,e.KEY_Y=89,e.KEY_Z=90,e.KEY_NUM0=96,e.KEY_NUM1=97,e.KEY_NUM2=98,e.KEY_NUM3=99,e.KEY_NUM4=100,e.KEY_NUM5=101,e.KEY_NUM6=102,e.KEY_NUM7=103,e.KEY_NUM8=104,e.KEY_NUM9=105,e.KEY_MULT=106,e.KEY_ADD=107,e.KEY_SUB=109,e.KEY_DEC_POINT=110,e.KEY_DIV=111,e.KEY_SEMI_COLON=186,e.KEY_EQUAL_SIGN=187,e.KEY_COMMA=188,e.KEY_DASH=189,e.KEY_PERIOD=190,e.KEY_FORWARD_SLASH=191,e.KEY_GRAVE_ACCENT=192,e.KEY_LEFT_SQ_BRACKET=219,e.KEY_BACK_SLASH=220,e.KEY_RIGHT_SQ_BRACKET=221,e.KEY_SINGLE_QUOTE=222,e.PL_SINGLE_TOUCH_MOVE=a.PL_SINGLE_TOUCH_MOVE,e.PL_MULTITOUCH_MOVE_ZOOM=a.PL_MULTITOUCH_MOVE_ZOOM,e.PL_MULTITOUCH_MOVE_PAN=a.PL_MULTITOUCH_MOVE_PAN,e.PL_MULTITOUCH_MOVE_ROTATE=a.PL_MULTITOUCH_MOVE_ROTATE,e.default_AND_logic_fun=a.default_AND_logic_fun,e.default_OR_logic_fun=a.default_OR_logic_fun,e.create_gamepad_btn_sensor=a.create_gamepad_btn_sensor,e.create_gamepad_axis_sensor=a.create_gamepad_axis_sensor,e.create_gamepad_position_sensor=a.create_gamepad_position_sensor,e.create_gamepad_orientation_sensor=a.create_gamepad_orientation_sensor,e.create_custom_sensor=a.create_custom_sensor,e.create_keyboard_sensor=a.create_keyboard_sensor,e.create_collision_sensor=function(e,t,r){return a.create_collision_sensor(e,t||"ANY",r||!1)},e.create_collision_impulse_sensor=a.create_collision_impulse_sensor,e.create_ray_sensor=function(e,t,o,i,_,s,c){if(!e||r.na(e))return a.create_ray_sensor(e,t,o,i||"ANY",_||!1,s||!1,c||!1);n.da("No physics for object "+e.name)},e.create_mouse_click_sensor=a.create_mouse_click_sensor,e.create_mouse_wheel_sensor=a.create_mouse_wheel_sensor,e.create_mouse_move_sensor=a.create_mouse_move_sensor,e.create_plock_mouse_sensor=a.create_plock_mouse_sensor,e.create_plock_sensor=a.create_plock_sensor,e.create_touch_move_sensor=a.create_touch_move_sensor,e.create_touch_zoom_sensor=a.create_touch_zoom_sensor,e.create_touch_rotate_sensor=a.create_touch_rotate_sensor,e.create_touch_click_sensor=a.create_touch_click_sensor,e.create_motion_sensor=a.create_motion_sensor,e.create_vertical_velocity_sensor=a.create_vertical_velocity_sensor,e.create_gyro_angles_sensor=a.create_gyro_angles_sensor,e.create_gyro_quat_sensor=a.create_gyro_quat_sensor,e.create_gyro_delta_sensor=a.create_gyro_delta_sensor,e.create_hmd_quat_sensor=a.create_hmd_quat_sensor,e.create_hmd_position_sensor=a.create_hmd_position_sensor,e.create_timer_sensor=function(e,t){return a.create_timer_sensor(e,t||!1)},e.reset_timer_sensor=a.reset_timer_sensor,e.create_elapsed_sensor=a.create_elapsed_sensor,e.create_timeline_sensor=a.create_timeline_sensor,e.create_selection_sensor=function(e,t){return a.create_selection_sensor(e,t||!1)},e.create_callback_sensor=function(e,t){return a.create_callback_sensor(e,t||0)},e.set_custom_sensor=function(e,t){a.VS(e,t)},e.get_custom_sensor=function(e){return e.value},e.get_sensor_value=a.get_sensor_value,e.get_sensor_payload=a.get_sensor_payload,e.create_sensor_manifold=function(e,t,r,n,o,i,_){o=o||a.default_AND_logic_fun,a.create_sensor_manifold(e,t,r,n,o,i,void 0===_?null:_)},e.create_kb_sensor_manifold=function(e,t,r,n,o,i){n=a.create_keyboard_sensor(n),a.create_sensor_manifold(e,t,r,[n],a.default_AND_logic_fun,o,void 0===i?null:i)},e.check_sensor_manifolds=function(e){return a.check_sensor_manifold(e,null)},e.check_sensor_manifold=a.check_sensor_manifold,e.remove_sensor_manifold=a.remove_sensor_manifold,e.reset=a.reset,e.set_plock_smooth_factor=a.set_plock_smooth_factor},a.module.constraints=function(e,t){var a=t("__camera"),r=t("__constraints"),n=t("__obj_util"),o=t("__physics"),i=t("__print"),_=t("__transform"),s=t("__util"),c=t("__vec3");e.append_stiff=function(e,t,a,s,c){n.is_dynamic(e)?(a=a||new Float32Array(3),c=c||1,s=s||[0,0,0,1],t instanceof Array&&2==t.length?r.sL(e,t[0],t[1],a,s,c):r.zC(e,t,a,s,c),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_semi_stiff=function(e,t,a,c,l,f,u,d){n.is_dynamic(e)?(l=s.Ud(l)?l:Math.PI/2,f=s.Ud(f)?f:-Math.PI/2,u=s.Ud(u)?u:Math.PI/2,d=s.Ud(d)?d:-Math.PI/2,a=a||new Float32Array(3),c=c?new Float32Array(c):null,r.qL(e,t,a,c,l,f,u,d),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_semi_stiff_cam=function(t,r,n,o,_,s,c,l){i.xd("append_semi_stiff_cam","append_semi_stiff"),a.is_eye_camera(t)?e.append_semi_stiff(t,r,n,o,_,s,c,l):i.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")},e.append_semi_soft_cam=function(t,r,n,o){i.xd("append_semi_soft_cam","append_semi_soft"),a.is_eye_camera(t)?e.append_semi_soft(t,r,n,o):i.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")},e.append_semi_soft=function(e,t,a,c){n.is_dynamic(e)?((!s.Ud(c)||0>c)&&(c=.25),a=a||new Float32Array(3),r.pL(e,t,a,c),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_stiff_trans=function(e,t,a){n.is_dynamic(e)?(a=a||new Float32Array(3),r.tL(e,t,a),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_copy_loc=function(e,t,a,s,c){if(n.is_dynamic(e)){s=s||!1,a=a||"XYZ",c=c||1;var l=_.get_translation(e,new Float32Array(3)),f=new Float32Array(3);f[0]=-1!=a.indexOf("-X")?-1:-1!=a.indexOf("X")?1:0,f[1]=-1!=a.indexOf("-Y")?-1:-1!=a.indexOf("Y")?1:0,f[2]=-1!=a.indexOf("-Z")?-1:-1!=a.indexOf("Z")?1:0,r.hL(e,t,l,f,s,c),_.O(e),o.sync_transform(e)}else i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_copy_trans=function(e,t,a){n.is_dynamic(e)?(r.jL(e,t,a||1),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_copy_rot=function(e,t,a,s,c){if(n.is_dynamic(e)){a=a||"XYZ";var l=new Float32Array(3);l[0]=-1!=a.indexOf("-X")?-1:-1!=a.indexOf("X")?1:0,l[1]=-1!=a.indexOf("-Y")?-1:-1!=a.indexOf("Y")?1:0,l[2]=-1!=a.indexOf("-Z")?-1:-1!=a.indexOf("Z")?1:0,r.iL(e,t,l,s||!1,c||1),_.O(e),o.sync_transform(e)}else i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_stiff_trans_rot=function(e,t,a,s){n.is_dynamic(e)?(a=a||new Float32Array(3),s=s?new Float32Array(s):[0,0,0,1],r.uL(e,t,a,s),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_track=function(e,t,a,l,f,u){if(n.is_dynamic(e)){var d=s.AXIS_Y;"-Y"==a?d=s.AXIS_MY:"Y"==a?d=s.AXIS_Y:"-X"==a?d=s.AXIS_MX:"X"==a?d=s.AXIS_X:"-Z"==a?d=s.AXIS_MZ:"Z"==a&&(d=s.AXIS_Z),a=s.AXIS_Z,"X"==l?a=s.AXIS_X:"Y"==l&&(a=s.AXIS_Y),1==Math.abs(c.dot(d,a))?i.error("Can not use parallel vectors for track and up axes."):(r.vL(e,t,d,a,f||!1,u||1),_.O(e),o.sync_transform(e))}else i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_follow=function(e,t,a,s){n.is_dynamic(e)?(r.mL(e,t,a,s),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.append_stiff_viewport=function(e,t,a){n.is_dynamic(e)?(a=a||{},r.append_stiff_viewport(e,t,a),_.O(e),o.sync_transform(e)):i.error('Wrong object: "'+e.name+'" is not dynamic.')},e.remove=function(e,t){t=t||!1,e.ic&&r.remove(e,t),t&&_.O(e)}},a.module.container=function(e,t){var a=t("__container"),r=t("__print");e.get_canvas=a.get_canvas,e.get_canvas_hud=a.get_canvas_hud,e.get_container=a.get_container,e.insert_to_container=function(e,t){2!=arguments.length?r.error("insert_to_container(): two arguments required"):e&&t&&a.insert_to_container(e,t)},e.set_canvas_offsets=function(e,t){return r.da("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),a.set_canvas_offsets(e,t)},e.update_canvas_offsets=function(){r.da("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),a.update_canvas_offsets()},e.client_to_canvas_coords=function(e,t,r){return r||(r=new Float32Array(2)),a.client_to_canvas_coords(e,t,r)},e.client_to_element_coords=function(e,t,r,n){return n||(n=new Float32Array(2)),a.client_to_element_coords(e,t,r,n)},e.force_offsets_updating=function(){r.da("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),a.force_offsets_updating()},e.resize=function(e,t,r){a.resize(e,t,r)},e.resize_to_container=function(e){a.resize_to_container(e||!1)}},a.module.data=function(e,t){var a=t("__data"),r=t("__loader");e.load=a.load,e.unload=function(e){a.unload(0|e)},e.set_debug_resources_root=a.set_debug_resources_root,e.is_primary_loaded=a.is_primary_loaded,e.is_idle=r.cm,e.load_and_add_new=a.load,e.cleanup=e.unload,e.activate_media=a.activate_media,e.prefetch=a.prefetch,e.unfetch=a.unfetch},a.module.debug=function(e,t){function a(e,t,a,r){for(y.group(N.ww(e),r),e=0;e<a.length;e++){var n=a[e],o=n.o;if(o.type==r)for(var i=!1,_=0;_<t.length;_++){for(var s=t[_].Ca,c=0;c<s.length;c++){var l=s[c];if(l.Vb&&l.Yf==o){"STATIC"==r?y.cd(n.qd,n):y.cd(n.name,n),i=!0;break}}if(i)break}}y.groupEnd()}function r(e){var t={};if(!e)return t;e=e.split("\n");for(var a=0;a<e.length;a++){var r=e[a];if(-1!=r.search(new RegExp(/^[A-Z.]+ ?/))){var n=r.split(" ")[0];n in t||(t[n]=0),t[n]++}}r=a=e=0;for(n in t)switch(n){case"KIL":case"TEX":case"TXB":case"TXP":case"KIL.F":case"TEX.F":case"TXB.F":case"TXD.F":case"TXL.F":case"TXQ.F":case"TXP.F":a+=t[n],e+=t[n];break;case"ATTRIB":r+=t[n];break;case"ADDRESS":case"PARAM":case"TEMP":case"ALIAS":case"OUTPUT":case"END":break;default:e+=t[n]}return t.ALL_OPS=e,t.TEX_OPS=a,t.ATTRIBS=r,t}function n(e,t){var a=new XMLHttpRequest;if(a.open("POST",e,!1),a.send(t),200==a.status)return a.responseText;throw y.error(a.responseText),"Error POST XHR: "+a.status}function o(e){e.sort(function(e,t){return t.Jy.ALL_OPS-e.Jy.ALL_OPS});for(var t=0;t<e.length;t++){var a=e[t],r=a.Jy,n=a.wV,o=i(a.$N),o=o.length?"\t\t("+o.join(", ")+")":"\t\t(NA)";y.groupCollapsed("VERT ->","OPS",n.ALL_OPS,"ATT",n.ATTRIBS,"TEX",n.TEX_OPS,"\t\tFRAG ->","OPS",r.ALL_OPS,"TEX",r.TEX_OPS,o),y.groupCollapsed("directives");for(var _=a.Ra.ah.slice().sort(),o=0;o<_.length;o++){var s=_[o];y.cd(s[0],s[1])}for(y.groupEnd(),y.groupCollapsed("node elements"),_=a.Ra.He,o=0;o<_.length;o++)y.cd(_[o]);y.groupEnd(),y.groupCollapsed("vert source"),y.cd(a.uV),y.groupEnd(),y.groupCollapsed("vert translated source"),y.cd(a.vV),y.groupEnd(),o=["ALL_OPS","TEX_OPS","ATTRIBS"],y.groupCollapsed("vert ops stats");for(var c in n)-1==o.indexOf(c)&&y.cd(c,n[c]);y.groupEnd(),y.groupCollapsed("vert assembly"),y.cd(a.tV),y.groupEnd(),y.groupCollapsed("frag source"),y.cd(a.bP),y.groupEnd(),y.groupCollapsed("frag translated source"),y.cd(a.cP),y.groupEnd(),y.groupCollapsed("frag ops stats");for(c in r)-1==o.indexOf(c)&&y.cd(c,r[c]);y.groupEnd(),y.groupCollapsed("frag assembly"),y.cd(a.UO),y.groupEnd(),y.groupEnd()}}function i(e){for(var t=[],a=O.Lq(),r=0;r<a.length;r++)for(var n=a[r],o=A.Hb(n,"MESH",A.DATA_ID_ALL),i=0;i<o.length;i++){var _=x.ya(o[i],n);if(_&&_.U.length)for(var _=_.U,s=0;s<_.length;s++){var c=_[s];if(c.ib==e)for(var l=0;l<c.Pb.length;l++){var f=c.Pb[l];-1==t.indexOf(f)&&t.push(f)}}}return t}function _(e){function t(){return H.push(t),e.apply(e,arguments)}return t}function s(e,t,a,r,n){if(typeof t!=typeof e)throw"debug.eqv: wrong expected data type";if(e.length!=t.length)throw"debug.eqv: wrong expected vector length";a=a||1e-6;for(var o=0;o<e.length;o++)if(t[o]>e[o]+a||t[o]<e[o]-a)throw"debug.eqv: wrong result";c(r,n,"eqv")}function c(e,t,a){if(e=e||"",t=t||"",W){if(""==e)throw"debug."+a+': no error is expected, but got "'+q+'"';if(q!=e)throw"debug."+a+': error "'+e+'" is expected, but got "'+q+'"'}else if(""!=e)throw"debug."+a+': error "'+e+'" is expected, but got nothing';if(z){if(""==t)throw"debug."+a+': no warning is expected, but got "'+X+'"';if(X!=t)throw"debug."+a+': warning "'+t+'" is expected, but got "'+X+'"'}else if(""!=t)throw"debug."+a+': warning "'+t+'" is expected, but got nothing';W=z=!1}function l(){j&&(A.qo(j,!1,!1,!1),g.tG(j),A.qo(j,!0,!0,!0),A.remove_object(j),j=null)}var f=t("__batch"),u=t("__config"),d=t("__compat"),p=t("__controls"),m=t("__container"),g=t("__data"),h=t("__debug"),v=t("__extensions"),b=t("__geometry"),E=t("__loader"),A=t("__objects"),x=t("__obj_util"),T=t("__physics"),y=t("__print"),S=t("__renderer"),O=t("__scenes"),w=t("__scenegraph"),R=t("__sfx"),L=t("__shaders"),N=t("__subscene"),I=t("__textures"),M=t("__transform"),C=t("__tsr"),D=t("__util"),U=t("__vec3"),k=C.create(),P=new Float32Array(2),G=U.create(),F=U.create(),j=null,B=u.H,H=[],X="",q="",z=!1,W=!1,Y=!0,V=new Uint8Array(4);e.DV_NONE=h.DV_NONE,e.DV_OPAQUE_WIREFRAME=h.DV_OPAQUE_WIREFRAME,e.DV_TRANSPARENT_WIREFRAME=h.DV_TRANSPARENT_WIREFRAME,e.DV_FRONT_BACK_VIEW=h.DV_FRONT_BACK_VIEW,e.DV_BOUNDINGS=h.DV_BOUNDINGS,e.DV_CLUSTERS_VIEW=h.DV_CLUSTERS_VIEW,e.DV_BATCHES_VIEW=h.DV_BATCHES_VIEW,e.DV_RENDER_TIME=h.DV_RENDER_TIME,e.physics_stats=function(){T.gO()},e.physics_id=function(e){y.log("O",T.OO(e));var t=T.oP();if(t)for(var t=t.pc.Ca,a=0;a<t.length;a++){var r=t[a];r.I.aa==e&&y.log("B",r)}else y.error("No active physics scene.")},e.visible_objects=function(){for(var e=O.get_active(),t=A.Hb(e,"MESH",A.DATA_ID_ALL),e=O.eg(e,[N.Gb,N.Sc,N.Md]),r=0;r<e.length;r++){var n=e[r],o=n.Pa;o.length&&(a(n,o,t,"DYNAMIC"),a(n,o,t,"STATIC"))}},e.object_info=function(e){for(var t=O.get_active(),a=A.Hb(t,"MESH",A.DATA_ID_ALL),r=0;r<a.length;r++){var n=a[r];if(n.name==e){y.log("Object",n);for(var o=O.My(t),i=0;i<o.length;i++){for(var _=o[i],s=[],c=_.Pa,l=0;l<c.length;l++)for(var f=c[l].Ca,u=0;u<f.length;u++)f[u].Yf==n.o&&s.push(f[u]);y.log("Subscene "+_.type,s)}}}},e.objects_stat=function(){var e=O.get_active();y.log("Armatures: "+A.Hb(e,"ARMATURE",A.DATA_ID_ALL).length),y.log("Cameras: "+A.Hb(e,"CAMERA",A.DATA_ID_ALL).length),y.log("Curves: "+A.Hb(e,"CURVE",A.DATA_ID_ALL).length),y.log("Empties: "+A.Hb(e,"EMPTY",A.DATA_ID_ALL).length),y.log("Lamps: "+A.Hb(e,"LAMP",A.DATA_ID_ALL).length),y.log("Meshes: "+A.Hb(e,"MESH",A.DATA_ID_ALL).length),y.log("Speakers: "+A.Hb(e,"SPEAKER",A.DATA_ID_ALL).length)},e.num_vertices=function(){for(var e=0,t=O.get_active(),t=O.eg(t,[N.Gb,N.Sc,N.Md]),a=0;a<t.length;a++)for(var r=t[a].Pa,n=0;n<r.length;n++)for(var o=r[n].Ca,i=0;i<o.length;i++){var _=o[i].ra;_&&(e+=_.num_vertices)}return e},e.num_triangles=function(){for(var e=0,t=O.get_active(),t=O.eg(t,[N.Gb,N.Sc,N.Md]),a=0;a<t.length;a++)for(var r=t[a].Pa,n=0;n<r.length;n++)for(var o=r[n].Ca,i=0;i<o.length;i++){var _=o[i].ra;_&&(e+=_.num_triangles)}return e},e.num_draw_calls=function(){for(var e=O.get_active(),t=O.eg(e,[N.Gb,N.Sc,N.Md,N.Nd,N.Bf]),a=0,r=0;r<t.length;r++)for(var n=t[r],n=n.Pa,o=0;o<n.length;o++)a+=n[o].Ca.length;for(e=O.eg(e,[N.kd,N.Qe]),r=0;r<e.length;r++)for(n=e[r],n=n.Pa,o=0;o<n.length;o++)a+=6*n[o].Ca.length;return a},e.num_shaders=function(){return D.$i(L.DE())},e.geometry_stats=function(){for(var e=O.get_active(),t=O.My(e),e={},a=0;a<t.length;a++){var r=t[a];if(r.type!=N.zi&&r.type!=N.Sg)for(var n=r.Pa,o=0;o<n.length;o++)for(var i=n[o].Ca,_=0;_<i.length;_++){var s=i[_].ra,c=i[_].Yf;s&&(r.type!=N.we&&r.type!=N.Tg||c.Cv||c.Bv)&&(e[s.id]=s)}}var l,a=t=0;for(l in e)r=e[l].ga,r.sn&&(a+=r.sn/1048576),t+=r.vn/1048576;return{vbo_memory:t,ibo_memory:a}},e.num_textures=function(){for(var e=[],t=0,a=O.get_active(),a=O.eg(a,[N.Gb,N.Sc,N.Md]),r=0;r<a.length;r++)for(var n=a[r].Pa,o=0;o<n.length;o++)for(var i=n[o].Ca,_=0;_<i.length;_++){var s=i[_].ra;if(s)for(var s=s.fa,c=0;c<s.length;c++){var l=s[c];if("IMAGE"===l.source||"ENVIRONMENT_MAP"===l.source){var f=l.zb;-1===e.indexOf(f)&&(e.push(f),l=l.width*l.height*4/1048576/l.lq,l*=1.3333,t+=l)}}}return{number:e.length,memory:t}},e.num_render_targets=function(){for(var e=[],t=0,a=O.get_active(),a=O.My(a),r=0;r<a.length;r++){var n=a[r];if(n.type!=N.zi){var o=n.B,i=[o.$b,o.bf];for(i.push.apply(i,n.Og),n=0;n<i.length;n++){var _=i[n];I.Zn(_)&&-1==e.indexOf(_)&&(e.push(_),t+=o.width*o.height*I.aQ(_))}}}return{number:e.length,memory:t/1024/1024}},e.make_camera_frustum_shot=function(){var e=O.get_active();(e=O.Ib(e,N.Gb))&&O.MF(e.B,e,[1,1,0])},e.make_light_frustum_shot=function(){var e=O.get_active(),t=O.Ib(e,N.Gb),e=O.eg(e,[N.ld]);if(t)for(var a=0;a<e.length;a++){var r,n=e[a];switch(a){case 0:r=[1,0,0];break;case 1:r=[0,1,0];break;case 2:r=[0,0,1];break;default:r=[1,0,1]}O.MF(n.B,t,r)}},e.scenegraph_to_dot=function(){for(var e=O.Lq(),t=0;t<e.length;t++)y.log("\n"+w.eO(O.ru(e[t])))},e.loading_graph_to_dot=function(e){y.log("\n"+E.fQ(0|e))},e.controls_info=p.debug,e.object_distance=function(e,t){var a=C.get_trans_view(e.o.v),r=C.get_trans_view(t.o.v);return U.dist(a,r)},e.msg=h.msg,e.fbmsg=h.fbmsg,e.print_telemetry=h.print_telemetry,e.plot_telemetry=h.plot_telemetry,e.fbres=function(e,t){function a(){h.fbmsg("FBRES",e()),setTimeout(a,t)}t||(t=16),a()},e.assert_constants=function(){var e=new Float32Array([0,0,0,1]),t=new Float32Array([1,0,0]),a=new Float32Array([0,1,0]),r=new Float32Array([0,0,1]),n=new Float32Array([-1,0,0]),o=new Float32Array([0,-1,0]),i=new Float32Array([0,0,-1]);if(!D.Vj(new Float32Array(3),D.Ax))throw"Wrong VEC3_IDENT";if(!D.Vj(e,D.zs))throw"Wrong QUAT4_IDENT";if(!D.Vj(t,D.AXIS_X))throw"Wrong AXIS_X";if(!D.Vj(a,D.AXIS_Y))throw"Wrong AXIS_Y";if(!D.Vj(r,D.AXIS_Z))throw"Wrong AXIS_Z";if(!D.Vj(n,D.AXIS_MX))throw"Wrong AXIS_MX";if(!D.Vj(o,D.AXIS_MY))throw"Wrong AXIS_MY";if(!D.Vj(i,D.AXIS_MZ))throw"Wrong AXIS_MZ"},e.mute_music=function(){for(var e=R.get_speaker_objects(),t=0;t<e.length;t++){var a=e[t];"BACKGROUND_MUSIC"==R.Uy(a)&&R.mute(a,!0)}},e.check_finite=h.check_finite,e.set_debug_params=function(e){var t=O.get_active(),t=O.eg(t,[N.Sg]);if(t.length)for(var a=0;a<t.length;a++){var r=t[a];if("number"==typeof e.debug_view_mode)switch(e.debug_view_mode){case h.DV_NONE:case h.DV_OPAQUE_WIREFRAME:case h.DV_TRANSPARENT_WIREFRAME:case h.DV_FRONT_BACK_VIEW:case h.DV_BOUNDINGS:case h.DV_CLUSTERS_VIEW:case h.DV_BATCHES_VIEW:case h.DV_RENDER_TIME:O.cT(r,e.debug_view_mode);break;default:y.error("set_debug_params(): Wrong debug view mode")}"number"==typeof e.debug_colors_seed&&O.bT(r,e.debug_colors_seed),"number"==typeof e.AS&&O.uT(r,e.AS),"object"==typeof e.wireframe_edge_color&&O.DT(r,D.f32(e.wireframe_edge_color))}else y.error("Debugging is not available on the scene.")},e.get_error_quantity=function(){return y.FP()},e.get_warning_quantity=function(){return y.cQ()},e.clear_errors_warnings=function(){return y.clear_errors_warnings()},e.analyze_shaders=function(e){var t,a=L.DE(),i=0;for(t in a)e&&-1===t.indexOf(e)||i++;var i="of "+i+" analyzing...",_={};for(t in a)if(!e||-1!==t.indexOf(e)){var s,c=a[t];s=c.cx;var l=c.iu,f=v.BP();if(f){var u=f.getTranslatedShaderSource(s),f=f.getTranslatedShaderSource(l);if(d.detect_mobile())var u=u.replace("#version","#version 300 //"),f=f.replace("#version","#version 300 //"),p=n("/analyze_shader/vert_gles",u),m=n("/analyze_shader/frag_gles",f);else u=u.replace("#version","#version 400 //"),f=f.replace("#version","#version 400 //"),p=n("/analyze_shader/vert",u),m=n("/analyze_shader/frag",f);var g=r(p),b=r(m);s={uV:h.qu().getShaderSource(s),vV:u,tV:p,wV:g,bP:h.qu().getShaderSource(l),cP:f,UO:m,Jy:b}}else y.warn("WEBGL_debug_shaders extension not found"),s=void 0;if(s){var l=c.Ra,E=l.uf+" + "+l.ge;s.$N=c,s.Ra=l,c=_[E]=_[E]||[],c.push(s),y.cd(i)}}for(E in _)y.group("%c"+E,"color: #800"),c=_[E],o(c),y.groupEnd()},e.fake_load=h.fake_load,e.test_performance=function(t){if(L.lD())if(v.Ry()){var a=B.gl_debug;B.gl_debug=!0;var r=w.qN();O.sE(null,r);for(var n=w.bc(r,N.sp),o=n.B,r=0;5>r;r++)S.Cn(n);B.gl_debug=a,window.setTimeout(function(){h.kS(n);var e=n.af;t(e,o.width*o.height*40/(e/1e3)/Math.pow(10,9))},100)}else t(0,0);else window.setTimeout(function(){e.test_performance(t)},100)},e.calc_vbo_garbage_byte_size=h.calc_vbo_garbage_byte_size,e.show_vbo_garbage_info=h.show_vbo_garbage_info,e.print_batches_stat=h.print_batches_stat,e.start_debug=function(e){H=[],Y=!0,e=t(e);for(var a in e)"function"===typeof e[a]&&(e[a]=_(e[a]))},e.check_debug_result=function(){return Y},e.test=function(e,a){var r=t("__print"),n=r.error,o=r.da,i=r.warn;r.error=r.da=function(){q=r.zD(arguments,"B4W ERROR").join(" "),W=!0},r.warn=function(){X=r.zD(arguments,"B4W WARN").join(" "),z=!0},W=z=!1;try{a();var _=!0}catch(t){Y=!1,console.error('Test "'+e+'" failed with exception: "'+t+'"'),W=z=_=!1}return r.error=n,r.da=o,r.warn=i,_},e.pix=function(e){var t=m.OE(),a=m.NE(),r=t/2,n=a/2;m.resize(t,a,!1),t=O.get_active().G.va,(a=w.PO(t))||D.F("Couldn't find onscreen subscene"),t=a.B,r=m.Tp(r,n,P,a.B),r[1]=t.height-r[1],r=S.Uv(t.Ee,r[0],r[1],1,1,V),s(e,r,1)},e.eqs=function(e,t,a,r){if(JSON.stringify(e)!=JSON.stringify(t))throw"debug.eqs: wrong result";c(a,r,"eqs")},e.eqv=s,e.eqf=function(e,t,a,r,n){if("number"!=typeof t)throw"debug.eqf: wrong expected data type";if(a=a||1e-6,t>e+a||t<e-a)throw"debug.eqf: wrong result";c(r,n,"eqf")},e.eq=function(e,t,a,r){if(e!==t)throw"debug.eq: wrong result";c(a,r,"eq")},e.ok=function(e,t,a){if(!e)throw"debug.ok: wrong result";c(t,a,"ok")},e.stat=function(e){var a=[];e=t(e);for(var r in e)-1==H.indexOf(e[r])&&"function"===typeof e[r]&&a.push(r);if(a.length){for(y.groupCollapsed(a.length+" function(s) not tested."),r=0;r<a.length;r++)y.cd(a[r]);y.groupEnd()}else y.group("All functions were tested.")},e.show_normals=function(e,t,a,r){if(l(),t=f.Va(e,t,"MAIN"),!b.bj(e)||!t)return y.error("Normals are not avaliable for the dynamic object:",e.name),!1;var n=t.ga;if(!(n&&n.xb&&n.xb.a_position&&n.xb.a_tbn))return y.error("Normals are not avaliable for the object:",e.name),!1;t=b.Gy(n,"a_position");var n=b.Gy(n,"a_normal"),o=M.get_tsr(e,k);j=A.create_line("normal_line"),e=new Float32Array(2*t.length);for(var i=0;i<t.length;i+=3){var _=G;_[0]=t[i+0],_[1]=t[i+1],_[2]=t[i+2];var s=C.transform_vec3(_,o,F);e[2*i+0]=s[0],e[2*i+1]=s[1],e[2*i+2]=s[2],s=U.scale(n.subarray(i,i+3),a,F),_=U.add(_,s,F),_=C.transform_vec3(_,o,F),e[2*i+3]=_[0],e[2*i+4]=_[1],e[2*i+5]=_[2]}a=f.ou(j),b.draw_line(a,e,!0),S.Ts(a),a.ud.set([1,1,1,1]),a.jm=r},e.hide_normals=l},a.module.geometry=function(e,t){var a=t("__batch"),r=t("__geometry"),n=t("__print"),o=t("__renderer"),i=t("__tbn");e.extract_vertex_array=function(e,t,o){return r.bj(e)?(e=a.Va(e,t,"MAIN"))?(t=e.ga)&&t.xb&&("a_normal"==o&&t.xb.a_tbn||t.xb[o])?r.Gy(t,o):(n.error("Attribute not found:"+o),null):(n.error("Wrong material:",t),null):(n.error("Wrong object:",e.name),null)},e.extract_index_array=function(e,t){if(!r.bj(e))return n.error("Wrong object:",e.name),null;var o=a.Va(e,t,"MAIN");return o?(o=o.ga)&&o.xb?o.Td:(n.error("Buffer data not found"),null):(n.error("Wrong material:",t),null)},e.update_vertex_array=function(e,t,o,i){if(r.bj(e))for(var _=["MAIN","SHADOW","COLOR_ID"],s=0;s<_.length;s++){var c=a.Va(e,t,_[s]);c&&(c=c.ga)&&c.xb&&("a_normal"==o&&c.xb.a_tbn||c.xb[o])&&r.aI(c,o,0,i)}else n.error("Wrong object:",e.name)},e.override_geometry=function(e,t,_,s,c){if(r.bj(e))if(_ instanceof Uint16Array||_ instanceof Uint32Array)if(s instanceof Float32Array)for(var l=["MAIN","SHADOW","COLOR_ID"],f=0;f<l.length;f++){var u=a.Va(e,t,l[f]);if(u){var d=u.ga;if(d){r.bI(d,u.bh,_);var p,m={};for(p in d.xb){var g=d.xb[p],g=s.length/3*g.cc,h=r.On(p);m[h]||(m[h]=0),m[h]+=g}h=r.zQ(m),d.Yb=h,m={};for(p in d.xb)switch(g=d.xb[p],h=r.On(p),m[h]||(m[h]=0),p){case"a_position":r.ps(d.Yb,"a_position",s,m[h]),g.offset=m[h],g.length=s.length,m[h]+=g.length;break;case"a_tbn":var v;c&&(v=r.ZC(_,s,s));var b=r.YC(_,s,v);g.length=s.length/3*g.cc;for(var E=new Float32Array(g.length),A=0;A<E.length;A+=4)E[A]=1,E[A+3]=1;b=i.Tl(b,E),r.ps(d.Yb,"a_tbn",b,m[h]),g.offset=m[h],m[h]+=g.length;break;default:g.offset=m[h],g.length=s.length/3*g.cc,b=new(r.zP(h))(g.length),r.ps(d.Yb,p,b,m[h]),m[h]+=g.length}r.tB(d),o.Ts(u),(u=a.Of(e,u))&&u.ga&&(u.ga=d)}}}else n.error("Wrong positions_array type");else n.error("Wrong ibo_array type");else n.error("Wrong object:",e.name)},e.set_shape_key_value=function(e,t,a){r.check_shape_keys(e)?r.fz(e,t)?r.Kx(e,t,parseFloat(a)):n.error("Wrong key name:",t):n.error("Wrong object:",e.name)},e.check_shape_keys=function(e){return r.check_shape_keys(e)},e.get_shape_keys_names=function(e){return r.check_shape_keys(e)?r.get_shape_keys_names(e):(n.error("Wrong object:",e.name),[])},e.get_shape_key_value=function(e,t){return r.check_shape_keys(e)?r.fz(e,t)?r.get_shape_key_value(e,t):(n.error("Wrong key name:",t),0):(n.error("Wrong object:",e.name),0)},e.draw_line=function(e,t,i){i=i||!1,t instanceof Float32Array?(e=a.ou(e))&&(r.draw_line(e,t,i),o.Ts(e)):n.error("Wrong positions type")}},a.module.hud=function(e,t){var a=t("__hud"),r=t("__print");e.draw_mixer_strip=function(e,t,n,o,i,_,s){r.xd("draw_mixer_strip","screen.draw_mixer_strip"),a.draw_mixer_strip(e,t,n,o,i,_,s)},e.plot_array=function(e,t,n,o,i,_,s){r.xd("plot_array","screen.plot_array"),a.plot_array(e,t,n,o,i,_,s)}},a.module.input=function(e,t){function a(e){s.xd("enable_split_screen","screen.request_split_screen");var t=r.get_device_by_type_element(r.DEVICE_HMD);if(!t)return!1;if(d)return!0;var a=r.get_vector_param(t,r.KB,f),o=r.get_vector_param(t,r.LB,u);return n.set_hmd_fov(e,a,o),(a=r.get_value_param(t,g))&&(o=c.get_active(),e=_.ya(e,o).ba,n.set_eye_distance(e,a)),e={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0},r.get_value_param(t,r.HMD_WEBVR_TYPE)&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE|r.HMD_WEBVR_DESKTOP)&&(e.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],e.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.Vm||(t.Kh&&t.bi&&t.Lh?e.base_line_factor=(t.Kh-t.Lh)/t.bi:t.Lh||(e.base_line_factor=t.Kh/t.bi)),t.kh&&t.il&&!t.Vm&&(e.inter_lens_factor=t.kh/t.il),p.enabled||(a=1+t.distortion_coefs[0]+t.distortion_coefs[1],c.uv(a,a))),c.set_hmd_params(e),i.resize_to_container(!0),r.reset_device(t),d=!0}var r=t("__input"),n=t("__camera"),o=t("__config"),i=t("__container"),_=t("__obj_util"),s=t("__print"),c=t("__scenes"),l=t("__vec4"),f=l.create(),u=l.create(),d=!1,p=o.Jl,m=o.H;e.GMPD_BUTTON_12=r.GMPD_BUTTON_12,e.GMPD_BUTTON_13=r.GMPD_BUTTON_13,e.GMPD_BUTTON_15=r.GMPD_BUTTON_15,e.GMPD_BUTTON_14=r.GMPD_BUTTON_14,e.GMPD_BUTTON_3=r.GMPD_BUTTON_3,e.GMPD_BUTTON_0=r.GMPD_BUTTON_0,e.GMPD_BUTTON_1=r.GMPD_BUTTON_1,e.GMPD_BUTTON_2=r.GMPD_BUTTON_2,e.GMPD_BUTTON_5=r.GMPD_BUTTON_5,e.GMPD_BUTTON_7=r.GMPD_BUTTON_7,e.GMPD_BUTTON_4=r.GMPD_BUTTON_4,e.GMPD_BUTTON_6=r.GMPD_BUTTON_6,e.GMPD_BUTTON_8=r.GMPD_BUTTON_8,e.GMPD_BUTTON_9=r.GMPD_BUTTON_9,e.GMPD_BUTTON_10=r.GMPD_BUTTON_10,e.GMPD_BUTTON_11=r.GMPD_BUTTON_11,e.GMPD_BUTTON_16=r.GMPD_BUTTON_16,e.GMPD_BUTTON_17=r.GMPD_BUTTON_17,e.GMPD_BUTTON_18=r.GMPD_BUTTON_18,e.GMPD_BUTTON_19=r.GMPD_BUTTON_19,e.GMPD_BUTTON_20=r.GMPD_BUTTON_20,e.GMPD_BUTTON_21=r.GMPD_BUTTON_21,e.GMPD_BUTTON_22=r.GMPD_BUTTON_22,e.GMPD_BUTTON_23=r.GMPD_BUTTON_23,e.GMPD_BUTTON_24=r.GMPD_BUTTON_24,e.GMPD_BUTTON_25=r.GMPD_BUTTON_25,e.GMPD_TRACKPAD_BUTTON=r.GMPD_TRACKPAD_BUTTON,e.GMPD_TRIGGER_BUTTON=r.GMPD_TRIGGER_BUTTON,e.GMPD_GRIPS_BUTTON=r.GMPD_GRIPS_BUTTON,e.GMPD_MENU_BUTTON=r.GMPD_MENU_BUTTON,e.GMPD_AXIS_0=r.GMPD_AXIS_0,e.GMPD_AXIS_1=r.GMPD_AXIS_1,e.GMPD_AXIS_2=r.GMPD_AXIS_2,e.GMPD_AXIS_3=r.GMPD_AXIS_3,e.GMPD_AXIS_4=r.GMPD_AXIS_4,e.GMPD_AXIS_5=r.GMPD_AXIS_5,e.GMPD_AXIS_6=r.GMPD_AXIS_6,e.GMPD_AXIS_7=r.GMPD_AXIS_7,e.GMPD_AXIS_8=r.GMPD_AXIS_8,e.GMPD_AXIS_9=r.GMPD_AXIS_9,e.GMPD_AXIS_10=r.GMPD_AXIS_10,e.GMPD_AXIS_11=r.GMPD_AXIS_11,e.HMD_ORIENTATION_QUAT=r.HMD_ORIENTATION_QUAT,e.HMD_POSITION=r.HMD_POSITION,e.HMD_WEBVR_TYPE=r.HMD_WEBVR_TYPE,e.HMD_WEBVR_DESKTOP=r.HMD_WEBVR_DESKTOP,e.HMD_WEBVR_MOBILE=r.HMD_WEBVR_MOBILE,e.HMD_NON_WEBVR=r.HMD_NON_WEBVR,e.HMD_WEBVR1=r.HMD_WEBVR1,e.HMD_WEBVR1_1=r.HMD_WEBVR1_1;var g=r.HMD_EYE_DISTANCE;e.HMD_EYE_DISTANCE=g,e.HMD_DISTORTION=r.HMD_DISTORTION,e.HMD_BASELINE_DIST=r.HMD_BASELINE_DIST,e.HMD_SCREEN_LENS_DIST=r.HMD_SCREEN_LENS_DIST,e.HMD_SCREEN_WIDTH=r.HMD_SCREEN_WIDTH,e.HMD_SCREEN_HEIGHT=r.HMD_SCREEN_HEIGHT,e.HMD_BEVEL_SIZE=r.HMD_BEVEL_SIZE,e.MOUSE_LOCATION=r.MOUSE_LOCATION,e.MOUSE_DOWN_WHICH=r.MOUSE_DOWN_WHICH,e.MOUSE_UP_WHICH=r.MOUSE_UP_WHICH,e.MOUSE_WHEEL=r.MOUSE_WHEEL,e.KEYBOARD_UP=r.KEYBOARD_UP,e.KEYBOARD_DOWN=r.KEYBOARD_DOWN,e.TOUCH_START=r.TOUCH_START,e.TOUCH_MOVE=r.TOUCH_MOVE,e.TOUCH_END=r.TOUCH_END,e.GYRO_ORIENTATION_QUAT=r.GYRO_ORIENTATION_QUAT,e.GYRO_ORIENTATION_ANGLES=r.GYRO_ORIENTATION_ANGLES;var h={};h[r.DEVICE_HMD]=[r.HMD_ORIENTATION_QUAT,r.HMD_POSITION],h[r.DEVICE_MOUSE]=[r.MOUSE_LOCATION];var v={};v[r.DEVICE_HMD]=[r.HMD_WEBVR_TYPE];var b={};b[r.DEVICE_MOUSE]=[r.MOUSE_LOCATION,r.MOUSE_DOWN_WHICH,r.MOUSE_UP_WHICH,r.MOUSE_WHEEL],b[r.DEVICE_KEYBOARD]=[r.KEYBOARD_UP,r.KEYBOARD_DOWN],b[r.DEVICE_TOUCH]=[r.TOUCH_START,r.TOUCH_MOVE,r.TOUCH_END],b[r.DEVICE_GYRO]=[r.GYRO_ORIENTATION_QUAT,r.GYRO_ORIENTATION_ANGLES];var E={};E[r.DEVICE_HMD]=[r.HMD_DISTORTION,r.HMD_EYE_DISTANCE,r.HMD_BASELINE_DIST,r.HMD_SCREEN_LENS_DIST,r.HMD_SCREEN_WIDTH,r.HMD_SCREEN_HEIGHT,r.HMD_BEVEL_SIZE],e.DEVICE_GYRO=r.DEVICE_GYRO,e.DEVICE_HMD=r.DEVICE_HMD,e.DEVICE_MOUSE=r.DEVICE_MOUSE,e.DEVICE_KEYBOARD=r.DEVICE_KEYBOARD,e.DEVICE_TOUCH=r.DEVICE_TOUCH,e.can_use_device=r.can_use_device,e.get_device_by_type_element=r.get_device_by_type_element,e.switch_prevent_default=function(e,t){e&&r.switch_prevent_default(e,t)},e.register_device=function(){s.da("input.register_device() deprecated")},e.reset_device=function(e){e&&e.type==r.DEVICE_HMD?r.reset_device(e):s.error("reset_device is undefined for device.")},e.get_vector_param=function(e,t,a){return e&&e.type in h&&0<=h[e.type].indexOf(t)?r.get_vector_param(e,t,a):(s.error("device hasn't param: ",t),null)},e.get_value_param=function(e,t){return e&&e.type in v&&0<=v[e.type].indexOf(t)?r.get_value_param(e,t):(s.error("device hasn't param: ",t),null)},e.attach_param_cb=function(e,t,a){if(a=a||null,e&&e.type in b&&0<=b[e.type].indexOf(t))return r.attach_param_cb(e,t,a);s.error("device hasn't param: ",t)},e.detach_param_cb=function(e,t,a){if(a=a||null,e&&e.type in b&&0<=b[e.type].indexOf(t))return r.detach_param_cb(e,t,a);s.error("device hasn't param: ",t)},e.set_config=function(e,t,a){if(e&&e.type in E&&0<=E[e.type].indexOf(t))return r.set_config(e,t,a);s.error("device hasn't config: ",t)},e.request_fullscreen_hmd=function(){if(s.xd("request_fullscreen_hmd","screen.request_fullscreen_hmd"),c.Fa()){var e=c.gk(c.get_active());if(e&&(a(e),e=r.get_device_by_type_element(r.DEVICE_HMD))){var t=e.jd;t&&!t.isPresenting&&(t.capabilities.canPresent?(e=i.get_canvas(),t.requestPresent([{source:e}]).then(function(){if(!m.is_mobile_device){var e=t.getEyeParameters("left"),a=t.getEyeParameters("right");i.resize(2*Math.max(e.renderWidth,a.renderWidth),Math.max(e.renderHeight,a.renderHeight),!1)}},function(){s.error("HMD fullscreen request failed.")})):s.error("HMD fullscreen request failed."))}}},e.enable_split_screen=a,e.disable_split_screen=function(){s.xd("disable_split_screen","screen.exit_split_screen");var e=r.get_device_by_type_element(r.DEVICE_HMD);return!!(d&&e&&e.ag)&&(c.set_hmd_params({enable_hmd_stereo:!1}),e=1/(1+e.distortion_coefs[0]+e.distortion_coefs[1]),c.uv(e,e),i.resize_to_container(!0),!0)},e.set_gamepad_key=function(e,t,a){switch(e){case 0:e=r.vs;break;case 1:e=r.px;break;case 2:e=r.qx;break;case 3:e=r.rx;break;default:e=r.vs}e=r.get_device_by_type_element(e),r.set_config(e,t,a)},e.get_pressed_gmpd_btn=r.get_pressed_gmpd_btn,e.get_moved_gmpd_axis=r.get_moved_gmpd_axis,e.get_gamepad_position=r.get_gamepad_position,e.get_gamepad_orientation=r.get_gamepad_orientation,e.check_enable_gamepad_indices=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=[],a=0;a<e.length;a++)e[a]&&t.push(a);return t},e.get_vr_controller_id=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],a=0,r=0;4>a;a++){var n=t[a];if(n&&(""==n.id||"OpenVR Gamepad"==n.id||"Oculus Touch (Left)"==n.id||"Oculus Touch (Right)"==n.id)){if(r==e)return r;r++}}return e},e.add_click_listener=function(e,t){e&&t&&r.add_click_listener(e,t)},e.remove_click_listener=function(e,t){e&&t&&r.remove_click_listener(e,t)}},a.module.lights=function(e,t){function a(e){for(var t=f.get_active(),a=s.Hb(t,"LAMP",s.DATA_ID_ALL),r=0;r<a.length;r++){var n=a[r];if("SUN"==n.wb.type){var o=n;break}}if(o){if("number"==typeof e.hor_position&&"number"==typeof e.vert_position){if(a=p.deg_to_rad(180-e.hor_position),e=p.deg_to_rad(90-e.vert_position),r=o.o,u.set_rotation_euler(o,[e,0,a]),a=new Float32Array(3),n=d.get_quat_view(r.v),p.quat_to_dir(n,p.AXIS_Z,a),r=d.get_trans_view(r.v),r=m.length(r),m.copy(a,g),m.scale(g,r,g),u.set_translation(o,g),u.O(o),a=o.wb,a.bE){r=t.world.horizon_color,n=t.world.zenith_color,e=Math.cos(Math.abs(e));var i=Math.max(e,.1)*t.world.light_settings.environment_energy;_.set_light_energy(a,Math.max(Math.min(3*e,1),0)*a.UD),f.set_environment_colors(t,i,r,n)}f.es(o,t)}}else l.error("There is no sun on the scene")}function r(e){return c.is_lamp(e)?e.wb.type:(l.error("get_light_type(): Wrong object"),"")}var n,o,i,_=t("__lights"),s=t("__objects"),c=t("__obj_util"),l=t("__print"),f=t("__scenes"),u=t("__transform"),d=t("__tsr"),p=t("__util"),m=t("__vec3"),g=new Float32Array(3),h=60;e.get_lamps=function(e){var t=f.get_active(),t=s.Hb(t,"LAMP",s.DATA_ID_ALL);if(!e)return t;for(var a=[],r=0;r<t.length;r++){var n=t[r];n.wb.type===e&&a.push(n)}return a},e.get_sun_params=function(){for(var e=f.get_active(),e=s.Hb(e,"LAMP",s.DATA_ID_ALL),t=null,a=0;a<e.length;a++){var r=e[a];if("SUN"==r.wb.type){t=r;break}}return t?(t=t.wb.direction,e=p.rad_to_deg(Math.atan2(-t[1],t[0]))+90,180<e&&(e-=360),t=p.rad_to_deg(Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1]))),a={},a.hor_position=e,a.vert_position=t,a):null},e.set_sun_params=a,e.set_day_time=function(e){for(var t=f.get_active(),t=s.Hb(t,"LAMP",s.DATA_ID_ALL),r=0;r<t.length;r++){var n=t[r];if("SUN"==n.wb.type){var o=n;break}}o?(o=-Math.cos(e/12*Math.PI)*h,t={},t.hor_position=12>e?15*e:15*(e-24),t.vert_position=o,a(t)):l.error("There is no sun on the scene")},e.set_date=function(e){n=e.getFullYear(),o=e.getMonth(),i=e.getDate(),n?1582==n&&9==o&&4<i&&15>i&&l.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):l.error("There is no year 0 in the Julian system!")},e.set_max_sun_angle=function(e){h=Math.min(Math.max(e,0),90)},e.get_light_params=function(e){if(!c.is_lamp(e))return l.error("get_light_params(): Wrong object"),null;var t=e.wb;if(e=r(e))switch(e){case"SPOT":var a={light_type:e,light_color:new Float32Array(3),light_energy:t.Mf,light_spot_blend:t.Sr,light_spot_size:t.Cm,light_distance:t.distance};a.light_color.set(t.color);break;case"POINT":a={light_type:e,light_color:new Float32Array(3),light_energy:t.Mf,light_distance:t.distance},a.light_color.set(t.color);break;default:a={light_type:e,light_color:new Float32Array(3),light_energy:t.Mf},a.light_color.set(t.color)}return a||null},e.get_light_type=r,e.set_light_params=function(e,t){if(c.is_lamp(e)){var a=e.wb,r=f.get_active(),n=!1;"number"==typeof t.light_energy&&_.set_light_energy(a,t.light_energy),"object"==typeof t.light_color&&_.set_light_color(a,t.light_color),"number"==typeof t.light_spot_blend&&(_.nT(a,t.light_spot_blend),n=!0),"number"==typeof t.light_spot_size&&(_.oT(a,t.light_spot_size),n=!0),"number"==typeof t.light_distance&&(_.mT(a,t.light_distance),n=!0),f.es(e,r),n&&f.sU(r)}else l.error("set_light_params(): Wrong object")},e.get_light_energy=function(e){return c.is_lamp(e)?e.wb.Mf:(l.error("get_light_energy(): Wrong object"),0)},e.set_light_energy=function(e,t){if(c.is_lamp(e)){var a=f.get_active();_.set_light_energy(e.wb,t),f.es(e,a)}else l.error("set_light_energy(): Wrong object")},e.get_light_color=function(e,t){return c.is_lamp(e)?(t=t||new Float32Array(3),t.set(e.wb.color),t):(l.error("get_light_color(): Wrong object"),null)},e.set_light_color=function(e,t){if(c.is_lamp(e)){var a=f.get_active();_.set_light_color(e.wb,t),f.es(e,a)}else l.error("set_light_color(): Wrong object")}},a.module.logic_nodes=function(e,t){var a=t("__logic_nodes");e.append_custom_callback=function(e,t){a.lL(e,t)},e.remove_custom_callback=function(e){a.sS(e)},e.run_entrypoint=function(e,t){a.OS(e,t)}},a.module.material=function(e,t){var a=t("__batch"),r=t("__config"),n=t("__geometry"),o=t("__objects"),i=t("__obj_util"),_=t("__print"),s=t("__shaders"),c=t("__util"),l=t("__scenes"),f=r.H;e.inherit_material=function(e,t,a,r){if(n.bj(a)&&n.bj(e)){var i=e.xc.Ak.indexOf(t);if(-1==i)_.error('inherit_material(): material "'+t+'" not found on the object "'+e.qd+'".');else{var s=a.xc.Ak.indexOf(r);-1==s?_.error('inherit_material(): material "'+r+'" not found on the object "'+a.qd+'".'):(0==a.Wg.data.submeshes[s].shade_tangs.length&&e.xc.Tj[i].use_tangent_shading&&_.warn('The target material "'+r+'" was exported without tangent shading data. However, the "'+t+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),o.inherit_material(e,t,a,r))}}else _.error('inherit_material(): both objects "'+e.qd+'" and "'+a.qd+'" must have the "Dynamic Geometry & Materials" flag enabled.')},e.get_materials_names=function(e){var t=[];if(!i.gb(e))return _.error('get_materials_names(): Object "'+e.name+'" is not a dynamic MESH.'),t;e=e.K;for(var a=0;a<e.length;a++)for(var r=e[a].U,n=0;n<r.length;n++)for(var o=0;o<r[n].Pb.length;o++)-1==t.indexOf(r[n].Pb[o])&&t.push(r[n].Pb[o]);return t},e.set_diffuse_color=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.ud.set(r),(e=a.Of(e,t,"MAIN"))&&e.ud.set(r)):_.error('set_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_diffuse_color=function(e,t){var r=new Float32Array(4);if(!i.gb(e))return _.error('get_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.'),r;var n=a.Va(e,t,"MAIN");return n?n.nb?(_.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),r):(r.set(n.ud),r):(_.error('get_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),r)},e.set_diffuse_intensity=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.Xh=r,(e=a.Of(e,t,"MAIN"))&&(e.Xh=r)):_.error('set_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_diffuse_intensity=function(e,t){if(!i.gb(e))return _.error('get_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.Xh:(_.error('get_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.set_specular_color=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.ri.set(r),(e=a.Of(e,t,"MAIN"))&&e.ri.set(r)):_.error('set_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_specular_color(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_specular_color=function(e,t){var r=new Float32Array(3);if(!i.gb(e))return _.error('get_specular_color(): Object "'+e.name+'" is not a dynamic MESH.'),r;var n=a.Va(e,t,"MAIN");return n?n.nb?(_.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),r):(r.set(n.ri),r):(_.error('get_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),r)},e.set_specular_color_factor=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.Aj=r,(e=a.Of(e,t,"MAIN"))&&(e.Aj=r)):_.error('set_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_specular_color_factor=function(e,t){if(!i.gb(e))return _.error('get_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.Aj:(_.error('get_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.set_specular_intensity=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.qe[0]=r,(e=a.Of(e,t,"MAIN"))&&(e.qe[0]=r)):_.error('set_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_specular_intensity=function(e,t){if(!i.gb(e))return _.error('get_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.qe[0]:(_.error('get_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.check_specular_intensity=function(e,t){_.da("check_specular_intensity() is deprecated, not needed anymore");var r=a.Va(e,t,"MAIN");return!(!r||!r.qe[0])},e.set_specular_hardness=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.qe[1]=r,(e=a.Of(e,t,"MAIN"))&&(e.qe[1]=r)):_.error('set_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_specular_hardness=function(e,t){if(!i.gb(e))return _.error('get_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.qe[1]:(_.error('get_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.check_specular_hardness=function(e,t){_.da("check_specular_hardness() is deprecated, not needed anymore");var r=a.Va(e,t,"MAIN");return!(!r||!r.qe[1])},e.set_emit_factor=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.dh=r,(e=a.Of(e,t,"MAIN"))&&(e.dh=r)):_.error('set_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_emit_factor=function(e,t){if(!i.gb(e))return _.error('get_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.dh:(_.error('get_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.set_ambient_factor=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.Xg=r,(e=a.Of(e,t,"MAIN"))&&(e.Xg=r)):_.error('set_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_ambient_factor=function(e,t){if(!i.gb(e))return _.error('get_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.Xg:(_.error('get_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.set_diffuse_color_factor=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.Wh=r,(e=a.Of(e,t,"MAIN"))&&(e.Wh=r)):_.error('set_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_diffuse_color_factor=function(e,t){if(!i.gb(e))return _.error('get_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.Wh:(_.error('get_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.set_alpha_factor=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");n?n.nb?_.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(n.mg=r,(e=a.Of(e,t,"MAIN"))&&(e.mg=r)):_.error('set_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_alpha_factor=function(e,t){if(!i.gb(e))return _.error('get_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=a.Va(e,t,"MAIN");return r?r.nb?(_.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.mg:(_.error('get_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},e.get_material_extended_params=function(e,t){if(!i.gb(e))return _.error('get_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var r=a.Va(e,t,"MAIN");if(!r)return _.error('get_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),null;if(r.nb)return _.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var n={};return n.reflect_factor=r.reflect_factor,n.fresnel=r.Pf[2],n.fresnel_factor=5*(1-r.Pf[3]),n.parallax_scale=r.parallax_scale,n.parallax_steps=parseFloat(a.$c(r,"PARALLAX_STEPS")[1]),n},e.set_material_extended_params=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");if(n)if(n.nb)_.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var o=[n];for((n=a.Of(e,t,"MAIN"))&&o.push(n),e=0;e<o.length;e++)n=o[e],"number"==typeof r.reflect_factor&&(n.reflect_factor=r.reflect_factor),"number"==typeof r.fresnel&&(n.Pf[2]=r.fresnel),"number"==typeof r.fresnel_factor&&(n.Pf[3]=1-r.fresnel_factor/5),"number"==typeof r.parallax_scale&&(n.parallax_scale=r.parallax_scale),"number"==typeof r.parallax_steps&&(a.qb(n,"PARALLAX_STEPS",s.R(r.parallax_steps)),a.zc(n),l.BG(n))}else _.error('set_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else _.error('set_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.')},e.get_water_material_params=function(e,t){if(!i.gb(e))return _.error('get_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var r=a.Va(e,t,"MAIN");if(!r||!r.wf)return _.error('get_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material."),null;if(r.nb)return _.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var n={};return n.shore_smoothing=f.shore_smoothing&&r.Um&&!!parseFloat(a.$c(r,"SHORE_SMOOTHING")[1]),n.absorb_factor=parseFloat(a.$c(r,"ABSORB")[1]),n.foam_factor=r.foam_factor,n.shallow_water_col=new Float32Array(3),n.shore_water_col=new Float32Array(3),n.shallow_water_col_fac=0,n.shore_water_col_fac=0,f.Do&&(n.shallow_water_col.set(r.shallow_water_col),n.shore_water_col.set(r.shore_water_col),n.shallow_water_col_fac=r.shallow_water_col_fac,n.shore_water_col_fac=r.shore_water_col_fac),n.norm_uv_velocity=r.hl,n.water_dynamic=f.water_dynamic&&r.water_dynamic&&!!parseFloat(a.$c(r,"DYNAMIC")[1]),n.sss_strength=parseFloat(a.$c(r,"SSS_STRENGTH")[1]),n.sss_width=parseFloat(a.$c(r,"SSS_WIDTH")[1]),n.waves_height=parseFloat(a.$c(r,"WAVES_HEIGHT")[1]),n.waves_length=parseFloat(a.$c(r,"WAVES_LENGTH")[1]),n.dst_noise_scale0=parseFloat(a.$c(r,"DST_NOISE_SCALE_0")[1]),n.dst_noise_scale1=parseFloat(a.$c(r,"DST_NOISE_SCALE_1")[1]),n.dst_noise_freq0=parseFloat(a.$c(r,"DST_NOISE_FREQ_0")[1]),n.dst_noise_freq1=parseFloat(a.$c(r,"DST_NOISE_FREQ_1")[1]),n.dir_min_shore_fac=parseFloat(a.$c(r,"DIR_MIN_SHR_FAC")[1]),n.dir_freq=parseFloat(a.$c(r,"DIR_FREQ")[1]),n.dir_noise_scale=parseFloat(a.$c(r,"DIR_NOISE_SCALE")[1]),n.dir_noise_freq=parseFloat(a.$c(r,"DIR_NOISE_FREQ")[1]),n.dir_min_noise_fac=parseFloat(a.$c(r,"DIR_MIN_NOISE_FAC")[1]),n.dst_min_fac=parseFloat(a.$c(r,"DST_MIN_FAC")[1]),n.waves_hor_fac=parseFloat(a.$c(r,"WAVES_HOR_FAC")[1]),n},e.set_water_material_params=function(e,t,r){if(i.gb(e)){var n=a.Va(e,t,"MAIN");if(n&&n.wf)if(n.nb)_.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var o=[n];for((n=a.Of(e,t,"MAIN"))&&o.push(n),e=0;e<o.length;e++)n=o[e],"boolean"==typeof r.shore_smoothing&&(f.shore_smoothing&&n.Um&&r.shore_smoothing?a.qb(n,"SHORE_SMOOTHING",1):a.qb(n,"SHORE_SMOOTHING",0)),"number"==typeof r.absorb_factor&&(t=s.R(parseFloat(r.absorb_factor)),a.qb(n,"ABSORB",t)),"number"==typeof r.foam_factor&&f.Jn&&(n.foam_factor=r.foam_factor),f.Do&&("object"==typeof r.shallow_water_col&&n.shallow_water_col.set(r.shallow_water_col),"number"==typeof r.shallow_water_col_fac&&(n.shallow_water_col_fac=r.shallow_water_col_fac),"object"==typeof r.shore_water_col&&n.shore_water_col.set(r.shore_water_col),"number"==typeof r.shore_water_col_fac&&(n.shore_water_col_fac=r.shore_water_col_fac)),"number"==typeof r.norm_uv_velocity&&(n.hl=r.norm_uv_velocity),f.water_dynamic&&n.water_dynamic&&("boolean"==typeof r.water_dynamic&&(r.water_dynamic?a.qb(n,"DYNAMIC",1):a.qb(n,"DYNAMIC",0)),"number"==typeof r.sss_strength&&(t=s.R(parseFloat(r.sss_strength)),a.qb(n,"SSS_STRENGTH",t)),"number"==typeof r.sss_width&&(t=s.R(parseFloat(r.sss_width)),a.qb(n,"SSS_WIDTH",t)),"number"==typeof r.waves_height&&(t=s.R(parseFloat(r.waves_height)),a.qb(n,"WAVES_HEIGHT",t)),"number"==typeof r.waves_length&&(t=s.R(parseFloat(r.waves_length)),a.qb(n,"WAVES_LENGTH",t)),"number"==typeof r.dst_noise_scale0&&(t=s.R(parseFloat(r.dst_noise_scale0)),a.qb(n,"DST_NOISE_SCALE_0",t)),"number"==typeof r.dst_noise_scale1&&(t=s.R(parseFloat(r.dst_noise_scale1)),a.qb(n,"DST_NOISE_SCALE_1",t)),"number"==typeof r.dst_noise_freq0&&(t=s.R(parseFloat(r.dst_noise_freq0)),a.qb(n,"DST_NOISE_FREQ_0",t)),"number"==typeof r.dst_noise_freq1&&(t=s.R(parseFloat(r.dst_noise_freq1)),a.qb(n,"DST_NOISE_FREQ_1",t)),"number"==typeof r.dir_min_shore_fac&&(t=s.R(parseFloat(r.dir_min_shore_fac)),a.qb(n,"DIR_MIN_SHR_FAC",t)),"number"==typeof r.dir_freq&&(t=s.R(parseFloat(r.dir_freq)),a.qb(n,"DIR_FREQ",t)),"number"==typeof r.dir_noise_scale&&(t=s.R(parseFloat(r.dir_noise_scale)),a.qb(n,"DIR_NOISE_SCALE",t)),"number"==typeof r.dir_noise_freq&&(t=s.R(parseFloat(r.dir_noise_freq)),a.qb(n,"DIR_NOISE_FREQ",t)),"number"==typeof r.dir_min_noise_fac&&(t=s.R(parseFloat(r.dir_min_noise_fac)),a.qb(n,"DIR_MIN_NOISE_FAC",t)),"number"==typeof r.dst_min_fac&&(t=s.R(parseFloat(r.dst_min_fac)),a.qb(n,"DST_MIN_FAC",t)),"number"==typeof r.waves_hor_fac&&(t=s.R(parseFloat(r.waves_hor_fac)),a.qb(n,"WAVES_HOR_FAC",t))),a.zc(n),l.BG(n)}else _.error('set_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material.")}else _.error('set_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.')},e.set_line_params=function(e,t){if(i.is_line(e)){var r=a.ou(e);r?(c.Ud(t.color)&&r.ud.set(t.color),c.Ud(t.width)&&(r.jm=t.width)):_.error("set_line_params(): Couldn't set line parameters!")}else _.error('set_line_params(): Object "'+e.name+'" is not a LINE object.')},e.get_line_params=function(e){return i.is_line(e)?(e=a.ou(e),e?{color:new Float32Array(e.ud),width:e.jm}:(_.error("get_line_params(): Couldn't get line parameters!"),null)):(_.error('get_line_params(): Object "'+e.name+'" is not a LINE object.'),null)},e.set_nodemat_value=function(e,t,r){var n=i.gb(e),s=i.is_world(e),c=s?o.xu(e):e.name;if(n||s){if(n){var f=t[0],u=1,d=a.au(e,f);if(!d)return void _.error('set_nodemat_value(): Material "'+f+'" wasn\'t found on the object "'+c+'".')}else if(s&&(n=l.get_active(),f="",u=0,!(d=a.Mq(e,n))))return void _.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+c+'".');u=o.$h(d.lf,t,u),null===u?_.error('set_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+c+'".'):o.set_nodemat_value(e,f,u,r)}else _.error('set_nodemat_value(): Object "'+c+'" is not a dynamic MESH or WORLD.')},e.get_nodemat_value=function(e,t){var r=i.gb(e),n=i.is_world(e),s=n?o.xu(e):e.name;if(!r&&!n)return _.error('get_nodemat_value(): Object "'+s+'" is not a dynamic MESH or WORLD.'),0;if(r){var r=t[0],c=1,f=a.au(e,r);if(!f)return _.error('get_nodemat_value(): Material "'+r+'" wasn\'t found on the object "'+s+'".'),0}else if(n&&(f=l.get_active(),c=0,!(f=a.Mq(e,f))))return _.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+s+'".'),0;return c=o.$h(f.lf,t,c),null===c?(_.error('get_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+s+'".'),0):o.get_nodemat_value(f,c)},e.set_nodemat_rgb=function(e,t,r,n,s){var c=i.gb(e),f=i.is_world(e),u=f?o.xu(e):e.name;if(c||f){if(c){var d=t[0],p=1,m=a.au(e,d);if(!m)return void _.error('set_nodemat_rgb(): Material "'+d+'" wasn\'t found on the object "'+u+'".')}else if(f&&(c=l.get_active(),d="",p=0,!(m=a.Mq(e,c))))return void _.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+u+'".');p=o.$h(m.kf,t,p),null===p?_.error('set_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+u+'".'):o.set_nodemat_rgb(e,d,p,r,n,s)}else _.error('set_nodemat_rgb(): Object "'+u+'" is not a dynamic MESH or WORLD.')},e.get_nodemat_rgb=function(e,t,r){var n=i.gb(e),s=i.is_world(e),c=s?o.xu(e):e.name;if(!n&&!s)return _.error('get_nodemat_rgb(): Object "'+c+'" is not a dynamic MESH or WORLD.'),null;if(n){var n=t[0],f=1,u=a.au(e,n);if(!u)return _.error('get_nodemat_rgb(): Material "'+n+'" wasn\'t found on the object "'+c+'".'),null}else if(s&&(u=l.get_active(),f=0,!(u=a.Mq(e,u))))return _.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+c+'".'),null;return null===(e=o.$h(u.kf,t,f))?(_.error('get_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+c+'".'),null):(r||(r=new Float32Array(3)),o.get_nodemat_rgb(u,e,r))},e.is_node_material=function(e,t){if(!i.gb(e))return _.error('is_node_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var r=a.Va(e,t,"MAIN");return r?r.nb:(_.error('is_node_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)},e.is_water_material=function(e,t){if(!i.gb(e))return _.error('is_water_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var r=a.Va(e,t,"MAIN");return r?r.wf&&!r.nb:(_.error('is_water_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)}},a.module.math=function(e,t){var a=t("__vec3"),r=t("__util"),n=t("__math"),o=new Float32Array(3);e.create_pline_from_points=function(e,t){var r=new Float32Array(6);return n.set_pline_initial_point(r,e),a.subtract(t,e,o),n.set_pline_directional_vec(r,o),r},e.create_pline_from_point_vec=function(e,t){var a=new Float32Array(6);return n.set_pline_initial_point(a,e),n.set_pline_directional_vec(a,t),a},e.create_pline=function(){return new Float32Array(6)},e.get_pline_directional_vec=n.get_pline_directional_vec,e.get_pline_initial_point=n.get_pline_initial_point,e.set_pline_initial_point=n.set_pline_initial_point,e.set_pline_directional_vec=n.set_pline_directional_vec,e.line_plane_intersect=r.line_plane_intersect,e.calc_pline_point=n.calc_pline_point,e.point_plane_dist=n.point_plane_dist,e.linear_tween=n.linear_tween,e.ease_in_quad=n.ease_in_quad,e.ease_out_quad=n.ease_out_quad,e.ease_in_out_quad=n.ease_in_out_quad,e.ease_in_cubic=n.ease_in_cubic,e.ease_out_cubic=n.ease_out_cubic,e.ease_in_out_cubic=n.ease_in_out_cubic,e.ease_in_quart=n.ease_in_quart,e.ease_out_quart=n.ease_out_quart,e.ease_in_out_quart=n.ease_in_out_quart,e.ease_in_quint=n.ease_in_quint,e.ease_out_quint=n.ease_out_quint,e.ease_in_out_quint=n.ease_in_out_quint,e.ease_in_sine=n.ease_in_sine,e.ease_out_sine=n.ease_out_sine,e.ease_in_out_sine=n.ease_in_out_sine,e.ease_in_expo=n.ease_in_expo,e.ease_out_expo=n.ease_out_expo,e.ease_in_out_expo=n.ease_in_out_expo,e.ease_in_circ=n.ease_in_circ,e.ease_out_circ=n.ease_out_circ,e.ease_in_out_circ=n.ease_in_out_circ,e.ease_in_elastic=n.ease_in_elastic,e.ease_out_elastic=n.ease_out_elastic,e.ease_in_out_elastic=n.ease_in_out_elastic,e.ease_in_back=n.ease_in_back,e.ease_out_back=n.ease_out_back,e.ease_in_out_back=n.ease_in_out_back,e.ease_in_bounce=n.ease_in_bounce,e.ease_out_bounce=n.ease_out_bounce,e.ease_in_out_bounce=n.ease_in_out_bounce},a.module.particles=function(e,t){var a=t("__particles"),r=t("__print");e.set_size=function(e,t,n){a.Zz(e,t)?a.set_size(e,t,n):r.error('set_size(): Object "'+e.name+'" has not a particle system named "'+t+'"')},e.set_normal_factor=function(e,t,n){a.Zz(e,t)?a.set_normal_factor(e,t,n):r.error('set_normal_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"')},e.set_factor=function(e,t,n){a.Zz(e,t)?(n=Math.min(n,1),n=Math.max(n,0),a.set_factor(e,t,n)):r.error('set_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"')}},a.module.physics=function(e,t){function a(e,t,a,r){return i.oO(e,r[a[0]],r[a[1]],r[a[2]])}function r(e,t,a,r,n){return t=Math.abs(e[2]-t[2]),t<n&&_.KQ(e,a,r)?t:Number.MAX_VALUE}var n=t("__physics"),o=t("__print"),i=t("__util"),_=t("__navmesh");e.CM_WALK=0,e.CM_RUN=1,e.CM_CLIMB=2,e.CM_FLY=3,e.enable_simulation=function(e){n.na(e)?n.enable_simulation(e):o.da("No physics for object "+e.name)},e.disable_simulation=function(e){n.na(e)?n.disable_simulation(e):o.da("No physics for object "+e.name)},e.has_physics=function(e){return n.na(e)},e.has_simulated_physics=function(e){return n.has_simulated_physics(e)},e.has_dynamic_physics=function(e){return n.has_dynamic_physics(e)},e.set_gravity=function(e,t){n.na(e)?n.set_gravity(e,t):o.da("No physics for object "+e.name)},e.set_transform=function(e,t,a){n.na(e)?n.set_transform(e,t,a):o.da("No physics for object "+e.name)},e.sync_transform=function(e){n.na(e)?n.sync_transform(e):o.da("No physics for object "+e.name)},e.apply_velocity=function(e,t,a,r){n.na(e)?n.apply_velocity(e,t,a,r):o.da("No physics for object "+e.name)},e.apply_velocity_world=function(e,t,a,r){n.na(e)?n.apply_velocity_world(e,t,a,r):o.da("No physics for object "+e.name)},e.apply_force=function(e,t,a,r){n.na(e)?n.apply_force(e,t,a,r,!1):o.da("No physics for object "+e.name)},e.apply_force_world=function(e,t,a,r){n.na(e)?n.apply_force(e,t,a,r,!0):o.da("No physics for object "+e.name)},e.apply_torque=function(e,t,a,r){n.na(e)?n.apply_torque(e,t,a,r):o.da("No physics for object "+e.name)},e.set_angular_velocity=function(e,t,a,r){n.na(e)?n.set_angular_velocity(e,t,a,r):o.da("No physics for object "+e.name)},e.vehicle_throttle=function(e,t){n.na(e)?(n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),n.vehicle_throttle(e,i.clamp(t,-1,1))):o.da("No physics for object "+e.name)},e.vehicle_throttle_inc=function(e,t,a){if(n.na(e)){n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),t=i.clamp(t,0,1);var r=e.J.En;-1==a||1==a?r=Math.max(-1,Math.min(r+a*t,1)):!a&&0<=r?r=Math.max(0,r-t):!a&&0>r?r=Math.min(0,r+t):o.error("Wrong steering direction"),n.vehicle_throttle(e,i.clamp(r,-1,1))}else o.da("No physics for object "+e.name)},e.vehicle_steer=function(e,t){n.na(e)?(n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),n.vehicle_steer(e,i.clamp(t,-1,1))):o.da("No physics for object "+e.name)},e.vehicle_steer_inc=function(e,t,a){if(n.na(e)){n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),t=i.clamp(t,0,1);var r=e.J.Qo;-1==a||1==a?r=Math.max(-1,Math.min(r+a*t,1)):!a&&0<=r?r=Math.max(0,r-t):!a&&0>r?r=Math.min(0,r+t):o.error("Wrong steering direction"),n.vehicle_steer(e,i.clamp(r,-1,1))}else o.da("No physics for object "+e.name)},e.vehicle_brake=function(e,t){n.na(e)?(n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),n.vehicle_brake(e,i.clamp(t,0,1))):o.da("No physics for object "+e.name)},e.vehicle_brake_inc=function(e,t){if(n.na(e)){n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)||o.error("Wrong object"),t=i.clamp(t,-1,1);var a=e.J.Pp;n.vehicle_brake(e,i.clamp(a+a*t,0,1))}else o.da("No physics for object "+e.name)},e.is_vehicle_chassis=function(e){return n.is_vehicle_chassis(e)},e.is_vehicle_hull=function(e){return n.is_vehicle_hull(e)},e.get_vehicle_name=function(e){return n.na(e)?n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)?e.tf.name:(o.error("Wrong object"),null):(o.da("No physics for object "+e.name),null)},e.get_vehicle_throttle=function(e){return n.na(e)?n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)?e.J.En:(o.error("Wrong object"),null):(o.da("No physics for object "+e.name),null)},e.get_vehicle_steering=function(e){return n.na(e)?n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)?e.J.Qo:(o.error("Wrong object"),0):(o.da("No physics for object "+e.name),0)},e.get_vehicle_brake=function(e){return n.na(e)?n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)?e.J.Pp:(o.error("Wrong object"),0):(o.da("No physics for object "+e.name),0)},e.get_vehicle_speed=function(e){return n.na(e)?n.is_vehicle_chassis(e)||n.is_vehicle_hull(e)?n.get_vehicle_speed(e):(o.error("Wrong object"),0):(o.da("No physics for object "+e.name),0)},e.is_character=function(e){return n.VE(e)},e.set_character_move_dir=function(e,t,a){n.na(e)?n.set_character_move_dir(e,t,a):o.da("No physics for object "+e.name)},e.set_character_move_type=function(e,t){n.na(e)?n.set_character_move_type(e,t):o.da("No physics for object "+e.name)},e.set_character_walk_velocity=function(e,t){n.na(e)?n.set_character_walk_velocity(e,t):o.da("No physics for object "+e.name)},e.set_character_run_velocity=function(e,t){n.na(e)?n.set_character_run_velocity(e,t):o.da("No physics for object "+e.name)},e.set_character_fly_velocity=function(e,t){n.na(e)?n.set_character_fly_velocity(e,t):o.da("No physics for object "+e.name)},e.character_jump=function(e){n.na(e)?n.character_jump(e):o.da("No physics for object "+e.name)},e.character_rotation_inc=function(e,t,a){n.na(e)?n.character_rotation_inc(e,t,a):o.da("No physics for object "+e.name)},e.set_character_rotation=function(e,t,a){n.na(e)?n.set_character_rotation(e,t,a):o.da("No physics for object "+e.name)},e.set_character_rotation_v=function(e,t){n.na(e)?n.set_character_rotation_v(e,t):o.da("No physics for object "+e.name)},e.set_character_rotation_h=function(e,t){n.na(e)?n.set_character_rotation_h(e,t):o.da("No physics for object "+e.name)},e.append_collision_test=function(e,t,a,r){n.na(e)?n.append_collision_test(e,t||"ANY",a,r||!1):o.da("No physics for object "+e.name)},e.remove_collision_test=function(e,t,a){n.na(e)?n.remove_collision_test(e,t||"ANY",a):o.da("No physics for object "+e.name)},e.apply_collision_impulse_test=function(e,t){n.na(e)?n.apply_collision_impulse_test(e,t):o.da("No physics for object "+e.name)},e.clear_collision_impulse_test=function(e){n.na(e)?n.clear_collision_impulse_test(e):o.da("No physics for object "+e.name)},e.append_ray_test=function(e,t,a,r,i,_){return e=e||null,null==e||n.na(e)?n.append_ray_test(e,t,a,r||"ANY",i,_||!1,!1,!1,!1):(o.da("No physics for object "+e.name),0)},e.append_ray_test_ext=function(e,t,a,r,i,_,s,c,l){return e=e||null,null==e||n.na(e)?n.append_ray_test(e,t,a,r||"ANY",i,_||!1,s||!1,c||!1,l||!1):(o.da("No physics for object "+e.name),0)},e.remove_ray_test=function(e){n.rF(e)?n.remove_ray_test(e):o.error("Wrong ray test ID")},e.change_ray_test_from_to=function(e,t,a){n.rF(e)?n.change_ray_test_from_to(e,t,a):o.error("Wrong ray test ID")},e.apply_constraint=function(e,t,a,r,i,_,s,c,l,f){n.na(t)&&n.na(i)?n.apply_constraint(e,t,a,r,i,_,s,c,l,f):o.error("Wrong objects")},e.clear_constraint=function(e){n.na(e)&&n.iQ(e)?n.clear_constraint(e):o.error("Wrong object")},e.pull_to_constraint_pivot=function(e,t,a,r,i,_){n.na(e)&&n.na(r)?n.pull_to_constraint_pivot(e,t,a,r,i,_):o.error("Wrong objects")},e.navmesh_get_island=function(e,t,r){if(r||(r=a),n.na(e)){var i=e.I.fr;return i?_.navmesh_get_island(i,t,r):(o.error(e.name+" is not a navigation mesh object"),null)}o.da("No physics for object "+e.name)},e.navmesh_find_path=function(e,t,i,s){if(n.na(e)){var c=e.I.fr;return c?(s=s||{},e={},e.do_not_pull_string=!!s.do_not_pull_string,e.distance_to_closest=s.distance_to_closest||a,e.distance_to_farthest=s.distance_to_farthest||r,e.island=s.island||0,e.allowed_distance=s.allowed_distance||Number.MAX_VALUE,e.return_normals=s.return_normals||!1,_.navmesh_find_path(c,t,i,e)):(o.error(e.name+" is not a navigation mesh object"),null)}o.da("No physics for object "+e.name)}},a.module.rgb=function(e,t){var a=t("__util"),r=new Float32Array(3);e.create=function(){return new Float32Array(3)},e.from_values=function(e,t,a){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=a,r},e.set=function(e,t,a,r){return r[0]=e,r[1]=t,r[2]=a,r},e.css_to_rgb=function(e,t,r,n){return n=n||new Float32Array(3),n[0]=e/255,n[1]=t/255,n[2]=r/255,a.AH(n,n),n},e.rgb_to_css=function(e){return e=a.zz(e,r),[Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])]},e.rgb_to_css_hex=function(e){function t(e){return e=Math.round(255*e).toString(16),1==e.length?"0"+e:e}return e=a.zz(e,r),"#"+t(e[0])+t(e[1])+t(e[2])}},a.module.rgba=function(e,t){var a=t("__util"),r=new Float32Array(3);e.create=function(){var e=new Float32Array(4);return e[3]=1,e},e.from_values=function(e,t,a,r){var n=new Float32Array(4);return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n},e.set=function(e,t,a,r,n){return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n},e.css_to_rgba=function(e,t,r,n,o){return o=o||new Float32Array(4),o[0]=e/255,o[1]=t/255,o[2]=r/255,o[3]=n,a.AH(o,o),o},e.rgba_to_css=function(e){var t=a.zz(e,r);return[Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2]),e[3]]}},a.module.scenes=function(e,t){function a(){var e=i.get_canvas();return c.pick_object(e.clientWidth/2,e.clientHeight/2)}function r(e){return l.gb(e)||l.is_empty(e)||l.is_line(e)||l.is_lamp(e)}var n=t("__batch"),o=t("__camera"),i=t("__container"),_=t("__data"),s=t("__graph"),c=t("__objects"),l=t("__obj_util"),f=t("__print"),u=t("__scenes"),d=t("__scenegraph"),p=t("__subscene"),m=t("__util");e.DATA_ID_ALL=c.DATA_ID_ALL,e.set_active=function(e){var t=u.Lq();u.set_active(m.keysearch("name",e,t))},e.get_active=function(){return u.Fa()?u.get_active().name:""},e.get_scenes=function(){for(var e=u.Lq(),t=[],a=0;a<e.length;a++)t.push(e[a].name);return t},e.get_active_camera=function(){return u.Fa()?u.gk(u.get_active()):(f.error("No active scene"),!1)},e.get_object_by_name=function(e,t){var a=c.lc(c.tx,e,0|t,!0);if(a)return a;f.error("get object "+e+": not found")},e.get_object_by_dupli_name=function(e,t,a){if(e=c.lc(c.sx,e,t,0|a))return e;f.error("get object "+t+": not found")},e.get_object_by_dupli_name_list=function(e,t){var a=c.lc(c.Ac,e,0|t);if(a)return a;f.error("get object "+e+": not found")},e.get_world_by_name=function(e,t){var a=c.get_world_by_name(e,0|t);if(a)return a;f.error("get object "+e+": not found")},e.get_object_data_id=function(e){return l.get_object_data_id(e)},e.pick_object=function(e,t){var r=u.jh();return r?(r=u.Ib(r,p.jg))&&r.enable_hmd_stereo?(f.da("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),a()):c.pick_object(e,t):(f.error("No active scene"),null)},e.pick_center=a,e.outlining_is_enabled=function(e){return e&&e.o&&e.o.Oc},e.set_outline_intensity=function(e,t){e&&e.o&&e.o.Oc?c.set_outline_intensity(e,t):f.error("set_outline_intensity(): wrong object")},e.get_outline_intensity=function(e){return e&&e.o&&e.o.Oc?e.o.sh:(f.error("get_outline_intensity(): wrong object"),0)},e.apply_outline_anim=function(e,t,a,r){e&&e.o&&e.o.Oc?c.apply_outline_anim(e,t,a,r):f.error("apply_outline_anim(): wrong object")},e.apply_outline_anim_def=function(e){if(e&&e.o&&e.o.Oc){var t=e.o.ki;c.apply_outline_anim(e,t.Bk,t.Ck,t.Dk)}else f.error("apply_outline_anim_def(): wrong object")},e.clear_outline_anim=function(e){e&&e.o&&e.o.Oc?c.clear_outline_anim(e):f.error("clear_outline_anim(): wrong object")},e.set_outline_color=u.set_outline_color,e.get_outline_color=function(e){var t=u.get_active();if(t=u.Ib(t,p.$m))return e=e||new Float32Array(3),e.set(t.rh),e},e.set_hmd_params=function(e){u.Fa()?e&&(!e.distortion_coefs||e.distortion_coefs instanceof Array||(e.distortion_coefs=null),!e.chromatic_aberration_coefs||e.chromatic_aberration_coefs instanceof Array||(e.chromatic_aberration_coefs=null),"number"!=typeof e.base_line_factor&&(e.base_line_factor=null),"number"!=typeof e.inter_lens_factor&&(e.inter_lens_factor=null),"boolean"!=typeof e.enable_hmd_stereo&&(e.enable_hmd_stereo=null),u.set_hmd_params(e)):f.error("No active scene")},e.get_shadow_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active(),t=u.Ib(e,p.ld);if(!t)return null;var a=e.G.Pc,r=u.Ib(e,p.Gb),n=u.Ib(e,p.Cf),o={};return o.csm_resolution=a.csm_resolution,o.self_shadow_polygon_offset=t.self_shadow_polygon_offset,n&&(o.self_shadow_normal_offset=n.self_shadow_normal_offset),o.enable_csm=a.enable_csm,o.csm_num=a.csm_num,o.csm_first_cascade_border=a.csm_first_cascade_border,o.first_cascade_blur_radius=a.first_cascade_blur_radius,o.csm_last_cascade_border=a.csm_last_cascade_border,o.last_cascade_blur_radius=a.last_cascade_blur_radius,o.fade_last_cascade=a.fade_last_cascade,o.blend_between_cascades=a.blend_between_cascades,a.enable_csm?(o.csm_borders=u.AP(e,r.B),o.blur_radii=new Float32Array(a.csm_num),o.blur_radii.set(r.B.uo.subarray(0,a.csm_num))):(o.csm_borders=null,o.blur_radii=null),o},e.set_shadow_params=function(e){if(u.Fa()){var t=u.get_active();"number"==typeof e.self_shadow_polygon_offset&&s.X(t.G.va,function(t,a){a.type==p.ld&&(a.self_shadow_polygon_offset=e.self_shadow_polygon_offset)});for(var a=u.eg(t,[p.Cf]),r=0;r<a.length;r++){var i=a[r];"number"==typeof e.self_shadow_normal_offset&&(i.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(i.pcf_blur_radius=e.pcf_blur_radius)}for(a=u.eg(t,[p.Sc]),r=0;r<a.length;r++){var _=a[r];"number"==typeof e.self_shadow_normal_offset&&(_.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(_.pcf_blur_radius=e.pcf_blur_radius),_.Ea=!0}if(a=t.G.Pc,"number"==typeof e.csm_first_cascade_border&&(a.csm_first_cascade_border=e.csm_first_cascade_border),"number"==typeof e.first_cascade_blur_radius&&(a.first_cascade_blur_radius=e.first_cascade_blur_radius),"number"==typeof e.csm_last_cascade_border&&(a.csm_last_cascade_border=e.csm_last_cascade_border),"number"==typeof e.last_cascade_blur_radius&&(a.last_cascade_blur_radius=e.last_cascade_blur_radius),i){for(_=i.Pa,r=0;r<_.length;r++)for(var c=_[r].Ca,d=0;d<c.length;d++){var m=c[d];if(m.Yf.Gd){var g=m.ra;n.EC(g,a),n.zc(g),p.Ic(i,m)}}i.Ea=!0}for(i=l.ya(t.Bi,t).ba,r=0;r<i.length;r++)o.sB(i[r],a);u.EA(t)}else f.error("No active scene")},e.get_environment_colors=function(){if(!u.Fa())return f.error("No active scene"),[];var e=u.get_active();return u.get_environment_colors(e)},e.set_environment_colors=function(e,t,a){if(u.Fa()){var r=u.get_active(),n=u.Ib(r,p.Gb);u.set_environment_colors(r,e||0==e?parseFloat(e):n.Nf,t||0==t?t:n.yd,a||0==a?a:n.Ld)}else f.error("No active scene")},e.get_fog_color_density=function(e){if(!u.Fa())return f.error("No active scene"),!1;var t=u.get_active();return u.get_fog_color_density(t,e)},e.set_fog_color_density=function(e){if(u.Fa()){var t=u.get_active();u.set_fog_color_density(t,e)}else f.error("No active scene")},e.get_fog_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active(),t={};return t.fog_intensity=u.JP(e),t.fog_depth=u.HP(e),t.fog_start=u.KP(e),t.fog_height=u.IP(e),t},e.set_fog_params=function(e){if(u.Fa()){var t=u.get_active();"number"==typeof e.fog_intensity&&u.XG(t,e.fog_intensity),"number"==typeof e.fog_depth&&u.VG(t,e.fog_depth),"number"==typeof e.fog_start&&u.YG(t,e.fog_start),"number"==typeof e.fog_height&&u.WG(t,e.fog_height)}else f.error("No active scene")},e.get_ssao_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.get_ssao_params(e)},e.set_ssao_params=function(e){if(u.Fa()){var t=u.get_active(),a=u.eg(t,[p.Ds]),t=u.eg(t,[p.zx]);if(!a.length)return f.error("SSAO is not enabled on the scene"),0;for(var r=0;r<a.length;r++){var o=a[r],i=t[r],_=e,s=u.get_active(),c=o.Pa[0].Ca[0],l=c.ra,m=i.Pa[0].Ca[0],g=m.ra;if("quality"in _){var h=_.quality;8===h||16===h||24===h||32===h?(o.Dm=h,n.qb(l,"SSAO_QUALITY","SSAO_QUALITY_"+h),n.zc(l),p.Ic(o,c)):f.error('set_ssao_params(): Wrong "quality" value.')}if("use_hemisphere"in _&&(o.No=_.use_hemisphere,n.qb(l,"SSAO_HEMISPHERE",0|_.use_hemisphere),n.zc(l),p.Ic(o,c)),"use_blur_depth"in _&&(i.Ko=_.use_blur_depth,n.qb(g,"SSAO_BLUR_DEPTH",0|_.use_blur_depth),n.zc(g),p.Ic(i,m),d.Dl(s.G.va,i,g)),"ssao_white"in _&&(o.ssao_white=_.ssao_white,n.qb(l,"SSAO_WHITE",0|_.ssao_white),n.zc(l),p.Ic(o,c)),"blur_discard_value"in _&&(i.Lo=_.blur_discard_value),"radius_increase"in _&&(o.Po=_.radius_increase),"influence"in _&&(o.Oo=_.influence),"dist_factor"in _&&(o.Mo=_.dist_factor),"boolean"==typeof _.ssao_only){for(s=u.Ib(s,p.Gb),s.ssao_only=_.ssao_only,c=s.Pa,l=[],m=0;m<c.length;m++)for(g=c[m].Ca,h=0;h<g.length;h++){var v=g[h].ra;n.qb(v,"SSAO_ONLY",0|_.ssao_only),n.zc(v),l.push(g[h])}for(m=0;m<l.length;m++)p.Ic(s,l[m])}o.Ea=!0,i.Ea=!0}}else f.error("No active scene")},e.get_color_correction_params=function(){if(!u.Fa())return f.error("No active scene"),null;var e=u.get_active(),e=u.Ib(e,p.nx);if(!e)return null;var t={};return t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t},e.set_color_correction_params=function(e){if(u.Fa()){var t=u.get_active();(t=u.Ib(t,p.nx))&&("brightness"in e&&(t.brightness=e.brightness),"contrast"in e&&(t.contrast=e.contrast),"exposure"in e&&(t.exposure=e.exposure),"saturation"in e&&(t.saturation=e.saturation),t.Ea=!0)}else f.error("No active scene")},e.get_sky_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.get_sky_params(e)},e.set_sky_params=function(e){if(u.Fa()){var t=u.get_active(),a=u.Ib(t,p.ae);a&&("color"in e&&a.Ok.set(e.color),"rayleigh_brightness"in e&&(a.rayleigh_brightness=e.rayleigh_brightness),"mie_brightness"in e&&(a.mie_brightness=e.mie_brightness),"spot_brightness"in e&&(a.spot_brightness=e.spot_brightness),"scatter_strength"in e&&(a.scatter_strength=e.scatter_strength),"rayleigh_strength"in e&&(a.rayleigh_strength=e.rayleigh_strength),"mie_strength"in e&&(a.mie_strength=e.mie_strength),"rayleigh_collection_power"in e&&(a.rayleigh_collection_power=e.rayleigh_collection_power),"mie_collection_power"in e&&(a.mie_collection_power=e.mie_collection_power),"mie_distribution"in e&&(a.mie_distribution=e.mie_distribution),a.Ea=!0,a.jo=!0,u.ZU(t,a))}else f.error("No active scene")},e.get_dof_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.Ib(e,p.pp)?u.get_dof_params(e):null},e.set_dof_params=function(e){if(u.Fa()){var t=u.get_active();u.set_dof_params(t,e)}else f.error("No active scene")},e.get_god_rays_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.Ib(e,p.Zm)?u.get_god_rays_params(e):null},e.set_god_rays_params=function(e){if(u.Fa()){var t=u.get_active();u.set_god_rays_params(t,e)}else f.error("No active scene")},e.get_bloom_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.Ib(e,p.lp)?u.get_bloom_params(e):null},e.set_bloom_params=function(e){if(u.Fa()){var t=u.get_active();u.set_bloom_params(t,e)}else f.error("No active scene")},e.get_glow_material_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.Ib(e,p.qp)?u.get_glow_material_params(e):null},e.set_glow_material_params=function(e){if(u.Fa()){var t=u.get_active();u.set_glow_material_params(t,e)}else f.error("No active scene")},e.get_wind_params=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.get_wind_params(e)},e.set_wind_params=function(e){if(u.Fa()){var t=u.get_active();c.set_wind_params(t,e)}else f.error("No active scene")},e.get_water_surface_level=function(e,t){if(!u.Fa())return f.error("No active scene"),0;var a=u.get_active();return a.G.hd?u.get_water_surface_level(a,e,t):(f.error("No water parameters on the active scene"),0)},e.set_water_params=function(e){if(u.Fa()){var t=u.get_active();u.set_water_params(t,e)}else f.error("No active scene")},e.get_water_mat_params=function(e){if(u.Fa()){var t=u.get_active();u.get_water_mat_params(t,e)}else f.error("No active scene")},e.update_scene_materials_params=function(){if(u.Fa()){var e=u.get_active();u.iI(e)}else f.error("No active scene")},e.hide_object=function(e,t){t=t||!1,r(e)?t?u.Wp(e,!0):u.Xp(e,!0):f.error("show/hide is only supported for dynamic objects.")},e.show_object=function(e,t){t=t||!1,r(e)?t?u.Wp(e,!1):u.Xp(e,!1):f.error("show/hide is only supported for dynamic objects.")},e.is_hidden=function(e){return r(e)?u.is_hidden(e):(f.error("show/hide is only supported for dynamic meshes/empties and lamps"),!1)},e.is_visible=function(e){return e.o.is_visible},e.check_object_by_name=function(e,t){return!!c.lc(c.tx,e,0|t,!0)},e.check_object_by_dupli_name=function(e,t,a){return!!c.lc(c.sx,e,t,0|a)},e.check_object_by_dupli_name_list=function(e,t){return!!c.lc(c.Ac,e,0|t)},e.get_all_objects=function(e,t){var a=u.get_active();return e||(e="ALL"),t||0===t||(t=c.DATA_ID_ALL),c.KE(a,e,t)},e.get_object_name=function(e){return e?e.qd:(f.error("Wrong object name"),"")},e.get_object_name_hierarchy=function(e){if(!e)return f.error("Wrong object name"),null;for(var t=[];e;)t.push(e.qd),e=l.get_dg_parent(e);return t.reverse()},e.get_object_type=function(e){return e&&e.type?e.type:(f.error("Wrong object"),"UNDEFINED")},e.get_object_children=function(e){return e.Ze.slice(0)},e.get_first_character=function(){return c.get_first_character(u.get_active())},e.get_shore_dist=function(e,t){if(t||0===t||(t=1),!u.Fa())return f.error("No active scene"),0;var a=u.get_active();return u.get_shore_dist(a,e,t)},e.get_cam_water_depth=function(){return u.get_cam_water_depth()},e.get_type_mesh_object=function(e){return l.is_mesh(e)?e.o.type:""},e.get_meta_tags=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.get_meta_tags(e)},e.get_custom_prop=function(){if(!u.Fa())return f.error("No active scene"),!1;var e=u.get_active();return u.get_custom_prop(e)},e.append_object=function(e,t){if(t)var a=u.Lq(),a=m.keysearch("name",t,a);else a=u.get_active();u.append_object(a,e,!0)},e.remove_object=function(e){l.gb(e)||l.is_empty(e)||l.is_line(e)?(c.qo(e,e.o.Su,!1,!1),_.tG(e),c.qo(e,!0,!0,!0),c.remove_object(e)):f.error("Can't remove object \""+e.name+'". It must be dynamic and type of MESH or EMPTY.')},e.marker_frame=function(e){var t=u.get_active();return t.timeline_markers&&e in t.timeline_markers?u.marker_frame(t,e):(f.error('"'+e+'" marker not found.'),0)},e.get_mb_params=function(){var e=u.get_active();return(e=u.Ib(e,p.Ih))?{mb_factor:e.mb_factor,mb_decay_threshold:e.mb_decay_threshold}:null},e.set_mb_params=function(e){var t=u.get_active(),t=u.eg(t,[p.Ih]);if(t.length)for(var a=0;a<t.length;a++){var r=t[a];"number"==typeof e.mb_decay_threshold&&(r.mb_decay_threshold=e.mb_decay_threshold),"number"==typeof e.mb_factor&&(r.mb_factor=e.mb_factor)}else f.error("The motion blur subscene doesn't exist.")},e.can_select_objects=function(){var e=u.get_active();return!!u.Ib(e,p.we)}},a.module.screen=function(e,t){function a(){}function r(){}function n(e,t,a){function r(){document.fullscreenElement===e||document.webkitFullscreenElement===e||document.mozFullScreenElement===e||document.webkitIsFullScreen||document.msFullscreenElement===e?t():(document.removeEventListener("fullscreenchange",r,!1),document.removeEventListener("webkitfullscreenchange",r,!1),document.removeEventListener("mozfullscreenchange",r,!1),document.removeEventListener("MSFullscreenChange",r,!1),a())}e=e||s.get_container(),t=t||function(){},a=a||function(){},document.addEventListener("fullscreenchange",r,!1),document.addEventListener("webkitfullscreenchange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),document.addEventListener("MSFullscreenChange",r,!1),e.vA=e.vA||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen,e.vA?e.vA():p.error("B4W App: request fullscreen method is not supported")}function o(){var e=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof e&&p.error("B4W App: exit fullscreen method is not supported"),e.apply(document)}function i(e){var t=f.get_device_by_type_element(f.DEVICE_HMD);if(t&&!b){var a=f.get_value_param(t,f.HMD_WEBVR_TYPE);if(a&f.HMD_WEBVR1_1){var r=t.jd,n=r.getEyeParameters("left"),r=r.getEyeParameters("right");s.resize(2*Math.max(n.renderWidth,r.renderWidth),Math.max(n.renderHeight,r.renderHeight),!1)}else n=s.get_canvas(),n=Math.max(2*n.height,n.width),s.resize(n,n/2,!1);n=f.get_vector_param(t,f.KB,h),r=f.get_vector_param(t,f.LB,v),_.set_hmd_fov(e,n,r,!(a&f.HMD_WEBVR1_1)),n={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0},a&(f.HMD_NON_WEBVR|f.HMD_WEBVR_MOBILE|f.HMD_WEBVR_DESKTOP)&&(n.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],n.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.Vm||(t.Kh&&t.bi&&t.Lh?n.base_line_factor=(t.Kh-t.Lh)/t.bi:t.Lh||(n.base_line_factor=t.Kh/t.bi)),t.kh&&t.il&&!t.Vm&&(n.inter_lens_factor=t.kh/t.il)),E.enabled||m.uv(.5,1),m.set_hmd_params(n),(t=f.get_value_param(t,f.HMD_EYE_DISTANCE))&&(a=m.get_active(),e=d.ya(e,a).ba,_.set_eye_distance(e,t)),m.uS(),b=!0}}var _=t("__camera"),s=t("__container"),c=t("__config"),l=t("__hud"),f=t("__input"),u=t("__main"),d=t("__obj_util"),p=t("__print"),m=t("__scenes"),g=t("__vec4"),h=g.create(),v=g.create(),b=!1,E=c.Jl;e.draw_mixer_strip=l.draw_mixer_strip,e.plot_array=l.plot_array,e.request_fullscreen=n,e.exit_fullscreen=o,e.check_fullscreen=f.check_fullscreen,e.request_fullscreen_hmd=function(e,t,r){if("HMD"!=!c.get("stereo")||"NONE"==c.get("stereo")&&c.get("is_mobile_device")){var o=f.get_device_by_type_element(f.DEVICE_HMD);if(o&&f.get_value_param(o,f.HMD_WEBVR_TYPE)&f.HMD_WEBVR1){var i=o.jd;i&&!i.isPresenting&&(t=t||function(){},r=r||function(){},a=function(){i.isPresenting?t():(window.removeEventListener("vrdisplaypresentchange",a),r())},window.addEventListener("vrdisplaypresentchange",a,!1),i.capabilities.canPresent?(e=s.get_canvas(),i.requestPresent([{source:e}]).then(function(){},function(){p.error("HMD fullscreen request failed.")})):p.error("HMD fullscreen request failed."))}else n(e,t,r)}},e.exit_fullscreen_hmd=function(){if("HMD"!=!c.get("stereo")||"NONE"==c.get("stereo")&&c.get("is_mobile_device")){var e=f.get_device_by_type_element(f.DEVICE_HMD);e&&f.get_value_param(e,f.HMD_WEBVR_TYPE)&f.HMD_WEBVR1?(e=e.jd)&&e.isPresenting&&(e.exitPresent(),s.resize_to_container(!0)):o()}},e.check_fullscreen_hmd=function(){var e=f.get_device_by_type_element(f.DEVICE_HMD),t=f.get_value_param(e,f.HMD_WEBVR_TYPE)&f.HMD_WEBVR1;return!(!e||!(t&&e.jd||!t&&f.check_fullscreen()))},e.request_split_screen=function(e,t){var a=f.get_device_by_type_element(f.DEVICE_HMD);if(!a)return!1;if(b)return!0;if(r=t,m.Fa()){var n=m.gk(m.get_active());n&&(a.ag?(i(n),e&&e()):(f.FS(a),a.Dr=function(){i(n),e&&e()}))}},e.exit_split_screen=function(){var e=f.get_device_by_type_element(f.DEVICE_HMD);return!!(b&&e&&e.ag)&&(m.set_hmd_params({enable_hmd_stereo:!1}),b=!1,r&&r(),m.vS(),E.enabled||m.uv(2,1),s.resize_to_container(!0),!0)},e.shot=function(e,t){e=e||"image/png",u.canvas_data_url(function(t){var a=window.document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=t,a.download="screenshot."+e.split("/")[1],a.click(),document.body.removeChild(a)},e,t||1,!0)}},a.module.sfx=function(e,t){var a=t("__obj_util"),r=t("__scenes"),n=t("__sfx"),o=t("__print");e.play=function(e,t,a){n.play(e,t||0,a||0)},e.play_def=function(e){n.play_def(e)},e.is_playing=function(e){return n.is_playing(e)},e.stop=function(e){n.stop(e)},e.pause=function(e){n.QT(e)},e.resume=function(e){n.ST(e)},e.loop_stop=function(e,t,a){n.loop_stop(e,t||0,a||!1)},e.playrate=function(e,t){n.playrate(e,t)},e.get_playrate=function(e){return n.get_playrate(e)},e.cyclic=function(e,t){n.cyclic(e,t)},e.is_cyclic=function(e){return n.is_cyclic(e)},e.listener_reset_speed=function(){n.listener_stride()},e.listener_stride=function(){n.listener_stride()},e.speaker_reset_speed=function(e){n.speaker_stride(e)},e.speaker_stride=function(e){n.speaker_stride(e)},e.get_volume=function(e){return e&&"object"===typeof e?n.get_volume(e):n.TP()},e.set_volume=function(e,t){e&&"object"===typeof e?n.set_volume(e,t):n.qT(t)},e.mute=function(e,t){e&&"object"===typeof e?n.mute(e,t):n.GR(t)},e.is_muted=function(e){return e&&"object"===typeof e?n.is_muted(e):n.IQ()},e.get_speaker_objects=function(){return n.get_speaker_objects().slice(0)},e.check_active_speakers=n.check_active_speakers,e.set_compressor_params=function(e){n.set_compressor_params(r.get_active(),e)},e.get_compressor_params=function(){return n.get_compressor_params(r.get_active())},e.duck=function(e,t,a){e&&"object"===typeof e?n.duck(e,t,a):n.sO(t,a)},e.unduck=function(e){e&&"object"===typeof e?n.unduck(e):n.rU()},e.apply_playlist=n.apply_playlist,e.clear_playlist=n.clear_playlist,e.detect_audio_container=n.detect_audio_container,e.detect_video_container=n.detect_video_container,e.set_positional_params=n.set_positional_params,e.get_positional_params=n.get_positional_params,e.set_filter_params=n.set_filter_params,e.get_filter_params=n.get_filter_params,e.get_filter_freq_response=n.get_filter_freq_response,e.get_duration=function(e){return e&&a.is_speaker(e)?n.get_duration(e):(o.error('Object "'+(e?e.name:void 0)+'" is not a valid speaker'),0)}},a.module.textures=function(e,t){var a=t("__print"),r=t("__scenes"),n=t("__textures"),o=t("__obj_util"),i=t("__util"),_=t("__assets");e.play_video=function(e,t){t||(t=0);var o=n.Zy(e,t);o?r.get_active().b4w_use_nla&&n.yB(o)?a.error("NLA texture can't be controlled directly through API."):n.play_video(o):a.error('Texture with name "'+e+'" not found!')},e.pause_video=function(e,t){t||(t=0);var o=n.Zy(e,t);o?r.get_active().b4w_use_nla&&n.yB(o)?a.error("NLA texture can't be controlled directly through API."):n.pause_video(o):a.error('Texture with name "'+e+'" not found!')},e.reset_video=function(e,t){t||(t=0);var o=n.Zy(e,t);o?r.get_active().b4w_use_nla&&n.yB(o)?a.error("NLA texture can't be controlled directly through API."):n.reset_video(o):a.error('Texture with name "'+e+'" not found!')},e.get_canvas_ctx=function(e,t){if(o.is_mesh(e)){var r=n.wP(e,t);if(r)return r;a.error("Couldn't find canvas texture with this name: "+t)}else a.error("Object must be type of mesh.");return null},e.update_canvas_ctx=function(e,t){if(!o.is_mesh(e))return a.error("Object must be type of mesh."),!1;var r=n.Wy(e,t);return r&&"CANVAS"==r.source?(n.bV(r),!0):(a.error("Couldn't find canvas texture \""+t+'" in object "'+e.name+'".'),!1)},e.change_image=function(e,t,r,o){o=o||function(){};var s=n.Wy(e,t);if(s)if(s.dj)a.error("Changing video textures is forbidden."),o(!1);else{var c=i.ji(r);s.jk==c?o(!0):_.enqueue([{id:r,type:_.AT_IMAGE_ELEMENT,url:r,request_method:"GET"}],function(a){a?(n.change_image(e,s,t,a,r),o(!0)):o(!1)},null,null)}else a.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),o(!1)},e.get_texture_names=function(e){return o.is_mesh(e)?n.get_texture_names(e):(a.error("Object must be type of mesh."),[])}},a.module.time=function(e,t){var a=t("__time");e.set_timeout=a.set_timeout,e.clear_timeout=a.clear_timeout,e.get_timeline=a.get_timeline,e.animate=a.animate,e.clear_animation=a.clear_animation},a.module.transform=function(e,t){var a=t("__boundings"),r=t("__obj_util"),n=t("__physics"),o=t("__print"),i=t("__quat"),_=t("__transform"),s=t("__tsr"),c=t("__util"),l=s.create(),f=new Float32Array(3),u=new Float32Array(4);e.set_translation=function(e,t,a,i){r.is_dynamic(e)?(f[0]=t,f[1]=a,f[2]=i,_.set_translation(e,f),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_translation_rel=function(e,t,a,i){r.is_dynamic(e)?(f[0]=t,f[1]=a,f[2]=i,_.set_translation_rel(e,f),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_translation_v=function(e,t){r.is_dynamic(e)?(_.set_translation(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_translation_rel_v=function(e,t){r.is_dynamic(e)?(_.set_translation_rel(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_translation_obj_rel=function(e,t,a,i,l){r.is_dynamic(e)?(f[0]=t,f[1]=a,f[2]=i,t=s.get_trans_view(l.o.v),l=s.get_quat_view(l.o.v),c.transform_vec3(f,1,l,t,f),_.set_translation(e,f),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_translation=function(e,t){return t||(t=new Float32Array(3)),_.get_translation(e,t),t},e.get_translation_rel=function(e,t){return t||(t=new Float32Array(3)),_.get_translation_rel(e,t),t},e.set_rotation=function(e,t,a,i,s){r.is_dynamic(e)?(u[0]=t,u[1]=a,u[2]=i,u[3]=s,_.set_rotation(e,u),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_rotation_rel=function(e,t,a,i,s){r.is_dynamic(e)?(u[0]=t,u[1]=a,u[2]=i,u[3]=s,_.set_rotation_rel(e,u),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_rotation_v=function(e,t){r.is_dynamic(e)?(_.set_rotation(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_rotation_rel_v=function(e,t){r.is_dynamic(e)?(_.set_rotation_rel(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_rotation_rel_v=function(e,t){if(r.is_dynamic(e))return _.get_rotation_rel(e,t),t;o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_rotation=function(e,t){return t||(t=new Float32Array(4)),_.get_rotation(e,t),t},e.get_rotation_rel=function(e,t){return t||(t=new Float32Array(4)),_.get_rotation_rel(e,t),t},e.set_rotation_euler=function(e,t,a,i){r.is_dynamic(e)?(f[0]=t,f[1]=a,f[2]=i,_.set_rotation_euler(e,f),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_rotation_euler=function(e,t){return t||(t=new Float32Array(3)),_.get_rotation_euler(e,t),t},e.get_rotation_euler_rel=function(e,t){return t||(t=new Float32Array(3)),_.get_rotation_euler_rel(e,t),t},e.set_rotation_euler_rel=function(e,t,a,i){r.is_dynamic(e)?(f[0]=t,f[1]=a,f[2]=i,_.set_rotation_euler_rel(e,f),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_rotation_euler_v=function(e,t){r.is_dynamic(e)?(_.set_rotation_euler(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_rotation_euler_rel_v=function(e,t){r.is_dynamic(e)?(_.set_rotation_euler_rel(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_scale=function(e,t){r.is_dynamic(e)?(_.set_scale(e,t),_.O(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_scale_rel=function(e,t){r.is_dynamic(e)?(_.set_scale_rel(e,t),_.O(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_scale=function(e){return _.get_scale(e)},e.get_scale_rel=function(e){return _.get_scale_rel(e)},e.empty_reset_transform=function(e){if("EMPTY"!=e.type)o.error("Wrong object: "+e.name);else{for(var t=0;t<e.Ze.length;t++)if(!r.is_dynamic(e.Ze[t]))return void o.error('Wrong object: "'+e.Ze[t].name+'" is not dynamic.');_.set_translation(e,[0,0,0]),_.set_rotation(e,[0,0,0,1]),_.set_scale(e,1),_.O(e),n.sync_transform(e)}},e.get_object_size=function(e){return r.is_mesh(e)?_.get_object_size(e):(o.error("Wrong object: "+e.name),0)},e.get_object_center=function(e,t,a){return r.is_mesh(e)?(a||(a=new Float32Array(3)),_.get_object_center(e,t,a)):(o.error("Wrong object: "+e.name),null)},e.move_local=function(e,t,a,i){r.is_dynamic(e)?(_.move_local(e,t,a,i),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.rotate_x_local=function(e,t){if(r.is_dynamic(e)){var a=i.setAxisAngle(c.AXIS_X,t,u);_.zA(e,a),_.O(e),n.sync_transform(e)}else o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.rotate_y_local=function(e,t){if(r.is_dynamic(e)){var a=i.setAxisAngle(c.AXIS_MY,t,u);_.zA(e,a),_.O(e),n.sync_transform(e)}else o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.rotate_z_local=function(e,t){if(r.is_dynamic(e)){var a=i.setAxisAngle(c.AXIS_Z,t,u);_.zA(e,a),_.O(e),n.sync_transform(e)}else o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_object_bounding_box=function(e){return a.rt(e.o.og)},e.set_tsr=function(e,t){r.is_dynamic(e)?(_.set_tsr(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_tsr_rel=function(e,t){r.is_dynamic(e)?(_.set_tsr_rel(e,t),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_tsr=function(e,t){return t||(t=new Float32Array(8)),_.get_tsr(e,t),t},e.get_tsr_rel=function(e,t){return t||(t=new Float32Array(8)),_.get_tsr_rel(e,t),t},e.distance=function(e,t){return _.distance(e,t)},e.set_matrix=function(e,t){r.is_dynamic(e)?(s.from_mat4(t,l),_.set_tsr(e,l),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.set_matrix_rel=function(e,t){r.is_dynamic(e)?(s.from_mat4(t,l),_.set_tsr_rel(e,l),_.O(e),n.sync_transform(e)):o.error('Wrong object: "'+e.name+'" is not dynamic.')},e.get_matrix=function(e,t){return t||(t=new Float32Array(16)),_.get_tsr(e,l),s.to_mat4(l,t),t},e.get_matrix_rel=function(e,t){return t||(t=new Float32Array(16)),_.get_tsr_rel(e,l),s.to_mat4(l,t),t}},a.module.tsr=function(e,t){var a=t("__mat4"),r=t("__tsr");e.create=r.create,e.from_values=r.from_values,e.copy=r.copy,e.identity=r.identity,e.set_sep=r.set_sep,e.set_trans=r.set_trans,e.set_scale=r.set_scale,e.set_transcale=r.set_transcale,e.set_quat=r.set_quat,e.get_trans_view=r.get_trans_view,e.get_scale=r.get_scale,e.get_quat_view=r.get_quat_view,e.invert=r.invert,e.to_mat4=function(e,t){return t||(t=a.create()),r.to_mat4(e,t),t},e.from_mat4=r.from_mat4,e.multiply=r.multiply,e.transform_vec3=r.transform_vec3,e.transform_vec3_inv=r.transform_vec3_inv,e.transform_vectors=r.transform_vectors,e.transform_dir_vectors=r.transform_dir_vectors,e.transform_dir_vec3=r.transform_dir_vec3,e.transform_tangents=r.transform_tangents,e.translate=r.translate,e.interpolate=function(e,t,a,n){return n||(n=r.create()),r.interpolate(e,t,a,n),n}},a.module.util=function(e,t){var a=t("__compat"),r=t("__print"),n=t("__quat"),o=t("__tbn"),i=t("__util"),_=t("__vec3");e.AXIS_X=new Float32Array([1,0,0]),e.AXIS_Y=new Float32Array([0,1,0]),e.AXIS_Z=new Float32Array([0,0,1]),e.AXIS_MX=new Float32Array([-1,0,0]),e.AXIS_MY=new Float32Array([0,-1,0]),e.AXIS_MZ=new Float32Array([0,0,-1]),e.XYX=i.XYX,e.YZY=i.YZY,e.ZXZ=i.ZXZ,e.XZX=i.XZX,e.YXY=i.YXY,e.ZYZ=i.ZYZ,e.XYZ=i.XYZ,e.YZX=i.YZX,e.ZXY=i.ZXY,e.XZY=i.XZY,e.YXZ=i.YXZ,e.ZYX=i.ZYX,e.f32=function(e){return i.f32(e||0)},e.assert=i.assert,e.keyfind=i.keyfind,e.keysearch=i.keysearch,e.matrix_to_quat=function(e){return i.matrix_to_quat(e)},e.euler_to_quat=function(e,t){return t||(t=new Float32Array(4)),i.euler_to_quat(e,t)},e.ordered_angles_to_quat=function(e,t,a){return a||(a=n.create()),i.ordered_angles_to_quat(e,t,a)},e.quat_to_ordered_angles=function(e,t,a){return a||(a=_.create()),i.quat_to_ordered_angles(e,t,a)},e.quat_to_euler=function(e,t){return t||(t=new Float32Array(3)),i.quat_to_euler(e,t)},e.sign=i.sign,e.clamp=i.clamp,e.quat_to_dir=i.quat_to_dir,e.ground_project_cam_quat=function(e,t){return i.quat_project(e,i.AXIS_MZ,i.AXIS_Z,i.AXIS_Y,t)},e.cam_quat_to_mesh_quat=function(e,t){return i.cam_quat_to_mesh_quat(e,t)},e.quat_project=function(e,t,a,n,o){return 0!=_.dot(a,n)?(r.error("Wrong in-plane direction"),null):i.quat_project(e,t,a,n,o)},e.hash_code=i.hash_code,e.smooth=i.smooth,e.smooth_v=i.smooth_v,e.is_vector=i.is_vector,e.correct_cam_quat_up=i.correct_cam_quat_up,e.quat_to_angle_axis=i.quat_to_angle_axis,e.random_from_array=i.random_from_array,e.horizontal_direction=i.horizontal_direction,e.angle_wrap_0_2pi=i.angle_wrap_0_2pi,e.angle_wrap_periodic=i.angle_wrap_periodic,e.smooth_step=i.smooth_step,e.lerp=i.lerp,e.deg_to_rad=i.deg_to_rad,e.rad_to_deg=i.rad_to_deg,e.dir_to_quat=i.dir_to_quat,e.is_ie11=a.is_ie11,e.gen_tbn_quats=o.get,e.trunc=i.trunc},a.module.version=function(e,t){var a=t("__version");e.version=a.version,e.version_str=a.version_str,e.type=a.type,e.date=a.date,e.date_str=a.date_str},a.module.objects=function(e,t){var a=t("__geometry"),r=t("__objects"),n=t("__batch"),o=t("__obj_util"),i=t("__print"),_=t("__scenes"),s=t("__util");e.get_meta_tags=function(e){if(e)return r.get_meta_tags(e)},e.get_custom_prop=function(e){if(e)return r.get_custom_prop(e)},e.copy=function(e,t,n){return o.is_mesh(e)?o.is_dynamic(e)?a.bj(e)||a.check_shape_keys(e)||!n?-1==r.Hb(_.get_active(),"MESH",r.DATA_ID_ALL).indexOf(e)?(i.error('object "'+e.name+'" does not belong to the active scene.'),!1):r.copy(e,t||"",n):(i.error('object "'+e.name+'" has not dynamic geometry for deep copying.'),!1):(i.error('object "'+e.name+'" is not dynamic.'),!1):(i.error('object "'+e.name+'" is not of type "MESH".'),!1)},e.set_nodemat_value=function(e,t,a){if(i.xd("set_nodemat_value","material.set_nodemat_value"),o.gb(e)){var _=t[0],s=n.Va(e,_,"MAIN");if(null===s)return i.error('Material "'+_+'" was not found in the object "'+e.name+'".'),null;if(null===(s=r.$h(s.lf,t,1)))return i.error('Value node "'+t[t.length-1]+'" was not found in the object "'+e.name+'".'),null;r.set_nodemat_value(e,_,s,a)}else i.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.')},e.get_nodemat_value=function(e,t){if(i.xd("get_nodemat_value","material.get_nodemat_value"),!o.gb(e))return i.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.'),0;var a=t[0],_=n.Va(e,a,"MAIN");return null===_?(i.error('Material "'+a+'" was not found in the object "'+e.name+'".'),0):(a=r.$h(_.lf,t,1),null===a?(i.error('Value node "'+t[t.length-1]+'" was not found in the object "'+e.name+'".'),0):r.get_nodemat_value(_,a))},e.set_nodemat_rgb=function(e,t,a,_,s){if(i.xd("set_nodemat_rgb","material.set_nodemat_rgb"),o.gb(e)){var c=t[0],l=n.Va(e,c,"MAIN");null===l?i.error('Material "'+c+'" was not found in the object "'+e.name+'".'):(l=r.$h(l.kf,t,1),null===l?i.error('RGB node "'+t[t.length-1]+'" was not found in the object "'+e.name+'".'):r.set_nodemat_rgb(e,c,l,a,_,s))}else i.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.')},e.get_nodemat_rgb=function(e,t,a){if(i.xd("get_nodemat_rgb","material.get_nodemat_rgb"),!o.gb(e))return i.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.'),null;var _=t[0],s=n.Va(e,_,"MAIN");return null===s?(i.error('Material "'+_+'" was not found in the object "'+e.name+'".'),null):null===(_=r.$h(s.kf,t))?(i.error('RGB node "'+t[t.length-1]+'" was not found in the object "'+e.name+'".'),null):(a||(a=new Float32Array(3)),r.get_nodemat_rgb(s,_,a))},e.update_boundings=function(e){o.is_mesh(e)?a.bj(e)||a.check_shape_keys(e)?r.update_boundings(e):i.error('object "'+e.name+'" has not dynamic geometry.'):i.error('The type of the object "'+e.name+'" is not "MESH".')},e.get_parent=o.get_parent,e.get_dg_parent=o.get_dg_parent,e.is_mesh=o.is_mesh,e.is_armature=o.is_armature,e.is_speaker=o.is_speaker,e.is_camera=o.is_camera,e.is_lamp=o.is_lamp,e.is_empty=o.is_empty,e.is_line=o.is_line,e.is_world=o.is_world,e.get_selectable_objects=function(){return r.get_selectable_objects()},e.get_outlining_objects=function(){return r.get_outlining_objects()},e.is_dynamic=o.is_dynamic,e.set_wind_bending_params=function(e,t){if(o.gb(e)){var a=e.o;if(a.ve){if("number"==typeof t.angle){var _=n.MI(s.deg_to_rad(t.angle),a.Ii,a.v[3]);a.xf=_}"number"==typeof t.main_frequency&&(a.yf=t.main_frequency),"number"==typeof t.detail_frequency&&(a.df=t.detail_frequency),"number"==typeof t.detail_amplitude&&(a.cf=t.detail_amplitude),"number"==typeof t.branch_amplitude&&(a.Xe=t.branch_amplitude),r.kT(e)}else i.error('The "'+e.name+"\" object doesn't have wind bending parameters.")}else i.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.')},e.get_wind_bending_params=function(e){if(e=e.o,!e.ve)return null;var t={},a=s.rad_to_deg(n.BV(e.xf,e.Ii,e.v[3]));return t.angle=a,t.main_frequency=e.yf,t.detail_frequency=e.df,t.detail_amplitude=e.cf,t.branch_amplitude=e.Xe,t},e.create_line=function(e){return r.create_line(e)}},a.module.main=function(e,t){function a(){}function r(){}function n(){}function o(){window.performance||(I.log("Apply performance workaround"),window.performance={});var e=Date.now();window.performance.now||(I.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-e}),P.gH(0)}function i(e,t){for(var a=null,r=t?J:V,n=0;n<r.length;n++){var o=r[n];try{a=e.getContext(o,H)}catch(e){}if(a)break}return a&&h.kO(a),a}function _(e,t,a){e.addEventListener("webglcontextlost",function(e){e.preventDefault(),I.error("WebGL context lost"),c()},!1),x.bg(a);var n=x.get_renderer_info();n&&I.log("%cRENDERER INFO:","color: #00a",a.getParameter(n.UNMASKED_VENDOR_WEBGL)+", "+a.getParameter(n.UNMASKED_RENDERER_WEBGL)),M.bg(a),T.bg(a),k.bg(a),U.bg(a),v.bg(a),A.bg(a),E.ET(e),v.init(e,t),C.iH(e.width,e.height,1),D.init(),y.init(),r=u(),f()}function s(){a=function(){}}function c(){l()||(z=performance.now()/1e3,D.pause(),N.pause(),k.pause(),d.pause())}function l(){return W<z}function f(){var e="HMD"===X.stereo&&y.dQ();e?e.requestAnimationFrame(f):Q(f);var t=performance.now()/1e3;q||(q=t);var n=t-q;if(!(n<1/X.max_fps)){for(var o=P.get_timeline(),i=0;i<Y.length;i++)Y[i](o,n);l()||(W>q&&(n-=W-Math.max(z,q)),P.fT(n),o+=n,P.gH(o),A.update(),m.update(),E.update(),i=n,E.is_primary_loaded()&&(S.reset(),G.update(i),R.update(o,i),O.update(o,i),D.update(o,i),i&&p.update(i),E.is_primary_loaded()&&(N.update(o,i),E.is_primary_loaded()&&(y.update(o),b.update(o,i),E.is_primary_loaded()&&(d.update(!1),L.update(o,i),B.update(),a(i,o),E.is_primary_loaded()&&(C.update(o,i),d.lI(),w.frame()))))),r(n)),q=t,e&&e.isPresenting&&e.submitFrame()}}function u(){var e=60,t=0,a=X.mE,r=X.VO;return function(o){o<1/X.max_fps||(e=F.smooth(1/o,e,o,a),o=N.LP(),(t=(t+1)%r)||n(Math.round(e),o))}}var d=t("__anchors"),p=t("__animation"),m=t("__assets"),g=t("__config"),h=t("__compat"),v=t("__container"),b=t("__controls"),E=t("__data"),A=t("__debug"),x=t("__extensions"),T=t("__geometry"),y=t("__input"),S=t("__hud"),O=t("__nla"),w=t("__main"),R=t("__logic_nodes"),L=t("__objects"),N=t("__physics"),I=t("__print"),M=t("__renderer"),C=t("__scenes"),D=t("__sfx"),U=t("__shaders"),k=t("__textures"),P=t("__time"),G=t("__transform"),F=t("__util"),j=t("__version"),B=t("__particles"),H=g.context,X=g.H,q=0,z=0,W=0,Y=[],V=["webgl","experimental-webgl"],J=["webgl2","experimental-webgl2"],K=null,Q=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/X.max_fps)}}();e.init=function(e,t){g.rT(),I.BT(X.console_verbose);var a=j.version_str()+" "+j.type()+" ("+j.date_str()+")";return I.log("%cINIT ENGINE","color: #00a",a),I.log("%cUSER AGENT:","color: #00a",navigator.userAgent),window.WebGLRenderingContext?(o(),t?S.init(t):(g.H.show_hud_debug_info=!1,g.Z.pv=!1),h.yL(),h.cy("Chrome")||h.cy("Firefox")||(X.Ab=!1),a=i(e,X.Ab),!a&&X.Ab&&(X.Ab=!1,a=i(e,!1)),a?(I.log("%cINIT WEBGL "+(X.Ab?"2":"1"),"color: #00a"),K=a,_(e,t,a),g.apply_quality(),h.aH(a,!0),U.hR(),X.Tn&&(e.style["touch-action"]="none"),I.log("%cSET PRECISION:","color: #00a",X.precision),a):null):null},e.set_fps_callback=function(e){n=e},e.clear_fps_callback=function(){n=function(){}},e.set_render_callback=function(e){a=e},e.clear_render_callback=function(){s()},e.pause=c,e.resume=function(){l()&&(W=performance.now()/1e3,D.resume(),N.resume(),k.play(!0),d.resume())},e.is_paused=l,e.reset=function(){E.unload(0),E.reset(),x.reset(),M.reset(),T.reset(),k.GS(),U.reset(),A.reset(),v.reset(),E.reset(),v.reset(),P.reset(),D.reset(),W=z=q=0,n=function(){},r=function(){},a=function(){},Y.length=0,K=null},e.canvas_data_url=function(e,t,a,r){w.canvas_data_url(e,t,a,r)},e.detect_mobile=function(){return h.detect_mobile()},e.append_loop_cb=function(e){for(var t=0;t<Y.length;t++)if(Y[t]==e)return;Y.push(e)},e.remove_loop_cb=function(e){for(var t=0;t<Y.length;t++)if(Y[t]==e){Y.splice(t,1);break}},e.get_renderer_info=function(){var e=x.get_renderer_info();return e?{vendor:K.getParameter(e.UNMASKED_VENDOR_WEBGL),renderer:K.getParameter(e.UNMASKED_RENDERER_WEBGL)}:null}},a.module.nla=function(e,t){var a=t("__nla"),r=t("__time"),n=t("__print"),o=t("__util");e.set_frame=function(e){e=o.clamp(e,a.get_frame_start(),a.get_frame_end()),a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.set_frame(e,r.get_timeline())},e.get_frame=function(){return a.get_frame(r.get_timeline())},e.stop=function(){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.VA()},e.play=function(e){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.sG(e)},e.is_play=function(){return a.is_play()},e.get_frame_start=function(){return a.get_frame_start()},e.get_frame_end=function(){return a.get_frame_end()},e.check_nla=function(){return a.check_nla()},e.check_logic_nodes=function(){return a.check_logic_nodes()},e.set_range=function(e,t){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):(t=parseFloat(t)||a.get_frame_end(),e=parseFloat(e)||a.get_frame_end(),t=o.clamp(t,a.get_frame_start(),a.get_frame_end()),e=o.clamp(e,a.get_frame_start(),t),a.set_range(e,t))},e.reset_range=function(){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.reset_range()},e.set_cyclic=function(e){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.set_cyclic(e)},e.clear_callback=function(){a.check_logic_nodes()?n.error("The active scene is using the Logic Editor."):a.clear_callback()}},a.module.app=function(e,t){function a(){var e=w.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(e=w.is_paused(),w.pause()):e||w.resume()},!1)}function r(){var e=0,t=x.get_container(),a=w.is_paused(),r=!0;w.append_loop_cb(function(){if(!(e%10)){var n=t.getBoundingClientRect();n.top>window.innerHeight||0>n.bottom?(r&&(a=w.is_paused()),w.pause(),r=!1):a||r||(w.resume(),r=!0)}e++})}function n(e,t,a,r){var n=document.createElement("canvas"),o=document.getElementById(e);return o||(L.error('Warning: canvas container "'+e+'" not found, appending to body'),o=document.body),n.style.position="absolute",n.style.left=0,n.style.top=0,n.style.width=o.offsetWidth+"px",n.style.height=o.offsetHeight+"px",n.width=o.offsetWidth*window.devicePixelRatio,n.height=o.offsetHeight*window.devicePixelRatio,t?(e=document.createElement("canvas"),e.style.position="absolute",n.style.left=0,n.style.top=0,e.style.pointerEvents="none"):e=null,o.appendChild(n),w.init(n,e)?(e&&x.insert_to_container(e,"LAST"),!0):(a&&h("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",r),!1)}function o(e,t){e?(t&&(document.getElementById(t).style.display="block"),k=document.getElementById(e)):(k=document.createElement("div"),k.innerHTML=0,k.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",x.insert_to_container(k,"JUST_AFTER_CANVAS"))}function i(e,t){var a=String(e);t&&(a+="/"+String(t)),k.innerHTML=a}function _(e){e=document.getElementById(e);var t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}function s(e,t,a){var r=Math.max(b.hover_get_distance(e),1),n=M.get_rotation(e,Y);t=C.quat_to_dir(n,t,z),t[2]=0,D.normalize(t,t),D.scale(t,r*a,t),a=M.get_translation(e,W),D.add(a,t,a),b.set_translation(e,a)}function c(e,t){var a=b.hover_get_vertical_limits(e,J);if(a.up!=a.down){var r=b.get_camera_angles(e,q)[1],a=(a.down-r)/(a.down-a.up),r=b.hover_get_distance_limits(e,J),a=Math.max(a,2/r.max);b.rotate_camera(e,0,a*t)}}function l(e,t,a,r){M.move_local(e,5*t,5*a,5*r)}function f(e,t,a){var r=b.target_get_distance(e),n=Math.abs(t);a=Math.pow(n*a,1-Math.pow(n*a,.15)),M.move_local(e,0,0,0>t?.001<r?-r*a:0:a/(1-a)*r)}function u(e,t,a,r){for(var n=a*t;0<e;--e)a+=n,r+=n,n=a*t;return r}function d(e,t,a,r,n){return n?(n=b.target_get_pivot(e,z),e=b.get_translation(e),e=D.dist(n,e)+r,r=0<t?u(t,-a,e,r):u(-t,a/(1-a),e,r)):r-=2*t*a,r}function p(e,t,a,r,n,o){function i(e,t,a,r){if(1==a){b.get_velocities(e,L);var n=w?.003*L.trans:.003*L.rot;a=T.get_sensor_value(e,t,0),T.get_sensor_payload(e,t,0).gesture===T.PL_SINGLE_TOUCH_MOVE?(ve+="X"==r?-a*n:0,be+="Y"==r?-a*n:0):T.get_sensor_payload(e,t,0).gesture===T.PL_MULTITOUCH_MOVE_PAN&&(e=w?.003*L.rot:75e-5*L.trans,Ee+="X"==r?-a*e:0,Ae+="Y"==r?-a*e:0)}}function _(e,t,a,r){if(1==a){if(a=T.get_sensor_value(e,t,1),b.get_velocities(e,L),w)n=.003*L.trans,o=75e-5*L.rot;else var n=.003*L.rot,o=75e-5*L.trans;1===T.get_sensor_payload(e,t,0).which?(fe+="X"==r?-a*n:0,ue+="Y"==r?-a*n:0):2!==T.get_sensor_payload(e,t,0).which&&3!==T.get_sensor_payload(e,t,0).which||(de+="X"==r?-a*o:0,pe+="Y"==r?-a*o:0)}}function u(e){return e[0]&&(e[1]||e[2]||-.1>e[3])}function p(e){return e[0]&&(e[1]||e[2]||.1<e[3])}function g(e){return e[0]&&(e[1]||-.1>e[2])}function h(e){return e[0]&&(e[1]||.1<e[2])}function v(e){return e[0]&&(e[1]||e[2]||e[3])}function E(e,t,a){if(1==a)switch(a=T.get_sensor_value(e,t,0),b.get_velocities(e,L),t){case"FORWARD":S?Y[0]=1:w?(t=b.get_camera_angles(e,q)[1],t=Math.abs(t)>=Math.PI/4?C.AXIS_Y:C.AXIS_MZ,s(e,t,.5*L.trans*a)):y?f(e,-L.zoom,a):l(e,0,0,-L.trans*a);break;case"BACKWARD":S?Y[0]=-1:w?(t=b.get_camera_angles(e,q)[1],t=Math.abs(t)>=Math.PI/4?C.AXIS_MY:C.AXIS_Z,s(e,t,.5*L.trans*a)):y?f(e,L.zoom,a):l(e,0,0,L.trans*a);break;case"UP":w?c(e,30*-L.zoom*a):S||l(e,0,L.trans*a,0);break;case"DOWN":w?c(e,30*L.zoom*a):S||l(e,0,-L.trans*a,0);break;case"LEFT":S?Y[1]=1:w?s(e,C.AXIS_MX,.5*L.trans*a):l(e,-L.trans*a,0,0);break;case"RIGHT":S?Y[1]=-1:w?s(e,C.AXIS_X,.5*L.trans*a):l(e,L.trans*a,0,0);break;case"ROT_LEFT":y?b.rotate_camera(e,.75*-L.rot*a,0):b.rotate_camera(e,.75*L.rot*a,0);break;case"ROT_RIGHT":y?b.rotate_camera(e,.75*L.rot*a,0):b.rotate_camera(e,.75*-L.rot*a,0);break;case"ROT_UP":y?b.rotate_camera(e,0,.75*-L.rot*a):b.rotate_camera(e,0,.75*L.rot*a);break;case"ROT_DOWN":y?b.rotate_camera(e,0,.75*L.rot*a):b.rotate_camera(e,0,.75*-L.rot*a)}else switch(t){case"FORWARD":case"BACKWARD":S&&(Y[0]=0);break;case"LEFT":case"RIGHT":S&&(Y[1]=0)}S&&(R.set_character_move_dir(S,Y[0],Y[1]),e=b.get_camera_angles_char(e,X),R.set_character_rotation(S,e[0],e[1]))}P=e,G=t,F=a,j=r,B=n,H=o;var x=I.get_active_camera();m(x);var y=!1,S=null,w=!1;switch(b.get_move_style(x)){case b.MS_TARGET_CONTROLS:y=!e;break;case b.MS_EYE_CONTROLS:S=I.get_first_character();break;case b.MS_STATIC:return;case b.MS_HOVER_CONTROLS:w=!0}var L=b.get_velocities(x,V);if(e=T.create_elapsed_sensor(),R.has_simulated_physics(x)){var N=T.create_collision_sensor(x,null,!0);T.create_sensor_manifold(x,"CAMERA_COLLISION",T.CT_POSITIVE,[N],null,function(e,t){var a=T.get_sensor_payload(e,t,0).coll_dist;if(0>a){var r=T.get_sensor_payload(e,t,0).coll_norm,n=z;D.scale(r,-.25*a,n),a=M.get_translation(e,W),D.add(a,n,a),M.set_translation_v(e,a)}})}if(S){var N=M.get_translation(x),k=M.get_rotation(x),k=C.cam_quat_to_mesh_quat(k);N[2]-=.5,R.set_transform(S,N,k),A.append_stiff_trans(x,S,[0,0,.5]);var Y=new Float32Array(2),J=!0;R.set_character_move_type(S,R.CM_FLY),T.create_kb_sensor_manifold(x,"TOGGLE_CHAR_MOVE_TYPE",T.CT_SHOT,T.KEY_C,function(){J=!J,R.set_character_move_type(S,J?R.CM_FLY:R.CM_WALK)})}var K,Q,Z,$,ee,te,ae,re,ne,oe,ie,_e,se;if(o?N=k=oe=ie=_e=se=T.create_custom_sensor(0):(se=O.check_enable_gamepad_indices(),k=se.length?se[se.length-1]:0,N=T.create_gamepad_btn_sensor(O.GMPD_BUTTON_6,k),k=T.create_gamepad_btn_sensor(O.GMPD_BUTTON_7,k),oe=T.create_gamepad_axis_sensor(O.GMPD_AXIS_0,se),ie=T.create_gamepad_axis_sensor(O.GMPD_AXIS_1,se),_e=T.create_gamepad_axis_sensor(O.GMPD_AXIS_2,se),se=T.create_gamepad_axis_sensor(O.GMPD_AXIS_3,se)),t?t=K=Q=Z=$=ee=te=ae=re=ne=T.create_custom_sensor(0):(t=T.create_keyboard_sensor(T.KEY_W),K=T.create_keyboard_sensor(T.KEY_S),Q=T.create_keyboard_sensor(T.KEY_A),Z=T.create_keyboard_sensor(T.KEY_D),$=T.create_keyboard_sensor(T.KEY_R),ee=T.create_keyboard_sensor(T.KEY_F),te=T.create_keyboard_sensor(T.KEY_UP),ae=T.create_keyboard_sensor(T.KEY_DOWN),re=T.create_keyboard_sensor(T.KEY_LEFT),ne=T.create_keyboard_sensor(T.KEY_RIGHT)),w||(T.create_sensor_manifold(x,"FORWARD",T.CT_CONTINUOUS,[e,t,ie],g,E),T.create_sensor_manifold(x,"BACKWARD",T.CT_CONTINUOUS,[e,K,ie],h,E)),y?(T.create_sensor_manifold(x,"ROT_UP",T.CT_CONTINUOUS,[e,te,$,se],u,E),T.create_sensor_manifold(x,"ROT_DOWN",T.CT_CONTINUOUS,[e,ae,ee,se],p,E),T.create_sensor_manifold(x,"ROT_LEFT",T.CT_CONTINUOUS,[e,re,Q,_e],u,E),T.create_sensor_manifold(x,"ROT_RIGHT",T.CT_CONTINUOUS,[e,ne,Z,_e],p,E)):w?(T.create_sensor_manifold(x,"LEFT",T.CT_CONTINUOUS,[e,re,Q,oe],u,E),T.create_sensor_manifold(x,"RIGHT",T.CT_CONTINUOUS,[e,ne,Z,oe],p,E),T.create_sensor_manifold(x,"FORWARD",T.CT_CONTINUOUS,[e,te,t,ie],u,E),T.create_sensor_manifold(x,"BACKWARD",T.CT_CONTINUOUS,[e,ae,K,ie],p,E),T.create_sensor_manifold(x,"UP",T.CT_CONTINUOUS,[e,ee,se],h,E),T.create_sensor_manifold(x,"DOWN",T.CT_CONTINUOUS,[e,$,se],g,E)):(T.create_sensor_manifold(x,"UP",T.CT_CONTINUOUS,[e,$,N],v,E),T.create_sensor_manifold(x,"DOWN",T.CT_CONTINUOUS,[e,ee,k],v,E),T.create_sensor_manifold(x,"LEFT",T.CT_CONTINUOUS,[e,Q,oe],g,E),T.create_sensor_manifold(x,"RIGHT",T.CT_CONTINUOUS,[e,Z,oe],h,E),T.create_sensor_manifold(x,"ROT_UP",T.CT_CONTINUOUS,[e,te,se],g,E),T.create_sensor_manifold(x,"ROT_DOWN",T.CT_CONTINUOUS,[e,ae,se],h,E),T.create_sensor_manifold(x,"ROT_LEFT",T.CT_CONTINUOUS,[e,re,_e],g,E),T.create_sensor_manifold(x,"ROT_RIGHT",T.CT_CONTINUOUS,[e,ne,_e],h,E)),!a){var ce=0;a=T.create_mouse_wheel_sensor(r);var le=0;ie=T.create_touch_zoom_sensor(r),T.create_sensor_manifold(x,"MOUSE_WHEEL",T.CT_LEVEL,[a],null,function(e,t,a){1==a&&(t=T.get_sensor_value(e,t,0),b.get_velocities(e,L),y||w?ce=d(e,t,L.zoom,ce,y):(L.trans*=1+t*L.zoom,b.set_velocities(e,L)))}),T.create_sensor_manifold(x,"TOUCH_ZOOM",T.CT_LEVEL,[ie],null,function(e,t,a){1==a&&(a=T.get_sensor_value(e,t,0),b.get_velocities(e,L),T.get_sensor_payload(e,t,0)===T.PL_MULTITOUCH_MOVE_ZOOM&&(le=d(e,a,.03*L.zoom,le,y)))}),T.create_sensor_manifold(x,"ZOOM_INTERPOL",T.CT_POSITIVE,[e],null,function(e,t){if(y||w)if(1e-5<Math.abs(ce)||1e-5<Math.abs(le)){var a=T.get_sensor_value(e,t,0),r=C.smooth(ce,0,a,.1*U);ce-=r,a=C.smooth(le,0,a,.15*U),le-=a,w?c(e,-(r+a)):(r=b.target_get_distance(e)+r+a,r=Math.max(r,.001),b.target_set_distance(e,r))}else le=ce=0})}var fe=0,ue=0,de=0,pe=0,me=0,ge=0;if(o||(o=function(e){b.get_velocities(e,L),me+=.002*L.trans},a=function(e){b.get_velocities(e,L),ge+=.05*L.zoom},ie=function(e){b.get_velocities(e,L),me-=.002*L.trans},se=function(e){b.get_velocities(e,L),ge-=.05*L.zoom},y?(T.create_sensor_manifold(x,"GMPD_PAN_Y_POS",T.CT_CONTINUOUS,[N],null,a),T.create_sensor_manifold(x,"GMPD_PAN_Y_NEG",T.CT_CONTINUOUS,[k],null,se),T.create_sensor_manifold(x,"GMPD_PAN_X_POS",T.CT_CONTINUOUS,[oe],function(e){return-.1>e[0]},ie),T.create_sensor_manifold(x,"GMPD_PAN_X_NEG",T.CT_CONTINUOUS,[oe],function(e){return.1<e[0]},o)):w&&(T.create_sensor_manifold(x,"GMPD_PAN_X_POS",T.CT_CONTINUOUS,[_e],function(e){return-.1>e[0]},ie),T.create_sensor_manifold(x,"GMPD_PAN_X_NEG",T.CT_CONTINUOUS,[_e],function(e){return.1<e[0]},o))),n){n=T.create_mouse_move_sensor("X",window),o=T.create_mouse_move_sensor("Y",window),N=T.create_mouse_click_sensor(r),a=T.create_mouse_click_sensor(window);var he=!1,k=function(e){return e[2]?he=!0:e[0]||(he=!1),he&&e[0]};T.create_sensor_manifold(x,"MOUSE_X",T.CT_POSITIVE,[a,n,N],k,_,"X"),T.create_sensor_manifold(x,"MOUSE_Y",T.CT_POSITIVE,[a,o,N],k,_,"Y"),n=O.get_device_by_type_element(O.DEVICE_MOUSE,window),O.switch_prevent_default(n,!1)}else n=T.create_mouse_move_sensor("X",r),o=T.create_mouse_move_sensor("Y",r),N=T.create_mouse_click_sensor(r),T.create_sensor_manifold(x,"MOUSE_X",T.CT_POSITIVE,[N,n],null,_,"X"),T.create_sensor_manifold(x,"MOUSE_Y",T.CT_POSITIVE,[N,o],null,_,"Y");var ve=0,be=0,Ee=0,Ae=0;n=T.create_touch_move_sensor("X",r),r=T.create_touch_move_sensor("Y",r),T.create_sensor_manifold(x,"TOUCH_X",T.CT_POSITIVE,[n],null,i,"X"),T.create_sensor_manifold(x,"TOUCH_Y",T.CT_POSITIVE,[r],null,i,"Y"),T.create_sensor_manifold(x,"ROT_TRANS_INTERPOL",T.CT_POSITIVE,[e],null,function(e,t){if(1e-5<Math.abs(fe)||1e-5<Math.abs(ue)||1e-5<Math.abs(ve)||1e-5<Math.abs(be)||1e-5<Math.abs(de)||1e-5<Math.abs(pe)||1e-5<Math.abs(Ee)||1e-5<Math.abs(Ae)||1e-5<Math.abs(me)||1e-5<Math.abs(ge)){var a=T.get_sensor_value(e,t,0),r=C.smooth(fe,0,a,.08*U),n=C.smooth(ue,0,a,.08*U);fe-=r,ue-=n;var o=C.smooth(ve,0,a,.12*U),i=C.smooth(be,0,a,.12*U);ve-=o,be-=i;var _=C.smooth(de,0,a,.08*U),c=C.smooth(pe,0,a,.08*U);de-=_,pe-=c;var l=C.smooth(Ee,0,a,.12*U),f=C.smooth(Ae,0,a,.12*U);Ee-=l,Ae-=f;var u=C.smooth(me,0,a,.08*U),a=C.smooth(ge,0,a,.08*U);me-=u,ge-=a,y?(b.rotate_camera(e,r+o,n+i),n=b.target_get_distance(e),b.target_pan_pivot(e,n*(_+l+u),n*(c+f+a))):w?(r+o&&s(e,C.AXIS_X,.2*(r+o)),n+i&&(c=b.get_camera_angles(e,q)[1],s(e,Math.abs(c)>Math.PI/4?C.AXIS_MY:C.AXIS_Z,.2*(n+i))),b.rotate_camera(e,_+l+u,0)):(b.rotate_camera(e,.5*(r+o),.5*(n+i)),S&&(_=b.get_camera_angles_char(e,X),R.set_character_rotation(S,_[0],_[1])))}}),T.create_kb_sensor_manifold(x,"DEC_STEREO_DIST",T.CT_SHOT,T.KEY_LEFT_SQ_BRACKET,function(e){var t=b.get_stereo_distance(e);b.set_stereo_distance(e,.9*t)}),T.create_kb_sensor_manifold(x,"INC_STEREO_DIST",T.CT_SHOT,T.KEY_RIGHT_SQ_BRACKET,function(e){var t=b.get_stereo_distance(e);b.set_stereo_distance(e,1.1*t)})}function m(e){var t=b.get_move_style(e),a=T.create_callback_sensor(function(){var a=b.get_move_style(e),r=a!=t;return t=a,r});T.create_sensor_manifold(e,"CHANGE_MOVE_STYLE",T.CT_POSITIVE,[a],null,function(){g(),p(P,G,F,j,B,H)})}function g(){var e=I.get_active_camera();T.check_sensor_manifold(e,"TOGGLE_CHAR_MOVE_TYPE")&&I.get_first_character()&&A.remove(e);for(var t="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),a=0;a<t.length;a++)T.remove_sensor_manifold(e,t[a])}function h(e,t,a,r){var n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div");if(r)for(var _=0;_<r.length;_++){var s=document.getElementById(r[_]);s&&s.parentNode.removeChild(s)}n.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;",o.style.cssText="color:#fff;font-size:24px;",i.style.cssText="color:#fff;font-size:20px;",o.innerHTML=e,i.innerHTML=t+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+a+'">'+a.replace("https://www.","")+"</a>",n.appendChild(o),n.appendChild(i),document.body.appendChild(n)}function v(e,t,a,r,n){function o(){var _=performance.now()-i;n(t+_*(a-t)/r),(_>=r||!e.parentNode)&&w.remove_loop_cb(o)}var i=performance.now();w.append_loop_cb(o)}var b=t("camera"),E=t("config"),A=t("constraints"),x=t("container"),T=t("controls"),y=t("data"),S=t("debug"),O=t("input"),w=t("main"),R=t("physics"),L=t("print"),N=t("screen"),I=t("scenes"),M=t("transform"),C=t("util"),D=t("vec3"),U=1,k=null,P=!1,G=!1,F=!1,j=null,B=!1,H=!1,X=new Float32Array(2),q=new Float32Array(2),z=new Float32Array(3),W=new Float32Array(3),Y=new Float32Array(4),V={},J={};e.init=function(e){function t(){var e=n(f,M,b,u),t=x.get_canvas();if(e){var _=x.get_container();x.resize_to_container(),O&&(o(d,m),w.set_fps_callback(i)),v&&(a(),r()),p&&w.append_loop_cb(function(){_.style.height=_.clientWidth/p+"px"}),l&&w.append_loop_cb(function(){x.resize_to_container()}),N&&w.append_loop_cb(function(){x.force_offsets_updating()}),h&&E.reset_limits(),I==E.P_AUTO?S.test_performance(function(e,a){0==e?(L.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),E.apply_quality(E.P_HIGH)):1.5>a?(L.log("QUALITY TEST RESULT: LOW ("+a.toFixed(1)+" GB/s)"),E.apply_quality(E.P_LOW)):(L.log("QUALITY TEST RESULT: HIGH ("+a.toFixed(1)+" GB/s)"),E.apply_quality(E.P_HIGH)),s(t,!0)}):s(t,!0)}else s(t,!1)}function _(e){e.keyCode==T.KEY_P&&(w.is_paused()?w.resume():w.pause())}function s(){}e=e||{};var c,l=!1,f=null,u=null,d=null,p=0,m=null,g=!0,h=!1,v=!0,b=!0,A=!1,O=!1,R=!1,N=!1,I=E.get("quality");for(c in e)switch(c){case"canvas_container_id":f=e.canvas_container_id;break;case"callback":s=e.callback;break;case"autoresize":l=e.autoresize;break;case"show_hud_debug_info":R=e.show_hud_debug_info;break;case"sfx_mix_mode":A=e.sfx_mix_mode;break;case"show_fps":O=e.show_fps;break;case"track_container_position":N=e.track_container_position,L.da("track_container_position deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");break;case"fps_wrapper_id":m=e.fps_wrapper_id;break;case"fps_elem_id":d=e.fps_elem_id;break;case"error_purge_elements":u=e.error_purge_elements;break;case"report_init_failure":b=e.report_init_failure;break;case"pause_invisible":v=e.pause_invisible;break;case"key_pause_enabled":g=e.key_pause_enabled;break;case"force_container_ratio":p=e.force_container_ratio;break;case"min_capabilities":h=e.min_capabilities;break;case"quality":I=e.quality;break;default:E.set(c,e[c])}I!=E.P_AUTO&&E.set("quality",I),g&&document.addEventListener("keydown",_,!1),E.set("show_hud_debug_info",R),E.set("sfx_mix_mode",A);var M=R||A||null;"complete"==document.readyState?window.setTimeout(t,0):window.addEventListener("load",t,!1),window.addEventListener("unload",function(){y.cleanup()},!1)},e.set_onclick=function(e,t){var a=_(e);a.addEventListener("mouseup",function(){t(a.value)},!1)},e.set_onchange=function(e,t){var a=_(e);a.addEventListener("change",function(){var e=a.checked;t(void 0!=e?e:a.value)},!1)},e.set_onkeypress=function(e,t){var a=_(e);a.addEventListener("keypress",function(e){t(e.keyCode,a.value)},!1)},e.enable_camera_controls=p,e.disable_camera_controls=g,e.enable_object_controls=function(e){function t(e){return e[0]&&(e[1]||e[2])}function a(e,t,a){if(1==a)switch(a=T.get_sensor_value(e,t,0),t){case"FORWARD":r?R.vehicle_throttle(e,1):M.move_local(e,0,-1*a,0);break;case"BACKWARD":r?R.vehicle_throttle(e,-1):M.move_local(e,0,1*a,0);break;case"LEFT":r?R.vehicle_steer(e,-1):M.move_local(e,1*a,0,0);break;case"RIGHT":r?R.vehicle_steer(e,1):M.move_local(e,-1*a,0,0)}else switch(t){case"FORWARD":case"BACKWARD":r&&R.vehicle_throttle(e,0);break;case"LEFT":case"RIGHT":r&&R.vehicle_steer(e,0)}}var r=R.is_vehicle_chassis(e)||R.is_vehicle_hull(e),n=T.create_elapsed_sensor(),o=T.create_keyboard_sensor(T.KEY_W),i=T.create_keyboard_sensor(T.KEY_S),_=T.create_keyboard_sensor(T.KEY_A),s=T.create_keyboard_sensor(T.KEY_D),c=T.create_keyboard_sensor(T.KEY_UP),l=T.create_keyboard_sensor(T.KEY_DOWN),f=T.create_keyboard_sensor(T.KEY_LEFT),u=T.create_keyboard_sensor(T.KEY_RIGHT);T.create_sensor_manifold(e,"FORWARD",T.CT_CONTINUOUS,[n,o,c],t,a),T.create_sensor_manifold(e,"BACKWARD",T.CT_CONTINUOUS,[n,i,l],t,a),T.create_sensor_manifold(e,"LEFT",T.CT_CONTINUOUS,[n,_,f],t,a),T.create_sensor_manifold(e,"RIGHT",T.CT_CONTINUOUS,[n,s,u],t,a)},e.disable_object_controls=function(e){for(var t=["FORWARD","BACKWARD","LEFT","RIGHT"],a=0;a<t.length;a++)T.remove_sensor_manifold(e,t[a])},e.enable_debug_controls=function(){T.create_kb_sensor_manifold(null,"CAMERA_SHOT",T.CT_SHOT,T.KEY_K,function(){S.make_camera_frustum_shot()}),T.create_kb_sensor_manifold(null,"LIGHT_SHOT",T.CT_SHOT,T.KEY_L,function(){S.make_light_frustum_shot()}),T.create_kb_sensor_manifold(null,"TELEMETRY",T.CT_SHOT,T.KEY_T,function(){S.plot_telemetry()})},e.request_fullscreen=function(e,t,a){L.xd("request_fullscreen","screen.request_fullscreen"),N.request_fullscreen(e,t,a)},e.exit_fullscreen=function(){L.xd("exit_fullscreen","screen.exit_fullscreen"),N.exit_fullscreen()},e.check_fullscreen=function(){return L.xd("check_fullscreen","screen.check_fullscreen"),N.check_fullscreen()},e.report_app_error=h,e.get_url_params=function(e){e=!!e;var t=decodeURIComponent(location.href.toString());if(-1==t.indexOf("?"))return null;for(var t=t.split("?")[1].split("&"),a={},r=0;r<t.length;r++){var n=t[r].split("="),o=n[0];1<n.length?(n=n[1],e?o in a?a[o].push(n):a[o]=[n]:a[o]=n):e?o in a||(a[o]=[]):a[o]=""}return a},e.css_animate=function(e,t,a,r,n,o,i,_){if(e&&t&&isFinite(a)&&isFinite(r)&&isFinite(n)){o=o||"",i=i||"",_=_||function(){};var s=e.style,c=t.charAt(0).toUpperCase()+t.slice(1);if(void 0==s[t])if(void 0!=s["webkit"+c])t="webkit"+c;else if(void 0!=s["ms"+c])t="ms"+c;else{if(void 0==s["moz"+c])return;t="moz"+c}v(e,a,r,n,function(n){e&&(s[t]=o+n+i,a>r&&n<=r||a<r&&n>=r)&&(s[t]=o+r+i,_())})}},e.attr_animate=function(e,t,a,r,n,o){e&&t&&isFinite(a)&&isFinite(r)&&isFinite(n)&&(o=o||function(){},v(e,a,r,n,function(n){e&&(0<=n&&e.setAttribute(t,n),a>r&&n<=r||a<r&&n>=r)&&(e.setAttribute(t,r),o())}))},e.queue_animate=function(t){if(t.length){var a=t.shift(),r=a.elem,n=a.prop,o=a.from,i=a.to,_=a.duration,s=a.opt_prefix,c=a.opt_suffix,l=function(){a.cb&&a.cb(),e.queue_animate(t)};"css"==a.type?e.css_animate(r,n,o,i,_,s,c,l):"attr"==a.type&&e.attr_animate(r,n,o,i,_,l)}},e.set_camera_smooth_factor=function(e){U=e},e.get_camera_smooth_factor=function(){return U}},a.module.camera_anim=function(e,t){function a(e,t,a,n,o){return a=l.angle_wrap_0_2pi(t-a),a=Math.min(a,2*Math.PI-a),t=l.angle_wrap_0_2pi(n-t),t=Math.min(t,2*Math.PI-t),(1e-6>Math.abs(a)||1e-6>2*Math.PI-Math.abs(a))&&(a=0),(1e-6>Math.abs(t)||1e-6>2*Math.PI-Math.abs(t))&&(t=0),r.is_eye_camera(e)?(o[0]=t,o[1]=a):(o[0]=a,o[1]=t),o}var r=t("camera"),n=t("controls"),o=t("print"),i=t("scenes"),_=t("time"),s=t("transform"),c=t("tsr"),l=t("util"),f=t("vec3"),u=new Float32Array(2),d=new Float32Array(2),p=new Float32Array(3),m=new Float32Array(3),g=new Float32Array(3),h=c.create(),v=c.create(),b=c.create(),E={},A=!1,x=!1,T=!1,y=!1;e.track_to_target=function(e,t,a,i,c,h,v,b){if(r.is_eye_camera(e)){if(l.is_vector(t))var E=t;else E=p,s.get_object_center(t,!1,E);a=a||1,i=i||2,c=c||1,h=h||1;var A=s.get_translation(e,m);t=f.subtract(E,A,g);var E=r.get_camera_angles(e,u),x=r.get_camera_angles_dir(t,d),T=x[0]-E[0],y=x[1]-E[1],S=Math.abs(Math.acos(Math.cos(T)*Math.cos(y))/a),O=f.length(t)*(1-1/i),w=function(e){return 6*e*(1-e)},R=_.get_timeline(),L=0,N=function(){n.remove_sensor_manifold(e,"TRACK_TO_TARGET"),v&&v()};a=n.create_timeline_sensor(),i=n.create_elapsed_sensor(),n.create_sensor_manifold(e,"TRACK_TO_TARGET",n.CT_CONTINUOUS,[a,i],null,function(t,a,o){r.is_eye_camera(t)?1==o&&(o=n.get_sensor_value(t,a,0)-R,a=n.get_sensor_value(t,a,1),o<S?(o=w(o/S),r.rotate_camera(e,o*T*a/S,o*y*a/S)):o<S+c?(L||(r.rotate_camera(e,x[0],x[1],!0),L++),o=w(o-S/c),a=o*O*a/c,s.move_local(t,0,0,-a)):o<S+c+h?1>=L&&(r.rotate_camera(e,x[0],x[1],!0),r.eye_set_look_at(e,A),s.move_local(t,0,0,-O),b&&b(),L++):o<S+c+h+c?(2>=L&&(r.rotate_camera(e,x[0],x[1],!0),r.eye_set_look_at(e,A),s.move_local(t,0,0,-O),L++),o=w(o-S-c-h/c),a=o*O*a/c,s.move_local(t,0,0,a)):(r.rotate_camera(e,x[0],x[1],!0),r.eye_set_look_at(e,A),N())):N()})}else o.error("track_to_target(): Wrong camera object or camera move style")},e.auto_rotate=function(e,t,_){function s(t,o,i){if(1==i)if((i=r.get_move_style(t))==r.MS_STATIC)c();else if(i!=r.MS_TARGET_CONTROLS&&i!=r.MS_EYE_CONTROLS||!r.has_horizontal_rot_limits(t))p=null,o=n.get_sensor_value(t,o,0),r.rotate_camera(t,o*e,0);else{if(i=i==r.MS_EYE_CONTROLS?r.eye_get_horizontal_limits(t,E):r.target_get_horizontal_limits(t,E),null===p||i.left!=p.left||i.right!=p.right){p=p||{},p.left=i.left,p.right=i.right,m=Math.min(.2,l.angle_wrap_0_2pi(p.right-p.left)/2),i=f;var _=p,s=r.get_camera_angles(i,u)[0];i=a(i,s,_.left,_.right,d),g=e*Math.min(1,i[0]/.2,i[1]/.2)}o=n.get_sensor_value(t,o,0),i=r.get_camera_angles(t,u)[0],i=a(t,i,p.left,p.right,d),i[1]>m&&i[0]>m?g=l.sign(g)*e:i[1]<m?g-=Math.pow(e,2)/.4*o:i[0]<m&&(g+=Math.pow(e,2)/.4*o),r.rotate_camera(t,o*g,0)}}function c(){n.remove_sensor_manifold(f,"AUTO_ROTATE"),n.remove_sensor_manifold(f,"DISABLE_AUTO_ROTATE"),t()}t=t||function(){};var f=i.get_active_camera();if(r.is_static_camera(f))o.error("auto_rotate(): Wrong camera move style");else{var p={},m=0,g=0;if(n.check_sensor_manifold(f,"AUTO_ROTATE"))c();else{var h=n.create_mouse_move_sensor("X"),v=n.create_mouse_move_sensor("Y"),b=n.create_mouse_click_sensor(),A=n.create_touch_move_sensor(),x=n.create_touch_zoom_sensor(),T=n.create_elapsed_sensor();_=_?n.create_mouse_wheel_sensor():n.create_custom_sensor(0),n.create_sensor_manifold(f,"DISABLE_AUTO_ROTATE",n.CT_LEVEL,[h,v,b,A,x,_],function(e){return e[0]&&e[2]||e[1]&&e[2]||e[3]||e[4]||e[5]},c),n.create_sensor_manifold(f,"AUTO_ROTATE",n.CT_CONTINUOUS,[T],function(e){return e[0]},s)}}},e.is_auto_rotate=function(){var e=i.get_active_camera();return n.check_sensor_manifold(e,"AUTO_ROTATE")},e.check_auto_rotate=function(){var e=i.get_active_camera();return r.get_move_style(e)!=r.MS_STATIC},e.move_camera_to_point=function(e,t,a,n,i){if(r.get_move_style(e)!=r.MS_STATIC)o.error("move_camera_to_point(): wrong camera type");else if(!A)if(e)if(t){a=a||1,n=n||.01;var u=l.is_vector(e)?e:s.get_tsr(e,h),d=l.is_vector(t)?t:s.get_tsr(t,v);t=f.distance(c.get_trans_view(u),c.get_trans_view(d))/a,a=l.quat_to_dir(c.get_quat_view(u),l.AXIS_MZ,p);var g=l.quat_to_dir(c.get_quat_view(d),l.AXIS_MZ,m);a=Math.min(Math.abs(f.dot(a,g)),1),n=1e3*Math.max(t,Math.acos(a)/n),A=!0;var E=_.animate(0,1,n,function(t){var a=c.interpolate(u,d,l.smooth_step(t),b);T?(_.clear_animation(E),A=T=!1):(s.set_tsr(e,a),1==t&&(A=!1,i&&i()))})}else o.error("move_camera_to_point(): you must specify the point object");else o.error("move_camera_to_point(): you must specify the camera object")},e.rotate_camera=function(e,t,a,n,i){if(r.get_move_style(e)==r.MS_STATIC)o.error("rotate_camera(): not supported for STATIC cameras");else if(!x)if(e)if(t||a){x=!0;var s=0,c=0,l=t||a,f=_.animate(0,l,n||1e3,function(n){y?(_.clear_animation(f),x=y=!1):(s-=n,c-=n,a&&t?r.rotate_camera(e,s,c):a?r.rotate_camera(e,0,c):t&&r.rotate_camera(e,s,0),c=s=n,n==l&&(x=!1,i&&i()))})}else o.error("rotate_camera(): you must specify the rotation angle");else o.error("rotate_camera(): you must specify the camera object")},e.stop_cam_moving=function(){T=!0},e.stop_cam_rotating=function(){y=!0},e.is_moving=function(){return A},e.is_rotating=function(){return x}},a.module.gp_conf=function(e,t){function a(){R.length=0;for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)e[t]&&R.push(e[t]);return R}function r(e){var t=m.get(e+"_gmpd_stngs","b4w");if(t){var a,t=JSON.parse(t);for(a in t)p.set_gamepad_key(e,a,t[a])}else a=JSON.stringify(h),m.set(e+"_gmpd_stngs",a,"b4w")}function n(e){M=!0;var t=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),_=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),f=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div"),h=document.createElement("div"),b=document.createElement("div"),E=document.createElement("div"),A=document.createElement("div"),x=document.createElement("div"),y=document.createElement("div"),S=document.createElement("div"),O=document.createElement("div"),w=document.createElement("div");for(T=t,t.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;",a.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;",r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;",n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;",o.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;",i.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;",_.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;",s.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;",l.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;",f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;",u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+"');width: 50px;height: 50px;top: 51px;position: absolute;",d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;",m.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;",h.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;",b.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;",E.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;",A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;",x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;",y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;",S.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;",O.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;",w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;",t.appendChild(O),t.appendChild(w),a.appendChild(r),a.appendChild(n),a.appendChild(o),a.appendChild(i),t.appendChild(a),_.appendChild(s),_.appendChild(l),_.appendChild(f),_.appendChild(u),t.appendChild(_),t.appendChild(d),t.appendChild(m),t.appendChild(h),t.appendChild(b),t.appendChild(E),t.appendChild(A),t.appendChild(x),e.appendChild(t),t.appendChild(y),t.appendChild(S),L.length=0,v.length=0,N.length=0,I.length=0,L.push(f,l,u,s,E,A,y,x,h,b,d,m,r,o,i,n,S),v.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>','<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>','<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>','<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>','<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>','<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>','<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>','<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>','<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>','<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>','<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>','<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>','<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>','<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>','<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>'),N.push(d,d,m,m),I.push(O,w),e=0;e<L.length;e++)L[e].setAttribute("id","pad_btn_"+e),L[e].setAttribute("data-colorstate","B"),L[e].setAttribute("data-key",e),L[e].setAttribute("data-svgid",e);O.setAttribute("id","pad_left_axis"),O.setAttribute("data-colorstate","GR"),O.setAttribute("data-key",p.GMPD_AXIS_0),O.setAttribute("data-svgid",v.length),w.setAttribute("id","pad_right_axis"),w.setAttribute("data-colorstate","GR"),w.setAttribute("data-key",p.GMPD_AXIS_2),w.setAttribute("data-svgid",v.length+1),v.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>','<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>'),c(L,g),c(I,"#e6e6e6")}function o(e){return[d.create_gamepad_btn_sensor(p.GMPD_BUTTON_0,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_1,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_2,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_3,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_4,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_5,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_6,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_7,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_8,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_9,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_10,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_11,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_12,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_13,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_14,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_15,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_16,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_17,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_18,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_19,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_20,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_21,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_22,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_23,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_24,e),d.create_gamepad_btn_sensor(p.GMPD_BUTTON_25,e)]}function i(e){return[d.create_gamepad_axis_sensor(p.GMPD_AXIS_0,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_1,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_2,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_3,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_4,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_5,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_6,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_7,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_8,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_9,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_10,e),d.create_gamepad_axis_sensor(p.GMPD_AXIS_11,e)]}function _(e,t){var a=document.createElement("input");a.style.cssText="display: inline-block;position = relative;",a.setAttribute("type","radio"),a.setAttribute("name","choice");var r=document.createElement("label");return r.textContent=t,r.style.cssText="position = relative;display: inline-block;color: white;",e.appendChild(a),e.appendChild(r),a}function s(e){switch(x.removeChild(T),T=null,e){case"PAD":O.checked=!0,n(x);break;case"WHEEL":S.checked=!0;var t=x;M=!1;var a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),_=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),f=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div"),h=document.createElement("div"),b=document.createElement("div"),E=document.createElement("div"),A=document.createElement("div"),y=document.createElement("div"),w=document.createElement("div"),R=document.createElement("div"),C=document.createElement("div"),D=document.createElement("div"),U=document.createElement("div"),k=document.createElement("div"),P=document.createElement("div"),G=document.createElement("div");e=document.createElement("div");var F=document.createElement("div"),j=document.createElement("div"),B=document.createElement("div"),H=document.createElement("div"),X=document.createElement("div");T=a;var q="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+"');width: 19px;height: 19px;background-size: 100% 100%;";for(a.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;",r.style.cssText=q+"top: 132px;left: 331px;",o.style.cssText=q+"top: 122px;left: 315px;",i.style.cssText=q+"top: 122px;left: 347px;",_.style.cssText=q+"top: 113px;left: 331px;",s.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;",l.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;",f.style.cssText=q+"top: 107px;left: 141px;",u.style.cssText=q+"top: 107px;left: 90px;",d.style.cssText=q+"top: 185px;left: 321px;",m.style.cssText=q+"top: 185px;left: 340px;",h.style.cssText=q+"top: 179px;left: 358px;",b.style.cssText=q+"top: 178px;left: 303px;",E.style.cssText=q+"top: 210px;left: 299px;",A.style.cssText=q+"top: 279px;left: 299px;",y.style.cssText=q+"top: 210px;left: 321px;",w.style.cssText=q+"top: 279px;left: 321px;",R.style.cssText=q+"top: 210px;left: 344px;",C.style.cssText=q+"top: 278px;left: 344px;",D.style.cssText=q+"top: 124px;left: 147px;",U.style.cssText=q+"top: 138px;left: 133px;",k.style.cssText=q+"top: 124px;left: 82px;",P.style.cssText=q+"top: 138px;left: 96px;",G.style.cssText=q+"top: 278px;left: 367px;",q="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+"');width: 19px;height: 46px;background-size: 100% 100%;",e.style.cssText=q+"top: 291px;left: 50px;",F.style.cssText=q+"top: 291px;left: 111px;",j.style.cssText=q+"top: 291px;left: 171px;",B.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;",H.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;",X.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;",t.appendChild(a),a.appendChild(e),a.appendChild(F),a.appendChild(j),a.appendChild(B),a.appendChild(H),a.appendChild(X),a.appendChild(r),a.appendChild(o),a.appendChild(i),a.appendChild(_),a.appendChild(s),a.appendChild(l),a.appendChild(f),a.appendChild(u),a.appendChild(d),a.appendChild(m),a.appendChild(h),a.appendChild(b),a.appendChild(E),a.appendChild(A),a.appendChild(y),a.appendChild(w),a.appendChild(R),a.appendChild(C),a.appendChild(D),a.appendChild(U),a.appendChild(k),a.appendChild(P),a.appendChild(G),L.length=0,v.length=0,N.length=0,I.length=0,L.push(r,o,i,_,s,l,f,u,d,m,h,b,E,A,y,w,R,C,D,U,k,P,G),v.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>','<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>','<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>'),I.push(B,e,j,F,H,X),t=0;t<L.length;t++)L[t].setAttribute("id","wheel_btn_"+t),L[t].setAttribute("data-colorstate","B"),L[t].setAttribute("data-key",t),L[t].setAttribute("data-svgid",t);for(t=0;t<I.length;t++)L[t].setAttribute("id","wheel_axis_"+t),L[t].setAttribute("data-colorstate","GR");B.setAttribute("data-key",p.GMPD_AXIS_0),B.setAttribute("data-svgid",v.length),e.setAttribute("data-key",p.GMPD_AXIS_1),e.setAttribute("data-svgid",v.length+1),j.setAttribute("data-key",p.GMPD_AXIS_2),j.setAttribute("data-svgid",v.length+2),F.setAttribute("data-key",p.GMPD_AXIS_3),F.setAttribute("data-svgid",v.length+3),H.setAttribute("data-key",p.GMPD_AXIS_4),H.setAttribute("data-svgid",v.length+4),X.setAttribute("data-key",p.GMPD_AXIS_5),X.setAttribute("data-svgid",v.length+5),v.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>','<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>','<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>','<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>','<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>','<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>'),c(L,g),c(I,"#e6e6e6")}}function c(e,t){function a(e){if(e=e.target,!(0>b||"G"==e.getAttribute("data-colorstate")))if(A){if("R"==e.getAttribute("data-colorstate")&&(E=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",A=0),"B"==e.getAttribute("data-colorstate")||"GR"==e.getAttribute("data-colorstate")){var a=parseFloat(E.getAttribute("data-svgid"));E.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(v[a])+"')",E.setAttribute("data-colorstate",e.getAttribute("data-colorstate")),E=e,a=parseFloat(e.getAttribute("data-svgid")),e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(v[a].replace(t,"#ff0000"))+"')",e.setAttribute("data-colorstate","R")}}else{var a=parseFloat(e.getAttribute("data-svgid")),r="B"==e.getAttribute("data-colorstate")?1:2;A=r,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(v[a].replace(t,"#ff0000"))+"')",e.setAttribute("data-colorstate","R"),document.getElementById("action_label").textContent=1==r?"Now press the button on the device":"Now move the axis on the device",E=e}}for(var r=0;r<e.length;r++)p.add_click_listener(e[r],a)}function l(e){var t=document.createElement("label");return t.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;",t.textContent=e,t}function f(){var e=window.innerWidth,t=window.innerHeight;x.style.zoom=750>=t&&400<t||750>=e&&400<e?"0.5":400>=e||400>=t?"0.3":"1"}var u=t("container"),d=t("controls"),p=t("input"),m=t("storage"),g=RegExp("#5276cf","g"),h={};h[p.GMPD_BUTTON_12]=p.GMPD_BUTTON_12,h[p.GMPD_BUTTON_13]=p.GMPD_BUTTON_13,h[p.GMPD_BUTTON_15]=p.GMPD_BUTTON_15,h[p.GMPD_BUTTON_14]=p.GMPD_BUTTON_14,h[p.GMPD_BUTTON_3]=p.GMPD_BUTTON_3,h[p.GMPD_BUTTON_0]=p.GMPD_BUTTON_0,h[p.GMPD_BUTTON_1]=p.GMPD_BUTTON_1,h[p.GMPD_BUTTON_2]=p.GMPD_BUTTON_2,h[p.GMPD_BUTTON_5]=p.GMPD_BUTTON_5,h[p.GMPD_BUTTON_7]=p.GMPD_BUTTON_7,h[p.GMPD_BUTTON_4]=p.GMPD_BUTTON_4,h[p.GMPD_BUTTON_6]=p.GMPD_BUTTON_6,h[p.GMPD_BUTTON_8]=p.GMPD_BUTTON_8,h[p.GMPD_BUTTON_9]=p.GMPD_BUTTON_9,h[p.GMPD_BUTTON_10]=p.GMPD_BUTTON_10,h[p.GMPD_BUTTON_11]=p.GMPD_BUTTON_11,h[p.GMPD_BUTTON_16]=p.GMPD_BUTTON_16;var v=[],b=-1,E=null,A=0,x=null,T=null,y=null,S=null,O=null,w=null,R=[],L=[],N=[],I=[],M=!0,C={};C[p.GMPD_AXIS_0]=-2,C[p.GMPD_AXIS_1]=-2,C[p.GMPD_AXIS_2]=-2,C[p.GMPD_AXIS_3]=-2,C[p.GMPD_AXIS_4]=-2,C[p.GMPD_AXIS_5]=-2,C[p.GMPD_AXIS_6]=-2,C[p.GMPD_AXIS_7]=-2,C[p.GMPD_AXIS_8]=-2,C[p.GMPD_AXIS_9]=-2,C[p.GMPD_AXIS_10]=-2,C[p.GMPD_AXIS_11]=-2,e.show=function(){var e=document.createElement("div");x=e,e.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);",u.insert_to_container(e,"LAST"),n(e);var t=document.createElement("div");t.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var c=document.createElement("div");for(c.innerHTML="Select a device",c.style.cssText="color: #fff;display: inline-block;",t.appendChild(c),c=0;4>c;c++){var h=o(c),T=function(){return!0},R=function(e,t){if(t==b)for(var a=0;a<L.length;a++){var r=L[a],n=d.get_sensor_value(e,t,a),o=a;if(A)0<=(n=p.get_pressed_gmpd_btn(b))&&E&&1==A&&(r=E.getAttribute("data-key"),p.set_gamepad_key(b,r,n),o=m.get(b+"_gmpd_stngs","b4w")||"{}",o=JSON.parse(o),o[r]=n,m.set(b+"_gmpd_stngs",JSON.stringify(o),"b4w"),E=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",A=0);else{if(n&&"B"==r.getAttribute("data-colorstate")){var i=v[o];r.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(i.replace(g,"#00ff00"))+"')",r.setAttribute("data-colorstate","G")}n||"B"==r.getAttribute("data-colorstate")||(i=v[o],r.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(i)+"')",r.setAttribute("data-colorstate","B"))}}};d.create_sensor_manifold(null,c,d.CT_CONTINUOUS,h,T,R)}0<a().length&&(b=0);var D=[],c=document.createElement("div");for(c.style.cssText="margin-top: 20px;",h=0;4>h;h++)R=l(h),h==b&&(R.style.backgroundColor="green",y=R),r(h),c.appendChild(R),R.setAttribute("data-device_type","PAD"),D.push(R),p.add_click_listener(R,function(e){var t=a();e=e.target;for(var n=0;n<t.length;n++)D[n]==e&&(b=n,y=e,r(b),s(e.getAttribute("data-device_type")))});for(t.appendChild(c),w=document.createElement("label"),w.style.cssText="position: relative;display: block;color: white;",t.appendChild(w),c=document.createElement("div"),c.style.cssText="margin-top: 20px;",h=_(c,"Pad"),R=_(c,"Wheel"),h.setAttribute("checked","true"),h.onchange=function(){s("PAD"),y&&y.setAttribute("data-device_type","PAD")},R.onchange=function(){s("WHEEL"),y&&y.setAttribute("data-device_type","WHEEL")},h.setAttribute("id","test"),O=h,S=R,h=document.createElement("label"),h.style.cssText+="color: #fff;display: block;",c.appendChild(h),h.textContent="Click on the buttons & arrows to setup your controller",h.setAttribute("id","action_label"),t.appendChild(c),e.appendChild(t),e=d.create_elapsed_sensor(),d.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",d.CT_CONTINUOUS,[e],T,function(){var e=a(),t=e.length;-1==b&&e.length&&(b=e[0].index,y=D[b]);for(var r=0;r<D.length;r++)r<t?(D[r].textContent=e[r].index,D[r]==y?(D[r].style.backgroundColor="green",w.textContent="Selected device: "+e[r].index+". Data: "+e[r].id):D[r].style.backgroundColor="blue"):D[r].style.backgroundColor="black";t||(b=-1,w.textContent="")}),c=0;4>c;c++)h=i(c),R=function(e,t){if(t=="AXES"+b){for(var a=0;a<N.length;a+=2){var r=N[a],n=e,o=t,i=a,_=20*d.get_sensor_value(n,o,i),n=20*d.get_sensor_value(n,o,i+1);r.style.transform="translate3d("+_+"px, "+n+"px, 0px) rotate(0rad)"}if(M){for(a=0;12>a;a+=2)if(n=e,o=t,!((r=a)+1>2*I.length)){if(_=d.get_sensor_value(n,o,r),n=d.get_sensor_value(n,o,r+1),-2<C[r]){var s=_-C[r],c=n-C[r+1],o=I[Math.floor(r/2)],i=o.getAttribute("data-svgid");A?2==A&&0<=(s=p.get_moved_gmpd_axis(b))&&(s%2&&s--,A=0,o.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(v[i])+"')",o=parseFloat(E.getAttribute("data-key")),p.set_gamepad_key(b,o,s),p.set_gamepad_key(b,o+1,s+1),E=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"):o.style.backgroundImage=s||c?"url('data:image/svg+xml;base64,"+btoa(v[i].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(v[i])+"')"}C[r]=_,C[r+1]=n}}else for(a=0;12>a;a++)(r=a)>=I.length||(_=d.get_sensor_value(e,t,r),-2<C[r]&&(i=_-C[r],n=I[r],o=n.getAttribute("data-svgid"),A?2==A&&0<=(i=p.get_moved_gmpd_axis(b))&&(A=0,n.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(v[o])+"')",n=parseFloat(E.getAttribute("data-key")),p.set_gamepad_key(b,n,i),E=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"):n.style.backgroundImage=i?"url('data:image/svg+xml;base64,"+btoa(v[o].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(v[o])+"')"),C[r]=_)}},d.create_sensor_manifold(null,"AXES"+c,d.CT_CONTINUOUS,h,function(){return!0},R);f(),window.addEventListener("resize",f)},e.hide=function(){A=0,b=-1,O=S=E=y=null,N.length=0,L.length=0,I.length=0,u.get_container().removeChild(x),x=null,d.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var e=0;4>e;e++)d.remove_sensor_manifold(null,e),d.remove_sensor_manifold(null,"AXES"+e);window.removeEventListener("resize",f)},e.update=function(){for(var e=0;4>e;e++)r(e)}},a.module.gyroscope=function(e,t){function a(e){var t=n.create_gyro_angles_sensor(),a=n.create_gyro_quat_sensor(),o=!0;n.create_sensor_manifold(e,"CAMERA_ROTATE_GYRO",n.CT_CONTINUOUS,[t,a],null,function(e,t,a){0<a&&(r.is_eye_camera(e)?(t=n.get_sensor_payload(e,t,1),a=s.transformQuat(_.AXIS_MY,t,f),r.set_vertical_axis(e,a),i.set_rotation_v(e,t)):(l=n.get_sensor_payload(e,t,0),o&&(c[0]=l[0],c[1]=l[1],c[2]=l[2],o=!1),a=t=0,window.orientation||(t=l[1]-c[1],a=l[0]-c[0],l[1]>d&&l[1]<u&&(a=0)),180==window.orientation&&(t=l[1]-c[1],0>l[1]&&(t=-t),a=c[0]-l[0],(t>Math.PI/2||t<-Math.PI/2)&&(t=0),l[1]>-u&&l[1]<-d&&(a=0)),-90==window.orientation&&(t=l[0]-c[0],(t>Math.PI/2||t<-Math.PI/2)&&(t=0),a=c[1]-l[1],(l[0]>p||l[0]<m)&&(a=0)),90==window.orientation&&(t=c[0]-l[0],(t>Math.PI/2||t<-Math.PI/2)&&(t=0),a=l[1]-c[1],(l[0]>p||l[0]<m)&&(a=0)),r.rotate_camera(e,a,t),c[0]=l[0],c[1]=l[1],c[2]=l[2]))})}var r=t("camera"),n=t("controls"),o=t("scenes"),i=t("transform"),_=t("util"),s=t("vec3"),c=new Float32Array(3),l=new Float32Array(3),f=s.create(),u=_.deg_to_rad(110),d=_.deg_to_rad(70),p=_.deg_to_rad(70),m=-_.deg_to_rad(70);e.enable_camera_rotation=function(){a(o.get_active_camera())},e.disable_camera_rotation=function(){var e=o.get_active_camera();n.remove_sensor_manifold(e,"CAMERA_ROTATE_GYRO")}},a.module.hmd_conf=function(e,t){function a(){if(!d.can_use_device(d.DEVICE_HMD))return!1;var e=d.get_device_by_type_element(d.DEVICE_HMD),e=d.get_value_param(e,d.HMD_WEBVR_TYPE);return e&(d.HMD_NON_WEBVR|d.HMD_WEBVR_MOBILE|d.HMD_WEBVR_DESKTOP)&&!(e&d.HMD_WEBVR1)}function r(e){e=e.target.value;var t,a=y[e];for(t in x)if(t in a){var r=document.getElementById(t+"_slider");r&&(r.disabled="custom"!==e,r.value=a[t]),(r=document.getElementById(t+"_number"))&&(r.disabled="custom"!==e,r.value=a[t]),x[t]=a[t]}}function n(){u.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING"),i(),s(),h&&(h=!1,f.get_container().removeChild(v),document.head.removeChild(b),b=E=v=null)}function o(){i(!0),s();for(var e in x){var t=document.getElementById(e+"_slider");t&&(t.value=x[e]),(t=document.getElementById(e+"_number"))&&(t.value=x[e])}}function i(e){var t,a=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,r=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,n=0,o=0,i=0;e:{t=O;var _=navigator.userAgent||navigator.vendor||window.opera;if(1==t.format&&t.devices&&t.devices.length)for(var s=0;s<t.devices.length;s++){var c=t.devices[s];if(c.rules&&("ios"==c.type&&T||"android"==c.type)){for(var l=!1,f=0;f<c.rules.length;f++){var u=c.rules[f];if(u.ua&&0<=_.indexOf(u.ua)||!u.ua&&u.res&&u.res[0]&&u.res[1]&&Math.min(a,r)==Math.min(u.res[0],u.res[1])&&Math.max(a,r)==Math.max(u.res[0],u.res[1])){l=!0;break}}if(l){t=s;break e}}}else p.error("DPDB isn't correct.");t=-1}-1!=t&&(i=O.devices[t],o=i.dpi[1]||i.dpi,n=Math.round(25.4*a/(i.dpi[0]||i.dpi)),o=Math.round(25.4*r/o),i=Math.round(i.bw)),a=m.get("hmd_conf","b4w"),a=JSON.parse(a||"{}"),e?(x.first_distortion=.34,x.second_distortion=.55,x.bevel_size=i||4,x.screen_width=n||110,x.screen_height=o||65,x.screen_lense=50,x.ipd=64,x.baseline=32):(x.first_distortion="first_distortion"in a?parseFloat(a.first_distortion):.34,x.second_distortion="second_distortion"in a?parseFloat(a.second_distortion):.55,x.bevel_size="bevel_size"in a?parseFloat(a.bevel_size):i||4,x.screen_width="screen_width"in a?parseFloat(a.screen_width):n||110,x.screen_height="screen_height"in a?parseFloat(a.screen_height):o||65,x.screen_lense="screen_lense"in a?parseFloat(a.screen_lense):50,x.ipd="ipd"in a?parseFloat(a.ipd):64,x.baseline="baseline"in a?parseFloat(a.baseline):32),A=!0}function _(){m.set("hmd_conf",JSON.stringify(x),"b4w"),n()}function s(){if(A){var e=d.get_device_by_type_element(d.DEVICE_HMD);e&&(d.set_config(e,d.HMD_DISTORTION,[x.first_distortion,x.second_distortion]),d.get_value_param(e,d.HMD_WEBVR_TYPE)&(d.HMD_NON_WEBVR|d.HMD_WEBVR_MOBILE)&&(d.set_config(e,d.HMD_BEVEL_SIZE,.001*x.bevel_size),d.set_config(e,d.HMD_SCREEN_WIDTH,.001*x.screen_width),d.set_config(e,d.HMD_SCREEN_HEIGHT,.001*x.screen_height),d.set_config(e,d.HMD_SCREEN_LENS_DIST,.001*x.screen_lense),d.set_config(e,d.HMD_EYE_DISTANCE,.001*x.ipd),d.set_config(e,d.HMD_BASELINE_DIST,.001*x.baseline))),A=!1}}function c(e){var t=e.target.id.split("_"),t=t.splice(0,t.length-1).join("_");t in x&&x[t]!=e.target.value&&(A=!0,x[t]=e.target.value,document.getElementById(t+"_slider").value=e.target.value,document.getElementById(t+"_number").value=e.target.value)}function l(e,t,a){var r=document.createElement("button");return r.onclick=e,r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+a+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",r.innerHTML=t,r}var f=t("container"),u=t("controls"),d=t("input"),p=t("print"),m=t("storage"),g=t("util"),h=!1,v=null,b=null,E=null,A=!0,x={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},T=/iPad|iPhone|iPod/.test(navigator.platform),y={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},S=[{label:"Tray to lens-center distance.",Xn:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",Xn:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",Xn:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",Xn:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",Xn:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",Xn:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];e.check=a,e.show=function(e){if(a()){var t=f.get_container();if(b=document.createElement("style"),b.innerHTML="."+e+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+e+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}",document.head.appendChild(b),!h){h=!0,i();var p=d.get_device_by_type_element(d.DEVICE_MOUSE,t);d.switch_prevent_default(p,!1),p=d.get_device_by_type_element(d.DEVICE_TOUCH,t),d.switch_prevent_default(p,!1),v=document.createElement("div"),v.className=e,t.appendChild(v),E=document.createElement("div"),v.appendChild(E),E.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;",e=m.get("hmd_conf","b4w"),e=JSON.parse(e||"{}").profile||"custom",t=document.createElement("div"),p=document.createElement("label"),p.innerHTML="Profile: ",p.className="text_label",p.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",t.appendChild(p),p=document.createElement("select"),t.appendChild(p),p.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var A=d.get_device_by_type_element(d.DEVICE_HMD);if(A)for(var T in y)if(0==y[T].type||d.get_value_param(A,d.HMD_WEBVR_TYPE)&(d.HMD_NON_WEBVR|d.HMD_WEBVR_MOBILE)&&1==y[T].type){var O=document.createElement("option");O.value=T,O.text=y[T].name,p.appendChild(O)}for(p.value=e,g.is_ie11()?p.onchange=r:p.oninput=r,E.appendChild(t),T=d.get_device_by_type_element(d.DEVICE_HMD),e=0;e<S.length;e++)if(d.get_value_param(T,d.HMD_WEBVR_TYPE)&(d.HMD_NON_WEBVR|d.HMD_WEBVR_MOBILE)||!S[e].Xn){t=S[e],A=e,p=document.createElement("div"),O=document.createElement("label"),O.className="text_label";var w="8px";for(A%2&&(w="0"),O.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",O.textContent=t.label,p.appendChild(O),p.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+w+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;",A=0;A<t.inputs.length;A++){O=t.inputs[A],w=document.createElement("div"),w.className="row";var R=document.createElement("input");R.className="input_slider",R.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;",R.setAttribute("id",O.id+"_slider"),R.setAttribute("type","range"),R.setAttribute("min","0.00"),R.setAttribute("step",O.step),R.setAttribute("value",x[O.id]),R.setAttribute("max",O.max),w.appendChild(R);var L=document.createElement("input");L.className="input_text",L.setAttribute("id",O.id+"_number"),L.setAttribute("type","number"),L.setAttribute("min","0.00"),L.setAttribute("step",O.step),L.setAttribute("value",x[O.id]),L.setAttribute("max",O.max),w.appendChild(L),L.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",g.is_ie11()?(R.onchange=c,L.onchange=c):(R.oninput=c,L.oninput=c),p.appendChild(w)}E.appendChild(p)}T=document.createElement("div"),e=l(_,"SAVE","4px"),t=l(n,"CANCEL","4px"),p=l(o,"RESET","0px"),T.className="row",T.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;",T.appendChild(e),T.appendChild(t),T.appendChild(p),E.appendChild(T),T=u.create_timeline_sensor(),u.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",u.CT_CONTINUOUS,[T],null,s)}}},e.hide=n,e.reset=o,e.update=function(){i(),s()};var O={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}},a.module.hmd=function(e,t){function a(){o.remove_sensor_manifold(null,"VR_CONTROLLERS")}function r(e,t){function a(t,a,r){if(0<r&&(r=s.get_active_camera())&&n.is_eye_camera(r)){var i=o.get_sensor_payload(t,a,1);if(t=o.get_sensor_payload(t,a,2),t=u.add(t,O,v),l.set_translation_v(r,t),i)if(1==e){var i=_.multiply(S,i,y),c=u.transformQuat(f.AXIS_MY,i,v);n.set_vertical_axis(r,c),l.set_rotation_v(r,i)}else if(2==e||3==e){t=l.get_rotation(r,x),t=_.invert(t,x),a=_.multiply(d,t,x),t=n.get_vertical_axis(r,v),Math.abs(t[2])<Math.PI/4?c=u.cross(t,f.AXIS_MY,b):Math.abs(t[1])<Math.PI/4&&(c=u.cross(t,f.AXIS_Z,b)),u.normalize(c,c),a=u.transformQuat(c,a,E);var m=u.dot(t,a);a=u.scaleAndAdd(a,t,-m,E),u.normalize(a,a),t=u.cross(t,c,v),c=Math.acos(f.clamp(u.dot(c,a),0,1)),t=f.sign(u.dot(a,t)),p+=c*t,c=_.setAxisAngle(f.AXIS_Z,-p,x),3==e?i=_.multiply(c,i,A):(t=f.quat_project(i,f.AXIS_MZ,f.AXIS_Z,f.AXIS_Y,T),t=_.invert(t,T),i=_.multiply(t,i,T),i=_.multiply(c,i,A)),c=u.transformQuat(f.AXIS_MY,i,v),n.set_vertical_axis(r,c),l.set_rotation_v(r,i),_.copy(i,d)}}}if(t){var r=s.get_active_camera();r&&c.request_split_screen(function(){n.is_eye_camera(r)||(m=n.is_target_camera(r),g=n.is_hover_camera(r),h=n.is_static_camera(r),n.eye_setup(r));var e=o.create_elapsed_sensor(),i=o.create_hmd_position_sensor();d=l.get_rotation(r,d),o.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",o.CT_CONTINUOUS,[e,t,i],null,a)})}}var n=t("camera"),o=t("controls"),i=t("input"),_=t("quat"),s=t("scenes"),c=t("screen"),l=t("transform"),f=t("util"),u=t("vec3"),d=_.create(),p=0,m=!1,g=!1,h=!1,v=u.create(),b=u.create(),E=u.create(),A=_.create(),x=_.create(),T=_.create(),y=_.create(),S=_.create(),O=u.create(),w={pivot:u.create()};e.HMD_NONE_MOUSE_ALL_AXES=0,e.HMD_ALL_AXES_MOUSE_NONE=1,e.HMD_ROLL_PITCH_MOUSE_YAW=2,e.HMD_ALL_AXES_MOUSE_YAW=3,e.enable_hmd=function(e){var t;(t=i.get_device_by_type_element(i.DEVICE_HMD))&&(t=i.get_value_param(t,i.HMD_WEBVR_TYPE)&(i.HMD_WEBVR_MOBILE|i.HMD_WEBVR_DESKTOP|i.HMD_WEBVR1)?o.create_hmd_quat_sensor():o.create_gyro_quat_sensor(),r(e,t))},e.check_browser_support=function(){return!!i.can_use_device(i.DEVICE_HMD)},e.enable_controllers=function(e,t){if(a(),e||t){var r=i.get_vr_controller_id(0),n=o.create_gamepad_position_sensor(r),r=o.create_gamepad_orientation_sensor(r),_=i.get_vr_controller_id(1),s=o.create_gamepad_position_sensor(_),_=o.create_gamepad_orientation_sensor(_);o.create_sensor_manifold(null,"VR_CONTROLLERS",o.CT_CONTINUOUS,[n,s,r,_],null,function(a,r){if(e){var n=o.get_sensor_payload(a,r,0),i=o.get_sensor_payload(a,r,2);u.add(O,n,n),l.set_translation_v(e,n),l.set_rotation_v(e,i)}t&&(n=o.get_sensor_payload(a,r,1),i=o.get_sensor_payload(a,r,3),u.add(O,n,n),l.set_translation_v(t,n),l.set_rotation_v(t,i))})}},e.disable_controllers=a,e.disable_hmd=function(){if(o.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){o.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA"),c.exit_split_screen();var e=s.get_active_camera();m?n.target_setup(e,w):g?n.hover_setup(e,w):h&&n.static_setup(e,w),n.set_vertical_axis(e,f.AXIS_Z);var t=l.get_rotation(e,A);l.set_rotation_v(e,t)}},e.set_rotate_quat=function(e){_.copy(e,S)},e.get_rotate_quat=function(e){return _.copy(S,e),e},e.set_position=function(e){_.copy(e,O)},e.get_position=function(e){return _.copy(O,e),e}},a.module.fps=function(e,t){function a(){}function r(e,t,a){var r=A.get_active_camera();v.rotate_camera(r,t,a),t=v.get_camera_angles_char(r,q),E.set_character_rotation(e,t[0],t[1])}function n(e,t,a,r){(.01<Math.abs(D[0])||.01<Math.abs(D[1]))&&(a=b.get_sensor_value(e,t,0),t=x.smooth(D[0],0,a,.2*U),a=x.smooth(D[1],0,a,.2*U),D[0]-=t,D[1]-=a,r(e,-t*k,-a*k))}function o(e){var t=document.createElement("div");t.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);",t.setAttribute("id","B4W_DEFAULT_BTN_1");var a=document.createElement("div");a.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;",a.setAttribute("id","B4W_DEFAULT_BTN_2"),e.appendChild(t),e.appendChild(a)}function i(e){return"function"===typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)}function _(e,t){if(i(e)&&!T.detect_mobile()){var r=b.create_plock_mouse_sensor(e),o=F||b.create_plock_sensor(e);F=o,b.create_sensor_manifold(t,"FPS_PLOCK",b.CT_CONTINUOUS,[r,o],function(e){return e[0]&&e[1]},function(e,t,r){0<r&&(t=b.get_sensor_payload(e,t,0),a(e,-t.coords[0]*k,-t.coords[1]*k))}),b.create_sensor_manifold(null,"FPS_ACTIVATE_PLOCK",b.CT_TRIGGER,[o],function(e){return e[0]},function(t,a,r){0<r?j.By&&j.By(e):j.vq&&j.vq(e)})}else{if(T.detect_mobile())var r=b.create_touch_move_sensor("XY",e),o=b.create_touch_click_sensor(e),_=4;else{var r=b.create_mouse_move_sensor("XY",e),o=b.create_mouse_click_sensor(e),_=2,s=A.get_active_camera(),c=b.create_elapsed_sensor(),l=b.create_gamepad_axis_sensor(S.GMPD_AXIS_2),f=b.create_gamepad_axis_sensor(S.GMPD_AXIS_3);b.create_sensor_manifold(t,"FPS_CAM_ROT",b.CT_CONTINUOUS,[c,l,f],function(e){return.05<Math.abs(e[1])||.05<Math.abs(e[2])},function(e,t,a){if(0<a){var r=b.get_sensor_value(e,t,0);a=b.get_sensor_value(e,t,1),t=b.get_sensor_value(e,t,2),r*=2.5,t=-(.05>Math.abs(t)?0:t)*r,a=-(.05>Math.abs(a)?0:a)*r,t=x.clamp(t,M,C),v.rotate_camera(s,a,t),a=v.get_camera_angles(s,q),E.set_character_rotation(e,a[0]+Math.PI,0)}})}var u=0,d=0;b.create_sensor_manifold(null,"FPS_DRAG_PRESS",b.CT_SHOT,[o],function(e){return e[0]},function(e,t,a){1==a&&(e=b.get_sensor_payload(e,t,0).coords,u=e[0],d=e[1])}),b.create_sensor_manifold(null,"FPS_DRAG_MOVE",b.CT_CONTINUOUS,[r,o],function(e){return e[0]&&e[1]},function(e,t,a){1==a&&(e=b.get_sensor_payload(e,t,0).coords,D[0]+=(e[0]-u)*_,D[1]+=(e[1]-d)*_,u=e[0],d=e[1])}),r=b.create_elapsed_sensor(),b.create_sensor_manifold(t,"FPS_SMOOTH_DRAG",b.CT_CONTINUOUS,[r],null,n,a)}}function s(e){var t=b.create_elapsed_sensor(),a=A.get_active_camera();b.create_sensor_manifold(e,"FPS_CHARECTER_VR_ROT",b.CT_CONTINUOUS,[t],null,function(e){var t=v.get_camera_angles_char(a,q)[0];E.set_character_rotation(e,t,0)})}function c(){var e=N.check_browser_support()&&!T.detect_mobile(),t=S.get_device_by_type_element(S.DEVICE_HMD);return t&&(e=e&&S.get_value_param(t,S.HMD_WEBVR_TYPE)&S.HMD_WEBVR1),e}function l(e,t,a,r){function n(e){if(s()){4==c.$j.id&&(e=0),e=0<e?1:e;var r=l+f;f=-(0>e?-1:e),e=u+d;var n=l+f;E.set_character_move_dir(t,e,n),a&&a(e,n),_(e,n),v&&r!=n&&v(e,n,0)}}function i(e){if(s()){e=0<e?1:e;var r=u+d;d=-(0>e?-1:e),e=u+d;var n=l+f;E.set_character_move_dir(t,e,n),a&&a(e,n),_(e,n),v&&r!=e&&v(e,n,0)}}function _(e,t){var a=c.$j.id;e||t||4==a?0==a&&(0<p?m(c,2):m(c,1)):m(c,0)}function s(){return!X||(d=u=f=l=0,!1)}T.detect_mobile()&&o(e.parentElement?e.parentElement:e);var c=g(t),l=0,f=0,u=0,d=0,p=-1,v=r.move_dir_cd;e=r.JL;var b=r.JS,A=r.TQ,x=r.NQ,y=r.PS,O=r.SO;h(1,r.TO,function(e){if(s()){var r=u+d;u=e,e=u+d;var n=l+f;E.set_character_move_dir(t,e,n),a&&a(e,n),_(e,n),v&&r!=e&&v(e,n,0)}}),h(1,e,i),h(1,b,n),h(1,A,function(e){if(s()){4==c.$j.id&&(e=0);var r=l+f;l=e,e=u+d;var n=l+f;E.set_character_move_dir(t,e,n),a&&a(e,n),_(e,n),v&&r!=n&&v(e,n,0)}}),h(1,x,function(e){s()&&0<e&&(E.character_jump(t),v&&v(u+d,l+f,1))}),h(3,[S.GMPD_AXIS_0],n),h(3,[S.GMPD_AXIS_1],i),h(1,y,function(e){p=e,Math.abs(u+d)+Math.abs(l+f)?(0<e?m(c,2):m(c,1),v&&v(u+d,l+f,0)):m(c,0)}),h(1,O,function(e){0<e&&(e=G.$j.id,1==e||0==e?m(c,3):m(c,1))})}function f(){return G||(G={V:[],$j:null,lock:!1,SQ:null}),G}function u(e,t,a,r){e.V.push({id:t,Hx:a,dD:r,cD:null,$x:null})}function d(e){for(var t=[],a=0;a<e.V;a++){var r=e.V[a].id;if(0<=t.indexOf(r))return!1;t.push(r)}for(a=0;a<e.V;a++)for(var r=e.V[a],n=0;n<r.Hx.length;n++)if(0>t.indexOf(r.Hx[n]))return!1;return!0}function p(e,t){for(var a=null,r=0;r<e.V.length;r++)if(e.V[r].id==t){a=e.V[r];break}return a}function m(e,t){if(e.SQ=t,!e.lock){var a=e.$j,r=a.id;if(0<=a.Hx.indexOf(t)){var n=!0;a.cD&&(n=a.cD(r,t)),n&&(e.$j=p(e,t),a.dD&&a.dD(r,t),a.$x&&a.$x(r,t))}}}function g(e){function t(t,a){switch(a){case 0:case 1:E.set_character_move_type(e,E.CM_WALK);break;case 2:E.set_character_move_type(e,E.CM_RUN);break;case 3:E.set_character_move_type(e,E.CM_FLY);break;case 4:E.set_character_move_type(e,E.CM_CLIMB)}}var a=f();return u(a,0,[1,3,2,4],t),u(a,1,[2,3,4,0],t),u(a,2,[1,3,4,0],t),u(a,3,[1],t),u(a,4,[1,2,0],t),d(a),a.$j=p(a,0),G}function h(e,t,a){if(t.length){for(var r=[],n=0;n<t.length;n++)if("number"==typeof t[n])300>t[n]?r.push(b.create_keyboard_sensor(t[n])):326>t[n]?r.push(b.create_gamepad_btn_sensor(t[n],B)):r.push(b.create_gamepad_axis_sensor(t[n]));else if("string"==typeof t[n]){var o=document.getElementById(t[n]);o?r.push(b.create_touch_click_sensor(o)):I.error("Couldn't find element with "+t[n]+" ID.")}switch(t=function(){return!1},n=b.CT_SHOT,o=function(){},e){case 1:n=b.CT_TRIGGER,t=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},o=function(e,t,r){a(0<r?1:0)};break;case 2:n=b.CT_TRIGGER,t=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},o=function(e,t,r){a(0>r?1:0)};break;case 3:n=b.CT_CONTINUOUS,t=function(e){for(var t=0;t<e.length;t++)if(.05<Math.abs(e[t]))return!0;return!1},o=function(e,t,r,n){if(0<r)for(r=0;r<n;r++){var o=b.get_sensor_value(e,t,r);if(.05<Math.abs(o)){a(o);break}}else a(0)}}b.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+P.toString(),n,r,t,o,r.length),P++}}var v=t("camera"),b=t("controls"),E=t("physics"),A=t("scenes"),x=t("util"),T=t("main"),y=t("container"),S=t("input"),O=t("screen"),w=t("transform"),R=t("constraints"),L=t("vec3"),N=t("hmd"),I=t("__print"),M=(.1-Math.PI)/2,C=(Math.PI-.1)/2,D=new Float32Array(2),U=1,k=4e-4,P=0,G=null,F=null,j={By:null,vq:null},B=0,H=4,X=!1,q=new Float32Array(2),z=new Float32Array(3),W=new Float32Array(3);e.CS_STAY=0,e.CS_WALK=1,e.CS_RUN=2,e.CS_FLY=3,e.CS_CLIMB=4,e.AT_PRESSED=1,e.AT_RELEASED=2,e.AT_CONTINUOUS=3,e.bind_action=h,e.enable_fps_controls=function(e){e=e||{lock_camera:!0};var t=e.character||A.get_first_character();if(t){var n=e.element||y.get_canvas(),o=e.motion_cb||null;B=e.gamepad_id||0;var i=e.forward_sens||[b.KEY_W,S.GMPD_BUTTON_12],f=e.backward_sens||[b.KEY_S,S.GMPD_BUTTON_13],u=e.right_sens||[b.KEY_D,S.GMPD_BUTTON_15],d=e.left_sens||[b.KEY_A,S.GMPD_BUTTON_14],p=e.jump_sens||[b.KEY_SPACE,S.GMPD_BUTTON_1],m=e.vY||[b.KEY_SHIFT,S.GMPD_BUTTON_7],g=e.fly_sens||[];T.detect_mobile()&&(i.push("B4W_DEFAULT_BTN_1"),f.push("B4W_DEFAULT_BTN_2")),i={TO:i,JL:f,JS:u,TQ:d,NQ:p,PS:m,SO:g,move_dir_cd:e.move_dir_cd||null},a=e.rotation_cb||r,f="undefined"==typeof e.lock_camera||e.lock_camera,e=A.get_active_camera(),f&&(f=w.get_translation(e,z),u=w.get_translation(t,W),L.subtract(f,u,f),R.append_stiff_trans(e,t,f)),e=v.get_camera_angles_char(e,q),E.set_character_rotation(t,e[0],e[1]),c()?(N.enable_hmd(N.HMD_ALL_AXES_MOUSE_NONE),S.add_click_listener(n,O.request_fullscreen_hmd),s(t)):_(n,t),l(n,t,o,i)}},e.disable_fps_controls=function(e,t){if(e=e||A.get_first_character(),t=t||y.get_container(),e){for(var a=0;a<P;a++)b.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+a.toString());var a=e,r=t;if(i(r)&&!T.detect_mobile()&&(j.vq&&j.vq(r),b.remove_sensor_manifold(a,"FPS_PLOCK"),b.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK")),a=e,i(t)&&!T.detect_mobile()||(b.remove_sensor_manifold(a,"FPS_CAM_ROT"),b.remove_sensor_manifold(a,"FPS_DRAG_PRESS"),b.remove_sensor_manifold(a,"FPS_DRAG_MOVE"),b.remove_sensor_manifold(a,"FPS_SMOOTH_DRAG")),a=e,c()&&b.remove_sensor_manifold(a,"FPS_CHARECTER_VR_ROT"),a=t,T.detect_mobile()){var r=document.getElementById("B4W_DEFAULT_BTN_1"),n=document.getElementById("B4W_DEFAULT_BTN_2");r&&a.removeChild(r),n&&a.removeChild(n)}}},e.set_state_change_cb=function(e,t){p(G,e).$x=t},e.set_cam_smooth_factor=function(e){b.set_plock_smooth_factor(e),U=e},e.get_cam_smooth_factor=function(){return U},e.set_cam_sensitivity=function(e){k=e/2e5},e.get_cam_sensitivity=function(){return 2e5*k},e.set_plock_enable_cb=function(e){j.By=e},e.set_plock_disable_cb=function(e){j.vq=e},e.get_character_state=function(){return G.$j.id},e.add_new_state=function(){return H++},e.add_state=function(e,t,a){var r=f();u(r,e,t,a),d(r)||I.error("Incorrect state machine.")},e.switch_state=function(e){m(f(),e)},e.lock_character=function(){f().lock=!0},e.unlock_character=function(){f().lock=!1},e.is_character_locked=function(){return f().lock},e.set_rotation_cb=function(e){a=e||r},e.freeze_movements=function(){X=!0},e.unfreeze_movements=function(){X=!1}},a.module.mixer=function(e,t){function a(){v=h.length=0,b=r(),E=new Float32Array(b.length),A=new Float32Array(b.length);var e=p.get_speaker_objects();if(e.length){h.push(n());for(var t=0;t<e.length;t++)h.push(i(e[t]));h.sort(function(e,t){return"MASTER"==e.id?-1:"MASTER"==t.id?1:"COMPRESSOR"==e.id?-1:"COMPRESSOR"==t.id?1:e.id.toUpperCase()<t.id.toUpperCase()?-1:e.id.toUpperCase()>t.id.toUpperCase()?1:0})}}function r(){for(var e=new Float32Array(100),t=0,a=0;100>a;a++)e[a]=20*Math.pow(1e3,t),t+=1/99;return e}function n(){var e=o("MASTER"),t=p.get_compressor_params();return t&&(e.Y.push(["THRESHOLD",t.threshold,-100,0,100,!1]),e.Y.push(["KNEE",t.knee,0,40,40,!1]),e.Y.push(["RATIO",t.ratio,1,20,20,!1]),e.Y.push(["ATTACK",t.attack,0,1,1e3,!1]),e.Y.push(["RELEASE",t.release,0,1,1e3,!1])),e.Y.push(["VOLUME",p.get_volume(null),0,1,50,!1]),e.mute=p.is_muted(null)?1:0,e.Lg=-1,e}function o(e){return{id:e,Y:[],nl:0,mute:-1,Lg:-1,fc:null}}function i(e){var t=o(u.get_object_name(e));return t.mute=p.is_muted(e)?1:0,t.Lg=0,t.fc=e,t}function _(e){if(e.fc){e.Y.length=0;var t=p.get_positional_params(e.fc);t&&(e.Y.push(["DIST_REF",t.dist_ref,0,1e3,1e4,!1]),e.Y.push(["ATTENUATION",t.attenuation,0,50,1e3,!1]),e.Y.push(["DIST_MAX",t.dist_max,0,1e4,1e4,!1])),(t=p.get_filter_params(e.fc))&&(e.Y.push(["EQ_FREQ",t.freq,20,2e4,100,!0]),e.Y.push(["EQ_Q",t.Q,0,10,100,!1]),e.Y.push(["EQ_GAIN",t.gain,-70,30,100,!1])),e.Y.push(["VOLUME",p.get_volume(e.fc),0,1,50,!1]),m.clamp(e.nl,0,e.Y.length-1)}}function s(e){for(var t=0;t<h.length;t++){var a=h[t];if(a!=e&&1==a.Lg)return!0}return!1}function c(e){for(var t=0;t<h.length;t++){var a=h[t];a!=e&&0==a.mute&&0==a.Lg&&p.mute(a.fc,!1)}}function l(){if(!h.length)return[0,-1];var e=8*Math.floor(v/8),t=e+7,e=m.clamp(e,0,h.length-1),t=m.clamp(t,0,h.length-1);return[e,t]}var f=t("controls"),u=t("scenes"),d=t("screen"),p=t("sfx"),m=t("__util"),g="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),h=[],v=0,b=null,E=null,A=null;e.enable_mixer_controls=function(){function e(e,t,a){if(1==a){var r=f.get_sensor_value(e,t,0)?-1:1,n=h[v];if(n)switch(a=n.Y[n.nl],a[1]=a[5]?a[1]*Math.pow(a[3]/a[2],r/a[4]):a[1]+(a[3]-a[2])/a[4]*r,a[1]=m.clamp(a[1],a[2],a[3]),a[0]){case"VOLUME":"MASTER"!=n.id?p.set_volume(n.fc,a[1]):p.set_volume(null,a[1]);break;case"DIST_REF":r=p.get_positional_params(n.fc),r.dist_ref=a[1],p.set_positional_params(n.fc,r);break;case"ATTENUATION":r=p.get_positional_params(n.fc),r.attenuation=a[1],p.set_positional_params(n.fc,r);break;case"DIST_MAX":r=p.get_positional_params(n.fc),r.dist_max=a[1],p.set_positional_params(n.fc,r);break;case"EQ_FREQ":r=p.get_filter_params(n.fc),r.freq=a[1],p.set_filter_params(n.fc,r);break;case"EQ_Q":r=p.get_filter_params(n.fc),r.Q=a[1],p.set_filter_params(n.fc,r);break;case"EQ_GAIN":r=p.get_filter_params(n.fc),r.gain=a[1],p.set_filter_params(n.fc,r);break;case"THRESHOLD":n=p.get_compressor_params(),n.threshold=a[1],p.set_compressor_params(n);break;case"KNEE":n=p.get_compressor_params(),n.knee=a[1],p.set_compressor_params(n);break;case"RATIO":n=p.get_compressor_params(),n.ratio=a[1],p.set_compressor_params(n);break;case"ATTACK":n=p.get_compressor_params(),n.attack=a[1],p.set_compressor_params(n);break;case"RELEASE":n=p.get_compressor_params(),n.release=a[1],p.set_compressor_params(n);break;default:m.F("Unknown strip param")}"INC_DEC"==t?f.reset_timer_sensor(e,t,2,.35):f.reset_timer_sensor(e,t,2,.05)}else f.reset_timer_sensor(e,t,2,10)}function t(e,t,a){if(1==a){if(a=f.get_sensor_value(e,t,0)?-1:1,h.length){1==a&&v<h.length-1?v++:-1==a&&0<v&&v--,a=l();for(var r=a[0];r<=a[1];r++)_(h[r])}"SWITCH_STRIP"==t?f.reset_timer_sensor(e,t,2,.15+.3):f.reset_timer_sensor(e,t,2,.15)}else f.reset_timer_sensor(e,t,2,10)}a();var r=f.create_keyboard_sensor(f.KEY_NUM4),n=f.create_keyboard_sensor(f.KEY_NUM6),o=f.create_keyboard_sensor(f.KEY_NUM8),i=f.create_keyboard_sensor(f.KEY_NUM2),u=f.create_keyboard_sensor(f.KEY_ADD),g=f.create_keyboard_sensor(f.KEY_SUB),x=f.create_keyboard_sensor(f.KEY_NUM7),T=f.create_keyboard_sensor(f.KEY_NUM9),y=f.create_timer_sensor(.15,!0),S=f.create_timer_sensor(.05,!0),r=[r,n,y];f.create_sensor_manifold(null,"SWITCH_STRIP",f.CT_TRIGGER,r,function(e){return e[0]||e[1]},t),f.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",f.CT_SHOT,r,function(e){return(e[0]||e[1])&&e[2]},t),f.create_sensor_manifold(null,"SWITCH_PARAM",f.CT_SHOT,[o,i],function(e){return e[0]||e[1]},function(e,t){var a=f.get_sensor_value(e,t,0)?-1:1,r=h[v];r&&(1==a&&r.nl<r.Y.length-1?r.nl++:-1==a&&0<r.nl&&r.nl--)}),o=[g,u,S],f.create_sensor_manifold(null,"INC_DEC",f.CT_TRIGGER,o,function(e){return e[0]||e[1]},e),f.create_sensor_manifold(null,"INC_DEC_HOLD",f.CT_SHOT,o,function(e){return(e[0]||e[1])&&e[2]},e),f.create_sensor_manifold(null,"MUTE_SOLO",f.CT_SHOT,[x,T],function(e){return e[0]||e[1]},function(e,t){if(f.get_sensor_value(e,t,0)){var a=h[v];a&&0<=a.mute&&("MASTER"!=a.id?0==a.mute?(a.mute=1,p.mute(a.fc,!0),1==a.Lg&&(a.Lg=0,s(a)||c(a))):(a.mute=0,s(a)||p.mute(a.fc,!1)):0==a.mute?(a.mute=1,p.mute(null,!0)):(a.mute=0,p.mute(null,!1)))}else if((a=h[v])&&0<=a.Lg)if(0==a.Lg){a.Lg=1,p.mute(a.fc,!1),1==a.mute&&(a.mute=0);for(var r=0;r<h.length;r++){var n=h[r];n!=a&&0==n.mute&&0==n.Lg&&p.mute(n.fc,!0)}}else a.Lg=0,s(a)?p.mute(a.fc,!0):c(a)}),x=f.create_elapsed_sensor(),f.create_sensor_manifold(null,"MIXER_DRAW",f.CT_CONTINUOUS,[x],null,function(){if(h[v])for(var e=l(),t=e[0];t<=e[1];t++){var a=h[t];if(d.draw_mixer_strip(a.id,t==v,t%8,a.Y,a.nl,a.mute,a.Lg),a.fc&&p.get_filter_params(a.fc)){for(p.get_filter_freq_response(a.fc,b,E,A),a=0;a<E.length;a++)E[a]=20*Math.log(E[a])/Math.LN10;d.plot_array("EQ",t%8,E,20,2e4,-10,10)}}}),x=f.create_timer_sensor(1,!0),f.create_sensor_manifold(null,"MIXER_UPDATE",f.CT_TRIGGER,[x],null,function(){for(var e=l(),t=e[0];t<=e[1];t++)_(h[t])})},e.disable_mixer_controls=function(){for(var e=0;g.length;e++)f.remove_sensor_manifold(null,g[e])}},a.module.npc_ai=function(e,t){function a(e,t){var a=t.destination,r=t.Lx,n=E;d.get_translation(t.collider,n);var o=0,i=n[2];switch(a[2]=i,t.type){case O:if(t.random&&t.Ik){a[0]=(12*Math.random()-6)*t.speed+r[0],a[1]=-(12*Math.random()-6)*t.speed+r[1];var c=y,r=A,f=t.speed,u=t.rot_speed;d.get_rotation(t.collider,c),p.transformQuat(h.AXIS_MY,c,r),r[2]=0,p.normalize(r,r),c=.5*f/Math.sin(u/2),n=p.dist(a,n),n<2*c&&p.scaleAndAdd(a,r,2*c-n,a),t.Ik=!1}t.az&&(o=t.az-i,n=t.speed*e,o>n?o=n:o<-n&&(o=-n)),t.Mj=o;break;case w:case R:t.hp?o=t.hp:t.Mj&&(o=t.Mj,t.type==R&&(o*=e)),t.random&&t.Ik&&(t.type==R?(t.speed=Math.random()+.1,n=t.RF-t.UF):n=t.max_height-t.min_height,a[0]=10*Math.random()-5+r[0],a[1]=10*Math.random()-5+r[1],a[2]=i-(Math.random()*n-.5*n),t.Ik=!1)}o&&(a[2]=i+o);var a=b,n=E,c=A,o=S,u=t.rig,r=t.collider,i=t.destination,m=t.speed,g=t.actions,v=s.get_current_anim_name(u);if(!s.is_play(u)||!g.idle||-1==g.idle.indexOf(v)){d.get_translation(r,a);var f=i[0]-a[0],L=i[1]-a[1],f=Math.sqrt(f*f+L*L);if(f>2*m*e?(t.state=20,h.horizontal_direction(i,a,c),g=t.rig,s.is_animated(g)&&(u=t.speed,m=s.get_frame(g),g=s.get_anim_length(g),u*=g/24*(1-m/g),.9>f/u&&p.scaleAndAdd(i,c,u-f,i)),f=y,u=x,d.get_rotation(t.collider,f),p.transformQuat(h.AXIS_MY,f,n),u[0]=n[0],u[1]=n[1],u[2]=0,p.normalize(u,u),m=p.dot(u,c),g=e/(Math.abs(Math.acos(m))/Math.PI)*t.rot_speed*t.AA,l.rotationTo(u,c,o),l.rotationTo(h.AXIS_MY,u,f),1<=Math.abs(m)?l.copy(f,o):(l.multiply(o,f,o),l.slerp(f,o,Math.min(g,1),o)),c=e,t.type!=w&&(c=Math.max(c,1/60),f=T,u=y,l.setAxisAngle(h.AXIS_X,-Math.asin(-n[2]),u),l.setAxisAngle(h.AXIS_X,-Math.atan(t.Mj/(t.speed*c)),f),l.slerp(u,f,c,f),l.multiply(o,f,o)),d.set_rotation_v(r,o),n=A,r=x,h.quat_to_dir(o,h.AXIS_MY,n),p.scale(n,t.speed*e,r),p.add(r,a,r),r[2]=t.type!=O?(i[2]-a[2])*e*.1+a[2]:i[2],d.set_translation_v(t.collider,r)):t.type==O?g.move&&v&&-1!=g.move.indexOf(v)&&s.is_play(u)?t.state=20:(t.state=10,t.Ik=!0):t.type!=R&&t.type!=w||(t.Ik=!0),_(t)&&(a=t.rig,!s.is_play(a))){switch(o=null,t.state){case 10:o=t.actions,o=o.idle?h.random_from_array(o.idle):null;break;case 20:o=s.get_current_anim_name(t.rig),n=i=t.actions,n.move_blends&&-1==n.move_blends.indexOf(o)&&n.move&&-1!=n.move.indexOf(o)&&.33<Math.random()?(i=t.actions,o=i.move_blends[i.move.indexOf(o)]):(n=t.actions,n.move&&(-1!=n.move.indexOf(o)||!n.move_blends&&!n.move_start||!n.move_start&&!o||n.move_blends&&-1!=n.move_blends.indexOf(o)||n.move_start&&-1!=n.move_start.indexOf(o))?(i=t.actions,i.move_blends?(n=i.move_blends.indexOf(o),-1!=n?(o=n+1,o=o<i.move.length?o:0,o=i.move[o]):o=-1!=i.move.indexOf(o)?o:h.random_from_array(i.move)):o=h.random_from_array(i.move)):(n=t.actions,o=n.move_start&&-1==n.move_start.indexOf(o)&&n.move&&-1==n.move.indexOf(o)?h.random_from_array(i.move_start):null))}o&&(s.apply(a,o),s.set_behavior(a,s.AB_FINISH_RESET),s.set_frame(a,0),s.play(a))}}}function r(e,t,a,r){if(r)if(1==a)switch(r.type){case w:e:{for(a=0;3>a;a++){var n=c.get_sensor_payload(e,t,a).hit_fract;if(n){t=n;break e}}t=void 0}t*=100,r.Mj=t<r.min_height?10:t>r.max_height?-10:0;break;case O:e=c.get_sensor_payload(e,t,0),r.az=e.hit_pos[2];break;case R:e=c.get_sensor_payload(e,t,0),"CLOSE_GROUND"==t?(r.Mj=100*e.hit_fract-1,r.Mj=.1>r.Mj?.05:0):"CLOSE_WATER"==t&&(r.hp=100*e.hit_fract,r.hp=r.hp<r.UF?-.02:r.hp>r.RF?.02:0)}else r.Mj=0}function n(){for(var e=0;e<v.length;e++){var t=v[e];o(t),i(t),s.get_current_anim_name(t.rig)&&s.play(t.rig)}}function o(e){var t=p.create(),a=e.collider;switch(e.type){case w:var n=c.create_ray_sensor(a,t,[0,0,-100],"TERRAIN",!0,!0),o=c.create_ray_sensor(a,t,[0,0,-100],"STONE",!0,!0),t=c.create_ray_sensor(a,t,[0,0,-100],"WATER",!0,!0),n=[n,o,t];c.create_sensor_manifold(a,"CLOSE_GROUND",c.CT_CONTINUOUS,n,function(e){return e[0]||e[1]||e[2]},r,e);break;case O:n=c.create_ray_sensor(a,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),n=[n],c.create_sensor_manifold(a,"CLOSE_GROUND",c.CT_CONTINUOUS,n,null,r,e);break;case R:n=c.create_ray_sensor(a,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),t=c.create_ray_sensor(a,t,[0,0,100],"WATER",!0,!0),n=[n],c.create_sensor_manifold(a,"CLOSE_WATER",c.CT_CONTINUOUS,[t],null,r,e),c.create_sensor_manifold(a,"CLOSE_GROUND",c.CT_CONTINUOUS,n,null,r,e)}}function i(e){var t=e.collider;if(e.type==O){var a=c.create_collision_sensor(t,"CONSTRUCTION",!1);c.create_sensor_manifold(t,"CONSTRUCTION_COLL",c.CT_CONTINUOUS,[a],null,function(t,a,r){1==r?(p.copy(e.Lx,e.destination),e.AA=4):e.AA=1})}}function _(e){var t=e.rig;if(!s.is_play(t))return!0;if(!(t=s.get_current_anim_name(t)))return!0;var a=e.actions;switch(e.state){case 10:if(!a.idle)return!1;break;case 20:if(!a.move||-1!=a.move.indexOf(t)||a.move_start&&-1!=a.move_start.indexOf(t)||a.move_blends&&-1!=a.move_blends.indexOf(t))return!1;break;default:return!1}return!0}var s=t("animation"),c=t("controls"),l=t("quat"),f=t("scenes"),u=t("time"),d=t("transform"),p=t("vec3"),m=t("physics"),g=t("print"),h=t("util"),v=[],b=new Float32Array(3),E=new Float32Array(3),A=new Float32Array(3),x=new Float32Array(3),T=new Float32Array(4),y=new Float32Array(4),S=new Float32Array(4),O=e.NT_WALKING=10,w=e.NT_FLYING=20,R=e.NT_SWIMMING=30;e.new_event_track=function(e){var t={obj:null,rig:null,collider:null,empty:null,type:O,state:10,actions:{},Lx:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],du:[],delay:[],random:!0,Ik:!0,az:0,Mj:0,hp:0,AA:1,speed:1,rot_speed:.1,max_height:0,min_height:0,RF:0,UF:0};if("object"!=typeof e.obj)g.error("Can't create event track. Wrong object.");else if("object"!=typeof e.rig)g.error("Can't create event track. Wrong rig object.");else if("object"==typeof e.collider&&m.has_physics(e.collider)){if(t.obj=e.obj,t.collider=e.collider,t.rig=e.rig,d.get_translation(e.collider,t.Lx),"object"==typeof e.actions&&(t.actions=e.actions),"boolean"==typeof e.random&&(t.random=e.random),"number"==typeof e.type&&(t.type=e.type),"number"==typeof e.speed&&(t.speed=e.speed),"number"==typeof e.rot_speed&&(t.rot_speed=e.rot_speed),"number"==typeof e.max_height&&(t.max_height=e.max_height),"number"==typeof e.min_height&&(t.min_height=e.min_height),!t.random){for(var a=0;a<e.path.length;a++)t.start[a]=-1,t.ended[a]=!1,t.du[a]=!1;t.path=e.path,t.delay=e.delay}e=e.actions;var r,a=s.get_current_anim_name(t.rig);for(r in e)for(var n=e[r],o=0;o<n.length;o++)s.apply(t.rig,n[o]);a&&s.apply(t.rig,a),v.push(t)}else g.error("Can't create event track. Wrong collider object.")},e.enable_animation=function(){if(v.length){n();var e=c.create_elapsed_sensor();c.create_sensor_manifold(v[0].collider,"ELAPSED",c.CT_CONTINUOUS,[e],function(e){return e[0]},function(e,t,r){if(1==r)for(e=c.get_sensor_value(e,t,0),t=0;t<v.length;t++){r=v[t];var n=e;if(f.is_visible(r.obj))if(r.random)a(n,r);else{for(var o=u.get_timeline(),i=0;i<r.path.length;i++)if(!r.ended[i]){if(r.du[i]||(r.du[i]=!0,r.destination[0]=r.path[i][0],r.destination[1]=r.path[i][1],r.destination[2]=r.path[i][2],r.start[i]=o+r.delay[i]),o<r.start[i])break;a(n,r),r.ended[i]=r.Ik;break}e:{for(n=0;n<r.path.length;n++)if(0==r.ended[n]){n=!1;break e}n=!0}if(n)for(n=0;n<r.path.length;n++)r.du[n]=!1,r.ended[n]=!1}}})}},e.disable_animation=function(){if(!(0>=v.length))for(var e=0;e<v.length;e++){var t=v[e];c.check_sensor_manifolds(t.collider)&&c.remove_sensor_manifold(t.collider),s.is_play(t.rig)&&s.stop(t.rig)}}},a.module.mouse=function(e,t){function a(){1==S&&(S=0);var e=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof e&&e.apply(document),u.remove_sensor_manifold(m.get_active_camera(),"SMOOTH_PL")}function r(e){2==S&&(S=0),e.removeEventListener("mousedown",o,!1),e.removeEventListener("mouseup",i,!1),e.removeEventListener("mousemove",n,!1),u.remove_sensor_manifold(m.get_active_camera(),"SMOOTH_DRAG")}function n(e){if(T()){if(w)var t=f.client_to_element_coords(e.clientX,e.clientY,e.target,x);else t=x,t[0]=e.clientX,t[1]=e.clientY;A[0]+=2*(t[0]-b),A[1]+=2*(t[1]-E),b=t[0],E=t[1]}e.preventDefault()}function o(e){if(w)var t=f.client_to_element_coords(e.clientX,e.clientY,e.target,x);else t=x,t[0]=e.clientX,t[1]=e.clientY;b=t[0],E=t[1],e.currentTarget.addEventListener("mousemove",n,!1),e.preventDefault()}function i(e){e.currentTarget.removeEventListener("mousemove",n,!1),e.preventDefault()}function _(e,t,a,r){(.01<Math.abs(A[0])||.01<Math.abs(A[1]))&&(t=u.get_sensor_value(e,t,0),e=g.smooth(A[0],0,t,.1*v),t=g.smooth(A[1],0,t,.1*v),A[0]-=e,A[1]-=t,r(4e-4*-e,4e-4*-t))}function s(e,t){var a=m.get_first_character(),r=m.get_active_camera();l.rotate_camera(r,e,t),a&&(r=l.get_camera_angles_char(r,x),d.set_character_rotation(a,r[0],r[1]))}function c(e){O?(e=f.client_to_canvas_coords(e.clientX,e.clientY,x),e=m.pick_object(e[0],e[1])):e=m.pick_object(e.clientX,e.clientY),e?(m.outlining_is_enabled(e)&&m.set_outline_intensity(e,1),m.outlining_is_enabled(y)&&e!=y&&m.set_outline_intensity(y,0)):m.outlining_is_enabled(y)&&m.set_outline_intensity(y,0),y=e}var l=t("camera"),f=t("container"),u=t("controls"),d=t("physics"),p=t("print"),m=t("scenes"),g=t("util"),h=t("main"),v=1,b=0,E=0,A=new Float32Array(2),x=new Float32Array(2),T=null,y=null,S=0,O=!1,w=!1;e.request_pointerlock=function(e,t,a,n,o,i){function c(){if(document.pointerLockElement===e||document.webkitPointerLockElement===e||document.mozPointerLockElement===e){r(e),e.addEventListener("mousemove",n,!1);var o=m.get_active_camera();if(!u.check_sensor_manifold(o,"SMOOTH_PL")){var s=u.create_elapsed_sensor();u.create_sensor_manifold(o,"SMOOTH_PL",u.CT_CONTINUOUS,[s],null,_,i)}t()}else e.removeEventListener("mousemove",n,!1),S=0,document.removeEventListener("pointerlockchange",c,!1),document.removeEventListener("webkitpointerlockchange",c,!1),document.removeEventListener("mozpointerlockchange",c,!1),a()}if(1!=S){S=1,t=t||function(){},a=a||function(){},i=i||s,o=o||function(){return!0},n=n||function(e){if(o()){if("number"==typeof e.movementX){var t=e.movementX;e=e.movementY}else"number"==typeof e.webkitMovementX?(t=e.webkitMovementX,e=e.webkitMovementY):"number"==typeof e.mozMovementX?(t=e.mozMovementX,e=e.mozMovementY):e=t=0;A[0]+=t,A[1]+=e}},document.addEventListener("pointerlockchange",c,!1),document.addEventListener("webkitpointerlockchange",c,!1),document.addEventListener("mozpointerlockchange",c,!1);var l=e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock;"function"===typeof l?l.apply(e):p.error("Pointer lock is not available")}},e.exit_pointerlock=a,e.check_pointerlock=function(e){return"function"===typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)},e.request_mouse_drag=function(e,t,r,n){2!=S&&(S=2,a(),T=t||function(){return!0},r=r||s,w=!!n,e.addEventListener("mousedown",o,!1),e.addEventListener("mouseup",i,!1),e=m.get_active_camera(),u.check_sensor_manifold(e,"SMOOTH_DRAG")||(t=u.create_elapsed_sensor(),u.create_sensor_manifold(e,"SMOOTH_DRAG",u.CT_CONTINUOUS,[t],null,_,r)))},e.exit_mouse_drag=r,e.enable_mouse_hover_outline=function(e){O=!!e,h.detect_mobile()||f.get_canvas().addEventListener("mousemove",c)},e.disable_mouse_hover_outline=function(){h.detect_mobile()||(f.get_canvas().removeEventListener("mousemove",c),y&&m.set_outline_intensity(y,0))},e.get_coords_x=function(e,t,a){return t="touchend"==e.type?e.changedTouches:t?e.targetTouches:e.touches,a?"clientX"in e&&"clientY"in e?f.client_to_canvas_coords(e.clientX,e.clientY,x)[0]:t&&t[0]&&"clientX"in t[0]&&"clientY"in t[0]?f.client_to_canvas_coords(t[0].clientX,t[0].clientY,x)[0]:-1:"clientX"in e?e.clientX:t&&t[0]&&"clientX"in t[0]?t[0].clientX:-1},e.get_coords_y=function(e,t,a){return t="touchend"==e.type?e.changedTouches:t?e.targetTouches:e.touches,a?"clientX"in e&&"clientY"in e?f.client_to_canvas_coords(e.clientX,e.clientY,x)[1]:t&&t[0]&&"clientX"in t[0]&&"clientY"in t[0]?f.client_to_canvas_coords(t[0].clientX,t[0].clientY,x)[1]:-1:"clientY"in e?e.clientY:t&&t[0]&&"clientY"in t[0]?t[0].clientY:-1},e.set_plock_smooth_factor=function(e){v=e},e.get_plock_smooth_factor=function(){return v}},a.module.preloader=function(e,t){var a,r,n,o,i,_,s,c,l=t("container"),f=null;e.create_preloader=function(e){var t,i="#484848",_="#5276cf",s="rgba(150, 150, 150, 0.7)",c="#fff";for(t in e)switch(t){case"container_color":i=e.container_color;break;case"bar_color":_=e.bar_color;break;case"frame_color":s=e.frame_color;break;case"font_color":c=e.font_color}e=document.createElement("div"),t=e.cloneNode(!1);var f=e.cloneNode(!1),u=e.cloneNode(!1),d=l.get_container();f.appendChild(t),f.appendChild(u),e.appendChild(f),d.appendChild(e),e.style.cssText="background-color: "+i+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;",f.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+s+";border: 2px solid "+s+";",t.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+_+";height: 100%;",u.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+s+";color: "+c+";",a=t,r=u,n=e,o="DEFAULT"},e.create_simple_preloader=function(e){var t,_=null,s=null,c="#bf9221",l="#000";for(t in e)switch(t){case"canvas_container_id":_=e.canvas_container_id;break;case"background_container_id":s=e.background_container_id;break;case"bg_color":l=e.bg_color;break;case"bar_color":c=e.bar_color}e=document.createElement("div"),t=document.createElement("div"),e.id="simple_preloader_container";var u=document.createElement("div"),d=document.createElement("div"),s=document.getElementById(s);f=document.getElementById(_),e.style.cssText="z-index: 4;background-color: "+l+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",t.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;",u.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+c+";border-radius: 0px;",d.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+t.appendChild(u),t.appendChild(d),e.appendChild(t),document.body.appendChild(e),o="SIMPLE",n=e,a=u,r=d,i=s},e.create_rotation_preloader=function(e){var t,a=null,s=null,c="rgba(0,0,0,0)",l="",u="",d="rgba(0,0,0,0)";for(t in e)switch(t){case"canvas_container_id":a=e.canvas_container_id;break;case"background_container_id":s=e.background_container_id;break;case"frame_bg_color":c=e.frame_bg_color;break;case"bg_color":d=e.bg_color;break;case"frame_class":l=e.frame_class;break;case"anim_elem_class":u=e.anim_elem_class}e=document.createElement("div"),t=document.createElement("div");var p=document.createElement("div"),m=document.createElement("div"),s=document.getElementById(s);f=document.getElementById(a),e.style.cssText="z-index: 4;background-color: "+d+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",t.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+c+";",p.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;",m.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;",p.className=u,t.appendChild(p),t.className=l,t.appendChild(m),e.appendChild(t),f.appendChild(e),o="ROTATION",n=e,_=p,r=m,i=s},e.create_advanced_preloader=function(e){var t=e.preloader_width,t=t/(t-e.img_width),_=document.getElementById(e.preloader_bar_id),l=document.getElementById(e.fill_band_id),u=document.getElementById(e.preloader_caption_id),d=document.getElementById(e.preloader_container_id),p=document.getElementById(e.background_container_id);f=document.getElementById(e.canvas_container_id),o="ADVANCED",a=_,s=l,c=t,r=u,n=d,i=p},e.update_preloader=function(e){r.innerHTML=e+"%","SIMPLE"==o?a.style.width=e+"%":"ADVANCED"==o?(a.style.width=e/c+"%",s.style.width=100-e+"%"):"ROTATION"==o?_.style.transform="rotate("+e+"deg)":"DEFAULT"==o&&(a.style.width=e+"%"),100==e&&(n.parentNode.removeChild(n),i&&i.parentNode.removeChild(i))}},a.module.storage=function(e,t){function a(e){return o[e||n]?JSON.parse(o[e||n]):{}}var r=t("__print"),n="b4w",o=null;e.init=function(e){e?"b4w"!==e?n=e:r.error("b4w prefix denied"):r.warn("Prefix should be a string. Last declared storage prefix will be used.")},e.set=function(e,t,r){var i=a(r);i[e]=String(t),o[r||n]=JSON.stringify(i)},e.cleanup=function(e){delete o[e||n]},e.get=function(e,t){var r=a(t);return r[e]?r[e]:""},e.debug=function(e){r.log(a(e||n))};try{o=window.localStorage;try{o.tmp=null,delete o.tmp}catch(e){r.warn("localStorage quota is limited. Disabling localStorage"),o=null}}catch(e){r.warn("Applying chrome localStorage bug workaround"),o=null}o||(r.warn("localStorage is not available, initializing temporary storage"),o={})},a.module.screenshooter=function(e,t){var a=t("screen"),r=t("print");e.shot=function(e,t){r.xd("shot","screen.shot"),a.shot(e,t)}},e.exports=a},function(e,t,a){t.Element=a(11),t.Option=a(14),t.EngineBridge=a(54),t.ViewpointManager=a(13);var r=a(56);t.Socket=r.Socket,t.CommandQueueType=r.CommandQueueType,t.utils=a(12)},function(e,t,a){"use strict";(function(t){function r(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var n=a(0),o=a(34),i={"Content-Type":"application/x-www-form-urlencoded"},_={adapter:function(){var e;return"undefined"!==typeof XMLHttpRequest?e=a(5):"undefined"!==typeof t&&(e=a(5)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};_.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],function(e){_.headers[e]={}}),n.forEach(["post","put","patch"],function(e){_.headers[e]=n.merge(i)}),e.exports=_}).call(t,a(51))},function(e,t,a){var r,n;!function(t,a){"use strict";"object"===typeof e&&"object"===typeof e.exports?e.exports=t.document?a(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return a(e)}:a(t)}("undefined"!==typeof window?window:this,function(a,o){"use strict";function i(e,t){t=t||ie;var a=t.createElement("script");a.text=e,t.head.appendChild(a).parentNode.removeChild(a)}function _(e){var t=!!e&&"length"in e&&e.length,a=ve.type(e);return"function"!==a&&!ve.isWindow(e)&&("array"===a||0===t||"number"===typeof t&&t>0&&t-1 in e)}function s(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function c(e,t,a){return ve.isFunction(t)?ve.grep(e,function(e,r){return!!t.call(e,r,e)!==a}):t.nodeType?ve.grep(e,function(e){return e===t!==a}):"string"!==typeof t?ve.grep(e,function(e){return fe.call(t,e)>-1!==a}):Re.test(t)?ve.filter(t,e,a):(t=ve.filter(t,e),ve.grep(e,function(e){return fe.call(t,e)>-1!==a&&1===e.nodeType}))}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function f(e){var t={};return ve.each(e.match(Ce)||[],function(e,a){t[a]=!0}),t}function u(e){return e}function d(e){throw e}function p(e,t,a,r){var n;try{e&&ve.isFunction(n=e.promise)?n.call(e).done(t).fail(a):e&&ve.isFunction(n=e.then)?n.call(e,t,a):t.apply(void 0,[e].slice(r))}catch(e){a.apply(void 0,[e])}}function m(){ie.removeEventListener("DOMContentLoaded",m),a.removeEventListener("load",m),ve.ready()}function g(){this.expando=ve.expando+g.uid++}function h(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:je.test(e)?JSON.parse(e):e)}function v(e,t,a){var r;if(void 0===a&&1===e.nodeType)if(r="data-"+t.replace(Be,"-$&").toLowerCase(),"string"===typeof(a=e.getAttribute(r))){try{a=h(a)}catch(e){}Fe.set(e,t,a)}else a=void 0;return a}function b(e,t,a,r){var n,o=1,i=20,_=r?function(){return r.cur()}:function(){return ve.css(e,t,"")},s=_(),c=a&&a[3]||(ve.cssNumber[t]?"":"px"),l=(ve.cssNumber[t]||"px"!==c&&+s)&&Xe.exec(ve.css(e,t));if(l&&l[3]!==c){c=c||l[3],a=a||[],l=+s||1;do{o=o||".5",l/=o,ve.style(e,t,l+c)}while(o!==(o=_()/s)&&1!==o&&--i)}return a&&(l=+l||+s||0,n=a[1]?l+(a[1]+1)*a[2]:+a[2],r&&(r.unit=c,r.start=l,r.end=n)),n}function E(e){var t,a=e.ownerDocument,r=e.nodeName,n=Ye[r];return n||(t=a.body.appendChild(a.createElement(r)),n=ve.css(t,"display"),t.parentNode.removeChild(t),"none"===n&&(n="block"),Ye[r]=n,n)}function A(e,t){for(var a,r,n=[],o=0,i=e.length;o<i;o++)r=e[o],r.style&&(a=r.style.display,t?("none"===a&&(n[o]=Ge.get(r,"display")||null,n[o]||(r.style.display="")),""===r.style.display&&ze(r)&&(n[o]=E(r))):"none"!==a&&(n[o]="none",Ge.set(r,"display",a)));for(o=0;o<i;o++)null!=n[o]&&(e[o].style.display=n[o]);return e}function x(e,t){var a;return a="undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!==typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&s(e,t)?ve.merge([e],a):a}function T(e,t){for(var a=0,r=e.length;a<r;a++)Ge.set(e[a],"globalEval",!t||Ge.get(t[a],"globalEval"))}function y(e,t,a,r,n){for(var o,i,_,s,c,l,f=t.createDocumentFragment(),u=[],d=0,p=e.length;d<p;d++)if((o=e[d])||0===o)if("object"===ve.type(o))ve.merge(u,o.nodeType?[o]:o);else if(Ze.test(o)){for(i=i||f.appendChild(t.createElement("div")),_=(Je.exec(o)||["",""])[1].toLowerCase(),s=Qe[_]||Qe._default,i.innerHTML=s[1]+ve.htmlPrefilter(o)+s[2],l=s[0];l--;)i=i.lastChild;ve.merge(u,i.childNodes),i=f.firstChild,i.textContent=""}else u.push(t.createTextNode(o));for(f.textContent="",d=0;o=u[d++];)if(r&&ve.inArray(o,r)>-1)n&&n.push(o);else if(c=ve.contains(o.ownerDocument,o),i=x(f.appendChild(o),"script"),c&&T(i),a)for(l=0;o=i[l++];)Ke.test(o.type||"")&&a.push(o);return f}function S(){return!0}function O(){return!1}function w(){try{return ie.activeElement}catch(e){}}function R(e,t,a,r,n,o){var i,_;if("object"===typeof t){"string"!==typeof a&&(r=r||a,a=void 0);for(_ in t)R(e,_,a,r,t[_],o);return e}if(null==r&&null==n?(n=a,r=a=void 0):null==n&&("string"===typeof a?(n=r,r=void 0):(n=r,r=a,a=void 0)),!1===n)n=O;else if(!n)return e;return 1===o&&(i=n,n=function(e){return ve().off(e),i.apply(this,arguments)},n.guid=i.guid||(i.guid=ve.guid++)),e.each(function(){ve.event.add(this,t,n,r,a)})}function L(e,t){return s(e,"table")&&s(11!==t.nodeType?t:t.firstChild,"tr")?ve(">tbody",e)[0]||e:e}function N(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function I(e){var t=it.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function M(e,t){var a,r,n,o,i,_,s,c;if(1===t.nodeType){if(Ge.hasData(e)&&(o=Ge.access(e),i=Ge.set(t,o),c=o.events)){delete i.handle,i.events={};for(n in c)for(a=0,r=c[n].length;a<r;a++)ve.event.add(t,n,c[n][a])}Fe.hasData(e)&&(_=Fe.access(e),s=ve.extend({},_),Fe.set(t,s))}}function C(e,t){var a=t.nodeName.toLowerCase();"input"===a&&Ve.test(e.type)?t.checked=e.checked:"input"!==a&&"textarea"!==a||(t.defaultValue=e.defaultValue)}function D(e,t,a,r){t=ce.apply([],t);var n,o,_,s,c,l,f=0,u=e.length,d=u-1,p=t[0],m=ve.isFunction(p);if(m||u>1&&"string"===typeof p&&!he.checkClone&&ot.test(p))return e.each(function(n){var o=e.eq(n);m&&(t[0]=p.call(this,n,o.html())),D(o,t,a,r)});if(u&&(n=y(t,e[0].ownerDocument,!1,e,r),o=n.firstChild,1===n.childNodes.length&&(n=o),o||r)){for(_=ve.map(x(n,"script"),N),s=_.length;f<u;f++)c=n,f!==d&&(c=ve.clone(c,!0,!0),s&&ve.merge(_,x(c,"script"))),a.call(e[f],c,f);if(s)for(l=_[_.length-1].ownerDocument,ve.map(_,I),f=0;f<s;f++)c=_[f],Ke.test(c.type||"")&&!Ge.access(c,"globalEval")&&ve.contains(l,c)&&(c.src?ve._evalUrl&&ve._evalUrl(c.src):i(c.textContent.replace(_t,""),l))}return e}function U(e,t,a){for(var r,n=t?ve.filter(t,e):e,o=0;null!=(r=n[o]);o++)a||1!==r.nodeType||ve.cleanData(x(r)),r.parentNode&&(a&&ve.contains(r.ownerDocument,r)&&T(x(r,"script")),r.parentNode.removeChild(r));return e}function k(e,t,a){var r,n,o,i,_=e.style;return a=a||lt(e),a&&(i=a.getPropertyValue(t)||a[t],""!==i||ve.contains(e.ownerDocument,e)||(i=ve.style(e,t)),!he.pixelMarginRight()&&ct.test(i)&&st.test(t)&&(r=_.width,n=_.minWidth,o=_.maxWidth,_.minWidth=_.maxWidth=_.width=i,i=a.width,_.width=r,_.minWidth=n,_.maxWidth=o)),void 0!==i?i+"":i}function P(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function G(e){if(e in gt)return e;for(var t=e[0].toUpperCase()+e.slice(1),a=mt.length;a--;)if((e=mt[a]+t)in gt)return e}function F(e){var t=ve.cssProps[e];return t||(t=ve.cssProps[e]=G(e)||e),t}function j(e,t,a){var r=Xe.exec(t);return r?Math.max(0,r[2]-(a||0))+(r[3]||"px"):t}function B(e,t,a,r,n){var o,i=0;for(o=a===(r?"border":"content")?4:"width"===t?1:0;o<4;o+=2)"margin"===a&&(i+=ve.css(e,a+qe[o],!0,n)),r?("content"===a&&(i-=ve.css(e,"padding"+qe[o],!0,n)),"margin"!==a&&(i-=ve.css(e,"border"+qe[o]+"Width",!0,n))):(i+=ve.css(e,"padding"+qe[o],!0,n),"padding"!==a&&(i+=ve.css(e,"border"+qe[o]+"Width",!0,n)));return i}function H(e,t,a){var r,n=lt(e),o=k(e,t,n),i="border-box"===ve.css(e,"boxSizing",!1,n);return ct.test(o)?o:(r=i&&(he.boxSizingReliable()||o===e.style[t]),"auto"===o&&(o=e["offset"+t[0].toUpperCase()+t.slice(1)]),(o=parseFloat(o)||0)+B(e,t,a||(i?"border":"content"),r,n)+"px")}function X(e,t,a,r,n){return new X.prototype.init(e,t,a,r,n)}function q(){vt&&(!1===ie.hidden&&a.requestAnimationFrame?a.requestAnimationFrame(q):a.setTimeout(q,ve.fx.interval),ve.fx.tick())}function z(){return a.setTimeout(function(){ht=void 0}),ht=ve.now()}function W(e,t){var a,r=0,n={height:e};for(t=t?1:0;r<4;r+=2-t)a=qe[r],n["margin"+a]=n["padding"+a]=e;return t&&(n.opacity=n.width=e),n}function Y(e,t,a){for(var r,n=(K.tweeners[t]||[]).concat(K.tweeners["*"]),o=0,i=n.length;o<i;o++)if(r=n[o].call(a,t,e))return r}function V(e,t,a){var r,n,o,i,_,s,c,l,f="width"in t||"height"in t,u=this,d={},p=e.style,m=e.nodeType&&ze(e),g=Ge.get(e,"fxshow");a.queue||(i=ve._queueHooks(e,"fx"),null==i.unqueued&&(i.unqueued=0,_=i.empty.fire,i.empty.fire=function(){i.unqueued||_()}),i.unqueued++,u.always(function(){u.always(function(){i.unqueued--,ve.queue(e,"fx").length||i.empty.fire()})}));for(r in t)if(n=t[r],bt.test(n)){if(delete t[r],o=o||"toggle"===n,n===(m?"hide":"show")){if("show"!==n||!g||void 0===g[r])continue;m=!0}d[r]=g&&g[r]||ve.style(e,r)}if((s=!ve.isEmptyObject(t))||!ve.isEmptyObject(d)){f&&1===e.nodeType&&(a.overflow=[p.overflow,p.overflowX,p.overflowY],c=g&&g.display,null==c&&(c=Ge.get(e,"display")),l=ve.css(e,"display"),"none"===l&&(c?l=c:(A([e],!0),c=e.style.display||c,l=ve.css(e,"display"),A([e]))),("inline"===l||"inline-block"===l&&null!=c)&&"none"===ve.css(e,"float")&&(s||(u.done(function(){p.display=c}),null==c&&(l=p.display,c="none"===l?"":l)),p.display="inline-block")),a.overflow&&(p.overflow="hidden",u.always(function(){p.overflow=a.overflow[0],p.overflowX=a.overflow[1],p.overflowY=a.overflow[2]})),s=!1;for(r in d)s||(g?"hidden"in g&&(m=g.hidden):g=Ge.access(e,"fxshow",{display:c}),o&&(g.hidden=!m),m&&A([e],!0),u.done(function(){m||A([e]),Ge.remove(e,"fxshow");for(r in d)ve.style(e,r,d[r])})),s=Y(m?g[r]:0,r,u),r in g||(g[r]=s.start,m&&(s.end=s.start,s.start=0))}}function J(e,t){var a,r,n,o,i;for(a in e)if(r=ve.camelCase(a),n=t[r],o=e[a],Array.isArray(o)&&(n=o[1],o=e[a]=o[0]),a!==r&&(e[r]=o,delete e[a]),(i=ve.cssHooks[r])&&"expand"in i){o=i.expand(o),delete e[r];for(a in o)a in e||(e[a]=o[a],t[a]=n)}else t[r]=n}function K(e,t,a){var r,n,o=0,i=K.prefilters.length,_=ve.Deferred().always(function(){delete s.elem}),s=function(){if(n)return!1;for(var t=ht||z(),a=Math.max(0,c.startTime+c.duration-t),r=a/c.duration||0,o=1-r,i=0,s=c.tweens.length;i<s;i++)c.tweens[i].run(o);return _.notifyWith(e,[c,o,a]),o<1&&s?a:(s||_.notifyWith(e,[c,1,0]),_.resolveWith(e,[c]),!1)},c=_.promise({elem:e,props:ve.extend({},t),opts:ve.extend(!0,{specialEasing:{},easing:ve.easing._default},a),originalProperties:t,originalOptions:a,startTime:ht||z(),duration:a.duration,tweens:[],createTween:function(t,a){var r=ve.Tween(e,c.opts,t,a,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var a=0,r=t?c.tweens.length:0;if(n)return this;for(n=!0;a<r;a++)c.tweens[a].run(1);return t?(_.notifyWith(e,[c,1,0]),_.resolveWith(e,[c,t])):_.rejectWith(e,[c,t]),this}}),l=c.props;for(J(l,c.opts.specialEasing);o<i;o++)if(r=K.prefilters[o].call(c,e,l,c.opts))return ve.isFunction(r.stop)&&(ve._queueHooks(c.elem,c.opts.queue).stop=ve.proxy(r.stop,r)),r;return ve.map(l,Y,c),ve.isFunction(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),ve.fx.timer(ve.extend(s,{elem:e,anim:c,queue:c.opts.queue})),c}function Q(e){return(e.match(Ce)||[]).join(" ")}function Z(e){return e.getAttribute&&e.getAttribute("class")||""}function $(e,t,a,r){var n;if(Array.isArray(t))ve.each(t,function(t,n){a||Nt.test(e)?r(e,n):$(e+"["+("object"===typeof n&&null!=n?t:"")+"]",n,a,r)});else if(a||"object"!==ve.type(t))r(e,t);else for(n in t)$(e+"["+n+"]",t[n],a,r)}function ee(e){return function(t,a){"string"!==typeof t&&(a=t,t="*");var r,n=0,o=t.toLowerCase().match(Ce)||[];if(ve.isFunction(a))for(;r=o[n++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(a)):(e[r]=e[r]||[]).push(a)}}function te(e,t,a,r){function n(_){var s;return o[_]=!0,ve.each(e[_]||[],function(e,_){var c=_(t,a,r);return"string"!==typeof c||i||o[c]?i?!(s=c):void 0:(t.dataTypes.unshift(c),n(c),!1)}),s}var o={},i=e===Ht;return n(t.dataTypes[0])||!o["*"]&&n("*")}function ae(e,t){var a,r,n=ve.ajaxSettings.flatOptions||{};for(a in t)void 0!==t[a]&&((n[a]?e:r||(r={}))[a]=t[a]);return r&&ve.extend(!0,e,r),e}function re(e,t,a){for(var r,n,o,i,_=e.contents,s=e.dataTypes;"*"===s[0];)s.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(n in _)if(_[n]&&_[n].test(r)){s.unshift(n);break}if(s[0]in a)o=s[0];else{for(n in a){if(!s[0]||e.converters[n+" "+s[0]]){o=n;break}i||(i=n)}o=o||i}if(o)return o!==s[0]&&s.unshift(o),a[o]}function ne(e,t,a,r){var n,o,i,_,s,c={},l=e.dataTypes.slice();if(l[1])for(i in e.converters)c[i.toLowerCase()]=e.converters[i];for(o=l.shift();o;)if(e.responseFields[o]&&(a[e.responseFields[o]]=t),!s&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),s=o,o=l.shift())if("*"===o)o=s;else if("*"!==s&&s!==o){if(!(i=c[s+" "+o]||c["* "+o]))for(n in c)if(_=n.split(" "),_[1]===o&&(i=c[s+" "+_[0]]||c["* "+_[0]])){!0===i?i=c[n]:!0!==c[n]&&(o=_[0],l.unshift(_[1]));break}if(!0!==i)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+s+" to "+o}}}return{state:"success",data:t}}var oe=[],ie=a.document,_e=Object.getPrototypeOf,se=oe.slice,ce=oe.concat,le=oe.push,fe=oe.indexOf,ue={},de=ue.toString,pe=ue.hasOwnProperty,me=pe.toString,ge=me.call(Object),he={},ve=function(e,t){return new ve.fn.init(e,t)},be=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Ee=/^-ms-/,Ae=/-([a-z])/g,xe=function(e,t){return t.toUpperCase()};ve.fn=ve.prototype={jquery:"3.2.1",constructor:ve,length:0,toArray:function(){return se.call(this)},get:function(e){return null==e?se.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ve.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ve.each(this,e)},map:function(e){return this.pushStack(ve.map(this,function(t,a){return e.call(t,a,t)}))},slice:function(){return this.pushStack(se.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,a=+e+(e<0?t:0);return this.pushStack(a>=0&&a<t?[this[a]]:[])},end:function(){return this.prevObject||this.constructor()},push:le,sort:oe.sort,splice:oe.splice},ve.extend=ve.fn.extend=function(){var e,t,a,r,n,o,i=arguments[0]||{},_=1,s=arguments.length,c=!1;for("boolean"===typeof i&&(c=i,i=arguments[_]||{},_++),"object"===typeof i||ve.isFunction(i)||(i={}),_===s&&(i=this,_--);_<s;_++)if(null!=(e=arguments[_]))for(t in e)a=i[t],r=e[t],i!==r&&(c&&r&&(ve.isPlainObject(r)||(n=Array.isArray(r)))?(n?(n=!1,o=a&&Array.isArray(a)?a:[]):o=a&&ve.isPlainObject(a)?a:{},i[t]=ve.extend(c,o,r)):void 0!==r&&(i[t]=r));return i},ve.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ve.type(e)},isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=ve.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,a;return!(!e||"[object Object]"!==de.call(e))&&(!(t=_e(e))||"function"===typeof(a=pe.call(t,"constructor")&&t.constructor)&&me.call(a)===ge)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"===typeof e||"function"===typeof e?ue[de.call(e)]||"object":typeof e},globalEval:function(e){i(e)},camelCase:function(e){return e.replace(Ee,"ms-").replace(Ae,xe)},each:function(e,t){var a,r=0;if(_(e))for(a=e.length;r<a&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(be,"")},makeArray:function(e,t){var a=t||[];return null!=e&&(_(Object(e))?ve.merge(a,"string"===typeof e?[e]:e):le.call(a,e)),a},inArray:function(e,t,a){return null==t?-1:fe.call(t,e,a)},merge:function(e,t){for(var a=+t.length,r=0,n=e.length;r<a;r++)e[n++]=t[r];return e.length=n,e},grep:function(e,t,a){for(var r=[],n=0,o=e.length,i=!a;n<o;n++)!t(e[n],n)!==i&&r.push(e[n]);return r},map:function(e,t,a){var r,n,o=0,i=[];if(_(e))for(r=e.length;o<r;o++)null!=(n=t(e[o],o,a))&&i.push(n);else for(o in e)null!=(n=t(e[o],o,a))&&i.push(n);return ce.apply([],i)},guid:1,proxy:function(e,t){var a,r,n;if("string"===typeof t&&(a=e[t],t=e,e=a),ve.isFunction(e))return r=se.call(arguments,2),n=function(){return e.apply(t||this,r.concat(se.call(arguments)))},n.guid=e.guid=e.guid||ve.guid++,n},now:Date.now,support:he}),"function"===typeof Symbol&&(ve.fn[Symbol.iterator]=oe[Symbol.iterator]),ve.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){ue["[object "+t+"]"]=t.toLowerCase()});var Te=function(e){function t(e,t,a,r){var n,o,i,_,s,l,u,d=t&&t.ownerDocument,p=t?t.nodeType:9;if(a=a||[],"string"!==typeof e||!e||1!==p&&9!==p&&11!==p)return a;if(!r&&((t?t.ownerDocument||t:F)!==I&&N(t),t=t||I,C)){if(11!==p&&(s=me.exec(e)))if(n=s[1]){if(9===p){if(!(i=t.getElementById(n)))return a;if(i.id===n)return a.push(i),a}else if(d&&(i=d.getElementById(n))&&P(t,i)&&i.id===n)return a.push(i),a}else{if(s[2])return K.apply(a,t.getElementsByTagName(e)),a;if((n=s[3])&&E.getElementsByClassName&&t.getElementsByClassName)return K.apply(a,t.getElementsByClassName(n)),a}if(E.qsa&&!q[e+" "]&&(!D||!D.test(e))){if(1!==p)d=t,u=e;else if("object"!==t.nodeName.toLowerCase()){for((_=t.getAttribute("id"))?_=_.replace(be,Ee):t.setAttribute("id",_=G),l=y(e),o=l.length;o--;)l[o]="#"+_+" "+f(l[o]);u=l.join(","),d=ge.test(e)&&c(t.parentNode)||t}if(u)try{return K.apply(a,d.querySelectorAll(u)),a}catch(e){}finally{_===G&&t.removeAttribute("id")}}}return O(e.replace(oe,"$1"),t,a,r)}function a(){function e(a,r){return t.push(a+" ")>A.cacheLength&&delete e[t.shift()],e[a+" "]=r}var t=[];return e}function r(e){return e[G]=!0,e}function n(e){var t=I.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var a=e.split("|"),r=a.length;r--;)A.attrHandle[a[r]]=t}function i(e,t){var a=t&&e,r=a&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(a)for(;a=a.nextSibling;)if(a===t)return-1;return e?1:-1}function _(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&xe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function s(e){return r(function(t){return t=+t,r(function(a,r){for(var n,o=e([],a.length,t),i=o.length;i--;)a[n=o[i]]&&(a[n]=!(r[n]=a[n]))})})}function c(e){return e&&"undefined"!==typeof e.getElementsByTagName&&e}function l(){}function f(e){for(var t=0,a=e.length,r="";t<a;t++)r+=e[t].value;return r}function u(e,t,a){var r=t.dir,n=t.next,o=n||r,i=a&&"parentNode"===o,_=B++;return t.first?function(t,a,n){for(;t=t[r];)if(1===t.nodeType||i)return e(t,a,n);return!1}:function(t,a,s){var c,l,f,u=[j,_];if(s){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,a,s))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[G]||(t[G]={}),l=f[t.uniqueID]||(f[t.uniqueID]={}),n&&n===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=l[o])&&c[0]===j&&c[1]===_)return u[2]=c[2];if(l[o]=u,u[2]=e(t,a,s))return!0}return!1}}function d(e){return e.length>1?function(t,a,r){for(var n=e.length;n--;)if(!e[n](t,a,r))return!1;return!0}:e[0]}function p(e,a,r){for(var n=0,o=a.length;n<o;n++)t(e,a[n],r);return r}function m(e,t,a,r,n){for(var o,i=[],_=0,s=e.length,c=null!=t;_<s;_++)(o=e[_])&&(a&&!a(o,r,n)||(i.push(o),c&&t.push(_)));return i}function g(e,t,a,n,o,i){return n&&!n[G]&&(n=g(n)),o&&!o[G]&&(o=g(o,i)),r(function(r,i,_,s){var c,l,f,u=[],d=[],g=i.length,h=r||p(t||"*",_.nodeType?[_]:_,[]),v=!e||!r&&t?h:m(h,u,e,_,s),b=a?o||(r?e:g||n)?[]:i:v;if(a&&a(v,b,_,s),n)for(c=m(b,d),n(c,[],_,s),l=c.length;l--;)(f=c[l])&&(b[d[l]]=!(v[d[l]]=f));if(r){if(o||e){if(o){for(c=[],l=b.length;l--;)(f=b[l])&&c.push(v[l]=f);o(null,b=[],c,s)}for(l=b.length;l--;)(f=b[l])&&(c=o?Z(r,f):u[l])>-1&&(r[c]=!(i[c]=f))}}else b=m(b===i?b.splice(g,b.length):b),o?o(null,i,b,s):K.apply(i,b)})}function h(e){for(var t,a,r,n=e.length,o=A.relative[e[0].type],i=o||A.relative[" "],_=o?1:0,s=u(function(e){return e===t},i,!0),c=u(function(e){return Z(t,e)>-1},i,!0),l=[function(e,a,r){var n=!o&&(r||a!==w)||((t=a).nodeType?s(e,a,r):c(e,a,r));return t=null,n}];_<n;_++)if(a=A.relative[e[_].type])l=[u(d(l),a)];else{if(a=A.filter[e[_].type].apply(null,e[_].matches),a[G]){for(r=++_;r<n&&!A.relative[e[r].type];r++);return g(_>1&&d(l),_>1&&f(e.slice(0,_-1).concat({value:" "===e[_-2].type?"*":""})).replace(oe,"$1"),a,_<r&&h(e.slice(_,r)),r<n&&h(e=e.slice(r)),r<n&&f(e))}l.push(a)}return d(l)}function v(e,a){var n=a.length>0,o=e.length>0,i=function(r,i,_,s,c){var l,f,u,d=0,p="0",g=r&&[],h=[],v=w,b=r||o&&A.find.TAG("*",c),E=j+=null==v?1:Math.random()||.1,x=b.length;for(c&&(w=i===I||i||c);p!==x&&null!=(l=b[p]);p++){if(o&&l){for(f=0,i||l.ownerDocument===I||(N(l),_=!C);u=e[f++];)if(u(l,i||I,_)){s.push(l);break}c&&(j=E)}n&&((l=!u&&l)&&d--,r&&g.push(l))}if(d+=p,n&&p!==d){for(f=0;u=a[f++];)u(g,h,i,_);if(r){if(d>0)for(;p--;)g[p]||h[p]||(h[p]=V.call(s));h=m(h)}K.apply(s,h),c&&!r&&h.length>0&&d+a.length>1&&t.uniqueSort(s)}return c&&(j=E,w=v),g};return n?r(i):i}var b,E,A,x,T,y,S,O,w,R,L,N,I,M,C,D,U,k,P,G="sizzle"+1*new Date,F=e.document,j=0,B=0,H=a(),X=a(),q=a(),z=function(e,t){return e===t&&(L=!0),0},W={}.hasOwnProperty,Y=[],V=Y.pop,J=Y.push,K=Y.push,Q=Y.slice,Z=function(e,t){for(var a=0,r=e.length;a<r;a++)if(e[a]===t)return a;return-1},$="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ae="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",re=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ae+")*)|.*)\\)|)",ne=new RegExp(ee+"+","g"),oe=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),ie=new RegExp("^"+ee+"*,"+ee+"*"),_e=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),se=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),ce=new RegExp(re),le=new RegExp("^"+te+"$"),fe={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+$+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},ue=/^(?:input|select|textarea|button)$/i,de=/^h\d$/i,pe=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ge=/[+~]/,he=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),ve=function(e,t,a){var r="0x"+t-65536;return r!==r||a?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},be=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Ee=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Ae=function(){N()},xe=u(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{K.apply(Y=Q.call(F.childNodes),F.childNodes),Y[F.childNodes.length].nodeType}catch(e){K={apply:Y.length?function(e,t){J.apply(e,Q.call(t))}:function(e,t){for(var a=e.length,r=0;e[a++]=t[r++];);e.length=a-1}}}E=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},N=t.setDocument=function(e){var t,a,r=e?e.ownerDocument||e:F;return r!==I&&9===r.nodeType&&r.documentElement?(I=r,M=I.documentElement,C=!T(I),F!==I&&(a=I.defaultView)&&a.top!==a&&(a.addEventListener?a.addEventListener("unload",Ae,!1):a.attachEvent&&a.attachEvent("onunload",Ae)),E.attributes=n(function(e){return e.className="i",!e.getAttribute("className")}),E.getElementsByTagName=n(function(e){return e.appendChild(I.createComment("")),!e.getElementsByTagName("*").length}),E.getElementsByClassName=pe.test(I.getElementsByClassName),E.getById=n(function(e){return M.appendChild(e).id=G,!I.getElementsByName||!I.getElementsByName(G).length}),E.getById?(A.filter.ID=function(e){var t=e.replace(he,ve);return function(e){return e.getAttribute("id")===t}},A.find.ID=function(e,t){if("undefined"!==typeof t.getElementById&&C){var a=t.getElementById(e);return a?[a]:[]}}):(A.filter.ID=function(e){var t=e.replace(he,ve);return function(e){var a="undefined"!==typeof e.getAttributeNode&&e.getAttributeNode("id");return a&&a.value===t}},A.find.ID=function(e,t){if("undefined"!==typeof t.getElementById&&C){var a,r,n,o=t.getElementById(e);if(o){if((a=o.getAttributeNode("id"))&&a.value===e)return[o];for(n=t.getElementsByName(e),r=0;o=n[r++];)if((a=o.getAttributeNode("id"))&&a.value===e)return[o]}return[]}}),A.find.TAG=E.getElementsByTagName?function(e,t){return"undefined"!==typeof t.getElementsByTagName?t.getElementsByTagName(e):E.qsa?t.querySelectorAll(e):void 0}:function(e,t){var a,r=[],n=0,o=t.getElementsByTagName(e);if("*"===e){for(;a=o[n++];)1===a.nodeType&&r.push(a);return r}return o},A.find.CLASS=E.getElementsByClassName&&function(e,t){if("undefined"!==typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},U=[],D=[],(E.qsa=pe.test(I.querySelectorAll))&&(n(function(e){M.appendChild(e).innerHTML="<a id='"+G+"'></a><select id='"+G+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||D.push("\\["+ee+"*(?:value|"+$+")"),e.querySelectorAll("[id~="+G+"-]").length||D.push("~="),e.querySelectorAll(":checked").length||D.push(":checked"),e.querySelectorAll("a#"+G+"+*").length||D.push(".#.+[+~]")}),n(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=I.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&D.push("name"+ee+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&D.push(":enabled",":disabled"),M.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&D.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),D.push(",.*:")})),(E.matchesSelector=pe.test(k=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&n(function(e){E.disconnectedMatch=k.call(e,"*"),k.call(e,"[s!='']:x"),U.push("!=",re)}),D=D.length&&new RegExp(D.join("|")),U=U.length&&new RegExp(U.join("|")),t=pe.test(M.compareDocumentPosition),P=t||pe.test(M.contains)?function(e,t){var a=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(a.contains?a.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},z=t?function(e,t){if(e===t)return L=!0,0;var a=!e.compareDocumentPosition-!t.compareDocumentPosition;return a||(a=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&a||!E.sortDetached&&t.compareDocumentPosition(e)===a?e===I||e.ownerDocument===F&&P(F,e)?-1:t===I||t.ownerDocument===F&&P(F,t)?1:R?Z(R,e)-Z(R,t):0:4&a?-1:1)}:function(e,t){if(e===t)return L=!0,0;var a,r=0,n=e.parentNode,o=t.parentNode,_=[e],s=[t];if(!n||!o)return e===I?-1:t===I?1:n?-1:o?1:R?Z(R,e)-Z(R,t):0;if(n===o)return i(e,t);for(a=e;a=a.parentNode;)_.unshift(a);for(a=t;a=a.parentNode;)s.unshift(a);for(;_[r]===s[r];)r++;return r?i(_[r],s[r]):_[r]===F?-1:s[r]===F?1:0},I):I},t.matches=function(e,a){return t(e,null,null,a)},t.matchesSelector=function(e,a){if((e.ownerDocument||e)!==I&&N(e),a=a.replace(se,"='$1']"),E.matchesSelector&&C&&!q[a+" "]&&(!U||!U.test(a))&&(!D||!D.test(a)))try{var r=k.call(e,a);if(r||E.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(a,I,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==I&&N(e),P(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==I&&N(e);var a=A.attrHandle[t.toLowerCase()],r=a&&W.call(A.attrHandle,t.toLowerCase())?a(e,t,!C):void 0;return void 0!==r?r:E.attributes||!C?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.escape=function(e){return(e+"").replace(be,Ee)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,a=[],r=0,n=0;if(L=!E.detectDuplicates,R=!E.sortStable&&e.slice(0),e.sort(z),L){for(;t=e[n++];)t===e[n]&&(r=a.push(n));for(;r--;)e.splice(a[r],1)}return R=null,e},x=t.getText=function(e){var t,a="",r=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"===typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)a+=x(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[r++];)a+=x(t);return a},A=t.selectors={cacheLength:50,createPseudo:r,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(he,ve),e[3]=(e[3]||e[4]||e[5]||"").replace(he,ve),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,a=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":a&&ce.test(a)&&(t=y(a,!0))&&(t=a.indexOf(")",a.length-t)-a.length)&&(e[0]=e[0].slice(0,t),e[2]=a.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(he,ve).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&H(e,function(e){return t.test("string"===typeof e.className&&e.className||"undefined"!==typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,a,r){return function(n){var o=t.attr(n,e);return null==o?"!="===a:!a||(o+="","="===a?o===r:"!="===a?o!==r:"^="===a?r&&0===o.indexOf(r):"*="===a?r&&o.indexOf(r)>-1:"$="===a?r&&o.slice(-r.length)===r:"~="===a?(" "+o.replace(ne," ")+" ").indexOf(r)>-1:"|="===a&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,a,r,n){var o="nth"!==e.slice(0,3),i="last"!==e.slice(-4),_="of-type"===t;return 1===r&&0===n?function(e){return!!e.parentNode}:function(t,a,s){var c,l,f,u,d,p,m=o!==i?"nextSibling":"previousSibling",g=t.parentNode,h=_&&t.nodeName.toLowerCase(),v=!s&&!_,b=!1;if(g){if(o){for(;m;){for(u=t;u=u[m];)if(_?u.nodeName.toLowerCase()===h:1===u.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[i?g.firstChild:g.lastChild],i&&v){for(u=g,f=u[G]||(u[G]={}),l=f[u.uniqueID]||(f[u.uniqueID]={}),c=l[e]||[],d=c[0]===j&&c[1],b=d&&c[2],u=d&&g.childNodes[d];u=++d&&u&&u[m]||(b=d=0)||p.pop();)if(1===u.nodeType&&++b&&u===t){l[e]=[j,d,b];break}}else if(v&&(u=t,f=u[G]||(u[G]={}),l=f[u.uniqueID]||(f[u.uniqueID]={}),c=l[e]||[],d=c[0]===j&&c[1],b=d),!1===b)for(;(u=++d&&u&&u[m]||(b=d=0)||p.pop())&&((_?u.nodeName.toLowerCase()!==h:1!==u.nodeType)||!++b||(v&&(f=u[G]||(u[G]={}),l=f[u.uniqueID]||(f[u.uniqueID]={}),l[e]=[j,b]),u!==t)););return(b-=n)===r||b%r===0&&b/r>=0}}},PSEUDO:function(e,a){var n,o=A.pseudos[e]||A.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[G]?o(a):o.length>1?(n=[e,e,"",a],A.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,n=o(e,a),i=n.length;i--;)r=Z(e,n[i]),e[r]=!(t[r]=n[i])}):function(e){return o(e,0,n)}):o}},pseudos:{not:r(function(e){var t=[],a=[],n=S(e.replace(oe,"$1"));return n[G]?r(function(e,t,a,r){for(var o,i=n(e,null,r,[]),_=e.length;_--;)(o=i[_])&&(e[_]=!(t[_]=o))}):function(e,r,o){return t[0]=e,n(t,null,o,a),t[0]=null,!a.pop()}}),has:r(function(e){return function(a){return t(e,a).length>0}}),contains:r(function(e){return e=e.replace(he,ve),function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),lang:r(function(e){return le.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(he,ve).toLowerCase(),function(t){var a;do{if(a=C?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(a=a.toLowerCase())===e||0===a.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var a=e.location&&e.location.hash;return a&&a.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:_(!1),disabled:_(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!A.pseudos.empty(e)},header:function(e){return de.test(e.nodeName)},input:function(e){return ue.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,a){return[a<0?a+t:a]}),even:s(function(e,t){for(var a=0;a<t;a+=2)e.push(a);return e}),odd:s(function(e,t){for(var a=1;a<t;a+=2)e.push(a);return e}),lt:s(function(e,t,a){for(var r=a<0?a+t:a;--r>=0;)e.push(r);return e}),gt:s(function(e,t,a){for(var r=a<0?a+t:a;++r<t;)e.push(r);return e})}},A.pseudos.nth=A.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})A.pseudos[b]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(b);for(b in{submit:!0,reset:!0})A.pseudos[b]=function(e){return function(t){var a=t.nodeName.toLowerCase();return("input"===a||"button"===a)&&t.type===e}}(b);return l.prototype=A.filters=A.pseudos,A.setFilters=new l,y=t.tokenize=function(e,a){var r,n,o,i,_,s,c,l=X[e+" "];if(l)return a?0:l.slice(0);for(_=e,s=[],c=A.preFilter;_;){r&&!(n=ie.exec(_))||(n&&(_=_.slice(n[0].length)||_),s.push(o=[])),r=!1,(n=_e.exec(_))&&(r=n.shift(),o.push({value:r,type:n[0].replace(oe," ")}),_=_.slice(r.length));for(i in A.filter)!(n=fe[i].exec(_))||c[i]&&!(n=c[i](n))||(r=n.shift(),o.push({value:r,type:i,matches:n}),_=_.slice(r.length));if(!r)break}return a?_.length:_?t.error(e):X(e,s).slice(0)},S=t.compile=function(e,t){var a,r=[],n=[],o=q[e+" "];if(!o){for(t||(t=y(e)),a=t.length;a--;)o=h(t[a]),o[G]?r.push(o):n.push(o);o=q(e,v(n,r)),o.selector=e}return o},O=t.select=function(e,t,a,r){var n,o,i,_,s,l="function"===typeof e&&e,u=!r&&y(e=l.selector||e);if(a=a||[],1===u.length){if(o=u[0]=u[0].slice(0),o.length>2&&"ID"===(i=o[0]).type&&9===t.nodeType&&C&&A.relative[o[1].type]){if(!(t=(A.find.ID(i.matches[0].replace(he,ve),t)||[])[0]))return a;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(n=fe.needsContext.test(e)?0:o.length;n--&&(i=o[n],!A.relative[_=i.type]);)if((s=A.find[_])&&(r=s(i.matches[0].replace(he,ve),ge.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(n,1),!(e=r.length&&f(o)))return K.apply(a,r),a;break}}return(l||S(e,u))(r,t,!C,a,!t||ge.test(e)&&c(t.parentNode)||t),a},E.sortStable=G.split("").sort(z).join("")===G,E.detectDuplicates=!!L,N(),E.sortDetached=n(function(e){return 1&e.compareDocumentPosition(I.createElement("fieldset"))}),n(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,a){if(!a)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),E.attributes&&n(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,a){if(!a&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),n(function(e){return null==e.getAttribute("disabled")})||o($,function(e,t,a){var r;if(!a)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(a);ve.find=Te,ve.expr=Te.selectors,ve.expr[":"]=ve.expr.pseudos,ve.uniqueSort=ve.unique=Te.uniqueSort,ve.text=Te.getText,ve.isXMLDoc=Te.isXML,ve.contains=Te.contains,ve.escapeSelector=Te.escape;var ye=function(e,t,a){for(var r=[],n=void 0!==a;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&ve(e).is(a))break;r.push(e)}return r},Se=function(e,t){for(var a=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&a.push(e);return a},Oe=ve.expr.match.needsContext,we=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Re=/^.[^:#\[\.,]*$/;ve.filter=function(e,t,a){var r=t[0];return a&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ve.find.matchesSelector(r,e)?[r]:[]:ve.find.matches(e,ve.grep(t,function(e){return 1===e.nodeType}))},ve.fn.extend({find:function(e){var t,a,r=this.length,n=this;if("string"!==typeof e)return this.pushStack(ve(e).filter(function(){for(t=0;t<r;t++)if(ve.contains(n[t],this))return!0}));for(a=this.pushStack([]),t=0;t<r;t++)ve.find(e,n[t],a);return r>1?ve.uniqueSort(a):a},filter:function(e){return this.pushStack(c(this,e||[],!1))},not:function(e){return this.pushStack(c(this,e||[],!0))},is:function(e){return!!c(this,"string"===typeof e&&Oe.test(e)?ve(e):e||[],!1).length}});var Le,Ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ve.fn.init=function(e,t,a){var r,n;if(!e)return this;if(a=a||Le,"string"===typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Ne.exec(e))||!r[1]&&t)return!t||t.jquery?(t||a).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ve?t[0]:t,ve.merge(this,ve.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:ie,!0)),we.test(r[1])&&ve.isPlainObject(t))for(r in t)ve.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return n=ie.getElementById(r[2]),n&&(this[0]=n,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):ve.isFunction(e)?void 0!==a.ready?a.ready(e):e(ve):ve.makeArray(e,this)}).prototype=ve.fn,Le=ve(ie);var Ie=/^(?:parents|prev(?:Until|All))/,Me={children:!0,contents:!0,next:!0,prev:!0};ve.fn.extend({has:function(e){var t=ve(e,this),a=t.length;return this.filter(function(){for(var e=0;e<a;e++)if(ve.contains(this,t[e]))return!0})},closest:function(e,t){var a,r=0,n=this.length,o=[],i="string"!==typeof e&&ve(e);if(!Oe.test(e))for(;r<n;r++)for(a=this[r];a&&a!==t;a=a.parentNode)if(a.nodeType<11&&(i?i.index(a)>-1:1===a.nodeType&&ve.find.matchesSelector(a,e))){o.push(a);break}return this.pushStack(o.length>1?ve.uniqueSort(o):o)},index:function(e){return e?"string"===typeof e?fe.call(ve(e),this[0]):fe.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ve.uniqueSort(ve.merge(this.get(),ve(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ve.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ye(e,"parentNode")},parentsUntil:function(e,t,a){return ye(e,"parentNode",a)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return ye(e,"nextSibling")},prevAll:function(e){return ye(e,"previousSibling")},nextUntil:function(e,t,a){return ye(e,"nextSibling",a)},prevUntil:function(e,t,a){return ye(e,"previousSibling",a)},siblings:function(e){return Se((e.parentNode||{}).firstChild,e)},children:function(e){return Se(e.firstChild)},contents:function(e){return s(e,"iframe")?e.contentDocument:(s(e,"template")&&(e=e.content||e),ve.merge([],e.childNodes))}},function(e,t){ve.fn[e]=function(a,r){var n=ve.map(this,t,a);return"Until"!==e.slice(-5)&&(r=a),r&&"string"===typeof r&&(n=ve.filter(r,n)),this.length>1&&(Me[e]||ve.uniqueSort(n),Ie.test(e)&&n.reverse()),this.pushStack(n)}});var Ce=/[^\x20\t\r\n\f]+/g;ve.Callbacks=function(e){e="string"===typeof e?f(e):ve.extend({},e);var t,a,r,n,o=[],i=[],_=-1,s=function(){for(n=n||e.once,r=t=!0;i.length;_=-1)for(a=i.shift();++_<o.length;)!1===o[_].apply(a[0],a[1])&&e.stopOnFalse&&(_=o.length,a=!1);e.memory||(a=!1),t=!1,n&&(o=a?[]:"")},c={add:function(){return o&&(a&&!t&&(_=o.length-1,i.push(a)),function t(a){ve.each(a,function(a,r){ve.isFunction(r)?e.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==ve.type(r)&&t(r)})}(arguments),a&&!t&&s()),this},remove:function(){return ve.each(arguments,function(e,t){for(var a;(a=ve.inArray(t,o,a))>-1;)o.splice(a,1),a<=_&&_--}),this},has:function(e){return e?ve.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return n=i=[],o=a="",this},disabled:function(){return!o},lock:function(){return n=i=[],a||t||(o=a=""),this},locked:function(){return!!n},fireWith:function(e,a){return n||(a=a||[],a=[e,a.slice?a.slice():a],i.push(a),t||s()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},ve.extend({Deferred:function(e){var t=[["notify","progress",ve.Callbacks("memory"),ve.Callbacks("memory"),2],["resolve","done",ve.Callbacks("once memory"),ve.Callbacks("once memory"),0,"resolved"],["reject","fail",ve.Callbacks("once memory"),ve.Callbacks("once memory"),1,"rejected"]],r="pending",n={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return n.then(null,e)},pipe:function(){var e=arguments;return ve.Deferred(function(a){ve.each(t,function(t,r){var n=ve.isFunction(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=n&&n.apply(this,arguments);e&&ve.isFunction(e.promise)?e.promise().progress(a.notify).done(a.resolve).fail(a.reject):a[r[0]+"With"](this,n?[e]:arguments)})}),e=null}).promise()},then:function(e,r,n){function o(e,t,r,n){return function(){var _=this,s=arguments,c=function(){var a,c;if(!(e<i)){if((a=r.apply(_,s))===t.promise())throw new TypeError("Thenable self-resolution");c=a&&("object"===typeof a||"function"===typeof a)&&a.then,ve.isFunction(c)?n?c.call(a,o(i,t,u,n),o(i,t,d,n)):(i++,c.call(a,o(i,t,u,n),o(i,t,d,n),o(i,t,u,t.notifyWith))):(r!==u&&(_=void 0,s=[a]),(n||t.resolveWith)(_,s))}},l=n?c:function(){try{c()}catch(a){ve.Deferred.exceptionHook&&ve.Deferred.exceptionHook(a,l.stackTrace),e+1>=i&&(r!==d&&(_=void 0,s=[a]),t.rejectWith(_,s))}};e?l():(ve.Deferred.getStackHook&&(l.stackTrace=ve.Deferred.getStackHook()),a.setTimeout(l))}}var i=0;return ve.Deferred(function(a){t[0][3].add(o(0,a,ve.isFunction(n)?n:u,a.notifyWith)),t[1][3].add(o(0,a,ve.isFunction(e)?e:u)),t[2][3].add(o(0,a,ve.isFunction(r)?r:d))}).promise()},promise:function(e){return null!=e?ve.extend(e,n):n}},o={};return ve.each(t,function(e,a){var i=a[2],_=a[5];n[a[1]]=i.add,_&&i.add(function(){r=_},t[3-e][2].disable,t[0][2].lock),i.add(a[3].fire),o[a[0]]=function(){return o[a[0]+"With"](this===o?void 0:this,arguments),this},o[a[0]+"With"]=i.fireWith}),n.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,a=t,r=Array(a),n=se.call(arguments),o=ve.Deferred(),i=function(e){return function(a){r[e]=this,n[e]=arguments.length>1?se.call(arguments):a,--t||o.resolveWith(r,n)}};if(t<=1&&(p(e,o.done(i(a)).resolve,o.reject,!t),"pending"===o.state()||ve.isFunction(n[a]&&n[a].then)))return o.then();for(;a--;)p(n[a],i(a),o.reject);return o.promise()}});var De=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ve.Deferred.exceptionHook=function(e,t){a.console&&a.console.warn&&e&&De.test(e.name)&&a.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ve.readyException=function(e){a.setTimeout(function(){throw e})};var Ue=ve.Deferred();ve.fn.ready=function(e){return Ue.then(e).catch(function(e){ve.readyException(e)}),this},ve.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ve.readyWait:ve.isReady)||(ve.isReady=!0,!0!==e&&--ve.readyWait>0||Ue.resolveWith(ie,[ve]))}}),ve.ready.then=Ue.then,"complete"===ie.readyState||"loading"!==ie.readyState&&!ie.documentElement.doScroll?a.setTimeout(ve.ready):(ie.addEventListener("DOMContentLoaded",m),a.addEventListener("load",m));var ke=function(e,t,a,r,n,o,i){var _=0,s=e.length,c=null==a;if("object"===ve.type(a)){n=!0;for(_ in a)ke(e,t,_,a[_],!0,o,i)}else if(void 0!==r&&(n=!0,ve.isFunction(r)||(i=!0),c&&(i?(t.call(e,r),t=null):(c=t,t=function(e,t,a){return c.call(ve(e),a)})),t))for(;_<s;_++)t(e[_],a,i?r:r.call(e[_],_,t(e[_],a)));return n?e:c?t.call(e):s?t(e[0],a):o},Pe=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};g.uid=1,g.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Pe(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,a){var r,n=this.cache(e);if("string"===typeof t)n[ve.camelCase(t)]=a;else for(r in t)n[ve.camelCase(r)]=t[r];return n},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ve.camelCase(t)]},access:function(e,t,a){return void 0===t||t&&"string"===typeof t&&void 0===a?this.get(e,t):(this.set(e,t,a),void 0!==a?a:t)},remove:function(e,t){var a,r=e[this.expando];if(void 0!==r){if(void 0!==t){Array.isArray(t)?t=t.map(ve.camelCase):(t=ve.camelCase(t),t=t in r?[t]:t.match(Ce)||[]),a=t.length;for(;a--;)delete r[t[a]]}(void 0===t||ve.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ve.isEmptyObject(t)}};var Ge=new g,Fe=new g,je=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Be=/[A-Z]/g;ve.extend({hasData:function(e){return Fe.hasData(e)||Ge.hasData(e)},data:function(e,t,a){return Fe.access(e,t,a)},removeData:function(e,t){Fe.remove(e,t)},_data:function(e,t,a){return Ge.access(e,t,a)},_removeData:function(e,t){Ge.remove(e,t)}}),ve.fn.extend({data:function(e,t){var a,r,n,o=this[0],i=o&&o.attributes;if(void 0===e){if(this.length&&(n=Fe.get(o),1===o.nodeType&&!Ge.get(o,"hasDataAttrs"))){for(a=i.length;a--;)i[a]&&(r=i[a].name,0===r.indexOf("data-")&&(r=ve.camelCase(r.slice(5)),v(o,r,n[r])));Ge.set(o,"hasDataAttrs",!0)}return n}return"object"===typeof e?this.each(function(){Fe.set(this,e)}):ke(this,function(t){var a;if(o&&void 0===t){if(void 0!==(a=Fe.get(o,e)))return a;if(void 0!==(a=v(o,e)))return a}else this.each(function(){Fe.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Fe.remove(this,e)})}}),ve.extend({queue:function(e,t,a){var r;if(e)return t=(t||"fx")+"queue",r=Ge.get(e,t),a&&(!r||Array.isArray(a)?r=Ge.access(e,t,ve.makeArray(a)):r.push(a)),r||[]},dequeue:function(e,t){t=t||"fx";var a=ve.queue(e,t),r=a.length,n=a.shift(),o=ve._queueHooks(e,t),i=function(){ve.dequeue(e,t)};"inprogress"===n&&(n=a.shift(),r--),n&&("fx"===t&&a.unshift("inprogress"),delete o.stop,n.call(e,i,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var a=t+"queueHooks";return Ge.get(e,a)||Ge.access(e,a,{empty:ve.Callbacks("once memory").add(function(){Ge.remove(e,[t+"queue",a])})})}}),ve.fn.extend({queue:function(e,t){var a=2;return"string"!==typeof e&&(t=e,e="fx",a--),arguments.length<a?ve.queue(this[0],e):void 0===t?this:this.each(function(){var a=ve.queue(this,e,t);ve._queueHooks(this,e),"fx"===e&&"inprogress"!==a[0]&&ve.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ve.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var a,r=1,n=ve.Deferred(),o=this,i=this.length,_=function(){--r||n.resolveWith(o,[o])};for("string"!==typeof e&&(t=e,e=void 0),e=e||"fx";i--;)(a=Ge.get(o[i],e+"queueHooks"))&&a.empty&&(r++,a.empty.add(_));return _(),n.promise(t)}});var He=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Xe=new RegExp("^(?:([+-])=|)("+He+")([a-z%]*)$","i"),qe=["Top","Right","Bottom","Left"],ze=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&ve.contains(e.ownerDocument,e)&&"none"===ve.css(e,"display")},We=function(e,t,a,r){var n,o,i={};for(o in t)i[o]=e.style[o],e.style[o]=t[o];n=a.apply(e,r||[]);for(o in t)e.style[o]=i[o];return n},Ye={};ve.fn.extend({show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(e){return"boolean"===typeof e?e?this.show():this.hide():this.each(function(){ze(this)?ve(this).show():ve(this).hide()})}});var Ve=/^(?:checkbox|radio)$/i,Je=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ke=/^$|\/(?:java|ecma)script/i,Qe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Qe.optgroup=Qe.option,Qe.tbody=Qe.tfoot=Qe.colgroup=Qe.caption=Qe.thead,Qe.th=Qe.td;var Ze=/<|&#?\w+;/;!function(){var e=ie.createDocumentFragment(),t=e.appendChild(ie.createElement("div")),a=ie.createElement("input");a.setAttribute("type","radio"),a.setAttribute("checked","checked"),a.setAttribute("name","t"),t.appendChild(a),he.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",he.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var $e=ie.documentElement,et=/^key/,tt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,at=/^([^.]*)(?:\.(.+)|)/;ve.event={global:{},add:function(e,t,a,r,n){var o,i,_,s,c,l,f,u,d,p,m,g=Ge.get(e);if(g)for(a.handler&&(o=a,a=o.handler,n=o.selector),n&&ve.find.matchesSelector($e,n),a.guid||(a.guid=ve.guid++),(s=g.events)||(s=g.events={}),(i=g.handle)||(i=g.handle=function(t){return"undefined"!==typeof ve&&ve.event.triggered!==t.type?ve.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Ce)||[""],c=t.length;c--;)_=at.exec(t[c])||[],d=m=_[1],p=(_[2]||"").split(".").sort(),d&&(f=ve.event.special[d]||{},d=(n?f.delegateType:f.bindType)||d,f=ve.event.special[d]||{},l=ve.extend({type:d,origType:m,data:r,handler:a,guid:a.guid,selector:n,needsContext:n&&ve.expr.match.needsContext.test(n),namespace:p.join(".")},o),(u=s[d])||(u=s[d]=[],u.delegateCount=0,f.setup&&!1!==f.setup.call(e,r,p,i)||e.addEventListener&&e.addEventListener(d,i)),f.add&&(f.add.call(e,l),l.handler.guid||(l.handler.guid=a.guid)),n?u.splice(u.delegateCount++,0,l):u.push(l),ve.event.global[d]=!0)},remove:function(e,t,a,r,n){var o,i,_,s,c,l,f,u,d,p,m,g=Ge.hasData(e)&&Ge.get(e);if(g&&(s=g.events)){for(t=(t||"").match(Ce)||[""],c=t.length;c--;)if(_=at.exec(t[c])||[],d=m=_[1],p=(_[2]||"").split(".").sort(),d){for(f=ve.event.special[d]||{},d=(r?f.delegateType:f.bindType)||d,u=s[d]||[],_=_[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=o=u.length;o--;)l=u[o],!n&&m!==l.origType||a&&a.guid!==l.guid||_&&!_.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(u.splice(o,1),l.selector&&u.delegateCount--,f.remove&&f.remove.call(e,l));i&&!u.length&&(f.teardown&&!1!==f.teardown.call(e,p,g.handle)||ve.removeEvent(e,d,g.handle),delete s[d])}else for(d in s)ve.event.remove(e,d+t[c],a,r,!0);ve.isEmptyObject(s)&&Ge.remove(e,"handle events")}},dispatch:function(e){var t,a,r,n,o,i,_=ve.event.fix(e),s=new Array(arguments.length),c=(Ge.get(this,"events")||{})[_.type]||[],l=ve.event.special[_.type]||{};for(s[0]=_,t=1;t<arguments.length;t++)s[t]=arguments[t];if(_.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,_)){for(i=ve.event.handlers.call(this,_,c),t=0;(n=i[t++])&&!_.isPropagationStopped();)for(_.currentTarget=n.elem,a=0;(o=n.handlers[a++])&&!_.isImmediatePropagationStopped();)_.rnamespace&&!_.rnamespace.test(o.namespace)||(_.handleObj=o,_.data=o.data,void 0!==(r=((ve.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,s))&&!1===(_.result=r)&&(_.preventDefault(),_.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,_),_.result}},handlers:function(e,t){var a,r,n,o,i,_=[],s=t.delegateCount,c=e.target;if(s&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],i={},a=0;a<s;a++)r=t[a],n=r.selector+" ",void 0===i[n]&&(i[n]=r.needsContext?ve(n,this).index(c)>-1:ve.find(n,this,null,[c]).length),i[n]&&o.push(r);o.length&&_.push({elem:c,handlers:o})}return c=this,s<t.length&&_.push({elem:c,handlers:t.slice(s)}),_},addProp:function(e,t){Object.defineProperty(ve.Event.prototype,e,{enumerable:!0,configurable:!0,get:ve.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[ve.expando]?e:new ve.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==w()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===w()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&s(this,"input"))return this.click(),!1},_default:function(e){return s(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ve.removeEvent=function(e,t,a){e.removeEventListener&&e.removeEventListener(t,a)},ve.Event=function(e,t){if(!(this instanceof ve.Event))return new ve.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?S:O,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ve.extend(this,t),this.timeStamp=e&&e.timeStamp||ve.now(),this[ve.expando]=!0},ve.Event.prototype={constructor:ve.Event,isDefaultPrevented:O,isPropagationStopped:O,isImmediatePropagationStopped:O,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=S,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=S,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=S,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ve.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&et.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&tt.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},ve.event.addProp),ve.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){ve.event.special[e]={delegateType:t,bindType:t,handle:function(e){var a,r=this,n=e.relatedTarget,o=e.handleObj;return n&&(n===r||ve.contains(r,n))||(e.type=o.origType,a=o.handler.apply(this,arguments),e.type=t),a}}}),ve.fn.extend({on:function(e,t,a,r){return R(this,e,t,a,r)},one:function(e,t,a,r){return R(this,e,t,a,r,1)},off:function(e,t,a){var r,n;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ve(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"===typeof e){for(n in e)this.off(n,t,e[n]);return this}return!1!==t&&"function"!==typeof t||(a=t,t=void 0),!1===a&&(a=O),this.each(function(){ve.event.remove(this,e,a,t)})}});var rt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,nt=/<script|<style|<link/i,ot=/checked\s*(?:[^=]|=\s*.checked.)/i,it=/^true\/(.*)/,_t=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ve.extend({htmlPrefilter:function(e){return e.replace(rt,"<$1></$2>")},clone:function(e,t,a){var r,n,o,i,_=e.cloneNode(!0),s=ve.contains(e.ownerDocument,e);if(!he.noCloneChecked&&(1===e.nodeType||11===e.nodeType)&&!ve.isXMLDoc(e))for(i=x(_),o=x(e),r=0,n=o.length;r<n;r++)C(o[r],i[r]);if(t)if(a)for(o=o||x(e),i=i||x(_),r=0,n=o.length;r<n;r++)M(o[r],i[r]);else M(e,_);return i=x(_,"script"),i.length>0&&T(i,!s&&x(e,"script")),_},cleanData:function(e){for(var t,a,r,n=ve.event.special,o=0;void 0!==(a=e[o]);o++)if(Pe(a)){if(t=a[Ge.expando]){if(t.events)for(r in t.events)n[r]?ve.event.remove(a,r):ve.removeEvent(a,r,t.handle);a[Ge.expando]=void 0}a[Fe.expando]&&(a[Fe.expando]=void 0)}}}),ve.fn.extend({detach:function(e){return U(this,e,!0)},remove:function(e){return U(this,e)},text:function(e){return ke(this,function(e){return void 0===e?ve.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return D(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){L(this,e).appendChild(e)}})},prepend:function(){return D(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=L(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ve.cleanData(x(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ve.clone(this,e,t)})},html:function(e){return ke(this,function(e){var t=this[0]||{},a=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"===typeof e&&!nt.test(e)&&!Qe[(Je.exec(e)||["",""])[1].toLowerCase()]){e=ve.htmlPrefilter(e);try{for(;a<r;a++)t=this[a]||{},1===t.nodeType&&(ve.cleanData(x(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return D(this,arguments,function(t){var a=this.parentNode;ve.inArray(this,e)<0&&(ve.cleanData(x(this)),a&&a.replaceChild(t,this))},e)}}),ve.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ve.fn[e]=function(e){for(var a,r=[],n=ve(e),o=n.length-1,i=0;i<=o;i++)a=i===o?this:this.clone(!0),ve(n[i])[t](a),le.apply(r,a.get());return this.pushStack(r)}});var st=/^margin/,ct=new RegExp("^("+He+")(?!px)[a-z%]+$","i"),lt=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=a),t.getComputedStyle(e)};!function(){function e(){if(_){_.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",_.innerHTML="",$e.appendChild(i);var e=a.getComputedStyle(_);t="1%"!==e.top,o="2px"===e.marginLeft,r="4px"===e.width,_.style.marginRight="50%",n="4px"===e.marginRight,$e.removeChild(i),_=null}}var t,r,n,o,i=ie.createElement("div"),_=ie.createElement("div");_.style&&(_.style.backgroundClip="content-box",_.cloneNode(!0).style.backgroundClip="",he.clearCloneStyle="content-box"===_.style.backgroundClip,i.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",i.appendChild(_),ve.extend(he,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return e(),r},pixelMarginRight:function(){return e(),n},reliableMarginLeft:function(){return e(),o}}))}();var ft=/^(none|table(?!-c[ea]).+)/,ut=/^--/,dt={position:"absolute",visibility:"hidden",display:"block"},pt={letterSpacing:"0",fontWeight:"400"},mt=["Webkit","Moz","ms"],gt=ie.createElement("div").style;ve.extend({cssHooks:{opacity:{get:function(e,t){if(t){var a=k(e,"opacity");return""===a?"1":a}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,a,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,o,i,_=ve.camelCase(t),s=ut.test(t),c=e.style;if(s||(t=F(_)),i=ve.cssHooks[t]||ve.cssHooks[_],void 0===a)return i&&"get"in i&&void 0!==(n=i.get(e,!1,r))?n:c[t];o=typeof a,"string"===o&&(n=Xe.exec(a))&&n[1]&&(a=b(e,t,n),o="number"),null!=a&&a===a&&("number"===o&&(a+=n&&n[3]||(ve.cssNumber[_]?"":"px")),he.clearCloneStyle||""!==a||0!==t.indexOf("background")||(c[t]="inherit"),i&&"set"in i&&void 0===(a=i.set(e,a,r))||(s?c.setProperty(t,a):c[t]=a))}},css:function(e,t,a,r){var n,o,i,_=ve.camelCase(t);return ut.test(t)||(t=F(_)),i=ve.cssHooks[t]||ve.cssHooks[_],i&&"get"in i&&(n=i.get(e,!0,a)),void 0===n&&(n=k(e,t,r)),"normal"===n&&t in pt&&(n=pt[t]),""===a||a?(o=parseFloat(n),!0===a||isFinite(o)?o||0:n):n}}),ve.each(["height","width"],function(e,t){ve.cssHooks[t]={get:function(e,a,r){if(a)return!ft.test(ve.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?H(e,t,r):We(e,dt,function(){return H(e,t,r)})},set:function(e,a,r){var n,o=r&&lt(e),i=r&&B(e,t,r,"border-box"===ve.css(e,"boxSizing",!1,o),o);return i&&(n=Xe.exec(a))&&"px"!==(n[3]||"px")&&(e.style[t]=a,a=ve.css(e,t)),j(e,a,i)}}}),ve.cssHooks.marginLeft=P(he.reliableMarginLeft,function(e,t){if(t)return(parseFloat(k(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ve.each({margin:"",padding:"",border:"Width"},function(e,t){ve.cssHooks[e+t]={expand:function(a){for(var r=0,n={},o="string"===typeof a?a.split(" "):[a];r<4;r++)n[e+qe[r]+t]=o[r]||o[r-2]||o[0];return n}},st.test(e)||(ve.cssHooks[e+t].set=j)}),ve.fn.extend({css:function(e,t){return ke(this,function(e,t,a){var r,n,o={},i=0;if(Array.isArray(t)){for(r=lt(e),n=t.length;i<n;i++)o[t[i]]=ve.css(e,t[i],!1,r);return o}return void 0!==a?ve.style(e,t,a):ve.css(e,t)},e,t,arguments.length>1)}}),ve.Tween=X,X.prototype={constructor:X,init:function(e,t,a,r,n,o){this.elem=e,this.prop=a,this.easing=n||ve.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ve.cssNumber[a]?"":"px")},cur:function(){var e=X.propHooks[this.prop];return e&&e.get?e.get(this):X.propHooks._default.get(this)},run:function(e){var t,a=X.propHooks[this.prop];return this.options.duration?this.pos=t=ve.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),a&&a.set?a.set(this):X.propHooks._default.set(this),this}},X.prototype.init.prototype=X.prototype,X.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ve.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){ve.fx.step[e.prop]?ve.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[ve.cssProps[e.prop]]&&!ve.cssHooks[e.prop]?e.elem[e.prop]=e.now:ve.style(e.elem,e.prop,e.now+e.unit)}}},X.propHooks.scrollTop=X.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ve.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ve.fx=X.prototype.init,ve.fx.step={};var ht,vt,bt=/^(?:toggle|show|hide)$/,Et=/queueHooks$/;ve.Animation=ve.extend(K,{tweeners:{"*":[function(e,t){var a=this.createTween(e,t);return b(a.elem,e,Xe.exec(t),a),a}]},tweener:function(e,t){ve.isFunction(e)?(t=e,e=["*"]):e=e.match(Ce);for(var a,r=0,n=e.length;r<n;r++)a=e[r],K.tweeners[a]=K.tweeners[a]||[],K.tweeners[a].unshift(t)},prefilters:[V],prefilter:function(e,t){t?K.prefilters.unshift(e):K.prefilters.push(e)}}),ve.speed=function(e,t,a){var r=e&&"object"===typeof e?ve.extend({},e):{complete:a||!a&&t||ve.isFunction(e)&&e,duration:e,easing:a&&t||t&&!ve.isFunction(t)&&t};return ve.fx.off?r.duration=0:"number"!==typeof r.duration&&(r.duration in ve.fx.speeds?r.duration=ve.fx.speeds[r.duration]:r.duration=ve.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){ve.isFunction(r.old)&&r.old.call(this),r.queue&&ve.dequeue(this,r.queue)},r},ve.fn.extend({fadeTo:function(e,t,a,r){return this.filter(ze).css("opacity",0).show().end().animate({opacity:t},e,a,r)},animate:function(e,t,a,r){var n=ve.isEmptyObject(e),o=ve.speed(t,a,r),i=function(){var t=K(this,ve.extend({},e),o);(n||Ge.get(this,"finish"))&&t.stop(!0)};return i.finish=i,n||!1===o.queue?this.each(i):this.queue(o.queue,i)},stop:function(e,t,a){var r=function(e){var t=e.stop;delete e.stop,t(a)};return"string"!==typeof e&&(a=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=ve.timers,i=Ge.get(this);if(n)i[n]&&i[n].stop&&r(i[n]);else for(n in i)i[n]&&i[n].stop&&Et.test(n)&&r(i[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(a),t=!1,o.splice(n,1));!t&&a||ve.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,a=Ge.get(this),r=a[e+"queue"],n=a[e+"queueHooks"],o=ve.timers,i=r?r.length:0;for(a.finish=!0,ve.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<i;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete a.finish})}}),ve.each(["toggle","show","hide"],function(e,t){var a=ve.fn[t];ve.fn[t]=function(e,r,n){return null==e||"boolean"===typeof e?a.apply(this,arguments):this.animate(W(t,!0),e,r,n)}}),ve.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ve.fn[e]=function(e,a,r){return this.animate(t,e,a,r)}}),ve.timers=[],ve.fx.tick=function(){var e,t=0,a=ve.timers;for(ht=ve.now();t<a.length;t++)(e=a[t])()||a[t]!==e||a.splice(t--,1);a.length||ve.fx.stop(),ht=void 0},ve.fx.timer=function(e){ve.timers.push(e),ve.fx.start()},ve.fx.interval=13,ve.fx.start=function(){vt||(vt=!0,q())},ve.fx.stop=function(){vt=null},ve.fx.speeds={slow:600,fast:200,_default:400},ve.fn.delay=function(e,t){return e=ve.fx?ve.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,r){var n=a.setTimeout(t,e);r.stop=function(){a.clearTimeout(n)}})},function(){var e=ie.createElement("input"),t=ie.createElement("select"),a=t.appendChild(ie.createElement("option"));e.type="checkbox",he.checkOn=""!==e.value,he.optSelected=a.selected,e=ie.createElement("input"),e.value="t",e.type="radio",he.radioValue="t"===e.value}();var At,xt=ve.expr.attrHandle;ve.fn.extend({attr:function(e,t){return ke(this,ve.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ve.removeAttr(this,e)})}}),ve.extend({attr:function(e,t,a){var r,n,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"===typeof e.getAttribute?ve.prop(e,t,a):(1===o&&ve.isXMLDoc(e)||(n=ve.attrHooks[t.toLowerCase()]||(ve.expr.match.bool.test(t)?At:void 0)),void 0!==a?null===a?void ve.removeAttr(e,t):n&&"set"in n&&void 0!==(r=n.set(e,a,t))?r:(e.setAttribute(t,a+""),a):n&&"get"in n&&null!==(r=n.get(e,t))?r:(r=ve.find.attr(e,t),null==r?void 0:r))},attrHooks:{type:{set:function(e,t){if(!he.radioValue&&"radio"===t&&s(e,"input")){var a=e.value;return e.setAttribute("type",t),a&&(e.value=a),t}}}},removeAttr:function(e,t){var a,r=0,n=t&&t.match(Ce);if(n&&1===e.nodeType)for(;a=n[r++];)e.removeAttribute(a)}}),At={set:function(e,t,a){return!1===t?ve.removeAttr(e,a):e.setAttribute(a,a),a}},ve.each(ve.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ve.find.attr;xt[t]=function(e,t,r){var n,o,i=t.toLowerCase();return r||(o=xt[i],xt[i]=n,n=null!=a(e,t,r)?i:null,xt[i]=o),n}});var Tt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;ve.fn.extend({prop:function(e,t){return ke(this,ve.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ve.propFix[e]||e]})}}),ve.extend({prop:function(e,t,a){var r,n,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ve.isXMLDoc(e)||(t=ve.propFix[t]||t,n=ve.propHooks[t]),void 0!==a?n&&"set"in n&&void 0!==(r=n.set(e,a,t))?r:e[t]=a:n&&"get"in n&&null!==(r=n.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ve.find.attr(e,"tabindex");return t?parseInt(t,10):Tt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),he.optSelected||(ve.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ve.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ve.propFix[this.toLowerCase()]=this}),ve.fn.extend({addClass:function(e){var t,a,r,n,o,i,_,s=0;if(ve.isFunction(e))return this.each(function(t){ve(this).addClass(e.call(this,t,Z(this)))});if("string"===typeof e&&e)for(t=e.match(Ce)||[];a=this[s++];)if(n=Z(a),r=1===a.nodeType&&" "+Q(n)+" "){for(i=0;o=t[i++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");_=Q(r),n!==_&&a.setAttribute("class",_)}return this},removeClass:function(e){var t,a,r,n,o,i,_,s=0;if(ve.isFunction(e))return this.each(function(t){ve(this).removeClass(e.call(this,t,Z(this)))});if(!arguments.length)return this.attr("class","");if("string"===typeof e&&e)for(t=e.match(Ce)||[];a=this[s++];)if(n=Z(a),r=1===a.nodeType&&" "+Q(n)+" "){for(i=0;o=t[i++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");_=Q(r),n!==_&&a.setAttribute("class",_)}return this},toggleClass:function(e,t){var a=typeof e;return"boolean"===typeof t&&"string"===a?t?this.addClass(e):this.removeClass(e):ve.isFunction(e)?this.each(function(a){ve(this).toggleClass(e.call(this,a,Z(this),t),t)}):this.each(function(){var t,r,n,o;if("string"===a)for(r=0,n=ve(this),o=e.match(Ce)||[];t=o[r++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else void 0!==e&&"boolean"!==a||(t=Z(this),t&&Ge.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Ge.get(this,"__className__")||""))})},hasClass:function(e){var t,a,r=0;for(t=" "+e+" ";a=this[r++];)if(1===a.nodeType&&(" "+Q(Z(a))+" ").indexOf(t)>-1)return!0;return!1}});var St=/\r/g;ve.fn.extend({val:function(e){var t,a,r,n=this[0];{if(arguments.length)return r=ve.isFunction(e),this.each(function(a){var n;1===this.nodeType&&(n=r?e.call(this,a,ve(this).val()):e,null==n?n="":"number"===typeof n?n+="":Array.isArray(n)&&(n=ve.map(n,function(e){return null==e?"":e+""})),(t=ve.valHooks[this.type]||ve.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))});if(n)return(t=ve.valHooks[n.type]||ve.valHooks[n.nodeName.toLowerCase()])&&"get"in t&&void 0!==(a=t.get(n,"value"))?a:(a=n.value,"string"===typeof a?a.replace(St,""):null==a?"":a)}}}),ve.extend({valHooks:{option:{get:function(e){var t=ve.find.attr(e,"value");return null!=t?t:Q(ve.text(e))}},select:{get:function(e){var t,a,r,n=e.options,o=e.selectedIndex,i="select-one"===e.type,_=i?null:[],c=i?o+1:n.length;for(r=o<0?c:i?o:0;r<c;r++)if(a=n[r],(a.selected||r===o)&&!a.disabled&&(!a.parentNode.disabled||!s(a.parentNode,"optgroup"))){if(t=ve(a).val(),i)return t;_.push(t)}return _},set:function(e,t){for(var a,r,n=e.options,o=ve.makeArray(t),i=n.length;i--;)r=n[i],(r.selected=ve.inArray(ve.valHooks.option.get(r),o)>-1)&&(a=!0);return a||(e.selectedIndex=-1),o}}}}),ve.each(["radio","checkbox"],function(){ve.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=ve.inArray(ve(e).val(),t)>-1}},he.checkOn||(ve.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Ot=/^(?:focusinfocus|focusoutblur)$/;ve.extend(ve.event,{trigger:function(e,t,r,n){var o,i,_,s,c,l,f,u=[r||ie],d=pe.call(e,"type")?e.type:e,p=pe.call(e,"namespace")?e.namespace.split("."):[];if(i=_=r=r||ie,3!==r.nodeType&&8!==r.nodeType&&!Ot.test(d+ve.event.triggered)&&(d.indexOf(".")>-1&&(p=d.split("."),d=p.shift(),p.sort()),c=d.indexOf(":")<0&&"on"+d,e=e[ve.expando]?e:new ve.Event(d,"object"===typeof e&&e),e.isTrigger=n?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:ve.makeArray(t,[e]),f=ve.event.special[d]||{},n||!f.trigger||!1!==f.trigger.apply(r,t))){if(!n&&!f.noBubble&&!ve.isWindow(r)){for(s=f.delegateType||d,Ot.test(s+d)||(i=i.parentNode);i;i=i.parentNode)u.push(i),_=i;_===(r.ownerDocument||ie)&&u.push(_.defaultView||_.parentWindow||a)}for(o=0;(i=u[o++])&&!e.isPropagationStopped();)e.type=o>1?s:f.bindType||d,l=(Ge.get(i,"events")||{})[e.type]&&Ge.get(i,"handle"),l&&l.apply(i,t),(l=c&&i[c])&&l.apply&&Pe(i)&&(e.result=l.apply(i,t),!1===e.result&&e.preventDefault());return e.type=d,n||e.isDefaultPrevented()||f._default&&!1!==f._default.apply(u.pop(),t)||!Pe(r)||c&&ve.isFunction(r[d])&&!ve.isWindow(r)&&(_=r[c],_&&(r[c]=null),ve.event.triggered=d,r[d](),ve.event.triggered=void 0,_&&(r[c]=_)),e.result}},simulate:function(e,t,a){var r=ve.extend(new ve.Event,a,{type:e,isSimulated:!0});ve.event.trigger(r,null,t)}}),ve.fn.extend({trigger:function(e,t){return this.each(function(){ve.event.trigger(e,t,this)})},triggerHandler:function(e,t){var a=this[0];if(a)return ve.event.trigger(e,t,a,!0)}}),ve.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){ve.fn[t]=function(e,a){return arguments.length>0?this.on(t,null,e,a):this.trigger(t)}}),ve.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),he.focusin="onfocusin"in a,he.focusin||ve.each({focus:"focusin",blur:"focusout"},function(e,t){var a=function(e){ve.event.simulate(t,e.target,ve.event.fix(e))};ve.event.special[t]={setup:function(){var r=this.ownerDocument||this,n=Ge.access(r,t);n||r.addEventListener(e,a,!0),Ge.access(r,t,(n||0)+1)},teardown:function(){var r=this.ownerDocument||this,n=Ge.access(r,t)-1;n?Ge.access(r,t,n):(r.removeEventListener(e,a,!0),Ge.remove(r,t))}}});var wt=a.location,Rt=ve.now(),Lt=/\?/;ve.parseXML=function(e){var t;if(!e||"string"!==typeof e)return null;try{t=(new a.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||ve.error("Invalid XML: "+e),t};var Nt=/\[\]$/,It=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Ct=/^(?:input|select|textarea|keygen)/i;ve.param=function(e,t){var a,r=[],n=function(e,t){var a=ve.isFunction(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==a?"":a)};if(Array.isArray(e)||e.jquery&&!ve.isPlainObject(e))ve.each(e,function(){n(this.name,this.value)});else for(a in e)$(a,e[a],t,n);return r.join("&")},ve.fn.extend({serialize:function(){return ve.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ve.prop(this,"elements");return e?ve.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ve(this).is(":disabled")&&Ct.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!Ve.test(e))}).map(function(e,t){var a=ve(this).val();return null==a?null:Array.isArray(a)?ve.map(a,function(e){return{name:t.name,value:e.replace(It,"\r\n")}}):{name:t.name,value:a.replace(It,"\r\n")}}).get()}});var Dt=/%20/g,Ut=/#.*$/,kt=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Gt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ft=/^(?:GET|HEAD)$/,jt=/^\/\//,Bt={},Ht={},Xt="*/".concat("*"),qt=ie.createElement("a");qt.href=wt.href,ve.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wt.href,type:"GET",isLocal:Gt.test(wt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ve.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ae(ae(e,ve.ajaxSettings),t):ae(ve.ajaxSettings,e)},ajaxPrefilter:ee(Bt),ajaxTransport:ee(Ht),ajax:function(e,t){function r(e,t,r,_){var c,u,d,E,A,x=t;l||(l=!0,s&&a.clearTimeout(s),n=void 0,i=_||"",T.readyState=e>0?4:0,c=e>=200&&e<300||304===e,r&&(E=re(p,T,r)),E=ne(p,E,T,c),c?(p.ifModified&&(A=T.getResponseHeader("Last-Modified"),A&&(ve.lastModified[o]=A),(A=T.getResponseHeader("etag"))&&(ve.etag[o]=A)),204===e||"HEAD"===p.type?x="nocontent":304===e?x="notmodified":(x=E.state,u=E.data,d=E.error,c=!d)):(d=x,!e&&x||(x="error",e<0&&(e=0))),T.status=e,T.statusText=(t||x)+"",c?h.resolveWith(m,[u,x,T]):h.rejectWith(m,[T,x,d]),T.statusCode(b),b=void 0,f&&g.trigger(c?"ajaxSuccess":"ajaxError",[T,p,c?u:d]),v.fireWith(m,[T,x]),f&&(g.trigger("ajaxComplete",[T,p]),--ve.active||ve.event.trigger("ajaxStop")))}"object"===typeof e&&(t=e,e=void 0),t=t||{};var n,o,i,_,s,c,l,f,u,d,p=ve.ajaxSetup({},t),m=p.context||p,g=p.context&&(m.nodeType||m.jquery)?ve(m):ve.event,h=ve.Deferred(),v=ve.Callbacks("once memory"),b=p.statusCode||{},E={},A={},x="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(l){if(!_)for(_={};t=Pt.exec(i);)_[t[1].toLowerCase()]=t[2];t=_[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return l?i:null},setRequestHeader:function(e,t){return null==l&&(e=A[e.toLowerCase()]=A[e.toLowerCase()]||e,E[e]=t),this},overrideMimeType:function(e){return null==l&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)T.always(e[T.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),r(0,t),this}};if(h.promise(T),p.url=((e||p.url||wt.href)+"").replace(jt,wt.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(Ce)||[""],null==p.crossDomain){c=ie.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=qt.protocol+"//"+qt.host!==c.protocol+"//"+c.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!==typeof p.data&&(p.data=ve.param(p.data,p.traditional)),te(Bt,p,t,T),l)return T;f=ve.event&&p.global,f&&0===ve.active++&&ve.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ft.test(p.type),o=p.url.replace(Ut,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Dt,"+")):(d=p.url.slice(o.length),p.data&&(o+=(Lt.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(kt,"$1"),d=(Lt.test(o)?"&":"?")+"_="+Rt+++d),p.url=o+d),p.ifModified&&(ve.lastModified[o]&&T.setRequestHeader("If-Modified-Since",ve.lastModified[o]),ve.etag[o]&&T.setRequestHeader("If-None-Match",ve.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Xt+"; q=0.01":""):p.accepts["*"]);for(u in p.headers)T.setRequestHeader(u,p.headers[u]);if(p.beforeSend&&(!1===p.beforeSend.call(m,T,p)||l))return T.abort();if(x="abort",v.add(p.complete),T.done(p.success),T.fail(p.error),n=te(Ht,p,t,T)){if(T.readyState=1,f&&g.trigger("ajaxSend",[T,p]),l)return T;p.async&&p.timeout>0&&(s=a.setTimeout(function(){T.abort("timeout")},p.timeout));try{l=!1,n.send(E,r)}catch(e){if(l)throw e;r(-1,e)}}else r(-1,"No Transport");return T},getJSON:function(e,t,a){return ve.get(e,t,a,"json")},getScript:function(e,t){return ve.get(e,void 0,t,"script")}}),ve.each(["get","post"],function(e,t){ve[t]=function(e,a,r,n){return ve.isFunction(a)&&(n=n||r,r=a,a=void 0),ve.ajax(ve.extend({url:e,type:t,dataType:n,data:a,success:r},ve.isPlainObject(e)&&e))}}),ve._evalUrl=function(e){return ve.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},ve.fn.extend({wrapAll:function(e){var t;return this[0]&&(ve.isFunction(e)&&(e=e.call(this[0])),t=ve(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return ve.isFunction(e)?this.each(function(t){ve(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ve(this),a=t.contents();a.length?a.wrapAll(e):t.append(e)})},wrap:function(e){var t=ve.isFunction(e);return this.each(function(a){ve(this).wrapAll(t?e.call(this,a):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ve(this).replaceWith(this.childNodes)}),this}}),ve.expr.pseudos.hidden=function(e){return!ve.expr.pseudos.visible(e)},ve.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ve.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Wt=ve.ajaxSettings.xhr();he.cors=!!Wt&&"withCredentials"in Wt,he.ajax=Wt=!!Wt,ve.ajaxTransport(function(e){var t,r;if(he.cors||Wt&&!e.crossDomain)return{send:function(n,o){var i,_=e.xhr();if(_.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)_[i]=e.xhrFields[i];e.mimeType&&_.overrideMimeType&&_.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)_.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(t=r=_.onload=_.onerror=_.onabort=_.onreadystatechange=null,"abort"===e?_.abort():"error"===e?"number"!==typeof _.status?o(0,"error"):o(_.status,_.statusText):o(zt[_.status]||_.status,_.statusText,"text"!==(_.responseType||"text")||"string"!==typeof _.responseText?{binary:_.response}:{text:_.responseText},_.getAllResponseHeaders()))}},_.onload=t(),r=_.onerror=t("error"),void 0!==_.onabort?_.onabort=r:_.onreadystatechange=function(){4===_.readyState&&a.setTimeout(function(){t&&r()})},t=t("abort");try{_.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),ve.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ve.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ve.globalEval(e),e}}}),ve.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ve.ajaxTransport("script",function(e){if(e.crossDomain){var t,a;return{send:function(r,n){t=ve("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",a=function(e){t.remove(),a=null,e&&n("error"===e.type?404:200,e.type)}),ie.head.appendChild(t[0])},abort:function(){a&&a()}}}});var Yt=[],Vt=/(=)\?(?=&|$)|\?\?/;ve.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||ve.expando+"_"+Rt++;return this[e]=!0,e}}),ve.ajaxPrefilter("json jsonp",function(e,t,r){var n,o,i,_=!1!==e.jsonp&&(Vt.test(e.url)?"url":"string"===typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(e.data)&&"data");if(_||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=ve.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,_?e[_]=e[_].replace(Vt,"$1"+n):!1!==e.jsonp&&(e.url+=(Lt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return i||ve.error(n+" was not called"),i[0]},e.dataTypes[0]="json",o=a[n],a[n]=function(){i=arguments},r.always(function(){void 0===o?ve(a).removeProp(n):a[n]=o,e[n]&&(e.jsonpCallback=t.jsonpCallback,Yt.push(n)),i&&ve.isFunction(o)&&o(i[0]),i=o=void 0}),"script"}),he.createHTMLDocument=function(){var e=ie.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),ve.parseHTML=function(e,t,a){if("string"!==typeof e)return[];"boolean"===typeof t&&(a=t,t=!1);var r,n,o;return t||(he.createHTMLDocument?(t=ie.implementation.createHTMLDocument(""),r=t.createElement("base"),r.href=ie.location.href,t.head.appendChild(r)):t=ie),n=we.exec(e),o=!a&&[],n?[t.createElement(n[1])]:(n=y([e],t,o),o&&o.length&&ve(o).remove(),ve.merge([],n.childNodes))},ve.fn.load=function(e,t,a){var r,n,o,i=this,_=e.indexOf(" ");return _>-1&&(r=Q(e.slice(_)),e=e.slice(0,_)),ve.isFunction(t)?(a=t,t=void 0):t&&"object"===typeof t&&(n="POST"),i.length>0&&ve.ajax({url:e,type:n||"GET",dataType:"html",data:t}).done(function(e){o=arguments,i.html(r?ve("<div>").append(ve.parseHTML(e)).find(r):e)}).always(a&&function(e,t){i.each(function(){a.apply(this,o||[e.responseText,t,e])})}),this},ve.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ve.fn[t]=function(e){return this.on(t,e)}}),ve.expr.pseudos.animated=function(e){return ve.grep(ve.timers,function(t){return e===t.elem}).length},ve.offset={setOffset:function(e,t,a){var r,n,o,i,_,s,c,l=ve.css(e,"position"),f=ve(e),u={};"static"===l&&(e.style.position="relative"),_=f.offset(),o=ve.css(e,"top"),s=ve.css(e,"left"),c=("absolute"===l||"fixed"===l)&&(o+s).indexOf("auto")>-1,c?(r=f.position(),i=r.top,n=r.left):(i=parseFloat(o)||0,n=parseFloat(s)||0),ve.isFunction(t)&&(t=t.call(e,a,ve.extend({},_))),null!=t.top&&(u.top=t.top-_.top+i),null!=t.left&&(u.left=t.left-_.left+n),"using"in t?t.using.call(e,u):f.css(u)}},ve.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ve.offset.setOffset(this,e,t)});var t,a,r,n,o=this[0];if(o)return o.getClientRects().length?(r=o.getBoundingClientRect(),t=o.ownerDocument,a=t.documentElement,n=t.defaultView,{top:r.top+n.pageYOffset-a.clientTop,left:r.left+n.pageXOffset-a.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var e,t,a=this[0],r={top:0,left:0};return"fixed"===ve.css(a,"position")?t=a.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),s(e[0],"html")||(r=e.offset()),r={top:r.top+ve.css(e[0],"borderTopWidth",!0),left:r.left+ve.css(e[0],"borderLeftWidth",!0)}),{top:t.top-r.top-ve.css(a,"marginTop",!0),left:t.left-r.left-ve.css(a,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===ve.css(e,"position");)e=e.offsetParent;return e||$e})}}),ve.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var a="pageYOffset"===t;ve.fn[e]=function(r){return ke(this,function(e,r,n){var o;if(ve.isWindow(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===n)return o?o[t]:e[r];o?o.scrollTo(a?o.pageXOffset:n,a?n:o.pageYOffset):e[r]=n},e,r,arguments.length)}}),ve.each(["top","left"],function(e,t){ve.cssHooks[t]=P(he.pixelPosition,function(e,a){if(a)return a=k(e,t),ct.test(a)?ve(e).position()[t]+"px":a})}),ve.each({Height:"height",Width:"width"},function(e,t){ve.each({padding:"inner"+e,content:t,"":"outer"+e},function(a,r){ve.fn[r]=function(n,o){var i=arguments.length&&(a||"boolean"!==typeof n),_=a||(!0===n||!0===o?"margin":"border");return ke(this,function(t,a,n){var o;return ve.isWindow(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===n?ve.css(t,a,_):ve.style(t,a,n,_)},t,i?n:void 0,i)}})}),ve.fn.extend({bind:function(e,t,a){return this.on(e,null,t,a)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,a,r){return this.on(t,e,a,r)},undelegate:function(e,t,a){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",a)}}),ve.holdReady=function(e){e?ve.readyWait++:ve.ready(!0)},ve.isArray=Array.isArray,ve.parseJSON=JSON.parse,ve.nodeName=s,r=[],void 0!==(n=function(){return ve}.apply(t,r))&&(e.exports=n);var Jt=a.jQuery,Kt=a.$;return ve.noConflict=function(e){return a.$===ve&&(a.$=Kt),e&&a.jQuery===ve&&(a.jQuery=Jt),ve},o||(a.jQuery=a.$=ve),ve})},function(e,t,a){"use strict";var r=a(0),n=a(26),o=a(29),i=a(35),_=a(33),s=a(8),c="undefined"!==typeof window&&window.btoa&&window.btoa.bind(window)||a(28);e.exports=function(e){return new Promise(function(t,l){var f=e.data,u=e.headers;r.isFormData(f)&&delete u["Content-Type"];var d=new XMLHttpRequest,p="onreadystatechange",m=!1;if("undefined"===typeof window||!window.XDomainRequest||"withCredentials"in d||_(e.url)||(d=new window.XDomainRequest,p="onload",m=!0,d.onprogress=function(){},d.ontimeout=function(){}),e.auth){var g=e.auth.username||"",h=e.auth.password||"";u.Authorization="Basic "+c(g+":"+h)}if(d.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d[p]=function(){if(d&&(4===d.readyState||m)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var a="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?d.response:d.responseText,o={data:r,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:a,config:e,request:d};n(t,l,o),d=null}},d.onerror=function(){l(s("Network Error",e,null,d)),d=null},d.ontimeout=function(){l(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var v=a(31),b=(e.withCredentials||_(e.url))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;b&&(u[e.xsrfHeaderName]=b)}if("setRequestHeader"in d&&r.forEach(u,function(e,t){"undefined"===typeof f&&"content-type"===t.toLowerCase()?delete u[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"===typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),l(e),d=null)}),void 0===f&&(f=null),d.send(f)})}},function(e,t,a){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,a){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,a){"use strict";var r=a(25);e.exports=function(e,t,a,n,o){var i=new Error(e);return r(i,t,a,n,o)}},function(e,t,a){"use strict";e.exports=function(e,t){return function(){for(var a=new Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];return e.apply(t,a)}}},function(e,t,a){"use strict";function r(){}function n(e){try{return e.then}catch(e){return h=e,v}}function o(e,t){try{return e(t)}catch(e){return h=e,v}}function i(e,t,a){try{e(t,a)}catch(e){return h=e,v}}function _(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._45=0,this._81=0,this._65=null,this._54=null,e!==r&&m(e,this)}function s(e,t,a){return new e.constructor(function(n,o){var i=new _(r);i.then(n,o),c(e,new p(t,a,i))})}function c(e,t){for(;3===e._81;)e=e._65;if(_._10&&_._10(e),0===e._81)return 0===e._45?(e._45=1,void(e._54=t)):1===e._45?(e._45=2,void(e._54=[e._54,t])):void e._54.push(t);l(e,t)}function l(e,t){g(function(){var a=1===e._81?t.onFulfilled:t.onRejected;if(null===a)return void(1===e._81?f(t.promise,e._65):u(t.promise,e._65));var r=o(a,e._65);r===v?u(t.promise,h):f(t.promise,r)})}function f(e,t){if(t===e)return u(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"===typeof t||"function"===typeof t)){var a=n(t);if(a===v)return u(e,h);if(a===e.then&&t instanceof _)return e._81=3,e._65=t,void d(e);if("function"===typeof a)return void m(a.bind(t),e)}e._81=1,e._65=t,d(e)}function u(e,t){e._81=2,e._65=t,_._97&&_._97(e,t),d(e)}function d(e){if(1===e._45&&(c(e,e._54),e._54=null),2===e._45){for(var t=0;t<e._54.length;t++)c(e,e._54[t]);e._54=null}}function p(e,t,a){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=a}function m(e,t){var a=!1,r=i(e,function(e){a||(a=!0,f(t,e))},function(e){a||(a=!0,u(t,e))});a||r!==v||(a=!0,u(t,h))}var g=a(18),h=null,v={};e.exports=_,_._10=null,_._97=null,_._61=r,_.prototype.then=function(e,t){if(this.constructor!==_)return s(this,e,t);var a=new _(r);return c(this,new p(e,t,a)),a}},function(e,t){!function(t){function a(e,t){this.data=e,this.tag=e.tag,this.attrib=e.attrib,this.children=[],"children"in e&&(this.children=e.children),this.text=e.text,this.parent=t}a.prototype.get=function(e,t){return arguments.length>1?this.attrib[e]||t:this.attrib[e]},a.prototype.set=function(e,t){this.attrib[e]=t},a.prototype.has=function(e){return this.attrib.hasOwnProperty(e)},a.prototype.foreach=function(e){for(var t,r=0;t=this.children[r];r++)e.apply(this,[new a(t,this)])},a.prototype.getchildren=function(){for(var e,t=[],r=0;e=this.children[r];r++)t.push(new a(e,this));return t},a.prototype.append=function(e){this.children.push(e)},a.prototype.unshiftchild=function(e){this.children.unshift(e)},a.prototype.find=function(e){for(var t,r=0;t=this.children[r];r++)if(t.tag==e)return new a(t,this)},a.prototype.findall=function(e){els=[];for(var t,r=0;t=this.children[r];r++)t.tag==e&&els.push(new a(t,this));return els},a.prototype.findchildbyattribute=function(e,t){for(var r,n=0;r=this.children[n];n++)if(r.attrib[e]==t)return new a(r,this)},a.prototype.findallchildbyattribute=function(e,t){cEls=[];for(var r,n=0;r=this.children[n];n++)r.attrib[e]==t&&cEls.push(new a(r,this));return cEls},a.prototype.copy=function(){return new a(JSON.parse(JSON.stringify(this.data)))},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=a:t.Element=a}(this)},function(e,t){!function(t){function a(){var e=new Date,t=e.getDate(),a=e.getMonth()+1;return e.getFullYear()+(a<10?"0":"")+a+(t<10?"0":"")+t}function r(e,t){e.prototype=Object.create(t.prototype)}function n(e,t){var a;return t.length>e.length&&(a=t,t=e,e=a),e.filter(function(e){if(-1!==t.indexOf(e))return!0})}function o(e){return e*Math.PI/180}function i(e){return 180*e/Math.PI}function _(e){return e.split(",").map(function(e){return e.trim()})}function s(e,t){return Object.keys(t.attrib).length-Object.keys(e.attrib).length}function c(e){return e*e*e*(e*(6*e-15)+10)}function l(){return vars={},window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,a){vars[t]=a}),vars}function f(e,t){return"string"===typeof e&&"string"===typeof t&&e.toLowerCase()===t.toLowerCase()}toExport={getCurrentDate:a,inheritFrom:r,intersect:n,radians:o,degrees:i,stringToList:_,sortByAttribLength:s,smootherStep:c,getUrlVars:l,lowerStringCompare:f},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=toExport:t.utils=toExport}(this)},function(e,t){!function(t){function a(e,t,a){this._vps=e,this._lerpTime=t,this._sock=a,this._currVp=void 0,this._lastVp=void 0,this._modal=!1,this._modalData=void 0,this._modalRootOption=void 0}a.prototype.getViewpoint=function(e,t){var a=this._vps.findchildbyattribute("name",e);if(a){var r=this.getViewpointOffset(a,t);a.set("offset",{x:r[0],y:r[1],z:r[2]}),a.set("offsetVec",r.join(", ")),a.set("time",this._lerpTime)}return a},a.prototype.getViewpointOffset=function(e,t){var a=[0,0,0];return t.contextMatch(e,function(e){offsetEl=e.getchildren()[0],offsetEl&&/,/.test(offsetEl.get("center"))&&(a=offsetEl.get("center").split(",").map(Number))}),a},a.prototype.setViewpoint=function(e,t,a,r,n){if(n="undefined"!==typeof n?n:{},this._modal)return void console.warn("setViewpoint called while in modal mode.");var o=this.getViewpoint(e,t);if(void 0==o)return void console.warn("Viewpoint missing: "+e);var i=this;if(void 0!=this._currVp&&Object.keys(this._currVp.attrib).forEach(function(e){Object.keys(o.attrib).indexOf(e)<0&&"invert"!=e.toLowerCase()&&o.set(e,i._currVp.get(e))}),void 0!=r)o=o.copy(),o.set("position",r.position),o.set("center",r.center);else if(n.hasOwnProperty("vpPositionTranslation")){o=o.copy();var _=o.attrib.position.split(",");_=_.map(function(e,t){return parseFloat(e)*n.vpPositionTranslation[t]}),o.set("position",_.join(", "))}this._lastVp=this._currVp,this._currVp=o;var s=function(e){try{var a=JSON.parse(e.result);i._modalData=a.from,i._modalRootOption=t}catch(t){console.log("Could not parse setViewpoint2 callback:",t,e.result)}};void 0==a?this._sock.send("setViewpoint2",o.attrib,s):this._sock.sendDelayed("setViewpointWithCallback2",o.attrib,s,a),$(this).trigger("ViewpointManager.setViewpoint",this._currVp)},a.prototype.updateCurrentViewpoint=function(e){if(void 0!=this._currVp){var t=this.getViewpointOffset(this._currVp,e);this._sock.send("setCameraOffset",{x:t[0],y:t[1],z:t[2]})}},a.prototype.enterModalViewpoint=function(e,t){if(this._modal)return void console.warn("enterModalViewpoint called while in modal mode.");this.setViewpoint(e,t),this._modal=!0},a.prototype.exitModalViewpoint=function(e,t){if(!this._modal)return void console.warn("exitModalViewpoint called while not in modal mode.");this._modal=!1,this.setViewpoint(this._lastVp.get("name"),this._modalRootOption,t,this._modalData)},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=a:t.ViewpointManager=a}(this)},function(e,t,a){!function(t){function r(){Element.apply(this,arguments);var e=this;this.hasNullOption=!!this.get("has-null-option"),this.hasNoneOption=void 0!=this.getNone(),this.isMultiSelect=!!this.get("multi-select"),this.isMultiSelect||this.foreach(function(t){t.has("radio-group")&&console.error(e.get("name")+" has radio group "+t.get("radio-group")+" but it is not multi-select.")})}Element=a(11),utils=a(12),r.prototype=Object.create(Element.prototype),r.prototype.constructor=r,r.prototype.getName=function(){return this.get("name")},r.prototype.isNone=function(){return 1==this.get("is-none")},r.prototype.isSelectable=function(){return!this.has("selectable")||!0===this.get("selectable")},r.prototype.isForcible=function(){return!!this.has("forcible")&&!0===this.get("forcible")},r.prototype.getNone=function(){var e=this.findallchildbyattribute("is-none",!0)[0];return void 0!=e?new this.constructor(e.data,this):void 0},r.prototype.getLinkedOptions=function(e){return e=e||this.getRootOption(),this.getAndOrStringOptions("linked",e).map(function(e){return e[0]})},r.prototype.getOptions=function(e,t){var a=this,r=this.findall("Option").filter(function(e){return void 0==t||e.get("type")==t});return opts=[],r.forEach(function(r){opt=new a.constructor(r.data,a),opts.push(opt),e&&(opts=opts.concat(opt.getOptions(e,t)))}),opts},r.prototype.findOption=function(e,t){var a=this.getOptions(t).filter(function(t){return t.get("name")==e});return a.length?a[0]:void 0},r.prototype.getSelectedOptions=function(e){return this.getOptions(e).filter(function(e){return e.isSelected()})},r.prototype.contextMatch=function(e,t){var a=this,r=e.findall("Context");r.sort(utils.sortByAttribLength);for(var n,o=0;n=r[o];o++){if(!Object.keys(n.attrib).filter(function(e){var t=new RegExp(n.attrib[e]),r="";return a.findOption(e,!0).getSelectedOptions().forEach(function(e){var t=(0==r.length?"":" ")+e.get("name");r=r.concat(t)}),!t.test(r)}).length)return void t.apply(this,[n])}},r.prototype.contextMatchElementAttributes=function(e){var t=e.attrib;return this.contextMatch(e,function(e){var a=e.find("Variables");a&&Object.keys(a.attrib).forEach(function(e){t[e]=a.attrib[e]})}),t},r.prototype.clearSelection=function(){this.getOptions().filter(function(e){e.deselect()})},r.prototype.getRootOption=function(){for(var e=this;void 0!=e.parent;)e=e.parent;return e},r.prototype.makeAvailable=function(e){var t=this.getRootOption(),a=this.getAndOrStringOptions("dependent",t),r=this.getAndOrStringOptions("noavail",t);if(a.length>0){a[0].forEach(function(e){e.parent.selectOption(e.get("name"),!0)})}r.forEach(function(t){t.forEach(function(t){t.parent.deselectOption(t.get("name"));var a=t.parent.getNextAvailableOption(t,e);t.parent.deselectOption(a.get("name"),!0)})})},r.prototype.selectOption=function(e,t,a){t=t||!1,a=a||!1;var r=this.findOption(e);if(void 0==r)return!1;var n=r.isSelected(),o=[];if(r.has("radio-group"))for(var i,_=r.getRadioGroups(),s=0;i=_[s];s++)o=o.concat(this.getRadioGroupOptions(i));else this.isMultiSelect&&!r.isNone()||(o=this.getOptions());o.forEach(function(e){e.deselect()}),r.select(!this.get("multi-select")||!n);var c=this.getOptions().filter(function(e){return"GasolineSpoiler"==e.get("name")||"RearLipSpoiler"==e.get("name")||"RearBigSpoiler"==e.get("name")});if(3==c.length){c.filter(function(e){return e.isSelected()}).length<1&&("GasolineSpoiler"==r.get("name")?this.findOption("RearLipSpoiler").select():"RearLipSpoiler"==r.get("name")?this.findOption("GasolineSpoiler").select():"RearBigSpoiler"==r.get("name")&&this.findOption("GasolineSpoiler").select())}var l=this.getRootOption(),f=this.getOptions().filter(function(e){return"GasolineSpoiler"==e.get("name")||"RearLipSpoiler"==e.get("name")}).filter(function(e){return e.isSelected()});if(f.length>0){var u=f[0];"GasolineSpoiler"==u.get("name")?(l.findOption("wheels",!0).findOption("HybridWheel").deselect(),l.findOption("wheels",!0).findOption("AluminumWheel").select()):"RearLipSpoiler"==u.get("name")&&(l.findOption("wheels",!0).findOption("HybridWheel").select(),l.findOption("wheels",!0).findOption("AluminumWheel").deselect())}var d=this.getOptions().filter(function(e){return"AluminumWheel"==e.get("name")||"HybridWheel"==e.get("name")}).filter(function(e){return e.isSelected()});if(d.length>0){var u=d[0];"AluminumWheel"==u.get("name")?(l.findOption("parts",!0).findOption("RearLipSpoiler").deselect(),l.findOption("parts",!0).findOption("GasolineSpoiler").select()):"HybridWheel"==u.get("name")&&(l.findOption("parts",!0).findOption("RearLipSpoiler").select(),l.findOption("parts",!0).findOption("GasolineSpoiler").deselect())}if(r.getLinkedOptions(l).forEach(function(e){a||e.parent.selectOption(e.get("name"),t,!0)}),r.isSelected()&&(r.isForcible()||t)){var l=this.getRootOption(),p=l.getSelectedOptions(!0);r.isAvailable(p)||r.makeAvailable(p)}return!0},r.prototype.deselectOption=function(e){var t=this.findOption(e);return void 0!=t&&(t.deselect(),!0)},r.prototype.getNextAvailableOption=function(e,t){for(var a=this.getOptions(),r=a.map(function(e){return e.get("name")}),n=0,o=r.indexOf(e.get("name")),i=!1;!i&&n<r.length;)o+=1,o>=r.length&&(o=0),i=a[o].isAvailable(t),n+=1;return i?a[o]:void 0},r.prototype.getAvailableOptions=function(e){return this.getOptions().filter(function(t){return t.isAvailable(e)})},r.prototype.getHash=function(){var e={};return this.getOptions().forEach(function(t){if(t.isSelectable()&&t.isSelected()||!t.isSelectable()){var a=t.getHash();e[t.get("partID")||t.get("name")]=a}}),e},r.prototype.setHash=function(e){var t=this;this.clearSelection(),this.getOptions().forEach(function(a){(e.hasOwnProperty(a.get("partID"))||e.hasOwnProperty(a.get("name")))&&t.selectOption(a.get("name")),a.setHash(e[a.get("partID")||a.get("name")]||{})})},r.prototype.getRadioGroups=function(){var e=this.get("radio-group");return void 0!=e?e.split(",").map(function(e){return e.trim()}):[]},r.prototype.getRadioGroupOptions=function(e){return this.getOptions().filter(function(t){if(-1!=t.getRadioGroups().indexOf(e))return!0})},r.prototype.validate=function(e){function t(e,t,a){var r=a.map(function(e){return e.get("name")});if(void 0!=t){var n=r.indexOf(t.get("name"));n>-1?a.splice(n,1):console.warn("Cannot remove option from selection list: ",t.get("name"))}void 0!=e&&a.push(e)}var a,r,n=this,o=this.getSelectedOptions(),e=e||this.getSelectedOptions(!0),i=this.getOptions(),_=!1;if(this.isMultiSelect)o.forEach(function(t){t.isAvailable(e)||n.deselectOption(t.get("name"))});else if(o.length>0){if(a=o[0],!a.isAvailable(e)){if(this.hasNoneOption)r=this.getNone();else{var n=this,s=utils.stringToList(a.get("fallback-option")||""),c=s.map(function(e){return n.findOption(e)}).filter(function(t){return void 0!=t&&t.isAvailable(e)});r=c.length?c[0]:this.getNextAvailableOption(a,e)}_=!0}}else!this.hasNoneOption&&i.length&&(r=this.getNextAvailableOption(i[i.length-1],e),_=!0);if(_&&(void 0!=r?(this.selectOption(r.get("name")),t(r,a,e)):this.hasNullOption&&(this.clearSelection(),t(void 0,a,e))),this.hasNoneOption){var l=this.getNone(),o=this.getSelectedOptions();0==o.length?this.selectOption(l.get("name")):l.isSelected()&&o.length>1&&this.deselectOption(l.get("name"))}i.forEach(function(t){t.getOptions().length&&t.validate(e)});var f=this.getRootOption(),u=f.findOption("smallRearRoofSpoiler",!0),d=f.findOption("rearRoofSpoiler",!0);if(void 0!==u&&!1===u.isSelected()&&void 0!==d&&!1===d.isSelected()){var o=f.getSelectedOptions(!0);u.isAvailable(o)?u.parent.selectOption(u.get("name")):d.parent.selectOption(d.get("name"))}},r.prototype.isSelected=function(){return 1==this.get("selected")},r.prototype.select=function(e){e=void 0==e||e,this.set("selected",e)},r.prototype.deselect=function(){this.select(!1)},r.prototype.isAvailableByName=function(e){return this.isDependencySatisfied(e,"dependent")&&this.isNoAvailabilitySatisfied(e,"noavail")},r.prototype.isAvailable=function(e){var t=e.map(function(e){return e.get("name")});return this.isAvailableByName(t)},r.prototype.isDependencySatisfied=function(e,t){var a=this.get(t);return!(null!=a&&!this._parseAndOrString(e,a))},r.prototype.isNoAvailabilitySatisfied=function(e,t){var a=this.get(t);return!(null!=a&&this._parseAndOrString(e,a))},r.prototype._parseAndOrString=function(e,t){for(var a,r=!1,n=utils.stringToList(t),o=0;a=n[o];o++){var i=!0,_=a.split(" ").map(function(e){return e.trim()});_=_.filter(function(e){return e.length>0}),_.map(function(t){i=i&&-1!=e.indexOf(t)}),r=r||i}return r},r.prototype.getAndOrStringOptions=function(e,t){var a=[];if(this.has(e)){var r=this.get(e);utils.stringToList(r).forEach(function(e){var r=[];e.split(" ").forEach(function(e){r.push(t.findOption(e,!0))}),a.push(r)})}return a},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=r:t.Option=r}(this)},function(e,t){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(a=window)}e.exports=a},function(e,t,a){"use strict";"undefined"===typeof Promise&&(a(53).enable(),window.Promise=a(52)),a(57),Object.assign=a(50)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),n=a.n(r),o=a(39),i=a(37);a.d(t,"rotorCME",function(){return n.a}),a.d(t,"Blend4WebEngine",function(){return o.a}),a.d(t,"AutoRenderer",function(){return i.a})},function(e,t,a){"use strict";(function(t){function a(e){i.length||(o(),_=!0),i[i.length]=e}function r(){for(;s<i.length;){var e=s;if(s+=1,i[e].call(),s>c){for(var t=0,a=i.length-s;t<a;t++)i[t]=i[t+s];i.length-=s,s=0}}i.length=0,s=0,_=!1}function n(e){return function(){function t(){clearTimeout(a),clearInterval(r),e()}var a=setTimeout(t,0),r=setInterval(t,50)}}e.exports=a;var o,i=[],_=!1,s=0,c=1024,l="undefined"!==typeof t?t:self,f=l.MutationObserver||l.WebKitMutationObserver;o="function"===typeof f?function(e){var t=1,a=new f(e),r=document.createTextNode("");return a.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}(r):n(r),a.requestFlush=o,a.makeRequestCallFromTimer=n}).call(t,a(15))},function(e,t,a){e.exports=a(20)},function(e,t,a){"use strict";function r(e){var t=new i(e),a=o(i.prototype.request,t);return n.extend(a,i.prototype,t),n.extend(a,t),a}var n=a(0),o=a(9),i=a(22),_=a(3),s=r(_);s.Axios=i,s.create=function(e){return r(n.merge(_,e))},s.Cancel=a(6),s.CancelToken=a(21),s.isCancel=a(7),s.all=function(e){return Promise.all(e)},s.spread=a(36),e.exports=s,e.exports.default=s},function(e,t,a){"use strict";function r(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var a=this;e(function(e){a.reason||(a.reason=new n(e),t(a.reason))})}var n=a(6);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,a){"use strict";function r(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var n=a(3),o=a(0),i=a(23),_=a(24),s=a(32),c=a(30);r.prototype.request=function(e){"string"===typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),e=o.merge(n,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase(),e.baseURL&&!s(e.url)&&(e.url=c(e.baseURL,e.url));var t=[_,void 0],a=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)a=a.then(t.shift(),t.shift());return a},o.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,a){return this.request(o.merge(a||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,a,r){return this.request(o.merge(r||{},{method:e,url:t,data:a}))}}),e.exports=r},function(e,t,a){"use strict";function r(){this.handlers=[]}var n=a(0);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,a){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var n=a(0),o=a(27),i=a(7),_=a(3);e.exports=function(e){return r(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||_.adapter)(e).then(function(t){return r(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(r(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,a){"use strict";e.exports=function(e,t,a,r,n){return e.config=t,a&&(e.code=a),e.request=r,e.response=n,e}},function(e,t,a){"use strict";var r=a(8);e.exports=function(e,t,a){var n=a.config.validateStatus;a.status&&n&&!n(a.status)?t(r("Request failed with status code "+a.status,a.config,null,a.request,a)):e(a)}},function(e,t,a){"use strict";var r=a(0);e.exports=function(e,t,a){return r.forEach(a,function(a){e=a(e,t)}),e}},function(e,t,a){"use strict";function r(){this.message="String contains an invalid character"}function n(e){for(var t,a,n=String(e),i="",_=0,s=o;n.charAt(0|_)||(s="=",_%1);i+=s.charAt(63&t>>8-_%1*8)){if((a=n.charCodeAt(_+=.75))>255)throw new r;t=t<<8|a}return i}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=n},function(e,t,a){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var n=a(0);e.exports=function(e,t,a){if(!t)return e;var o;if(a)o=a(t);else if(n.isURLSearchParams(t))o=t.toString();else{var i=[];n.forEach(t,function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)&&(t+="[]"),n.isArray(e)||(e=[e]),n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),o=i.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,a){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,a){"use strict";var r=a(0);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,a,n,o,i){var _=[];_.push(e+"="+encodeURIComponent(t)),r.isNumber(a)&&_.push("expires="+new Date(a).toGMTString()),r.isString(n)&&_.push("path="+n),r.isString(o)&&_.push("domain="+o),!0===i&&_.push("secure"),document.cookie=_.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,a){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,a){"use strict";var r=a(0);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return a&&(n.setAttribute("href",t),t=n.href),n.setAttribute("href",t),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}var t,a=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");return t=e(window.location.href),function(a){var n=r.isString(a)?e(a):a;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},function(e,t,a){"use strict";var r=a(0);e.exports=function(e,t){r.forEach(e,function(a,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=a,delete e[r])})}},function(e,t,a){"use strict";var r=a(0);e.exports=function(e){var t,a,n,o={};return e?(r.forEach(e.split("\n"),function(e){n=e.indexOf(":"),t=r.trim(e.substr(0,n)).toLowerCase(),a=r.trim(e.substr(n+1)),t&&(o[t]=o[t]?o[t]+", "+a:a)}),o):o}},function(e,t,a){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,a){"use strict";function r(e,t){if(x)throw new Error("AutoRenderer has already been initialised");T=e,y=t;var a=d()('script[src$="grcme.js"]').attr("src"),r=void 0!==a?a.replace("grcme.js",""):"/",o=r+"scenes/common-assets/CameraAnglesRig.json";S=h.load(o,function(e){O=n("CamFront"),w=n("CamLeftHalf"),R=n("CamLeftFull"),L=n("CamTopHalf"),N=n("CamTopFull"),I=R,M=n("CamGlam"),x=!0})}function n(e){var t=v.get_all_objects().filter(function(t){return t.name===e});return 0===t.length?void console.error("Couldnt find "+e):t[0]}function o(){if(!x)throw new Error("AutoRenderer hasn't been initialised.");A.resize_to_container(!1),A.resize(2048,2048,!1);var e=v.get_active_camera(),t=_(e),a=b.get_fov(e);s([O,w,R,L,N,M],function(){b.target_setup(e,t),b.set_fov(e,a),A.resize_to_container(!0)})}function i(){if(!x)throw new Error("AutoRenderer hasn't been initialised.");A.resize_to_container(!1),A.resize(2048,2048,!1);var e=v.get_active_camera(),t=_(e),a=b.get_fov(e);c(I,function(){b.target_setup(e,t),b.set_fov(e,a),A.resize_to_container(!0)})}function _(e){return{pos:b.get_translation(e),pivot:b.target_get_pivot(e),horiz_rot_lim:b.target_get_horizontal_limits(e),vert_rot_lim:b.target_get_vertical_limits(e),dist_lim:b.target_get_distance_limits(e),pivot_lim:b.target_get_pivot_limits(e),use_panning:!1}}function s(e,t){if(0===e.length)return void t();c(e[0],function(){e.shift(),s(e,function(){return t()})})}function c(e,t){var a=f();l(e,function(){v.hide_object(a),l(e,function(){v.show_object(a),t()})})}function l(e,t){var a=v.get_active_camera();b.static_setup(a),setTimeout(function(){b.set_translation(a,b.get_translation(e)),b.static_set_rotation(a,b.static_get_rotation(e)),b.set_fov(a,b.get_fov(e)),E.shot(),setTimeout(t,C)},200)}function f(){for(var e=0;e<D.length;e++){var t=v.get_object_by_name(D[e]);if(void 0!==t)return t}}var u=a(4),d=a.n(u),p=a(1),m=a.n(p),g=a(2),h=(a.n(g),m.a.require("data")),v=m.a.require("scenes"),b=m.a.require("camera"),E=m.a.require("screen"),A=m.a.require("container"),x=!1,T=void 0,y=void 0,S=void 0,O=void 0,w=void 0,R=void 0,L=void 0,N=void 0,I=void 0,M=void 0,C=1e3,D=["Harrier_AO_Plane","MarkX_AO","Voxy_AO_Plane","Harrier_AO_Plane","AO","Voxy_AO_Plane"];t.a={initialise:r,autoRender:o,renderCurrent:i}},function(e,t,a){"use strict";function r(e){var t=s.utils.stringToList(e),a=parseFloat(t[0].trim()),r=parseFloat(t[1].trim()),n=parseFloat(t[2].trim());return u.fromValues(a,r,n)}function n(e){var t=r(e.position),a=u.fromValues((270-t[1])%360,-t[0]%360,.01*t[2]),n=r(e.center);return[a,u.fromValues(-.01*n[2],-.01*n[0],.01*n[1])]}function o(){}var i=a(1),_=a.n(i),s=a(2),c=(a.n(s),_.a.require("time")),l=_.a.require("camera"),f=_.a.require("controls"),u=_.a.require("vec3");o.prototype.initialise=function(e){this._camera=e},o.prototype.getCurrentViewpoint=function(){var e=new Float32Array(2);l.get_camera_angles(this._camera,e);var t=s.utils.degrees(e[0]),a=s.utils.degrees(e[1]),r=l.target_get_distance(this._camera),n=u.create();l.target_get_pivot(this._camera,n);var o=l.target_get_vertical_limits(this._camera),i=l.target_get_horizontal_limits(this._camera),_=l.target_get_distance_limits(this._camera),c=[o&&o.down?s.utils.degrees(o.down):"null",i&&i.right?270-s.utils.degrees(i.right):"null",_&&_.min?100*_.min:"null"],f=[o&&o.up?-s.utils.degrees(o.up):"null",i&&i.left?270-s.utils.degrees(i.left):"null",_&&_.max?100*_.max:"null"];return{position:-a%360+", "+(270-t)%360+", "+100*r,center:-100*n[1]+", "+100*n[2]+", "+-100*n[0],minLimits:c[0]+", "+c[1]+", "+c[2],maxLimits:f[0]+", "+f[1]+", "+f[2]}},o.prototype.setViewpoint=function(e,t){var a=this;t=t||2;var n=this.getCurrentViewpoint();l.target_set_vertical_limits(this._camera,null),l.target_set_horizontal_limits(this._camera,null),l.target_set_distance_limits(this._camera,null);var o=r(n.position),i=o[1],_=r(e.position)[1],u=i-_;u>=180?i-=360:u<=-180&&(i+=360),n.position=o[0]+", "+i+", "+o[2];var d=c.get_timeline(),p=function(e){return e[0]-d<t};f.create_sensor_manifold(null,"CameraViewpointAnimation",f.CT_CONTINUOUS,[f.create_timeline_sensor()],p,function(o,i,_){var c=void 0;if(_<0)f.remove_sensor_manifold(null,"CameraViewpointAnimation"),c=1;else{c=(f.get_sensor_value(o,i,0)-d)/t,c=s.utils.smootherStep(c)}if(a.lerpViewpoints(n,e,c),c>=1&&e.hasOwnProperty("minLimits")&&e.hasOwnProperty("maxLimits")){var u=r(e.minLimits),p=r(e.maxLimits);l.target_set_vertical_limits(a._camera,{down:s.utils.radians(u[0]),up:-s.utils.radians(p[0])}),l.target_set_horizontal_limits(a._camera,{right:s.utils.radians(270-u[1]),left:s.utils.radians(270-p[1])}),l.target_set_distance_limits(a._camera,{min:.01*u[2],max:.01*p[2]})}})},o.prototype.lerpViewpoints=function(e,t,a){var r=n(e),o=n(t),i=u.create();u.lerp(r[1],o[1],a,i),l.target_set_pivot_translation(this._camera,i);var _=u.create();u.lerp(r[0],o[0],a,_),l.target_set_distance(this._camera,_[2]);var c=new Float32Array(2);l.get_camera_angles(this._camera,c);var f=[s.utils.radians(_[0])-c[0],s.utils.radians(_[1])-c[1]];l.rotate_camera(this._camera,f[0],f[1],!1)},t.a=o},function(e,t,a){"use strict";(function(e){function r(e){return e.split(",").map(function(e){return e.trim()})}function n(){return Z}function o(e){Z=.01*e}function i(){var e=void 0===window.orientation,t=!1,a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")&&(t=!0),e&&t}function _(e,t,r,n,o){function _(e,t){t?S()(K).on("Socket._sendMessage",c):console.error("b4w init failure"),_e&&T(),"function"===typeof r&&r()}if(_e&&x(),window.b4w=L.a,J)throw new Error("Blend4WebEngine.initialise can only be called once.");J=!0,K=t;var s={canvas_container_id:e,callback:_,autoresize:!0,background_color:[.15,.15,.15,0],physics_enabled:!1,allow_cors:!0,assets_gzip_available:!0,assets_min50_available:!0,enable_texture_cache:!1};i()&&(s.assets_gzip_available=!1),n&&(s.show_fps=!0,s.show_hud_debug_info=!0),a.i(N.a)(),U.init(s)}function s(){function e(e,o,i){var _=window.innerWidth>window.innerHeight?a:r,s=B.get_sensor_value(e,o,0),c=t+s*(_-t);if(j.set_fov(n,c),null!==re){s*=s;var l=ne+(1-s)*(re.dof_power-ne),f=0+(1-s)*(re.dof_bokeh-0);G.set_dof_params({dof_power:l,dof_bokeh:f})}}var t=17/180*Math.PI,a=67/180*Math.PI,r=87/180*Math.PI,n=G.get_active_camera(),o=j.target_get_distance_limits(n),i=o.min,_=o.max,s=function(){return j.is_target_camera(n)?(j.target_get_distance(n)-i)/(_-i):0},c=B.create_callback_sensor(s);B.create_sensor_manifold(n,"Camera FOV Zoom",B.CT_CONTINUOUS,[c],void 0,e)}function c(e,t){function a(e,t){K.bluiClbk(e,t)}var r=JSON.parse(t),n=r.cmd,o=r.params;"loadConfigurator"===n?l(o,function(){s(),te.initialise(G.get_active_camera()),w.a.get(Y+"data/textures.json").then(function(e){V=e.data}),w.a.get(Y+"data/postprocessing.json").then(function(e){ie=e.data}),a(r.id,"OK")}):"setVariantSetLookup"===n?(f(o.lookup),a(r.id,"OK")):"setSwitchMaterialLookup"===n?(u(o.lookup),a(r.id,"OK")):"setConfiguration"===n?(d(o),a(r.id,"OK")):"setEnvironment"===n?m(o,function(){return a(r.delId,"OK")}):"showCutScene"===n?!0===o?h():b():"pauseCutScene"===n?v():"takeScreenShot"===n?E(o,function(e){return a(r.delId,e)}):"setViewpoint2"===n&&te.setViewpoint(o)}function l(e,t){_e&&x();var a=Y+"scenes/vehicles/"+e+"/"+e+".json";void 0===$?(Z=0,$=P.load(a,function(e){U.enable_camera_controls(),ae=G.get_dof_params(),re=JSON.parse(JSON.stringify(ae)),oe=G.get_color_correction_params(),_e&&T(),t()},o)):(console.warn("Reloading experience for new vehicle."),window.location.reload())}function f(e){Q=e}function u(e){e.forEach(function(e){var t=r(e.attrib["property-names"]),a=r(e.attrib["property-types"]),n=[],o=[];t.forEach(function(e,t){"value"===a[t]?n.push(e):"rgb"===a[t]?o.push(e):console.error("Unknown property type:",a[t])});var i={},_={};e.children.forEach(function(e){var n=e.attrib.name;i[n]={},_[n]={},e.children.forEach(function(e,o){var s=e.attrib.value;"value"===a[o]?i[n][t[o]]=s:"rgb"===a[o]?_[n][t[o]]=r(s):console.error("Unknown property type:",a[o])})});var s=e.attrib.name,c=new I.a(s,i,_,n,o);se[s]=c})}function d(e){!function(){G.get_all_objects().filter(function(e){return F.get_meta_tags(e)}).forEach(function(e){return G.show_object(e)})}();var t=e.variantSetName;t||(t=Object.keys(Q)[0]);var a=Q[t].disable;a=a.concat(e.geometry.disable),function(e){G.get_all_objects().filter(function(t){var a=F.get_meta_tags(t);return a&&-1!==e.indexOf(a.title)}).forEach(function(e){return G.hide_object(e)})}(a),e.switchMaterials.forEach(function(t){var a=t.switchMaterialName,r=t.instanceMaterialName;se.hasOwnProperty(a)?se[a].startLerpMaterial(r,!1===e.lerp?0:void 0):console.warn("Cannot find switch material:",a)}),G.get_all_objects().filter(function(t){var a=F.get_meta_tags(t);return a&&e.geometry.xforms.hasOwnProperty(a.title)}).forEach(function(t){var a=F.get_meta_tags(t).title,r=e.geometry.xforms[a].pos.split(",").map(function(e){return parseFloat(e)});e.geometry.enable.indexOf(a),z.set_translation(t,r[0],r[1],r[2])})}function p(e,t){var a=[],r=[],n=[];G.get_all_objects().forEach(function(t){"mesh"===G.get_object_type(t).toLowerCase()&&k.get_texture_names(t).forEach(function(o){if(V.Objects.hasOwnProperty(o)){if(!V.Objects[o].hasOwnProperty(e))return void console.warn("Attempt to change texture for environment failed:",o,"->",e);a.push(t),r.push(o),n.push(Y+V.Objects[o][e])}})});var o=G.get_world_by_name("World");if(Object.keys(V.World).forEach(function(t){V.World[t].hasOwnProperty(e)&&(a.push(o),r.push(t),n.push(Y+V.World[t][e]))}),a.length<1)return void t();for(var i=0,_=0;_<a.length;_++)try{k.change_image(a[_],r[_],n[_],function(){(i+=1)===r.length&&t()})}catch(e){console.warn("Failed to change texture path:",e)}}function m(e,t){_e&&x();var a=Y+"scenes/environments/"+e+"/"+e+".json";ee.load(a,function(){g(e),Z=0,p(e,t),_e&&T()},o)}function g(e){function t(e,t){var a=JSON.parse(JSON.stringify(e));return void 0!==t&&Object.keys(t).forEach(function(e){return a[e]=t[e]}),a}var a=ie[e]||{};if(null!==ae&&(re=t(ae,a.dofParams),G.set_dof_params(re),ne=a.minimumDOFPower||0),null!==oe){var r=t(oe,a.colorCorrectionParams);G.set_color_correction_params(r)}}function h(){M.a.playing?M.a.resume():M.a.play()}function v(){M.a.pause()}function b(){M.a.stop()}function E(t,a){var r=t.x,n=t.y,o=q.get("canvas_resolution_factor");r/=o,n/=o,X.resize_to_container(!1),X.resize(r,n,!1),H.canvas_data_url(function(t){w.a.get(t,{responseType:"arraybuffer"}).then(function(t){var r=new e(t.data,"binary").toString("base64");X.resize_to_container(!0),a({imageData:r})})})}function A(){var e=L.a.require("print");e.info=function(){},e.log=function(){},e.log_raw=function(){},e.warn=function(){},e.error=function(){},e.export_warn=function(){},e.export_error=function(){},_e=!0}function x(){window.console=Object.create(console),Object.assign(window.console,{log:function(){return null},warn:function(){return null},error:function(){return null}})}function T(){window.console=Object.getPrototypeOf(window.console)}var y=a(4),S=a.n(y),O=a(19),w=a.n(O),R=a(1),L=a.n(R),N=a(42),I=a(40),M=a(41),C=a(43),D=a(38),U=L.a.require("app"),k=L.a.require("textures"),P=L.a.require("data"),G=L.a.require("scenes"),F=L.a.require("objects"),j=L.a.require("camera"),B=L.a.require("controls"),H=L.a.require("main"),X=L.a.require("container"),q=L.a.require("config"),z=L.a.require("transform"),W=S()('script[src$="grcme.js"]').attr("src"),Y=void 0!==W?W.replace("grcme.js",""):"/",V=void 0,J=!1,K=void 0,Q=void 0,Z=1,$=void 0,ee=new C.a,te=new D.a,ae=null,re=null,ne=0,oe=null,ie=void 0,_e=!1;window.camMgr=te;var se={};A(),t.a={initialise:_,getLoadValue:n,disableLogs:A,get isInitialised(){return J},get isConfigurableLoaded(){return void 0!==$}}}).call(t,a(45).Buffer)},function(e,t,a){"use strict";function r(e,t,a,r,n){var o=this;this.switchName=e,this.materialValues=t||{},this.materialRgbs=a||{},this.valueNames=r||[],this.rgbNames=n||[],this.materialInstances=[],_.get_all_objects().forEach(function(e){if("dynamic"==_.get_type_mesh_object(e).toLowerCase()){var t=s.get_materials_names(e).indexOf(o.switchName);t>-1&&o.materialInstances.push([e,t])}}),this.materialInstances.length<1&&console.error("Cannot find any instances of material:",this.switchName),this.valueNames.forEach(function(e){var t=s.get_nodemat_value(o.materialInstances[0][0],[o.switchName,e]);console.assert(null!==t,'Material "'+o.switchName+'" has no value pin "'+e+'"')}),this.rgbNames.forEach(function(e){var t=s.get_nodemat_rgb(o.materialInstances[0][0],[o.switchName,e]);console.assert(null!==t,'Material "'+o.switchName+'"" has no rgb pin "'+e+'"')})}var n=a(1),o=a.n(n),i=a(2),_=(a.n(i),o.a.require("scenes")),s=o.a.require("material"),c=o.a.require("vec3"),l=o.a.require("controls"),f=o.a.require("time");r.prototype.lerpMaterial=function(e,t){function a(e,t,a){var r=[0,0,0];return c.lerp(e,t,a,r),r}var r=this;this.valueNames.forEach(function(n){var o=[r.startValues[n],0,0],i=[r.materialValues[e][n],0,0];r.setValueNode(n,a(o,i,t)[0])}),this.rgbNames.forEach(function(n){var o=r.startRgbs[n],i=r.materialRgbs[e][n];r.setRgbNode(n,a(o,i,t))})},r.prototype.setValueNode=function(e,t){var a=this;this.materialInstances.forEach(function(r){var n=r[0],o=r[1];s.set_nodemat_value(n,[a.switchName,e],t,o)})},r.prototype.setRgbNode=function(e,t){var a=this;this.materialInstances.forEach(function(r){var n=r[0],o=r[1];s.set_nodemat_rgb(n,[a.switchName,e],t[0],t[1],t[2],o)})},r.prototype.startLerpMaterial=function(e,t){var a=this,r=void 0!==t?t:.3;if(console.assert(this.materialValues.hasOwnProperty(e),'Material "'+this.switchName+'" has no value "'+e+'"'),console.assert(this.materialRgbs.hasOwnProperty(e),'Material "'+this.switchName+'" has no rgb "'+e+'"'),this.startValues={},this.valueNames.forEach(function(e){var t=s.get_nodemat_value(a.materialInstances[0][0],[a.switchName,e]);a.startValues[e]=t}),this.startRgbs={},this.rgbNames.forEach(function(e){var t=s.get_nodemat_rgb(a.materialInstances[0][0],[a.switchName,e]);a.startRgbs[e]=t}),r<=0)return void this.lerpMaterial(e,1);var n=f.get_timeline(),o=function(e){return e[0]-n<r},_=this.switchName+"Blend4WebSwitchMaterial";l.create_sensor_manifold(null,_,l.CT_CONTINUOUS,[l.create_timeline_sensor()],o,function(t,o,s){var c=void 0;if(s<0)l.remove_sensor_manifold(null,_),c=1;else{c=(l.get_sensor_value(t,o,0)-n)/r,c=i.utils.smootherStep(c)}a.lerpMaterial(e,c)})},t.a=r},function(e,t,a){"use strict";function r(){function e(){if(d){if(p)return}else n();v=u(h),b=c.get_fov(h),c.static_setup(h),_.play(g),_.set_speed(g,1),p=!0}function t(){p&&(p=!1,c.target_setup(h,v),c.set_fov(h,b),_.stop(g),_.set_speed(g,1),_.set_frame(g,0),m=!1)}function a(){!m&&p&&(_.stop(g),m=!0)}function r(){m&&p&&(_.play(g),m=!1)}function n(){if(void 0===(g=i.get_object_by_name(f)))throw new Error("Cannot initialise Camera Preview - Cannot find animation camera: "+f);_.apply_def(g),h=i.get_active_camera();var e=new s.create_callback_sensor(function(){return!!p});s.create_sensor_manifold(h,"Camera Preview Animation",s.CT_CONTINUOUS,[e],void 0,o),d=!0}function o(e,t,a){1===a&&l(g,e)}function l(e,t){c.set_translation(t,c.get_translation(e)),c.static_set_rotation(t,c.static_get_rotation(e)),c.set_fov(t,c.get_fov(e))}function u(e){return{pos:c.get_translation(e),pivot:c.target_get_pivot(e),horiz_rot_lim:c.target_get_horizontal_limits(e),vert_rot_lim:c.target_get_vertical_limits(e),dist_lim:c.target_get_distance_limits(e),pivot_lim:c.target_get_pivot_limits(e),use_panning:!1}}var d=!1,p=!1,m=!1,g=void 0,h=void 0,v=void 0,b=0;return{get playing(){return p},get paused(){return m},play:e,stop:t,pause:a,resume:r}}a.d(t,"a",function(){return l});var n=a(1),o=a.n(n),i=o.a.require("scenes"),_=o.a.require("animation"),s=o.a.require("controls"),c=o.a.require("camera"),l=new r,f="cam_All";window.Preview=l},function(e,t,a){"use strict";function r(){n(),p.get("is_mobile_device")?i():o(),s()&&_()}function n(){p.apply_quality(p.P_CUSTOM),p.set("anisotropic_filtering",!0),p.set("antialiasing",!0),p.set("bloom",!1),p.set("dof",!0),p.set("msaa_samples",1)}function o(){p.set("max_fps",60),p.set("canvas_resolution_factor",2)}function i(){p.set("max_fps",30);var e=Math.min(Math.max(1.5,window.devicePixelRatio),2);p.set("canvas_resolution_factor",e),p.set("allow_hidpi",!0)}function _(){p.set("use_min50",!0),p.set("reflection_quality","LOW"),p.set("ssao",!1),p.set("shadows",!1),p.set("texture_lod_available",!0),p.set("force_low_quality_nodes",!0)}function s(){var e=!1;l()&&("6"===c()&&(e=!0),"6+"===c()&&(e=!0),"5"===c()&&(e=!0),"4"===c()&&(e=!0),"2-3"===c()&&(e=!0),e=!0);var t=d.utils.getUrlVars();return e=e||d.utils.lowerStringCompare(t.lowres,"true")}function c(){var e=window.screen.height,t=window.screen.width;return 320===t&&480===e?"4":375===t&&667===e?"6":414===t&&736===e?"6+":320===t&&568===e?"5":e<=480?"2-3":"none"}function l(){return navigator.userAgent.toLowerCase().indexOf("iphone")>-1||navigator.userAgent.toLowerCase().indexOf("ipad")>-1}a.d(t,"a",function(){return r});var f=a(1),u=a.n(f),d=a(2),p=(a.n(d),u.a.require("config"))},function(e,t,a){"use strict";function r(){function e(e,a,r){if(!(o.length>0&&o[o.length-1].url===e)){var n={url:e,loadClbk:a,progressClbk:r};o.push(n),_||t()}}function t(){if(_=!0,0===o.length)return void(_=!1);var e=o.shift(),s=e.url,c=e.loadClbk,l=e.progressClbk;o.length>0?("function"===typeof c&&c(),t()):s!==r?(r=s,void 0!==n&&(a(n),n=void 0),n=i.load(s,function(){"function"===typeof c&&c(),t()},function(e){"function"===typeof l&&l(0===o.length?e:0)},!0)):(_=!1,"function"===typeof c&&c())}function a(e){i.is_idle()?i.unload(e):setTimeout(function(){return a(e)},200)}var r=void 0,n=void 0,o=[],_=!1;return{load:e}}var n=a(1),o=a.n(n),i=o.a.require("data");t.a=r},function(e,t,a){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function n(e){return 3*e.length/4-r(e)}function o(e){var t,a,n,o,i,_=e.length;o=r(e),i=new f(3*_/4-o),a=o>0?_-4:_;var s=0;for(t=0;t<a;t+=4)n=l[e.charCodeAt(t)]<<18|l[e.charCodeAt(t+1)]<<12|l[e.charCodeAt(t+2)]<<6|l[e.charCodeAt(t+3)],i[s++]=n>>16&255,i[s++]=n>>8&255,i[s++]=255&n;return 2===o?(n=l[e.charCodeAt(t)]<<2|l[e.charCodeAt(t+1)]>>4,i[s++]=255&n):1===o&&(n=l[e.charCodeAt(t)]<<10|l[e.charCodeAt(t+1)]<<4|l[e.charCodeAt(t+2)]>>2,i[s++]=n>>8&255,i[s++]=255&n),i}function i(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function _(e,t,a){for(var r,n=[],o=t;o<a;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],n.push(i(r));return n.join("")}function s(e){for(var t,a=e.length,r=a%3,n="",o=[],i=0,s=a-r;i<s;i+=16383)o.push(_(e,i,i+16383>s?s:i+16383));return 1===r?(t=e[a-1],n+=c[t>>2],n+=c[t<<4&63],n+="=="):2===r&&(t=(e[a-2]<<8)+e[a-1],n+=c[t>>10],n+=c[t>>4&63],n+=c[t<<2&63],n+="="),o.push(n),o.join("")}t.byteLength=n,t.toByteArray=o,t.fromByteArray=s;for(var c=[],l=[],f="undefined"!==typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,p=u.length;d<p;++d)c[d]=u[d],l[u.charCodeAt(d)]=d;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(e,t,a){"use strict";(function(e){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function n(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,a){if(!o.TYPED_ARRAY_SUPPORT&&!(this instanceof o))return new o(e,t,a);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return i(this,e,t,a)}function i(e,t,a,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?u(e,t,a,r):"string"===typeof t?l(e,t,a):d(e,t)}function _(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function s(e,t,a,r){return _(t),t<=0?n(e,t):void 0!==a?"string"===typeof r?n(e,t).fill(a,r):n(e,t).fill(a):n(e,t)}function c(e,t){if(_(t),e=n(e,t<0?0:0|p(t)),!o.TYPED_ARRAY_SUPPORT)for(var a=0;a<t;++a)e[a]=0;return e}function l(e,t,a){if("string"===typeof a&&""!==a||(a="utf8"),!o.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(t,a);e=n(e,r);var i=e.write(t,a);return i!==r&&(e=e.slice(0,i)),e}function f(e,t){var a=t.length<0?0:0|p(t.length);e=n(e,a);for(var r=0;r<a;r+=1)e[r]=255&t[r];return e}function u(e,t,a,r){if(t.byteLength,a<0||t.byteLength<a)throw new RangeError("'offset' is out of bounds");if(t.byteLength<a+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===a&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,a):new Uint8Array(t,a,r),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=f(e,t),e}function d(e,t){if(o.isBuffer(t)){var a=0|p(t.length);return e=n(e,a),0===e.length?e:(t.copy(e,0,0,a),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||J(t.length)?n(e,0):f(e,t);if("Buffer"===t.type&&Z(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),o.alloc(+e)}function g(e,t){if(o.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var a=e.length;if(0===a)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return Y(e).length;default:if(r)return q(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,a){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if(a>>>=0,t>>>=0,a<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,a);case"utf8":case"utf-8":return R(this,t,a);case"ascii":return N(this,t,a);case"latin1":case"binary":return I(this,t,a);case"base64":return w(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,a);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,a){var r=e[t];e[t]=e[a],e[a]=r}function b(e,t,a,r,n){if(0===e.length)return-1;if("string"===typeof a?(r=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,isNaN(a)&&(a=n?0:e.length-1),a<0&&(a=e.length+a),a>=e.length){if(n)return-1;a=e.length-1}else if(a<0){if(!n)return-1;a=0}if("string"===typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:E(e,t,a,r,n);if("number"===typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):E(e,[t],a,r,n);throw new TypeError("val must be string, number or Buffer")}function E(e,t,a,r,n){function o(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}var i=1,_=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,_/=2,s/=2,a/=2}var c;if(n){var l=-1;for(c=a;c<_;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*i}else-1!==l&&(c-=c-l),l=-1}else for(a+s>_&&(a=_-s),c=a;c>=0;c--){for(var f=!0,u=0;u<s;u++)if(o(e,c+u)!==o(t,u)){f=!1;break}if(f)return c}return-1}function A(e,t,a,r){a=Number(a)||0;var n=e.length-a;r?(r=Number(r))>n&&(r=n):r=n;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var i=0;i<r;++i){var _=parseInt(t.substr(2*i,2),16);if(isNaN(_))return i;e[a+i]=_}return i}function x(e,t,a,r){return V(q(t,e.length-a),e,a,r)}function T(e,t,a,r){return V(z(t),e,a,r)}function y(e,t,a,r){return T(e,t,a,r)}function S(e,t,a,r){return V(Y(t),e,a,r)}function O(e,t,a,r){return V(W(t,e.length-a),e,a,r)}function w(e,t,a){return 0===t&&a===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,a))}function R(e,t,a){a=Math.min(e.length,a);for(var r=[],n=t;n<a;){var o=e[n],i=null,_=o>239?4:o>223?3:o>191?2:1;if(n+_<=a){var s,c,l,f;switch(_){case 1:o<128&&(i=o);break;case 2:s=e[n+1],128===(192&s)&&(f=(31&o)<<6|63&s)>127&&(i=f);break;case 3:s=e[n+1],c=e[n+2],128===(192&s)&&128===(192&c)&&(f=(15&o)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(i=f);break;case 4:s=e[n+1],c=e[n+2],l=e[n+3],128===(192&s)&&128===(192&c)&&128===(192&l)&&(f=(15&o)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(i=f)}}null===i?(i=65533,_=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),n+=_}return L(r)}function L(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var a="",r=0;r<t;)a+=String.fromCharCode.apply(String,e.slice(r,r+=$));return a}function N(e,t,a){var r="";a=Math.min(e.length,a);for(var n=t;n<a;++n)r+=String.fromCharCode(127&e[n]);return r}function I(e,t,a){var r="";a=Math.min(e.length,a);for(var n=t;n<a;++n)r+=String.fromCharCode(e[n]);return r}function M(e,t,a){var r=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>r)&&(a=r);for(var n="",o=t;o<a;++o)n+=X(e[o]);return n}function C(e,t,a){for(var r=e.slice(t,a),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function D(e,t,a){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,a,r,n,i){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<i)throw new RangeError('"value" argument is out of bounds');if(a+r>e.length)throw new RangeError("Index out of range")}function k(e,t,a,r){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-a,2);n<o;++n)e[a+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function P(e,t,a,r){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-a,4);n<o;++n)e[a+n]=t>>>8*(r?n:3-n)&255}function G(e,t,a,r,n,o){if(a+r>e.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function F(e,t,a,r,n){return n||G(e,t,a,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,a,r,23,4),a+4}function j(e,t,a,r,n){return n||G(e,t,a,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,a,r,52,8),a+8}function B(e){if(e=H(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function X(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var a,r=e.length,n=null,o=[],i=0;i<r;++i){if((a=e.charCodeAt(i))>55295&&a<57344){if(!n){if(a>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&o.push(239,191,189);continue}n=a;continue}if(a<56320){(t-=3)>-1&&o.push(239,191,189),n=a;continue}a=65536+(n-55296<<10|a-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,a<128){if((t-=1)<0)break;o.push(a)}else if(a<2048){if((t-=2)<0)break;o.push(a>>6|192,63&a|128)}else if(a<65536){if((t-=3)<0)break;o.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return o}function z(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}function W(e,t){for(var a,r,n,o=[],i=0;i<e.length&&!((t-=2)<0);++i)a=e.charCodeAt(i),r=a>>8,n=a%256,o.push(n),o.push(r);return o}function Y(e){return K.toByteArray(B(e))}function V(e,t,a,r){for(var n=0;n<r&&!(n+a>=t.length||n>=e.length);++n)t[n+a]=e[n];return n}function J(e){return e!==e}var K=a(44),Q=a(46),Z=a(48);t.Buffer=o,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,a){return i(null,e,t,a)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,a){return s(null,e,t,a)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var a=e.length,r=t.length,n=0,i=Math.min(a,r);n<i;++n)if(e[n]!==t[n]){a=e[n],r=t[n];break}return a<r?-1:r<a?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var a;if(void 0===t)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var r=o.allocUnsafe(t),n=0;for(a=0;a<e.length;++a){var i=e[a];if(!o.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,n),n+=i.length}return r},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):h.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",a=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,a,r,n){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||a>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&t>=a)return 0;if(r>=n)return-1;if(t>=a)return 1;if(t>>>=0,a>>>=0,r>>>=0,n>>>=0,this===e)return 0;for(var i=n-r,_=a-t,s=Math.min(i,_),c=this.slice(r,n),l=e.slice(t,a),f=0;f<s;++f)if(c[f]!==l[f]){i=c[f],_=l[f];break}return i<_?-1:_<i?1:0},o.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},o.prototype.indexOf=function(e,t,a){return b(this,e,t,a,!0)},o.prototype.lastIndexOf=function(e,t,a){return b(this,e,t,a,!1)},o.prototype.write=function(e,t,a,r){if(void 0===t)r="utf8",a=this.length,t=0;else if(void 0===a&&"string"===typeof t)r=t,a=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(a)?(a|=0,void 0===r&&(r="utf8")):(r=a,a=void 0)}var n=this.length-t;if((void 0===a||a>n)&&(a=n),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return A(this,e,t,a);case"utf8":case"utf-8":return x(this,e,t,a);case"ascii":return T(this,e,t,a);case"latin1":case"binary":return y(this,e,t,a);case"base64":return S(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,a);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var a=this.length;e=~~e,t=void 0===t?a:~~t,e<0?(e+=a)<0&&(e=0):e>a&&(e=a),t<0?(t+=a)<0&&(t=0):t>a&&(t=a),t<e&&(t=e);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=o.prototype;else{var n=t-e;r=new o(n,void 0);for(var i=0;i<n;++i)r[i]=this[i+e]}return r},o.prototype.readUIntLE=function(e,t,a){e|=0,t|=0,a||D(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r},o.prototype.readUIntBE=function(e,t,a){e|=0,t|=0,a||D(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},o.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,a){e|=0,t|=0,a||D(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return n*=128,r>=n&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,a){e|=0,t|=0,a||D(e,t,this.length);for(var r=t,n=1,o=this[e+--r];r>0&&(n*=256);)o+=this[e+--r]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},o.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},o.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,a,r){if(e=+e,t|=0,a|=0,!r){U(this,e,t,a,Math.pow(2,8*a)-1,0)}var n=1,o=0;for(this[t]=255&e;++o<a&&(n*=256);)this[t+o]=e/n&255;return t+a},o.prototype.writeUIntBE=function(e,t,a,r){if(e=+e,t|=0,a|=0,!r){U(this,e,t,a,Math.pow(2,8*a)-1,0)}var n=a-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+a},o.prototype.writeUInt8=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,a,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*a-1);U(this,e,t,a,n-1,-n)}var o=0,i=1,_=0;for(this[t]=255&e;++o<a&&(i*=256);)e<0&&0===_&&0!==this[t+o-1]&&(_=1),this[t+o]=(e/i>>0)-_&255;return t+a},o.prototype.writeIntBE=function(e,t,a,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*a-1);U(this,e,t,a,n-1,-n)}var o=a-1,i=1,_=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===_&&0!==this[t+o+1]&&(_=1),this[t+o]=(e/i>>0)-_&255;return t+a},o.prototype.writeInt8=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,a){return e=+e,t|=0,a||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,a){return F(this,e,t,!0,a)},o.prototype.writeFloatBE=function(e,t,a){return F(this,e,t,!1,a)},o.prototype.writeDoubleLE=function(e,t,a){return j(this,e,t,!0,a)},o.prototype.writeDoubleBE=function(e,t,a){return j(this,e,t,!1,a)},o.prototype.copy=function(e,t,a,r){if(a||(a=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<a&&(r=a),r===a)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-a&&(r=e.length-t+a);var n,i=r-a;if(this===e&&a<t&&t<r)for(n=i-1;n>=0;--n)e[n+t]=this[n+a];else if(i<1e3||!o.TYPED_ARRAY_SUPPORT)for(n=0;n<i;++n)e[n+t]=this[n+a];else Uint8Array.prototype.set.call(e,this.subarray(a,a+i),t);return i},o.prototype.fill=function(e,t,a,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,a=this.length):"string"===typeof a&&(r=a,a=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;t>>>=0,a=void 0===a?this.length:a>>>0,e||(e=0);var i;if("number"===typeof e)for(i=t;i<a;++i)this[i]=e;else{var _=o.isBuffer(e)?e:q(new o(e,r).toString()),s=_.length;for(i=0;i<a-t;++i)this[i+t]=_[i%s]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,a(15))},function(e,t){t.read=function(e,t,a,r,n){var o,i,_=8*n-r-1,s=(1<<_)-1,c=s>>1,l=-7,f=a?n-1:0,u=a?-1:1,d=e[t+f];for(f+=u,o=d&(1<<-l)-1,d>>=-l,l+=_;l>0;o=256*o+e[t+f],f+=u,l-=8);for(i=o&(1<<-l)-1,o>>=-l,l+=r;l>0;i=256*i+e[t+f],f+=u,l-=8);if(0===o)o=1-c;else{if(o===s)return i?NaN:1/0*(d?-1:1);i+=Math.pow(2,r),o-=c}return(d?-1:1)*i*Math.pow(2,o-r)},t.write=function(e,t,a,r,n,o){var i,_,s,c=8*o-n-1,l=(1<<c)-1,f=l>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(_=isNaN(t)?1:0,i=l):(i=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-i))<1&&(i--,s*=2),t+=i+f>=1?u/s:u*Math.pow(2,1-f),t*s>=2&&(i++,s/=2),i+f>=l?(_=0,i=l):i+f>=1?(_=(t*s-1)*Math.pow(2,n),i+=f):(_=t*Math.pow(2,f-1)*Math.pow(2,n),i=0));n>=8;e[a+d]=255&_,d+=p,_/=256,n-=8);for(i=i<<n|_,c+=n;c>0;e[a+d]=255&i,d+=p,i/=256,c-=8);e[a+d-p]|=128*m}},function(e,t){function a(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&a(e.slice(0,0))}e.exports=function(e){return null!=e&&(a(e)||r(e)||!!e._isBuffer)}},function(e,t){var a={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},function(e,t,a){var r,n;!function(o,i){"use strict";r=i,void 0!==(n="function"===typeof r?r.call(t,a,t,e):r)&&(e.exports=n)}(0,function(){"use strict";function e(e,t){var a=e[t];if("function"===typeof a.bind)return a.bind(e);try{return Function.prototype.bind.call(a,e)}catch(t){return function(){return Function.prototype.apply.apply(a,[e,arguments])}}}function t(t){return"debug"===t&&(t="log"),typeof console!==_&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):i)}function a(e,t){for(var a=0;a<s.length;a++){var r=s[a];this[r]=a<e?i:this.methodFactory(r,e,t)}this.log=this.debug}function r(e,t,r){return function(){typeof console!==_&&(a.call(this,t,r),this[e].apply(this,arguments))}}function n(e,a,n){return t(e)||r.apply(this,arguments)}function o(e,t,r){function o(e){var t=(s[e]||"silent").toUpperCase();if(typeof window!==_){try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}}function i(){var e;if(typeof window!==_){try{e=window.localStorage[f]}catch(e){}if(typeof e===_)try{var t=window.document.cookie,a=t.indexOf(encodeURIComponent(f)+"=");-1!==a&&(e=/^([^;]+)/.exec(t.slice(a))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}var c,l=this,f="loglevel";e&&(f+=":"+e),l.name=e,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=r||n,l.getLevel=function(){return c},l.setLevel=function(t,r){if("string"===typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"===typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(c=t,!1!==r&&o(t),a.call(l,t,e),typeof console===_&&t<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){i()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var u=i();null==u&&(u=null==t?"WARN":t),l.setLevel(u,!1)}var i=function(){},_="undefined",s=["trace","debug","info","warn","error"],c=new o,l={};c.getLogger=function(e){if("string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new o(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==_?window.log:void 0;return c.noConflict=function(){return typeof window!==_&&window.log===c&&(window.log=f),c},c.getLoggers=function(){return l},c})},function(e,t,a){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},a=0;a<10;a++)t["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var a,_,s=r(e),c=1;c<arguments.length;c++){a=Object(arguments[c]);for(var l in a)o.call(a,l)&&(s[l]=a[l]);if(n){_=n(a);for(var f=0;f<_.length;f++)i.call(a,_[f])&&(s[_[f]]=a[_[f]])}}return s}},function(e,t){function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function n(e){if(l===setTimeout)return setTimeout(e,0);if((l===a||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function i(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&_())}function _(){if(!m){var e=n(i);m=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,m=!1,o(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var l,f,u=e.exports={};!function(){try{l="function"===typeof setTimeout?setTimeout:a}catch(e){l=a}try{f="function"===typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,p=[],m=!1,g=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];p.push(new s(e,t)),1!==p.length||m||n(_)},s.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=c,u.addListener=c,u.once=c,u.off=c,u.removeListener=c,u.removeAllListeners=c,u.emit=c,u.prependListener=c,u.prependOnceListener=c,u.listeners=function(e){return[]},u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,a){"use strict";function r(e){var t=new n(n._61);return t._81=1,t._65=e,t}var n=a(10);e.exports=n;var o=r(!0),i=r(!1),_=r(null),s=r(void 0),c=r(0),l=r("");n.resolve=function(e){if(e instanceof n)return e;if(null===e)return _;if(void 0===e)return s;if(!0===e)return o;if(!1===e)return i;if(0===e)return c;if(""===e)return l;if("object"===typeof e||"function"===typeof e)try{var t=e.then;if("function"===typeof t)return new n(t.bind(e))}catch(e){return new n(function(t,a){a(e)})}return r(e)},n.all=function(e){var t=Array.prototype.slice.call(e);return new n(function(e,a){function r(i,_){if(_&&("object"===typeof _||"function"===typeof _)){if(_ instanceof n&&_.then===n.prototype.then){for(;3===_._81;)_=_._65;return 1===_._81?r(i,_._65):(2===_._81&&a(_._65),void _.then(function(e){r(i,e)},a))}var s=_.then;if("function"===typeof s){return void new n(s.bind(_)).then(function(e){r(i,e)},a)}}t[i]=_,0===--o&&e(t)}if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)r(i,t[i])})},n.reject=function(e){return new n(function(t,a){a(e)})},n.race=function(e){return new n(function(t,a){e.forEach(function(e){n.resolve(e).then(t,a)})})},n.prototype.catch=function(e){return this.then(null,e)}},function(e,t,a){"use strict";function r(){c=!1,_._10=null,_._97=null}function n(e){function t(t){(e.allRejections||i(f[t].error,e.whitelist||s))&&(f[t].displayId=l++,e.onUnhandled?(f[t].logged=!0,e.onUnhandled(f[t].displayId,f[t].error)):(f[t].logged=!0,o(f[t].displayId,f[t].error)))}function a(t){f[t].logged&&(e.onHandled?e.onHandled(f[t].displayId,f[t].error):f[t].onUnhandled||(console.warn("Promise Rejection Handled (id: "+f[t].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+f[t].displayId+".")))}e=e||{},c&&r(),c=!0;var n=0,l=0,f={};_._10=function(e){2===e._81&&f[e._72]&&(f[e._72].logged?a(e._72):clearTimeout(f[e._72].timeout),delete f[e._72])},_._97=function(e,a){0===e._45&&(e._72=n++,f[e._72]={displayId:null,error:a,timeout:setTimeout(t.bind(null,e._72),i(a,s)?100:2e3),logged:!1})}}function o(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}function i(e,t){return t.some(function(t){return e instanceof t})}var _=a(10),s=[ReferenceError,TypeError,RangeError],c=!1;t.disable=r,t.enable=n},function(e,t,a){!function(t){function r(e,t,a,r){this.opts=t,this._currEnv=null,this._prevEnv=null,this._cfgData=e,this._vSetData=a,this.sock=r,this.geoMgr=new GeometryManager(a,e),e&&(this.vpMgr=new ViewpointManager(e.find("Viewpoints"),this.opts.const.viewpointSpeed,this.sock))}GeometryManager=a(55),ViewpointManager=a(13),r.prototype.initialiseEngine=function(e,t){var a=this;a.sock.send("loadConfigurator",e,function(){a.sock.send("setVariantSetLookup",{lookup:a._vSetData},function(){var e=a.geoMgr.getSwitchMaterialLookup(a._cfgData);a.sock.send("setSwitchMaterialLookup",{lookup:e},t)})},6e5)},r.prototype.load=function(e,t){console.log("Loading: "+e),this.sock.send("loadCar",e,t)},r.prototype.runConsoleCommand=function(e,t){this.sock.send("consoleCmd",e,t)},r.prototype.toggleState=function(e,t,a){this.sock.send(e,t,a)},r.prototype.startComparisonMode=function(e){function t(){a.sock.send("setVariantSetLookup",{configurableId:1,lookup:a._vSetData}),"function"==typeof e&&e.call()}if(this._inComparisonMode)throw new Error("Already in comparison mode.");this._inComparisonMode=!0,this.sock.sendDelayed("setupComparisonMode",void 0,void 0,t,15e4);var a=this},r.prototype.stopComparisonMode=function(e){function t(){"function"==typeof e&&e.call()}this._inComparisonMode=!1,this.sock.sendDelayed("disableComparisonMode",void 0,void 0,t,15e4)},r.prototype.playPreview=function(){this.sock.send("showCutScene",!0)},r.prototype.stopPreview=function(){this.sock.send("showCutScene",!1)},r.prototype.pausePreview=function(){this.sock.send("pauseCutScene")},r.prototype.update3dScene=function(e,t){function a(){var a={switchMaterials:r.geoMgr.getSwitchMaterialList(e),geometry:r.geoMgr.getGeo(e),variantSetName:r.geoMgr.getVsetFromParams(e),lerp:t.hasOwnProperty("lerp")?t.lerp:r.opts.const.lerpConfiguration,configurableId:t.configurableId||0};r.sock.send("setConfiguration",a,t.clbk,t.timeout)}t=t||{};var r=this;!function(){var t=e.findOption("environments"),n=void 0!==t?t.getSelectedOptions()[0]:void 0;void 0!==n&&n.get("name")!==r._currEnv?r.setEnvironment(n.get("name"),a):a()}()},r.prototype.setEnvironment=function(e,t){this._prevEnv=this._currEnv,this.sock.sendDelayed("setEnvironment",e,void 0,t,3e5),this._currEnv=e},r.prototype.takeScreenShot=function(e,t){this.sock.sendDelayed("takeScreenShot",e,void 0,function(e){t(e.result)},3e5)},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=r:t.EngineBridge=r}(this)},function(e,t,a){!function(t){function r(e,t){var a=this,r=function(e,t){var a={};for(var r in e)a[r]=e[r];for(var r in t)a[r]=t[r];return a},n=function(e){return e.get("name")},o=function(e){return{pos:e.get("position","0, 0, 0"),rot:e.get("rotation","0, 0, 0")}},i=function(e){return!e.get("switch-material-name")},_=function(e){for(var t=[],a=e.findall("State"),r=0;r<2;r++){var n=[];a[r]&&(n=a[r].findall("Asset").filter(i)),t.push(n)}return t};return a.getGeo=function(e){var t=[],a=[],i={},s=e.getSelectedOptions(!0),c=e.getOptions(!0).filter(function(e){return!e.isSelected()});return s.forEach(function(e){var s=_(e);t=t.concat(s[0].map(n)),a=a.concat(s[1].map(n)),i=r(i,s[0].reduce(function(e,t){return e[n(t)]=o(t),e},{}))}),c.forEach(function(e){var s=_(e);t=t.concat(s[1].map(n).filter(function(e){return a.indexOf(e)<0})),a=a.concat(s[0].map(n).filter(function(e){return t.indexOf(e)<0})),i=r(s[1].reduce(function(e,t){return e[n(t)]=o(t),e},{}),i)}),a=a.filter(function(e){return t.indexOf(e)<0}),{enable:t,disable:a,xforms:i}},a.getSwitchMaterialList=function(e){var t=[];return e.getOptions(!0).filter(function(e){return!e.isSelectable()&&e.has("switch-material-names")}).forEach(function(e){var a=utils.stringToList(e.get("switch-material-names"));e.getSelectedOptions().filter(function(r){var n=r.find("State");n&&n.foreach(function(r){var n=r.get("switch-material-name");if(n&&-1!=a.indexOf(n)){var o={groupName:e.get("name"),switchMaterialName:n,instanceMaterialName:r.get("name")};t.push(o)}})})}),t},a.getSwitchMaterialLookup=function(e){var t=[],a=e.find("Materials");return void 0!=a&&(t=a.findall("SwitchMaterial").map(function(e){return e.data})),t},a.getVsetFromParams=function(e){var a=t.find("VariantSets");if(!a)return null;var r=a.getchildren().sort(utils.sortByAttribLength);for(var n in r){var o=r[n],i="",_=!0;for(var s in o.attrib)if("set"==s)i=o.attrib[s];else{var c=e.findOption(s,!0);if(!c||c.getSelectedOptions()[0].get("name")!=o.attrib[s]){_=!1;break}}if(_)return i}return null},a}Option=a(14),"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports=r:t.GeometryManager=r}(this)},function(e,t,a){!function(t){function r(e){if(!("id"in e))throw new Error('Required argument "id" missing');if(!("callbackDelegate"in e))throw new Error('Required argument "callbackDelegate" missing');this._id=e.id,this._callbackDelegate=e.callbackDelegate,this._host=e.localhost||"localhost",this._port=e.port||3e3,this._type=void 0!=e.type?e.type:n.WEBSOCKET,this._cmdTimeout=e.cmdTimeout||12e4,this._retryPeriod=500,this._queue=[],this._registry={},this._initialized=!1,this._closed=!1,this.CLOSE_NORMAL=1e3,this.CLOSE_GOING_AWAY=1001,this.CLOSE_PROTOCOL_ERROR=1002;var t=this;switch(setInterval(function(){t._messagePumpRecovery()},1e4),this._type){case n.WEBSOCKET:this._initialiseWebSocket();break;case n.DUMMY:case n.TRIGGER:case n.UNREAL:this._initialise()}}log=a(49),$=a(4);var n={DUMMY:0,WEBSOCKET:1,UNREAL:2,TRIGGER:3};r.prototype._initialiseWebSocket=function(){var e=this;e._closed=!1,e._ws=new WebSocket("ws://"+e._host+":"+e._port),e._ws.onopen=function(t){log.info("Socket:",e._id,"opened"),e._ws.send(JSON.stringify(e.formatMessage("idSocket",e._id))),e._initialise()},e._ws.onmessage=function(t){log.info("Socket:",e._id,"received:",t.data);var a=JSON.parse(t.data);if(a.id)e._respond(a);else try{for(var r,n,o=window,i=a.cmd.split("."),_=0;n=i[_];_++){if("function"!=typeof o&&"object"!=typeof o)return void log.warn('Tried to call function "',o,'" which was not found.');r=o,o=o[n]}o.call(r,a.params)}catch(e){log.error(e)}},e._ws.onclose=function(t){log.info("Socket:",e._id,"closed:",t.reason,"clean:",t.wasClean),t.code!=e.CLOSE_NORMAL&&t.code!=e.CLOSE_GOING_AWAY&&t.code!=e.CLOSE_PROTOCOL_ERROR&&setTimeout(function(){e._closed||(log.warn("Socket:",e._id,"reconnecting"),e._initialiseWebSocket())},e._retryPeriod)},e._ws.onerror=function(t){log.error("Socket:",e._id,"error:",t)}},r.prototype._initialise=function(){for(this._initialized=!0;this._queue.length;)this._sendMessage(this._queue.shift());this._closed=!1},r.prototype._respond=function(e){try{var t=this._registry[e.id];t&&(clearTimeout(t.timeoutId),"function"==typeof t.callback&&t.callback(e),delete this._registry[e.id],log.info("Socket:",this._id,"respond:",JSON.stringify(t)))}catch(e){throw log.warn("Socket:",this._id,"received response without request"),e}},r.prototype.createId=function(){return[Date.now(),Math.random().toString().slice(-10)].join(".")},r.prototype.formatMessage=function(e,t,a,r){return{cmd:e,params:t,id:a?this.createId():void 0,delId:r,callbackDelegate:this._callbackDelegate}},r.prototype.registerCallback=function(e,t,a){if(a=a||this._cmdTimeout,void 0!=e){this._registry[e]={id:e,callback:t,timeoutId:setTimeout(function(){log.warn("Socket:",this._id,"callback timeout")},a)}}},r.prototype.send=function(e,t,a,r,o){var i=this.formatMessage(e,t,a,o);return this.registerCallback(i.id,a,r),log.info("Socket:",this._id,"queued:",JSON.stringify(i)),this._queue.push(i),this._type==n.DUMMY&&this.dummyRespond(i.id,!0,e),1===this._queue.length&&this._sendMessage(i),i},r.prototype.sendDelayed=function(e,t,a,r,o){var i=this.createId();return this.registerCallback(i,r,o),this._type==n.DUMMY&&this.dummyRespond(i,!0,e),this.send(e,t,a,o,i)},r.prototype._sendMessage=function(e){var t=JSON.stringify(e),a=!1;switch(this._type){case n.WEBSOCKET:1==this._ws.readyState&&this._initialized&&(log.info("Socket:",this._id,"sent:",t),this._ws.send(t),a=!0);break;case n.UNREAL:log.info("Socket:",this._id,"sent:",t),blu_event("onJsonMessage",t),a=!0;break;case n.DUMMY:case n.TRIGGER:log.info("Socket:",this._id,"sent:",t),$(this).trigger("Socket._sendMessage",[t]),a=!0}a||log.warn("Socket:",this._id,"failed:",t),this._type==n.DUMMY&&e.id&&this._respond({id:e.id,result:!0}),a&&this._queue[0]===e&&(this._queue.shift(),this._queue.length>0&&this._sendMessage(this._queue[0]))},r.prototype._messagePumpRecovery=function(){if(1!=this._closed&&0!=this._queue.length){var e=!1,t=!1;switch(this._type){case n.WEBSOCKET:1==this._ws.readyState?t=!0:(e=!0,this._initialiseWebSocket(),log.warn("Websocket recovery attempted"));break;case n.UNREAL:void 0!=blu_event?t=!0:(e=!0,log.warn("Unreal socket recovery attempted"));break;case n.TRIGGER:case n.DUMMY:t=!0}t&&(this._queue.length>0||e)&&this._sendMessage(this._queue[0])}},r.prototype.dummyRespond=function(e,t,a){var r=this;a&&console.log("Setting dummy callback for",a,e),setTimeout(function(){r._respond({id:e,result:t})},1e3)},r.prototype.close=function(){this._type!=n.DUMMY&&this._type!=n.TRIGGER&&this._ws.close(),this._closed=!0},r.prototype.bluiClbk=function(e,t){try{this._respond({id:e,result:t})}catch(a){log.error("Socket:",e,"respond error:",t,a)}},"undefined"!==typeof e&&"undefined"!==typeof e.exports?e.exports={CommandQueueType:n,Socket:r}:(t.CommandQueueType=n,t.Socket=r)}(this)},function(e,t){!function(e){"use strict";function t(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){return"string"!==typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return h.iterable&&(t[Symbol.iterator]=function(){return t}),t}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function i(e){return new Promise(function(t,a){e.onload=function(){t(e.result)},e.onerror=function(){a(e.error)}})}function _(e){var t=new FileReader,a=i(t);return t.readAsArrayBuffer(e),a}function s(e){var t=new FileReader,a=i(t);return t.readAsText(e),a}function c(e){for(var t=new Uint8Array(e),a=new Array(t.length),r=0;r<t.length;r++)a[r]=String.fromCharCode(t[r]);return a.join("")}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"===typeof e)this._bodyText=e;else if(h.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(h.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(h.arrayBuffer&&h.blob&&b(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!h.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!E(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(_)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(e){var t=e.toUpperCase();return A.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var a=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,a||null==e._bodyInit||(a=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new n(t.headers)),this.method=u(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(a)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var a=e.split("="),r=a.shift().replace(/\+/g," "),n=a.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(n))}}),t}function m(e){var t=new n;return e.split(/\r?\n/).forEach(function(e){var a=e.split(":"),r=a.shift().trim();if(r){var n=a.join(":").trim();t.append(r,n)}}),t}function g(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new n(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var h={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(h.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(e){return e&&DataView.prototype.isPrototypeOf(e)},E=ArrayBuffer.isView||function(e){return e&&v.indexOf(Object.prototype.toString.call(e))>-1};n.prototype.append=function(e,r){e=t(e),r=a(r);var n=this.map[e];this.map[e]=n?n+","+r:r},n.prototype.delete=function(e){delete this.map[t(e)]},n.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(e,r){this.map[t(e)]=a(r)},n.prototype.forEach=function(e,t){for(var a in this.map)this.map.hasOwnProperty(a)&&e.call(t,this.map[a],a,this)},n.prototype.keys=function(){var e=[];return this.forEach(function(t,a){e.push(a)}),r(e)},n.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},n.prototype.entries=function(){var e=[];return this.forEach(function(t,a){e.push([a,t])}),r(e)},h.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},f.call(d.prototype),f.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];g.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=n,e.Request=d,e.Response=g,e.fetch=function(e,t){return new Promise(function(a,r){var n=new d(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;a(new g(t,e))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&h.blob&&(o.responseType="blob"),n.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send("undefined"===typeof n._bodyInit?null:n._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!==typeof self?self:this)},function(e,t,a){a(16),e.exports=a(17)}])});
//# sourceMappingURL=grcme.js.map