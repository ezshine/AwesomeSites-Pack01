var _ENCODINGS;
function _toConsumableArray(e) {
    return _arrayWithoutHoles(e) || _iterableToArray(e) || _unsupportedIterableToArray(e) || _nonIterableSpread()
}
function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
}
function _iterableToArray(e) {
    if ("undefined" != typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"])
        return Array.from(e)
}
function _arrayWithoutHoles(e) {
    if (Array.isArray(e))
        return _arrayLikeToArray(e)
}
function _wrapNativeSuper(e) {
    var t = "function" == typeof Map ? new Map : void 0;
    return _wrapNativeSuper = function(e) {
        if (null === e || !_isNativeFunction(e))
            return e;
        if ("function" != typeof e)
            throw new TypeError("Super expression must either be null or a function");
        if (void 0 !== t) {
            if (t.has(e))
                return t.get(e);
            t.set(e, i)
        }
        function i() {
            return _construct(e, arguments, _getPrototypeOf(this).constructor)
        }
        return i.prototype = Object.create(e.prototype, {
            constructor: {
                value: i,
                enumerable: !1,
                writable: !0,
                configurable: !0
            }
        }),
        _setPrototypeOf(i, e)
    }
    ,
    _wrapNativeSuper(e)
}
function _construct(e, t, i) {
    return (_construct = _isNativeReflectConstruct() ? Reflect.construct.bind() : function(e, t, i) {
        var r = [null];
        r.push.apply(r, t);
        var n = new (Function.bind.apply(e, r));
        return i && _setPrototypeOf(n, i.prototype),
        n
    }
    ).apply(null, arguments)
}
function _isNativeFunction(e) {
    return -1 !== Function.toString.call(e).indexOf("[native code]")
}
function _asyncGeneratorStep(e, t, i, r, n, a, o) {
    try {
        var s = e[a](o)
          , l = s.value
    } catch (h) {
        return void i(h)
    }
    s.done ? t(l) : Promise.resolve(l).then(r, n)
}
function _asyncToGenerator2(e) {
    return function() {
        var t = this
          , i = arguments;
        return new Promise((function(r, n) {
            var a = e.apply(t, i);
            function o(e) {
                _asyncGeneratorStep(a, r, n, o, s, "next", e)
            }
            function s(e) {
                _asyncGeneratorStep(a, r, n, o, s, "throw", e)
            }
            o(void 0)
        }
        ))
    }
}
function _slicedToArray(e, t) {
    return _arrayWithHoles(e) || _iterableToArrayLimit(e, t) || _unsupportedIterableToArray(e, t) || _nonIterableRest()
}
function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
}
function _iterableToArrayLimit(e, t) {
    var i = null == e ? null : "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
    if (null != i) {
        var r, n, a = [], o = !0, s = !1;
        try {
            for (i = i.call(e); !(o = (r = i.next()).done) && (a.push(r.value),
            !t || a.length !== t); o = !0)
                ;
        } catch (l) {
            s = !0,
            n = l
        } finally {
            try {
                o || null == i.return || i.return()
            } finally {
                if (s)
                    throw n
            }
        }
        return a
    }
}
function _arrayWithHoles(e) {
    if (Array.isArray(e))
        return e
}
function _get() {
    return _get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function(e, t, i) {
        var r = _superPropBase(e, t);
        if (r) {
            var n = Object.getOwnPropertyDescriptor(r, t);
            return n.get ? n.get.call(arguments.length < 3 ? e : i) : n.value
        }
    }
    ,
    _get.apply(this, arguments)
}
function _superPropBase(e, t) {
    for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = _getPrototypeOf(e)); )
        ;
    return e
}
function _ownKeys(e, t) {
    var i = Object.keys(e);
    if (Object.getOwnPropertySymbols) {
        var r = Object.getOwnPropertySymbols(e);
        t && (r = r.filter((function(t) {
            return Object.getOwnPropertyDescriptor(e, t).enumerable
        }
        ))),
        i.push.apply(i, r)
    }
    return i
}
function _objectSpread(e) {
    for (var t = 1; t < arguments.length; t++) {
        var i = null != arguments[t] ? arguments[t] : {};
        t % 2 ? _ownKeys(Object(i), !0).forEach((function(t) {
            _defineProperty2(e, t, i[t])
        }
        )) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : _ownKeys(Object(i)).forEach((function(t) {
            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
        }
        ))
    }
    return e
}
function _defineProperty2(e, t, i) {
    return t in e ? Object.defineProperty(e, t, {
        value: i,
        enumerable: !0,
        configurable: !0,
        writable: !0
    }) : e[t] = i,
    e
}
function _inherits(e, t) {
    if ("function" != typeof t && null !== t)
        throw new TypeError("Super expression must either be null or a function");
    e.prototype = Object.create(t && t.prototype, {
        constructor: {
            value: e,
            writable: !0,
            configurable: !0
        }
    }),
    Object.defineProperty(e, "prototype", {
        writable: !1
    }),
    t && _setPrototypeOf(e, t)
}
function _setPrototypeOf(e, t) {
    return (_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(e, t) {
        return e.__proto__ = t,
        e
    }
    )(e, t)
}
function _createSuper(e) {
    var t = _isNativeReflectConstruct();
    return function() {
        var i, r = _getPrototypeOf(e);
        if (t) {
            var n = _getPrototypeOf(this).constructor;
            i = Reflect.construct(r, arguments, n)
        } else
            i = r.apply(this, arguments);
        return _possibleConstructorReturn(this, i)
    }
}
function _possibleConstructorReturn(e, t) {
    if (t && ("object" === _typeof2(t) || "function" == typeof t))
        return t;
    if (void 0 !== t)
        throw new TypeError("Derived constructors may only return object or undefined");
    return _assertThisInitialized(e)
}
function _assertThisInitialized(e) {
    if (void 0 === e)
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return e
}
function _isNativeReflectConstruct() {
    if ("undefined" == typeof Reflect || !Reflect.construct)
        return !1;
    if (Reflect.construct.sham)
        return !1;
    if ("function" == typeof Proxy)
        return !0;
    try {
        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}
        ))),
        !0
    } catch (e) {
        return !1
    }
}
function _getPrototypeOf(e) {
    return (_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(e) {
        return e.__proto__ || Object.getPrototypeOf(e)
    }
    )(e)
}
function _regeneratorRuntime() {
    _regeneratorRuntime = function() {
        return e
    }
    ;
    var e = {}
      , t = Object.prototype
      , i = t.hasOwnProperty
      , r = "function" == typeof Symbol ? Symbol : {}
      , n = r.iterator || "@@iterator"
      , a = r.asyncIterator || "@@asyncIterator"
      , o = r.toStringTag || "@@toStringTag";
    function s(e, t, i) {
        return Object.defineProperty(e, t, {
            value: i,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }),
        e[t]
    }
    try {
        s({}, "")
    } catch (E) {
        s = function(e, t, i) {
            return e[t] = i
        }
    }
    function l(e, t, i, r) {
        var n, a, o, s, l = t && t.prototype instanceof p ? t : p, u = Object.create(l.prototype), d = new S(r || []);
        return u._invoke = (n = e,
        a = i,
        o = d,
        s = "suspendedStart",
        function(e, t) {
            if ("executing" === s)
                throw new Error("Generator is already running");
            if ("completed" === s) {
                if ("throw" === e)
                    throw t;
                return {
                    value: void 0,
                    done: !0
                }
            }
            for (o.method = e,
            o.arg = t; ; ) {
                var i = o.delegate;
                if (i) {
                    var r = b(i, o);
                    if (r) {
                        if (r === c)
                            continue;
                        return r
                    }
                }
                if ("next" === o.method)
                    o.sent = o._sent = o.arg;
                else if ("throw" === o.method) {
                    if ("suspendedStart" === s)
                        throw s = "completed",
                        o.arg;
                    o.dispatchException(o.arg)
                } else
                    "return" === o.method && o.abrupt("return", o.arg);
                s = "executing";
                var l = h(n, a, o);
                if ("normal" === l.type) {
                    if (s = o.done ? "completed" : "suspendedYield",
                    l.arg === c)
                        continue;
                    return {
                        value: l.arg,
                        done: o.done
                    }
                }
                "throw" === l.type && (s = "completed",
                o.method = "throw",
                o.arg = l.arg)
            }
        }
        ),
        u
    }
    function h(e, t, i) {
        try {
            return {
                type: "normal",
                arg: e.call(t, i)
            }
        } catch (E) {
            return {
                type: "throw",
                arg: E
            }
        }
    }
    e.wrap = l;
    var c = {};
    function p() {}
    function u() {}
    function d() {}
    var f = {};
    s(f, n, (function() {
        return this
    }
    ));
    var m = Object.getPrototypeOf
      , g = m && m(m(T([])));
    g && g !== t && i.call(g, n) && (f = g);
    var v = d.prototype = p.prototype = Object.create(f);
    function y(e) {
        ["next", "throw", "return"].forEach((function(t) {
            s(e, t, (function(e) {
                return this._invoke(t, e)
            }
            ))
        }
        ))
    }
    function _(e, t) {
        function r(n, a, o, s) {
            var l = h(e[n], e, a);
            if ("throw" !== l.type) {
                var c = l.arg
                  , p = c.value;
                return p && "object" == _typeof2(p) && i.call(p, "__await") ? t.resolve(p.__await).then((function(e) {
                    r("next", e, o, s)
                }
                ), (function(e) {
                    r("throw", e, o, s)
                }
                )) : t.resolve(p).then((function(e) {
                    c.value = e,
                    o(c)
                }
                ), (function(e) {
                    return r("throw", e, o, s)
                }
                ))
            }
            s(l.arg)
        }
        var n;
        this._invoke = function(e, i) {
            function a() {
                return new t((function(t, n) {
                    r(e, i, t, n)
                }
                ))
            }
            return n = n ? n.then(a, a) : a()
        }
    }
    function b(e, t) {
        var i = e.iterator[t.method];
        if (void 0 === i) {
            if (t.delegate = null,
            "throw" === t.method) {
                if (e.iterator.return && (t.method = "return",
                t.arg = void 0,
                b(e, t),
                "throw" === t.method))
                    return c;
                t.method = "throw",
                t.arg = new TypeError("The iterator does not provide a 'throw' method")
            }
            return c
        }
        var r = h(i, e.iterator, t.arg);
        if ("throw" === r.type)
            return t.method = "throw",
            t.arg = r.arg,
            t.delegate = null,
            c;
        var n = r.arg;
        return n ? n.done ? (t[e.resultName] = n.value,
        t.next = e.nextLoc,
        "return" !== t.method && (t.method = "next",
        t.arg = void 0),
        t.delegate = null,
        c) : n : (t.method = "throw",
        t.arg = new TypeError("iterator result is not an object"),
        t.delegate = null,
        c)
    }
    function x(e) {
        var t = {
            tryLoc: e[0]
        };
        1 in e && (t.catchLoc = e[1]),
        2 in e && (t.finallyLoc = e[2],
        t.afterLoc = e[3]),
        this.tryEntries.push(t)
    }
    function w(e) {
        var t = e.completion || {};
        t.type = "normal",
        delete t.arg,
        e.completion = t
    }
    function S(e) {
        this.tryEntries = [{
            tryLoc: "root"
        }],
        e.forEach(x, this),
        this.reset(!0)
    }
    function T(e) {
        if (e) {
            var t = e[n];
            if (t)
                return t.call(e);
            if ("function" == typeof e.next)
                return e;
            if (!isNaN(e.length)) {
                var r = -1
                  , a = function t() {
                    for (; ++r < e.length; )
                        if (i.call(e, r))
                            return t.value = e[r],
                            t.done = !1,
                            t;
                    return t.value = void 0,
                    t.done = !0,
                    t
                };
                return a.next = a
            }
        }
        return {
            next: k
        }
    }
    function k() {
        return {
            value: void 0,
            done: !0
        }
    }
    return u.prototype = d,
    s(v, "constructor", d),
    s(d, "constructor", u),
    u.displayName = s(d, o, "GeneratorFunction"),
    e.isGeneratorFunction = function(e) {
        var t = "function" == typeof e && e.constructor;
        return !!t && (t === u || "GeneratorFunction" === (t.displayName || t.name))
    }
    ,
    e.mark = function(e) {
        return Object.setPrototypeOf ? Object.setPrototypeOf(e, d) : (e.__proto__ = d,
        s(e, o, "GeneratorFunction")),
        e.prototype = Object.create(v),
        e
    }
    ,
    e.awrap = function(e) {
        return {
            __await: e
        }
    }
    ,
    y(_.prototype),
    s(_.prototype, a, (function() {
        return this
    }
    )),
    e.AsyncIterator = _,
    e.async = function(t, i, r, n, a) {
        void 0 === a && (a = Promise);
        var o = new _(l(t, i, r, n),a);
        return e.isGeneratorFunction(i) ? o : o.next().then((function(e) {
            return e.done ? e.value : o.next()
        }
        ))
    }
    ,
    y(v),
    s(v, o, "Generator"),
    s(v, n, (function() {
        return this
    }
    )),
    s(v, "toString", (function() {
        return "[object Generator]"
    }
    )),
    e.keys = function(e) {
        var t = [];
        for (var i in e)
            t.push(i);
        return t.reverse(),
        function i() {
            for (; t.length; ) {
                var r = t.pop();
                if (r in e)
                    return i.value = r,
                    i.done = !1,
                    i
            }
            return i.done = !0,
            i
        }
    }
    ,
    e.values = T,
    S.prototype = {
        constructor: S,
        reset: function(e) {
            if (this.prev = 0,
            this.next = 0,
            this.sent = this._sent = void 0,
            this.done = !1,
            this.delegate = null,
            this.method = "next",
            this.arg = void 0,
            this.tryEntries.forEach(w),
            !e)
                for (var t in this)
                    "t" === t.charAt(0) && i.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = void 0)
        },
        stop: function() {
            this.done = !0;
            var e = this.tryEntries[0].completion;
            if ("throw" === e.type)
                throw e.arg;
            return this.rval
        },
        dispatchException: function(e) {
            if (this.done)
                throw e;
            var t = this;
            function r(i, r) {
                return o.type = "throw",
                o.arg = e,
                t.next = i,
                r && (t.method = "next",
                t.arg = void 0),
                !!r
            }
            for (var n = this.tryEntries.length - 1; n >= 0; --n) {
                var a = this.tryEntries[n]
                  , o = a.completion;
                if ("root" === a.tryLoc)
                    return r("end");
                if (a.tryLoc <= this.prev) {
                    var s = i.call(a, "catchLoc")
                      , l = i.call(a, "finallyLoc");
                    if (s && l) {
                        if (this.prev < a.catchLoc)
                            return r(a.catchLoc, !0);
                        if (this.prev < a.finallyLoc)
                            return r(a.finallyLoc)
                    } else if (s) {
                        if (this.prev < a.catchLoc)
                            return r(a.catchLoc, !0)
                    } else {
                        if (!l)
                            throw new Error("try statement without catch or finally");
                        if (this.prev < a.finallyLoc)
                            return r(a.finallyLoc)
                    }
                }
            }
        },
        abrupt: function(e, t) {
            for (var r = this.tryEntries.length - 1; r >= 0; --r) {
                var n = this.tryEntries[r];
                if (n.tryLoc <= this.prev && i.call(n, "finallyLoc") && this.prev < n.finallyLoc) {
                    var a = n;
                    break
                }
            }
            a && ("break" === e || "continue" === e) && a.tryLoc <= t && t <= a.finallyLoc && (a = null);
            var o = a ? a.completion : {};
            return o.type = e,
            o.arg = t,
            a ? (this.method = "next",
            this.next = a.finallyLoc,
            c) : this.complete(o)
        },
        complete: function(e, t) {
            if ("throw" === e.type)
                throw e.arg;
            return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg,
            this.method = "return",
            this.next = "end") : "normal" === e.type && t && (this.next = t),
            c
        },
        finish: function(e) {
            for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                var i = this.tryEntries[t];
                if (i.finallyLoc === e)
                    return this.complete(i.completion, i.afterLoc),
                    w(i),
                    c
            }
        },
        catch: function(e) {
            for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                var i = this.tryEntries[t];
                if (i.tryLoc === e) {
                    var r = i.completion;
                    if ("throw" === r.type) {
                        var n = r.arg;
                        w(i)
                    }
                    return n
                }
            }
            throw new Error("illegal catch attempt")
        },
        delegateYield: function(e, t, i) {
            return this.delegate = {
                iterator: T(e),
                resultName: t,
                nextLoc: i
            },
            "next" === this.method && (this.arg = void 0),
            c
        }
    },
    e
}
function _classCallCheck2(e, t) {
    if (!(e instanceof t))
        throw new TypeError("Cannot call a class as a function")
}
function __defineProperties(e, t) {
    for (var i = 0; i < t.length; i++) {
        var r = t[i];
        r.enumerable = r.enumerable || !1,
        r.configurable = !0,
        "value"in r && (r.writable = !0),
        Object.defineProperty(e, r.key, r)
    }
}
function _createClass2(e, t, i) {
    return t && __defineProperties(e.prototype, t),
    i && __defineProperties(e, i),
    Object.defineProperty(e, "prototype", {
        writable: !1
    }),
    e
}
function _typeof2(e) {
    return (_typeof2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    }
    : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    }
    )(e)
}
function _createForOfIteratorHelper(e, t) {
    var i = "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
    if (!i) {
        if (Array.isArray(e) || (i = _unsupportedIterableToArray(e)) || t && e && "number" == typeof e.length) {
            i && (e = i);
            var r = 0
              , n = function() {};
            return {
                s: n,
                n: function() {
                    return r >= e.length ? {
                        done: !0
                    } : {
                        done: !1,
                        value: e[r++]
                    }
                },
                e: function(e) {
                    throw e
                },
                f: n
            }
        }
        throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
    }
    var a, o = !0, s = !1;
    return {
        s: function() {
            i = i.call(e)
        },
        n: function() {
            var e = i.next();
            return o = e.done,
            e
        },
        e: function(e) {
            s = !0,
            a = e
        },
        f: function() {
            try {
                o || null == i.return || i.return()
            } finally {
                if (s)
                    throw a
            }
        }
    }
}
function _unsupportedIterableToArray(e, t) {
    if (e) {
        if ("string" == typeof e)
            return _arrayLikeToArray(e, t);
        var i = Object.prototype.toString.call(e).slice(8, -1);
        return "Object" === i && e.constructor && (i = e.constructor.name),
        "Map" === i || "Set" === i ? Array.from(e) : "Arguments" === i || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i) ? _arrayLikeToArray(e, t) : void 0
    }
}
function _arrayLikeToArray(e, t) {
    (null == t || t > e.length) && (t = e.length);
    for (var i = 0, r = new Array(t); i < t; i++)
        r[i] = e[i];
    return r
}
var p$1 = function() {
    var e = document.createElement("link").relList;
    if (!(e && e.supports && e.supports("modulepreload"))) {
        var t, i = _createForOfIteratorHelper(document.querySelectorAll('link[rel="modulepreload"]'));
        try {
            for (i.s(); !(t = i.n()).done; )
                r(t.value)
        } catch (n) {
            i.e(n)
        } finally {
            i.f()
        }
        new MutationObserver((function(e) {
            var t, i = _createForOfIteratorHelper(e);
            try {
                for (i.s(); !(t = i.n()).done; ) {
                    var a = t.value;
                    if ("childList" === a.type) {
                        var o, s = _createForOfIteratorHelper(a.addedNodes);
                        try {
                            for (s.s(); !(o = s.n()).done; ) {
                                var l = o.value;
                                "LINK" === l.tagName && "modulepreload" === l.rel && r(l)
                            }
                        } catch (n) {
                            s.e(n)
                        } finally {
                            s.f()
                        }
                    }
                }
            } catch (n) {
                i.e(n)
            } finally {
                i.f()
            }
        }
        )).observe(document, {
            childList: !0,
            subtree: !0
        })
    }
    function r(e) {
        if (!e.ep) {
            e.ep = !0;
            var t = function(e) {
                var t = {};
                return e.integrity && (t.integrity = e.integrity),
                e.referrerpolicy && (t.referrerPolicy = e.referrerpolicy),
                "use-credentials" === e.crossorigin ? t.credentials = "include" : "anonymous" === e.crossorigin ? t.credentials = "omit" : t.credentials = "same-origin",
                t
            }(e);
            fetch(e.href, t)
        }
    }
};
p$1();
var index = function() {
    return ':where(html){line-height:1.15}:where(h1){font-size:2em;-webkit-margin-after:.67em;margin-block-end:.67em;-webkit-margin-before:.67em;margin-block-start:.67em}:where(dl,ol,ul) :where(dl,ol,ul){-webkit-margin-after:0;margin-block-end:0;-webkit-margin-before:0;margin-block-start:0}:where(hr){box-sizing:content-box;color:inherit;height:0}:where(pre){font-family:monospace,monospace;font-size:1em}:where(abbr[title]){text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}:where(b,strong){font-weight:bolder}:where(code,kbd,samp){font-family:monospace,monospace;font-size:1em}:where(small){font-size:80%}:where(table){border-color:currentColor;text-indent:0}:where(button,input,select){margin:0}:where(button){text-transform:none}:where(button,input:is([type=button i],[type=reset i],[type=submit i])){-webkit-appearance:button}:where(progress){vertical-align:baseline}:where(select){text-transform:none}:where(textarea){margin:0}:where(input[type=search i]){-webkit-appearance:textfield;outline-offset:-2px}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}:where(button,input:is([type=button i],[type=color i],[type=reset i],[type=submit i]))::-moz-focus-inner{border-style:none;padding:0}:where(button,input:is([type=button i],[type=color i],[type=reset i],[type=submit i]))::-moz-focusring{outline:1px dotted ButtonText}:where(:-moz-ui-invalid){box-shadow:none}:where(dialog){background-color:#fff;border:solid;color:#000;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;left:0;margin:auto;padding:1em;position:absolute;right:0;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}:where(dialog:not([open])){display:none}:where(summary){display:list-item}*,*:before,*:after{box-sizing:border-box}a{text-decoration:none}a,a:active,a:hover,a:visited{color:currentColor;outline:0}@-webkit-keyframes wiggle-animation{0%{transform:rotate(0)}10%{transform:rotate(10deg) scale(.8)}20%{transform:rotate(-10deg) scale(1.1)}30%{transform:rotate(8deg) scale(.95)}40%{transform:rotate(-8deg) scale(1.05)}50%{transform:rotate(4deg) scale(.98)}60%{transform:rotate(-4deg) scale(.98)}70%{transform:rotate(0) scale(1)}}@keyframes wiggle-animation{0%{transform:rotate(0)}10%{transform:rotate(10deg) scale(.8)}20%{transform:rotate(-10deg) scale(1.1)}30%{transform:rotate(8deg) scale(.95)}40%{transform:rotate(-8deg) scale(1.05)}50%{transform:rotate(4deg) scale(.98)}60%{transform:rotate(-4deg) scale(.98)}70%{transform:rotate(0) scale(1)}}.no-select{-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.no-select:focus{outline:none}.no-scroll{-webkit-overflow-scrolling:touch;overflow:hidden;-ms-scroll-chaining:none;overscroll-behavior:none;-ms-overflow-style:none;scrollbar-width:none}.no-scroll::-webkit-scrollbar,.no-scroll::-webkit-scrollbar-track,.no-scroll::-webkit-scrollbar-thumb{-webkit-appearance:none;appearance:none;width:0;height:0;background:transparent;display:none}.hide-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.hide-scrollbar::-webkit-scrollbar,.hide-scrollbar::-webkit-scrollbar-track,.hide-scrollbar::-webkit-scrollbar-thumb{-webkit-appearance:none;appearance:none;width:0;height:0;background:transparent;display:none}.fixed-full-screen{position:fixed;top:0;left:0;right:0;bottom:0;margin:0;padding:0;border:0;overflow:hidden;-ms-scroll-chaining:none;overscroll-behavior:none;touch-action:none}.is-active-template{display:none}.is-active-template.is-active{display:block}.sharedClassesTestBtn{border-radius:50%;width:60px;height:60px;pointer-events:auto;background:linear-gradient(180deg,#ffc806 0%,#eb7100 100%);box-shadow:0 6px #d36601}@font-face{font-family:karlaregular;src:url(./assets/fonts/karla/karla.woff2) format("woff2"),url(./assets/fonts/karla/karla.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:karlasemibold;src:url(./assets/fonts/karla/karla-semi-bold.woff2) format("woff2"),url(./assets/fonts/karla/karla-semi-bold.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:karlabold;src:url(./assets/fonts/karla/karla-bold.woff2) format("woff2"),url(./assets/fonts/karla/karla-bold.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:fredokasemibold;src:url(./assets/fonts/fredoka/fredoka-semi-bold.woff2) format("woff2"),url(./assets/fonts/fredoka/fredoka-semi-bold.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}.dg.ac input,.dg.ac select,.dg.ac .property-name,.dg.ac .close-button{font-family:SFMono-Regular,Jetbrains Mono,Menlo,Monaco,Consolas,Liberation Mono,Courier New,Lucida Console,monospace}.dg .dg.main{margin-right:0;margin-left:10px}.dg.main .property-name{padding-right:5px}.dg.main li.title{background-image:none;position:relative}.dg.main li.title:before{position:absolute;content:"-";left:5px}.dg.main .closed li.title{background-image:none}.dg.main .closed li.title:before{content:"+"}.dg.main .c .slider{position:relative;background:transparent}.dg.main .c .slider:hover{background:transparent}.dg.main .c .slider:hover .slider-fg{background:#0ff}.dg.main .c .slider:before{position:absolute;content:"";display:block;top:25%;height:50%;width:100%;background-color:#111}.dg.main .c .slider-fg{background:#0cc;position:absolute;top:25%;height:50%}.dg.main .cr.number{border-left:3px solid #0ff}.dg.main .cr.number input[type=text]{color:#0ff}html,body{-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;position:fixed;top:0;left:0;right:0;bottom:0;margin:0;padding:0;border:0;-ms-scroll-chaining:none;overscroll-behavior:none;touch-action:none;background-color:#36363a;color:#36363a;font-family:karlaregular;font-size:62.5%;font-weight:400;font-style:normal;image-rendering:-webkit-optimize-contrast;overflow:hidden}html:focus,body:focus{outline:none}html.is-ready,body.is-ready{cursor:none}@media (max-width: 812px){html,body{cursor:default}}html body,html.no-js body{display:none}h1,h2,h3,h4,h5,h6{margin:0;font-family:fredokasemibold,sans-serif}h1{font-size:4.6rem}h2{font-size:3.6rem}h3{font-size:1.6rem}p{margin:0;font-family:karlaregular;font-size:1.6rem;line-height:140%}button{outline:none;border:0;padding:0;font-family:fredokasemibold,sans-serif;color:#36363a}ul{list-style:none;margin:0;padding:0}button{cursor:none;background:transparent}@media (max-width: 812px){button{cursor:default}}input{cursor:none;background:transparent}@media (max-width: 812px){input{cursor:default}}label,a{cursor:none}@media (max-width: 812px){label,a{cursor:default}}#canvas,#ui{position:fixed;top:0;left:0;right:0;bottom:0;margin:0;padding:0;border:0;overflow:hidden;-ms-scroll-chaining:none;overscroll-behavior:none;touch-action:none;background-color:transparent}#canvas{pointer-events:auto}#ui{pointer-events:none}.page{position:fixed;top:0;left:0;right:0;bottom:0;margin:0;padding:0;border:0;overflow:hidden;-ms-scroll-chaining:none;overscroll-behavior:none;touch-action:none;display:none}.page.is-active{display:block}.component{display:none}.component.is-active{display:block}.component--popup{width:100%;height:100%;pointer-events:auto;background:rgba(253,156,14,.75);z-index:1;position:absolute;transition:opacity .5s;opacity:0}.component--popup.animate{opacity:1}.component--popup .component--content{height:calc(100 * var(--vh));transform:perspective(500px) translate3d(0,20px,0) scale(.85) rotateX(2deg);opacity:0;transition:transform .4s 1s ease-in,opacity .5s}.component--popup .component--content.animate{opacity:1;transform:scale(1);transition:transform .4s cubic-bezier(.34,1.56,.64,1)}.component--popup .component--content .component-wrapper{position:absolute;top:50%;transform:translateY(-50%);left:0;right:0;margin:0 auto;padding:50px 45px;width:610px;display:flex;flex-direction:column;justify-content:space-between;background:linear-gradient(180deg,#ffffff 0%,#e7eff8 100%);border-radius:16px;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21))}@media (max-width: 812px){.component--popup .component--content .component-wrapper{max-width:90%;padding:60px 10px}}.component--popup .component--content .component-wrapper h3{text-align:center;font-size:30px}@media (max-width: 812px){.component--popup .component--content .component-wrapper h3{font-size:26px}}.close-btn{position:absolute;right:20px;top:20px;width:30px;height:30px;border-radius:10px;filter:drop-shadow(0px 5px 3px rgba(17,24,55,.21))}@media (max-width: 812px){.close-btn{width:30px;height:30px}}@media (hover: hover){.close-btn:hover .close-btn-container{transform:translateY(1px)}}.close-btn .close-btn-background{position:absolute;width:100%;height:100%;top:-1px;border-radius:10px;box-shadow:0 5px #720ca0;bottom:1px}.close-btn .close-btn-container{position:absolute;width:100%;height:100%;top:0;border-radius:10px;background:linear-gradient(180deg,#db07fe 0%,#7211be 100%);box-shadow:inset 0 -2px 8px #f2a2ff99;display:flex;justify-content:center;align-items:center;transition:transform .2s cubic-bezier(0,.51,.58,.99)}.close-btn .close-btn-container img{width:16px;height:auto}@media (max-width: 812px){.close-btn .close-btn-container img{width:14px}}.switch{position:relative;display:block;width:134px;height:64px;border-radius:16px;box-sizing:content-box;pointer-events:auto;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));transition:transform .7s .7s cubic-bezier(.34,1.56,.64,1)}.switch svg path{transition:.3s fill}.switch:before{content:"";width:100%;height:109%;top:-1%;left:0%;position:absolute;border-radius:18px;z-index:10;opacity:0}@media (max-width: 812px){.switch:before{border-radius:13px;height:111%}}@media (max-width: 812px){.switch{width:115px;height:55px;border-radius:16px}}@media (hover: hover){.switch:hover .switch-container{transform:translateY(1px)}.switch:hover .switch-container:after{opacity:1}}.switch-background{position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;bottom:1px}.switch-background:before,.switch-background:after{content:"";position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;left:0;bottom:0;box-shadow:0 5px #91c5e8}@media (max-width: 812px){.switch-background:before,.switch-background:after{border-radius:12px}}.switch-background:after{box-shadow:0 5px #898be6;opacity:0}.switch-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;transition:transform .2s cubic-bezier(0,.51,.58,.99);z-index:1}.switch-container:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:inset 0 -2px 10px #78cfff99;border-radius:18px}@media (max-width: 812px){.switch-container:before{border-radius:12px}}.switch-container:after{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:inset 0 -2px 20px #78d0ff;border-radius:18px;opacity:0;transition:opacity .5s}@media (max-width: 812px){.switch-container:after{border-radius:12px}}.switch-container.pressed{transform:translateY(4px)!important}.switch-input{width:0;height:0;opacity:0}.switch-input:not(:checked)+.switch-label .switch-first-mode svg{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}.switch-input:checked+.switch-label:before{box-shadow:inset 0 2px 1px #0158b4;background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%)}.switch-input:checked+.switch-label:after{transform:translate(100%,-50%);box-shadow:0 2px 1px #0158b4}@media (max-width: 812px){.switch-input:checked+.switch-label:after{transform:translate(80%,-50%)}}.switch-input:checked+.switch-label .switch-first-mode svg path{fill:#91c5e8}.switch-input:checked+.switch-label .switch-second-mode svg{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}.switch-input:checked+.switch-label .switch-second-mode svg path{fill:#09b1f8}.switch-label{position:absolute;top:0;left:0;right:0;bottom:0;transition:.4s;border-radius:22px;z-index:1}.switch-label:before{position:absolute;content:"";height:24px;width:50px;left:50%;top:50%;transition:transform .4s;transform:translate(-50%,-50%);border-radius:32px;background:linear-gradient(180deg,#ffc806 0%,#eb7100 100%);box-shadow:inset 0 2px 1px #d36601}@media (max-width: 812px){.switch-label:before{width:40px;height:19px}}.switch-label:after{position:absolute;content:"";height:16px;width:16px;left:41%;top:50%;transition:transform .4s;transform:translate(-50%,-50%);border-radius:100%;box-shadow:0 2px 1px #d36601;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%)}@media (max-width: 812px){.switch-label:after{height:12.5px;width:12.5px;left:42%}}.switch-label .switch-first-mode{width:24px;height:24px;left:10px;top:20px;position:absolute;transition:cubic-bezier(.34,1.56,.64,1)}@media (max-width: 812px){.switch-label .switch-first-mode{width:19px;height:19px;top:18px}.switch-label .switch-first-mode svg{width:19px;height:19px}}.switch-label .switch-second-mode{width:24px;height:24px;position:absolute;top:19px;right:10px}.switch-label .switch-second-mode svg path{fill:#91c5e8}@media (max-width: 812px){.switch-label .switch-second-mode{width:18px;height:18px}.switch-label .switch-second-mode svg{width:18px;height:18px}}.btn{filter:drop-shadow(0px 5px 3px rgba(17,24,55,.21));position:relative;color:#fff;border-radius:18px;font-size:18px}.btn .btn-background{position:absolute;width:100%;height:100%;border-radius:18px;top:0;left:0;box-shadow:0 5px #0158b4}.btn .btn-container{position:relative;width:100%;height:100%;padding:16px 32px;border-radius:18px;box-shadow:inset 0 -2px 10px #78cfff99;transition:transform .2s cubic-bezier(0,.51,.58,.99);background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%)}@media (max-width: 812px){.btn .btn-container{padding:14px 30px}}.btn .btn-container span{z-index:1;position:relative;text-shadow:0px 3px 4px #0158b4;font-family:fredokasemibold,sans-serif}@media (hover: hover){.btn:hover .btn-container{transform:translateY(1px)}}.btn.pressed .btn-container{transform:translateY(4px)}.btn.btn-rounded .btn-container{border-radius:100px}.btn.btn-large{font-size:20px}.btn.btn-large .btn-container{padding:20px 50px}.btn.btn-medium{font-size:18px}.btn.btn-medium .btn-container{padding:14px 30px}.btn.btn-small{font-size:16px}.btn.btn-small .btn-container{border-radius:10px;padding:10px 24px}.btn.btn-small .btn-background{border-radius:10px}.btn.btn-white .btn-background{box-shadow:0 5px #91c5e8}.btn.btn-white .btn-container{background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:inset 0 -2px 10px #78cfff99}.btn.btn-white .btn-container span{color:#09b1f8;text-shadow:none}.btn.btn-delete .btn-background{box-shadow:0 5px #cc0a0a}.btn.btn-delete .btn-container{background:linear-gradient(180deg,#ff7b7b 0%,#d71616 100%);box-shadow:inset 0 -1px 5px #ffaeae99}.btn.btn-delete .btn-container span{text-shadow:0px 3px 4px #cc0a0a}#component--cameraMode{width:100%;position:absolute;bottom:0;left:0;padding:50px;pointer-events:none}@media (max-width: 812px){#component--cameraMode{flex-wrap:nowrap;position:absolute;left:26px;top:-60px;padding:0}}#component--cameraMode .component--content{position:relative;bottom:0;left:0;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:flex}#component--cameraMode .camera-btn{position:relative;display:flex;pointer-events:none;height:64px;width:64px;align-items:center;justify-content:center;border-radius:18px;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));transform:translateY(200%);transition:cubic-bezier(.34,1.56,.64,1) .5s}@media (max-width: 812px){#component--cameraMode .camera-btn{height:50px;width:50px;transform:translateY(20px);opacity:0}}@media (min-width: 812px){#component--cameraMode .camera-btn img.wiggle-animation{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}}@media (hover: hover){#component--cameraMode .camera-btn:hover .camera-btn-container{transform:translateY(1px)}#component--cameraMode .camera-btn:hover .camera-btn-container:after{opacity:1}}#component--cameraMode .camera-btn:not(:first-child){margin-left:8px}#component--cameraMode .camera-btn .camera-btn-background{position:absolute;width:100%;height:90%;box-shadow:0 5px #0158b4;border-radius:18px;pointer-events:none;bottom:0}@media (max-width: 812px){#component--cameraMode .camera-btn .camera-btn-background{border-radius:12px}}#component--cameraMode .camera-btn .camera-btn-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;transition:transform .2s cubic-bezier(0,.51,.58,.99);z-index:1}#component--cameraMode .camera-btn .camera-btn-container:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:inset 0 -2px 10px #78cfff99}@media (max-width: 812px){#component--cameraMode .camera-btn .camera-btn-container:before{-webkit-clip-path:none;clip-path:none;border-radius:12px}}#component--cameraMode .camera-btn .camera-btn-container:after{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:inset 0 -2px 10px #78cfff99;opacity:0;transition:opacity .5s}@media (max-width: 812px){#component--cameraMode .camera-btn .camera-btn-container:after{-webkit-clip-path:none;clip-path:none;border-radius:12px}}#component--cameraMode .camera-btn .camera-btn-container.pressed{transform:translateY(4px)}#component--cameraMode .camera-btn img{height:40px;width:auto;margin-bottom:12px;z-index:1;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:translateZ(0)}@media (max-width: 812px){#component--cameraMode .camera-btn img{height:24px}}#component--cameraMode .camera-btn-indicator{width:10px;height:10px;display:inline-block;position:absolute;bottom:5px;left:50%;transform:translate(-50%);border-radius:100%;background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%);border:2px solid #0158b4;z-index:1}@media (max-width: 812px){#component--cameraMode .camera-btn-indicator{height:8px;width:8px}}#component--cameraMode .is-active .camera-btn-indicator{background:linear-gradient(180deg,#86ff26 0%,#22b31f 100%)}#component--cameraMode.animated .camera-btn{transform:translateY(0);pointer-events:auto}@media (max-width: 812px){#component--cameraMode.animated .camera-btn{transform:translateY(0);opacity:1}}#component--settings{pointer-events:auto;position:relative;z-index:1;width:100%;height:100%;background:linear-gradient(90deg,rgba(0,0,0,.35) 0%,rgba(0,0,0,0) 100%);transition:opacity .5s;opacity:0}#component--settings.animate{opacity:1}#component--settings .component--content{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:100%;padding:50px 0 0 50px;transform:translate3d(-150px,0,0);transition:transform .4s 1s ease-in}@media (max-width: 812px){#component--settings .component--content{width:100%;height:100%;padding:20px 0}}#component--settings .component--content.animate{transform:translateZ(0);transition:transform .6s cubic-bezier(.34,1.56,.64,1)}#component--settings .component--content .component-wrapper{width:380px;height:calc(100% - 50px);max-height:700px;background:linear-gradient(180deg,#ffffff 0%,#ecf3fa 76.04%,#e5eaf0 100%);border-radius:16px;padding:50px 65px;position:relative;overflow:auto}@media (max-width: 812px){#component--settings .component--content .component-wrapper{width:calc(100% - 40px);height:100%;max-height:none;padding:50px 25px;margin:0 auto;min-width:340px}}#component--settings .component--content .component-wrapper h3{text-align:center;font-size:30px;margin-bottom:64px}@media (max-width: 812px){#component--settings .component--content .component-wrapper h3{font-size:26px}}#component--settings .component--content .component-wrapper p{font-size:18px;font-family:fredokasemibold,sans-serif}#component--settings .component--content .component-wrapper .settings-switch-day-night{display:flex;justify-content:space-between;align-items:center;max-width:250px;margin:0 auto}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night{filter:drop-shadow(0px 10px 7px rgba(17,24,55,.068))}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-input:checked+.switch-label:before{box-shadow:inset 0 2px 1px #7001b4;background:linear-gradient(180deg,#db07fe 0%,#7211be 100%)}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-input:checked+.switch-label:after{box-shadow:0 2px 1px #7001b4}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-input:checked+.switch-label .switch-first-mode svg path{fill:#91c5e8}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-input:checked+.switch-label .switch-second-mode svg path{fill:#8f00ff}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-label:before{background:linear-gradient(180deg,#ffe91e 0%,#efbb01 100%);box-shadow:inset #e5a809}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-label:after{box-shadow:inset #e5a809;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%)}#component--settings .component--content .component-wrapper .settings-switch-day-night .switch-day-night .switch-second-mode svg path{fill:#91c5e8}#component--settings .component--content .component-wrapper .settings-row{display:flex;justify-content:space-between;max-width:250px;margin:54px auto auto}#component--settings .component--content .component-wrapper .settings-row .settings-row-items{position:relative;display:flex;flex-direction:column;align-items:center}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-help-btn{position:relative}#component--settings .component--content .component-wrapper .settings-row .settings-row-items canvas{position:absolute;left:0;top:16px;pointer-events:none}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn{position:relative}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn.hide canvas,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn.hide canvas{opacity:1}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn.hide img,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn.hide img{opacity:0;transition-delay:.2s}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn.off img:nth-child(1),#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn.off img:nth-child(1){opacity:0}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn.off img:nth-child(2),#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn.off img:nth-child(2){opacity:1;transition-delay:1s}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn img,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn img,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn canvas,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn canvas{transition:opacity .2s ease-out}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn canvas,#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn canvas{opacity:0}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-audio-btn img:nth-child(2),#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn img:nth-child(2){position:absolute;left:50%;transform:translate(-50%);opacity:0;transition-delay:0s;pointer-events:none}#component--settings .component--content .component-wrapper .settings-row .settings-row-items #settings-music-btn.off img:nth-child(2){transition-delay:.2s}#component--settings .component--content .component-wrapper .settings-row:nth-child(4),#component--settings .component--content .component-wrapper .settings-row:nth-child(5){margin-left:auto;margin-right:auto;width:75%}#component--settings .component--content .component-wrapper .settings-row:nth-child(6){justify-content:center;flex-direction:column;align-items:center}#component--settings .component--content .component-wrapper .settings-row:nth-child(6) h4{font-size:20px}#component--settings .component--content .component-wrapper .settings-row:last-child p{font-size:12px;font-family:karlasemibold,sans-serif}#component--settings .component--content .component-wrapper .settings-row img{height:36px;margin-top:16px}#component--settings .component--content .component-wrapper .settings-row span{display:block;font-family:karlasemibold,sans-serif;text-align:center;font-size:16px;margin-top:16px}#component--settings .component--content .component-wrapper .settings-row .settings-row-images{margin-top:8px}#component--settings .component--content .component-wrapper .settings-row .settings-row-images a{display:inline-block}#component--settings .component--content .component-wrapper .settings-row .settings-row-images a:hover img{transform:scale(1.1)}#component--settings .component--content .component-wrapper .settings-row .settings-row-images a img{transition:transform .5s cubic-bezier(.34,1.56,.64,1)}#component--settings .component--content .component-wrapper .settings-row .settings-row-images a:last-child{margin-left:16px}#component--settings .component--content .component-wrapper .settings-row .settings-row-images a:last-child img{height:36px}#component--settings .settings-switch-day-night,#component--settings .settings-row{transform:translate3d(-70px,0,0);opacity:0;-webkit-animation:settings-row-animation .7s cubic-bezier(.34,1.56,.64,1) forwards;animation:settings-row-animation .7s cubic-bezier(.34,1.56,.64,1) forwards}@-webkit-keyframes settings-row-animation{0%{transform:translate3d(-70px,0,0);opacity:0}to{transform:translateZ(0);opacity:1}}@keyframes settings-row-animation{0%{transform:translate3d(-70px,0,0);opacity:0}to{transform:translateZ(0);opacity:1}}#component--cameraSpin .component--content{position:absolute;top:50%;transform:translateY(-50%);left:50px;right:auto;pointer-events:none}@media (max-width: 812px){#component--cameraSpin .component--content{left:140px;transform:translateY(0);top:0;bottom:22px;display:flex;align-items:flex-end}}#component--cameraSpin .cameraSpin-btn{pointer-events:auto;border-radius:100%;height:64px;width:64px;transform:translate3d(-200%,0,0);transition:transform .7s 1s cubic-bezier(.34,1.56,.64,1);filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));position:relative}#component--cameraSpin .cameraSpin-btn:before{content:"";width:102%;height:109%;top:-1%;left:-1%;position:absolute;background:black;border-radius:100%;z-index:10;opacity:0}@media (max-width: 812px){#component--cameraSpin .cameraSpin-btn:before{height:112%}}@media (max-width: 812px){#component--cameraSpin .cameraSpin-btn{width:50px;height:50px;transition:.7s .7s cubic-bezier(.34,1.56,.64,1);transform:translate3d(0,20px,0);opacity:0}}@media (hover: hover){#component--cameraSpin .cameraSpin-btn:hover .cameraSpin-btn-container{transform:translateY(1px)}#component--cameraSpin .cameraSpin-btn:hover .cameraSpin-btn-container:after{opacity:1}}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-background{position:absolute;width:100%;height:100%;border-radius:100%;pointer-events:none;bottom:1px}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-background:before,#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-background:after{content:"";position:absolute;width:100%;height:100%;border-radius:100%;pointer-events:none;left:0;bottom:0;box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-background:after{box-shadow:0 5px #898be6;opacity:0}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;transition:transform .2s cubic-bezier(0,.51,.58,.99);z-index:1}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:inset 0 -2px 10px #78cfff99;border-radius:100%}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container:after{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:inset 0 -2px 20px #78d0ff;opacity:0;transition:opacity .5s;border-radius:100%}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container.pressed{transform:translateY(4px)}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container .cameraSpin-btn-icon{height:36px;z-index:1}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container .cameraSpin-btn-layout{height:52px;position:absolute;z-index:1;transition:.2s cubic-bezier(.34,1.56,.64,1)}@media (max-width: 812px){#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container .cameraSpin-btn-layout{height:40px}}#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container canvas{z-index:1}@media (max-width: 812px){#component--cameraSpin .cameraSpin-btn .cameraSpin-btn-container canvas{width:30px!important;height:30px!important}}.disable-cameraSpin-btn{pointer-events:none}.animated .cameraSpin-btn{opacity:1!important;transform:translateZ(0)!important}@media (max-width: 812px){.cameraSpin-btn.hide{transform:translate3d(0,20px,0)!important;opacity:0!important}}#component--confirmDelete{width:100%;height:100%;pointer-events:auto;background:rgba(253,156,14,.75);z-index:1;position:absolute;top:0;opacity:0;transition:opacity .5s}#component--confirmDelete.animate{opacity:1}#component--confirmDelete .component--content{height:calc(100 * var(--vh));transform:perspective(500px) translate3d(0,20px,0) scale(.85) rotateX(2deg);opacity:0;transition:transform .4s 1s ease-in,opacity .5s}#component--confirmDelete .component--content.animate{opacity:1;transform:scale(1);transition:transform .4s cubic-bezier(.34,1.56,.64,1)}#component--confirmDelete .component--content .component-wrapper{position:absolute;top:50%;transform:translateY(-50%);left:0;right:0;margin:0 auto;padding:50px 40px;width:610px;display:flex;flex-direction:column;justify-content:space-between;background:linear-gradient(180deg,#ffffff 0%,#ecf3fa 76.04%,#e5eaf0 100%);border-radius:16px;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21))}@media (max-width: 812px){#component--confirmDelete .component--content .component-wrapper{max-width:90%;padding:60px 25px 30px}}#component--confirmDelete .component--content .component-wrapper h3{text-align:center;font-size:30px}@media (max-width: 812px){#component--confirmDelete .component--content .component-wrapper h3{font-size:24px}}#confirmDelete-options{display:flex;width:100%;justify-content:center;margin-top:40px}@media (max-width: 812px){#confirmDelete-options{margin-top:60px;flex-direction:column}}#confirmDelete-options #confirmDelete-yes-btn{margin-left:20px}@media (max-width: 812px){#confirmDelete-options #confirmDelete-yes-btn{margin-left:0;margin-top:16px}}#component--footer{display:flex;width:100%;padding:50px;position:absolute;bottom:0;left:0;right:0;align-items:flex-end;justify-content:space-between}@media (max-width: 812px){#component--footer{padding:20px}}#component--header .component--content{position:absolute;padding:50px;left:0;right:0;margin:0 auto;width:100%;display:flex;align-items:center;justify-content:flex-end}#component--header .component--content canvas{transform:translate3d(0,-140px,0);transition:transform .7s .2s cubic-bezier(.34,1.56,.64,1)}@media (max-width: 812px){#component--header .component--content{padding:36px 24px}}#component--header .component--content .header-nav{display:flex;align-items:center;justify-content:space-between}@media (max-width: 812px){#component--header .component--content .header-nav{width:100%}}#component--header .component--content .header-nav #header-snapshot,#component--header .component--content .header-nav #header-gallery,#component--header .component--content .header-nav #header-settings-btn,#component--header .component--content .header-nav #header-audio-btn{height:36px}#component--header .component--content .header-nav #header-share-btn,#component--header .component--content .header-nav #header-about-btn{height:28px}#component--header .component--content .header-nav-item{pointer-events:auto;background:transparent;position:relative;transform:translate3d(0,-110px,0);transition:transform .7s cubic-bezier(.34,1.56,.64,1)}#component--header .component--content .header-nav-item:not(:last-child){margin-right:50px}@media (max-width: 812px){#component--header .component--content .header-nav-item:not(:last-child){margin-right:24px}}#component--header .component--content .header-nav-item img{height:100%}#component--header .component--content .header-nav-item canvas{left:0;pointer-events:none}#header-share{display:flex;align-items:center;pointer-events:auto}#header-share-title{text-transform:uppercase}.animated .header-nav-item,.animated canvas{transform:translateZ(0)!important}#component--info-popup{position:fixed;top:0;left:0}#component--info-popup .info-popup{pointer-events:auto;background-image:url(./assets/images/others/infoPopup-down.png);background-position:center top;background-size:contain;background-repeat:no-repeat;padding:1.5rem 3rem 2rem;transition:transform .5s cubic-bezier(.34,1.56,.64,1);transform:scale(1);filter:drop-shadow(0px 10px 7px rgba(17,24,55,.068))}#component--info-popup .info-popup.right{padding:1.5rem 2.5rem 1.5rem 2rem}#component--info-popup .info-popup p{font-size:16px;position:relative;z-index:1;font-family:fredokasemibold,sans-serif;color:#424242;min-width:6rem;text-align:center;bottom:.2rem}#component--info-popup.hidden .info-popup{transform:scale(0);transition:transform .3s cubic-bezier(.66,0,.35,1.01)}#component--mouse{position:fixed;top:0;left:0;height:30px;width:30px;pointer-events:none;transition:opacity .5s}@media (max-width: 812px){#component--mouse{display:none}}#component--mouse svg{height:100%;width:100%;transition:opacity .3s}#component--mouse .mouse-hover{display:none}#component--mouse.hide svg{opacity:0}#component--player{pointer-events:none}#component--player .component--content{position:absolute;justify-content:space-between;height:145px;top:50%;transform:translateY(-50%);right:50px;left:auto;display:flex;flex-direction:column}@media (max-width: 812px){#component--player .component--content{top:100%;left:24px}}#component--player #player-toolTip{top:3px;right:85px}#component--player #player-playPause-btn{transition-delay:.5s}#component--player #player-reset-btn{transition-delay:.6s}#component--player .player-btn{border-radius:50%;width:64px;height:64px;pointer-events:auto;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));position:relative;transition:.7s cubic-bezier(.34,1.56,.64,1);transform:translate3d(120px,0,0)}#component--player .player-btn:before{content:"";width:102%;height:109%;top:-1%;left:-1%;position:absolute;border-radius:100%;z-index:10;opacity:0}@media (max-width: 812px){#component--player .player-btn:before{height:112%}}@media (max-width: 812px){#component--player .player-btn{position:absolute;top:0;width:50px;height:50px;transform:translate3d(0,20px,0);opacity:0}#component--player .player-btn#player-reset-btn{left:58px}}#component--player .player-btn#player-reset-btn img[data-state=deactive]{opacity:1;transition:opacity .5s}#component--player .player-btn#player-reset-btn.wiggle-animation-reset img[data-state=active]{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}#component--player .player-btn#player-reset-btn.wiggle-animation-reset img[data-state=deactive]{opacity:1;-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}#component--player .player-btn#player-reset-btn.wiggle-animation-play img[data-state=active]{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}#component--player .player-btn#player-reset-btn.wiggle-animation-play img[data-state=deactive]{opacity:0;-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}@media (hover: hover){#component--player .player-btn:hover .player-btn-container{transform:translateY(1px)}}#component--player .player-btn.pressed .player-btn-container{transform:translateY(4px)!important}#component--player .player-btn .player-btn-background{border-radius:50%;position:absolute;height:100%;width:100%;top:-1px;left:0;box-shadow:0 6px #d36601;pointer-events:none}#component--player .player-btn .player-btn-container{border-radius:50%;position:absolute;height:100%;width:100%;top:0;left:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#ffc806 0%,#eb7100 100%);transition:transform .2s cubic-bezier(0,.51,.58,.99);box-shadow:inset 0 -1px 8px #fff27899;pointer-events:none}#component--player .player-btn .player-btn-container img{height:36px;width:auto;z-index:1;pointer-events:none}@media (max-width: 812px){#component--player .player-btn .player-btn-container img{height:25px}}.animated .player-btn{opacity:1!important;transform:translateZ(0)!important}#share-container{display:flex;flex-direction:column;align-items:center}#share-container p{font-size:22px;line-height:1.4;text-align:center;margin:32px 16px}@media (max-width: 812px){#share-container p{font-size:18px}}#share-options{display:flex;width:80%;justify-content:space-around}@media (max-width: 812px){#share-options{flex-direction:column}}@media (hover: hover){#share-fb-btn:hover img,#share-tw-btn:hover img,#share-copyURL-btn:hover img{transform:scale(1.1) rotate(5deg);opacity:0}#share-fb-btn:hover img:nth-child(2),#share-tw-btn:hover img:nth-child(2),#share-copyURL-btn:hover img:nth-child(2){transform:scale(1.1) rotate(5deg);opacity:1}#share-fb-btn:hover:nth-child(2) img,#share-tw-btn:hover:nth-child(2) img,#share-copyURL-btn:hover:nth-child(2) img{transform:scale(1.1) rotate(-5deg)}}.share-btn{pointer-events:auto;position:relative}@media (max-width: 812px){.share-btn:not(:first-child){margin-top:24px}}.share-btn .share-copyURL-btn-container{display:inline-block;transition:transform .6s cubic-bezier(.34,1.56,.64,1)}.share-btn img{transition:transform .4s cubic-bezier(.34,1.56,.64,1),opacity .4s ease-in-out}.share-btn img:nth-child(2){position:absolute;right:0;top:0;opacity:0;transition:transform .4s cubic-bezier(.34,1.56,.64,1),opacity .4s ease-in-out}.share-btn:last-child{display:flex;justify-content:flex-end;transform-origin:center}.share-btn:last-child img{height:37px}@media (max-width: 812px){.share-btn:last-child{display:block}.share-btn:last-child img{height:36px}}.share-btn img{height:32px;width:auto}.share-btn .share-urlCopied-btn-container{position:absolute;left:50%;transform:translate(-50%) scale(0);pointer-events:none;top:3px;transition:transform .6s cubic-bezier(.34,1.56,.64,1)}.share-btn .share-urlCopied-btn-container img{height:34px}.share-btn.copied .share-copyURL-btn-container{transform:scale(0);pointer-events:none}.share-btn.copied .share-urlCopied-btn-container{transform:translate(-50%) scale(1);pointer-events:auto}#share-tw-btn img:nth-child(2),#share-fb-btn img:nth-child(2){top:3px}#switch-mode-toolTip{top:120px;right:50px}.switch-mode{transform:translate3d(0,200%,0);filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21))}@media (max-width: 812px){.switch-mode{transform:translate3d(0,20px,0);opacity:0;transition:.7s .8s cubic-bezier(.34,1.56,.64,1)}}.switch-mode .switch-first-mode{top:22px;left:10px}@media (max-width: 812px){.switch-mode .switch-first-mode{top:19px}}.switch-mode .switch-second-mode{top:24px;right:8px}@media (max-width: 812px){.switch-mode .switch-second-mode{top:18px;right:10px}}.switch-mode .switch-input:checked+.switch-label:before{box-shadow:inset 0 2px 1px #0158b4;background:linear-gradient(180deg,#07b9fe 0%,#1160be 100%)}.switch-mode .switch-input:checked+.switch-label:after{box-shadow:0 2px 1px #0158b4}.switch-mode .switch-input:checked+.switch-label .switch-first-mode svg path{fill:#91c5e8}.switch-mode .switch-input:checked+.switch-label .switch-second-mode svg path{fill:#09b1f8}.switch-mode .switch-label:before{background:linear-gradient(180deg,#ffc806 0%,#eb7100 100%)}.switch-mode .switch-label:after{background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%)}.switch-mode .switch-label .switch-second-mode svg path{fill:#91c5e8}@-webkit-keyframes pop-animation-switch{0%{transform:scale(1)}50%{transform:scale(1.2) rotate(10deg)}to{transform:scale(1)}}@keyframes pop-animation-switch{0%{transform:scale(1)}50%{transform:scale(1.2) rotate(10deg)}to{transform:scale(1)}}.animated .switch{transform:translateZ(0)!important;opacity:1!important}#component--toolTips-background{position:absolute;top:0;left:0;width:100%;height:100%;background:#000000;transition:opacity .4s;opacity:0;z-index:1}#component--toolTips-background.animate{opacity:.5;pointer-events:auto}#component--toolTip{position:absolute;width:100%;height:100%;top:0;left:0;z-index:10}#component--toolTip .component--content{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;justify-content:center;align-items:center;opacity:0;transform:perspective(500px) translate3d(0,20px,0) scale(.75) rotateX(10deg);transition:opacity .4s,transform .4s ease-in}#component--toolTip .component--content.animate{opacity:1;transform:scale(1);transition:opacity .6s,transform .6s cubic-bezier(.34,1.56,.64,1)}#component--toolTip .component--content.animate .toolTips-skip,#component--toolTip .component--content.animate .btn{transform:translateY(0)!important;opacity:1!important}#component--toolTip .component--content .toolTips{position:relative;display:flex;flex-direction:column;align-items:center;width:610px;border-radius:16px;background:linear-gradient(180deg,#ffffff 0%,#ecf3fa 76.04%,#e5eaf0 100%);box-shadow:0 48px 19px #11183703,0 27px 16px #11183705,0 12px 12px #1118370a,0 3px 7px #1118370d,0 0 #1118370d;padding:20px 0}@media (max-width: 812px){#component--toolTip .component--content .toolTips{width:90%}}#component--toolTip .component--content .toolTips .btn{pointer-events:auto}#component--toolTip .component--content .toolTips-skip{font-size:1.4rem;letter-spacing:1px;text-transform:uppercase;position:absolute;top:24px;right:24px;color:#09b1f8;pointer-events:auto;transform:translateY(20px);opacity:0;transition:.6s 1s cubic-bezier(.34,1.56,.64,1);font-family:fredokasemibold,sans-serif}#component--toolTip .component--content .toolTips-skip:hover:before{transform:scaleX(1)}#component--toolTip .component--content .toolTips-skip:before{content:"";bottom:-2px;left:0;position:absolute;height:2px;width:100%;background:#09b1f8;transform-origin:left;transform:scaleX(0);transition:transform cubic-bezier(.66,0,.35,1.01) .5s}#component--toolTip .component--content .toolTips .toolTip{position:relative;display:flex;flex-direction:column;align-items:center;padding:16px 64px 0}#component--toolTip .component--content .toolTips .toolTip:nth-child(2) .toolTip-description,#component--toolTip .component--content .toolTips .toolTip:nth-child(3) .toolTip-description{display:block}@media (max-width: 812px){#component--toolTip .component--content .toolTips .toolTip:nth-child(2) .toolTip-description,#component--toolTip .component--content .toolTips .toolTip:nth-child(3) .toolTip-description{display:none}}#component--toolTip .component--content .toolTips .toolTip:nth-child(2) .toolTip-description-mobile,#component--toolTip .component--content .toolTips .toolTip:nth-child(3) .toolTip-description-mobile{display:none}@media (max-width: 812px){#component--toolTip .component--content .toolTips .toolTip:nth-child(2) .toolTip-description-mobile,#component--toolTip .component--content .toolTips .toolTip:nth-child(3) .toolTip-description-mobile{display:block}}#component--toolTip .component--content .toolTips .toolTip:not(:nth-child(2)){position:absolute}@media (max-width: 812px){#component--toolTip .component--content .toolTips .toolTip{padding:32px 16px 0}}#component--toolTip .component--content .toolTips .toolTip-illustration{height:150px;width:300px}#component--toolTip .component--content .toolTips .toolTip-illustration img{height:100%;width:100%;opacity:0;transition:opacity .5s;-o-object-fit:contain;object-fit:contain}#component--toolTip .component--content .toolTips .toolTip-illustration img:nth-child(2){display:none}#component--toolTip .component--content .toolTips .toolTip-title{font-size:2.6rem;margin-top:24px}#component--toolTip .component--content .toolTips .toolTip-description,#component--toolTip .component--content .toolTips .toolTip-description-mobile{font-size:1.6rem;margin-top:32px;text-align:center}@media (max-width: 812px){#component--toolTip .component--content .toolTips .toolTip-description,#component--toolTip .component--content .toolTips .toolTip-description-mobile{margin-top:20px}}#component--toolTip .component--content .toolTips .toolTip-description-mobile{display:none}@media (max-width: 812px){#component--toolTip .component--content .toolTips .toolTip-description-mobile{display:block}}#component--toolTip .component--content .toolTips .toolTip .word-content,#component--toolTip .component--content .toolTips .toolTip .line-content{opacity:0}#component--toolTip .component--content .toolTips .toolTip.active .word-content{transform:translateZ(0)!important;transition:1s .5s cubic-bezier(.34,1.56,.64,1);opacity:1}#component--toolTip .component--content .toolTips .toolTip.active .line-content{transform:translateZ(0)!important;transition:1s calc(.5s + var(--delay)) cubic-bezier(.34,1.56,.64,1);opacity:1}#component--toolTip .component--content .toolTips .toolTip.active .toolTip-illustration img{opacity:1;transition-delay:.5s!important}#component--toolTip .component--content .toolTips .toolTip.leave .word-content{transform:translate3d(0,-20px,0)!important;transition:1s 0s cubic-bezier(.34,1.56,.64,1);opacity:0}#component--toolTip .component--content .toolTips .toolTip.leave .line-content{transform:translate3d(0,-110%,0)!important;transition:1s var(--delay) cubic-bezier(.34,1.56,.64,1);opacity:0}#component--toolTip .component--content .toolTips .toolTip.leave .toolTip-illustration img{opacity:0;transition-delay:0s!important}#component--toolTip .component--content .toolTips .btn{position:relative;color:#fff;border-radius:18px;filter:drop-shadow(0px 5px 3px rgba(17,24,55,.21));margin-top:48px;pointer-events:auto;transition:transform .8s .8s cubic-bezier(.34,1.56,.64,1),opacity .6s .8s;transform:translate3d(0,20px,0);opacity:0}@media (max-width: 812px){#component--toolTip .component--content .toolTips .btn{margin-top:96px}}#component--toolTip .component--content .toolTips .btn-container{transition:transform .2s cubic-bezier(0,.51,.58,.99)}#component--toolTip .component--content .toolTips .btn-container p span{transition:.8s cubic-bezier(.34,1.56,.64,1);display:inline-block;transition-delay:.3s}#component--toolTip .component--content .toolTips .btn-container p:nth-child(2){position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}#component--toolTip .component--content .toolTips .btn-container p:nth-child(2) span{transform:translate3d(0,10px,0);opacity:0;transition-delay:0s}#component--toolTip .component--content .toolTips .btn.end p:nth-child(1) span{opacity:0;transition-delay:0s;transform:translate3d(0,-10px,0)}#component--toolTip .component--content .toolTips .btn.end p:nth-child(2) span{opacity:1;transform:translateZ(0);transition-delay:.3s}#component--toolTip .component--content .toolTips-steps{display:inherit;margin-top:24px}#component--toolTip .component--content .toolTips-steps-indicator{height:6px;width:6px;padding:8px}@media (hover: hover){#component--toolTip .component--content .toolTips-steps-indicator:hover .indicator{transform:scale(1.5)}}#component--toolTip .component--content .toolTips-steps-indicator .indicator{position:absolute;height:6px;width:6px;border-radius:100%;background:#09b1f8;opacity:.2;pointer-events:none;transition:cubic-bezier(.34,1.56,.64,1) .4s;display:inline-block}#component--toolTip .component--content .toolTips-steps-indicator.active .indicator,#component--toolTip .component--content .toolTips-steps-indicator.was-active .indicator{opacity:1}.is-mobile .toolTip-illustration{height:100px!important;width:200px!important}.is-mobile .toolTip .toolTip-illustration img:first-child{display:none!important}.is-mobile .toolTip .toolTip-illustration img:nth-child(2){display:block!important}.onboarding,.onboarding .component--content{z-index:1}.onboarding .trackEditor-btn:before,.onboarding .cameraSpin-btn:before,.onboarding .switch:before,.onboarding .player-btn:before{opacity:.5!important}.animate .trackEditor-btn:before,.animate .cameraSpin-btn:before,.animate .switch:before,.animate .player-btn:before{opacity:0!important;transition:opacity .4s}#component--trackEditor{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:flex-end;position:relative}@media (max-width: 812px){#component--trackEditor{flex-wrap:nowrap;position:absolute;left:0px;top:-356px;padding:0 20px 24px;width:100%;height:376px;overflow-x:auto;pointer-events:auto}}#component--trackEditor.animated .trackEditor-btn-wrapper{transform:translateY(0)}@media (max-width: 812px){#component--trackEditor.animated .trackEditor-btn-wrapper{opacity:1}}#trackEditor-toolTip{top:70px;left:0;right:0;margin:0 auto}.trackEditor-btn-wrapper{position:relative;transform:translateY(130px);transition:cubic-bezier(.34,1.56,.64,1) .5s}.trackEditor-btn-wrapper.active .trackEditor-btn-child-length{transform:translateZ(0);opacity:1;pointer-events:auto}.trackEditor-btn-wrapper.active .trackEditor-btn-indicator:before{opacity:1}@media (max-width: 812px){.trackEditor-btn-wrapper{transform:translateY(20px);opacity:0}}.trackEditor-btn{display:flex;pointer-events:auto;height:64px;width:64px;align-items:center;justify-content:center;margin-left:4px;margin-right:4px;margin-top:16px;position:relative;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));z-index:5}.trackEditor-btn:before{content:"";width:102%;height:110%;top:-1%;left:-1%;position:absolute;-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);z-index:10;opacity:0}@media (max-width: 812px){.trackEditor-btn:before{border-radius:12px;-webkit-clip-path:none;clip-path:none;height:111%}}.trackEditor-btn[has-children]:before{top:-2%;height:112%}@media (max-width: 812px){.trackEditor-btn{height:50px;width:50px}}@media (hover: hover){.trackEditor-btn:hover .trackEditor-btn-container{transform:translateY(1px)}.trackEditor-btn:hover .trackEditor-btn-container:after{opacity:1}}.trackEditor-btn .trackEditor-btn-background{position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;bottom:1px}.trackEditor-btn .trackEditor-btn-background:before,.trackEditor-btn .trackEditor-btn-background:after{content:"";position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;left:0;bottom:0;box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}@media (max-width: 812px){.trackEditor-btn .trackEditor-btn-background:before,.trackEditor-btn .trackEditor-btn-background:after{border-radius:12px}}.trackEditor-btn .trackEditor-btn-background:after{box-shadow:0 5px #898be6;opacity:0}.trackEditor-btn .trackEditor-btn-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;transition:transform .2s cubic-bezier(0,.51,.58,.99);z-index:1}.trackEditor-btn .trackEditor-btn-container:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}@media (max-width: 812px){.trackEditor-btn .trackEditor-btn-container:before{-webkit-clip-path:none;clip-path:none;border-radius:12px}}.trackEditor-btn .trackEditor-btn-container:after{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:inset 0 -2px 20px #78d0ff;opacity:0;transition:opacity .5s}@media (max-width: 812px){.trackEditor-btn .trackEditor-btn-container:after{-webkit-clip-path:none;clip-path:none;border-radius:12px}}.trackEditor-btn .trackEditor-btn-container.pressed{transform:translateY(4px)}.trackEditor-btn-indicator{width:10px;height:10px;display:inline-block;position:absolute;bottom:5px;left:50%;transform:translate(-50%);border-radius:100%;border:2px solid #91c5e8;z-index:1}.trackEditor-btn-indicator:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;border-radius:100%;background:linear-gradient(180deg,#86ff26 0%,#22b31f 100%);opacity:0;transition:opacity .3s ease-out}@media (max-width: 812px){.trackEditor-btn-indicator{height:8px;width:8px}}.trackEditor-btn-size-info{position:absolute;z-index:2;bottom:2px;color:#424242;pointer-events:none;font-family:fredokasemibold,sans-serif;font-size:12px}.trackEditor-btn img{height:36px;width:auto;margin-bottom:12px;z-index:1;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:translateZ(0);transition:opacity .5s}@media (min-width: 812px){.trackEditor-btn img.wiggle-animation{-webkit-animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards;animation:wiggle-animation 1.6s cubic-bezier(0,.36,.55,1) forwards}}@media (max-width: 812px){.trackEditor-btn img{height:25px}}.trackEditor-btn img.trackEditor-btn-img-disabled,.trackEditor-btn img.trackEditor-btn-img-disabled-night{position:absolute;opacity:0}.trackEditor-btn img.colorPalettes{margin-bottom:12px}.trackEditor-btn canvas{z-index:1;transition:opacity .5s;margin-bottom:12px}#trackEditor-undo-btn img,#trackEditor-deleteTrack-btn img,[track-piece-type=down] img,[track-piece-type=up] img{margin-bottom:0;width:36px;height:auto}@media (max-width: 812px){#trackEditor-undo-btn img,#trackEditor-deleteTrack-btn img,[track-piece-type=down] img,[track-piece-type=up] img{width:25px}}#trackEditor-undo-btn canvas,#trackEditor-deleteTrack-btn canvas,[track-piece-type=down] canvas,[track-piece-type=up] canvas{margin-bottom:0}.trackEditor-btn-child{display:flex;justify-content:center;align-items:center;border-radius:2px;padding:8px 16px;transition:opacity .2s;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);transition:transform .2s cubic-bezier(0,.51,.58,.99);box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}.trackEditor-btn-child.pressed{transform:translateY(2px)}.trackEditor-btn-img{width:100%;height:100%;pointer-events:none}.trackEditor-btn-img.colorPalette{height:38px;margin-bottom:0;border:2px solid transparent;border-radius:8px;padding:4px;transition:border-color .5s}.trackEditor-btn-img.colorPalette.isActive{border-color:#09b1f8}.trackEditor-btn-disabled{pointer-events:none;opacity:1}.trackEditor-btn-disabled .trackEditor-btn-child-container img{opacity:0}.trackEditor-btn-disabled canvas{opacity:0}.trackEditor-btn-disabled .trackEditor-btn-img-disabled{opacity:1!important}.trackEditor-btn-child-wrapper{display:flex;flex-direction:column-reverse;position:relative;top:4px}.trackEditor-btn-child-wrapper[track-piece-type=special] img{margin-bottom:0}.trackEditor-btn-child-length{display:flex;height:64px;width:64px;align-items:center;justify-content:center;margin-left:4px;margin-right:4px;margin-top:10px;position:relative;transition:cubic-bezier(.41,0,0,1) .6s;transform:translate3d(0,var(--translate-y),0);filter:none;pointer-events:none}.trackEditor-btn-child-length:before{display:none}@media (max-width: 812px){.trackEditor-btn-child-length{height:50px;width:50px}}@media (hover: hover){.trackEditor-btn-child-length:hover .trackEditor-btn-child-container{transform:translateY(1px)}.trackEditor-btn-child-length:hover .trackEditor-btn-child-container:after{opacity:1}}.trackEditor-btn-child-length .trackEditor-btn-child-background{position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;bottom:1px}.trackEditor-btn-child-length .trackEditor-btn-child-background:before,.trackEditor-btn-child-length .trackEditor-btn-child-background:after{content:"";position:absolute;width:100%;height:100%;border-radius:18px;pointer-events:none;left:0;bottom:0;box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}@media (max-width: 812px){.trackEditor-btn-child-length .trackEditor-btn-child-background:before,.trackEditor-btn-child-length .trackEditor-btn-child-background:after{border-radius:12px}}.trackEditor-btn-child-length .trackEditor-btn-child-background:after{box-shadow:0 5px #898be6;opacity:0}.trackEditor-btn-child-length .trackEditor-btn-child-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;transition:transform .2s cubic-bezier(0,.51,.58,.99);z-index:1}.trackEditor-btn-child-length .trackEditor-btn-child-container:before{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:0 5px #91c5e8,inset 0 -2px 10px #78cfff99}@media (max-width: 812px){.trackEditor-btn-child-length .trackEditor-btn-child-container:before{-webkit-clip-path:none;clip-path:none;border-radius:12px}}.trackEditor-btn-child-length .trackEditor-btn-child-container:after{content:"";position:absolute;height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);-webkit-clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);clip-path:polygon(100% 50%,100% 56.6%,100% 59.3%,100% 61.4%,99.9% 63.2%,99.9% 64.8%,99.9% 66.2%,99.8% 67.5%,99.8% 68.7%,99.7% 69.8%,99.6% 70.8%,99.5% 71.8%,99.5% 72.8%,99.4% 73.7%,99.3% 74.6%,99.1% 75.4%,99% 76.3%,98.9% 77%,98.8% 77.8%,98.6% 78.5%,98.5% 79.2%,98.3% 79.9%,98.1% 80.6%,98% 81.3%,97.8% 81.9%,97.6% 82.5%,97.4% 83.1%,97.2% 83.7%,97% 84.3%,96.8% 84.8%,96.5% 85.4%,96.3% 85.9%,96% 86.4%,95.8% 86.9%,95.5% 87.4%,95.3% 87.9%,95% 88.3%,94.7% 88.8%,94.4% 89.2%,94.1% 89.7%,93.8% 90.1%,93.4% 90.5%,93.1% 90.9%,92.8% 91.3%,92.4% 91.7%,92% 92%,91.7% 92.4%,91.3% 92.8%,90.9% 93.1%,90.5% 93.4%,90.1% 93.8%,89.7% 94.1%,89.2% 94.4%,88.8% 94.7%,88.3% 95%,87.9% 95.3%,87.4% 95.5%,86.9% 95.8%,86.4% 96%,85.9% 96.3%,85.4% 96.5%,84.8% 96.8%,84.3% 97%,83.7% 97.2%,83.1% 97.4%,82.5% 97.6%,81.9% 97.8%,81.3% 98%,80.6% 98.1%,79.9% 98.3%,79.2% 98.5%,78.5% 98.6%,77.8% 98.8%,77% 98.9%,76.3% 99%,75.4% 99.1%,74.6% 99.3%,73.7% 99.4%,72.8% 99.5%,71.8% 99.5%,70.8% 99.6%,69.8% 99.7%,68.7% 99.8%,67.5% 99.8%,66.2% 99.9%,64.8% 99.9%,63.2% 99.9%,61.4% 100%,59.3% 100%,56.6% 100%,50% 100%,43.4% 100%,40.7% 100%,38.6% 100%,36.8% 99.9%,35.2% 99.9%,33.8% 99.9%,32.5% 99.8%,31.3% 99.8%,30.2% 99.7%,29.2% 99.6%,28.2% 99.5%,27.2% 99.5%,26.3% 99.4%,25.4% 99.3%,24.6% 99.1%,23.7% 99%,23% 98.9%,22.2% 98.8%,21.5% 98.6%,20.8% 98.5%,20.1% 98.3%,19.4% 98.1%,18.7% 98%,18.1% 97.8%,17.5% 97.6%,16.9% 97.4%,16.3% 97.2%,15.7% 97%,15.2% 96.8%,14.6% 96.5%,14.1% 96.3%,13.6% 96%,13.1% 95.8%,12.6% 95.5%,12.1% 95.3%,11.7% 95%,11.2% 94.7%,10.8% 94.4%,10.3% 94.1%,9.9% 93.8%,9.5% 93.4%,9.1% 93.1%,8.7% 92.8%,8.3% 92.4%,8% 92%,7.6% 91.7%,7.2% 91.3%,6.9% 90.9%,6.6% 90.5%,6.2% 90.1%,5.9% 89.7%,5.6% 89.2%,5.3% 88.8%,5% 88.3%,4.7% 87.9%,4.5% 87.4%,4.2% 86.9%,4% 86.4%,3.7% 85.9%,3.5% 85.4%,3.2% 84.8%,3% 84.3%,2.8% 83.7%,2.6% 83.1%,2.4% 82.5%,2.2% 81.9%,2% 81.3%,1.9% 80.6%,1.7% 79.9%,1.5% 79.2%,1.4% 78.5%,1.2% 77.8%,1.1% 77%,1% 76.3%,.9% 75.4%,.7% 74.6%,.6% 73.7%,.5% 72.8%,.5% 71.8%,.4% 70.8%,.3% 69.8%,.2% 68.7%,.2% 67.5%,.1% 66.2%,.1% 64.8%,.1% 63.2%,0% 61.4%,0% 59.3%,0% 56.6%,0% 50%,0% 43.4%,0% 40.7%,0% 38.6%,.1% 36.8%,.1% 35.2%,.1% 33.8%,.2% 32.5%,.2% 31.3%,.3% 30.2%,.4% 29.2%,.5% 28.2%,.5% 27.2%,.6% 26.3%,.7% 25.4%,.9% 24.6%,1% 23.7%,1.1% 23%,1.2% 22.2%,1.4% 21.5%,1.5% 20.8%,1.7% 20.1%,1.9% 19.4%,2% 18.7%,2.2% 18.1%,2.4% 17.5%,2.6% 16.9%,2.8% 16.3%,3% 15.7%,3.2% 15.2%,3.5% 14.6%,3.7% 14.1%,4% 13.6%,4.2% 13.1%,4.5% 12.6%,4.7% 12.1%,5% 11.7%,5.3% 11.2%,5.6% 10.8%,5.9% 10.3%,6.2% 9.9%,6.6% 9.5%,6.9% 9.1%,7.2% 8.7%,7.6% 8.3%,8% 8%,8.3% 7.6%,8.7% 7.2%,9.1% 6.9%,9.5% 6.6%,9.9% 6.2%,10.3% 5.9%,10.8% 5.6%,11.2% 5.3%,11.7% 5%,12.1% 4.7%,12.6% 4.5%,13.1% 4.2%,13.6% 4%,14.1% 3.7%,14.6% 3.5%,15.2% 3.2%,15.7% 3%,16.3% 2.8%,16.9% 2.6%,17.5% 2.4%,18.1% 2.2%,18.7% 2%,19.4% 1.9%,20.1% 1.7%,20.8% 1.5%,21.5% 1.4%,22.2% 1.2%,23% 1.1%,23.7% 1%,24.6% .9%,25.4% .7%,26.3% .6%,27.2% .5%,28.2% .5%,29.2% .4%,30.2% .3%,31.3% .2%,32.5% .2%,33.8% .1%,35.2% .1%,36.8% .1%,38.6% 0%,40.7% 0%,43.4% 0%,50% 0%,56.6% 0%,59.3% 0%,61.4% 0%,63.2% .1%,64.8% .1%,66.2% .1%,67.5% .2%,68.7% .2%,69.8% .3%,70.8% .4%,71.8% .5%,72.8% .5%,73.7% .6%,74.6% .7%,75.4% .9%,76.3% 1%,77% 1.1%,77.8% 1.2%,78.5% 1.4%,79.2% 1.5%,79.9% 1.7%,80.6% 1.9%,81.3% 2%,81.9% 2.2%,82.5% 2.4%,83.1% 2.6%,83.7% 2.8%,84.3% 3%,84.8% 3.2%,85.4% 3.5%,85.9% 3.7%,86.4% 4%,86.9% 4.2%,87.4% 4.5%,87.9% 4.7%,88.3% 5%,88.8% 5.3%,89.2% 5.6%,89.7% 5.9%,90.1% 6.2%,90.5% 6.6%,90.9% 6.9%,91.3% 7.2%,91.7% 7.6%,92% 8%,92.4% 8.3%,92.8% 8.7%,93.1% 9.1%,93.4% 9.5%,93.8% 9.9%,94.1% 10.3%,94.4% 10.8%,94.7% 11.2%,95% 11.7%,95.3% 12.1%,95.5% 12.6%,95.8% 13.1%,96% 13.6%,96.3% 14.1%,96.5% 14.6%,96.8% 15.2%,97% 15.7%,97.2% 16.3%,97.4% 16.9%,97.6% 17.5%,97.8% 18.1%,98% 18.7%,98.1% 19.4%,98.3% 20.1%,98.5% 20.8%,98.6% 21.5%,98.8% 22.2%,98.9% 23%,99% 23.7%,99.1% 24.6%,99.3% 25.4%,99.4% 26.3%,99.5% 27.2%,99.5% 28.2%,99.6% 29.2%,99.7% 30.2%,99.8% 31.3%,99.8% 32.5%,99.9% 33.8%,99.9% 35.2%,99.9% 36.8%,100% 38.6%,100% 40.7%,100% 43.4%);box-shadow:inset 0 -2px 20px #78d0ff;opacity:0;transition:opacity .5s}@media (max-width: 812px){.trackEditor-btn-child-length .trackEditor-btn-child-container:after{-webkit-clip-path:none;clip-path:none;border-radius:12px}}.trackEditor-btn-child-length .trackEditor-btn-child-container.pressed{transform:translateY(4px)}.trackEditor-btn-child-length img{height:36px;width:auto;z-index:1;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:translateZ(0);transition:opacity .5s}.trackEditor-btn-child-length img[data-sprite-animated=true]{margin-bottom:0}@media (max-width: 812px){.trackEditor-btn-child-length img{height:25px}}.trackEditor-btn-child-length canvas{margin-bottom:0}#component--snapshot{width:100%;height:100%;z-index:1;position:absolute}#component--snapshot .component--content{height:100%;width:100%;position:absolute;pointer-events:auto}#component--snapshot .component--content .snapshot-background{position:absolute;height:100%;width:100%;pointer-events:auto;background:rgba(253,156,14,.75);transition:opacity .5s;opacity:0;pointer-events:none}#component--snapshot .component--content .snapshot-flash{position:absolute;height:100%;width:100%;background:white;opacity:1;transition:ease-in opacity .4s 1s;pointer-events:none}#component--snapshot .component--content .snapshot-picture-wrapper{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:500px;aspect-ratio:.84375}@media (max-width: 560px){#component--snapshot .component--content .snapshot-picture-wrapper{aspect-ratio:.8}}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-btn{font-size:18px}@media (max-width: 560px){#component--snapshot .component--content .snapshot-picture-wrapper{width:90%}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-btn{font-size:16px}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-btn-container{padding:16px 24px!important}}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;justify-content:center;transform:translateY(150%);border-radius:8px;background:linear-gradient(180deg,#ffffff 0%,#ecf3fa 76.04%,#e5eaf0 100%);box-shadow:0 48px 19px #11183703,0 27px 16px #11183705,0 12px 12px #1118370a,0 3px 7px #1118370d,0 0 #1118370d}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-canvas{position:absolute;width:450px;aspect-ratio:1;top:25px;border-radius:8px;overflow:hidden}@media (max-width: 560px){#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-canvas{width:90%}}@media (max-width: 380px){#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-canvas{top:12px}}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-canvas:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;z-index:1001;background:black;transition:opacity ease-in-out 2s 1s}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-buttons{position:absolute;bottom:38px}@media (max-width: 812px){#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-buttons{display:flex;align-items:flex-end;justify-content:space-around;width:80%}}@media (max-width: 560px){#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-buttons{bottom:28px}}#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-buttons #snapshot-download-btn{margin-left:20px}@media (max-width: 812px){#component--snapshot .component--content .snapshot-picture-wrapper .snapshot-wrapper .snapshot-buttons #snapshot-download-btn{margin-left:0;margin-top:16px}}#component--snapshot.animate .snapshot-background{opacity:1}#component--snapshot.animate .snapshot-flash{opacity:0;transition-delay:0s}#component--snapshot.animate .snapshot-picture-wrapper{pointer-events:auto}#component--snapshot.animate .snapshot-picture-wrapper .snapshot-wrapper{-webkit-animation:cubic-bezier(.51,0,.45,1) polaroid-in 1s .4s forwards;animation:cubic-bezier(.51,0,.45,1) polaroid-in 1s .4s forwards}#component--snapshot.animate .snapshot-picture-wrapper .snapshot-wrapper .snapshot-canvas:before{opacity:0}#component--snapshot.animate-out .snapshot-picture-wrapper .snapshot-wrapper{-webkit-animation:cubic-bezier(.5,-.41,.02,1) polaroid-out 1s 0s forwards;animation:cubic-bezier(.5,-.41,.02,1) polaroid-out 1s 0s forwards}@-webkit-keyframes polaroid-in{0%{transform:translateY(150%) rotate(10deg)}60%{transform:translateY(-15%) rotate(-4deg)}to{transform:translateY(0) rotate(0)}}@keyframes polaroid-in{0%{transform:translateY(150%) rotate(10deg)}60%{transform:translateY(-15%) rotate(-4deg)}to{transform:translateY(0) rotate(0)}}@-webkit-keyframes polaroid-out{0%{transform:translateY(0)}to{transform:translateY(-190%) rotate(-10deg)}}@keyframes polaroid-out{0%{transform:translateY(0)}to{transform:translateY(-190%) rotate(-10deg)}}.night-time .switch-background:before,.night-time .trackEditor-btn-background:before,.night-time .trackEditor-btn-child-background:before,.night-time .cameraSpin-btn-background:before{opacity:0!important}.night-time .switch-background:after,.night-time .trackEditor-btn-background:after,.night-time .trackEditor-btn-child-background:after,.night-time .cameraSpin-btn-background:after{opacity:1!important}.night-time .switch-container:before,.night-time .trackEditor-btn-container:before,.night-time .trackEditor-btn-child-container:before,.night-time .cameraSpin-btn-container:before{background:linear-gradient(180deg,#ffffff 0%,#d8d9ff 100%)!important;box-shadow:inset 0 -2px 10px #7886ff99!important}.night-time .switch-container:after,.night-time .trackEditor-btn-container:after,.night-time .trackEditor-btn-child-container:after,.night-time .cameraSpin-btn-container:after{background:linear-gradient(180deg,#ffffff 0%,#d8d9ff 100%)!important;box-shadow:inset 0 -2px 20px #7886ff99!important}.night-time .switch-input:checked+.switch-label .switch-first-mode svg path{fill:#a3a8ed!important}.night-time .switch-mode .switch-label .switch-second-mode svg path{fill:#a3a8ed}.night-time .trackEditor-btn-disabled .trackEditor-btn-img-disabled{opacity:0}.night-time .trackEditor-btn-disabled .trackEditor-btn-img-disabled-night{opacity:1}.night-time .component--settings .component-wrapper,.night-time .component--popup .component-wrapper,.night-time #component--confirmDelete .component-wrapper,.night-time .snapshot-wrapper,.night-time .about--sections,.night-time .toolTips{background:linear-gradient(180deg,#ffffff 0%,#efebfc 85.68%,#ddd7f0 100%)!important}.night-time #preloader-start--copy{color:#fff;text-shadow:0px 3px 4px #36363a}.night-time #preloader-bar{background:linear-gradient(180deg,#ffffff 0%,#d8d9ff 100%);box-shadow:0 5px #898be6,inset 0 -2px 10px #7886ff99}.night-time #preloader-bar--background{background:#c5caff;box-shadow:inset 0 2px 1px #9b9dff}.switch-background:after,.trackEditor-btn-background:after,.trackEditor-btn-child-background:after,.cameraSpin-btn-background:after{transition:opacity .3s ease-out}.switch-container:before,.trackEditor-btn-container:before,.trackEditor-btn-child-container:before,.cameraSpin-btn-container:before{transition:background .3s ease-out,opacity .3s ease-out}.switch-container:after,.trackEditor-btn-container:after,.trackEditor-btn-child-container:after,.cameraSpin-btn-container:after{transition:background .3s ease-out,opacity .3s ease-out}.switch-input:checked+.switch-label .switch-first-mode svg path{transition:fill .3s ease-out}.switch-mode .switch-label .switch-second-mode svg path{transition:fill .3s ease-out}.component--settings .component-wrapper,.component--popup .component-wrapper,#component--confirmDelete .component-wrapper,.snapshot-wrapper,.about--sections{transition:background .3s ease-out}.is-mobile #page--about,.is-mobile .page--content{overflow-y:scroll}#page--about{z-index:1;pointer-events:auto;overflow:none}#page--about .page--content{display:flex;flex-direction:column;justify-content:center;position:relative;left:0;right:0;margin:0 auto;padding:40px;transition:transform .4s 1s ease-in,opacity .5s;opacity:0;transform:translate3d(0,50px,0);min-height:100vh}#page--about .page--content.animate{transition:opacity .6s,transform .6s cubic-bezier(.34,1.56,.64,1);opacity:1;transform:translateZ(0)}@media (max-width: 812px){#page--about .page--content{padding:20px}}#page--about a{position:relative;display:inline-block;transition:.2s ease-out}#page--about a:after{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:3px;border-radius:10px;background:#36363a;transform:scaleX(0);transform-origin:left;transition:.2s ease-out}@media (hover: hover){#page--about a:hover{color:var(--color)}#page--about a:hover:after{background:var(--color)}}#about-close-btn{transition:transform .5s .3s cubic-bezier(.34,1.56,.64,1);transform:scale(0)}@media (hover: hover){#about-close-btn:hover #about-close-btn-container{transform:translateY(1px)}}.about--decoration{height:100%;width:100%;position:absolute;top:0;left:0;padding:5rem;border-radius:16px;overflow:hidden;z-index:0}@media (max-width: 812px){.about--decoration{padding:20px}}.about--decoration-img{position:absolute;z-index:1}.about--decoration-img img{position:relative;width:100%;user-drag:none;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;-webkit-user-drag:none;transform:scale(0);transition:transform cubic-bezier(.34,1.56,.64,1) .5s}.about--decoration-img img.holded{transform:scale(1.05)!important}.about--decoration-img:nth-child(1){width:24%;max-width:300px;right:-2%;top:28%}@media (max-width: 812px){.about--decoration-img:nth-child(1){top:16%;width:140px}}.about--decoration-img:nth-child(2){width:9%;max-width:112px;left:15%;top:60%}@media (max-width: 812px){.about--decoration-img:nth-child(2){width:55px;left:85%;top:43%}}.about--decoration-img:nth-child(3){width:8.5%;max-width:105px;left:17%;top:66%}@media (max-width: 812px){.about--decoration-img:nth-child(3){width:55px;left:75%;top:49%}}.about--decoration-img:nth-child(4){width:9%;max-width:112px;left:25%;top:62%}@media (max-width: 812px){.about--decoration-img:nth-child(4){width:55px;left:90%;top:45%}}.about--decoration-img:nth-child(5){width:16%;max-width:200px;left:5%;top:2%}@media (max-width: 812px){.about--decoration-img:nth-child(5){top:-2%;width:120px;left:20%}}.about--decoration-img:nth-child(6){width:11.2%;max-width:140px;right:25%;top:4%}@media (max-width: 812px){.about--decoration-img:nth-child(6){right:20%;top:9%;width:80px}}.about--decoration-img:nth-child(7){width:14%;max-width:174px;left:25%;bottom:17%}@media (max-width: 812px){.about--decoration-img:nth-child(7){display:none}}.about--decoration-img:nth-child(8){width:10.4%;max-width:130px;left:15%;top:22%}@media (max-width: 812px){.about--decoration-img:nth-child(8){width:60px;left:-12%}}.about--decoration-img:nth-child(9){width:20%;max-width:250px;left:70%;bottom:35%}@media (max-width: 812px){.about--decoration-img:nth-child(9){bottom:36%;left:50%;width:110px}}.about--decoration-img:nth-child(10){width:8.5%;max-width:105px;left:11%;bottom:12%}@media (max-width: 812px){.about--decoration-img:nth-child(10){display:none}}.about--decoration-img:nth-child(11){width:8.5%;max-width:105px;left:9%;bottom:17%}@media (max-width: 812px){.about--decoration-img:nth-child(11){display:none}}.about--sections{background:linear-gradient(180deg,#ffffff 0%,#ecf3fa 76.04%,#e5eaf0 100%);filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));border-radius:16px;padding:5rem}.about--sections .word-content{line-height:1}.about--sections .char{transition:color cubic-bezier(.34,1.56,.64,1) 1s,transform cubic-bezier(.34,1.56,.64,1) .5s;pointer-events:auto;transition-delay:.5s}.about--sections .char:hover{transition-delay:0s;transition:color cubic-bezier(.34,1.56,.64,1) 0s,transform cubic-bezier(.34,1.56,.64,1) .5s;color:var(--hover-color)!important;transform:scale(1.05) rotate(var(--hover-rotate))}@media (max-width: 560px){.about--sections{padding:2.5rem;overflow:hidden;position:relative}}.about--summary-title{padding:0;margin:0;max-width:88rem;margin:20vh auto 0;font-size:clamp(42px,6.8vw,64px);text-transform:uppercase;text-align:center;line-height:.9}@media (max-width: 812px){.about--summary-title{max-width:55vw;margin:7rem 0 0;text-align:left;font-size:clamp(36px,7vw,64px)}}@media (max-width: 460px){.about--summary-title{max-width:58vw}}@media (max-width: 446px){.about--summary-title{max-width:inherit}}.about--section-wrapper:not(:first-child){margin:10rem 0rem 20rem}@media (max-width: 812px){.about--section-wrapper:not(:first-child){margin:5rem 0}}.about--section-wrapper:last-child{margin:5rem 0rem 3rem}.about--section-wrapper .about--section{display:flex;justify-content:center;margin-top:10rem}@media (max-width: 812px){.about--section-wrapper .about--section{flex-direction:column;margin-top:0}.about--section-wrapper .about--section:not(:first-child){margin-top:5rem}}.about--section-wrapper h3{font-size:4.4rem;text-transform:uppercase;text-align:center;z-index:1;position:relative;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;left:50%;transform:translate(-50%)}@media (max-width: 812px){.about--section-wrapper h3{margin-bottom:5rem;left:0;transform:translate(0)}}.about--section-wrapper h4,.about--section-wrapper p{width:45%;max-width:490px;z-index:1;position:relative;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}@media (max-width: 812px){.about--section-wrapper h4,.about--section-wrapper p{width:100%}}.about--section-wrapper h4{font-family:karlasemibold,sans-serif;font-size:2.8rem;line-height:1.2}@media (max-width: 812px){.about--section-wrapper h4{font-size:2.2rem;margin-bottom:2rem}}.about--section-wrapper p{font-size:2rem;margin-left:50px}@media (max-width: 812px){.about--section-wrapper p{margin-left:0;font-size:1.6rem}}.about--section-wrapper a{position:relative;z-index:1}.is-active h2 .char-content{-webkit-animation:scale-pop-animation 1s var(--delay) forwards!important;animation:scale-pop-animation 1s var(--delay) forwards!important}#page--about .is-visible .char-content{-webkit-animation:scale-pop-animation 1s calc(.2s + var(--delay)) forwards!important;animation:scale-pop-animation 1s calc(.2s + var(--delay)) forwards!important}#page--about .is-visible .line-content{-webkit-animation:translate-animation .8s var(--delay) cubic-bezier(.34,1.56,.64,1) forwards!important;animation:translate-animation .8s var(--delay) cubic-bezier(.34,1.56,.64,1) forwards!important}#page--about .is-visible a:after{-webkit-animation:about-line-animation .5s var(--delay) cubic-bezier(.66,0,.35,1.01) forwards;animation:about-line-animation .5s var(--delay) cubic-bezier(.66,0,.35,1.01) forwards}.animate #about-close-btn,.animate .about--decoration-img img{transform:scale(1)}@-webkit-keyframes translate-animation{to{transform:translateZ(0);opacity:1}}@keyframes translate-animation{to{transform:translateZ(0);opacity:1}}@-webkit-keyframes scale-pop-animation{0%{transform:translate3d(0,20px,0) scale(0)}30%{transform:translate3d(0,-5px,0) scale(1.05) rotate(var(--hover-rotate));color:var(--hover-color)}80%{transform:scale(1)}to{transform:scale(1)}}@-webkit-keyframes pop-animation{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes pop-animation{0%{transform:scale(0)}to{transform:scale(1)}}.about--logo{display:flex;justify-content:center;margin-top:10vh}@media (max-width: 812px){.about--logo{margin-top:5rem}}.about--logo.is-visible .about--logo-animation{-webkit-animation:.7s .3s pop-animation cubic-bezier(.34,1.56,.64,1) forwards;animation:.7s .3s pop-animation cubic-bezier(.34,1.56,.64,1) forwards}.about--logo .about--logo-animation{width:30%;height:auto;max-width:400px;transform:scale(0)}@media (max-width: 480px){.about--logo .about--logo-animation{width:60%}}@-webkit-keyframes about-line-animation{0%{transform:scaleX(0)}to{transform:scaleX(1)}}@keyframes about-line-animation{0%{transform:scaleX(0)}to{transform:scaleX(1)}}.is-mobile #page--gallery,.is-mobile .page--content{overflow-y:scroll}#page--gallery{z-index:1;pointer-events:auto;overflow:none}#page--gallery .page--content{position:relative;left:0;right:0;margin:0 auto;padding:40px;transition:transform .4s 1s ease-in,opacity .5s;opacity:0;transform:translate3d(0,50px,0);min-height:100vh}#page--gallery .page--content.animate{transition:opacity .6s,transform .6s cubic-bezier(.34,1.56,.64,1);opacity:1;transform:translateZ(0)}@media (max-width: 812px){#page--gallery .page--content{padding:20px}}#page--gallery .page--content .gallery--sections{background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21));border-radius:16px;padding:5rem;display:flex;flex-direction:column;align-items:center}#page--gallery .page--content .gallery--summary-title{padding:0;margin:0;max-width:88rem;margin:5vh auto 0;font-size:clamp(42px,6.8vw,64px);text-transform:uppercase;text-align:center;line-height:.9}@media (max-width: 812px){#page--gallery .page--content .gallery--summary-title{max-width:55vw;margin:7rem 0 0;text-align:left;font-size:clamp(36px,7vw,64px)}}@media (max-width: 460px){#page--gallery .page--content .gallery--summary-title{max-width:58vw}}@media (max-width: 446px){#page--gallery .page--content .gallery--summary-title{max-width:inherit}}#page--gallery .page--content .gallery--sub-title{text-align:center;margin-top:3rem}#page--gallery .page--content p{font-size:2rem}@media (max-width: 812px){#page--gallery .page--content p{font-size:1.6rem}}#page--gallery .page--content .gallery--wrapper{display:grid;grid-template-columns:repeat(3,1fr);grid-column-gap:10px;margin-top:10rem;max-width:1050px;width:100%}@media (max-width: 812px){#page--gallery .page--content .gallery--wrapper{grid-template-columns:repeat(2,1fr)}}#page--gallery .page--content .gallery--wrapper .gallery-container{position:relative;width:100%;max-width:300px;aspect-ratio:1;justify-self:center;margin-bottom:2rem}#page--gallery .page--content .gallery--wrapper .gallery-container .gallery-img{width:100%;height:100%;position:absolute;background:rgba(201,201,201,.306)}#page--gallery .page--content #gallery-close-btn{position:absolute;z-index:1;right:32px;top:32px;width:40px;height:40px;border-radius:10px;filter:drop-shadow(0px 5px 3px rgba(17,24,55,.21));transition:transform .5s .3s cubic-bezier(.34,1.56,.64,1)}@media (max-width: 812px){#page--gallery .page--content #gallery-close-btn{right:10px;top:10px;width:30px;height:30px}}@media (hover: hover){#page--gallery .page--content #gallery-close-btn:hover #gallery-close-btn-container{transform:translateY(1px)}}#page--gallery .page--content #gallery-close-btn-background{position:absolute;width:100%;height:100%;top:-1px;border-radius:10px;box-shadow:0 5px #720ca0;bottom:1px}#page--gallery .page--content #gallery-close-btn-container{position:absolute;width:100%;height:100%;top:0;border-radius:10px;background:linear-gradient(180deg,#db07fe 0%,#7211be 100%);box-shadow:inset 0 -2px 8px #f2a2ff99;display:flex;justify-content:center;align-items:center;transition:transform .2s cubic-bezier(0,.51,.58,.99)}#page--gallery .page--content #gallery-close-btn-container img{width:20px;height:auto}@media (max-width: 812px){#page--gallery .page--content #gallery-close-btn-container img{width:14px}}#page--home{pointer-events:none}#page--home .page--content{position:absolute;width:100%;height:100%;overflow:hidden}#page--preloader{pointer-events:auto;z-index:1}#page--preloader .page--content{position:absolute;width:90%;max-width:600px;top:55%;left:50%;transform:translate3d(-50%,-50%,0);display:flex;flex-direction:column;align-items:center;transition:opacity .7s ease-in-out;overflow:visible}@media (max-width: 812px){#page--preloader .page--content{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}}@media (max-width: 1000px){#page--preloader .page--content{max-width:480px}}@media (max-width: 812px){#page--preloader .page--content{max-width:400px}}@media (max-width: 560px){#page--preloader .page--content{max-width:360px}}#page--preloader .page--content.is-anime-out{opacity:0}#page--preloader .page--content .preloader-lottie{top:0}@media (max-width: 812px){#page--preloader .page--content .preloader-lottie{top:-40px;position:relative}}#page--preloader .page--content .preloader-lottie.wiggle-logo{-webkit-animation:1s wiggle-logo forwards;animation:1s wiggle-logo forwards}.preloader-lottie{z-index:1;aspect-ratio:1.58730159;width:100%}#preloader-bar{position:relative;width:70%;-webkit-animation:.8s fade-in cubic-bezier(.99,0,.4,1) forwards;animation:.8s fade-in cubic-bezier(.99,0,.4,1) forwards;z-index:1;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);box-shadow:0 6px #91c5e8,inset 0 -2px 10px #78cfff99;border-radius:142px;padding:16px;filter:drop-shadow(0px 10px 7px rgba(17,24,55,.21))}@media (max-width: 812px){#preloader-bar{padding:9px}}#preloader-bar.scale-out{-webkit-animation:.8s fade-out forwards;animation:.8s fade-out forwards}#preloader-bar--loader{position:absolute;top:18px;left:19px;width:calc(100% - 38px);height:10px;transform-origin:left;border-radius:10px;background:linear-gradient(180deg,#ffc806 0%,#eb7100 100%);box-shadow:0 2px #d36601,inset 0 -1px 8px #fff27899;z-index:1}@media (max-width: 812px){#preloader-bar--loader{height:5px;top:11px;left:12px;width:calc(100% - 24px)}}#preloader-bar--background{height:16px;width:100%;border-radius:10px;background:linear-gradient(180deg,#d5eaf8 0%,#cde7f8 100%);box-shadow:inset 0 2px #c2d7e6}@media (max-width: 812px){#preloader-bar--background{height:11px}}#preloader-bar--copy{text-align:center;margin:30px 0 0;color:#0158b4}#preloader-start{position:relative;bottom:110px;text-align:center;z-index:1}@media (max-width: 812px){#preloader-start{bottom:-50px}}#preloader-start .btn{transform:scale(0)}#preloader-start--copy{margin-top:40px;color:#0158b4;font-family:karlabold,sans-serif;font-size:20px}@media (max-width: 480px){#preloader-start--copy{font-size:16px}}#preloader-start--copy span{display:inline-block;opacity:0;transform:translateY(20px)}#preloader-start.is-active #preloader-start--btn{transition:.8s .9s cubic-bezier(.34,1.56,.64,1);transform:scale(1)}#preloader-start.is-active #preloader-start--copy span{transition:.8s .9s cubic-bezier(.66,0,.35,1.01);transform:translateY(0);opacity:1}#preloader-start.is-active #preloader-start--copy span:not(:first-child){transition-delay:1s}#preloader-clouds{position:fixed;height:100vh;width:100vw;pointer-events:none;background:#ffffff}#preloader-clouds.portrait .img-container{position:absolute;width:auto;height:100%;transform:scale(1.2)}#preloader-clouds.portrait .img-container:nth-child(1){bottom:-30%;left:-20%}#preloader-clouds.portrait .img-container:nth-child(2){left:-80%;top:-5%}#preloader-clouds.portrait .img-container:nth-child(3){top:-30%}#preloader-clouds.portrait .img-container:nth-child(4){left:0%;top:-30%}#preloader-clouds.portrait .img-container:nth-child(5){left:0%;top:20%}#preloader-clouds.portrait .img-container:nth-child(6){left:40%}#preloader-clouds.portrait .img-container img{width:auto;height:100%}#preloader-clouds.move .img-container:nth-child(1) img{transform:translateY(80%);transition-delay:0s}#preloader-clouds.move .img-container:nth-child(2) img{transform:translate(-70%);transition-delay:.1s}#preloader-clouds.move .img-container:nth-child(3) img{transform:translateY(-80%);transition-delay:.2s}#preloader-clouds.move .img-container:nth-child(4) img{transform:translate(90%,-80%);transition-delay:.3s}#preloader-clouds.move .img-container:nth-child(5) img{transform:translate(110%,100%);transition-delay:.4s}#preloader-clouds.move .img-container:nth-child(6) img{transform:translate(150%);transition-delay:.5s}#preloader-clouds .img-container{position:absolute;width:100%;transform:scale(2)}#preloader-clouds .img-container img{width:100%;height:100%;width:75%;transition:transform 3s}#preloader-clouds .img-container:nth-child(1){bottom:-30%;left:20%}#preloader-clouds .img-container:nth-child(2){left:-20%;top:-5%}#preloader-clouds .img-container:nth-child(3){top:-30%;left:-20%}#preloader-clouds .img-container:nth-child(4){left:60%;top:-30%}#preloader-clouds .img-container:nth-child(5){left:60%;top:20%}#preloader-clouds .img-container:nth-child(6){left:100%}@-webkit-keyframes fade-out{0%{transform:translateZ(0);opacity:1}to{transform:translate3d(0,50px,0);opacity:0}}@keyframes fade-out{0%{transform:translateZ(0);opacity:1}to{transform:translate3d(0,50px,0);opacity:0}}@-webkit-keyframes fade-in{0%{transform:translate3d(0,50px,0);opacity:0}to{transform:translateZ(0);opacity:1}}@keyframes fade-in{0%{transform:translate3d(0,50px,0);opacity:0}to{transform:translateZ(0);opacity:1}}@-webkit-keyframes wiggle-logo{0%{transform:translateY(0)}20%{transform:translateY(10px)}60%{transform:translateY(-90px)}to{transform:translateY(-70px)}}@keyframes wiggle-logo{0%{transform:translateY(0)}20%{transform:translateY(10px)}60%{transform:translateY(-90px)}to{transform:translateY(-70px)}}#page--privacyAndCookie{pointer-events:none}#page--privacyAndCookie .page--content{position:absolute;top:0;left:0;right:0;bottom:0;width:calc(100% - 80px);height:calc(100% - 80px);margin:auto;transition:transform .4s 1s ease-in,opacity .5s;opacity:0;transform:translate3d(0,50px,0);padding:5rem;border-radius:16px;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);pointer-events:auto;overflow:hidden}#page--privacyAndCookie .page--content.animate{transition:opacity .6s,transform .6s cubic-bezier(.34,1.56,.64,1);opacity:1;transform:translateZ(0)}@media (max-width: 812px){#page--privacyAndCookie .page--content{padding:20px}}#privacyAndCookie-close-btn{transition:transform .5s .3s cubic-bezier(.34,1.56,.64,1);transform:scale(1)}@media (hover: hover){#privacyAndCookie-close-btn:hover #privacyAndCookie-close-btn-container{transform:translateY(1px)}}#privacyAndCookie-headline{margin:40px auto 80px;font-size:clamp(42px,6vw,64px);text-align:left}.privacyAndCookie-list{width:100%;height:calc(100% - 40px);margin-top:40px;overflow:auto}#page--termsOfUse{pointer-events:none}#page--termsOfUse .page--content{position:absolute;top:0;left:0;right:0;bottom:0;width:calc(100% - 80px);height:calc(100% - 80px);margin:auto;transition:transform .4s 1s ease-in,opacity .5s;opacity:0;transform:translate3d(0,50px,0);padding:5rem;border-radius:16px;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%);pointer-events:auto;overflow:hidden}#page--termsOfUse .page--content.animate{transition:opacity .6s,transform .6s cubic-bezier(.34,1.56,.64,1);opacity:1;transform:translateZ(0)}@media (max-width: 812px){#page--termsOfUse .page--content{padding:20px}}#termsOfUse-close-btn{transition:transform .5s .3s cubic-bezier(.34,1.56,.64,1);transform:scale(1)}@media (hover: hover){#termsOfUse-close-btn:hover #termsOfUse-close-btn-container{transform:translateY(1px)}}#termsOfUse-headline{margin:40px auto 80px;font-size:clamp(42px,6vw,64px);text-align:left}.termsOfUse-list{width:100%;height:calc(100% - 40px);margin-top:40px;overflow:auto}.list-item{margin-bottom:40px;counter-reset:list-number}.list-item-headline{text-transform:capitalize;font-family:karlaregular;font-size:24px;font-size:clamp(20px,6vw,24px);margin-bottom:20px}.list-item-copy{text-transform:capitalize}.list-item-inner{display:flex;flex-direction:row;position:relative;width:calc(100% - 10px);margin:auto 0 auto auto}.list-item-inner .list-item-copy{width:calc(100% - 20px);margin:auto 0 auto auto}.list-item-inner:not(:last-child){margin-bottom:10px}.list-item a{color:#09b1f8;font-family:karlabold}.bulletStyle:before{content:"";position:absolute;top:9px;width:6px;height:6px;border-radius:50%;background:#36363a}.numberedStyle:before{counter-increment:list-number;content:counter(list-number);position:relative;top:0;margin-right:10px;margin-bottom:10px;width:35px;height:35px;display:inline-flex;align-items:center;justify-content:center;font-size:16px;background-color:#36363a;border-radius:50%;color:#fff}html #not-supported-container{position:fixed;top:0;left:0;right:0;bottom:0;margin:0;padding:0;border:0;overflow:hidden;-ms-scroll-chaining:none;overscroll-behavior:none;touch-action:none;display:none}html.not-supported #canvas,html.not-supported #ui{display:none}html.not-supported body,html.not-supported #not-supported-container{display:block;background:linear-gradient(180deg,#ffffff 0%,#d9efff 100%)}html.not-supported--device .not-supported--content#ns-device,html.not-supported--browser .not-supported--content#ns-browser,html.not-supported--webgl .not-supported--content#ns-webgl,html.not-supported--orientation .not-supported--content#ns-orientation{display:block;z-index:99999}html.not-supported--device .not-supported--content#ns-device h3,html.not-supported--browser .not-supported--content#ns-browser h3,html.not-supported--webgl .not-supported--content#ns-webgl h3,html.not-supported--orientation .not-supported--content#ns-orientation h3{font-size:4.8rem}@media (max-width: 812px){html.not-supported--device .not-supported--content#ns-device h3,html.not-supported--browser .not-supported--content#ns-browser h3,html.not-supported--webgl .not-supported--content#ns-webgl h3,html.not-supported--orientation .not-supported--content#ns-orientation h3{font-size:3.2rem}}html.not-supported--device .not-supported--content#ns-device h3 .char,html.not-supported--browser .not-supported--content#ns-browser h3 .char,html.not-supported--webgl .not-supported--content#ns-webgl h3 .char,html.not-supported--orientation .not-supported--content#ns-orientation h3 .char{transition:color .2s,transform cubic-bezier(.34,1.56,.64,1) .2s}html.not-supported--device .not-supported--content#ns-device h3 .char:hover,html.not-supported--browser .not-supported--content#ns-browser h3 .char:hover,html.not-supported--webgl .not-supported--content#ns-webgl h3 .char:hover,html.not-supported--orientation .not-supported--content#ns-orientation h3 .char:hover{color:var(--hover-color)!important;transform:scale(1.05) rotate(var(--hover-rotate))}html.not-supported--device .not-supported--content#ns-device h3 .char .char-content,html.not-supported--browser .not-supported--content#ns-browser h3 .char .char-content,html.not-supported--webgl .not-supported--content#ns-webgl h3 .char .char-content,html.not-supported--orientation .not-supported--content#ns-orientation h3 .char .char-content{-webkit-animation:scale-pop-animation 1s var(--delay) forwards!important;animation:scale-pop-animation 1s var(--delay) forwards!important}.not-supported--content{width:100%;text-align:center;display:none;position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}@keyframes scale-pop-animation{0%{transform:translate3d(0,20px,0) scale(0)}30%{transform:translate3d(0,-5px,0) scale(1.05) rotate(var(--hover-rotate));color:var(--hover-color)}80%{transform:scale(1)}to{transform:scale(1)}}\n'
}()
  , commonjsGlobal = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {}
  , runtime = {
    exports: {}
};
!function(e) {
    var t = function(e) {
        var t, i = Object.prototype, r = i.hasOwnProperty, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", o = n.asyncIterator || "@@asyncIterator", s = n.toStringTag || "@@toStringTag";
        function l(e, t, i) {
            return Object.defineProperty(e, t, {
                value: i,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }),
            e[t]
        }
        try {
            l({}, "")
        } catch (L) {
            l = function(e, t, i) {
                return e[t] = i
            }
        }
        function h(e, t, i, r) {
            var n = t && t.prototype instanceof g ? t : g
              , a = Object.create(n.prototype)
              , o = new P(r || []);
            return a._invoke = function(e, t, i) {
                var r = p;
                return function(n, a) {
                    if (r === d)
                        throw new Error("Generator is already running");
                    if (r === f) {
                        if ("throw" === n)
                            throw a;
                        return A()
                    }
                    for (i.method = n,
                    i.arg = a; ; ) {
                        var o = i.delegate;
                        if (o) {
                            var s = k(o, i);
                            if (s) {
                                if (s === m)
                                    continue;
                                return s
                            }
                        }
                        if ("next" === i.method)
                            i.sent = i._sent = i.arg;
                        else if ("throw" === i.method) {
                            if (r === p)
                                throw r = f,
                                i.arg;
                            i.dispatchException(i.arg)
                        } else
                            "return" === i.method && i.abrupt("return", i.arg);
                        r = d;
                        var l = c(e, t, i);
                        if ("normal" === l.type) {
                            if (r = i.done ? f : u,
                            l.arg === m)
                                continue;
                            return {
                                value: l.arg,
                                done: i.done
                            }
                        }
                        "throw" === l.type && (r = f,
                        i.method = "throw",
                        i.arg = l.arg)
                    }
                }
            }(e, i, o),
            a
        }
        function c(e, t, i) {
            try {
                return {
                    type: "normal",
                    arg: e.call(t, i)
                }
            } catch (L) {
                return {
                    type: "throw",
                    arg: L
                }
            }
        }
        e.wrap = h;
        var p = "suspendedStart"
          , u = "suspendedYield"
          , d = "executing"
          , f = "completed"
          , m = {};
        function g() {}
        function v() {}
        function y() {}
        var _ = {};
        l(_, a, (function() {
            return this
        }
        ));
        var b = Object.getPrototypeOf
          , x = b && b(b(C([])));
        x && x !== i && r.call(x, a) && (_ = x);
        var w = y.prototype = g.prototype = Object.create(_);
        function S(e) {
            ["next", "throw", "return"].forEach((function(t) {
                l(e, t, (function(e) {
                    return this._invoke(t, e)
                }
                ))
            }
            ))
        }
        function T(e, t) {
            function i(n, a, o, s) {
                var l = c(e[n], e, a);
                if ("throw" !== l.type) {
                    var h = l.arg
                      , p = h.value;
                    return p && "object" === _typeof2(p) && r.call(p, "__await") ? t.resolve(p.__await).then((function(e) {
                        i("next", e, o, s)
                    }
                    ), (function(e) {
                        i("throw", e, o, s)
                    }
                    )) : t.resolve(p).then((function(e) {
                        h.value = e,
                        o(h)
                    }
                    ), (function(e) {
                        return i("throw", e, o, s)
                    }
                    ))
                }
                s(l.arg)
            }
            var n;
            this._invoke = function(e, r) {
                function a() {
                    return new t((function(t, n) {
                        i(e, r, t, n)
                    }
                    ))
                }
                return n = n ? n.then(a, a) : a()
            }
        }
        function k(e, i) {
            var r = e.iterator[i.method];
            if (r === t) {
                if (i.delegate = null,
                "throw" === i.method) {
                    if (e.iterator.return && (i.method = "return",
                    i.arg = t,
                    k(e, i),
                    "throw" === i.method))
                        return m;
                    i.method = "throw",
                    i.arg = new TypeError("The iterator does not provide a 'throw' method")
                }
                return m
            }
            var n = c(r, e.iterator, i.arg);
            if ("throw" === n.type)
                return i.method = "throw",
                i.arg = n.arg,
                i.delegate = null,
                m;
            var a = n.arg;
            return a ? a.done ? (i[e.resultName] = a.value,
            i.next = e.nextLoc,
            "return" !== i.method && (i.method = "next",
            i.arg = t),
            i.delegate = null,
            m) : a : (i.method = "throw",
            i.arg = new TypeError("iterator result is not an object"),
            i.delegate = null,
            m)
        }
        function E(e) {
            var t = {
                tryLoc: e[0]
            };
            1 in e && (t.catchLoc = e[1]),
            2 in e && (t.finallyLoc = e[2],
            t.afterLoc = e[3]),
            this.tryEntries.push(t)
        }
        function M(e) {
            var t = e.completion || {};
            t.type = "normal",
            delete t.arg,
            e.completion = t
        }
        function P(e) {
            this.tryEntries = [{
                tryLoc: "root"
            }],
            e.forEach(E, this),
            this.reset(!0)
        }
        function C(e) {
            if (e) {
                var i = e[a];
                if (i)
                    return i.call(e);
                if ("function" == typeof e.next)
                    return e;
                if (!isNaN(e.length)) {
                    var n = -1
                      , o = function i() {
                        for (; ++n < e.length; )
                            if (r.call(e, n))
                                return i.value = e[n],
                                i.done = !1,
                                i;
                        return i.value = t,
                        i.done = !0,
                        i
                    };
                    return o.next = o
                }
            }
            return {
                next: A
            }
        }
        function A() {
            return {
                value: t,
                done: !0
            }
        }
        return v.prototype = y,
        l(w, "constructor", y),
        l(y, "constructor", v),
        v.displayName = l(y, s, "GeneratorFunction"),
        e.isGeneratorFunction = function(e) {
            var t = "function" == typeof e && e.constructor;
            return !!t && (t === v || "GeneratorFunction" === (t.displayName || t.name))
        }
        ,
        e.mark = function(e) {
            return Object.setPrototypeOf ? Object.setPrototypeOf(e, y) : (e.__proto__ = y,
            l(e, s, "GeneratorFunction")),
            e.prototype = Object.create(w),
            e
        }
        ,
        e.awrap = function(e) {
            return {
                __await: e
            }
        }
        ,
        S(T.prototype),
        l(T.prototype, o, (function() {
            return this
        }
        )),
        e.AsyncIterator = T,
        e.async = function(t, i, r, n, a) {
            void 0 === a && (a = Promise);
            var o = new T(h(t, i, r, n),a);
            return e.isGeneratorFunction(i) ? o : o.next().then((function(e) {
                return e.done ? e.value : o.next()
            }
            ))
        }
        ,
        S(w),
        l(w, s, "Generator"),
        l(w, a, (function() {
            return this
        }
        )),
        l(w, "toString", (function() {
            return "[object Generator]"
        }
        )),
        e.keys = function(e) {
            var t = [];
            for (var i in e)
                t.push(i);
            return t.reverse(),
            function i() {
                for (; t.length; ) {
                    var r = t.pop();
                    if (r in e)
                        return i.value = r,
                        i.done = !1,
                        i
                }
                return i.done = !0,
                i
            }
        }
        ,
        e.values = C,
        P.prototype = {
            constructor: P,
            reset: function(e) {
                if (this.prev = 0,
                this.next = 0,
                this.sent = this._sent = t,
                this.done = !1,
                this.delegate = null,
                this.method = "next",
                this.arg = t,
                this.tryEntries.forEach(M),
                !e)
                    for (var i in this)
                        "t" === i.charAt(0) && r.call(this, i) && !isNaN(+i.slice(1)) && (this[i] = t)
            },
            stop: function() {
                this.done = !0;
                var e = this.tryEntries[0].completion;
                if ("throw" === e.type)
                    throw e.arg;
                return this.rval
            },
            dispatchException: function(e) {
                if (this.done)
                    throw e;
                var i = this;
                function n(r, n) {
                    return s.type = "throw",
                    s.arg = e,
                    i.next = r,
                    n && (i.method = "next",
                    i.arg = t),
                    !!n
                }
                for (var a = this.tryEntries.length - 1; a >= 0; --a) {
                    var o = this.tryEntries[a]
                      , s = o.completion;
                    if ("root" === o.tryLoc)
                        return n("end");
                    if (o.tryLoc <= this.prev) {
                        var l = r.call(o, "catchLoc")
                          , h = r.call(o, "finallyLoc");
                        if (l && h) {
                            if (this.prev < o.catchLoc)
                                return n(o.catchLoc, !0);
                            if (this.prev < o.finallyLoc)
                                return n(o.finallyLoc)
                        } else if (l) {
                            if (this.prev < o.catchLoc)
                                return n(o.catchLoc, !0)
                        } else {
                            if (!h)
                                throw new Error("try statement without catch or finally");
                            if (this.prev < o.finallyLoc)
                                return n(o.finallyLoc)
                        }
                    }
                }
            },
            abrupt: function(e, t) {
                for (var i = this.tryEntries.length - 1; i >= 0; --i) {
                    var n = this.tryEntries[i];
                    if (n.tryLoc <= this.prev && r.call(n, "finallyLoc") && this.prev < n.finallyLoc) {
                        var a = n;
                        break
                    }
                }
                a && ("break" === e || "continue" === e) && a.tryLoc <= t && t <= a.finallyLoc && (a = null);
                var o = a ? a.completion : {};
                return o.type = e,
                o.arg = t,
                a ? (this.method = "next",
                this.next = a.finallyLoc,
                m) : this.complete(o)
            },
            complete: function(e, t) {
                if ("throw" === e.type)
                    throw e.arg;
                return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg,
                this.method = "return",
                this.next = "end") : "normal" === e.type && t && (this.next = t),
                m
            },
            finish: function(e) {
                for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                    var i = this.tryEntries[t];
                    if (i.finallyLoc === e)
                        return this.complete(i.completion, i.afterLoc),
                        M(i),
                        m
                }
            },
            catch: function(e) {
                for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                    var i = this.tryEntries[t];
                    if (i.tryLoc === e) {
                        var r = i.completion;
                        if ("throw" === r.type) {
                            var n = r.arg;
                            M(i)
                        }
                        return n
                    }
                }
                throw new Error("illegal catch attempt")
            },
            delegateYield: function(e, i, r) {
                return this.delegate = {
                    iterator: C(e),
                    resultName: i,
                    nextLoc: r
                },
                "next" === this.method && (this.arg = t),
                m
            }
        },
        e
    }(runtime.exports);
    try {
        regeneratorRuntime = t
    } catch (i) {
        "object" === ("undefined" == typeof globalThis ? "undefined" : _typeof2(globalThis)) ? globalThis.regeneratorRuntime = t : Function("r", "regeneratorRuntime = r")(t)
    }
}();
for (var REVISION = "133", MOUSE = {
    LEFT: 0,
    MIDDLE: 1,
    RIGHT: 2,
    ROTATE: 0,
    DOLLY: 1,
    PAN: 2
}, TOUCH = {
    ROTATE: 0,
    PAN: 1,
    DOLLY_PAN: 2,
    DOLLY_ROTATE: 3
}, CullFaceNone = 0, CullFaceBack = 1, CullFaceFront = 2, PCFShadowMap = 1, PCFSoftShadowMap = 2, VSMShadowMap = 3, FrontSide = 0, BackSide = 1, DoubleSide = 2, FlatShading = 1, NoBlending = 0, NormalBlending = 1, AdditiveBlending = 2, SubtractiveBlending = 3, MultiplyBlending = 4, CustomBlending = 5, AddEquation = 100, SubtractEquation = 101, ReverseSubtractEquation = 102, MinEquation = 103, MaxEquation = 104, ZeroFactor = 200, OneFactor = 201, SrcColorFactor = 202, OneMinusSrcColorFactor = 203, SrcAlphaFactor = 204, OneMinusSrcAlphaFactor = 205, DstAlphaFactor = 206, OneMinusDstAlphaFactor = 207, DstColorFactor = 208, OneMinusDstColorFactor = 209, SrcAlphaSaturateFactor = 210, NeverDepth = 0, AlwaysDepth = 1, LessDepth = 2, LessEqualDepth = 3, EqualDepth = 4, GreaterEqualDepth = 5, GreaterDepth = 6, NotEqualDepth = 7, MultiplyOperation = 0, MixOperation = 1, AddOperation = 2, NoToneMapping = 0, LinearToneMapping = 1, ReinhardToneMapping = 2, CineonToneMapping = 3, ACESFilmicToneMapping = 4, CustomToneMapping = 5, UVMapping = 300, CubeReflectionMapping = 301, CubeRefractionMapping = 302, EquirectangularReflectionMapping = 303, EquirectangularRefractionMapping = 304, CubeUVReflectionMapping = 306, CubeUVRefractionMapping = 307, RepeatWrapping = 1e3, ClampToEdgeWrapping = 1001, MirroredRepeatWrapping = 1002, NearestFilter = 1003, NearestMipmapNearestFilter = 1004, NearestMipMapNearestFilter = 1004, NearestMipmapLinearFilter = 1005, NearestMipMapLinearFilter = 1005, LinearFilter = 1006, LinearMipmapNearestFilter = 1007, LinearMipMapNearestFilter = 1007, LinearMipmapLinearFilter = 1008, LinearMipMapLinearFilter = 1008, UnsignedByteType = 1009, ByteType = 1010, ShortType = 1011, UnsignedShortType = 1012, IntType = 1013, UnsignedIntType = 1014, FloatType = 1015, HalfFloatType = 1016, UnsignedShort4444Type = 1017, UnsignedShort5551Type = 1018, UnsignedShort565Type = 1019, UnsignedInt248Type = 1020, AlphaFormat = 1021, RGBFormat = 1022, RGBAFormat = 1023, LuminanceFormat = 1024, LuminanceAlphaFormat = 1025, RGBEFormat = RGBAFormat, DepthFormat = 1026, DepthStencilFormat = 1027, RedFormat = 1028, RedIntegerFormat = 1029, RGFormat = 1030, RGIntegerFormat = 1031, RGBIntegerFormat = 1032, RGBAIntegerFormat = 1033, RGB_S3TC_DXT1_Format = 33776, RGBA_S3TC_DXT1_Format = 33777, RGBA_S3TC_DXT3_Format = 33778, RGBA_S3TC_DXT5_Format = 33779, RGB_PVRTC_4BPPV1_Format = 35840, RGB_PVRTC_2BPPV1_Format = 35841, RGBA_PVRTC_4BPPV1_Format = 35842, RGBA_PVRTC_2BPPV1_Format = 35843, RGB_ETC1_Format = 36196, RGB_ETC2_Format = 37492, RGBA_ETC2_EAC_Format = 37496, RGBA_ASTC_4x4_Format = 37808, RGBA_ASTC_5x4_Format = 37809, RGBA_ASTC_5x5_Format = 37810, RGBA_ASTC_6x5_Format = 37811, RGBA_ASTC_6x6_Format = 37812, RGBA_ASTC_8x5_Format = 37813, RGBA_ASTC_8x6_Format = 37814, RGBA_ASTC_8x8_Format = 37815, RGBA_ASTC_10x5_Format = 37816, RGBA_ASTC_10x6_Format = 37817, RGBA_ASTC_10x8_Format = 37818, RGBA_ASTC_10x10_Format = 37819, RGBA_ASTC_12x10_Format = 37820, RGBA_ASTC_12x12_Format = 37821, RGBA_BPTC_Format = 36492, SRGB8_ALPHA8_ASTC_4x4_Format = 37840, SRGB8_ALPHA8_ASTC_5x4_Format = 37841, SRGB8_ALPHA8_ASTC_5x5_Format = 37842, SRGB8_ALPHA8_ASTC_6x5_Format = 37843, SRGB8_ALPHA8_ASTC_6x6_Format = 37844, SRGB8_ALPHA8_ASTC_8x5_Format = 37845, SRGB8_ALPHA8_ASTC_8x6_Format = 37846, SRGB8_ALPHA8_ASTC_8x8_Format = 37847, SRGB8_ALPHA8_ASTC_10x5_Format = 37848, SRGB8_ALPHA8_ASTC_10x6_Format = 37849, SRGB8_ALPHA8_ASTC_10x8_Format = 37850, SRGB8_ALPHA8_ASTC_10x10_Format = 37851, SRGB8_ALPHA8_ASTC_12x10_Format = 37852, SRGB8_ALPHA8_ASTC_12x12_Format = 37853, LoopOnce = 2200, LoopRepeat = 2201, LoopPingPong = 2202, InterpolateDiscrete = 2300, InterpolateLinear = 2301, InterpolateSmooth = 2302, ZeroCurvatureEnding = 2400, ZeroSlopeEnding = 2401, WrapAroundEnding = 2402, NormalAnimationBlendMode = 2500, AdditiveAnimationBlendMode = 2501, TrianglesDrawMode = 0, TriangleStripDrawMode = 1, TriangleFanDrawMode = 2, LinearEncoding = 3e3, sRGBEncoding = 3001, GammaEncoding = 3007, RGBEEncoding = 3002, LogLuvEncoding = 3003, RGBM7Encoding = 3004, RGBM16Encoding = 3005, RGBDEncoding = 3006, BasicDepthPacking = 3200, RGBADepthPacking = 3201, TangentSpaceNormalMap = 0, ObjectSpaceNormalMap = 1, KeepStencilOp = 7680, AlwaysStencilFunc = 519, StaticDrawUsage = 35044, DynamicDrawUsage = 35048, GLSL3 = "300 es", EventDispatcher = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "addEventListener",
        value: function(e, t) {
            void 0 === this._listeners && (this._listeners = {});
            var i = this._listeners;
            void 0 === i[e] && (i[e] = []),
            -1 === i[e].indexOf(t) && i[e].push(t)
        }
    }, {
        key: "hasEventListener",
        value: function(e, t) {
            if (void 0 === this._listeners)
                return !1;
            var i = this._listeners;
            return void 0 !== i[e] && -1 !== i[e].indexOf(t)
        }
    }, {
        key: "removeEventListener",
        value: function(e, t) {
            if (void 0 !== this._listeners) {
                var i = this._listeners[e];
                if (void 0 !== i) {
                    var r = i.indexOf(t);
                    -1 !== r && i.splice(r, 1)
                }
            }
        }
    }, {
        key: "dispatchEvent",
        value: function(e) {
            if (void 0 !== this._listeners) {
                var t = this._listeners[e.type];
                if (void 0 !== t) {
                    e.target = this;
                    for (var i = t.slice(0), r = 0, n = i.length; r < n; r++)
                        i[r].call(this, e);
                    e.target = null
                }
            }
        }
    }]),
    e
}(), _seed = 1234567, DEG2RAD = Math.PI / 180, RAD2DEG = 180 / Math.PI, _lut = [], _i3 = 0; _i3 < 256; _i3++)
    _lut[_i3] = (_i3 < 16 ? "0" : "") + _i3.toString(16);
var hasRandomUUID = "undefined" != typeof crypto && "randomUUID"in crypto;
function generateUUID() {
    if (hasRandomUUID)
        return crypto.randomUUID().toUpperCase();
    var e = 4294967295 * Math.random() | 0
      , t = 4294967295 * Math.random() | 0
      , i = 4294967295 * Math.random() | 0
      , r = 4294967295 * Math.random() | 0;
    return (_lut[255 & e] + _lut[e >> 8 & 255] + _lut[e >> 16 & 255] + _lut[e >> 24 & 255] + "-" + _lut[255 & t] + _lut[t >> 8 & 255] + "-" + _lut[t >> 16 & 15 | 64] + _lut[t >> 24 & 255] + "-" + _lut[63 & i | 128] + _lut[i >> 8 & 255] + "-" + _lut[i >> 16 & 255] + _lut[i >> 24 & 255] + _lut[255 & r] + _lut[r >> 8 & 255] + _lut[r >> 16 & 255] + _lut[r >> 24 & 255]).toUpperCase()
}
function clamp(e, t, i) {
    return Math.max(t, Math.min(i, e))
}
function euclideanModulo(e, t) {
    return (e % t + t) % t
}
function mapLinear(e, t, i, r, n) {
    return r + (e - t) * (n - r) / (i - t)
}
function inverseLerp(e, t, i) {
    return e !== t ? (i - e) / (t - e) : 0
}
function lerp(e, t, i) {
    return (1 - i) * e + i * t
}
function damp(e, t, i, r) {
    return lerp(e, t, 1 - Math.exp(-i * r))
}
function pingpong(e) {
    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
    return t - Math.abs(euclideanModulo(e, 2 * t) - t)
}
function smoothstep(e, t, i) {
    return e <= t ? 0 : e >= i ? 1 : (e = (e - t) / (i - t)) * e * (3 - 2 * e)
}
function smootherstep(e, t, i) {
    return e <= t ? 0 : e >= i ? 1 : (e = (e - t) / (i - t)) * e * e * (e * (6 * e - 15) + 10)
}
function randInt(e, t) {
    return e + Math.floor(Math.random() * (t - e + 1))
}
function randFloat(e, t) {
    return e + Math.random() * (t - e)
}
function randFloatSpread(e) {
    return e * (.5 - Math.random())
}
function seededRandom(e) {
    return void 0 !== e && (_seed = e % 2147483647),
    ((_seed = 16807 * _seed % 2147483647) - 1) / 2147483646
}
function degToRad(e) {
    return e * DEG2RAD
}
function radToDeg(e) {
    return e * RAD2DEG
}
function isPowerOfTwo(e) {
    return 0 == (e & e - 1) && 0 !== e
}
function ceilPowerOfTwo(e) {
    return Math.pow(2, Math.ceil(Math.log(e) / Math.LN2))
}
function floorPowerOfTwo(e) {
    return Math.pow(2, Math.floor(Math.log(e) / Math.LN2))
}
function setQuaternionFromProperEuler(e, t, i, r, n) {
    var a = Math.cos
      , o = Math.sin
      , s = a(i / 2)
      , l = o(i / 2)
      , h = a((t + r) / 2)
      , c = o((t + r) / 2)
      , p = a((t - r) / 2)
      , u = o((t - r) / 2)
      , d = a((r - t) / 2)
      , f = o((r - t) / 2);
    switch (n) {
    case "XYX":
        e.set(s * c, l * p, l * u, s * h);
        break;
    case "YZY":
        e.set(l * u, s * c, l * p, s * h);
        break;
    case "ZXZ":
        e.set(l * p, l * u, s * c, s * h);
        break;
    case "XZX":
        e.set(s * c, l * f, l * d, s * h);
        break;
    case "YXY":
        e.set(l * d, s * c, l * f, s * h);
        break;
    case "ZYZ":
        e.set(l * f, l * d, s * c, s * h);
        break;
    default:
        console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: " + n)
    }
}
var MathUtils$1 = Object.freeze({
    __proto__: null,
    DEG2RAD,
    RAD2DEG,
    generateUUID,
    clamp,
    euclideanModulo,
    mapLinear,
    inverseLerp,
    lerp,
    damp,
    pingpong,
    smoothstep,
    smootherstep,
    randInt,
    randFloat,
    randFloatSpread,
    seededRandom,
    degToRad,
    radToDeg,
    isPowerOfTwo,
    ceilPowerOfTwo,
    floorPowerOfTwo,
    setQuaternionFromProperEuler
})
  , Vector2 = function(e) {
    function t() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
        _classCallCheck2(this, t),
        this.x = e,
        this.y = i
    }
    return _createClass2(t, [{
        key: "width",
        get: function() {
            return this.x
        },
        set: function(e) {
            this.x = e
        }
    }, {
        key: "height",
        get: function() {
            return this.y
        },
        set: function(e) {
            this.y = e
        }
    }, {
        key: "set",
        value: function(e, t) {
            return this.x = e,
            this.y = t,
            this
        }
    }, {
        key: "setScalar",
        value: function(e) {
            return this.x = e,
            this.y = e,
            this
        }
    }, {
        key: "setX",
        value: function(e) {
            return this.x = e,
            this
        }
    }, {
        key: "setY",
        value: function(e) {
            return this.y = e,
            this
        }
    }, {
        key: "setComponent",
        value: function(e, t) {
            switch (e) {
            case 0:
                this.x = t;
                break;
            case 1:
                this.y = t;
                break;
            default:
                throw new Error("index is out of range: " + e)
            }
            return this
        }
    }, {
        key: "getComponent",
        value: function(e) {
            switch (e) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            default:
                throw new Error("index is out of range: " + e)
            }
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this.x,this.y)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.x = e.x,
            this.y = e.y,
            this
        }
    }, {
        key: "add",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
            this.addVectors(e, t)) : (this.x += e.x,
            this.y += e.y,
            this)
        }
    }, {
        key: "addScalar",
        value: function(e) {
            return this.x += e,
            this.y += e,
            this
        }
    }, {
        key: "addVectors",
        value: function(e, t) {
            return this.x = e.x + t.x,
            this.y = e.y + t.y,
            this
        }
    }, {
        key: "addScaledVector",
        value: function(e, t) {
            return this.x += e.x * t,
            this.y += e.y * t,
            this
        }
    }, {
        key: "sub",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
            this.subVectors(e, t)) : (this.x -= e.x,
            this.y -= e.y,
            this)
        }
    }, {
        key: "subScalar",
        value: function(e) {
            return this.x -= e,
            this.y -= e,
            this
        }
    }, {
        key: "subVectors",
        value: function(e, t) {
            return this.x = e.x - t.x,
            this.y = e.y - t.y,
            this
        }
    }, {
        key: "multiply",
        value: function(e) {
            return this.x *= e.x,
            this.y *= e.y,
            this
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            return this.x *= e,
            this.y *= e,
            this
        }
    }, {
        key: "divide",
        value: function(e) {
            return this.x /= e.x,
            this.y /= e.y,
            this
        }
    }, {
        key: "divideScalar",
        value: function(e) {
            return this.multiplyScalar(1 / e)
        }
    }, {
        key: "applyMatrix3",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = e.elements;
            return this.x = r[0] * t + r[3] * i + r[6],
            this.y = r[1] * t + r[4] * i + r[7],
            this
        }
    }, {
        key: "min",
        value: function(e) {
            return this.x = Math.min(this.x, e.x),
            this.y = Math.min(this.y, e.y),
            this
        }
    }, {
        key: "max",
        value: function(e) {
            return this.x = Math.max(this.x, e.x),
            this.y = Math.max(this.y, e.y),
            this
        }
    }, {
        key: "clamp",
        value: function(e, t) {
            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
            this.y = Math.max(e.y, Math.min(t.y, this.y)),
            this
        }
    }, {
        key: "clampScalar",
        value: function(e, t) {
            return this.x = Math.max(e, Math.min(t, this.x)),
            this.y = Math.max(e, Math.min(t, this.y)),
            this
        }
    }, {
        key: "clampLength",
        value: function(e, t) {
            var i = this.length();
            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
        }
    }, {
        key: "floor",
        value: function() {
            return this.x = Math.floor(this.x),
            this.y = Math.floor(this.y),
            this
        }
    }, {
        key: "ceil",
        value: function() {
            return this.x = Math.ceil(this.x),
            this.y = Math.ceil(this.y),
            this
        }
    }, {
        key: "round",
        value: function() {
            return this.x = Math.round(this.x),
            this.y = Math.round(this.y),
            this
        }
    }, {
        key: "roundToZero",
        value: function() {
            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
            this
        }
    }, {
        key: "negate",
        value: function() {
            return this.x = -this.x,
            this.y = -this.y,
            this
        }
    }, {
        key: "dot",
        value: function(e) {
            return this.x * e.x + this.y * e.y
        }
    }, {
        key: "cross",
        value: function(e) {
            return this.x * e.y - this.y * e.x
        }
    }, {
        key: "lengthSq",
        value: function() {
            return this.x * this.x + this.y * this.y
        }
    }, {
        key: "length",
        value: function() {
            return Math.sqrt(this.x * this.x + this.y * this.y)
        }
    }, {
        key: "manhattanLength",
        value: function() {
            return Math.abs(this.x) + Math.abs(this.y)
        }
    }, {
        key: "normalize",
        value: function() {
            return this.divideScalar(this.length() || 1)
        }
    }, {
        key: "angle",
        value: function() {
            return Math.atan2(-this.y, -this.x) + Math.PI
        }
    }, {
        key: "distanceTo",
        value: function(e) {
            return Math.sqrt(this.distanceToSquared(e))
        }
    }, {
        key: "distanceToSquared",
        value: function(e) {
            var t = this.x - e.x
              , i = this.y - e.y;
            return t * t + i * i
        }
    }, {
        key: "manhattanDistanceTo",
        value: function(e) {
            return Math.abs(this.x - e.x) + Math.abs(this.y - e.y)
        }
    }, {
        key: "setLength",
        value: function(e) {
            return this.normalize().multiplyScalar(e)
        }
    }, {
        key: "lerp",
        value: function(e, t) {
            return this.x += (e.x - this.x) * t,
            this.y += (e.y - this.y) * t,
            this
        }
    }, {
        key: "lerpVectors",
        value: function(e, t, i) {
            return this.x = e.x + (t.x - e.x) * i,
            this.y = e.y + (t.y - e.y) * i,
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.x === this.x && e.y === this.y
        }
    }, {
        key: "fromArray",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.x = e[t],
            this.y = e[t + 1],
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this.x,
            e[t + 1] = this.y,
            e
        }
    }, {
        key: "fromBufferAttribute",
        value: function(e, t, i) {
            return void 0 !== i && console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),
            this.x = e.getX(t),
            this.y = e.getY(t),
            this
        }
    }, {
        key: "rotateAround",
        value: function(e, t) {
            var i = Math.cos(t)
              , r = Math.sin(t)
              , n = this.x - e.x
              , a = this.y - e.y;
            return this.x = n * i - a * r + e.x,
            this.y = n * r + a * i + e.y,
            this
        }
    }, {
        key: "random",
        value: function() {
            return this.x = Math.random(),
            this.y = Math.random(),
            this
        }
    }, {
        key: Symbol.iterator,
        value: _regeneratorRuntime().mark((function e() {
            return _regeneratorRuntime().wrap((function(e) {
                for (; ; )
                    switch (e.prev = e.next) {
                    case 0:
                        return e.next = 2,
                        this.x;
                    case 2:
                        return e.next = 4,
                        this.y;
                    case 4:
                    case "end":
                        return e.stop()
                    }
            }
            ), e, this)
        }
        ))
    }]),
    t
}();
Vector2.prototype.isVector2 = !0;
var Matrix3 = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elements = [1, 0, 0, 0, 1, 0, 0, 0, 1],
        arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i, r, n, a, o, s, l) {
            var h = this.elements;
            return h[0] = e,
            h[1] = r,
            h[2] = o,
            h[3] = t,
            h[4] = n,
            h[5] = s,
            h[6] = i,
            h[7] = a,
            h[8] = l,
            this
        }
    }, {
        key: "identity",
        value: function() {
            return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            var t = this.elements
              , i = e.elements;
            return t[0] = i[0],
            t[1] = i[1],
            t[2] = i[2],
            t[3] = i[3],
            t[4] = i[4],
            t[5] = i[5],
            t[6] = i[6],
            t[7] = i[7],
            t[8] = i[8],
            this
        }
    }, {
        key: "extractBasis",
        value: function(e, t, i) {
            return e.setFromMatrix3Column(this, 0),
            t.setFromMatrix3Column(this, 1),
            i.setFromMatrix3Column(this, 2),
            this
        }
    }, {
        key: "setFromMatrix4",
        value: function(e) {
            var t = e.elements;
            return this.set(t[0], t[4], t[8], t[1], t[5], t[9], t[2], t[6], t[10]),
            this
        }
    }, {
        key: "multiply",
        value: function(e) {
            return this.multiplyMatrices(this, e)
        }
    }, {
        key: "premultiply",
        value: function(e) {
            return this.multiplyMatrices(e, this)
        }
    }, {
        key: "multiplyMatrices",
        value: function(e, t) {
            var i = e.elements
              , r = t.elements
              , n = this.elements
              , a = i[0]
              , o = i[3]
              , s = i[6]
              , l = i[1]
              , h = i[4]
              , c = i[7]
              , p = i[2]
              , u = i[5]
              , d = i[8]
              , f = r[0]
              , m = r[3]
              , g = r[6]
              , v = r[1]
              , y = r[4]
              , _ = r[7]
              , b = r[2]
              , x = r[5]
              , w = r[8];
            return n[0] = a * f + o * v + s * b,
            n[3] = a * m + o * y + s * x,
            n[6] = a * g + o * _ + s * w,
            n[1] = l * f + h * v + c * b,
            n[4] = l * m + h * y + c * x,
            n[7] = l * g + h * _ + c * w,
            n[2] = p * f + u * v + d * b,
            n[5] = p * m + u * y + d * x,
            n[8] = p * g + u * _ + d * w,
            this
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            var t = this.elements;
            return t[0] *= e,
            t[3] *= e,
            t[6] *= e,
            t[1] *= e,
            t[4] *= e,
            t[7] *= e,
            t[2] *= e,
            t[5] *= e,
            t[8] *= e,
            this
        }
    }, {
        key: "determinant",
        value: function() {
            var e = this.elements
              , t = e[0]
              , i = e[1]
              , r = e[2]
              , n = e[3]
              , a = e[4]
              , o = e[5]
              , s = e[6]
              , l = e[7]
              , h = e[8];
            return t * a * h - t * o * l - i * n * h + i * o * s + r * n * l - r * a * s
        }
    }, {
        key: "invert",
        value: function() {
            var e = this.elements
              , t = e[0]
              , i = e[1]
              , r = e[2]
              , n = e[3]
              , a = e[4]
              , o = e[5]
              , s = e[6]
              , l = e[7]
              , h = e[8]
              , c = h * a - o * l
              , p = o * s - h * n
              , u = l * n - a * s
              , d = t * c + i * p + r * u;
            if (0 === d)
                return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0);
            var f = 1 / d;
            return e[0] = c * f,
            e[1] = (r * l - h * i) * f,
            e[2] = (o * i - r * a) * f,
            e[3] = p * f,
            e[4] = (h * t - r * s) * f,
            e[5] = (r * n - o * t) * f,
            e[6] = u * f,
            e[7] = (i * s - l * t) * f,
            e[8] = (a * t - i * n) * f,
            this
        }
    }, {
        key: "transpose",
        value: function() {
            var e, t = this.elements;
            return e = t[1],
            t[1] = t[3],
            t[3] = e,
            e = t[2],
            t[2] = t[6],
            t[6] = e,
            e = t[5],
            t[5] = t[7],
            t[7] = e,
            this
        }
    }, {
        key: "getNormalMatrix",
        value: function(e) {
            return this.setFromMatrix4(e).invert().transpose()
        }
    }, {
        key: "transposeIntoArray",
        value: function(e) {
            var t = this.elements;
            return e[0] = t[0],
            e[1] = t[3],
            e[2] = t[6],
            e[3] = t[1],
            e[4] = t[4],
            e[5] = t[7],
            e[6] = t[2],
            e[7] = t[5],
            e[8] = t[8],
            this
        }
    }, {
        key: "setUvTransform",
        value: function(e, t, i, r, n, a, o) {
            var s = Math.cos(n)
              , l = Math.sin(n);
            return this.set(i * s, i * l, -i * (s * a + l * o) + a + e, -r * l, r * s, -r * (-l * a + s * o) + o + t, 0, 0, 1),
            this
        }
    }, {
        key: "scale",
        value: function(e, t) {
            var i = this.elements;
            return i[0] *= e,
            i[3] *= e,
            i[6] *= e,
            i[1] *= t,
            i[4] *= t,
            i[7] *= t,
            this
        }
    }, {
        key: "rotate",
        value: function(e) {
            var t = Math.cos(e)
              , i = Math.sin(e)
              , r = this.elements
              , n = r[0]
              , a = r[3]
              , o = r[6]
              , s = r[1]
              , l = r[4]
              , h = r[7];
            return r[0] = t * n + i * s,
            r[3] = t * a + i * l,
            r[6] = t * o + i * h,
            r[1] = -i * n + t * s,
            r[4] = -i * a + t * l,
            r[7] = -i * o + t * h,
            this
        }
    }, {
        key: "translate",
        value: function(e, t) {
            var i = this.elements;
            return i[0] += e * i[2],
            i[3] += e * i[5],
            i[6] += e * i[8],
            i[1] += t * i[2],
            i[4] += t * i[5],
            i[7] += t * i[8],
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            for (var t = this.elements, i = e.elements, r = 0; r < 9; r++)
                if (t[r] !== i[r])
                    return !1;
            return !0
        }
    }, {
        key: "fromArray",
        value: function(e) {
            for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = 0; i < 9; i++)
                this.elements[i] = e[i + t];
            return this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
              , i = this.elements;
            return e[t] = i[0],
            e[t + 1] = i[1],
            e[t + 2] = i[2],
            e[t + 3] = i[3],
            e[t + 4] = i[4],
            e[t + 5] = i[5],
            e[t + 6] = i[6],
            e[t + 7] = i[7],
            e[t + 8] = i[8],
            e
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).fromArray(this.elements)
        }
    }]),
    e
}(), _canvas;
function arrayMax(e) {
    if (0 === e.length)
        return -1 / 0;
    for (var t = e[0], i = 1, r = e.length; i < r; ++i)
        e[i] > t && (t = e[i]);
    return t
}
function createElementNS(e) {
    return document.createElementNS("http://www.w3.org/1999/xhtml", e)
}
Matrix3.prototype.isMatrix3 = !0;
var ImageUtils = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, null, [{
        key: "getDataURL",
        value: function(e) {
            if (/^data:/i.test(e.src))
                return e.src;
            if ("undefined" == typeof HTMLCanvasElement)
                return e.src;
            var t;
            if (e instanceof HTMLCanvasElement)
                t = e;
            else {
                void 0 === _canvas && (_canvas = createElementNS("canvas")),
                _canvas.width = e.width,
                _canvas.height = e.height;
                var i = _canvas.getContext("2d");
                e instanceof ImageData ? i.putImageData(e, 0, 0) : i.drawImage(e, 0, 0, e.width, e.height),
                t = _canvas
            }
            return t.width > 2048 || t.height > 2048 ? (console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons", e),
            t.toDataURL("image/jpeg", .6)) : t.toDataURL("image/png")
        }
    }]),
    e
}()
  , textureId = 0
  , Texture = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : i.DEFAULT_IMAGE, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : i.DEFAULT_MAPPING, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ClampToEdgeWrapping, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : ClampToEdgeWrapping, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : LinearFilter, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : LinearMipmapLinearFilter, h = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : RGBAFormat, c = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : UnsignedByteType, p = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : 1, u = arguments.length > 9 && void 0 !== arguments[9] ? arguments[9] : LinearEncoding;
        return _classCallCheck2(this, i),
        e = t.call(this),
        Object.defineProperty(_assertThisInitialized(e), "id", {
            value: textureId++
        }),
        e.uuid = generateUUID(),
        e.name = "",
        e.image = r,
        e.mipmaps = [],
        e.mapping = n,
        e.wrapS = a,
        e.wrapT = o,
        e.magFilter = s,
        e.minFilter = l,
        e.anisotropy = p,
        e.format = h,
        e.internalFormat = null,
        e.type = c,
        e.offset = new Vector2(0,0),
        e.repeat = new Vector2(1,1),
        e.center = new Vector2(0,0),
        e.rotation = 0,
        e.matrixAutoUpdate = !0,
        e.matrix = new Matrix3,
        e.generateMipmaps = !0,
        e.premultiplyAlpha = !1,
        e.flipY = !0,
        e.unpackAlignment = 4,
        e.encoding = u,
        e.version = 0,
        e.onUpdate = null,
        e.isRenderTargetTexture = !1,
        e
    }
    return _createClass2(i, [{
        key: "updateMatrix",
        value: function() {
            this.matrix.setUvTransform(this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y)
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.name = e.name,
            this.image = e.image,
            this.mipmaps = e.mipmaps.slice(0),
            this.mapping = e.mapping,
            this.wrapS = e.wrapS,
            this.wrapT = e.wrapT,
            this.magFilter = e.magFilter,
            this.minFilter = e.minFilter,
            this.anisotropy = e.anisotropy,
            this.format = e.format,
            this.internalFormat = e.internalFormat,
            this.type = e.type,
            this.offset.copy(e.offset),
            this.repeat.copy(e.repeat),
            this.center.copy(e.center),
            this.rotation = e.rotation,
            this.matrixAutoUpdate = e.matrixAutoUpdate,
            this.matrix.copy(e.matrix),
            this.generateMipmaps = e.generateMipmaps,
            this.premultiplyAlpha = e.premultiplyAlpha,
            this.flipY = e.flipY,
            this.unpackAlignment = e.unpackAlignment,
            this.encoding = e.encoding,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = void 0 === e || "string" == typeof e;
            if (!t && void 0 !== e.textures[this.uuid])
                return e.textures[this.uuid];
            var i = {
                metadata: {
                    version: 4.5,
                    type: "Texture",
                    generator: "Texture.toJSON"
                },
                uuid: this.uuid,
                name: this.name,
                mapping: this.mapping,
                repeat: [this.repeat.x, this.repeat.y],
                offset: [this.offset.x, this.offset.y],
                center: [this.center.x, this.center.y],
                rotation: this.rotation,
                wrap: [this.wrapS, this.wrapT],
                format: this.format,
                type: this.type,
                encoding: this.encoding,
                minFilter: this.minFilter,
                magFilter: this.magFilter,
                anisotropy: this.anisotropy,
                flipY: this.flipY,
                premultiplyAlpha: this.premultiplyAlpha,
                unpackAlignment: this.unpackAlignment
            };
            if (void 0 !== this.image) {
                var r = this.image;
                if (void 0 === r.uuid && (r.uuid = generateUUID()),
                !t && void 0 === e.images[r.uuid]) {
                    var n;
                    if (Array.isArray(r)) {
                        n = [];
                        for (var a = 0, o = r.length; a < o; a++)
                            r[a].isDataTexture ? n.push(serializeImage(r[a].image)) : n.push(serializeImage(r[a]))
                    } else
                        n = serializeImage(r);
                    e.images[r.uuid] = {
                        uuid: r.uuid,
                        url: n
                    }
                }
                i.image = r.uuid
            }
            return t || (e.textures[this.uuid] = i),
            i
        }
    }, {
        key: "dispose",
        value: function() {
            this.dispatchEvent({
                type: "dispose"
            })
        }
    }, {
        key: "transformUv",
        value: function(e) {
            if (this.mapping !== UVMapping)
                return e;
            if (e.applyMatrix3(this.matrix),
            e.x < 0 || e.x > 1)
                switch (this.wrapS) {
                case RepeatWrapping:
                    e.x = e.x - Math.floor(e.x);
                    break;
                case ClampToEdgeWrapping:
                    e.x = e.x < 0 ? 0 : 1;
                    break;
                case MirroredRepeatWrapping:
                    1 === Math.abs(Math.floor(e.x) % 2) ? e.x = Math.ceil(e.x) - e.x : e.x = e.x - Math.floor(e.x)
                }
            if (e.y < 0 || e.y > 1)
                switch (this.wrapT) {
                case RepeatWrapping:
                    e.y = e.y - Math.floor(e.y);
                    break;
                case ClampToEdgeWrapping:
                    e.y = e.y < 0 ? 0 : 1;
                    break;
                case MirroredRepeatWrapping:
                    1 === Math.abs(Math.floor(e.y) % 2) ? e.y = Math.ceil(e.y) - e.y : e.y = e.y - Math.floor(e.y)
                }
            return this.flipY && (e.y = 1 - e.y),
            e
        }
    }, {
        key: "needsUpdate",
        set: function(e) {
            !0 === e && this.version++
        }
    }]),
    i
}();
function serializeImage(e) {
    return "undefined" != typeof HTMLImageElement && e instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && e instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && e instanceof ImageBitmap ? ImageUtils.getDataURL(e) : e.data ? {
        data: Array.prototype.slice.call(e.data),
        width: e.width,
        height: e.height,
        type: e.data.constructor.name
    } : (console.warn("THREE.Texture: Unable to serialize Texture."),
    {})
}
Texture.DEFAULT_IMAGE = void 0,
Texture.DEFAULT_MAPPING = UVMapping,
Texture.prototype.isTexture = !0;
var Vector4 = function(e) {
    function t() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        _classCallCheck2(this, t),
        this.x = e,
        this.y = i,
        this.z = r,
        this.w = n
    }
    return _createClass2(t, [{
        key: "width",
        get: function() {
            return this.z
        },
        set: function(e) {
            this.z = e
        }
    }, {
        key: "height",
        get: function() {
            return this.w
        },
        set: function(e) {
            this.w = e
        }
    }, {
        key: "set",
        value: function(e, t, i, r) {
            return this.x = e,
            this.y = t,
            this.z = i,
            this.w = r,
            this
        }
    }, {
        key: "setScalar",
        value: function(e) {
            return this.x = e,
            this.y = e,
            this.z = e,
            this.w = e,
            this
        }
    }, {
        key: "setX",
        value: function(e) {
            return this.x = e,
            this
        }
    }, {
        key: "setY",
        value: function(e) {
            return this.y = e,
            this
        }
    }, {
        key: "setZ",
        value: function(e) {
            return this.z = e,
            this
        }
    }, {
        key: "setW",
        value: function(e) {
            return this.w = e,
            this
        }
    }, {
        key: "setComponent",
        value: function(e, t) {
            switch (e) {
            case 0:
                this.x = t;
                break;
            case 1:
                this.y = t;
                break;
            case 2:
                this.z = t;
                break;
            case 3:
                this.w = t;
                break;
            default:
                throw new Error("index is out of range: " + e)
            }
            return this
        }
    }, {
        key: "getComponent",
        value: function(e) {
            switch (e) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            case 2:
                return this.z;
            case 3:
                return this.w;
            default:
                throw new Error("index is out of range: " + e)
            }
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this.x,this.y,this.z,this.w)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.x = e.x,
            this.y = e.y,
            this.z = e.z,
            this.w = void 0 !== e.w ? e.w : 1,
            this
        }
    }, {
        key: "add",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
            this.addVectors(e, t)) : (this.x += e.x,
            this.y += e.y,
            this.z += e.z,
            this.w += e.w,
            this)
        }
    }, {
        key: "addScalar",
        value: function(e) {
            return this.x += e,
            this.y += e,
            this.z += e,
            this.w += e,
            this
        }
    }, {
        key: "addVectors",
        value: function(e, t) {
            return this.x = e.x + t.x,
            this.y = e.y + t.y,
            this.z = e.z + t.z,
            this.w = e.w + t.w,
            this
        }
    }, {
        key: "addScaledVector",
        value: function(e, t) {
            return this.x += e.x * t,
            this.y += e.y * t,
            this.z += e.z * t,
            this.w += e.w * t,
            this
        }
    }, {
        key: "sub",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
            this.subVectors(e, t)) : (this.x -= e.x,
            this.y -= e.y,
            this.z -= e.z,
            this.w -= e.w,
            this)
        }
    }, {
        key: "subScalar",
        value: function(e) {
            return this.x -= e,
            this.y -= e,
            this.z -= e,
            this.w -= e,
            this
        }
    }, {
        key: "subVectors",
        value: function(e, t) {
            return this.x = e.x - t.x,
            this.y = e.y - t.y,
            this.z = e.z - t.z,
            this.w = e.w - t.w,
            this
        }
    }, {
        key: "multiply",
        value: function(e) {
            return this.x *= e.x,
            this.y *= e.y,
            this.z *= e.z,
            this.w *= e.w,
            this
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            return this.x *= e,
            this.y *= e,
            this.z *= e,
            this.w *= e,
            this
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = this.z
              , n = this.w
              , a = e.elements;
            return this.x = a[0] * t + a[4] * i + a[8] * r + a[12] * n,
            this.y = a[1] * t + a[5] * i + a[9] * r + a[13] * n,
            this.z = a[2] * t + a[6] * i + a[10] * r + a[14] * n,
            this.w = a[3] * t + a[7] * i + a[11] * r + a[15] * n,
            this
        }
    }, {
        key: "divideScalar",
        value: function(e) {
            return this.multiplyScalar(1 / e)
        }
    }, {
        key: "setAxisAngleFromQuaternion",
        value: function(e) {
            this.w = 2 * Math.acos(e.w);
            var t = Math.sqrt(1 - e.w * e.w);
            return t < 1e-4 ? (this.x = 1,
            this.y = 0,
            this.z = 0) : (this.x = e.x / t,
            this.y = e.y / t,
            this.z = e.z / t),
            this
        }
    }, {
        key: "setAxisAngleFromRotationMatrix",
        value: function(e) {
            var t, i, r, n, a = .01, o = .1, s = e.elements, l = s[0], h = s[4], c = s[8], p = s[1], u = s[5], d = s[9], f = s[2], m = s[6], g = s[10];
            if (Math.abs(h - p) < a && Math.abs(c - f) < a && Math.abs(d - m) < a) {
                if (Math.abs(h + p) < o && Math.abs(c + f) < o && Math.abs(d + m) < o && Math.abs(l + u + g - 3) < o)
                    return this.set(1, 0, 0, 0),
                    this;
                t = Math.PI;
                var v = (l + 1) / 2
                  , y = (u + 1) / 2
                  , _ = (g + 1) / 2
                  , b = (h + p) / 4
                  , x = (c + f) / 4
                  , w = (d + m) / 4;
                return v > y && v > _ ? v < a ? (i = 0,
                r = .707106781,
                n = .707106781) : (r = b / (i = Math.sqrt(v)),
                n = x / i) : y > _ ? y < a ? (i = .707106781,
                r = 0,
                n = .707106781) : (i = b / (r = Math.sqrt(y)),
                n = w / r) : _ < a ? (i = .707106781,
                r = .707106781,
                n = 0) : (i = x / (n = Math.sqrt(_)),
                r = w / n),
                this.set(i, r, n, t),
                this
            }
            var S = Math.sqrt((m - d) * (m - d) + (c - f) * (c - f) + (p - h) * (p - h));
            return Math.abs(S) < .001 && (S = 1),
            this.x = (m - d) / S,
            this.y = (c - f) / S,
            this.z = (p - h) / S,
            this.w = Math.acos((l + u + g - 1) / 2),
            this
        }
    }, {
        key: "min",
        value: function(e) {
            return this.x = Math.min(this.x, e.x),
            this.y = Math.min(this.y, e.y),
            this.z = Math.min(this.z, e.z),
            this.w = Math.min(this.w, e.w),
            this
        }
    }, {
        key: "max",
        value: function(e) {
            return this.x = Math.max(this.x, e.x),
            this.y = Math.max(this.y, e.y),
            this.z = Math.max(this.z, e.z),
            this.w = Math.max(this.w, e.w),
            this
        }
    }, {
        key: "clamp",
        value: function(e, t) {
            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
            this.y = Math.max(e.y, Math.min(t.y, this.y)),
            this.z = Math.max(e.z, Math.min(t.z, this.z)),
            this.w = Math.max(e.w, Math.min(t.w, this.w)),
            this
        }
    }, {
        key: "clampScalar",
        value: function(e, t) {
            return this.x = Math.max(e, Math.min(t, this.x)),
            this.y = Math.max(e, Math.min(t, this.y)),
            this.z = Math.max(e, Math.min(t, this.z)),
            this.w = Math.max(e, Math.min(t, this.w)),
            this
        }
    }, {
        key: "clampLength",
        value: function(e, t) {
            var i = this.length();
            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
        }
    }, {
        key: "floor",
        value: function() {
            return this.x = Math.floor(this.x),
            this.y = Math.floor(this.y),
            this.z = Math.floor(this.z),
            this.w = Math.floor(this.w),
            this
        }
    }, {
        key: "ceil",
        value: function() {
            return this.x = Math.ceil(this.x),
            this.y = Math.ceil(this.y),
            this.z = Math.ceil(this.z),
            this.w = Math.ceil(this.w),
            this
        }
    }, {
        key: "round",
        value: function() {
            return this.x = Math.round(this.x),
            this.y = Math.round(this.y),
            this.z = Math.round(this.z),
            this.w = Math.round(this.w),
            this
        }
    }, {
        key: "roundToZero",
        value: function() {
            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
            this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z),
            this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w),
            this
        }
    }, {
        key: "negate",
        value: function() {
            return this.x = -this.x,
            this.y = -this.y,
            this.z = -this.z,
            this.w = -this.w,
            this
        }
    }, {
        key: "dot",
        value: function(e) {
            return this.x * e.x + this.y * e.y + this.z * e.z + this.w * e.w
        }
    }, {
        key: "lengthSq",
        value: function() {
            return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
        }
    }, {
        key: "length",
        value: function() {
            return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
        }
    }, {
        key: "manhattanLength",
        value: function() {
            return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
        }
    }, {
        key: "normalize",
        value: function() {
            return this.divideScalar(this.length() || 1)
        }
    }, {
        key: "setLength",
        value: function(e) {
            return this.normalize().multiplyScalar(e)
        }
    }, {
        key: "lerp",
        value: function(e, t) {
            return this.x += (e.x - this.x) * t,
            this.y += (e.y - this.y) * t,
            this.z += (e.z - this.z) * t,
            this.w += (e.w - this.w) * t,
            this
        }
    }, {
        key: "lerpVectors",
        value: function(e, t, i) {
            return this.x = e.x + (t.x - e.x) * i,
            this.y = e.y + (t.y - e.y) * i,
            this.z = e.z + (t.z - e.z) * i,
            this.w = e.w + (t.w - e.w) * i,
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.x === this.x && e.y === this.y && e.z === this.z && e.w === this.w
        }
    }, {
        key: "fromArray",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.x = e[t],
            this.y = e[t + 1],
            this.z = e[t + 2],
            this.w = e[t + 3],
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this.x,
            e[t + 1] = this.y,
            e[t + 2] = this.z,
            e[t + 3] = this.w,
            e
        }
    }, {
        key: "fromBufferAttribute",
        value: function(e, t, i) {
            return void 0 !== i && console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),
            this.x = e.getX(t),
            this.y = e.getY(t),
            this.z = e.getZ(t),
            this.w = e.getW(t),
            this
        }
    }, {
        key: "random",
        value: function() {
            return this.x = Math.random(),
            this.y = Math.random(),
            this.z = Math.random(),
            this.w = Math.random(),
            this
        }
    }, {
        key: Symbol.iterator,
        value: _regeneratorRuntime().mark((function e() {
            return _regeneratorRuntime().wrap((function(e) {
                for (; ; )
                    switch (e.prev = e.next) {
                    case 0:
                        return e.next = 2,
                        this.x;
                    case 2:
                        return e.next = 4,
                        this.y;
                    case 4:
                        return e.next = 6,
                        this.z;
                    case 6:
                        return e.next = 8,
                        this.w;
                    case 8:
                    case "end":
                        return e.stop()
                    }
            }
            ), e, this)
        }
        ))
    }]),
    t
}();
Vector4.prototype.isVector4 = !0;
var WebGLRenderTarget = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};
        return _classCallCheck2(this, i),
        (n = t.call(this)).width = e,
        n.height = r,
        n.depth = 1,
        n.scissor = new Vector4(0,0,e,r),
        n.scissorTest = !1,
        n.viewport = new Vector4(0,0,e,r),
        n.texture = new Texture(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),
        n.texture.isRenderTargetTexture = !0,
        n.texture.image = {
            width: e,
            height: r,
            depth: 1
        },
        n.texture.generateMipmaps = void 0 !== a.generateMipmaps && a.generateMipmaps,
        n.texture.internalFormat = void 0 !== a.internalFormat ? a.internalFormat : null,
        n.texture.minFilter = void 0 !== a.minFilter ? a.minFilter : LinearFilter,
        n.depthBuffer = void 0 === a.depthBuffer || a.depthBuffer,
        n.stencilBuffer = void 0 !== a.stencilBuffer && a.stencilBuffer,
        n.depthTexture = void 0 !== a.depthTexture ? a.depthTexture : null,
        n
    }
    return _createClass2(i, [{
        key: "setTexture",
        value: function(e) {
            e.image = {
                width: this.width,
                height: this.height,
                depth: this.depth
            },
            this.texture = e
        }
    }, {
        key: "setSize",
        value: function(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1;
            this.width === e && this.height === t && this.depth === i || (this.width = e,
            this.height = t,
            this.depth = i,
            this.texture.image.width = e,
            this.texture.image.height = t,
            this.texture.image.depth = i,
            this.dispose()),
            this.viewport.set(0, 0, e, t),
            this.scissor.set(0, 0, e, t)
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.width = e.width,
            this.height = e.height,
            this.depth = e.depth,
            this.viewport.copy(e.viewport),
            this.texture = e.texture.clone(),
            this.texture.image = _objectSpread({}, this.texture.image),
            this.depthBuffer = e.depthBuffer,
            this.stencilBuffer = e.stencilBuffer,
            this.depthTexture = e.depthTexture,
            this
        }
    }, {
        key: "dispose",
        value: function() {
            this.dispatchEvent({
                type: "dispose"
            })
        }
    }]),
    i
}();
WebGLRenderTarget.prototype.isWebGLRenderTarget = !0;
var WebGLMultipleRenderTargets = function(e) {
    _inherits(i, WebGLRenderTarget);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        _classCallCheck2(this, i);
        var o = (a = t.call(this, e, r)).texture;
        a.texture = [];
        for (var s = 0; s < n; s++)
            a.texture[s] = o.clone();
        return a
    }
    return _createClass2(i, [{
        key: "setSize",
        value: function(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1;
            if (this.width !== e || this.height !== t || this.depth !== i) {
                this.width = e,
                this.height = t,
                this.depth = i;
                for (var r = 0, n = this.texture.length; r < n; r++)
                    this.texture[r].image.width = e,
                    this.texture[r].image.height = t,
                    this.texture[r].image.depth = i;
                this.dispose()
            }
            return this.viewport.set(0, 0, e, t),
            this.scissor.set(0, 0, e, t),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            this.dispose(),
            this.width = e.width,
            this.height = e.height,
            this.depth = e.depth,
            this.viewport.set(0, 0, this.width, this.height),
            this.scissor.set(0, 0, this.width, this.height),
            this.depthBuffer = e.depthBuffer,
            this.stencilBuffer = e.stencilBuffer,
            this.depthTexture = e.depthTexture,
            this.texture.length = 0;
            for (var t = 0, i = e.texture.length; t < i; t++)
                this.texture[t] = e.texture[t].clone();
            return this
        }
    }]),
    i
}();
WebGLMultipleRenderTargets.prototype.isWebGLMultipleRenderTargets = !0;
var WebGLMultisampleRenderTarget = function(e) {
    _inherits(i, WebGLRenderTarget);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        return _classCallCheck2(this, i),
        (a = t.call(this, e, r, n)).samples = 4,
        a
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.samples = e.samples,
            this
        }
    }]),
    i
}();
WebGLMultisampleRenderTarget.prototype.isWebGLMultisampleRenderTarget = !0;
var Quaternion = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        _classCallCheck2(this, e),
        this._x = t,
        this._y = i,
        this._z = r,
        this._w = n
    }
    return _createClass2(e, [{
        key: "x",
        get: function() {
            return this._x
        },
        set: function(e) {
            this._x = e,
            this._onChangeCallback()
        }
    }, {
        key: "y",
        get: function() {
            return this._y
        },
        set: function(e) {
            this._y = e,
            this._onChangeCallback()
        }
    }, {
        key: "z",
        get: function() {
            return this._z
        },
        set: function(e) {
            this._z = e,
            this._onChangeCallback()
        }
    }, {
        key: "w",
        get: function() {
            return this._w
        },
        set: function(e) {
            this._w = e,
            this._onChangeCallback()
        }
    }, {
        key: "set",
        value: function(e, t, i, r) {
            return this._x = e,
            this._y = t,
            this._z = i,
            this._w = r,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this._x,this._y,this._z,this._w)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this._x = e.x,
            this._y = e.y,
            this._z = e.z,
            this._w = e.w,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromEuler",
        value: function(e, t) {
            if (!e || !e.isEuler)
                throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
            var i = e._x
              , r = e._y
              , n = e._z
              , a = e._order
              , o = Math.cos
              , s = Math.sin
              , l = o(i / 2)
              , h = o(r / 2)
              , c = o(n / 2)
              , p = s(i / 2)
              , u = s(r / 2)
              , d = s(n / 2);
            switch (a) {
            case "XYZ":
                this._x = p * h * c + l * u * d,
                this._y = l * u * c - p * h * d,
                this._z = l * h * d + p * u * c,
                this._w = l * h * c - p * u * d;
                break;
            case "YXZ":
                this._x = p * h * c + l * u * d,
                this._y = l * u * c - p * h * d,
                this._z = l * h * d - p * u * c,
                this._w = l * h * c + p * u * d;
                break;
            case "ZXY":
                this._x = p * h * c - l * u * d,
                this._y = l * u * c + p * h * d,
                this._z = l * h * d + p * u * c,
                this._w = l * h * c - p * u * d;
                break;
            case "ZYX":
                this._x = p * h * c - l * u * d,
                this._y = l * u * c + p * h * d,
                this._z = l * h * d - p * u * c,
                this._w = l * h * c + p * u * d;
                break;
            case "YZX":
                this._x = p * h * c + l * u * d,
                this._y = l * u * c + p * h * d,
                this._z = l * h * d - p * u * c,
                this._w = l * h * c - p * u * d;
                break;
            case "XZY":
                this._x = p * h * c - l * u * d,
                this._y = l * u * c - p * h * d,
                this._z = l * h * d + p * u * c,
                this._w = l * h * c + p * u * d;
                break;
            default:
                console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: " + a)
            }
            return !1 !== t && this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromAxisAngle",
        value: function(e, t) {
            var i = t / 2
              , r = Math.sin(i);
            return this._x = e.x * r,
            this._y = e.y * r,
            this._z = e.z * r,
            this._w = Math.cos(i),
            this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromRotationMatrix",
        value: function(e) {
            var t = e.elements
              , i = t[0]
              , r = t[4]
              , n = t[8]
              , a = t[1]
              , o = t[5]
              , s = t[9]
              , l = t[2]
              , h = t[6]
              , c = t[10]
              , p = i + o + c;
            if (p > 0) {
                var u = .5 / Math.sqrt(p + 1);
                this._w = .25 / u,
                this._x = (h - s) * u,
                this._y = (n - l) * u,
                this._z = (a - r) * u
            } else if (i > o && i > c) {
                var d = 2 * Math.sqrt(1 + i - o - c);
                this._w = (h - s) / d,
                this._x = .25 * d,
                this._y = (r + a) / d,
                this._z = (n + l) / d
            } else if (o > c) {
                var f = 2 * Math.sqrt(1 + o - i - c);
                this._w = (n - l) / f,
                this._x = (r + a) / f,
                this._y = .25 * f,
                this._z = (s + h) / f
            } else {
                var m = 2 * Math.sqrt(1 + c - i - o);
                this._w = (a - r) / m,
                this._x = (n + l) / m,
                this._y = (s + h) / m,
                this._z = .25 * m
            }
            return this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromUnitVectors",
        value: function(e, t) {
            var i = e.dot(t) + 1;
            return i < Number.EPSILON ? (i = 0,
            Math.abs(e.x) > Math.abs(e.z) ? (this._x = -e.y,
            this._y = e.x,
            this._z = 0,
            this._w = i) : (this._x = 0,
            this._y = -e.z,
            this._z = e.y,
            this._w = i)) : (this._x = e.y * t.z - e.z * t.y,
            this._y = e.z * t.x - e.x * t.z,
            this._z = e.x * t.y - e.y * t.x,
            this._w = i),
            this.normalize()
        }
    }, {
        key: "angleTo",
        value: function(e) {
            return 2 * Math.acos(Math.abs(clamp(this.dot(e), -1, 1)))
        }
    }, {
        key: "rotateTowards",
        value: function(e, t) {
            var i = this.angleTo(e);
            if (0 === i)
                return this;
            var r = Math.min(1, t / i);
            return this.slerp(e, r),
            this
        }
    }, {
        key: "identity",
        value: function() {
            return this.set(0, 0, 0, 1)
        }
    }, {
        key: "invert",
        value: function() {
            return this.conjugate()
        }
    }, {
        key: "conjugate",
        value: function() {
            return this._x *= -1,
            this._y *= -1,
            this._z *= -1,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "dot",
        value: function(e) {
            return this._x * e._x + this._y * e._y + this._z * e._z + this._w * e._w
        }
    }, {
        key: "lengthSq",
        value: function() {
            return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
        }
    }, {
        key: "length",
        value: function() {
            return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
        }
    }, {
        key: "normalize",
        value: function() {
            var e = this.length();
            return 0 === e ? (this._x = 0,
            this._y = 0,
            this._z = 0,
            this._w = 1) : (e = 1 / e,
            this._x = this._x * e,
            this._y = this._y * e,
            this._z = this._z * e,
            this._w = this._w * e),
            this._onChangeCallback(),
            this
        }
    }, {
        key: "multiply",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
            this.multiplyQuaternions(e, t)) : this.multiplyQuaternions(this, e)
        }
    }, {
        key: "premultiply",
        value: function(e) {
            return this.multiplyQuaternions(e, this)
        }
    }, {
        key: "multiplyQuaternions",
        value: function(e, t) {
            var i = e._x
              , r = e._y
              , n = e._z
              , a = e._w
              , o = t._x
              , s = t._y
              , l = t._z
              , h = t._w;
            return this._x = i * h + a * o + r * l - n * s,
            this._y = r * h + a * s + n * o - i * l,
            this._z = n * h + a * l + i * s - r * o,
            this._w = a * h - i * o - r * s - n * l,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "slerp",
        value: function(e, t) {
            if (0 === t)
                return this;
            if (1 === t)
                return this.copy(e);
            var i = this._x
              , r = this._y
              , n = this._z
              , a = this._w
              , o = a * e._w + i * e._x + r * e._y + n * e._z;
            if (o < 0 ? (this._w = -e._w,
            this._x = -e._x,
            this._y = -e._y,
            this._z = -e._z,
            o = -o) : this.copy(e),
            o >= 1)
                return this._w = a,
                this._x = i,
                this._y = r,
                this._z = n,
                this;
            var s = 1 - o * o;
            if (s <= Number.EPSILON) {
                var l = 1 - t;
                return this._w = l * a + t * this._w,
                this._x = l * i + t * this._x,
                this._y = l * r + t * this._y,
                this._z = l * n + t * this._z,
                this.normalize(),
                this._onChangeCallback(),
                this
            }
            var h = Math.sqrt(s)
              , c = Math.atan2(h, o)
              , p = Math.sin((1 - t) * c) / h
              , u = Math.sin(t * c) / h;
            return this._w = a * p + this._w * u,
            this._x = i * p + this._x * u,
            this._y = r * p + this._y * u,
            this._z = n * p + this._z * u,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "slerpQuaternions",
        value: function(e, t, i) {
            this.copy(e).slerp(t, i)
        }
    }, {
        key: "random",
        value: function() {
            var e = Math.random()
              , t = Math.sqrt(1 - e)
              , i = Math.sqrt(e)
              , r = 2 * Math.PI * Math.random()
              , n = 2 * Math.PI * Math.random();
            return this.set(t * Math.cos(r), i * Math.sin(n), i * Math.cos(n), t * Math.sin(r))
        }
    }, {
        key: "equals",
        value: function(e) {
            return e._x === this._x && e._y === this._y && e._z === this._z && e._w === this._w
        }
    }, {
        key: "fromArray",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this._x = e[t],
            this._y = e[t + 1],
            this._z = e[t + 2],
            this._w = e[t + 3],
            this._onChangeCallback(),
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this._x,
            e[t + 1] = this._y,
            e[t + 2] = this._z,
            e[t + 3] = this._w,
            e
        }
    }, {
        key: "fromBufferAttribute",
        value: function(e, t) {
            return this._x = e.getX(t),
            this._y = e.getY(t),
            this._z = e.getZ(t),
            this._w = e.getW(t),
            this
        }
    }, {
        key: "_onChange",
        value: function(e) {
            return this._onChangeCallback = e,
            this
        }
    }, {
        key: "_onChangeCallback",
        value: function() {}
    }], [{
        key: "slerp",
        value: function(e, t, i, r) {
            return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),
            i.slerpQuaternions(e, t, r)
        }
    }, {
        key: "slerpFlat",
        value: function(e, t, i, r, n, a, o) {
            var s = i[r + 0]
              , l = i[r + 1]
              , h = i[r + 2]
              , c = i[r + 3]
              , p = n[a + 0]
              , u = n[a + 1]
              , d = n[a + 2]
              , f = n[a + 3];
            if (0 === o)
                return e[t + 0] = s,
                e[t + 1] = l,
                e[t + 2] = h,
                void (e[t + 3] = c);
            if (1 === o)
                return e[t + 0] = p,
                e[t + 1] = u,
                e[t + 2] = d,
                void (e[t + 3] = f);
            if (c !== f || s !== p || l !== u || h !== d) {
                var m = 1 - o
                  , g = s * p + l * u + h * d + c * f
                  , v = g >= 0 ? 1 : -1
                  , y = 1 - g * g;
                if (y > Number.EPSILON) {
                    var _ = Math.sqrt(y)
                      , b = Math.atan2(_, g * v);
                    m = Math.sin(m * b) / _,
                    o = Math.sin(o * b) / _
                }
                var x = o * v;
                if (s = s * m + p * x,
                l = l * m + u * x,
                h = h * m + d * x,
                c = c * m + f * x,
                m === 1 - o) {
                    var w = 1 / Math.sqrt(s * s + l * l + h * h + c * c);
                    s *= w,
                    l *= w,
                    h *= w,
                    c *= w
                }
            }
            e[t] = s,
            e[t + 1] = l,
            e[t + 2] = h,
            e[t + 3] = c
        }
    }, {
        key: "multiplyQuaternionsFlat",
        value: function(e, t, i, r, n, a) {
            var o = i[r]
              , s = i[r + 1]
              , l = i[r + 2]
              , h = i[r + 3]
              , c = n[a]
              , p = n[a + 1]
              , u = n[a + 2]
              , d = n[a + 3];
            return e[t] = o * d + h * c + s * u - l * p,
            e[t + 1] = s * d + h * p + l * c - o * u,
            e[t + 2] = l * d + h * u + o * p - s * c,
            e[t + 3] = h * d - o * c - s * p - l * u,
            e
        }
    }]),
    e
}();
Quaternion.prototype.isQuaternion = !0;
var Vector3 = function(e) {
    function t() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
        _classCallCheck2(this, t),
        this.x = e,
        this.y = i,
        this.z = r
    }
    return _createClass2(t, [{
        key: "set",
        value: function(e, t, i) {
            return void 0 === i && (i = this.z),
            this.x = e,
            this.y = t,
            this.z = i,
            this
        }
    }, {
        key: "setScalar",
        value: function(e) {
            return this.x = e,
            this.y = e,
            this.z = e,
            this
        }
    }, {
        key: "setX",
        value: function(e) {
            return this.x = e,
            this
        }
    }, {
        key: "setY",
        value: function(e) {
            return this.y = e,
            this
        }
    }, {
        key: "setZ",
        value: function(e) {
            return this.z = e,
            this
        }
    }, {
        key: "setComponent",
        value: function(e, t) {
            switch (e) {
            case 0:
                this.x = t;
                break;
            case 1:
                this.y = t;
                break;
            case 2:
                this.z = t;
                break;
            default:
                throw new Error("index is out of range: " + e)
            }
            return this
        }
    }, {
        key: "getComponent",
        value: function(e) {
            switch (e) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            case 2:
                return this.z;
            default:
                throw new Error("index is out of range: " + e)
            }
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this.x,this.y,this.z)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.x = e.x,
            this.y = e.y,
            this.z = e.z,
            this
        }
    }, {
        key: "add",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
            this.addVectors(e, t)) : (this.x += e.x,
            this.y += e.y,
            this.z += e.z,
            this)
        }
    }, {
        key: "addScalar",
        value: function(e) {
            return this.x += e,
            this.y += e,
            this.z += e,
            this
        }
    }, {
        key: "addVectors",
        value: function(e, t) {
            return this.x = e.x + t.x,
            this.y = e.y + t.y,
            this.z = e.z + t.z,
            this
        }
    }, {
        key: "addScaledVector",
        value: function(e, t) {
            return this.x += e.x * t,
            this.y += e.y * t,
            this.z += e.z * t,
            this
        }
    }, {
        key: "sub",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
            this.subVectors(e, t)) : (this.x -= e.x,
            this.y -= e.y,
            this.z -= e.z,
            this)
        }
    }, {
        key: "subScalar",
        value: function(e) {
            return this.x -= e,
            this.y -= e,
            this.z -= e,
            this
        }
    }, {
        key: "subVectors",
        value: function(e, t) {
            return this.x = e.x - t.x,
            this.y = e.y - t.y,
            this.z = e.z - t.z,
            this
        }
    }, {
        key: "multiply",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
            this.multiplyVectors(e, t)) : (this.x *= e.x,
            this.y *= e.y,
            this.z *= e.z,
            this)
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            return this.x *= e,
            this.y *= e,
            this.z *= e,
            this
        }
    }, {
        key: "multiplyVectors",
        value: function(e, t) {
            return this.x = e.x * t.x,
            this.y = e.y * t.y,
            this.z = e.z * t.z,
            this
        }
    }, {
        key: "applyEuler",
        value: function(e) {
            return e && e.isEuler || console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),
            this.applyQuaternion(_quaternion$4.setFromEuler(e))
        }
    }, {
        key: "applyAxisAngle",
        value: function(e, t) {
            return this.applyQuaternion(_quaternion$4.setFromAxisAngle(e, t))
        }
    }, {
        key: "applyMatrix3",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = this.z
              , n = e.elements;
            return this.x = n[0] * t + n[3] * i + n[6] * r,
            this.y = n[1] * t + n[4] * i + n[7] * r,
            this.z = n[2] * t + n[5] * i + n[8] * r,
            this
        }
    }, {
        key: "applyNormalMatrix",
        value: function(e) {
            return this.applyMatrix3(e).normalize()
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = this.z
              , n = e.elements
              , a = 1 / (n[3] * t + n[7] * i + n[11] * r + n[15]);
            return this.x = (n[0] * t + n[4] * i + n[8] * r + n[12]) * a,
            this.y = (n[1] * t + n[5] * i + n[9] * r + n[13]) * a,
            this.z = (n[2] * t + n[6] * i + n[10] * r + n[14]) * a,
            this
        }
    }, {
        key: "applyQuaternion",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = this.z
              , n = e.x
              , a = e.y
              , o = e.z
              , s = e.w
              , l = s * t + a * r - o * i
              , h = s * i + o * t - n * r
              , c = s * r + n * i - a * t
              , p = -n * t - a * i - o * r;
            return this.x = l * s + p * -n + h * -o - c * -a,
            this.y = h * s + p * -a + c * -n - l * -o,
            this.z = c * s + p * -o + l * -a - h * -n,
            this
        }
    }, {
        key: "project",
        value: function(e) {
            return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)
        }
    }, {
        key: "unproject",
        value: function(e) {
            return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)
        }
    }, {
        key: "transformDirection",
        value: function(e) {
            var t = this.x
              , i = this.y
              , r = this.z
              , n = e.elements;
            return this.x = n[0] * t + n[4] * i + n[8] * r,
            this.y = n[1] * t + n[5] * i + n[9] * r,
            this.z = n[2] * t + n[6] * i + n[10] * r,
            this.normalize()
        }
    }, {
        key: "divide",
        value: function(e) {
            return this.x /= e.x,
            this.y /= e.y,
            this.z /= e.z,
            this
        }
    }, {
        key: "divideScalar",
        value: function(e) {
            return this.multiplyScalar(1 / e)
        }
    }, {
        key: "min",
        value: function(e) {
            return this.x = Math.min(this.x, e.x),
            this.y = Math.min(this.y, e.y),
            this.z = Math.min(this.z, e.z),
            this
        }
    }, {
        key: "max",
        value: function(e) {
            return this.x = Math.max(this.x, e.x),
            this.y = Math.max(this.y, e.y),
            this.z = Math.max(this.z, e.z),
            this
        }
    }, {
        key: "clamp",
        value: function(e, t) {
            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
            this.y = Math.max(e.y, Math.min(t.y, this.y)),
            this.z = Math.max(e.z, Math.min(t.z, this.z)),
            this
        }
    }, {
        key: "clampScalar",
        value: function(e, t) {
            return this.x = Math.max(e, Math.min(t, this.x)),
            this.y = Math.max(e, Math.min(t, this.y)),
            this.z = Math.max(e, Math.min(t, this.z)),
            this
        }
    }, {
        key: "clampLength",
        value: function(e, t) {
            var i = this.length();
            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
        }
    }, {
        key: "floor",
        value: function() {
            return this.x = Math.floor(this.x),
            this.y = Math.floor(this.y),
            this.z = Math.floor(this.z),
            this
        }
    }, {
        key: "ceil",
        value: function() {
            return this.x = Math.ceil(this.x),
            this.y = Math.ceil(this.y),
            this.z = Math.ceil(this.z),
            this
        }
    }, {
        key: "round",
        value: function() {
            return this.x = Math.round(this.x),
            this.y = Math.round(this.y),
            this.z = Math.round(this.z),
            this
        }
    }, {
        key: "roundToZero",
        value: function() {
            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
            this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z),
            this
        }
    }, {
        key: "negate",
        value: function() {
            return this.x = -this.x,
            this.y = -this.y,
            this.z = -this.z,
            this
        }
    }, {
        key: "dot",
        value: function(e) {
            return this.x * e.x + this.y * e.y + this.z * e.z
        }
    }, {
        key: "lengthSq",
        value: function() {
            return this.x * this.x + this.y * this.y + this.z * this.z
        }
    }, {
        key: "length",
        value: function() {
            return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
        }
    }, {
        key: "manhattanLength",
        value: function() {
            return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
        }
    }, {
        key: "normalize",
        value: function() {
            return this.divideScalar(this.length() || 1)
        }
    }, {
        key: "setLength",
        value: function(e) {
            return this.normalize().multiplyScalar(e)
        }
    }, {
        key: "lerp",
        value: function(e, t) {
            return this.x += (e.x - this.x) * t,
            this.y += (e.y - this.y) * t,
            this.z += (e.z - this.z) * t,
            this
        }
    }, {
        key: "lerpVectors",
        value: function(e, t, i) {
            return this.x = e.x + (t.x - e.x) * i,
            this.y = e.y + (t.y - e.y) * i,
            this.z = e.z + (t.z - e.z) * i,
            this
        }
    }, {
        key: "cross",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
            this.crossVectors(e, t)) : this.crossVectors(this, e)
        }
    }, {
        key: "crossVectors",
        value: function(e, t) {
            var i = e.x
              , r = e.y
              , n = e.z
              , a = t.x
              , o = t.y
              , s = t.z;
            return this.x = r * s - n * o,
            this.y = n * a - i * s,
            this.z = i * o - r * a,
            this
        }
    }, {
        key: "projectOnVector",
        value: function(e) {
            var t = e.lengthSq();
            if (0 === t)
                return this.set(0, 0, 0);
            var i = e.dot(this) / t;
            return this.copy(e).multiplyScalar(i)
        }
    }, {
        key: "projectOnPlane",
        value: function(e) {
            return _vector$c.copy(this).projectOnVector(e),
            this.sub(_vector$c)
        }
    }, {
        key: "reflect",
        value: function(e) {
            return this.sub(_vector$c.copy(e).multiplyScalar(2 * this.dot(e)))
        }
    }, {
        key: "angleTo",
        value: function(e) {
            var t = Math.sqrt(this.lengthSq() * e.lengthSq());
            if (0 === t)
                return Math.PI / 2;
            var i = this.dot(e) / t;
            return Math.acos(clamp(i, -1, 1))
        }
    }, {
        key: "distanceTo",
        value: function(e) {
            return Math.sqrt(this.distanceToSquared(e))
        }
    }, {
        key: "distanceToSquared",
        value: function(e) {
            var t = this.x - e.x
              , i = this.y - e.y
              , r = this.z - e.z;
            return t * t + i * i + r * r
        }
    }, {
        key: "manhattanDistanceTo",
        value: function(e) {
            return Math.abs(this.x - e.x) + Math.abs(this.y - e.y) + Math.abs(this.z - e.z)
        }
    }, {
        key: "setFromSpherical",
        value: function(e) {
            return this.setFromSphericalCoords(e.radius, e.phi, e.theta)
        }
    }, {
        key: "setFromSphericalCoords",
        value: function(e, t, i) {
            var r = Math.sin(t) * e;
            return this.x = r * Math.sin(i),
            this.y = Math.cos(t) * e,
            this.z = r * Math.cos(i),
            this
        }
    }, {
        key: "setFromCylindrical",
        value: function(e) {
            return this.setFromCylindricalCoords(e.radius, e.theta, e.y)
        }
    }, {
        key: "setFromCylindricalCoords",
        value: function(e, t, i) {
            return this.x = e * Math.sin(t),
            this.y = i,
            this.z = e * Math.cos(t),
            this
        }
    }, {
        key: "setFromMatrixPosition",
        value: function(e) {
            var t = e.elements;
            return this.x = t[12],
            this.y = t[13],
            this.z = t[14],
            this
        }
    }, {
        key: "setFromMatrixScale",
        value: function(e) {
            var t = this.setFromMatrixColumn(e, 0).length()
              , i = this.setFromMatrixColumn(e, 1).length()
              , r = this.setFromMatrixColumn(e, 2).length();
            return this.x = t,
            this.y = i,
            this.z = r,
            this
        }
    }, {
        key: "setFromMatrixColumn",
        value: function(e, t) {
            return this.fromArray(e.elements, 4 * t)
        }
    }, {
        key: "setFromMatrix3Column",
        value: function(e, t) {
            return this.fromArray(e.elements, 3 * t)
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.x === this.x && e.y === this.y && e.z === this.z
        }
    }, {
        key: "fromArray",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.x = e[t],
            this.y = e[t + 1],
            this.z = e[t + 2],
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this.x,
            e[t + 1] = this.y,
            e[t + 2] = this.z,
            e
        }
    }, {
        key: "fromBufferAttribute",
        value: function(e, t, i) {
            return void 0 !== i && console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),
            this.x = e.getX(t),
            this.y = e.getY(t),
            this.z = e.getZ(t),
            this
        }
    }, {
        key: "random",
        value: function() {
            return this.x = Math.random(),
            this.y = Math.random(),
            this.z = Math.random(),
            this
        }
    }, {
        key: "randomDirection",
        value: function() {
            var e = 2 * (Math.random() - .5)
              , t = Math.random() * Math.PI * 2
              , i = Math.sqrt(1 - Math.pow(e, 2));
            return this.x = i * Math.cos(t),
            this.y = i * Math.sin(t),
            this.z = e,
            this
        }
    }, {
        key: Symbol.iterator,
        value: _regeneratorRuntime().mark((function e() {
            return _regeneratorRuntime().wrap((function(e) {
                for (; ; )
                    switch (e.prev = e.next) {
                    case 0:
                        return e.next = 2,
                        this.x;
                    case 2:
                        return e.next = 4,
                        this.y;
                    case 4:
                        return e.next = 6,
                        this.z;
                    case 6:
                    case "end":
                        return e.stop()
                    }
            }
            ), e, this)
        }
        ))
    }]),
    t
}();
Vector3.prototype.isVector3 = !0;
var _vector$c = new Vector3
  , _quaternion$4 = new Quaternion
  , Box3 = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3(1 / 0,1 / 0,1 / 0)
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3(-1 / 0,-1 / 0,-1 / 0);
        _classCallCheck2(this, e),
        this.min = t,
        this.max = i
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t) {
            return this.min.copy(e),
            this.max.copy(t),
            this
        }
    }, {
        key: "setFromArray",
        value: function(e) {
            for (var t = 1 / 0, i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, l = e.length; s < l; s += 3) {
                var h = e[s]
                  , c = e[s + 1]
                  , p = e[s + 2];
                h < t && (t = h),
                c < i && (i = c),
                p < r && (r = p),
                h > n && (n = h),
                c > a && (a = c),
                p > o && (o = p)
            }
            return this.min.set(t, i, r),
            this.max.set(n, a, o),
            this
        }
    }, {
        key: "setFromBufferAttribute",
        value: function(e) {
            for (var t = 1 / 0, i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, l = e.count; s < l; s++) {
                var h = e.getX(s)
                  , c = e.getY(s)
                  , p = e.getZ(s);
                h < t && (t = h),
                c < i && (i = c),
                p < r && (r = p),
                h > n && (n = h),
                c > a && (a = c),
                p > o && (o = p)
            }
            return this.min.set(t, i, r),
            this.max.set(n, a, o),
            this
        }
    }, {
        key: "setFromPoints",
        value: function(e) {
            this.makeEmpty();
            for (var t = 0, i = e.length; t < i; t++)
                this.expandByPoint(e[t]);
            return this
        }
    }, {
        key: "setFromCenterAndSize",
        value: function(e, t) {
            var i = _vector$b.copy(t).multiplyScalar(.5);
            return this.min.copy(e).sub(i),
            this.max.copy(e).add(i),
            this
        }
    }, {
        key: "setFromObject",
        value: function(e) {
            return this.makeEmpty(),
            this.expandByObject(e)
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.min.copy(e.min),
            this.max.copy(e.max),
            this
        }
    }, {
        key: "makeEmpty",
        value: function() {
            return this.min.x = this.min.y = this.min.z = 1 / 0,
            this.max.x = this.max.y = this.max.z = -1 / 0,
            this
        }
    }, {
        key: "isEmpty",
        value: function() {
            return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
        }
    }, {
        key: "getCenter",
        value: function(e) {
            return this.isEmpty() ? e.set(0, 0, 0) : e.addVectors(this.min, this.max).multiplyScalar(.5)
        }
    }, {
        key: "getSize",
        value: function(e) {
            return this.isEmpty() ? e.set(0, 0, 0) : e.subVectors(this.max, this.min)
        }
    }, {
        key: "expandByPoint",
        value: function(e) {
            return this.min.min(e),
            this.max.max(e),
            this
        }
    }, {
        key: "expandByVector",
        value: function(e) {
            return this.min.sub(e),
            this.max.add(e),
            this
        }
    }, {
        key: "expandByScalar",
        value: function(e) {
            return this.min.addScalar(-e),
            this.max.addScalar(e),
            this
        }
    }, {
        key: "expandByObject",
        value: function(e) {
            e.updateWorldMatrix(!1, !1);
            var t = e.geometry;
            void 0 !== t && (null === t.boundingBox && t.computeBoundingBox(),
            _box$3.copy(t.boundingBox),
            _box$3.applyMatrix4(e.matrixWorld),
            this.union(_box$3));
            for (var i = e.children, r = 0, n = i.length; r < n; r++)
                this.expandByObject(i[r]);
            return this
        }
    }, {
        key: "containsPoint",
        value: function(e) {
            return !(e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y || e.z < this.min.z || e.z > this.max.z)
        }
    }, {
        key: "containsBox",
        value: function(e) {
            return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y && this.min.z <= e.min.z && e.max.z <= this.max.z
        }
    }, {
        key: "getParameter",
        value: function(e, t) {
            return t.set((e.x - this.min.x) / (this.max.x - this.min.x), (e.y - this.min.y) / (this.max.y - this.min.y), (e.z - this.min.z) / (this.max.z - this.min.z))
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            return !(e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y || e.max.z < this.min.z || e.min.z > this.max.z)
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            return this.clampPoint(e.center, _vector$b),
            _vector$b.distanceToSquared(e.center) <= e.radius * e.radius
        }
    }, {
        key: "intersectsPlane",
        value: function(e) {
            var t, i;
            return e.normal.x > 0 ? (t = e.normal.x * this.min.x,
            i = e.normal.x * this.max.x) : (t = e.normal.x * this.max.x,
            i = e.normal.x * this.min.x),
            e.normal.y > 0 ? (t += e.normal.y * this.min.y,
            i += e.normal.y * this.max.y) : (t += e.normal.y * this.max.y,
            i += e.normal.y * this.min.y),
            e.normal.z > 0 ? (t += e.normal.z * this.min.z,
            i += e.normal.z * this.max.z) : (t += e.normal.z * this.max.z,
            i += e.normal.z * this.min.z),
            t <= -e.constant && i >= -e.constant
        }
    }, {
        key: "intersectsTriangle",
        value: function(e) {
            if (this.isEmpty())
                return !1;
            this.getCenter(_center),
            _extents.subVectors(this.max, _center),
            _v0$2.subVectors(e.a, _center),
            _v1$7.subVectors(e.b, _center),
            _v2$3$1.subVectors(e.c, _center),
            _f0.subVectors(_v1$7, _v0$2),
            _f1.subVectors(_v2$3$1, _v1$7),
            _f2.subVectors(_v0$2, _v2$3$1);
            var t = [0, -_f0.z, _f0.y, 0, -_f1.z, _f1.y, 0, -_f2.z, _f2.y, _f0.z, 0, -_f0.x, _f1.z, 0, -_f1.x, _f2.z, 0, -_f2.x, -_f0.y, _f0.x, 0, -_f1.y, _f1.x, 0, -_f2.y, _f2.x, 0];
            return !!satForAxes(t, _v0$2, _v1$7, _v2$3$1, _extents) && !!satForAxes(t = [1, 0, 0, 0, 1, 0, 0, 0, 1], _v0$2, _v1$7, _v2$3$1, _extents) && (_triangleNormal.crossVectors(_f0, _f1),
            satForAxes(t = [_triangleNormal.x, _triangleNormal.y, _triangleNormal.z], _v0$2, _v1$7, _v2$3$1, _extents))
        }
    }, {
        key: "clampPoint",
        value: function(e, t) {
            return t.copy(e).clamp(this.min, this.max)
        }
    }, {
        key: "distanceToPoint",
        value: function(e) {
            return _vector$b.copy(e).clamp(this.min, this.max).sub(e).length()
        }
    }, {
        key: "getBoundingSphere",
        value: function(e) {
            return this.getCenter(e.center),
            e.radius = .5 * this.getSize(_vector$b).length(),
            e
        }
    }, {
        key: "intersect",
        value: function(e) {
            return this.min.max(e.min),
            this.max.min(e.max),
            this.isEmpty() && this.makeEmpty(),
            this
        }
    }, {
        key: "union",
        value: function(e) {
            return this.min.min(e.min),
            this.max.max(e.max),
            this
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            return this.isEmpty() || (_points[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(e),
            _points[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(e),
            _points[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(e),
            _points[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(e),
            _points[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(e),
            _points[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(e),
            _points[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(e),
            _points[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(e),
            this.setFromPoints(_points)),
            this
        }
    }, {
        key: "translate",
        value: function(e) {
            return this.min.add(e),
            this.max.add(e),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.min.equals(this.min) && e.max.equals(this.max)
        }
    }]),
    e
}();
Box3.prototype.isBox3 = !0;
var _points = [new Vector3, new Vector3, new Vector3, new Vector3, new Vector3, new Vector3, new Vector3, new Vector3]
  , _vector$b = new Vector3
  , _box$3 = new Box3
  , _v0$2 = new Vector3
  , _v1$7 = new Vector3
  , _v2$3$1 = new Vector3
  , _f0 = new Vector3
  , _f1 = new Vector3
  , _f2 = new Vector3
  , _center = new Vector3
  , _extents = new Vector3
  , _triangleNormal = new Vector3
  , _testAxis = new Vector3;
function satForAxes(e, t, i, r, n) {
    for (var a = 0, o = e.length - 3; a <= o; a += 3) {
        _testAxis.fromArray(e, a);
        var s = n.x * Math.abs(_testAxis.x) + n.y * Math.abs(_testAxis.y) + n.z * Math.abs(_testAxis.z)
          , l = t.dot(_testAxis)
          , h = i.dot(_testAxis)
          , c = r.dot(_testAxis);
        if (Math.max(-Math.max(l, h, c), Math.min(l, h, c)) > s)
            return !1
    }
    return !0
}
var _box$2 = new Box3
  , _v1$6 = new Vector3
  , _toFarthestPoint = new Vector3
  , _toPoint = new Vector3
  , Sphere = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : -1;
        _classCallCheck2(this, e),
        this.center = t,
        this.radius = i
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t) {
            return this.center.copy(e),
            this.radius = t,
            this
        }
    }, {
        key: "setFromPoints",
        value: function(e, t) {
            var i = this.center;
            void 0 !== t ? i.copy(t) : _box$2.setFromPoints(e).getCenter(i);
            for (var r = 0, n = 0, a = e.length; n < a; n++)
                r = Math.max(r, i.distanceToSquared(e[n]));
            return this.radius = Math.sqrt(r),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.center.copy(e.center),
            this.radius = e.radius,
            this
        }
    }, {
        key: "isEmpty",
        value: function() {
            return this.radius < 0
        }
    }, {
        key: "makeEmpty",
        value: function() {
            return this.center.set(0, 0, 0),
            this.radius = -1,
            this
        }
    }, {
        key: "containsPoint",
        value: function(e) {
            return e.distanceToSquared(this.center) <= this.radius * this.radius
        }
    }, {
        key: "distanceToPoint",
        value: function(e) {
            return e.distanceTo(this.center) - this.radius
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            var t = this.radius + e.radius;
            return e.center.distanceToSquared(this.center) <= t * t
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            return e.intersectsSphere(this)
        }
    }, {
        key: "intersectsPlane",
        value: function(e) {
            return Math.abs(e.distanceToPoint(this.center)) <= this.radius
        }
    }, {
        key: "clampPoint",
        value: function(e, t) {
            var i = this.center.distanceToSquared(e);
            return t.copy(e),
            i > this.radius * this.radius && (t.sub(this.center).normalize(),
            t.multiplyScalar(this.radius).add(this.center)),
            t
        }
    }, {
        key: "getBoundingBox",
        value: function(e) {
            return this.isEmpty() ? (e.makeEmpty(),
            e) : (e.set(this.center, this.center),
            e.expandByScalar(this.radius),
            e)
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            return this.center.applyMatrix4(e),
            this.radius = this.radius * e.getMaxScaleOnAxis(),
            this
        }
    }, {
        key: "translate",
        value: function(e) {
            return this.center.add(e),
            this
        }
    }, {
        key: "expandByPoint",
        value: function(e) {
            _toPoint.subVectors(e, this.center);
            var t = _toPoint.lengthSq();
            if (t > this.radius * this.radius) {
                var i = Math.sqrt(t)
                  , r = .5 * (i - this.radius);
                this.center.add(_toPoint.multiplyScalar(r / i)),
                this.radius += r
            }
            return this
        }
    }, {
        key: "union",
        value: function(e) {
            return _toFarthestPoint.subVectors(e.center, this.center).normalize().multiplyScalar(e.radius),
            this.expandByPoint(_v1$6.copy(e.center).add(_toFarthestPoint)),
            this.expandByPoint(_v1$6.copy(e.center).sub(_toFarthestPoint)),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.center.equals(this.center) && e.radius === this.radius
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    e
}()
  , _vector$a = new Vector3
  , _segCenter = new Vector3
  , _segDir = new Vector3
  , _diff = new Vector3
  , _edge1 = new Vector3
  , _edge2 = new Vector3
  , _normal$1 = new Vector3
  , Ray = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3(0,0,-1);
        _classCallCheck2(this, e),
        this.origin = t,
        this.direction = i
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t) {
            return this.origin.copy(e),
            this.direction.copy(t),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.origin.copy(e.origin),
            this.direction.copy(e.direction),
            this
        }
    }, {
        key: "at",
        value: function(e, t) {
            return t.copy(this.direction).multiplyScalar(e).add(this.origin)
        }
    }, {
        key: "lookAt",
        value: function(e) {
            return this.direction.copy(e).sub(this.origin).normalize(),
            this
        }
    }, {
        key: "recast",
        value: function(e) {
            return this.origin.copy(this.at(e, _vector$a)),
            this
        }
    }, {
        key: "closestPointToPoint",
        value: function(e, t) {
            t.subVectors(e, this.origin);
            var i = t.dot(this.direction);
            return i < 0 ? t.copy(this.origin) : t.copy(this.direction).multiplyScalar(i).add(this.origin)
        }
    }, {
        key: "distanceToPoint",
        value: function(e) {
            return Math.sqrt(this.distanceSqToPoint(e))
        }
    }, {
        key: "distanceSqToPoint",
        value: function(e) {
            var t = _vector$a.subVectors(e, this.origin).dot(this.direction);
            return t < 0 ? this.origin.distanceToSquared(e) : (_vector$a.copy(this.direction).multiplyScalar(t).add(this.origin),
            _vector$a.distanceToSquared(e))
        }
    }, {
        key: "distanceSqToSegment",
        value: function(e, t, i, r) {
            _segCenter.copy(e).add(t).multiplyScalar(.5),
            _segDir.copy(t).sub(e).normalize(),
            _diff.copy(this.origin).sub(_segCenter);
            var n, a, o, s, l = .5 * e.distanceTo(t), h = -this.direction.dot(_segDir), c = _diff.dot(this.direction), p = -_diff.dot(_segDir), u = _diff.lengthSq(), d = Math.abs(1 - h * h);
            if (d > 0)
                if (a = h * c - p,
                s = l * d,
                (n = h * p - c) >= 0)
                    if (a >= -s)
                        if (a <= s) {
                            var f = 1 / d;
                            o = (n *= f) * (n + h * (a *= f) + 2 * c) + a * (h * n + a + 2 * p) + u
                        } else
                            a = l,
                            o = -(n = Math.max(0, -(h * a + c))) * n + a * (a + 2 * p) + u;
                    else
                        a = -l,
                        o = -(n = Math.max(0, -(h * a + c))) * n + a * (a + 2 * p) + u;
                else
                    a <= -s ? o = -(n = Math.max(0, -(-h * l + c))) * n + (a = n > 0 ? -l : Math.min(Math.max(-l, -p), l)) * (a + 2 * p) + u : a <= s ? (n = 0,
                    o = (a = Math.min(Math.max(-l, -p), l)) * (a + 2 * p) + u) : o = -(n = Math.max(0, -(h * l + c))) * n + (a = n > 0 ? l : Math.min(Math.max(-l, -p), l)) * (a + 2 * p) + u;
            else
                a = h > 0 ? -l : l,
                o = -(n = Math.max(0, -(h * a + c))) * n + a * (a + 2 * p) + u;
            return i && i.copy(this.direction).multiplyScalar(n).add(this.origin),
            r && r.copy(_segDir).multiplyScalar(a).add(_segCenter),
            o
        }
    }, {
        key: "intersectSphere",
        value: function(e, t) {
            _vector$a.subVectors(e.center, this.origin);
            var i = _vector$a.dot(this.direction)
              , r = _vector$a.dot(_vector$a) - i * i
              , n = e.radius * e.radius;
            if (r > n)
                return null;
            var a = Math.sqrt(n - r)
              , o = i - a
              , s = i + a;
            return o < 0 && s < 0 ? null : o < 0 ? this.at(s, t) : this.at(o, t)
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            return this.distanceSqToPoint(e.center) <= e.radius * e.radius
        }
    }, {
        key: "distanceToPlane",
        value: function(e) {
            var t = e.normal.dot(this.direction);
            if (0 === t)
                return 0 === e.distanceToPoint(this.origin) ? 0 : null;
            var i = -(this.origin.dot(e.normal) + e.constant) / t;
            return i >= 0 ? i : null
        }
    }, {
        key: "intersectPlane",
        value: function(e, t) {
            var i = this.distanceToPlane(e);
            return null === i ? null : this.at(i, t)
        }
    }, {
        key: "intersectsPlane",
        value: function(e) {
            var t = e.distanceToPoint(this.origin);
            return 0 === t || e.normal.dot(this.direction) * t < 0
        }
    }, {
        key: "intersectBox",
        value: function(e, t) {
            var i, r, n, a, o, s, l = 1 / this.direction.x, h = 1 / this.direction.y, c = 1 / this.direction.z, p = this.origin;
            return l >= 0 ? (i = (e.min.x - p.x) * l,
            r = (e.max.x - p.x) * l) : (i = (e.max.x - p.x) * l,
            r = (e.min.x - p.x) * l),
            h >= 0 ? (n = (e.min.y - p.y) * h,
            a = (e.max.y - p.y) * h) : (n = (e.max.y - p.y) * h,
            a = (e.min.y - p.y) * h),
            i > a || n > r ? null : ((n > i || i != i) && (i = n),
            (a < r || r != r) && (r = a),
            c >= 0 ? (o = (e.min.z - p.z) * c,
            s = (e.max.z - p.z) * c) : (o = (e.max.z - p.z) * c,
            s = (e.min.z - p.z) * c),
            i > s || o > r ? null : ((o > i || i != i) && (i = o),
            (s < r || r != r) && (r = s),
            r < 0 ? null : this.at(i >= 0 ? i : r, t)))
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            return null !== this.intersectBox(e, _vector$a)
        }
    }, {
        key: "intersectTriangle",
        value: function(e, t, i, r, n) {
            _edge1.subVectors(t, e),
            _edge2.subVectors(i, e),
            _normal$1.crossVectors(_edge1, _edge2);
            var a, o = this.direction.dot(_normal$1);
            if (o > 0) {
                if (r)
                    return null;
                a = 1
            } else {
                if (!(o < 0))
                    return null;
                a = -1,
                o = -o
            }
            _diff.subVectors(this.origin, e);
            var s = a * this.direction.dot(_edge2.crossVectors(_diff, _edge2));
            if (s < 0)
                return null;
            var l = a * this.direction.dot(_edge1.cross(_diff));
            if (l < 0)
                return null;
            if (s + l > o)
                return null;
            var h = -a * _diff.dot(_normal$1);
            return h < 0 ? null : this.at(h / o, n)
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            return this.origin.applyMatrix4(e),
            this.direction.transformDirection(e),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.origin.equals(this.origin) && e.direction.equals(this.direction)
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    e
}()
  , Matrix4 = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
        arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i, r, n, a, o, s, l, h, c, p, u, d, f, m) {
            var g = this.elements;
            return g[0] = e,
            g[4] = t,
            g[8] = i,
            g[12] = r,
            g[1] = n,
            g[5] = a,
            g[9] = o,
            g[13] = s,
            g[2] = l,
            g[6] = h,
            g[10] = c,
            g[14] = p,
            g[3] = u,
            g[7] = d,
            g[11] = f,
            g[15] = m,
            this
        }
    }, {
        key: "identity",
        value: function() {
            return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new e).fromArray(this.elements)
        }
    }, {
        key: "copy",
        value: function(e) {
            var t = this.elements
              , i = e.elements;
            return t[0] = i[0],
            t[1] = i[1],
            t[2] = i[2],
            t[3] = i[3],
            t[4] = i[4],
            t[5] = i[5],
            t[6] = i[6],
            t[7] = i[7],
            t[8] = i[8],
            t[9] = i[9],
            t[10] = i[10],
            t[11] = i[11],
            t[12] = i[12],
            t[13] = i[13],
            t[14] = i[14],
            t[15] = i[15],
            this
        }
    }, {
        key: "copyPosition",
        value: function(e) {
            var t = this.elements
              , i = e.elements;
            return t[12] = i[12],
            t[13] = i[13],
            t[14] = i[14],
            this
        }
    }, {
        key: "setFromMatrix3",
        value: function(e) {
            var t = e.elements;
            return this.set(t[0], t[3], t[6], 0, t[1], t[4], t[7], 0, t[2], t[5], t[8], 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "extractBasis",
        value: function(e, t, i) {
            return e.setFromMatrixColumn(this, 0),
            t.setFromMatrixColumn(this, 1),
            i.setFromMatrixColumn(this, 2),
            this
        }
    }, {
        key: "makeBasis",
        value: function(e, t, i) {
            return this.set(e.x, t.x, i.x, 0, e.y, t.y, i.y, 0, e.z, t.z, i.z, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "extractRotation",
        value: function(e) {
            var t = this.elements
              , i = e.elements
              , r = 1 / _v1$5$1.setFromMatrixColumn(e, 0).length()
              , n = 1 / _v1$5$1.setFromMatrixColumn(e, 1).length()
              , a = 1 / _v1$5$1.setFromMatrixColumn(e, 2).length();
            return t[0] = i[0] * r,
            t[1] = i[1] * r,
            t[2] = i[2] * r,
            t[3] = 0,
            t[4] = i[4] * n,
            t[5] = i[5] * n,
            t[6] = i[6] * n,
            t[7] = 0,
            t[8] = i[8] * a,
            t[9] = i[9] * a,
            t[10] = i[10] * a,
            t[11] = 0,
            t[12] = 0,
            t[13] = 0,
            t[14] = 0,
            t[15] = 1,
            this
        }
    }, {
        key: "makeRotationFromEuler",
        value: function(e) {
            e && e.isEuler || console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
            var t = this.elements
              , i = e.x
              , r = e.y
              , n = e.z
              , a = Math.cos(i)
              , o = Math.sin(i)
              , s = Math.cos(r)
              , l = Math.sin(r)
              , h = Math.cos(n)
              , c = Math.sin(n);
            if ("XYZ" === e.order) {
                var p = a * h
                  , u = a * c
                  , d = o * h
                  , f = o * c;
                t[0] = s * h,
                t[4] = -s * c,
                t[8] = l,
                t[1] = u + d * l,
                t[5] = p - f * l,
                t[9] = -o * s,
                t[2] = f - p * l,
                t[6] = d + u * l,
                t[10] = a * s
            } else if ("YXZ" === e.order) {
                var m = s * h
                  , g = s * c
                  , v = l * h
                  , y = l * c;
                t[0] = m + y * o,
                t[4] = v * o - g,
                t[8] = a * l,
                t[1] = a * c,
                t[5] = a * h,
                t[9] = -o,
                t[2] = g * o - v,
                t[6] = y + m * o,
                t[10] = a * s
            } else if ("ZXY" === e.order) {
                var _ = s * h
                  , b = s * c
                  , x = l * h
                  , w = l * c;
                t[0] = _ - w * o,
                t[4] = -a * c,
                t[8] = x + b * o,
                t[1] = b + x * o,
                t[5] = a * h,
                t[9] = w - _ * o,
                t[2] = -a * l,
                t[6] = o,
                t[10] = a * s
            } else if ("ZYX" === e.order) {
                var S = a * h
                  , T = a * c
                  , k = o * h
                  , E = o * c;
                t[0] = s * h,
                t[4] = k * l - T,
                t[8] = S * l + E,
                t[1] = s * c,
                t[5] = E * l + S,
                t[9] = T * l - k,
                t[2] = -l,
                t[6] = o * s,
                t[10] = a * s
            } else if ("YZX" === e.order) {
                var M = a * s
                  , P = a * l
                  , C = o * s
                  , A = o * l;
                t[0] = s * h,
                t[4] = A - M * c,
                t[8] = C * c + P,
                t[1] = c,
                t[5] = a * h,
                t[9] = -o * h,
                t[2] = -l * h,
                t[6] = P * c + C,
                t[10] = M - A * c
            } else if ("XZY" === e.order) {
                var L = a * s
                  , D = a * l
                  , I = o * s
                  , R = o * l;
                t[0] = s * h,
                t[4] = -c,
                t[8] = l * h,
                t[1] = L * c + R,
                t[5] = a * h,
                t[9] = D * c - I,
                t[2] = I * c - D,
                t[6] = o * h,
                t[10] = R * c + L
            }
            return t[3] = 0,
            t[7] = 0,
            t[11] = 0,
            t[12] = 0,
            t[13] = 0,
            t[14] = 0,
            t[15] = 1,
            this
        }
    }, {
        key: "makeRotationFromQuaternion",
        value: function(e) {
            return this.compose(_zero, e, _one)
        }
    }, {
        key: "lookAt",
        value: function(e, t, i) {
            var r = this.elements;
            return _z.subVectors(e, t),
            0 === _z.lengthSq() && (_z.z = 1),
            _z.normalize(),
            _x.crossVectors(i, _z),
            0 === _x.lengthSq() && (1 === Math.abs(i.z) ? _z.x += 1e-4 : _z.z += 1e-4,
            _z.normalize(),
            _x.crossVectors(i, _z)),
            _x.normalize(),
            _y.crossVectors(_z, _x),
            r[0] = _x.x,
            r[4] = _y.x,
            r[8] = _z.x,
            r[1] = _x.y,
            r[5] = _y.y,
            r[9] = _z.y,
            r[2] = _x.z,
            r[6] = _y.z,
            r[10] = _z.z,
            this
        }
    }, {
        key: "multiply",
        value: function(e, t) {
            return void 0 !== t ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
            this.multiplyMatrices(e, t)) : this.multiplyMatrices(this, e)
        }
    }, {
        key: "premultiply",
        value: function(e) {
            return this.multiplyMatrices(e, this)
        }
    }, {
        key: "multiplyMatrices",
        value: function(e, t) {
            var i = e.elements
              , r = t.elements
              , n = this.elements
              , a = i[0]
              , o = i[4]
              , s = i[8]
              , l = i[12]
              , h = i[1]
              , c = i[5]
              , p = i[9]
              , u = i[13]
              , d = i[2]
              , f = i[6]
              , m = i[10]
              , g = i[14]
              , v = i[3]
              , y = i[7]
              , _ = i[11]
              , b = i[15]
              , x = r[0]
              , w = r[4]
              , S = r[8]
              , T = r[12]
              , k = r[1]
              , E = r[5]
              , M = r[9]
              , P = r[13]
              , C = r[2]
              , A = r[6]
              , L = r[10]
              , D = r[14]
              , I = r[3]
              , R = r[7]
              , F = r[11]
              , B = r[15];
            return n[0] = a * x + o * k + s * C + l * I,
            n[4] = a * w + o * E + s * A + l * R,
            n[8] = a * S + o * M + s * L + l * F,
            n[12] = a * T + o * P + s * D + l * B,
            n[1] = h * x + c * k + p * C + u * I,
            n[5] = h * w + c * E + p * A + u * R,
            n[9] = h * S + c * M + p * L + u * F,
            n[13] = h * T + c * P + p * D + u * B,
            n[2] = d * x + f * k + m * C + g * I,
            n[6] = d * w + f * E + m * A + g * R,
            n[10] = d * S + f * M + m * L + g * F,
            n[14] = d * T + f * P + m * D + g * B,
            n[3] = v * x + y * k + _ * C + b * I,
            n[7] = v * w + y * E + _ * A + b * R,
            n[11] = v * S + y * M + _ * L + b * F,
            n[15] = v * T + y * P + _ * D + b * B,
            this
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            var t = this.elements;
            return t[0] *= e,
            t[4] *= e,
            t[8] *= e,
            t[12] *= e,
            t[1] *= e,
            t[5] *= e,
            t[9] *= e,
            t[13] *= e,
            t[2] *= e,
            t[6] *= e,
            t[10] *= e,
            t[14] *= e,
            t[3] *= e,
            t[7] *= e,
            t[11] *= e,
            t[15] *= e,
            this
        }
    }, {
        key: "determinant",
        value: function() {
            var e = this.elements
              , t = e[0]
              , i = e[4]
              , r = e[8]
              , n = e[12]
              , a = e[1]
              , o = e[5]
              , s = e[9]
              , l = e[13]
              , h = e[2]
              , c = e[6]
              , p = e[10]
              , u = e[14];
            return e[3] * (+n * s * c - r * l * c - n * o * p + i * l * p + r * o * u - i * s * u) + e[7] * (+t * s * u - t * l * p + n * a * p - r * a * u + r * l * h - n * s * h) + e[11] * (+t * l * c - t * o * u - n * a * c + i * a * u + n * o * h - i * l * h) + e[15] * (-r * o * h - t * s * c + t * o * p + r * a * c - i * a * p + i * s * h)
        }
    }, {
        key: "transpose",
        value: function() {
            var e, t = this.elements;
            return e = t[1],
            t[1] = t[4],
            t[4] = e,
            e = t[2],
            t[2] = t[8],
            t[8] = e,
            e = t[6],
            t[6] = t[9],
            t[9] = e,
            e = t[3],
            t[3] = t[12],
            t[12] = e,
            e = t[7],
            t[7] = t[13],
            t[13] = e,
            e = t[11],
            t[11] = t[14],
            t[14] = e,
            this
        }
    }, {
        key: "setPosition",
        value: function(e, t, i) {
            var r = this.elements;
            return e.isVector3 ? (r[12] = e.x,
            r[13] = e.y,
            r[14] = e.z) : (r[12] = e,
            r[13] = t,
            r[14] = i),
            this
        }
    }, {
        key: "invert",
        value: function() {
            var e = this.elements
              , t = e[0]
              , i = e[1]
              , r = e[2]
              , n = e[3]
              , a = e[4]
              , o = e[5]
              , s = e[6]
              , l = e[7]
              , h = e[8]
              , c = e[9]
              , p = e[10]
              , u = e[11]
              , d = e[12]
              , f = e[13]
              , m = e[14]
              , g = e[15]
              , v = c * m * l - f * p * l + f * s * u - o * m * u - c * s * g + o * p * g
              , y = d * p * l - h * m * l - d * s * u + a * m * u + h * s * g - a * p * g
              , _ = h * f * l - d * c * l + d * o * u - a * f * u - h * o * g + a * c * g
              , b = d * c * s - h * f * s - d * o * p + a * f * p + h * o * m - a * c * m
              , x = t * v + i * y + r * _ + n * b;
            if (0 === x)
                return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
            var w = 1 / x;
            return e[0] = v * w,
            e[1] = (f * p * n - c * m * n - f * r * u + i * m * u + c * r * g - i * p * g) * w,
            e[2] = (o * m * n - f * s * n + f * r * l - i * m * l - o * r * g + i * s * g) * w,
            e[3] = (c * s * n - o * p * n - c * r * l + i * p * l + o * r * u - i * s * u) * w,
            e[4] = y * w,
            e[5] = (h * m * n - d * p * n + d * r * u - t * m * u - h * r * g + t * p * g) * w,
            e[6] = (d * s * n - a * m * n - d * r * l + t * m * l + a * r * g - t * s * g) * w,
            e[7] = (a * p * n - h * s * n + h * r * l - t * p * l - a * r * u + t * s * u) * w,
            e[8] = _ * w,
            e[9] = (d * c * n - h * f * n - d * i * u + t * f * u + h * i * g - t * c * g) * w,
            e[10] = (a * f * n - d * o * n + d * i * l - t * f * l - a * i * g + t * o * g) * w,
            e[11] = (h * o * n - a * c * n - h * i * l + t * c * l + a * i * u - t * o * u) * w,
            e[12] = b * w,
            e[13] = (h * f * r - d * c * r + d * i * p - t * f * p - h * i * m + t * c * m) * w,
            e[14] = (d * o * r - a * f * r - d * i * s + t * f * s + a * i * m - t * o * m) * w,
            e[15] = (a * c * r - h * o * r + h * i * s - t * c * s - a * i * p + t * o * p) * w,
            this
        }
    }, {
        key: "scale",
        value: function(e) {
            var t = this.elements
              , i = e.x
              , r = e.y
              , n = e.z;
            return t[0] *= i,
            t[4] *= r,
            t[8] *= n,
            t[1] *= i,
            t[5] *= r,
            t[9] *= n,
            t[2] *= i,
            t[6] *= r,
            t[10] *= n,
            t[3] *= i,
            t[7] *= r,
            t[11] *= n,
            this
        }
    }, {
        key: "getMaxScaleOnAxis",
        value: function() {
            var e = this.elements
              , t = e[0] * e[0] + e[1] * e[1] + e[2] * e[2]
              , i = e[4] * e[4] + e[5] * e[5] + e[6] * e[6]
              , r = e[8] * e[8] + e[9] * e[9] + e[10] * e[10];
            return Math.sqrt(Math.max(t, i, r))
        }
    }, {
        key: "makeTranslation",
        value: function(e, t, i) {
            return this.set(1, 0, 0, e, 0, 1, 0, t, 0, 0, 1, i, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeRotationX",
        value: function(e) {
            var t = Math.cos(e)
              , i = Math.sin(e);
            return this.set(1, 0, 0, 0, 0, t, -i, 0, 0, i, t, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeRotationY",
        value: function(e) {
            var t = Math.cos(e)
              , i = Math.sin(e);
            return this.set(t, 0, i, 0, 0, 1, 0, 0, -i, 0, t, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeRotationZ",
        value: function(e) {
            var t = Math.cos(e)
              , i = Math.sin(e);
            return this.set(t, -i, 0, 0, i, t, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeRotationAxis",
        value: function(e, t) {
            var i = Math.cos(t)
              , r = Math.sin(t)
              , n = 1 - i
              , a = e.x
              , o = e.y
              , s = e.z
              , l = n * a
              , h = n * o;
            return this.set(l * a + i, l * o - r * s, l * s + r * o, 0, l * o + r * s, h * o + i, h * s - r * a, 0, l * s - r * o, h * s + r * a, n * s * s + i, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeScale",
        value: function(e, t, i) {
            return this.set(e, 0, 0, 0, 0, t, 0, 0, 0, 0, i, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "makeShear",
        value: function(e, t, i, r, n, a) {
            return this.set(1, i, n, 0, e, 1, a, 0, t, r, 1, 0, 0, 0, 0, 1),
            this
        }
    }, {
        key: "compose",
        value: function(e, t, i) {
            var r = this.elements
              , n = t._x
              , a = t._y
              , o = t._z
              , s = t._w
              , l = n + n
              , h = a + a
              , c = o + o
              , p = n * l
              , u = n * h
              , d = n * c
              , f = a * h
              , m = a * c
              , g = o * c
              , v = s * l
              , y = s * h
              , _ = s * c
              , b = i.x
              , x = i.y
              , w = i.z;
            return r[0] = (1 - (f + g)) * b,
            r[1] = (u + _) * b,
            r[2] = (d - y) * b,
            r[3] = 0,
            r[4] = (u - _) * x,
            r[5] = (1 - (p + g)) * x,
            r[6] = (m + v) * x,
            r[7] = 0,
            r[8] = (d + y) * w,
            r[9] = (m - v) * w,
            r[10] = (1 - (p + f)) * w,
            r[11] = 0,
            r[12] = e.x,
            r[13] = e.y,
            r[14] = e.z,
            r[15] = 1,
            this
        }
    }, {
        key: "decompose",
        value: function(e, t, i) {
            var r = this.elements
              , n = _v1$5$1.set(r[0], r[1], r[2]).length()
              , a = _v1$5$1.set(r[4], r[5], r[6]).length()
              , o = _v1$5$1.set(r[8], r[9], r[10]).length();
            this.determinant() < 0 && (n = -n),
            e.x = r[12],
            e.y = r[13],
            e.z = r[14],
            _m1$2.copy(this);
            var s = 1 / n
              , l = 1 / a
              , h = 1 / o;
            return _m1$2.elements[0] *= s,
            _m1$2.elements[1] *= s,
            _m1$2.elements[2] *= s,
            _m1$2.elements[4] *= l,
            _m1$2.elements[5] *= l,
            _m1$2.elements[6] *= l,
            _m1$2.elements[8] *= h,
            _m1$2.elements[9] *= h,
            _m1$2.elements[10] *= h,
            t.setFromRotationMatrix(_m1$2),
            i.x = n,
            i.y = a,
            i.z = o,
            this
        }
    }, {
        key: "makePerspective",
        value: function(e, t, i, r, n, a) {
            void 0 === a && console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
            var o = this.elements
              , s = 2 * n / (t - e)
              , l = 2 * n / (i - r)
              , h = (t + e) / (t - e)
              , c = (i + r) / (i - r)
              , p = -(a + n) / (a - n)
              , u = -2 * a * n / (a - n);
            return o[0] = s,
            o[4] = 0,
            o[8] = h,
            o[12] = 0,
            o[1] = 0,
            o[5] = l,
            o[9] = c,
            o[13] = 0,
            o[2] = 0,
            o[6] = 0,
            o[10] = p,
            o[14] = u,
            o[3] = 0,
            o[7] = 0,
            o[11] = -1,
            o[15] = 0,
            this
        }
    }, {
        key: "makeOrthographic",
        value: function(e, t, i, r, n, a) {
            var o = this.elements
              , s = 1 / (t - e)
              , l = 1 / (i - r)
              , h = 1 / (a - n)
              , c = (t + e) * s
              , p = (i + r) * l
              , u = (a + n) * h;
            return o[0] = 2 * s,
            o[4] = 0,
            o[8] = 0,
            o[12] = -c,
            o[1] = 0,
            o[5] = 2 * l,
            o[9] = 0,
            o[13] = -p,
            o[2] = 0,
            o[6] = 0,
            o[10] = -2 * h,
            o[14] = -u,
            o[3] = 0,
            o[7] = 0,
            o[11] = 0,
            o[15] = 1,
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            for (var t = this.elements, i = e.elements, r = 0; r < 16; r++)
                if (t[r] !== i[r])
                    return !1;
            return !0
        }
    }, {
        key: "fromArray",
        value: function(e) {
            for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = 0; i < 16; i++)
                this.elements[i] = e[i + t];
            return this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
              , i = this.elements;
            return e[t] = i[0],
            e[t + 1] = i[1],
            e[t + 2] = i[2],
            e[t + 3] = i[3],
            e[t + 4] = i[4],
            e[t + 5] = i[5],
            e[t + 6] = i[6],
            e[t + 7] = i[7],
            e[t + 8] = i[8],
            e[t + 9] = i[9],
            e[t + 10] = i[10],
            e[t + 11] = i[11],
            e[t + 12] = i[12],
            e[t + 13] = i[13],
            e[t + 14] = i[14],
            e[t + 15] = i[15],
            e
        }
    }]),
    e
}();
Matrix4.prototype.isMatrix4 = !0;
var _v1$5$1 = new Vector3
  , _m1$2 = new Matrix4
  , _zero = new Vector3(0,0,0)
  , _one = new Vector3(1,1,1)
  , _x = new Vector3
  , _y = new Vector3
  , _z = new Vector3
  , _matrix$1 = new Matrix4
  , _quaternion$3 = new Quaternion
  , Euler = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : e.DefaultOrder;
        _classCallCheck2(this, e),
        this._x = t,
        this._y = i,
        this._z = r,
        this._order = n
    }
    return _createClass2(e, [{
        key: "x",
        get: function() {
            return this._x
        },
        set: function(e) {
            this._x = e,
            this._onChangeCallback()
        }
    }, {
        key: "y",
        get: function() {
            return this._y
        },
        set: function(e) {
            this._y = e,
            this._onChangeCallback()
        }
    }, {
        key: "z",
        get: function() {
            return this._z
        },
        set: function(e) {
            this._z = e,
            this._onChangeCallback()
        }
    }, {
        key: "order",
        get: function() {
            return this._order
        },
        set: function(e) {
            this._order = e,
            this._onChangeCallback()
        }
    }, {
        key: "set",
        value: function(e, t, i) {
            var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : this._order;
            return this._x = e,
            this._y = t,
            this._z = i,
            this._order = r,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this._x,this._y,this._z,this._order)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this._x = e._x,
            this._y = e._y,
            this._z = e._z,
            this._order = e._order,
            this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromRotationMatrix",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this._order
              , i = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2]
              , r = e.elements
              , n = r[0]
              , a = r[4]
              , o = r[8]
              , s = r[1]
              , l = r[5]
              , h = r[9]
              , c = r[2]
              , p = r[6]
              , u = r[10];
            switch (t) {
            case "XYZ":
                this._y = Math.asin(clamp(o, -1, 1)),
                Math.abs(o) < .9999999 ? (this._x = Math.atan2(-h, u),
                this._z = Math.atan2(-a, n)) : (this._x = Math.atan2(p, l),
                this._z = 0);
                break;
            case "YXZ":
                this._x = Math.asin(-clamp(h, -1, 1)),
                Math.abs(h) < .9999999 ? (this._y = Math.atan2(o, u),
                this._z = Math.atan2(s, l)) : (this._y = Math.atan2(-c, n),
                this._z = 0);
                break;
            case "ZXY":
                this._x = Math.asin(clamp(p, -1, 1)),
                Math.abs(p) < .9999999 ? (this._y = Math.atan2(-c, u),
                this._z = Math.atan2(-a, l)) : (this._y = 0,
                this._z = Math.atan2(s, n));
                break;
            case "ZYX":
                this._y = Math.asin(-clamp(c, -1, 1)),
                Math.abs(c) < .9999999 ? (this._x = Math.atan2(p, u),
                this._z = Math.atan2(s, n)) : (this._x = 0,
                this._z = Math.atan2(-a, l));
                break;
            case "YZX":
                this._z = Math.asin(clamp(s, -1, 1)),
                Math.abs(s) < .9999999 ? (this._x = Math.atan2(-h, l),
                this._y = Math.atan2(-c, n)) : (this._x = 0,
                this._y = Math.atan2(o, u));
                break;
            case "XZY":
                this._z = Math.asin(-clamp(a, -1, 1)),
                Math.abs(a) < .9999999 ? (this._x = Math.atan2(p, l),
                this._y = Math.atan2(o, n)) : (this._x = Math.atan2(-h, u),
                this._y = 0);
                break;
            default:
                console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: " + t)
            }
            return this._order = t,
            !0 === i && this._onChangeCallback(),
            this
        }
    }, {
        key: "setFromQuaternion",
        value: function(e, t, i) {
            return _matrix$1.makeRotationFromQuaternion(e),
            this.setFromRotationMatrix(_matrix$1, t, i)
        }
    }, {
        key: "setFromVector3",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this._order;
            return this.set(e.x, e.y, e.z, t)
        }
    }, {
        key: "reorder",
        value: function(e) {
            return _quaternion$3.setFromEuler(this),
            this.setFromQuaternion(_quaternion$3, e)
        }
    }, {
        key: "equals",
        value: function(e) {
            return e._x === this._x && e._y === this._y && e._z === this._z && e._order === this._order
        }
    }, {
        key: "fromArray",
        value: function(e) {
            return this._x = e[0],
            this._y = e[1],
            this._z = e[2],
            void 0 !== e[3] && (this._order = e[3]),
            this._onChangeCallback(),
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this._x,
            e[t + 1] = this._y,
            e[t + 2] = this._z,
            e[t + 3] = this._order,
            e
        }
    }, {
        key: "toVector3",
        value: function(e) {
            return e ? e.set(this._x, this._y, this._z) : new Vector3(this._x,this._y,this._z)
        }
    }, {
        key: "_onChange",
        value: function(e) {
            return this._onChangeCallback = e,
            this
        }
    }, {
        key: "_onChangeCallback",
        value: function() {}
    }]),
    e
}();
Euler.prototype.isEuler = !0,
Euler.DefaultOrder = "XYZ",
Euler.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"];
var Layers = function() {
    function e() {
        _classCallCheck2(this, e),
        this.mask = 1
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e) {
            this.mask = 1 << e | 0
        }
    }, {
        key: "enable",
        value: function(e) {
            this.mask |= 1 << e | 0
        }
    }, {
        key: "enableAll",
        value: function() {
            this.mask = -1
        }
    }, {
        key: "toggle",
        value: function(e) {
            this.mask ^= 1 << e | 0
        }
    }, {
        key: "disable",
        value: function(e) {
            this.mask &= ~(1 << e | 0)
        }
    }, {
        key: "disableAll",
        value: function() {
            this.mask = 0
        }
    }, {
        key: "test",
        value: function(e) {
            return 0 != (this.mask & e.mask)
        }
    }]),
    e
}()
  , _object3DId = 0
  , _v1$4$1 = new Vector3
  , _q1$2 = new Quaternion
  , _m1$1 = new Matrix4
  , _target = new Vector3
  , _position$3 = new Vector3
  , _scale$2 = new Vector3
  , _quaternion$2 = new Quaternion
  , _xAxis = new Vector3(1,0,0)
  , _yAxis = new Vector3(0,1,0)
  , _zAxis = new Vector3(0,0,1)
  , _addedEvent = {
    type: "added"
}
  , _removedEvent = {
    type: "removed"
}
  , Object3D = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i),
        e = t.call(this),
        Object.defineProperty(_assertThisInitialized(e), "id", {
            value: _object3DId++
        }),
        e.uuid = generateUUID(),
        e.name = "",
        e.type = "Object3D",
        e.parent = null,
        e.children = [],
        e.up = i.DefaultUp.clone();
        var r = new Vector3
          , n = new Euler
          , a = new Quaternion
          , o = new Vector3(1,1,1);
        return n._onChange((function() {
            a.setFromEuler(n, !1)
        }
        )),
        a._onChange((function() {
            n.setFromQuaternion(a, void 0, !1)
        }
        )),
        Object.defineProperties(_assertThisInitialized(e), {
            position: {
                configurable: !0,
                enumerable: !0,
                value: r
            },
            rotation: {
                configurable: !0,
                enumerable: !0,
                value: n
            },
            quaternion: {
                configurable: !0,
                enumerable: !0,
                value: a
            },
            scale: {
                configurable: !0,
                enumerable: !0,
                value: o
            },
            modelViewMatrix: {
                value: new Matrix4
            },
            normalMatrix: {
                value: new Matrix3
            }
        }),
        e.matrix = new Matrix4,
        e.matrixWorld = new Matrix4,
        e.matrixAutoUpdate = i.DefaultMatrixAutoUpdate,
        e.matrixWorldNeedsUpdate = !1,
        e.layers = new Layers,
        e.visible = !0,
        e.castShadow = !1,
        e.receiveShadow = !1,
        e.frustumCulled = !0,
        e.renderOrder = 0,
        e.animations = [],
        e.userData = {},
        e
    }
    return _createClass2(i, [{
        key: "onBeforeRender",
        value: function() {}
    }, {
        key: "onAfterRender",
        value: function() {}
    }, {
        key: "applyMatrix4",
        value: function(e) {
            this.matrixAutoUpdate && this.updateMatrix(),
            this.matrix.premultiply(e),
            this.matrix.decompose(this.position, this.quaternion, this.scale)
        }
    }, {
        key: "applyQuaternion",
        value: function(e) {
            return this.quaternion.premultiply(e),
            this
        }
    }, {
        key: "setRotationFromAxisAngle",
        value: function(e, t) {
            this.quaternion.setFromAxisAngle(e, t)
        }
    }, {
        key: "setRotationFromEuler",
        value: function(e) {
            this.quaternion.setFromEuler(e, !0)
        }
    }, {
        key: "setRotationFromMatrix",
        value: function(e) {
            this.quaternion.setFromRotationMatrix(e)
        }
    }, {
        key: "setRotationFromQuaternion",
        value: function(e) {
            this.quaternion.copy(e)
        }
    }, {
        key: "rotateOnAxis",
        value: function(e, t) {
            return _q1$2.setFromAxisAngle(e, t),
            this.quaternion.multiply(_q1$2),
            this
        }
    }, {
        key: "rotateOnWorldAxis",
        value: function(e, t) {
            return _q1$2.setFromAxisAngle(e, t),
            this.quaternion.premultiply(_q1$2),
            this
        }
    }, {
        key: "rotateX",
        value: function(e) {
            return this.rotateOnAxis(_xAxis, e)
        }
    }, {
        key: "rotateY",
        value: function(e) {
            return this.rotateOnAxis(_yAxis, e)
        }
    }, {
        key: "rotateZ",
        value: function(e) {
            return this.rotateOnAxis(_zAxis, e)
        }
    }, {
        key: "translateOnAxis",
        value: function(e, t) {
            return _v1$4$1.copy(e).applyQuaternion(this.quaternion),
            this.position.add(_v1$4$1.multiplyScalar(t)),
            this
        }
    }, {
        key: "translateX",
        value: function(e) {
            return this.translateOnAxis(_xAxis, e)
        }
    }, {
        key: "translateY",
        value: function(e) {
            return this.translateOnAxis(_yAxis, e)
        }
    }, {
        key: "translateZ",
        value: function(e) {
            return this.translateOnAxis(_zAxis, e)
        }
    }, {
        key: "localToWorld",
        value: function(e) {
            return e.applyMatrix4(this.matrixWorld)
        }
    }, {
        key: "worldToLocal",
        value: function(e) {
            return e.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())
        }
    }, {
        key: "lookAt",
        value: function(e, t, i) {
            e.isVector3 ? _target.copy(e) : _target.set(e, t, i);
            var r = this.parent;
            this.updateWorldMatrix(!0, !1),
            _position$3.setFromMatrixPosition(this.matrixWorld),
            this.isCamera || this.isLight ? _m1$1.lookAt(_position$3, _target, this.up) : _m1$1.lookAt(_target, _position$3, this.up),
            this.quaternion.setFromRotationMatrix(_m1$1),
            r && (_m1$1.extractRotation(r.matrixWorld),
            _q1$2.setFromRotationMatrix(_m1$1),
            this.quaternion.premultiply(_q1$2.invert()))
        }
    }, {
        key: "add",
        value: function(e) {
            if (arguments.length > 1) {
                for (var t = 0; t < arguments.length; t++)
                    this.add(arguments[t]);
                return this
            }
            return e === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", e),
            this) : (e && e.isObject3D ? (null !== e.parent && e.parent.remove(e),
            e.parent = this,
            this.children.push(e),
            e.dispatchEvent(_addedEvent)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", e),
            this)
        }
    }, {
        key: "remove",
        value: function(e) {
            if (arguments.length > 1) {
                for (var t = 0; t < arguments.length; t++)
                    this.remove(arguments[t]);
                return this
            }
            var i = this.children.indexOf(e);
            return -1 !== i && (e.parent = null,
            this.children.splice(i, 1),
            e.dispatchEvent(_removedEvent)),
            this
        }
    }, {
        key: "removeFromParent",
        value: function() {
            var e = this.parent;
            return null !== e && e.remove(this),
            this
        }
    }, {
        key: "clear",
        value: function() {
            for (var e = 0; e < this.children.length; e++) {
                var t = this.children[e];
                t.parent = null,
                t.dispatchEvent(_removedEvent)
            }
            return this.children.length = 0,
            this
        }
    }, {
        key: "attach",
        value: function(e) {
            return this.updateWorldMatrix(!0, !1),
            _m1$1.copy(this.matrixWorld).invert(),
            null !== e.parent && (e.parent.updateWorldMatrix(!0, !1),
            _m1$1.multiply(e.parent.matrixWorld)),
            e.applyMatrix4(_m1$1),
            this.add(e),
            e.updateWorldMatrix(!1, !0),
            this
        }
    }, {
        key: "getObjectById",
        value: function(e) {
            return this.getObjectByProperty("id", e)
        }
    }, {
        key: "getObjectByName",
        value: function(e) {
            return this.getObjectByProperty("name", e)
        }
    }, {
        key: "getObjectByProperty",
        value: function(e, t) {
            if (this[e] === t)
                return this;
            for (var i = 0, r = this.children.length; i < r; i++) {
                var n = this.children[i].getObjectByProperty(e, t);
                if (void 0 !== n)
                    return n
            }
        }
    }, {
        key: "getWorldPosition",
        value: function(e) {
            return this.updateWorldMatrix(!0, !1),
            e.setFromMatrixPosition(this.matrixWorld)
        }
    }, {
        key: "getWorldQuaternion",
        value: function(e) {
            return this.updateWorldMatrix(!0, !1),
            this.matrixWorld.decompose(_position$3, e, _scale$2),
            e
        }
    }, {
        key: "getWorldScale",
        value: function(e) {
            return this.updateWorldMatrix(!0, !1),
            this.matrixWorld.decompose(_position$3, _quaternion$2, e),
            e
        }
    }, {
        key: "getWorldDirection",
        value: function(e) {
            this.updateWorldMatrix(!0, !1);
            var t = this.matrixWorld.elements;
            return e.set(t[8], t[9], t[10]).normalize()
        }
    }, {
        key: "raycast",
        value: function() {}
    }, {
        key: "traverse",
        value: function(e) {
            e(this);
            for (var t = this.children, i = 0, r = t.length; i < r; i++)
                t[i].traverse(e)
        }
    }, {
        key: "traverseVisible",
        value: function(e) {
            if (!1 !== this.visible) {
                e(this);
                for (var t = this.children, i = 0, r = t.length; i < r; i++)
                    t[i].traverseVisible(e)
            }
        }
    }, {
        key: "traverseAncestors",
        value: function(e) {
            var t = this.parent;
            null !== t && (e(t),
            t.traverseAncestors(e))
        }
    }, {
        key: "updateMatrix",
        value: function() {
            this.matrix.compose(this.position, this.quaternion, this.scale),
            this.matrixWorldNeedsUpdate = !0
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            this.matrixAutoUpdate && this.updateMatrix(),
            (this.matrixWorldNeedsUpdate || e) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix),
            this.matrixWorldNeedsUpdate = !1,
            e = !0);
            for (var t = this.children, i = 0, r = t.length; i < r; i++)
                t[i].updateMatrixWorld(e)
        }
    }, {
        key: "updateWorldMatrix",
        value: function(e, t) {
            var i = this.parent;
            if (!0 === e && null !== i && i.updateWorldMatrix(!0, !1),
            this.matrixAutoUpdate && this.updateMatrix(),
            null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix),
            !0 === t)
                for (var r = this.children, n = 0, a = r.length; n < a; n++)
                    r[n].updateWorldMatrix(!1, !0)
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = void 0 === e || "string" == typeof e
              , i = {};
            t && (e = {
                geometries: {},
                materials: {},
                textures: {},
                images: {},
                shapes: {},
                skeletons: {},
                animations: {}
            },
            i.metadata = {
                version: 4.5,
                type: "Object",
                generator: "Object3D.toJSON"
            });
            var r = {};
            function n(t, i) {
                return void 0 === t[i.uuid] && (t[i.uuid] = i.toJSON(e)),
                i.uuid
            }
            if (r.uuid = this.uuid,
            r.type = this.type,
            "" !== this.name && (r.name = this.name),
            !0 === this.castShadow && (r.castShadow = !0),
            !0 === this.receiveShadow && (r.receiveShadow = !0),
            !1 === this.visible && (r.visible = !1),
            !1 === this.frustumCulled && (r.frustumCulled = !1),
            0 !== this.renderOrder && (r.renderOrder = this.renderOrder),
            "{}" !== JSON.stringify(this.userData) && (r.userData = this.userData),
            r.layers = this.layers.mask,
            r.matrix = this.matrix.toArray(),
            !1 === this.matrixAutoUpdate && (r.matrixAutoUpdate = !1),
            this.isInstancedMesh && (r.type = "InstancedMesh",
            r.count = this.count,
            r.instanceMatrix = this.instanceMatrix.toJSON(),
            null !== this.instanceColor && (r.instanceColor = this.instanceColor.toJSON())),
            this.isScene)
                this.background && (this.background.isColor ? r.background = this.background.toJSON() : this.background.isTexture && (r.background = this.background.toJSON(e).uuid)),
                this.environment && this.environment.isTexture && (r.environment = this.environment.toJSON(e).uuid);
            else if (this.isMesh || this.isLine || this.isPoints) {
                r.geometry = n(e.geometries, this.geometry);
                var a = this.geometry.parameters;
                if (void 0 !== a && void 0 !== a.shapes) {
                    var o = a.shapes;
                    if (Array.isArray(o))
                        for (var s = 0, l = o.length; s < l; s++) {
                            var h = o[s];
                            n(e.shapes, h)
                        }
                    else
                        n(e.shapes, o)
                }
            }
            if (this.isSkinnedMesh && (r.bindMode = this.bindMode,
            r.bindMatrix = this.bindMatrix.toArray(),
            void 0 !== this.skeleton && (n(e.skeletons, this.skeleton),
            r.skeleton = this.skeleton.uuid)),
            void 0 !== this.material)
                if (Array.isArray(this.material)) {
                    for (var c = [], p = 0, u = this.material.length; p < u; p++)
                        c.push(n(e.materials, this.material[p]));
                    r.material = c
                } else
                    r.material = n(e.materials, this.material);
            if (this.children.length > 0) {
                r.children = [];
                for (var d = 0; d < this.children.length; d++)
                    r.children.push(this.children[d].toJSON(e).object)
            }
            if (this.animations.length > 0) {
                r.animations = [];
                for (var f = 0; f < this.animations.length; f++) {
                    var m = this.animations[f];
                    r.animations.push(n(e.animations, m))
                }
            }
            if (t) {
                var g = S(e.geometries)
                  , v = S(e.materials)
                  , y = S(e.textures)
                  , _ = S(e.images)
                  , b = S(e.shapes)
                  , x = S(e.skeletons)
                  , w = S(e.animations);
                g.length > 0 && (i.geometries = g),
                v.length > 0 && (i.materials = v),
                y.length > 0 && (i.textures = y),
                _.length > 0 && (i.images = _),
                b.length > 0 && (i.shapes = b),
                x.length > 0 && (i.skeletons = x),
                w.length > 0 && (i.animations = w)
            }
            return i.object = r,
            i;
            function S(e) {
                var t = [];
                for (var i in e) {
                    var r = e[i];
                    delete r.metadata,
                    t.push(r)
                }
                return t
            }
        }
    }, {
        key: "clone",
        value: function(e) {
            return (new this.constructor).copy(this, e)
        }
    }, {
        key: "copy",
        value: function(e) {
            var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
            if (this.name = e.name,
            this.up.copy(e.up),
            this.position.copy(e.position),
            this.rotation.order = e.rotation.order,
            this.quaternion.copy(e.quaternion),
            this.scale.copy(e.scale),
            this.matrix.copy(e.matrix),
            this.matrixWorld.copy(e.matrixWorld),
            this.matrixAutoUpdate = e.matrixAutoUpdate,
            this.matrixWorldNeedsUpdate = e.matrixWorldNeedsUpdate,
            this.layers.mask = e.layers.mask,
            this.visible = e.visible,
            this.castShadow = e.castShadow,
            this.receiveShadow = e.receiveShadow,
            this.frustumCulled = e.frustumCulled,
            this.renderOrder = e.renderOrder,
            this.userData = JSON.parse(JSON.stringify(e.userData)),
            !0 === t)
                for (var i = 0; i < e.children.length; i++) {
                    var r = e.children[i];
                    this.add(r.clone())
                }
            return this
        }
    }]),
    i
}();
Object3D.DefaultUp = new Vector3(0,1,0),
Object3D.DefaultMatrixAutoUpdate = !0,
Object3D.prototype.isObject3D = !0;
var _v0$1 = new Vector3
  , _v1$3$1 = new Vector3
  , _v2$2$1 = new Vector3
  , _v3$1 = new Vector3
  , _vab = new Vector3
  , _vac = new Vector3
  , _vbc = new Vector3
  , _vap = new Vector3
  , _vbp = new Vector3
  , _vcp = new Vector3
  , Triangle = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Vector3;
        _classCallCheck2(this, e),
        this.a = t,
        this.b = i,
        this.c = r
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i) {
            return this.a.copy(e),
            this.b.copy(t),
            this.c.copy(i),
            this
        }
    }, {
        key: "setFromPointsAndIndices",
        value: function(e, t, i, r) {
            return this.a.copy(e[t]),
            this.b.copy(e[i]),
            this.c.copy(e[r]),
            this
        }
    }, {
        key: "setFromAttributeAndIndices",
        value: function(e, t, i, r) {
            return this.a.fromBufferAttribute(e, t),
            this.b.fromBufferAttribute(e, i),
            this.c.fromBufferAttribute(e, r),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.a.copy(e.a),
            this.b.copy(e.b),
            this.c.copy(e.c),
            this
        }
    }, {
        key: "getArea",
        value: function() {
            return _v0$1.subVectors(this.c, this.b),
            _v1$3$1.subVectors(this.a, this.b),
            .5 * _v0$1.cross(_v1$3$1).length()
        }
    }, {
        key: "getMidpoint",
        value: function(e) {
            return e.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3)
        }
    }, {
        key: "getNormal",
        value: function(t) {
            return e.getNormal(this.a, this.b, this.c, t)
        }
    }, {
        key: "getPlane",
        value: function(e) {
            return e.setFromCoplanarPoints(this.a, this.b, this.c)
        }
    }, {
        key: "getBarycoord",
        value: function(t, i) {
            return e.getBarycoord(t, this.a, this.b, this.c, i)
        }
    }, {
        key: "getUV",
        value: function(t, i, r, n, a) {
            return e.getUV(t, this.a, this.b, this.c, i, r, n, a)
        }
    }, {
        key: "containsPoint",
        value: function(t) {
            return e.containsPoint(t, this.a, this.b, this.c)
        }
    }, {
        key: "isFrontFacing",
        value: function(t) {
            return e.isFrontFacing(this.a, this.b, this.c, t)
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            return e.intersectsTriangle(this)
        }
    }, {
        key: "closestPointToPoint",
        value: function(e, t) {
            var i, r, n = this.a, a = this.b, o = this.c;
            _vab.subVectors(a, n),
            _vac.subVectors(o, n),
            _vap.subVectors(e, n);
            var s = _vab.dot(_vap)
              , l = _vac.dot(_vap);
            if (s <= 0 && l <= 0)
                return t.copy(n);
            _vbp.subVectors(e, a);
            var h = _vab.dot(_vbp)
              , c = _vac.dot(_vbp);
            if (h >= 0 && c <= h)
                return t.copy(a);
            var p = s * c - h * l;
            if (p <= 0 && s >= 0 && h <= 0)
                return i = s / (s - h),
                t.copy(n).addScaledVector(_vab, i);
            _vcp.subVectors(e, o);
            var u = _vab.dot(_vcp)
              , d = _vac.dot(_vcp);
            if (d >= 0 && u <= d)
                return t.copy(o);
            var f = u * l - s * d;
            if (f <= 0 && l >= 0 && d <= 0)
                return r = l / (l - d),
                t.copy(n).addScaledVector(_vac, r);
            var m = h * d - u * c;
            if (m <= 0 && c - h >= 0 && u - d >= 0)
                return _vbc.subVectors(o, a),
                r = (c - h) / (c - h + (u - d)),
                t.copy(a).addScaledVector(_vbc, r);
            var g = 1 / (m + f + p);
            return i = f * g,
            r = p * g,
            t.copy(n).addScaledVector(_vab, i).addScaledVector(_vac, r)
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.a.equals(this.a) && e.b.equals(this.b) && e.c.equals(this.c)
        }
    }], [{
        key: "getNormal",
        value: function(e, t, i, r) {
            r.subVectors(i, t),
            _v0$1.subVectors(e, t),
            r.cross(_v0$1);
            var n = r.lengthSq();
            return n > 0 ? r.multiplyScalar(1 / Math.sqrt(n)) : r.set(0, 0, 0)
        }
    }, {
        key: "getBarycoord",
        value: function(e, t, i, r, n) {
            _v0$1.subVectors(r, t),
            _v1$3$1.subVectors(i, t),
            _v2$2$1.subVectors(e, t);
            var a = _v0$1.dot(_v0$1)
              , o = _v0$1.dot(_v1$3$1)
              , s = _v0$1.dot(_v2$2$1)
              , l = _v1$3$1.dot(_v1$3$1)
              , h = _v1$3$1.dot(_v2$2$1)
              , c = a * l - o * o;
            if (0 === c)
                return n.set(-2, -1, -1);
            var p = 1 / c
              , u = (l * s - o * h) * p
              , d = (a * h - o * s) * p;
            return n.set(1 - u - d, d, u)
        }
    }, {
        key: "containsPoint",
        value: function(e, t, i, r) {
            return this.getBarycoord(e, t, i, r, _v3$1),
            _v3$1.x >= 0 && _v3$1.y >= 0 && _v3$1.x + _v3$1.y <= 1
        }
    }, {
        key: "getUV",
        value: function(e, t, i, r, n, a, o, s) {
            return this.getBarycoord(e, t, i, r, _v3$1),
            s.set(0, 0),
            s.addScaledVector(n, _v3$1.x),
            s.addScaledVector(a, _v3$1.y),
            s.addScaledVector(o, _v3$1.z),
            s
        }
    }, {
        key: "isFrontFacing",
        value: function(e, t, i, r) {
            return _v0$1.subVectors(i, t),
            _v1$3$1.subVectors(e, t),
            _v0$1.cross(_v1$3$1).dot(r) < 0
        }
    }]),
    e
}()
  , materialId = 0
  , Material = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        e = t.call(this),
        Object.defineProperty(_assertThisInitialized(e), "id", {
            value: materialId++
        }),
        e.uuid = generateUUID(),
        e.name = "",
        e.type = "Material",
        e.fog = !0,
        e.blending = NormalBlending,
        e.side = FrontSide,
        e.vertexColors = !1,
        e.opacity = 1,
        e.format = RGBAFormat,
        e.transparent = !1,
        e.blendSrc = SrcAlphaFactor,
        e.blendDst = OneMinusSrcAlphaFactor,
        e.blendEquation = AddEquation,
        e.blendSrcAlpha = null,
        e.blendDstAlpha = null,
        e.blendEquationAlpha = null,
        e.depthFunc = LessEqualDepth,
        e.depthTest = !0,
        e.depthWrite = !0,
        e.stencilWriteMask = 255,
        e.stencilFunc = AlwaysStencilFunc,
        e.stencilRef = 0,
        e.stencilFuncMask = 255,
        e.stencilFail = KeepStencilOp,
        e.stencilZFail = KeepStencilOp,
        e.stencilZPass = KeepStencilOp,
        e.stencilWrite = !1,
        e.clippingPlanes = null,
        e.clipIntersection = !1,
        e.clipShadows = !1,
        e.shadowSide = null,
        e.colorWrite = !0,
        e.precision = null,
        e.polygonOffset = !1,
        e.polygonOffsetFactor = 0,
        e.polygonOffsetUnits = 0,
        e.dithering = !1,
        e.alphaToCoverage = !1,
        e.premultipliedAlpha = !1,
        e.visible = !0,
        e.toneMapped = !0,
        e.userData = {},
        e.version = 0,
        e._alphaTest = 0,
        e
    }
    return _createClass2(i, [{
        key: "alphaTest",
        get: function() {
            return this._alphaTest
        },
        set: function(e) {
            this._alphaTest > 0 != e > 0 && this.version++,
            this._alphaTest = e
        }
    }, {
        key: "onBuild",
        value: function() {}
    }, {
        key: "onBeforeRender",
        value: function() {}
    }, {
        key: "onBeforeCompile",
        value: function() {}
    }, {
        key: "customProgramCacheKey",
        value: function() {
            return this.onBeforeCompile.toString()
        }
    }, {
        key: "setValues",
        value: function(e) {
            if (void 0 !== e)
                for (var t in e) {
                    var i = e[t];
                    if (void 0 !== i)
                        if ("shading" !== t) {
                            var r = this[t];
                            void 0 !== r ? r && r.isColor ? r.set(i) : r && r.isVector3 && i && i.isVector3 ? r.copy(i) : this[t] = i : console.warn("THREE." + this.type + ": '" + t + "' is not a property of this material.")
                        } else
                            console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."),
                            this.flatShading = i === FlatShading;
                    else
                        console.warn("THREE.Material: '" + t + "' parameter is undefined.")
                }
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = void 0 === e || "string" == typeof e;
            t && (e = {
                textures: {},
                images: {}
            });
            var i = {
                metadata: {
                    version: 4.5,
                    type: "Material",
                    generator: "Material.toJSON"
                }
            };
            function r(e) {
                var t = [];
                for (var i in e) {
                    var r = e[i];
                    delete r.metadata,
                    t.push(r)
                }
                return t
            }
            if (i.uuid = this.uuid,
            i.type = this.type,
            "" !== this.name && (i.name = this.name),
            this.color && this.color.isColor && (i.color = this.color.getHex()),
            void 0 !== this.roughness && (i.roughness = this.roughness),
            void 0 !== this.metalness && (i.metalness = this.metalness),
            void 0 !== this.sheen && (i.sheen = this.sheen),
            this.sheenTint && this.sheenTint.isColor && (i.sheenTint = this.sheenTint.getHex()),
            void 0 !== this.sheenRoughness && (i.sheenRoughness = this.sheenRoughness),
            this.emissive && this.emissive.isColor && (i.emissive = this.emissive.getHex()),
            this.emissiveIntensity && 1 !== this.emissiveIntensity && (i.emissiveIntensity = this.emissiveIntensity),
            this.specular && this.specular.isColor && (i.specular = this.specular.getHex()),
            void 0 !== this.specularIntensity && (i.specularIntensity = this.specularIntensity),
            this.specularTint && this.specularTint.isColor && (i.specularTint = this.specularTint.getHex()),
            void 0 !== this.shininess && (i.shininess = this.shininess),
            void 0 !== this.clearcoat && (i.clearcoat = this.clearcoat),
            void 0 !== this.clearcoatRoughness && (i.clearcoatRoughness = this.clearcoatRoughness),
            this.clearcoatMap && this.clearcoatMap.isTexture && (i.clearcoatMap = this.clearcoatMap.toJSON(e).uuid),
            this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture && (i.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON(e).uuid),
            this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture && (i.clearcoatNormalMap = this.clearcoatNormalMap.toJSON(e).uuid,
            i.clearcoatNormalScale = this.clearcoatNormalScale.toArray()),
            this.map && this.map.isTexture && (i.map = this.map.toJSON(e).uuid),
            this.matcap && this.matcap.isTexture && (i.matcap = this.matcap.toJSON(e).uuid),
            this.alphaMap && this.alphaMap.isTexture && (i.alphaMap = this.alphaMap.toJSON(e).uuid),
            this.lightMap && this.lightMap.isTexture && (i.lightMap = this.lightMap.toJSON(e).uuid,
            i.lightMapIntensity = this.lightMapIntensity),
            this.aoMap && this.aoMap.isTexture && (i.aoMap = this.aoMap.toJSON(e).uuid,
            i.aoMapIntensity = this.aoMapIntensity),
            this.bumpMap && this.bumpMap.isTexture && (i.bumpMap = this.bumpMap.toJSON(e).uuid,
            i.bumpScale = this.bumpScale),
            this.normalMap && this.normalMap.isTexture && (i.normalMap = this.normalMap.toJSON(e).uuid,
            i.normalMapType = this.normalMapType,
            i.normalScale = this.normalScale.toArray()),
            this.displacementMap && this.displacementMap.isTexture && (i.displacementMap = this.displacementMap.toJSON(e).uuid,
            i.displacementScale = this.displacementScale,
            i.displacementBias = this.displacementBias),
            this.roughnessMap && this.roughnessMap.isTexture && (i.roughnessMap = this.roughnessMap.toJSON(e).uuid),
            this.metalnessMap && this.metalnessMap.isTexture && (i.metalnessMap = this.metalnessMap.toJSON(e).uuid),
            this.emissiveMap && this.emissiveMap.isTexture && (i.emissiveMap = this.emissiveMap.toJSON(e).uuid),
            this.specularMap && this.specularMap.isTexture && (i.specularMap = this.specularMap.toJSON(e).uuid),
            this.specularIntensityMap && this.specularIntensityMap.isTexture && (i.specularIntensityMap = this.specularIntensityMap.toJSON(e).uuid),
            this.specularTintMap && this.specularTintMap.isTexture && (i.specularTintMap = this.specularTintMap.toJSON(e).uuid),
            this.envMap && this.envMap.isTexture && (i.envMap = this.envMap.toJSON(e).uuid,
            void 0 !== this.combine && (i.combine = this.combine)),
            void 0 !== this.envMapIntensity && (i.envMapIntensity = this.envMapIntensity),
            void 0 !== this.reflectivity && (i.reflectivity = this.reflectivity),
            void 0 !== this.refractionRatio && (i.refractionRatio = this.refractionRatio),
            this.gradientMap && this.gradientMap.isTexture && (i.gradientMap = this.gradientMap.toJSON(e).uuid),
            void 0 !== this.transmission && (i.transmission = this.transmission),
            this.transmissionMap && this.transmissionMap.isTexture && (i.transmissionMap = this.transmissionMap.toJSON(e).uuid),
            void 0 !== this.thickness && (i.thickness = this.thickness),
            this.thicknessMap && this.thicknessMap.isTexture && (i.thicknessMap = this.thicknessMap.toJSON(e).uuid),
            void 0 !== this.attenuationDistance && (i.attenuationDistance = this.attenuationDistance),
            void 0 !== this.attenuationTint && (i.attenuationTint = this.attenuationTint.getHex()),
            void 0 !== this.size && (i.size = this.size),
            null !== this.shadowSide && (i.shadowSide = this.shadowSide),
            void 0 !== this.sizeAttenuation && (i.sizeAttenuation = this.sizeAttenuation),
            this.blending !== NormalBlending && (i.blending = this.blending),
            this.side !== FrontSide && (i.side = this.side),
            this.vertexColors && (i.vertexColors = !0),
            this.opacity < 1 && (i.opacity = this.opacity),
            this.format !== RGBAFormat && (i.format = this.format),
            !0 === this.transparent && (i.transparent = this.transparent),
            i.depthFunc = this.depthFunc,
            i.depthTest = this.depthTest,
            i.depthWrite = this.depthWrite,
            i.colorWrite = this.colorWrite,
            i.stencilWrite = this.stencilWrite,
            i.stencilWriteMask = this.stencilWriteMask,
            i.stencilFunc = this.stencilFunc,
            i.stencilRef = this.stencilRef,
            i.stencilFuncMask = this.stencilFuncMask,
            i.stencilFail = this.stencilFail,
            i.stencilZFail = this.stencilZFail,
            i.stencilZPass = this.stencilZPass,
            this.rotation && 0 !== this.rotation && (i.rotation = this.rotation),
            !0 === this.polygonOffset && (i.polygonOffset = !0),
            0 !== this.polygonOffsetFactor && (i.polygonOffsetFactor = this.polygonOffsetFactor),
            0 !== this.polygonOffsetUnits && (i.polygonOffsetUnits = this.polygonOffsetUnits),
            this.linewidth && 1 !== this.linewidth && (i.linewidth = this.linewidth),
            void 0 !== this.dashSize && (i.dashSize = this.dashSize),
            void 0 !== this.gapSize && (i.gapSize = this.gapSize),
            void 0 !== this.scale && (i.scale = this.scale),
            !0 === this.dithering && (i.dithering = !0),
            this.alphaTest > 0 && (i.alphaTest = this.alphaTest),
            !0 === this.alphaToCoverage && (i.alphaToCoverage = this.alphaToCoverage),
            !0 === this.premultipliedAlpha && (i.premultipliedAlpha = this.premultipliedAlpha),
            !0 === this.wireframe && (i.wireframe = this.wireframe),
            this.wireframeLinewidth > 1 && (i.wireframeLinewidth = this.wireframeLinewidth),
            "round" !== this.wireframeLinecap && (i.wireframeLinecap = this.wireframeLinecap),
            "round" !== this.wireframeLinejoin && (i.wireframeLinejoin = this.wireframeLinejoin),
            !0 === this.flatShading && (i.flatShading = this.flatShading),
            !1 === this.visible && (i.visible = !1),
            !1 === this.toneMapped && (i.toneMapped = !1),
            "{}" !== JSON.stringify(this.userData) && (i.userData = this.userData),
            t) {
                var n = r(e.textures)
                  , a = r(e.images);
                n.length > 0 && (i.textures = n),
                a.length > 0 && (i.images = a)
            }
            return i
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            this.name = e.name,
            this.fog = e.fog,
            this.blending = e.blending,
            this.side = e.side,
            this.vertexColors = e.vertexColors,
            this.opacity = e.opacity,
            this.format = e.format,
            this.transparent = e.transparent,
            this.blendSrc = e.blendSrc,
            this.blendDst = e.blendDst,
            this.blendEquation = e.blendEquation,
            this.blendSrcAlpha = e.blendSrcAlpha,
            this.blendDstAlpha = e.blendDstAlpha,
            this.blendEquationAlpha = e.blendEquationAlpha,
            this.depthFunc = e.depthFunc,
            this.depthTest = e.depthTest,
            this.depthWrite = e.depthWrite,
            this.stencilWriteMask = e.stencilWriteMask,
            this.stencilFunc = e.stencilFunc,
            this.stencilRef = e.stencilRef,
            this.stencilFuncMask = e.stencilFuncMask,
            this.stencilFail = e.stencilFail,
            this.stencilZFail = e.stencilZFail,
            this.stencilZPass = e.stencilZPass,
            this.stencilWrite = e.stencilWrite;
            var t = e.clippingPlanes
              , i = null;
            if (null !== t) {
                var r = t.length;
                i = new Array(r);
                for (var n = 0; n !== r; ++n)
                    i[n] = t[n].clone()
            }
            return this.clippingPlanes = i,
            this.clipIntersection = e.clipIntersection,
            this.clipShadows = e.clipShadows,
            this.shadowSide = e.shadowSide,
            this.colorWrite = e.colorWrite,
            this.precision = e.precision,
            this.polygonOffset = e.polygonOffset,
            this.polygonOffsetFactor = e.polygonOffsetFactor,
            this.polygonOffsetUnits = e.polygonOffsetUnits,
            this.dithering = e.dithering,
            this.alphaTest = e.alphaTest,
            this.alphaToCoverage = e.alphaToCoverage,
            this.premultipliedAlpha = e.premultipliedAlpha,
            this.visible = e.visible,
            this.toneMapped = e.toneMapped,
            this.userData = JSON.parse(JSON.stringify(e.userData)),
            this
        }
    }, {
        key: "dispose",
        value: function() {
            this.dispatchEvent({
                type: "dispose"
            })
        }
    }, {
        key: "needsUpdate",
        set: function(e) {
            !0 === e && this.version++
        }
    }]),
    i
}();
Material.prototype.isMaterial = !0;
var _colorKeywords = {
    aliceblue: 15792383,
    antiquewhite: 16444375,
    aqua: 65535,
    aquamarine: 8388564,
    azure: 15794175,
    beige: 16119260,
    bisque: 16770244,
    black: 0,
    blanchedalmond: 16772045,
    blue: 255,
    blueviolet: 9055202,
    brown: 10824234,
    burlywood: 14596231,
    cadetblue: 6266528,
    chartreuse: 8388352,
    chocolate: 13789470,
    coral: 16744272,
    cornflowerblue: 6591981,
    cornsilk: 16775388,
    crimson: 14423100,
    cyan: 65535,
    darkblue: 139,
    darkcyan: 35723,
    darkgoldenrod: 12092939,
    darkgray: 11119017,
    darkgreen: 25600,
    darkgrey: 11119017,
    darkkhaki: 12433259,
    darkmagenta: 9109643,
    darkolivegreen: 5597999,
    darkorange: 16747520,
    darkorchid: 10040012,
    darkred: 9109504,
    darksalmon: 15308410,
    darkseagreen: 9419919,
    darkslateblue: 4734347,
    darkslategray: 3100495,
    darkslategrey: 3100495,
    darkturquoise: 52945,
    darkviolet: 9699539,
    deeppink: 16716947,
    deepskyblue: 49151,
    dimgray: 6908265,
    dimgrey: 6908265,
    dodgerblue: 2003199,
    firebrick: 11674146,
    floralwhite: 16775920,
    forestgreen: 2263842,
    fuchsia: 16711935,
    gainsboro: 14474460,
    ghostwhite: 16316671,
    gold: 16766720,
    goldenrod: 14329120,
    gray: 8421504,
    green: 32768,
    greenyellow: 11403055,
    grey: 8421504,
    honeydew: 15794160,
    hotpink: 16738740,
    indianred: 13458524,
    indigo: 4915330,
    ivory: 16777200,
    khaki: 15787660,
    lavender: 15132410,
    lavenderblush: 16773365,
    lawngreen: 8190976,
    lemonchiffon: 16775885,
    lightblue: 11393254,
    lightcoral: 15761536,
    lightcyan: 14745599,
    lightgoldenrodyellow: 16448210,
    lightgray: 13882323,
    lightgreen: 9498256,
    lightgrey: 13882323,
    lightpink: 16758465,
    lightsalmon: 16752762,
    lightseagreen: 2142890,
    lightskyblue: 8900346,
    lightslategray: 7833753,
    lightslategrey: 7833753,
    lightsteelblue: 11584734,
    lightyellow: 16777184,
    lime: 65280,
    limegreen: 3329330,
    linen: 16445670,
    magenta: 16711935,
    maroon: 8388608,
    mediumaquamarine: 6737322,
    mediumblue: 205,
    mediumorchid: 12211667,
    mediumpurple: 9662683,
    mediumseagreen: 3978097,
    mediumslateblue: 8087790,
    mediumspringgreen: 64154,
    mediumturquoise: 4772300,
    mediumvioletred: 13047173,
    midnightblue: 1644912,
    mintcream: 16121850,
    mistyrose: 16770273,
    moccasin: 16770229,
    navajowhite: 16768685,
    navy: 128,
    oldlace: 16643558,
    olive: 8421376,
    olivedrab: 7048739,
    orange: 16753920,
    orangered: 16729344,
    orchid: 14315734,
    palegoldenrod: 15657130,
    palegreen: 10025880,
    paleturquoise: 11529966,
    palevioletred: 14381203,
    papayawhip: 16773077,
    peachpuff: 16767673,
    peru: 13468991,
    pink: 16761035,
    plum: 14524637,
    powderblue: 11591910,
    purple: 8388736,
    rebeccapurple: 6697881,
    red: 16711680,
    rosybrown: 12357519,
    royalblue: 4286945,
    saddlebrown: 9127187,
    salmon: 16416882,
    sandybrown: 16032864,
    seagreen: 3050327,
    seashell: 16774638,
    sienna: 10506797,
    silver: 12632256,
    skyblue: 8900331,
    slateblue: 6970061,
    slategray: 7372944,
    slategrey: 7372944,
    snow: 16775930,
    springgreen: 65407,
    steelblue: 4620980,
    tan: 13808780,
    teal: 32896,
    thistle: 14204888,
    tomato: 16737095,
    turquoise: 4251856,
    violet: 15631086,
    wheat: 16113331,
    white: 16777215,
    whitesmoke: 16119285,
    yellow: 16776960,
    yellowgreen: 10145074
}
  , _hslA = {
    h: 0,
    s: 0,
    l: 0
}
  , _hslB = {
    h: 0,
    s: 0,
    l: 0
};
function hue2rgb(e, t, i) {
    return i < 0 && (i += 1),
    i > 1 && (i -= 1),
    i < 1 / 6 ? e + 6 * (t - e) * i : i < .5 ? t : i < 2 / 3 ? e + 6 * (t - e) * (2 / 3 - i) : e
}
function SRGBToLinear(e) {
    return e < .04045 ? .0773993808 * e : Math.pow(.9478672986 * e + .0521327014, 2.4)
}
function LinearToSRGB(e) {
    return e < .0031308 ? 12.92 * e : 1.055 * Math.pow(e, .41666) - .055
}
var Color = function() {
    function e(t, i, r) {
        return _classCallCheck2(this, e),
        void 0 === i && void 0 === r ? this.set(t) : this.setRGB(t, i, r)
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e) {
            return e && e.isColor ? this.copy(e) : "number" == typeof e ? this.setHex(e) : "string" == typeof e && this.setStyle(e),
            this
        }
    }, {
        key: "setScalar",
        value: function(e) {
            return this.r = e,
            this.g = e,
            this.b = e,
            this
        }
    }, {
        key: "setHex",
        value: function(e) {
            return e = Math.floor(e),
            this.r = (e >> 16 & 255) / 255,
            this.g = (e >> 8 & 255) / 255,
            this.b = (255 & e) / 255,
            this
        }
    }, {
        key: "setRGB",
        value: function(e, t, i) {
            return this.r = e,
            this.g = t,
            this.b = i,
            this
        }
    }, {
        key: "setHSL",
        value: function(e, t, i) {
            if (e = euclideanModulo(e, 1),
            t = clamp(t, 0, 1),
            i = clamp(i, 0, 1),
            0 === t)
                this.r = this.g = this.b = i;
            else {
                var r = i <= .5 ? i * (1 + t) : i + t - i * t
                  , n = 2 * i - r;
                this.r = hue2rgb(n, r, e + 1 / 3),
                this.g = hue2rgb(n, r, e),
                this.b = hue2rgb(n, r, e - 1 / 3)
            }
            return this
        }
    }, {
        key: "setStyle",
        value: function(e) {
            function t(t) {
                void 0 !== t && parseFloat(t) < 1 && console.warn("THREE.Color: Alpha component of " + e + " will be ignored.")
            }
            var i;
            if (i = /^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)) {
                var r, n = i[1], a = i[2];
                switch (n) {
                case "rgb":
                case "rgba":
                    if (r = /^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))
                        return this.r = Math.min(255, parseInt(r[1], 10)) / 255,
                        this.g = Math.min(255, parseInt(r[2], 10)) / 255,
                        this.b = Math.min(255, parseInt(r[3], 10)) / 255,
                        t(r[4]),
                        this;
                    if (r = /^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))
                        return this.r = Math.min(100, parseInt(r[1], 10)) / 100,
                        this.g = Math.min(100, parseInt(r[2], 10)) / 100,
                        this.b = Math.min(100, parseInt(r[3], 10)) / 100,
                        t(r[4]),
                        this;
                    break;
                case "hsl":
                case "hsla":
                    if (r = /^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)) {
                        var o = parseFloat(r[1]) / 360
                          , s = parseInt(r[2], 10) / 100
                          , l = parseInt(r[3], 10) / 100;
                        return t(r[4]),
                        this.setHSL(o, s, l)
                    }
                }
            } else if (i = /^\#([A-Fa-f\d]+)$/.exec(e)) {
                var h = i[1]
                  , c = h.length;
                if (3 === c)
                    return this.r = parseInt(h.charAt(0) + h.charAt(0), 16) / 255,
                    this.g = parseInt(h.charAt(1) + h.charAt(1), 16) / 255,
                    this.b = parseInt(h.charAt(2) + h.charAt(2), 16) / 255,
                    this;
                if (6 === c)
                    return this.r = parseInt(h.charAt(0) + h.charAt(1), 16) / 255,
                    this.g = parseInt(h.charAt(2) + h.charAt(3), 16) / 255,
                    this.b = parseInt(h.charAt(4) + h.charAt(5), 16) / 255,
                    this
            }
            return e && e.length > 0 ? this.setColorName(e) : this
        }
    }, {
        key: "setColorName",
        value: function(e) {
            var t = _colorKeywords[e.toLowerCase()];
            return void 0 !== t ? this.setHex(t) : console.warn("THREE.Color: Unknown color " + e),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this.r,this.g,this.b)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.r = e.r,
            this.g = e.g,
            this.b = e.b,
            this
        }
    }, {
        key: "copyGammaToLinear",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 2;
            return this.r = Math.pow(e.r, t),
            this.g = Math.pow(e.g, t),
            this.b = Math.pow(e.b, t),
            this
        }
    }, {
        key: "copyLinearToGamma",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 2
              , i = t > 0 ? 1 / t : 1;
            return this.r = Math.pow(e.r, i),
            this.g = Math.pow(e.g, i),
            this.b = Math.pow(e.b, i),
            this
        }
    }, {
        key: "convertGammaToLinear",
        value: function(e) {
            return this.copyGammaToLinear(this, e),
            this
        }
    }, {
        key: "convertLinearToGamma",
        value: function(e) {
            return this.copyLinearToGamma(this, e),
            this
        }
    }, {
        key: "copySRGBToLinear",
        value: function(e) {
            return this.r = SRGBToLinear(e.r),
            this.g = SRGBToLinear(e.g),
            this.b = SRGBToLinear(e.b),
            this
        }
    }, {
        key: "copyLinearToSRGB",
        value: function(e) {
            return this.r = LinearToSRGB(e.r),
            this.g = LinearToSRGB(e.g),
            this.b = LinearToSRGB(e.b),
            this
        }
    }, {
        key: "convertSRGBToLinear",
        value: function() {
            return this.copySRGBToLinear(this),
            this
        }
    }, {
        key: "convertLinearToSRGB",
        value: function() {
            return this.copyLinearToSRGB(this),
            this
        }
    }, {
        key: "getHex",
        value: function() {
            return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0
        }
    }, {
        key: "getHexString",
        value: function() {
            return ("000000" + this.getHex().toString(16)).slice(-6)
        }
    }, {
        key: "getHSL",
        value: function(e) {
            var t, i, r = this.r, n = this.g, a = this.b, o = Math.max(r, n, a), s = Math.min(r, n, a), l = (s + o) / 2;
            if (s === o)
                t = 0,
                i = 0;
            else {
                var h = o - s;
                switch (i = l <= .5 ? h / (o + s) : h / (2 - o - s),
                o) {
                case r:
                    t = (n - a) / h + (n < a ? 6 : 0);
                    break;
                case n:
                    t = (a - r) / h + 2;
                    break;
                case a:
                    t = (r - n) / h + 4
                }
                t /= 6
            }
            return e.h = t,
            e.s = i,
            e.l = l,
            e
        }
    }, {
        key: "getStyle",
        value: function() {
            return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")"
        }
    }, {
        key: "offsetHSL",
        value: function(e, t, i) {
            return this.getHSL(_hslA),
            _hslA.h += e,
            _hslA.s += t,
            _hslA.l += i,
            this.setHSL(_hslA.h, _hslA.s, _hslA.l),
            this
        }
    }, {
        key: "add",
        value: function(e) {
            return this.r += e.r,
            this.g += e.g,
            this.b += e.b,
            this
        }
    }, {
        key: "addColors",
        value: function(e, t) {
            return this.r = e.r + t.r,
            this.g = e.g + t.g,
            this.b = e.b + t.b,
            this
        }
    }, {
        key: "addScalar",
        value: function(e) {
            return this.r += e,
            this.g += e,
            this.b += e,
            this
        }
    }, {
        key: "sub",
        value: function(e) {
            return this.r = Math.max(0, this.r - e.r),
            this.g = Math.max(0, this.g - e.g),
            this.b = Math.max(0, this.b - e.b),
            this
        }
    }, {
        key: "multiply",
        value: function(e) {
            return this.r *= e.r,
            this.g *= e.g,
            this.b *= e.b,
            this
        }
    }, {
        key: "multiplyScalar",
        value: function(e) {
            return this.r *= e,
            this.g *= e,
            this.b *= e,
            this
        }
    }, {
        key: "lerp",
        value: function(e, t) {
            return this.r += (e.r - this.r) * t,
            this.g += (e.g - this.g) * t,
            this.b += (e.b - this.b) * t,
            this
        }
    }, {
        key: "lerpColors",
        value: function(e, t, i) {
            return this.r = e.r + (t.r - e.r) * i,
            this.g = e.g + (t.g - e.g) * i,
            this.b = e.b + (t.b - e.b) * i,
            this
        }
    }, {
        key: "lerpHSL",
        value: function(e, t) {
            this.getHSL(_hslA),
            e.getHSL(_hslB);
            var i = lerp(_hslA.h, _hslB.h, t)
              , r = lerp(_hslA.s, _hslB.s, t)
              , n = lerp(_hslA.l, _hslB.l, t);
            return this.setHSL(i, r, n),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.r === this.r && e.g === this.g && e.b === this.b
        }
    }, {
        key: "fromArray",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.r = e[t],
            this.g = e[t + 1],
            this.b = e[t + 2],
            this
        }
    }, {
        key: "toArray",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return e[t] = this.r,
            e[t + 1] = this.g,
            e[t + 2] = this.b,
            e
        }
    }, {
        key: "fromBufferAttribute",
        value: function(e, t) {
            return this.r = e.getX(t),
            this.g = e.getY(t),
            this.b = e.getZ(t),
            !0 === e.normalized && (this.r /= 255,
            this.g /= 255,
            this.b /= 255),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            return this.getHex()
        }
    }]),
    e
}();
Color.NAMES = _colorKeywords,
Color.prototype.isColor = !0,
Color.prototype.r = 1,
Color.prototype.g = 1,
Color.prototype.b = 1;
var MeshBasicMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshBasicMaterial",
        r.color = new Color(16777215),
        r.map = null,
        r.lightMap = null,
        r.lightMapIntensity = 1,
        r.aoMap = null,
        r.aoMapIntensity = 1,
        r.specularMap = null,
        r.alphaMap = null,
        r.envMap = null,
        r.combine = MultiplyOperation,
        r.reflectivity = 1,
        r.refractionRatio = .98,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.wireframeLinecap = "round",
        r.wireframeLinejoin = "round",
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.map = e.map,
            this.lightMap = e.lightMap,
            this.lightMapIntensity = e.lightMapIntensity,
            this.aoMap = e.aoMap,
            this.aoMapIntensity = e.aoMapIntensity,
            this.specularMap = e.specularMap,
            this.alphaMap = e.alphaMap,
            this.envMap = e.envMap,
            this.combine = e.combine,
            this.reflectivity = e.reflectivity,
            this.refractionRatio = e.refractionRatio,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.wireframeLinecap = e.wireframeLinecap,
            this.wireframeLinejoin = e.wireframeLinejoin,
            this
        }
    }]),
    i
}();
MeshBasicMaterial.prototype.isMeshBasicMaterial = !0;
var _vector$9 = new Vector3
  , _vector2$1 = new Vector2
  , BufferAttribute = function() {
    function e(t, i, r) {
        if (_classCallCheck2(this, e),
        Array.isArray(t))
            throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
        this.name = "",
        this.array = t,
        this.itemSize = i,
        this.count = void 0 !== t ? t.length / i : 0,
        this.normalized = !0 === r,
        this.usage = StaticDrawUsage,
        this.updateRange = {
            offset: 0,
            count: -1
        },
        this.version = 0
    }
    return _createClass2(e, [{
        key: "onUploadCallback",
        value: function() {}
    }, {
        key: "needsUpdate",
        set: function(e) {
            !0 === e && this.version++
        }
    }, {
        key: "setUsage",
        value: function(e) {
            return this.usage = e,
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.name = e.name,
            this.array = new e.array.constructor(e.array),
            this.itemSize = e.itemSize,
            this.count = e.count,
            this.normalized = e.normalized,
            this.usage = e.usage,
            this
        }
    }, {
        key: "copyAt",
        value: function(e, t, i) {
            e *= this.itemSize,
            i *= t.itemSize;
            for (var r = 0, n = this.itemSize; r < n; r++)
                this.array[e + r] = t.array[i + r];
            return this
        }
    }, {
        key: "copyArray",
        value: function(e) {
            return this.array.set(e),
            this
        }
    }, {
        key: "copyColorsArray",
        value: function(e) {
            for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                var a = e[r];
                void 0 === a && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", r),
                a = new Color),
                t[i++] = a.r,
                t[i++] = a.g,
                t[i++] = a.b
            }
            return this
        }
    }, {
        key: "copyVector2sArray",
        value: function(e) {
            for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                var a = e[r];
                void 0 === a && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", r),
                a = new Vector2),
                t[i++] = a.x,
                t[i++] = a.y
            }
            return this
        }
    }, {
        key: "copyVector3sArray",
        value: function(e) {
            for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                var a = e[r];
                void 0 === a && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", r),
                a = new Vector3),
                t[i++] = a.x,
                t[i++] = a.y,
                t[i++] = a.z
            }
            return this
        }
    }, {
        key: "copyVector4sArray",
        value: function(e) {
            for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                var a = e[r];
                void 0 === a && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", r),
                a = new Vector4),
                t[i++] = a.x,
                t[i++] = a.y,
                t[i++] = a.z,
                t[i++] = a.w
            }
            return this
        }
    }, {
        key: "applyMatrix3",
        value: function(e) {
            if (2 === this.itemSize)
                for (var t = 0, i = this.count; t < i; t++)
                    _vector2$1.fromBufferAttribute(this, t),
                    _vector2$1.applyMatrix3(e),
                    this.setXY(t, _vector2$1.x, _vector2$1.y);
            else if (3 === this.itemSize)
                for (var r = 0, n = this.count; r < n; r++)
                    _vector$9.fromBufferAttribute(this, r),
                    _vector$9.applyMatrix3(e),
                    this.setXYZ(r, _vector$9.x, _vector$9.y, _vector$9.z);
            return this
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            for (var t = 0, i = this.count; t < i; t++)
                _vector$9.x = this.getX(t),
                _vector$9.y = this.getY(t),
                _vector$9.z = this.getZ(t),
                _vector$9.applyMatrix4(e),
                this.setXYZ(t, _vector$9.x, _vector$9.y, _vector$9.z);
            return this
        }
    }, {
        key: "applyNormalMatrix",
        value: function(e) {
            for (var t = 0, i = this.count; t < i; t++)
                _vector$9.x = this.getX(t),
                _vector$9.y = this.getY(t),
                _vector$9.z = this.getZ(t),
                _vector$9.applyNormalMatrix(e),
                this.setXYZ(t, _vector$9.x, _vector$9.y, _vector$9.z);
            return this
        }
    }, {
        key: "transformDirection",
        value: function(e) {
            for (var t = 0, i = this.count; t < i; t++)
                _vector$9.x = this.getX(t),
                _vector$9.y = this.getY(t),
                _vector$9.z = this.getZ(t),
                _vector$9.transformDirection(e),
                this.setXYZ(t, _vector$9.x, _vector$9.y, _vector$9.z);
            return this
        }
    }, {
        key: "set",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.array.set(e, t),
            this
        }
    }, {
        key: "getX",
        value: function(e) {
            return this.array[e * this.itemSize]
        }
    }, {
        key: "setX",
        value: function(e, t) {
            return this.array[e * this.itemSize] = t,
            this
        }
    }, {
        key: "getY",
        value: function(e) {
            return this.array[e * this.itemSize + 1]
        }
    }, {
        key: "setY",
        value: function(e, t) {
            return this.array[e * this.itemSize + 1] = t,
            this
        }
    }, {
        key: "getZ",
        value: function(e) {
            return this.array[e * this.itemSize + 2]
        }
    }, {
        key: "setZ",
        value: function(e, t) {
            return this.array[e * this.itemSize + 2] = t,
            this
        }
    }, {
        key: "getW",
        value: function(e) {
            return this.array[e * this.itemSize + 3]
        }
    }, {
        key: "setW",
        value: function(e, t) {
            return this.array[e * this.itemSize + 3] = t,
            this
        }
    }, {
        key: "setXY",
        value: function(e, t, i) {
            return e *= this.itemSize,
            this.array[e + 0] = t,
            this.array[e + 1] = i,
            this
        }
    }, {
        key: "setXYZ",
        value: function(e, t, i, r) {
            return e *= this.itemSize,
            this.array[e + 0] = t,
            this.array[e + 1] = i,
            this.array[e + 2] = r,
            this
        }
    }, {
        key: "setXYZW",
        value: function(e, t, i, r, n) {
            return e *= this.itemSize,
            this.array[e + 0] = t,
            this.array[e + 1] = i,
            this.array[e + 2] = r,
            this.array[e + 3] = n,
            this
        }
    }, {
        key: "onUpload",
        value: function(e) {
            return this.onUploadCallback = e,
            this
        }
    }, {
        key: "clone",
        value: function() {
            return new this.constructor(this.array,this.itemSize).copy(this)
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = {
                itemSize: this.itemSize,
                type: this.array.constructor.name,
                array: Array.prototype.slice.call(this.array),
                normalized: this.normalized
            };
            return "" !== this.name && (e.name = this.name),
            this.usage !== StaticDrawUsage && (e.usage = this.usage),
            0 === this.updateRange.offset && -1 === this.updateRange.count || (e.updateRange = this.updateRange),
            e
        }
    }]),
    e
}();
BufferAttribute.prototype.isBufferAttribute = !0;
var Uint16BufferAttribute = function(e) {
    _inherits(i, BufferAttribute);
    var t = _createSuper(i);
    function i(e, r, n) {
        return _classCallCheck2(this, i),
        t.call(this, new Uint16Array(e), r, n)
    }
    return _createClass2(i)
}()
  , Uint32BufferAttribute = function(e) {
    _inherits(i, BufferAttribute);
    var t = _createSuper(i);
    function i(e, r, n) {
        return _classCallCheck2(this, i),
        t.call(this, new Uint32Array(e), r, n)
    }
    return _createClass2(i)
}()
  , Float16BufferAttribute = function(e) {
    _inherits(i, BufferAttribute);
    var t = _createSuper(i);
    function i(e, r, n) {
        return _classCallCheck2(this, i),
        t.call(this, new Uint16Array(e), r, n)
    }
    return _createClass2(i)
}();
Float16BufferAttribute.prototype.isFloat16BufferAttribute = !0;
var Float32BufferAttribute = function(e) {
    _inherits(i, BufferAttribute);
    var t = _createSuper(i);
    function i(e, r, n) {
        return _classCallCheck2(this, i),
        t.call(this, new Float32Array(e), r, n)
    }
    return _createClass2(i)
}()
  , _id = 0
  , _m1$3 = new Matrix4
  , _obj = new Object3D
  , _offset = new Vector3
  , _box$1 = new Box3
  , _boxMorphTargets = new Box3
  , _vector$8 = new Vector3
  , BufferGeometry = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        e = t.call(this),
        Object.defineProperty(_assertThisInitialized(e), "id", {
            value: _id++
        }),
        e.uuid = generateUUID(),
        e.name = "",
        e.type = "BufferGeometry",
        e.index = null,
        e.attributes = {},
        e.morphAttributes = {},
        e.morphTargetsRelative = !1,
        e.groups = [],
        e.boundingBox = null,
        e.boundingSphere = null,
        e.drawRange = {
            start: 0,
            count: 1 / 0
        },
        e.userData = {},
        e
    }
    return _createClass2(i, [{
        key: "getIndex",
        value: function() {
            return this.index
        }
    }, {
        key: "setIndex",
        value: function(e) {
            return Array.isArray(e) ? this.index = new (arrayMax(e) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute)(e,1) : this.index = e,
            this
        }
    }, {
        key: "getAttribute",
        value: function(e) {
            return this.attributes[e]
        }
    }, {
        key: "setAttribute",
        value: function(e, t) {
            return this.attributes[e] = t,
            this
        }
    }, {
        key: "deleteAttribute",
        value: function(e) {
            return delete this.attributes[e],
            this
        }
    }, {
        key: "hasAttribute",
        value: function(e) {
            return void 0 !== this.attributes[e]
        }
    }, {
        key: "addGroup",
        value: function(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
            this.groups.push({
                start: e,
                count: t,
                materialIndex: i
            })
        }
    }, {
        key: "clearGroups",
        value: function() {
            this.groups = []
        }
    }, {
        key: "setDrawRange",
        value: function(e, t) {
            this.drawRange.start = e,
            this.drawRange.count = t
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            var t = this.attributes.position;
            void 0 !== t && (t.applyMatrix4(e),
            t.needsUpdate = !0);
            var i = this.attributes.normal;
            if (void 0 !== i) {
                var r = (new Matrix3).getNormalMatrix(e);
                i.applyNormalMatrix(r),
                i.needsUpdate = !0
            }
            var n = this.attributes.tangent;
            return void 0 !== n && (n.transformDirection(e),
            n.needsUpdate = !0),
            null !== this.boundingBox && this.computeBoundingBox(),
            null !== this.boundingSphere && this.computeBoundingSphere(),
            this
        }
    }, {
        key: "applyQuaternion",
        value: function(e) {
            return _m1$3.makeRotationFromQuaternion(e),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "rotateX",
        value: function(e) {
            return _m1$3.makeRotationX(e),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "rotateY",
        value: function(e) {
            return _m1$3.makeRotationY(e),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "rotateZ",
        value: function(e) {
            return _m1$3.makeRotationZ(e),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "translate",
        value: function(e, t, i) {
            return _m1$3.makeTranslation(e, t, i),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "scale",
        value: function(e, t, i) {
            return _m1$3.makeScale(e, t, i),
            this.applyMatrix4(_m1$3),
            this
        }
    }, {
        key: "lookAt",
        value: function(e) {
            return _obj.lookAt(e),
            _obj.updateMatrix(),
            this.applyMatrix4(_obj.matrix),
            this
        }
    }, {
        key: "center",
        value: function() {
            return this.computeBoundingBox(),
            this.boundingBox.getCenter(_offset).negate(),
            this.translate(_offset.x, _offset.y, _offset.z),
            this
        }
    }, {
        key: "setFromPoints",
        value: function(e) {
            for (var t = [], i = 0, r = e.length; i < r; i++) {
                var n = e[i];
                t.push(n.x, n.y, n.z || 0)
            }
            return this.setAttribute("position", new Float32BufferAttribute(t,3)),
            this
        }
    }, {
        key: "computeBoundingBox",
        value: function() {
            null === this.boundingBox && (this.boundingBox = new Box3);
            var e = this.attributes.position
              , t = this.morphAttributes.position;
            if (e && e.isGLBufferAttribute)
                return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".', this),
                void this.boundingBox.set(new Vector3(-1 / 0,-1 / 0,-1 / 0), new Vector3(1 / 0,1 / 0,1 / 0));
            if (void 0 !== e) {
                if (this.boundingBox.setFromBufferAttribute(e),
                t)
                    for (var i = 0, r = t.length; i < r; i++) {
                        var n = t[i];
                        _box$1.setFromBufferAttribute(n),
                        this.morphTargetsRelative ? (_vector$8.addVectors(this.boundingBox.min, _box$1.min),
                        this.boundingBox.expandByPoint(_vector$8),
                        _vector$8.addVectors(this.boundingBox.max, _box$1.max),
                        this.boundingBox.expandByPoint(_vector$8)) : (this.boundingBox.expandByPoint(_box$1.min),
                        this.boundingBox.expandByPoint(_box$1.max))
                    }
            } else
                this.boundingBox.makeEmpty();
            (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this)
        }
    }, {
        key: "computeBoundingSphere",
        value: function() {
            null === this.boundingSphere && (this.boundingSphere = new Sphere);
            var e = this.attributes.position
              , t = this.morphAttributes.position;
            if (e && e.isGLBufferAttribute)
                return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".', this),
                void this.boundingSphere.set(new Vector3, 1 / 0);
            if (e) {
                var i = this.boundingSphere.center;
                if (_box$1.setFromBufferAttribute(e),
                t)
                    for (var r = 0, n = t.length; r < n; r++) {
                        var a = t[r];
                        _boxMorphTargets.setFromBufferAttribute(a),
                        this.morphTargetsRelative ? (_vector$8.addVectors(_box$1.min, _boxMorphTargets.min),
                        _box$1.expandByPoint(_vector$8),
                        _vector$8.addVectors(_box$1.max, _boxMorphTargets.max),
                        _box$1.expandByPoint(_vector$8)) : (_box$1.expandByPoint(_boxMorphTargets.min),
                        _box$1.expandByPoint(_boxMorphTargets.max))
                    }
                _box$1.getCenter(i);
                for (var o = 0, s = 0, l = e.count; s < l; s++)
                    _vector$8.fromBufferAttribute(e, s),
                    o = Math.max(o, i.distanceToSquared(_vector$8));
                if (t)
                    for (var h = 0, c = t.length; h < c; h++)
                        for (var p = t[h], u = this.morphTargetsRelative, d = 0, f = p.count; d < f; d++)
                            _vector$8.fromBufferAttribute(p, d),
                            u && (_offset.fromBufferAttribute(e, d),
                            _vector$8.add(_offset)),
                            o = Math.max(o, i.distanceToSquared(_vector$8));
                this.boundingSphere.radius = Math.sqrt(o),
                isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this)
            }
        }
    }, {
        key: "computeTangents",
        value: function() {
            var e = this.index
              , t = this.attributes;
            if (null !== e && void 0 !== t.position && void 0 !== t.normal && void 0 !== t.uv) {
                var i = e.array
                  , r = t.position.array
                  , n = t.normal.array
                  , a = t.uv.array
                  , o = r.length / 3;
                void 0 === t.tangent && this.setAttribute("tangent", new BufferAttribute(new Float32Array(4 * o),4));
                for (var s = t.tangent.array, l = [], h = [], c = 0; c < o; c++)
                    l[c] = new Vector3,
                    h[c] = new Vector3;
                var p = new Vector3
                  , u = new Vector3
                  , d = new Vector3
                  , f = new Vector2
                  , m = new Vector2
                  , g = new Vector2
                  , v = new Vector3
                  , y = new Vector3
                  , _ = this.groups;
                0 === _.length && (_ = [{
                    start: 0,
                    count: i.length
                }]);
                for (var b = 0, x = _.length; b < x; ++b)
                    for (var w = _[b], S = w.start, T = S, k = S + w.count; T < k; T += 3)
                        B(i[T + 0], i[T + 1], i[T + 2]);
                for (var E = new Vector3, M = new Vector3, P = new Vector3, C = new Vector3, A = 0, L = _.length; A < L; ++A)
                    for (var D = _[A], I = D.start, R = I, F = I + D.count; R < F; R += 3)
                        O(i[R + 0]),
                        O(i[R + 1]),
                        O(i[R + 2])
            } else
                console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");
            function B(e, t, i) {
                p.fromArray(r, 3 * e),
                u.fromArray(r, 3 * t),
                d.fromArray(r, 3 * i),
                f.fromArray(a, 2 * e),
                m.fromArray(a, 2 * t),
                g.fromArray(a, 2 * i),
                u.sub(p),
                d.sub(p),
                m.sub(f),
                g.sub(f);
                var n = 1 / (m.x * g.y - g.x * m.y);
                isFinite(n) && (v.copy(u).multiplyScalar(g.y).addScaledVector(d, -m.y).multiplyScalar(n),
                y.copy(d).multiplyScalar(m.x).addScaledVector(u, -g.x).multiplyScalar(n),
                l[e].add(v),
                l[t].add(v),
                l[i].add(v),
                h[e].add(y),
                h[t].add(y),
                h[i].add(y))
            }
            function O(e) {
                P.fromArray(n, 3 * e),
                C.copy(P);
                var t = l[e];
                E.copy(t),
                E.sub(P.multiplyScalar(P.dot(t))).normalize(),
                M.crossVectors(C, t);
                var i = M.dot(h[e]) < 0 ? -1 : 1;
                s[4 * e] = E.x,
                s[4 * e + 1] = E.y,
                s[4 * e + 2] = E.z,
                s[4 * e + 3] = i
            }
        }
    }, {
        key: "computeVertexNormals",
        value: function() {
            var e = this.index
              , t = this.getAttribute("position");
            if (void 0 !== t) {
                var i = this.getAttribute("normal");
                if (void 0 === i)
                    i = new BufferAttribute(new Float32Array(3 * t.count),3),
                    this.setAttribute("normal", i);
                else
                    for (var r = 0, n = i.count; r < n; r++)
                        i.setXYZ(r, 0, 0, 0);
                var a = new Vector3
                  , o = new Vector3
                  , s = new Vector3
                  , l = new Vector3
                  , h = new Vector3
                  , c = new Vector3
                  , p = new Vector3
                  , u = new Vector3;
                if (e)
                    for (var d = 0, f = e.count; d < f; d += 3) {
                        var m = e.getX(d + 0)
                          , g = e.getX(d + 1)
                          , v = e.getX(d + 2);
                        a.fromBufferAttribute(t, m),
                        o.fromBufferAttribute(t, g),
                        s.fromBufferAttribute(t, v),
                        p.subVectors(s, o),
                        u.subVectors(a, o),
                        p.cross(u),
                        l.fromBufferAttribute(i, m),
                        h.fromBufferAttribute(i, g),
                        c.fromBufferAttribute(i, v),
                        l.add(p),
                        h.add(p),
                        c.add(p),
                        i.setXYZ(m, l.x, l.y, l.z),
                        i.setXYZ(g, h.x, h.y, h.z),
                        i.setXYZ(v, c.x, c.y, c.z)
                    }
                else
                    for (var y = 0, _ = t.count; y < _; y += 3)
                        a.fromBufferAttribute(t, y + 0),
                        o.fromBufferAttribute(t, y + 1),
                        s.fromBufferAttribute(t, y + 2),
                        p.subVectors(s, o),
                        u.subVectors(a, o),
                        p.cross(u),
                        i.setXYZ(y + 0, p.x, p.y, p.z),
                        i.setXYZ(y + 1, p.x, p.y, p.z),
                        i.setXYZ(y + 2, p.x, p.y, p.z);
                this.normalizeNormals(),
                i.needsUpdate = !0
            }
        }
    }, {
        key: "merge",
        value: function(e, t) {
            if (e && e.isBufferGeometry) {
                void 0 === t && (t = 0,
                console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
                var i = this.attributes;
                for (var r in i)
                    if (void 0 !== e.attributes[r])
                        for (var n = i[r].array, a = e.attributes[r], o = a.array, s = a.itemSize * t, l = Math.min(o.length, n.length - s), h = 0, c = s; h < l; h++,
                        c++)
                            n[c] = o[h];
                return this
            }
            console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", e)
        }
    }, {
        key: "normalizeNormals",
        value: function() {
            for (var e = this.attributes.normal, t = 0, i = e.count; t < i; t++)
                _vector$8.fromBufferAttribute(e, t),
                _vector$8.normalize(),
                e.setXYZ(t, _vector$8.x, _vector$8.y, _vector$8.z)
        }
    }, {
        key: "toNonIndexed",
        value: function() {
            function e(e, t) {
                for (var i = e.array, r = e.itemSize, n = e.normalized, a = new i.constructor(t.length * r), o = 0, s = 0, l = 0, h = t.length; l < h; l++) {
                    o = e.isInterleavedBufferAttribute ? t[l] * e.data.stride + e.offset : t[l] * r;
                    for (var c = 0; c < r; c++)
                        a[s++] = i[o++]
                }
                return new BufferAttribute(a,r,n)
            }
            if (null === this.index)
                return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),
                this;
            var t = new i
              , r = this.index.array
              , n = this.attributes;
            for (var a in n) {
                var o = e(n[a], r);
                t.setAttribute(a, o)
            }
            var s = this.morphAttributes;
            for (var l in s) {
                for (var h = [], c = s[l], p = 0, u = c.length; p < u; p++) {
                    var d = e(c[p], r);
                    h.push(d)
                }
                t.morphAttributes[l] = h
            }
            t.morphTargetsRelative = this.morphTargetsRelative;
            for (var f = this.groups, m = 0, g = f.length; m < g; m++) {
                var v = f[m];
                t.addGroup(v.start, v.count, v.materialIndex)
            }
            return t
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = {
                metadata: {
                    version: 4.5,
                    type: "BufferGeometry",
                    generator: "BufferGeometry.toJSON"
                }
            };
            if (e.uuid = this.uuid,
            e.type = this.type,
            "" !== this.name && (e.name = this.name),
            Object.keys(this.userData).length > 0 && (e.userData = this.userData),
            void 0 !== this.parameters) {
                var t = this.parameters;
                for (var i in t)
                    void 0 !== t[i] && (e[i] = t[i]);
                return e
            }
            e.data = {
                attributes: {}
            };
            var r = this.index;
            null !== r && (e.data.index = {
                type: r.array.constructor.name,
                array: Array.prototype.slice.call(r.array)
            });
            var n = this.attributes;
            for (var a in n) {
                var o = n[a];
                e.data.attributes[a] = o.toJSON(e.data)
            }
            var s = {}
              , l = !1;
            for (var h in this.morphAttributes) {
                for (var c = this.morphAttributes[h], p = [], u = 0, d = c.length; u < d; u++) {
                    var f = c[u];
                    p.push(f.toJSON(e.data))
                }
                p.length > 0 && (s[h] = p,
                l = !0)
            }
            l && (e.data.morphAttributes = s,
            e.data.morphTargetsRelative = this.morphTargetsRelative);
            var m = this.groups;
            m.length > 0 && (e.data.groups = JSON.parse(JSON.stringify(m)));
            var g = this.boundingSphere;
            return null !== g && (e.data.boundingSphere = {
                center: g.center.toArray(),
                radius: g.radius
            }),
            e
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            this.index = null,
            this.attributes = {},
            this.morphAttributes = {},
            this.groups = [],
            this.boundingBox = null,
            this.boundingSphere = null;
            var t = {};
            this.name = e.name;
            var i = e.index;
            null !== i && this.setIndex(i.clone(t));
            var r = e.attributes;
            for (var n in r) {
                var a = r[n];
                this.setAttribute(n, a.clone(t))
            }
            var o = e.morphAttributes;
            for (var s in o) {
                for (var l = [], h = o[s], c = 0, p = h.length; c < p; c++)
                    l.push(h[c].clone(t));
                this.morphAttributes[s] = l
            }
            this.morphTargetsRelative = e.morphTargetsRelative;
            for (var u = e.groups, d = 0, f = u.length; d < f; d++) {
                var m = u[d];
                this.addGroup(m.start, m.count, m.materialIndex)
            }
            var g = e.boundingBox;
            null !== g && (this.boundingBox = g.clone());
            var v = e.boundingSphere;
            return null !== v && (this.boundingSphere = v.clone()),
            this.drawRange.start = e.drawRange.start,
            this.drawRange.count = e.drawRange.count,
            this.userData = e.userData,
            void 0 !== e.parameters && (this.parameters = Object.assign({}, e.parameters)),
            this
        }
    }, {
        key: "dispose",
        value: function() {
            this.dispatchEvent({
                type: "dispose"
            })
        }
    }]),
    i
}();
BufferGeometry.prototype.isBufferGeometry = !0;
var _inverseMatrix$2 = new Matrix4
  , _ray$2 = new Ray
  , _sphere$3$1 = new Sphere
  , _vA$1 = new Vector3
  , _vB$1 = new Vector3
  , _vC$1 = new Vector3
  , _tempA = new Vector3
  , _tempB = new Vector3
  , _tempC = new Vector3
  , _morphA = new Vector3
  , _morphB = new Vector3
  , _morphC = new Vector3
  , _uvA$1 = new Vector2
  , _uvB$1 = new Vector2
  , _uvC$1 = new Vector2
  , _intersectionPoint = new Vector3
  , _intersectionPointWorld = new Vector3
  , Mesh = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new BufferGeometry, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new MeshBasicMaterial;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Mesh",
        e.geometry = r,
        e.material = n,
        e.updateMorphTargets(),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            void 0 !== e.morphTargetInfluences && (this.morphTargetInfluences = e.morphTargetInfluences.slice()),
            void 0 !== e.morphTargetDictionary && (this.morphTargetDictionary = Object.assign({}, e.morphTargetDictionary)),
            this.material = e.material,
            this.geometry = e.geometry,
            this
        }
    }, {
        key: "updateMorphTargets",
        value: function() {
            var e = this.geometry;
            if (e.isBufferGeometry) {
                var t = e.morphAttributes
                  , i = Object.keys(t);
                if (i.length > 0) {
                    var r = t[i[0]];
                    if (void 0 !== r) {
                        this.morphTargetInfluences = [],
                        this.morphTargetDictionary = {};
                        for (var n = 0, a = r.length; n < a; n++) {
                            var o = r[n].name || String(n);
                            this.morphTargetInfluences.push(0),
                            this.morphTargetDictionary[o] = n
                        }
                    }
                }
            } else {
                var s = e.morphTargets;
                void 0 !== s && s.length > 0 && console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")
            }
        }
    }, {
        key: "raycast",
        value: function(e, t) {
            var i, r = this.geometry, n = this.material, a = this.matrixWorld;
            if (void 0 !== n && (null === r.boundingSphere && r.computeBoundingSphere(),
            _sphere$3$1.copy(r.boundingSphere),
            _sphere$3$1.applyMatrix4(a),
            !1 !== e.ray.intersectsSphere(_sphere$3$1) && (_inverseMatrix$2.copy(a).invert(),
            _ray$2.copy(e.ray).applyMatrix4(_inverseMatrix$2),
            null === r.boundingBox || !1 !== _ray$2.intersectsBox(r.boundingBox))))
                if (r.isBufferGeometry) {
                    var o = r.index
                      , s = r.attributes.position
                      , l = r.morphAttributes.position
                      , h = r.morphTargetsRelative
                      , c = r.attributes.uv
                      , p = r.attributes.uv2
                      , u = r.groups
                      , d = r.drawRange;
                    if (null !== o)
                        if (Array.isArray(n))
                            for (var f = 0, m = u.length; f < m; f++)
                                for (var g = u[f], v = n[g.materialIndex], y = Math.max(g.start, d.start), _ = Math.min(o.count, Math.min(g.start + g.count, d.start + d.count)); y < _; y += 3) {
                                    var b = o.getX(y)
                                      , x = o.getX(y + 1)
                                      , w = o.getX(y + 2);
                                    (i = checkBufferGeometryIntersection(this, v, e, _ray$2, s, l, h, c, p, b, x, w)) && (i.faceIndex = Math.floor(y / 3),
                                    i.face.materialIndex = g.materialIndex,
                                    t.push(i))
                                }
                        else
                            for (var S = Math.max(0, d.start), T = Math.min(o.count, d.start + d.count); S < T; S += 3) {
                                var k = o.getX(S)
                                  , E = o.getX(S + 1)
                                  , M = o.getX(S + 2);
                                (i = checkBufferGeometryIntersection(this, n, e, _ray$2, s, l, h, c, p, k, E, M)) && (i.faceIndex = Math.floor(S / 3),
                                t.push(i))
                            }
                    else if (void 0 !== s)
                        if (Array.isArray(n))
                            for (var P = 0, C = u.length; P < C; P++)
                                for (var A = u[P], L = n[A.materialIndex], D = Math.max(A.start, d.start), I = Math.min(s.count, Math.min(A.start + A.count, d.start + d.count)); D < I; D += 3)
                                    (i = checkBufferGeometryIntersection(this, L, e, _ray$2, s, l, h, c, p, D, D + 1, D + 2)) && (i.faceIndex = Math.floor(D / 3),
                                    i.face.materialIndex = A.materialIndex,
                                    t.push(i));
                        else
                            for (var R = Math.max(0, d.start), F = Math.min(s.count, d.start + d.count); R < F; R += 3)
                                (i = checkBufferGeometryIntersection(this, n, e, _ray$2, s, l, h, c, p, R, R + 1, R + 2)) && (i.faceIndex = Math.floor(R / 3),
                                t.push(i))
                } else
                    r.isGeometry && console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")
        }
    }]),
    i
}();
function checkIntersection(e, t, i, r, n, a, o, s) {
    if (null === (t.side === BackSide ? r.intersectTriangle(o, a, n, !0, s) : r.intersectTriangle(n, a, o, t.side !== DoubleSide, s)))
        return null;
    _intersectionPointWorld.copy(s),
    _intersectionPointWorld.applyMatrix4(e.matrixWorld);
    var l = i.ray.origin.distanceTo(_intersectionPointWorld);
    return l < i.near || l > i.far ? null : {
        distance: l,
        point: _intersectionPointWorld.clone(),
        object: e
    }
}
function checkBufferGeometryIntersection(e, t, i, r, n, a, o, s, l, h, c, p) {
    _vA$1.fromBufferAttribute(n, h),
    _vB$1.fromBufferAttribute(n, c),
    _vC$1.fromBufferAttribute(n, p);
    var u = e.morphTargetInfluences;
    if (a && u) {
        _morphA.set(0, 0, 0),
        _morphB.set(0, 0, 0),
        _morphC.set(0, 0, 0);
        for (var d = 0, f = a.length; d < f; d++) {
            var m = u[d]
              , g = a[d];
            0 !== m && (_tempA.fromBufferAttribute(g, h),
            _tempB.fromBufferAttribute(g, c),
            _tempC.fromBufferAttribute(g, p),
            o ? (_morphA.addScaledVector(_tempA, m),
            _morphB.addScaledVector(_tempB, m),
            _morphC.addScaledVector(_tempC, m)) : (_morphA.addScaledVector(_tempA.sub(_vA$1), m),
            _morphB.addScaledVector(_tempB.sub(_vB$1), m),
            _morphC.addScaledVector(_tempC.sub(_vC$1), m)))
        }
        _vA$1.add(_morphA),
        _vB$1.add(_morphB),
        _vC$1.add(_morphC)
    }
    e.isSkinnedMesh && (e.boneTransform(h, _vA$1),
    e.boneTransform(c, _vB$1),
    e.boneTransform(p, _vC$1));
    var v = checkIntersection(e, t, i, r, _vA$1, _vB$1, _vC$1, _intersectionPoint);
    if (v) {
        s && (_uvA$1.fromBufferAttribute(s, h),
        _uvB$1.fromBufferAttribute(s, c),
        _uvC$1.fromBufferAttribute(s, p),
        v.uv = Triangle.getUV(_intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2)),
        l && (_uvA$1.fromBufferAttribute(l, h),
        _uvB$1.fromBufferAttribute(l, c),
        _uvC$1.fromBufferAttribute(l, p),
        v.uv2 = Triangle.getUV(_intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2));
        var y = {
            a: h,
            b: c,
            c: p,
            normal: new Vector3,
            materialIndex: 0
        };
        Triangle.getNormal(_vA$1, _vB$1, _vC$1, y.normal),
        v.face = y
    }
    return v
}
Mesh.prototype.isMesh = !0;
var BoxGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 1;
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "BoxGeometry",
        e.parameters = {
            width: r,
            height: n,
            depth: a,
            widthSegments: o,
            heightSegments: s,
            depthSegments: l
        };
        var h = _assertThisInitialized(e);
        o = Math.floor(o),
        s = Math.floor(s),
        l = Math.floor(l);
        var c = []
          , p = []
          , u = []
          , d = []
          , f = 0
          , m = 0;
        function g(e, t, i, r, n, a, o, s, l, g, v) {
            for (var y = a / l, _ = o / g, b = a / 2, x = o / 2, w = s / 2, S = l + 1, T = g + 1, k = 0, E = 0, M = new Vector3, P = 0; P < T; P++)
                for (var C = P * _ - x, A = 0; A < S; A++) {
                    var L = A * y - b;
                    M[e] = L * r,
                    M[t] = C * n,
                    M[i] = w,
                    p.push(M.x, M.y, M.z),
                    M[e] = 0,
                    M[t] = 0,
                    M[i] = s > 0 ? 1 : -1,
                    u.push(M.x, M.y, M.z),
                    d.push(A / l),
                    d.push(1 - P / g),
                    k += 1
                }
            for (var D = 0; D < g; D++)
                for (var I = 0; I < l; I++) {
                    var R = f + I + S * D
                      , F = f + I + S * (D + 1)
                      , B = f + (I + 1) + S * (D + 1)
                      , O = f + (I + 1) + S * D;
                    c.push(R, F, O),
                    c.push(F, B, O),
                    E += 6
                }
            h.addGroup(m, E, v),
            m += E,
            f += k
        }
        return g("z", "y", "x", -1, -1, a, n, r, l, s, 0),
        g("z", "y", "x", 1, -1, a, n, -r, l, s, 1),
        g("x", "z", "y", 1, 1, r, a, n, o, l, 2),
        g("x", "z", "y", 1, -1, r, a, -n, o, l, 3),
        g("x", "y", "z", 1, -1, r, n, a, o, s, 4),
        g("x", "y", "z", -1, -1, r, n, -a, o, s, 5),
        e.setIndex(c),
        e.setAttribute("position", new Float32BufferAttribute(p,3)),
        e.setAttribute("normal", new Float32BufferAttribute(u,3)),
        e.setAttribute("uv", new Float32BufferAttribute(d,2)),
        e
    }
    return _createClass2(i, null, [{
        key: "fromJSON",
        value: function(e) {
            return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)
        }
    }]),
    i
}();
function cloneUniforms(e) {
    var t = {};
    for (var i in e)
        for (var r in t[i] = {},
        e[i]) {
            var n = e[i][r];
            n && (n.isColor || n.isMatrix3 || n.isMatrix4 || n.isVector2 || n.isVector3 || n.isVector4 || n.isTexture || n.isQuaternion) ? t[i][r] = n.clone() : Array.isArray(n) ? t[i][r] = n.slice() : t[i][r] = n
        }
    return t
}
function mergeUniforms(e) {
    for (var t = {}, i = 0; i < e.length; i++) {
        var r = cloneUniforms(e[i]);
        for (var n in r)
            t[n] = r[n]
    }
    return t
}
var UniformsUtils = {
    clone: cloneUniforms,
    merge: mergeUniforms
}
  , default_vertex = "void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"
  , default_fragment = "void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}"
  , ShaderMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "ShaderMaterial",
        r.defines = {},
        r.uniforms = {},
        r.vertexShader = default_vertex,
        r.fragmentShader = default_fragment,
        r.linewidth = 1,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.fog = !1,
        r.lights = !1,
        r.clipping = !1,
        r.extensions = {
            derivatives: !1,
            fragDepth: !1,
            drawBuffers: !1,
            shaderTextureLOD: !1
        },
        r.defaultAttributeValues = {
            color: [1, 1, 1],
            uv: [0, 0],
            uv2: [0, 0]
        },
        r.index0AttributeName = void 0,
        r.uniformsNeedUpdate = !1,
        r.glslVersion = null,
        void 0 !== e && (void 0 !== e.attributes && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),
        r.setValues(e)),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.fragmentShader = e.fragmentShader,
            this.vertexShader = e.vertexShader,
            this.uniforms = cloneUniforms(e.uniforms),
            this.defines = Object.assign({}, e.defines),
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.lights = e.lights,
            this.clipping = e.clipping,
            this.extensions = Object.assign({}, e.extensions),
            this.glslVersion = e.glslVersion,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            for (var r in t.glslVersion = this.glslVersion,
            t.uniforms = {},
            this.uniforms) {
                var n = this.uniforms[r].value;
                n && n.isTexture ? t.uniforms[r] = {
                    type: "t",
                    value: n.toJSON(e).uuid
                } : n && n.isColor ? t.uniforms[r] = {
                    type: "c",
                    value: n.getHex()
                } : n && n.isVector2 ? t.uniforms[r] = {
                    type: "v2",
                    value: n.toArray()
                } : n && n.isVector3 ? t.uniforms[r] = {
                    type: "v3",
                    value: n.toArray()
                } : n && n.isVector4 ? t.uniforms[r] = {
                    type: "v4",
                    value: n.toArray()
                } : n && n.isMatrix3 ? t.uniforms[r] = {
                    type: "m3",
                    value: n.toArray()
                } : n && n.isMatrix4 ? t.uniforms[r] = {
                    type: "m4",
                    value: n.toArray()
                } : t.uniforms[r] = {
                    value: n
                }
            }
            Object.keys(this.defines).length > 0 && (t.defines = this.defines),
            t.vertexShader = this.vertexShader,
            t.fragmentShader = this.fragmentShader;
            var a = {};
            for (var o in this.extensions)
                !0 === this.extensions[o] && (a[o] = !0);
            return Object.keys(a).length > 0 && (t.extensions = a),
            t
        }
    }]),
    i
}();
ShaderMaterial.prototype.isShaderMaterial = !0;
var Camera = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Camera",
        e.matrixWorldInverse = new Matrix4,
        e.projectionMatrix = new Matrix4,
        e.projectionMatrixInverse = new Matrix4,
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e, t) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e, t),
            this.matrixWorldInverse.copy(e.matrixWorldInverse),
            this.projectionMatrix.copy(e.projectionMatrix),
            this.projectionMatrixInverse.copy(e.projectionMatrixInverse),
            this
        }
    }, {
        key: "getWorldDirection",
        value: function(e) {
            this.updateWorldMatrix(!0, !1);
            var t = this.matrixWorld.elements;
            return e.set(-t[8], -t[9], -t[10]).normalize()
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e),
            this.matrixWorldInverse.copy(this.matrixWorld).invert()
        }
    }, {
        key: "updateWorldMatrix",
        value: function(e, t) {
            _get(_getPrototypeOf(i.prototype), "updateWorldMatrix", this).call(this, e, t),
            this.matrixWorldInverse.copy(this.matrixWorld).invert()
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    i
}();
Camera.prototype.isCamera = !0;
var PerspectiveCamera = function(e) {
    _inherits(i, Camera);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 50, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 2e3;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "PerspectiveCamera",
        e.fov = r,
        e.zoom = 1,
        e.near = a,
        e.far = o,
        e.focus = 10,
        e.aspect = n,
        e.view = null,
        e.filmGauge = 35,
        e.filmOffset = 0,
        e.updateProjectionMatrix(),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e, t) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e, t),
            this.fov = e.fov,
            this.zoom = e.zoom,
            this.near = e.near,
            this.far = e.far,
            this.focus = e.focus,
            this.aspect = e.aspect,
            this.view = null === e.view ? null : Object.assign({}, e.view),
            this.filmGauge = e.filmGauge,
            this.filmOffset = e.filmOffset,
            this
        }
    }, {
        key: "setFocalLength",
        value: function(e) {
            var t = .5 * this.getFilmHeight() / e;
            this.fov = 2 * RAD2DEG * Math.atan(t),
            this.updateProjectionMatrix()
        }
    }, {
        key: "getFocalLength",
        value: function() {
            var e = Math.tan(.5 * DEG2RAD * this.fov);
            return .5 * this.getFilmHeight() / e
        }
    }, {
        key: "getEffectiveFOV",
        value: function() {
            return 2 * RAD2DEG * Math.atan(Math.tan(.5 * DEG2RAD * this.fov) / this.zoom)
        }
    }, {
        key: "getFilmWidth",
        value: function() {
            return this.filmGauge * Math.min(this.aspect, 1)
        }
    }, {
        key: "getFilmHeight",
        value: function() {
            return this.filmGauge / Math.max(this.aspect, 1)
        }
    }, {
        key: "setViewOffset",
        value: function(e, t, i, r, n, a) {
            this.aspect = e / t,
            null === this.view && (this.view = {
                enabled: !0,
                fullWidth: 1,
                fullHeight: 1,
                offsetX: 0,
                offsetY: 0,
                width: 1,
                height: 1
            }),
            this.view.enabled = !0,
            this.view.fullWidth = e,
            this.view.fullHeight = t,
            this.view.offsetX = i,
            this.view.offsetY = r,
            this.view.width = n,
            this.view.height = a,
            this.updateProjectionMatrix()
        }
    }, {
        key: "clearViewOffset",
        value: function() {
            null !== this.view && (this.view.enabled = !1),
            this.updateProjectionMatrix()
        }
    }, {
        key: "updateProjectionMatrix",
        value: function() {
            var e = this.near
              , t = e * Math.tan(.5 * DEG2RAD * this.fov) / this.zoom
              , i = 2 * t
              , r = this.aspect * i
              , n = -.5 * r
              , a = this.view;
            if (null !== this.view && this.view.enabled) {
                var o = a.fullWidth
                  , s = a.fullHeight;
                n += a.offsetX * r / o,
                t -= a.offsetY * i / s,
                r *= a.width / o,
                i *= a.height / s
            }
            var l = this.filmOffset;
            0 !== l && (n += e * l / this.getFilmWidth()),
            this.projectionMatrix.makePerspective(n, n + r, t, t - i, e, this.far),
            this.projectionMatrixInverse.copy(this.projectionMatrix).invert()
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.object.fov = this.fov,
            t.object.zoom = this.zoom,
            t.object.near = this.near,
            t.object.far = this.far,
            t.object.focus = this.focus,
            t.object.aspect = this.aspect,
            null !== this.view && (t.object.view = Object.assign({}, this.view)),
            t.object.filmGauge = this.filmGauge,
            t.object.filmOffset = this.filmOffset,
            t
        }
    }]),
    i
}();
PerspectiveCamera.prototype.isPerspectiveCamera = !0;
var fov = 90
  , aspect = 1
  , CubeCamera = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        if (_classCallCheck2(this, i),
        (a = t.call(this)).type = "CubeCamera",
        !0 !== n.isWebGLCubeRenderTarget)
            return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),
            _possibleConstructorReturn(a);
        a.renderTarget = n;
        var o = new PerspectiveCamera(fov,aspect,e,r);
        o.layers = a.layers,
        o.up.set(0, -1, 0),
        o.lookAt(new Vector3(1,0,0)),
        a.add(o);
        var s = new PerspectiveCamera(fov,aspect,e,r);
        s.layers = a.layers,
        s.up.set(0, -1, 0),
        s.lookAt(new Vector3(-1,0,0)),
        a.add(s);
        var l = new PerspectiveCamera(fov,aspect,e,r);
        l.layers = a.layers,
        l.up.set(0, 0, 1),
        l.lookAt(new Vector3(0,1,0)),
        a.add(l);
        var h = new PerspectiveCamera(fov,aspect,e,r);
        h.layers = a.layers,
        h.up.set(0, 0, -1),
        h.lookAt(new Vector3(0,-1,0)),
        a.add(h);
        var c = new PerspectiveCamera(fov,aspect,e,r);
        c.layers = a.layers,
        c.up.set(0, -1, 0),
        c.lookAt(new Vector3(0,0,1)),
        a.add(c);
        var p = new PerspectiveCamera(fov,aspect,e,r);
        return p.layers = a.layers,
        p.up.set(0, -1, 0),
        p.lookAt(new Vector3(0,0,-1)),
        a.add(p),
        a
    }
    return _createClass2(i, [{
        key: "update",
        value: function(e, t) {
            null === this.parent && this.updateMatrixWorld();
            var i = this.renderTarget
              , r = _slicedToArray(this.children, 6)
              , n = r[0]
              , a = r[1]
              , o = r[2]
              , s = r[3]
              , l = r[4]
              , h = r[5]
              , c = e.xr.enabled
              , p = e.getRenderTarget();
            e.xr.enabled = !1;
            var u = i.texture.generateMipmaps;
            i.texture.generateMipmaps = !1,
            e.setRenderTarget(i, 0),
            e.render(t, n),
            e.setRenderTarget(i, 1),
            e.render(t, a),
            e.setRenderTarget(i, 2),
            e.render(t, o),
            e.setRenderTarget(i, 3),
            e.render(t, s),
            e.setRenderTarget(i, 4),
            e.render(t, l),
            i.texture.generateMipmaps = u,
            e.setRenderTarget(i, 5),
            e.render(t, h),
            e.setRenderTarget(p),
            e.xr.enabled = c
        }
    }]),
    i
}()
  , CubeTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s, l, h, c, p) {
        var u;
        return _classCallCheck2(this, i),
        e = void 0 !== e ? e : [],
        r = void 0 !== r ? r : CubeReflectionMapping,
        (u = t.call(this, e, r, n, a, o, s, l, h, c, p)).flipY = !1,
        u
    }
    return _createClass2(i, [{
        key: "images",
        get: function() {
            return this.image
        },
        set: function(e) {
            this.image = e
        }
    }]),
    i
}();
CubeTexture.prototype.isCubeTexture = !0;
var WebGLCubeRenderTarget = function(e) {
    _inherits(i, WebGLRenderTarget);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        return _classCallCheck2(this, i),
        Number.isInteger(r) && (console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),
        r = n),
        a = t.call(this, e, e, r),
        r = r || {},
        a.texture = new CubeTexture(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),
        a.texture.isRenderTargetTexture = !0,
        a.texture.generateMipmaps = void 0 !== r.generateMipmaps && r.generateMipmaps,
        a.texture.minFilter = void 0 !== r.minFilter ? r.minFilter : LinearFilter,
        a.texture._needsFlipEnvMap = !1,
        a
    }
    return _createClass2(i, [{
        key: "fromEquirectangularTexture",
        value: function(e, t) {
            this.texture.type = t.type,
            this.texture.format = RGBAFormat,
            this.texture.encoding = t.encoding,
            this.texture.generateMipmaps = t.generateMipmaps,
            this.texture.minFilter = t.minFilter,
            this.texture.magFilter = t.magFilter;
            var i = new BoxGeometry(5,5,5)
              , r = new ShaderMaterial({
                name: "CubemapFromEquirect",
                uniforms: cloneUniforms({
                    tEquirect: {
                        value: null
                    }
                }),
                vertexShader: "\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",
                fragmentShader: "\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",
                side: BackSide,
                blending: NoBlending
            });
            r.uniforms.tEquirect.value = t;
            var n = new Mesh(i,r)
              , a = t.minFilter;
            return t.minFilter === LinearMipmapLinearFilter && (t.minFilter = LinearFilter),
            new CubeCamera(1,10,this).update(e, n),
            t.minFilter = a,
            n.geometry.dispose(),
            n.material.dispose(),
            this
        }
    }, {
        key: "clear",
        value: function(e, t, i, r) {
            for (var n = e.getRenderTarget(), a = 0; a < 6; a++)
                e.setRenderTarget(this, a),
                e.clear(t, i, r);
            e.setRenderTarget(n)
        }
    }]),
    i
}();
WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget = !0;
var _vector1 = new Vector3
  , _vector2 = new Vector3
  , _normalMatrix = new Matrix3
  , Plane = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3(1,0,0)
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
        _classCallCheck2(this, e),
        this.normal = t,
        this.constant = i
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t) {
            return this.normal.copy(e),
            this.constant = t,
            this
        }
    }, {
        key: "setComponents",
        value: function(e, t, i, r) {
            return this.normal.set(e, t, i),
            this.constant = r,
            this
        }
    }, {
        key: "setFromNormalAndCoplanarPoint",
        value: function(e, t) {
            return this.normal.copy(e),
            this.constant = -t.dot(this.normal),
            this
        }
    }, {
        key: "setFromCoplanarPoints",
        value: function(e, t, i) {
            var r = _vector1.subVectors(i, t).cross(_vector2.subVectors(e, t)).normalize();
            return this.setFromNormalAndCoplanarPoint(r, e),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.normal.copy(e.normal),
            this.constant = e.constant,
            this
        }
    }, {
        key: "normalize",
        value: function() {
            var e = 1 / this.normal.length();
            return this.normal.multiplyScalar(e),
            this.constant *= e,
            this
        }
    }, {
        key: "negate",
        value: function() {
            return this.constant *= -1,
            this.normal.negate(),
            this
        }
    }, {
        key: "distanceToPoint",
        value: function(e) {
            return this.normal.dot(e) + this.constant
        }
    }, {
        key: "distanceToSphere",
        value: function(e) {
            return this.distanceToPoint(e.center) - e.radius
        }
    }, {
        key: "projectPoint",
        value: function(e, t) {
            return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)
        }
    }, {
        key: "intersectLine",
        value: function(e, t) {
            var i = e.delta(_vector1)
              , r = this.normal.dot(i);
            if (0 === r)
                return 0 === this.distanceToPoint(e.start) ? t.copy(e.start) : null;
            var n = -(e.start.dot(this.normal) + this.constant) / r;
            return n < 0 || n > 1 ? null : t.copy(i).multiplyScalar(n).add(e.start)
        }
    }, {
        key: "intersectsLine",
        value: function(e) {
            var t = this.distanceToPoint(e.start)
              , i = this.distanceToPoint(e.end);
            return t < 0 && i > 0 || i < 0 && t > 0
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            return e.intersectsPlane(this)
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            return e.intersectsPlane(this)
        }
    }, {
        key: "coplanarPoint",
        value: function(e) {
            return e.copy(this.normal).multiplyScalar(-this.constant)
        }
    }, {
        key: "applyMatrix4",
        value: function(e, t) {
            var i = t || _normalMatrix.getNormalMatrix(e)
              , r = this.coplanarPoint(_vector1).applyMatrix4(e)
              , n = this.normal.applyMatrix3(i).normalize();
            return this.constant = -r.dot(n),
            this
        }
    }, {
        key: "translate",
        value: function(e) {
            return this.constant -= e.dot(this.normal),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.normal.equals(this.normal) && e.constant === this.constant
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    e
}();
Plane.prototype.isPlane = !0;
var _sphere$2$1 = new Sphere
  , _vector$7 = new Vector3
  , Frustum = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Plane
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Plane
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Plane
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : new Plane
          , a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : new Plane
          , o = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : new Plane;
        _classCallCheck2(this, e),
        this.planes = [t, i, r, n, a, o]
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i, r, n, a) {
            var o = this.planes;
            return o[0].copy(e),
            o[1].copy(t),
            o[2].copy(i),
            o[3].copy(r),
            o[4].copy(n),
            o[5].copy(a),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            for (var t = this.planes, i = 0; i < 6; i++)
                t[i].copy(e.planes[i]);
            return this
        }
    }, {
        key: "setFromProjectionMatrix",
        value: function(e) {
            var t = this.planes
              , i = e.elements
              , r = i[0]
              , n = i[1]
              , a = i[2]
              , o = i[3]
              , s = i[4]
              , l = i[5]
              , h = i[6]
              , c = i[7]
              , p = i[8]
              , u = i[9]
              , d = i[10]
              , f = i[11]
              , m = i[12]
              , g = i[13]
              , v = i[14]
              , y = i[15];
            return t[0].setComponents(o - r, c - s, f - p, y - m).normalize(),
            t[1].setComponents(o + r, c + s, f + p, y + m).normalize(),
            t[2].setComponents(o + n, c + l, f + u, y + g).normalize(),
            t[3].setComponents(o - n, c - l, f - u, y - g).normalize(),
            t[4].setComponents(o - a, c - h, f - d, y - v).normalize(),
            t[5].setComponents(o + a, c + h, f + d, y + v).normalize(),
            this
        }
    }, {
        key: "intersectsObject",
        value: function(e) {
            var t = e.geometry;
            return null === t.boundingSphere && t.computeBoundingSphere(),
            _sphere$2$1.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),
            this.intersectsSphere(_sphere$2$1)
        }
    }, {
        key: "intersectsSprite",
        value: function(e) {
            return _sphere$2$1.center.set(0, 0, 0),
            _sphere$2$1.radius = .7071067811865476,
            _sphere$2$1.applyMatrix4(e.matrixWorld),
            this.intersectsSphere(_sphere$2$1)
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            for (var t = this.planes, i = e.center, r = -e.radius, n = 0; n < 6; n++)
                if (t[n].distanceToPoint(i) < r)
                    return !1;
            return !0
        }
    }, {
        key: "intersectsBox",
        value: function(e) {
            for (var t = this.planes, i = 0; i < 6; i++) {
                var r = t[i];
                if (_vector$7.x = r.normal.x > 0 ? e.max.x : e.min.x,
                _vector$7.y = r.normal.y > 0 ? e.max.y : e.min.y,
                _vector$7.z = r.normal.z > 0 ? e.max.z : e.min.z,
                r.distanceToPoint(_vector$7) < 0)
                    return !1
            }
            return !0
        }
    }, {
        key: "containsPoint",
        value: function(e) {
            for (var t = this.planes, i = 0; i < 6; i++)
                if (t[i].distanceToPoint(e) < 0)
                    return !1;
            return !0
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    e
}();
function WebGLAnimation() {
    var e = null
      , t = !1
      , i = null
      , r = null;
    function n(t, a) {
        i(t, a),
        r = e.requestAnimationFrame(n)
    }
    return {
        start: function() {
            !0 !== t && null !== i && (r = e.requestAnimationFrame(n),
            t = !0)
        },
        stop: function() {
            e.cancelAnimationFrame(r),
            t = !1
        },
        setAnimationLoop: function(e) {
            i = e
        },
        setContext: function(t) {
            e = t
        }
    }
}
function WebGLAttributes(e, t) {
    var i = t.isWebGL2
      , r = new WeakMap;
    return {
        get: function(e) {
            return e.isInterleavedBufferAttribute && (e = e.data),
            r.get(e)
        },
        remove: function(t) {
            t.isInterleavedBufferAttribute && (t = t.data);
            var i = r.get(t);
            i && (e.deleteBuffer(i.buffer),
            r.delete(t))
        },
        update: function(t, n) {
            if (t.isGLBufferAttribute) {
                var a = r.get(t);
                (!a || a.version < t.version) && r.set(t, {
                    buffer: t.buffer,
                    type: t.type,
                    bytesPerElement: t.elementSize,
                    version: t.version
                })
            } else {
                t.isInterleavedBufferAttribute && (t = t.data);
                var o = r.get(t);
                void 0 === o ? r.set(t, function(t, r) {
                    var n = t.array
                      , a = t.usage
                      , o = e.createBuffer();
                    e.bindBuffer(r, o),
                    e.bufferData(r, n, a),
                    t.onUploadCallback();
                    var s = 5126;
                    return n instanceof Float32Array ? s = 5126 : n instanceof Float64Array ? console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.") : n instanceof Uint16Array ? t.isFloat16BufferAttribute ? i ? s = 5131 : console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.") : s = 5123 : n instanceof Int16Array ? s = 5122 : n instanceof Uint32Array ? s = 5125 : n instanceof Int32Array ? s = 5124 : n instanceof Int8Array ? s = 5120 : (n instanceof Uint8Array || n instanceof Uint8ClampedArray) && (s = 5121),
                    {
                        buffer: o,
                        type: s,
                        bytesPerElement: n.BYTES_PER_ELEMENT,
                        version: t.version
                    }
                }(t, n)) : o.version < t.version && (function(t, r, n) {
                    var a = r.array
                      , o = r.updateRange;
                    e.bindBuffer(n, t),
                    -1 === o.count ? e.bufferSubData(n, 0, a) : (i ? e.bufferSubData(n, o.offset * a.BYTES_PER_ELEMENT, a, o.offset, o.count) : e.bufferSubData(n, o.offset * a.BYTES_PER_ELEMENT, a.subarray(o.offset, o.offset + o.count)),
                    o.count = -1)
                }(o.buffer, t, n),
                o.version = t.version)
            }
        }
    }
}
var PlaneGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "PlaneGeometry",
        e.parameters = {
            width: r,
            height: n,
            widthSegments: a,
            heightSegments: o
        };
        for (var s = r / 2, l = n / 2, h = Math.floor(a), c = Math.floor(o), p = h + 1, u = c + 1, d = r / h, f = n / c, m = [], g = [], v = [], y = [], _ = 0; _ < u; _++)
            for (var b = _ * f - l, x = 0; x < p; x++) {
                var w = x * d - s;
                g.push(w, -b, 0),
                v.push(0, 0, 1),
                y.push(x / h),
                y.push(1 - _ / c)
            }
        for (var S = 0; S < c; S++)
            for (var T = 0; T < h; T++) {
                var k = T + p * S
                  , E = T + p * (S + 1)
                  , M = T + 1 + p * (S + 1)
                  , P = T + 1 + p * S;
                m.push(k, E, P),
                m.push(E, M, P)
            }
        return e.setIndex(m),
        e.setAttribute("position", new Float32BufferAttribute(g,3)),
        e.setAttribute("normal", new Float32BufferAttribute(v,3)),
        e.setAttribute("uv", new Float32BufferAttribute(y,2)),
        e
    }
    return _createClass2(i, null, [{
        key: "fromJSON",
        value: function(e) {
            return new i(e.width,e.height,e.widthSegments,e.heightSegments)
        }
    }]),
    i
}()
  , alphamap_fragment = "#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif"
  , alphamap_pars_fragment = "#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif"
  , alphatest_fragment = "#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif"
  , alphatest_pars_fragment = "#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif"
  , aomap_fragment = "#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif"
  , aomap_pars_fragment = "#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif"
  , begin_vertex = "vec3 transformed = vec3( position );"
  , beginnormal_vertex = "vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif"
  , bsdfs = "vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenTint, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenTint * ( D * V );\n}\n#endif"
  , bumpmap_pars_fragment = "#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif"
  , clipping_planes_fragment = "#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif"
  , clipping_planes_pars_fragment = "#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif"
  , clipping_planes_pars_vertex = "#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif"
  , clipping_planes_vertex = "#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif"
  , color_fragment = "#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif"
  , color_pars_fragment = "#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif"
  , color_pars_vertex = "#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif"
  , color_vertex = "#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif"
  , common = "#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}"
  , cube_uv_reflection_fragment = "#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif"
  , defaultnormal_vertex = "vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif"
  , displacementmap_pars_vertex = "#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif"
  , displacementmap_vertex = "#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif"
  , emissivemap_fragment = "#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif"
  , emissivemap_pars_fragment = "#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif"
  , encodings_fragment = "gl_FragColor = linearToOutputTexel( gl_FragColor );"
  , encodings_pars_fragment = "\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}"
  , envmap_fragment = "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif"
  , envmap_common_pars_fragment = "#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif"
  , envmap_pars_fragment = "#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif"
  , envmap_pars_vertex = "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif"
  , envmap_vertex = "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif"
  , fog_vertex = "#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif"
  , fog_pars_vertex = "#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif"
  , fog_fragment = "#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif"
  , fog_pars_fragment = "#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif"
  , gradientmap_pars_fragment = "#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}"
  , lightmap_fragment = "#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif"
  , lightmap_pars_fragment = "#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif"
  , lights_lambert_vertex = "vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif"
  , lights_pars_begin = "uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif"
  , envmap_physical_pars_fragment = "#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif"
  , lights_toon_fragment = "ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;"
  , lights_toon_pars_fragment = "varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)"
  , lights_phong_fragment = "BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;"
  , lights_phong_pars_fragment = "varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)"
  , lights_physical_fragment = "PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n#endif"
  , lights_physical_pars_fragment = "struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenTint, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}"
  , lights_fragment_begin = "\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif"
  , lights_fragment_maps = "#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif"
  , lights_fragment_end = "#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif"
  , logdepthbuf_fragment = "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif"
  , logdepthbuf_pars_fragment = "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif"
  , logdepthbuf_pars_vertex = "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif"
  , logdepthbuf_vertex = "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif"
  , map_fragment = "#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif"
  , map_pars_fragment = "#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif"
  , map_particle_fragment = "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif"
  , map_particle_pars_fragment = "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif"
  , metalnessmap_fragment = "float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif"
  , metalnessmap_pars_fragment = "#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif"
  , morphnormal_vertex = "#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif"
  , morphtarget_pars_vertex = "#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif"
  , morphtarget_vertex = "#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif"
  , normal_fragment_begin = "float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;"
  , normal_fragment_maps = "#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif"
  , normal_pars_fragment = "#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif"
  , normal_pars_vertex = "#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif"
  , normal_vertex = "#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif"
  , normalmap_pars_fragment = "#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif"
  , clearcoat_normal_fragment_begin = "#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif"
  , clearcoat_normal_fragment_maps = "#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif"
  , clearcoat_pars_fragment = "#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif"
  , output_fragment = "#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );"
  , packing = "vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}"
  , premultiplied_alpha_fragment = "#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif"
  , project_vertex = "vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;"
  , dithering_fragment = "#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif"
  , dithering_pars_fragment = "#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif"
  , roughnessmap_fragment = "float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif"
  , roughnessmap_pars_fragment = "#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif"
  , shadowmap_pars_fragment = "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif"
  , shadowmap_pars_vertex = "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif"
  , shadowmap_vertex = "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif"
  , shadowmask_pars_fragment = "float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}"
  , skinbase_vertex = "#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif"
  , skinning_pars_vertex = "#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif"
  , skinning_vertex = "#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif"
  , skinnormal_vertex = "#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif"
  , specularmap_fragment = "float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif"
  , specularmap_pars_fragment = "#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif"
  , tonemapping_fragment = "#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif"
  , tonemapping_pars_fragment = "#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }"
  , transmission_fragment = "#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif"
  , transmission_pars_fragment = "#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif"
  , uv_pars_fragment = "#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif"
  , uv_pars_vertex = "#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif"
  , uv_vertex = "#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif"
  , uv2_pars_fragment = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif"
  , uv2_pars_vertex = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif"
  , uv2_vertex = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif"
  , worldpos_vertex = "#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif"
  , vertex$g = "varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}"
  , fragment$g = "uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}"
  , vertex$f = "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}"
  , fragment$f = "#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}"
  , vertex$e = "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}"
  , fragment$e = "#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}"
  , vertex$d = "#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}"
  , fragment$d = "#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}"
  , vertex$c = "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}"
  , fragment$c = "uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}"
  , vertex$b = "uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$b = "uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}"
  , vertex$a = "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$a = "uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$9 = "#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$9 = "uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$8 = "#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}"
  , fragment$8 = "#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$7 = "#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}"
  , fragment$7 = "#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}"
  , vertex$6 = "#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$6 = "#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$5 = "#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}"
  , fragment$5 = "#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n\tuniform float sheenRoughness;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$4 = "#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$4 = "#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}"
  , vertex$3 = "uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$3 = "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}"
  , vertex$2 = "#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$2 = "uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"
  , vertex$1 = "uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"
  , fragment$1 = "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"
  , ShaderChunk = {
    alphamap_fragment,
    alphamap_pars_fragment,
    alphatest_fragment,
    alphatest_pars_fragment,
    aomap_fragment,
    aomap_pars_fragment,
    begin_vertex,
    beginnormal_vertex,
    bsdfs,
    bumpmap_pars_fragment,
    clipping_planes_fragment,
    clipping_planes_pars_fragment,
    clipping_planes_pars_vertex,
    clipping_planes_vertex,
    color_fragment,
    color_pars_fragment,
    color_pars_vertex,
    color_vertex,
    common,
    cube_uv_reflection_fragment,
    defaultnormal_vertex,
    displacementmap_pars_vertex,
    displacementmap_vertex,
    emissivemap_fragment,
    emissivemap_pars_fragment,
    encodings_fragment,
    encodings_pars_fragment,
    envmap_fragment,
    envmap_common_pars_fragment,
    envmap_pars_fragment,
    envmap_pars_vertex,
    envmap_physical_pars_fragment,
    envmap_vertex,
    fog_vertex,
    fog_pars_vertex,
    fog_fragment,
    fog_pars_fragment,
    gradientmap_pars_fragment,
    lightmap_fragment,
    lightmap_pars_fragment,
    lights_lambert_vertex,
    lights_pars_begin,
    lights_toon_fragment,
    lights_toon_pars_fragment,
    lights_phong_fragment,
    lights_phong_pars_fragment,
    lights_physical_fragment,
    lights_physical_pars_fragment,
    lights_fragment_begin,
    lights_fragment_maps,
    lights_fragment_end,
    logdepthbuf_fragment,
    logdepthbuf_pars_fragment,
    logdepthbuf_pars_vertex,
    logdepthbuf_vertex,
    map_fragment,
    map_pars_fragment,
    map_particle_fragment,
    map_particle_pars_fragment,
    metalnessmap_fragment,
    metalnessmap_pars_fragment,
    morphnormal_vertex,
    morphtarget_pars_vertex,
    morphtarget_vertex,
    normal_fragment_begin,
    normal_fragment_maps,
    normal_pars_fragment,
    normal_pars_vertex,
    normal_vertex,
    normalmap_pars_fragment,
    clearcoat_normal_fragment_begin,
    clearcoat_normal_fragment_maps,
    clearcoat_pars_fragment,
    output_fragment,
    packing,
    premultiplied_alpha_fragment,
    project_vertex,
    dithering_fragment,
    dithering_pars_fragment,
    roughnessmap_fragment,
    roughnessmap_pars_fragment,
    shadowmap_pars_fragment,
    shadowmap_pars_vertex,
    shadowmap_vertex,
    shadowmask_pars_fragment,
    skinbase_vertex,
    skinning_pars_vertex,
    skinning_vertex,
    skinnormal_vertex,
    specularmap_fragment,
    specularmap_pars_fragment,
    tonemapping_fragment,
    tonemapping_pars_fragment,
    transmission_fragment,
    transmission_pars_fragment,
    uv_pars_fragment,
    uv_pars_vertex,
    uv_vertex,
    uv2_pars_fragment,
    uv2_pars_vertex,
    uv2_vertex,
    worldpos_vertex,
    background_vert: vertex$g,
    background_frag: fragment$g,
    cube_vert: vertex$f,
    cube_frag: fragment$f,
    depth_vert: vertex$e,
    depth_frag: fragment$e,
    distanceRGBA_vert: vertex$d,
    distanceRGBA_frag: fragment$d,
    equirect_vert: vertex$c,
    equirect_frag: fragment$c,
    linedashed_vert: vertex$b,
    linedashed_frag: fragment$b,
    meshbasic_vert: vertex$a,
    meshbasic_frag: fragment$a,
    meshlambert_vert: vertex$9,
    meshlambert_frag: fragment$9,
    meshmatcap_vert: vertex$8,
    meshmatcap_frag: fragment$8,
    meshnormal_vert: vertex$7,
    meshnormal_frag: fragment$7,
    meshphong_vert: vertex$6,
    meshphong_frag: fragment$6,
    meshphysical_vert: vertex$5,
    meshphysical_frag: fragment$5,
    meshtoon_vert: vertex$4,
    meshtoon_frag: fragment$4,
    points_vert: vertex$3,
    points_frag: fragment$3,
    shadow_vert: vertex$2,
    shadow_frag: fragment$2,
    sprite_vert: vertex$1,
    sprite_frag: fragment$1
}
  , UniformsLib = {
    common: {
        diffuse: {
            value: new Color(16777215)
        },
        opacity: {
            value: 1
        },
        map: {
            value: null
        },
        uvTransform: {
            value: new Matrix3
        },
        uv2Transform: {
            value: new Matrix3
        },
        alphaMap: {
            value: null
        },
        alphaTest: {
            value: 0
        }
    },
    specularmap: {
        specularMap: {
            value: null
        }
    },
    envmap: {
        envMap: {
            value: null
        },
        flipEnvMap: {
            value: -1
        },
        reflectivity: {
            value: 1
        },
        ior: {
            value: 1.5
        },
        refractionRatio: {
            value: .98
        },
        maxMipLevel: {
            value: 0
        }
    },
    aomap: {
        aoMap: {
            value: null
        },
        aoMapIntensity: {
            value: 1
        }
    },
    lightmap: {
        lightMap: {
            value: null
        },
        lightMapIntensity: {
            value: 1
        }
    },
    emissivemap: {
        emissiveMap: {
            value: null
        }
    },
    bumpmap: {
        bumpMap: {
            value: null
        },
        bumpScale: {
            value: 1
        }
    },
    normalmap: {
        normalMap: {
            value: null
        },
        normalScale: {
            value: new Vector2(1,1)
        }
    },
    displacementmap: {
        displacementMap: {
            value: null
        },
        displacementScale: {
            value: 1
        },
        displacementBias: {
            value: 0
        }
    },
    roughnessmap: {
        roughnessMap: {
            value: null
        }
    },
    metalnessmap: {
        metalnessMap: {
            value: null
        }
    },
    gradientmap: {
        gradientMap: {
            value: null
        }
    },
    fog: {
        fogDensity: {
            value: 25e-5
        },
        fogNear: {
            value: 1
        },
        fogFar: {
            value: 2e3
        },
        fogColor: {
            value: new Color(16777215)
        }
    },
    lights: {
        ambientLightColor: {
            value: []
        },
        lightProbe: {
            value: []
        },
        directionalLights: {
            value: [],
            properties: {
                direction: {},
                color: {}
            }
        },
        directionalLightShadows: {
            value: [],
            properties: {
                shadowBias: {},
                shadowNormalBias: {},
                shadowRadius: {},
                shadowMapSize: {}
            }
        },
        directionalShadowMap: {
            value: []
        },
        directionalShadowMatrix: {
            value: []
        },
        spotLights: {
            value: [],
            properties: {
                color: {},
                position: {},
                direction: {},
                distance: {},
                coneCos: {},
                penumbraCos: {},
                decay: {}
            }
        },
        spotLightShadows: {
            value: [],
            properties: {
                shadowBias: {},
                shadowNormalBias: {},
                shadowRadius: {},
                shadowMapSize: {}
            }
        },
        spotShadowMap: {
            value: []
        },
        spotShadowMatrix: {
            value: []
        },
        pointLights: {
            value: [],
            properties: {
                color: {},
                position: {},
                decay: {},
                distance: {}
            }
        },
        pointLightShadows: {
            value: [],
            properties: {
                shadowBias: {},
                shadowNormalBias: {},
                shadowRadius: {},
                shadowMapSize: {},
                shadowCameraNear: {},
                shadowCameraFar: {}
            }
        },
        pointShadowMap: {
            value: []
        },
        pointShadowMatrix: {
            value: []
        },
        hemisphereLights: {
            value: [],
            properties: {
                direction: {},
                skyColor: {},
                groundColor: {}
            }
        },
        rectAreaLights: {
            value: [],
            properties: {
                color: {},
                position: {},
                width: {},
                height: {}
            }
        },
        ltc_1: {
            value: null
        },
        ltc_2: {
            value: null
        }
    },
    points: {
        diffuse: {
            value: new Color(16777215)
        },
        opacity: {
            value: 1
        },
        size: {
            value: 1
        },
        scale: {
            value: 1
        },
        map: {
            value: null
        },
        alphaMap: {
            value: null
        },
        alphaTest: {
            value: 0
        },
        uvTransform: {
            value: new Matrix3
        }
    },
    sprite: {
        diffuse: {
            value: new Color(16777215)
        },
        opacity: {
            value: 1
        },
        center: {
            value: new Vector2(.5,.5)
        },
        rotation: {
            value: 0
        },
        map: {
            value: null
        },
        alphaMap: {
            value: null
        },
        alphaTest: {
            value: 0
        },
        uvTransform: {
            value: new Matrix3
        }
    }
}
  , ShaderLib = {
    basic: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.specularmap, UniformsLib.envmap, UniformsLib.aomap, UniformsLib.lightmap, UniformsLib.fog]),
        vertexShader: ShaderChunk.meshbasic_vert,
        fragmentShader: ShaderChunk.meshbasic_frag
    },
    lambert: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.specularmap, UniformsLib.envmap, UniformsLib.aomap, UniformsLib.lightmap, UniformsLib.emissivemap, UniformsLib.fog, UniformsLib.lights, {
            emissive: {
                value: new Color(0)
            }
        }]),
        vertexShader: ShaderChunk.meshlambert_vert,
        fragmentShader: ShaderChunk.meshlambert_frag
    },
    phong: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.specularmap, UniformsLib.envmap, UniformsLib.aomap, UniformsLib.lightmap, UniformsLib.emissivemap, UniformsLib.bumpmap, UniformsLib.normalmap, UniformsLib.displacementmap, UniformsLib.fog, UniformsLib.lights, {
            emissive: {
                value: new Color(0)
            },
            specular: {
                value: new Color(1118481)
            },
            shininess: {
                value: 30
            }
        }]),
        vertexShader: ShaderChunk.meshphong_vert,
        fragmentShader: ShaderChunk.meshphong_frag
    },
    standard: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.envmap, UniformsLib.aomap, UniformsLib.lightmap, UniformsLib.emissivemap, UniformsLib.bumpmap, UniformsLib.normalmap, UniformsLib.displacementmap, UniformsLib.roughnessmap, UniformsLib.metalnessmap, UniformsLib.fog, UniformsLib.lights, {
            emissive: {
                value: new Color(0)
            },
            roughness: {
                value: 1
            },
            metalness: {
                value: 0
            },
            envMapIntensity: {
                value: 1
            }
        }]),
        vertexShader: ShaderChunk.meshphysical_vert,
        fragmentShader: ShaderChunk.meshphysical_frag
    },
    toon: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.aomap, UniformsLib.lightmap, UniformsLib.emissivemap, UniformsLib.bumpmap, UniformsLib.normalmap, UniformsLib.displacementmap, UniformsLib.gradientmap, UniformsLib.fog, UniformsLib.lights, {
            emissive: {
                value: new Color(0)
            }
        }]),
        vertexShader: ShaderChunk.meshtoon_vert,
        fragmentShader: ShaderChunk.meshtoon_frag
    },
    matcap: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.bumpmap, UniformsLib.normalmap, UniformsLib.displacementmap, UniformsLib.fog, {
            matcap: {
                value: null
            }
        }]),
        vertexShader: ShaderChunk.meshmatcap_vert,
        fragmentShader: ShaderChunk.meshmatcap_frag
    },
    points: {
        uniforms: mergeUniforms([UniformsLib.points, UniformsLib.fog]),
        vertexShader: ShaderChunk.points_vert,
        fragmentShader: ShaderChunk.points_frag
    },
    dashed: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.fog, {
            scale: {
                value: 1
            },
            dashSize: {
                value: 1
            },
            totalSize: {
                value: 2
            }
        }]),
        vertexShader: ShaderChunk.linedashed_vert,
        fragmentShader: ShaderChunk.linedashed_frag
    },
    depth: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.displacementmap]),
        vertexShader: ShaderChunk.depth_vert,
        fragmentShader: ShaderChunk.depth_frag
    },
    normal: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.bumpmap, UniformsLib.normalmap, UniformsLib.displacementmap, {
            opacity: {
                value: 1
            }
        }]),
        vertexShader: ShaderChunk.meshnormal_vert,
        fragmentShader: ShaderChunk.meshnormal_frag
    },
    sprite: {
        uniforms: mergeUniforms([UniformsLib.sprite, UniformsLib.fog]),
        vertexShader: ShaderChunk.sprite_vert,
        fragmentShader: ShaderChunk.sprite_frag
    },
    background: {
        uniforms: {
            uvTransform: {
                value: new Matrix3
            },
            t2D: {
                value: null
            }
        },
        vertexShader: ShaderChunk.background_vert,
        fragmentShader: ShaderChunk.background_frag
    },
    cube: {
        uniforms: mergeUniforms([UniformsLib.envmap, {
            opacity: {
                value: 1
            }
        }]),
        vertexShader: ShaderChunk.cube_vert,
        fragmentShader: ShaderChunk.cube_frag
    },
    equirect: {
        uniforms: {
            tEquirect: {
                value: null
            }
        },
        vertexShader: ShaderChunk.equirect_vert,
        fragmentShader: ShaderChunk.equirect_frag
    },
    distanceRGBA: {
        uniforms: mergeUniforms([UniformsLib.common, UniformsLib.displacementmap, {
            referencePosition: {
                value: new Vector3
            },
            nearDistance: {
                value: 1
            },
            farDistance: {
                value: 1e3
            }
        }]),
        vertexShader: ShaderChunk.distanceRGBA_vert,
        fragmentShader: ShaderChunk.distanceRGBA_frag
    },
    shadow: {
        uniforms: mergeUniforms([UniformsLib.lights, UniformsLib.fog, {
            color: {
                value: new Color(0)
            },
            opacity: {
                value: 1
            }
        }]),
        vertexShader: ShaderChunk.shadow_vert,
        fragmentShader: ShaderChunk.shadow_frag
    }
};
function WebGLBackground(e, t, i, r, n) {
    var a, o, s = new Color(0), l = 0, h = null, c = 0, p = null;
    function u(e, t) {
        i.buffers.color.setClear(e.r, e.g, e.b, t, n)
    }
    return {
        getClearColor: function() {
            return s
        },
        setClearColor: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
            s.set(e),
            u(s, l = t)
        },
        getClearAlpha: function() {
            return l
        },
        setClearAlpha: function(e) {
            u(s, l = e)
        },
        render: function(i, n) {
            var d = !1
              , f = !0 === n.isScene ? n.background : null;
            f && f.isTexture && (f = t.get(f));
            var m = e.xr
              , g = m.getSession && m.getSession();
            g && "additive" === g.environmentBlendMode && (f = null),
            null === f ? u(s, l) : f && f.isColor && (u(f, 1),
            d = !0),
            (e.autoClear || d) && e.clear(e.autoClearColor, e.autoClearDepth, e.autoClearStencil),
            f && (f.isCubeTexture || f.mapping === CubeUVReflectionMapping) ? (void 0 === o && ((o = new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({
                name: "BackgroundCubeMaterial",
                uniforms: cloneUniforms(ShaderLib.cube.uniforms),
                vertexShader: ShaderLib.cube.vertexShader,
                fragmentShader: ShaderLib.cube.fragmentShader,
                side: BackSide,
                depthTest: !1,
                depthWrite: !1,
                fog: !1
            }))).geometry.deleteAttribute("normal"),
            o.geometry.deleteAttribute("uv"),
            o.onBeforeRender = function(e, t, i) {
                this.matrixWorld.copyPosition(i.matrixWorld)
            }
            ,
            Object.defineProperty(o.material, "envMap", {
                get: function() {
                    return this.uniforms.envMap.value
                }
            }),
            r.update(o)),
            o.material.uniforms.envMap.value = f,
            o.material.uniforms.flipEnvMap.value = f.isCubeTexture && !1 === f.isRenderTargetTexture ? -1 : 1,
            h === f && c === f.version && p === e.toneMapping || (o.material.needsUpdate = !0,
            h = f,
            c = f.version,
            p = e.toneMapping),
            i.unshift(o, o.geometry, o.material, 0, 0, null)) : f && f.isTexture && (void 0 === a && ((a = new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({
                name: "BackgroundMaterial",
                uniforms: cloneUniforms(ShaderLib.background.uniforms),
                vertexShader: ShaderLib.background.vertexShader,
                fragmentShader: ShaderLib.background.fragmentShader,
                side: FrontSide,
                depthTest: !1,
                depthWrite: !1,
                fog: !1
            }))).geometry.deleteAttribute("normal"),
            Object.defineProperty(a.material, "map", {
                get: function() {
                    return this.uniforms.t2D.value
                }
            }),
            r.update(a)),
            a.material.uniforms.t2D.value = f,
            !0 === f.matrixAutoUpdate && f.updateMatrix(),
            a.material.uniforms.uvTransform.value.copy(f.matrix),
            h === f && c === f.version && p === e.toneMapping || (a.material.needsUpdate = !0,
            h = f,
            c = f.version,
            p = e.toneMapping),
            i.unshift(a, a.geometry, a.material, 0, 0, null))
        }
    }
}
function WebGLBindingStates(e, t, i, r) {
    var n = e.getParameter(34921)
      , a = r.isWebGL2 ? null : t.get("OES_vertex_array_object")
      , o = r.isWebGL2 || null !== a
      , s = {}
      , l = u(null)
      , h = l;
    function c(t) {
        return r.isWebGL2 ? e.bindVertexArray(t) : a.bindVertexArrayOES(t)
    }
    function p(t) {
        return r.isWebGL2 ? e.deleteVertexArray(t) : a.deleteVertexArrayOES(t)
    }
    function u(e) {
        for (var t = [], i = [], r = [], a = 0; a < n; a++)
            t[a] = 0,
            i[a] = 0,
            r[a] = 0;
        return {
            geometry: null,
            program: null,
            wireframe: !1,
            newAttributes: t,
            enabledAttributes: i,
            attributeDivisors: r,
            object: e,
            attributes: {},
            index: null
        }
    }
    function d() {
        for (var e = h.newAttributes, t = 0, i = e.length; t < i; t++)
            e[t] = 0
    }
    function f(e) {
        m(e, 0)
    }
    function m(i, n) {
        var a = h.newAttributes
          , o = h.enabledAttributes
          , s = h.attributeDivisors;
        a[i] = 1,
        0 === o[i] && (e.enableVertexAttribArray(i),
        o[i] = 1),
        s[i] !== n && ((r.isWebGL2 ? e : t.get("ANGLE_instanced_arrays"))[r.isWebGL2 ? "vertexAttribDivisor" : "vertexAttribDivisorANGLE"](i, n),
        s[i] = n)
    }
    function g() {
        for (var t = h.newAttributes, i = h.enabledAttributes, r = 0, n = i.length; r < n; r++)
            i[r] !== t[r] && (e.disableVertexAttribArray(r),
            i[r] = 0)
    }
    function v(t, i, n, a, o, s) {
        !0 !== r.isWebGL2 || 5124 !== n && 5125 !== n ? e.vertexAttribPointer(t, i, n, a, o, s) : e.vertexAttribIPointer(t, i, n, o, s)
    }
    function y() {
        _(),
        h !== l && c((h = l).object)
    }
    function _() {
        l.geometry = null,
        l.program = null,
        l.wireframe = !1
    }
    return {
        setup: function(n, l, p, y, _) {
            var b = !1;
            if (o) {
                var x = function(t, i, n) {
                    var o = !0 === n.wireframe
                      , l = s[t.id];
                    void 0 === l && (l = {},
                    s[t.id] = l);
                    var h = l[i.id];
                    void 0 === h && (h = {},
                    l[i.id] = h);
                    var c = h[o];
                    return void 0 === c && (c = u(r.isWebGL2 ? e.createVertexArray() : a.createVertexArrayOES()),
                    h[o] = c),
                    c
                }(y, p, l);
                h !== x && c((h = x).object),
                b = function(e, t) {
                    var i = h.attributes
                      , r = e.attributes
                      , n = 0;
                    for (var a in r) {
                        var o = i[a]
                          , s = r[a];
                        if (void 0 === o)
                            return !0;
                        if (o.attribute !== s)
                            return !0;
                        if (o.data !== s.data)
                            return !0;
                        n++
                    }
                    return h.attributesNum !== n || h.index !== t
                }(y, _),
                b && function(e, t) {
                    var i = {}
                      , r = e.attributes
                      , n = 0;
                    for (var a in r) {
                        var o = r[a]
                          , s = {};
                        s.attribute = o,
                        o.data && (s.data = o.data),
                        i[a] = s,
                        n++
                    }
                    h.attributes = i,
                    h.attributesNum = n,
                    h.index = t
                }(y, _)
            } else {
                var w = !0 === l.wireframe;
                h.geometry === y.id && h.program === p.id && h.wireframe === w || (h.geometry = y.id,
                h.program = p.id,
                h.wireframe = w,
                b = !0)
            }
            !0 === n.isInstancedMesh && (b = !0),
            null !== _ && i.update(_, 34963),
            b && (function(n, a, o, s) {
                if (!1 !== r.isWebGL2 || !n.isInstancedMesh && !s.isInstancedBufferGeometry || null !== t.get("ANGLE_instanced_arrays")) {
                    d();
                    var l = s.attributes
                      , h = o.getAttributes()
                      , c = a.defaultAttributeValues;
                    for (var p in h) {
                        var u = h[p];
                        if (u.location >= 0) {
                            var y = l[p];
                            if (void 0 === y && ("instanceMatrix" === p && n.instanceMatrix && (y = n.instanceMatrix),
                            "instanceColor" === p && n.instanceColor && (y = n.instanceColor)),
                            void 0 !== y) {
                                var _ = y.normalized
                                  , b = y.itemSize
                                  , x = i.get(y);
                                if (void 0 === x)
                                    continue;
                                var w = x.buffer
                                  , S = x.type
                                  , T = x.bytesPerElement;
                                if (y.isInterleavedBufferAttribute) {
                                    var k = y.data
                                      , E = k.stride
                                      , M = y.offset;
                                    if (k && k.isInstancedInterleavedBuffer) {
                                        for (var P = 0; P < u.locationSize; P++)
                                            m(u.location + P, k.meshPerAttribute);
                                        !0 !== n.isInstancedMesh && void 0 === s._maxInstanceCount && (s._maxInstanceCount = k.meshPerAttribute * k.count)
                                    } else
                                        for (var C = 0; C < u.locationSize; C++)
                                            f(u.location + C);
                                    e.bindBuffer(34962, w);
                                    for (var A = 0; A < u.locationSize; A++)
                                        v(u.location + A, b / u.locationSize, S, _, E * T, (M + b / u.locationSize * A) * T)
                                } else {
                                    if (y.isInstancedBufferAttribute) {
                                        for (var L = 0; L < u.locationSize; L++)
                                            m(u.location + L, y.meshPerAttribute);
                                        !0 !== n.isInstancedMesh && void 0 === s._maxInstanceCount && (s._maxInstanceCount = y.meshPerAttribute * y.count)
                                    } else
                                        for (var D = 0; D < u.locationSize; D++)
                                            f(u.location + D);
                                    e.bindBuffer(34962, w);
                                    for (var I = 0; I < u.locationSize; I++)
                                        v(u.location + I, b / u.locationSize, S, _, b * T, b / u.locationSize * I * T)
                                }
                            } else if (void 0 !== c) {
                                var R = c[p];
                                if (void 0 !== R)
                                    switch (R.length) {
                                    case 2:
                                        e.vertexAttrib2fv(u.location, R);
                                        break;
                                    case 3:
                                        e.vertexAttrib3fv(u.location, R);
                                        break;
                                    case 4:
                                        e.vertexAttrib4fv(u.location, R);
                                        break;
                                    default:
                                        e.vertexAttrib1fv(u.location, R)
                                    }
                            }
                        }
                    }
                    g()
                }
            }(n, l, p, y),
            null !== _ && e.bindBuffer(34963, i.get(_).buffer))
        },
        reset: y,
        resetDefaultState: _,
        dispose: function() {
            for (var e in y(),
            s) {
                var t = s[e];
                for (var i in t) {
                    var r = t[i];
                    for (var n in r)
                        p(r[n].object),
                        delete r[n];
                    delete t[i]
                }
                delete s[e]
            }
        },
        releaseStatesOfGeometry: function(e) {
            if (void 0 !== s[e.id]) {
                var t = s[e.id];
                for (var i in t) {
                    var r = t[i];
                    for (var n in r)
                        p(r[n].object),
                        delete r[n];
                    delete t[i]
                }
                delete s[e.id]
            }
        },
        releaseStatesOfProgram: function(e) {
            for (var t in s) {
                var i = s[t];
                if (void 0 !== i[e.id]) {
                    var r = i[e.id];
                    for (var n in r)
                        p(r[n].object),
                        delete r[n];
                    delete i[e.id]
                }
            }
        },
        initAttributes: d,
        enableAttribute: f,
        disableUnusedAttributes: g
    }
}
function WebGLBufferRenderer(e, t, i, r) {
    var n, a = r.isWebGL2;
    this.setMode = function(e) {
        n = e
    }
    ,
    this.render = function(t, r) {
        e.drawArrays(n, t, r),
        i.update(r, n, 1)
    }
    ,
    this.renderInstances = function(r, o, s) {
        if (0 !== s) {
            var l, h;
            if (a)
                l = e,
                h = "drawArraysInstanced";
            else if (h = "drawArraysInstancedANGLE",
            null === (l = t.get("ANGLE_instanced_arrays")))
                return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
            l[h](n, r, o, s),
            i.update(o, n, s)
        }
    }
}
function WebGLCapabilities(e, t, i) {
    var r;
    function n(t) {
        if ("highp" === t) {
            if (e.getShaderPrecisionFormat(35633, 36338).precision > 0 && e.getShaderPrecisionFormat(35632, 36338).precision > 0)
                return "highp";
            t = "mediump"
        }
        return "mediump" === t && e.getShaderPrecisionFormat(35633, 36337).precision > 0 && e.getShaderPrecisionFormat(35632, 36337).precision > 0 ? "mediump" : "lowp"
    }
    var a = "undefined" != typeof WebGL2RenderingContext && e instanceof WebGL2RenderingContext || "undefined" != typeof WebGL2ComputeRenderingContext && e instanceof WebGL2ComputeRenderingContext
      , o = void 0 !== i.precision ? i.precision : "highp"
      , s = n(o);
    s !== o && (console.warn("THREE.WebGLRenderer:", o, "not supported, using", s, "instead."),
    o = s);
    var l = a || t.has("WEBGL_draw_buffers")
      , h = !0 === i.logarithmicDepthBuffer
      , c = e.getParameter(34930)
      , p = e.getParameter(35660)
      , u = e.getParameter(3379)
      , d = e.getParameter(34076)
      , f = e.getParameter(34921)
      , m = e.getParameter(36347)
      , g = e.getParameter(36348)
      , v = e.getParameter(36349)
      , y = p > 0
      , _ = a || t.has("OES_texture_float");
    return {
        isWebGL2: a,
        drawBuffers: l,
        getMaxAnisotropy: function() {
            if (void 0 !== r)
                return r;
            if (!0 === t.has("EXT_texture_filter_anisotropic")) {
                var i = t.get("EXT_texture_filter_anisotropic");
                r = e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)
            } else
                r = 0;
            return r
        },
        getMaxPrecision: n,
        precision: o,
        logarithmicDepthBuffer: h,
        maxTextures: c,
        maxVertexTextures: p,
        maxTextureSize: u,
        maxCubemapSize: d,
        maxAttributes: f,
        maxVertexUniforms: m,
        maxVaryings: g,
        maxFragmentUniforms: v,
        vertexTextures: y,
        floatFragmentTextures: _,
        floatVertexTextures: y && _,
        maxSamples: a ? e.getParameter(36183) : 0
    }
}
function WebGLClipping(e) {
    var t = this
      , i = null
      , r = 0
      , n = !1
      , a = !1
      , o = new Plane
      , s = new Matrix3
      , l = {
        value: null,
        needsUpdate: !1
    };
    function h() {
        l.value !== i && (l.value = i,
        l.needsUpdate = r > 0),
        t.numPlanes = r,
        t.numIntersection = 0
    }
    function c(e, i, r, n) {
        var a = null !== e ? e.length : 0
          , h = null;
        if (0 !== a) {
            if (h = l.value,
            !0 !== n || null === h) {
                var c = r + 4 * a
                  , p = i.matrixWorldInverse;
                s.getNormalMatrix(p),
                (null === h || h.length < c) && (h = new Float32Array(c));
                for (var u = 0, d = r; u !== a; ++u,
                d += 4)
                    o.copy(e[u]).applyMatrix4(p, s),
                    o.normal.toArray(h, d),
                    h[d + 3] = o.constant
            }
            l.value = h,
            l.needsUpdate = !0
        }
        return t.numPlanes = a,
        t.numIntersection = 0,
        h
    }
    this.uniform = l,
    this.numPlanes = 0,
    this.numIntersection = 0,
    this.init = function(e, t, a) {
        var o = 0 !== e.length || t || 0 !== r || n;
        return n = t,
        i = c(e, a, 0),
        r = e.length,
        o
    }
    ,
    this.beginShadows = function() {
        a = !0,
        c(null)
    }
    ,
    this.endShadows = function() {
        a = !1,
        h()
    }
    ,
    this.setState = function(t, o, s) {
        var p = t.clippingPlanes
          , u = t.clipIntersection
          , d = t.clipShadows
          , f = e.get(t);
        if (!n || null === p || 0 === p.length || a && !d)
            a ? c(null) : h();
        else {
            var m = a ? 0 : r
              , g = 4 * m
              , v = f.clippingState || null;
            l.value = v,
            v = c(p, o, g, s);
            for (var y = 0; y !== g; ++y)
                v[y] = i[y];
            f.clippingState = v,
            this.numIntersection = u ? this.numPlanes : 0,
            this.numPlanes += m
        }
    }
}
function WebGLCubeMaps(e) {
    var t = new WeakMap;
    function i(e, t) {
        return t === EquirectangularReflectionMapping ? e.mapping = CubeReflectionMapping : t === EquirectangularRefractionMapping && (e.mapping = CubeRefractionMapping),
        e
    }
    function r(e) {
        var i = e.target;
        i.removeEventListener("dispose", r);
        var n = t.get(i);
        void 0 !== n && (t.delete(i),
        n.dispose())
    }
    return {
        get: function(n) {
            if (n && n.isTexture && !1 === n.isRenderTargetTexture) {
                var a = n.mapping;
                if (a === EquirectangularReflectionMapping || a === EquirectangularRefractionMapping) {
                    if (t.has(n))
                        return i(t.get(n).texture, n.mapping);
                    var o = n.image;
                    if (o && o.height > 0) {
                        var s = e.getRenderTarget()
                          , l = new WebGLCubeRenderTarget(o.height / 2);
                        return l.fromEquirectangularTexture(e, n),
                        t.set(n, l),
                        e.setRenderTarget(s),
                        n.addEventListener("dispose", r),
                        i(l.texture, n.mapping)
                    }
                    return null
                }
            }
            return n
        },
        dispose: function() {
            t = new WeakMap
        }
    }
}
ShaderLib.physical = {
    uniforms: mergeUniforms([ShaderLib.standard.uniforms, {
        clearcoat: {
            value: 0
        },
        clearcoatMap: {
            value: null
        },
        clearcoatRoughness: {
            value: 0
        },
        clearcoatRoughnessMap: {
            value: null
        },
        clearcoatNormalScale: {
            value: new Vector2(1,1)
        },
        clearcoatNormalMap: {
            value: null
        },
        sheen: {
            value: 0
        },
        sheenTint: {
            value: new Color(0)
        },
        sheenRoughness: {
            value: 0
        },
        transmission: {
            value: 0
        },
        transmissionMap: {
            value: null
        },
        transmissionSamplerSize: {
            value: new Vector2
        },
        transmissionSamplerMap: {
            value: null
        },
        thickness: {
            value: 0
        },
        thicknessMap: {
            value: null
        },
        attenuationDistance: {
            value: 0
        },
        attenuationTint: {
            value: new Color(0)
        },
        specularIntensity: {
            value: 0
        },
        specularIntensityMap: {
            value: null
        },
        specularTint: {
            value: new Color(1,1,1)
        },
        specularTintMap: {
            value: null
        }
    }]),
    vertexShader: ShaderChunk.meshphysical_vert,
    fragmentShader: ShaderChunk.meshphysical_frag
};
var OrthographicCamera = function(e) {
    _inherits(i, Camera);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : -1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : -1, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : .1, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 2e3;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "OrthographicCamera",
        e.zoom = 1,
        e.view = null,
        e.left = r,
        e.right = n,
        e.top = a,
        e.bottom = o,
        e.near = s,
        e.far = l,
        e.updateProjectionMatrix(),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e, t) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e, t),
            this.left = e.left,
            this.right = e.right,
            this.top = e.top,
            this.bottom = e.bottom,
            this.near = e.near,
            this.far = e.far,
            this.zoom = e.zoom,
            this.view = null === e.view ? null : Object.assign({}, e.view),
            this
        }
    }, {
        key: "setViewOffset",
        value: function(e, t, i, r, n, a) {
            null === this.view && (this.view = {
                enabled: !0,
                fullWidth: 1,
                fullHeight: 1,
                offsetX: 0,
                offsetY: 0,
                width: 1,
                height: 1
            }),
            this.view.enabled = !0,
            this.view.fullWidth = e,
            this.view.fullHeight = t,
            this.view.offsetX = i,
            this.view.offsetY = r,
            this.view.width = n,
            this.view.height = a,
            this.updateProjectionMatrix()
        }
    }, {
        key: "clearViewOffset",
        value: function() {
            null !== this.view && (this.view.enabled = !1),
            this.updateProjectionMatrix()
        }
    }, {
        key: "updateProjectionMatrix",
        value: function() {
            var e = (this.right - this.left) / (2 * this.zoom)
              , t = (this.top - this.bottom) / (2 * this.zoom)
              , i = (this.right + this.left) / 2
              , r = (this.top + this.bottom) / 2
              , n = i - e
              , a = i + e
              , o = r + t
              , s = r - t;
            if (null !== this.view && this.view.enabled) {
                var l = (this.right - this.left) / this.view.fullWidth / this.zoom
                  , h = (this.top - this.bottom) / this.view.fullHeight / this.zoom;
                a = (n += l * this.view.offsetX) + l * this.view.width,
                s = (o -= h * this.view.offsetY) - h * this.view.height
            }
            this.projectionMatrix.makeOrthographic(n, a, o, s, this.near, this.far),
            this.projectionMatrixInverse.copy(this.projectionMatrix).invert()
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.object.zoom = this.zoom,
            t.object.left = this.left,
            t.object.right = this.right,
            t.object.top = this.top,
            t.object.bottom = this.bottom,
            t.object.near = this.near,
            t.object.far = this.far,
            null !== this.view && (t.object.view = Object.assign({}, this.view)),
            t
        }
    }]),
    i
}();
OrthographicCamera.prototype.isOrthographicCamera = !0;
var RawShaderMaterial = function(e) {
    _inherits(i, ShaderMaterial);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).type = "RawShaderMaterial",
        r
    }
    return _createClass2(i)
}();
RawShaderMaterial.prototype.isRawShaderMaterial = !0;
var LOD_MIN = 4
  , LOD_MAX = 8
  , SIZE_MAX = Math.pow(2, LOD_MAX)
  , EXTRA_LOD_SIGMA = [.125, .215, .35, .446, .526, .582]
  , TOTAL_LODS = LOD_MAX - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length
  , MAX_SAMPLES = 20
  , ENCODINGS = (_ENCODINGS = {},
_defineProperty2(_ENCODINGS, LinearEncoding, 0),
_defineProperty2(_ENCODINGS, sRGBEncoding, 1),
_defineProperty2(_ENCODINGS, RGBEEncoding, 2),
_defineProperty2(_ENCODINGS, RGBM7Encoding, 3),
_defineProperty2(_ENCODINGS, RGBM16Encoding, 4),
_defineProperty2(_ENCODINGS, RGBDEncoding, 5),
_defineProperty2(_ENCODINGS, GammaEncoding, 6),
_ENCODINGS)
  , _flatCamera = new OrthographicCamera
  , _createPlanes2 = _createPlanes()
  , _lodPlanes = _createPlanes2._lodPlanes
  , _sizeLods = _createPlanes2._sizeLods
  , _sigmas = _createPlanes2._sigmas
  , _clearColor = new Color
  , _oldTarget = null
  , PHI = (1 + Math.sqrt(5)) / 2
  , INV_PHI = 1 / PHI
  , _axisDirections = [new Vector3(1,1,1), new Vector3(-1,1,1), new Vector3(1,1,-1), new Vector3(-1,1,-1), new Vector3(0,PHI,INV_PHI), new Vector3(0,PHI,-INV_PHI), new Vector3(INV_PHI,0,PHI), new Vector3(-INV_PHI,0,PHI), new Vector3(PHI,INV_PHI,0), new Vector3(-PHI,INV_PHI,0)]
  , PMREMGenerator = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this._renderer = t,
        this._pingPongRenderTarget = null,
        this._blurMaterial = _getBlurShader(MAX_SAMPLES),
        this._equirectShader = null,
        this._cubemapShader = null,
        this._compileMaterial(this._blurMaterial)
    }
    return _createClass2(e, [{
        key: "fromScene",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
              , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .1
              , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 100;
            _oldTarget = this._renderer.getRenderTarget();
            var n = this._allocateTargets();
            return this._sceneToCubeUV(e, i, r, n),
            t > 0 && this._blur(n, 0, 0, t),
            this._applyPMREM(n),
            this._cleanup(n),
            n
        }
    }, {
        key: "fromEquirectangular",
        value: function(e) {
            return this._fromTexture(e)
        }
    }, {
        key: "fromCubemap",
        value: function(e) {
            return this._fromTexture(e)
        }
    }, {
        key: "compileCubemapShader",
        value: function() {
            null === this._cubemapShader && (this._cubemapShader = _getCubemapShader(),
            this._compileMaterial(this._cubemapShader))
        }
    }, {
        key: "compileEquirectangularShader",
        value: function() {
            null === this._equirectShader && (this._equirectShader = _getEquirectShader(),
            this._compileMaterial(this._equirectShader))
        }
    }, {
        key: "dispose",
        value: function() {
            this._blurMaterial.dispose(),
            null !== this._cubemapShader && this._cubemapShader.dispose(),
            null !== this._equirectShader && this._equirectShader.dispose();
            for (var e = 0; e < _lodPlanes.length; e++)
                _lodPlanes[e].dispose()
        }
    }, {
        key: "_cleanup",
        value: function(e) {
            this._pingPongRenderTarget.dispose(),
            this._renderer.setRenderTarget(_oldTarget),
            e.scissorTest = !1,
            _setViewport(e, 0, 0, e.width, e.height)
        }
    }, {
        key: "_fromTexture",
        value: function(e) {
            _oldTarget = this._renderer.getRenderTarget();
            var t = this._allocateTargets(e);
            return this._textureToCubeUV(e, t),
            this._applyPMREM(t),
            this._cleanup(t),
            t
        }
    }, {
        key: "_allocateTargets",
        value: function(e) {
            var t = {
                magFilter: NearestFilter,
                minFilter: NearestFilter,
                generateMipmaps: !1,
                type: UnsignedByteType,
                format: RGBEFormat,
                encoding: _isLDR(e) ? e.encoding : RGBEEncoding,
                depthBuffer: !1
            }
              , i = _createRenderTarget(t);
            return i.depthBuffer = !e,
            this._pingPongRenderTarget = _createRenderTarget(t),
            i
        }
    }, {
        key: "_compileMaterial",
        value: function(e) {
            var t = new Mesh(_lodPlanes[0],e);
            this._renderer.compile(t, _flatCamera)
        }
    }, {
        key: "_sceneToCubeUV",
        value: function(e, t, i, r) {
            var n = new PerspectiveCamera(90,1,t,i)
              , a = [1, -1, 1, 1, 1, 1]
              , o = [1, 1, 1, -1, -1, -1]
              , s = this._renderer
              , l = s.autoClear
              , h = s.outputEncoding
              , c = s.toneMapping;
            s.getClearColor(_clearColor),
            s.toneMapping = NoToneMapping,
            s.outputEncoding = LinearEncoding,
            s.autoClear = !1;
            var p = new MeshBasicMaterial({
                name: "PMREM.Background",
                side: BackSide,
                depthWrite: !1,
                depthTest: !1
            })
              , u = new Mesh(new BoxGeometry,p)
              , d = !1
              , f = e.background;
            f ? f.isColor && (p.color.copy(f),
            e.background = null,
            d = !0) : (p.color.copy(_clearColor),
            d = !0);
            for (var m = 0; m < 6; m++) {
                var g = m % 3;
                0 == g ? (n.up.set(0, a[m], 0),
                n.lookAt(o[m], 0, 0)) : 1 == g ? (n.up.set(0, 0, a[m]),
                n.lookAt(0, o[m], 0)) : (n.up.set(0, a[m], 0),
                n.lookAt(0, 0, o[m])),
                _setViewport(r, g * SIZE_MAX, m > 2 ? SIZE_MAX : 0, SIZE_MAX, SIZE_MAX),
                s.setRenderTarget(r),
                d && s.render(u, n),
                s.render(e, n)
            }
            u.geometry.dispose(),
            u.material.dispose(),
            s.toneMapping = c,
            s.outputEncoding = h,
            s.autoClear = l,
            e.background = f
        }
    }, {
        key: "_setEncoding",
        value: function(e, t) {
            !0 === this._renderer.capabilities.isWebGL2 && t.format === RGBAFormat && t.type === UnsignedByteType && t.encoding === sRGBEncoding ? e.value = ENCODINGS[LinearEncoding] : e.value = ENCODINGS[t.encoding]
        }
    }, {
        key: "_textureToCubeUV",
        value: function(e, t) {
            var i = this._renderer;
            e.isCubeTexture ? null == this._cubemapShader && (this._cubemapShader = _getCubemapShader()) : null == this._equirectShader && (this._equirectShader = _getEquirectShader());
            var r = e.isCubeTexture ? this._cubemapShader : this._equirectShader
              , n = new Mesh(_lodPlanes[0],r)
              , a = r.uniforms;
            a.envMap.value = e,
            e.isCubeTexture || a.texelSize.value.set(1 / e.image.width, 1 / e.image.height),
            this._setEncoding(a.inputEncoding, e),
            this._setEncoding(a.outputEncoding, t.texture),
            _setViewport(t, 0, 0, 3 * SIZE_MAX, 2 * SIZE_MAX),
            i.setRenderTarget(t),
            i.render(n, _flatCamera)
        }
    }, {
        key: "_applyPMREM",
        value: function(e) {
            var t = this._renderer
              , i = t.autoClear;
            t.autoClear = !1;
            for (var r = 1; r < TOTAL_LODS; r++) {
                var n = Math.sqrt(_sigmas[r] * _sigmas[r] - _sigmas[r - 1] * _sigmas[r - 1])
                  , a = _axisDirections[(r - 1) % _axisDirections.length];
                this._blur(e, r - 1, r, n, a)
            }
            t.autoClear = i
        }
    }, {
        key: "_blur",
        value: function(e, t, i, r, n) {
            var a = this._pingPongRenderTarget;
            this._halfBlur(e, a, t, i, r, "latitudinal", n),
            this._halfBlur(a, e, i, i, r, "longitudinal", n)
        }
    }, {
        key: "_halfBlur",
        value: function(e, t, i, r, n, a, o) {
            var s = this._renderer
              , l = this._blurMaterial;
            "latitudinal" !== a && "longitudinal" !== a && console.error("blur direction must be either latitudinal or longitudinal!");
            var h = new Mesh(_lodPlanes[r],l)
              , c = l.uniforms
              , p = _sizeLods[i] - 1
              , u = isFinite(n) ? Math.PI / (2 * p) : 2 * Math.PI / (2 * MAX_SAMPLES - 1)
              , d = n / u
              , f = isFinite(n) ? 1 + Math.floor(3 * d) : MAX_SAMPLES;
            f > MAX_SAMPLES && console.warn("sigmaRadians, ".concat(n, ", is too large and will clip, as it requested ").concat(f, " samples when the maximum is set to ").concat(MAX_SAMPLES));
            for (var m = [], g = 0, v = 0; v < MAX_SAMPLES; ++v) {
                var y = v / d
                  , _ = Math.exp(-y * y / 2);
                m.push(_),
                0 == v ? g += _ : v < f && (g += 2 * _)
            }
            for (var b = 0; b < m.length; b++)
                m[b] = m[b] / g;
            c.envMap.value = e.texture,
            c.samples.value = f,
            c.weights.value = m,
            c.latitudinal.value = "latitudinal" === a,
            o && (c.poleAxis.value = o),
            c.dTheta.value = u,
            c.mipInt.value = LOD_MAX - i,
            this._setEncoding(c.inputEncoding, e.texture),
            this._setEncoding(c.outputEncoding, e.texture);
            var x = _sizeLods[r];
            _setViewport(t, 3 * Math.max(0, SIZE_MAX - 2 * x), (0 === r ? 0 : 2 * SIZE_MAX) + 2 * x * (r > LOD_MAX - LOD_MIN ? r - LOD_MAX + LOD_MIN : 0), 3 * x, 2 * x),
            s.setRenderTarget(t),
            s.render(h, _flatCamera)
        }
    }]),
    e
}();
function _isLDR(e) {
    return void 0 !== e && e.type === UnsignedByteType && (e.encoding === LinearEncoding || e.encoding === sRGBEncoding || e.encoding === GammaEncoding)
}
function _createPlanes() {
    for (var e = [], t = [], i = [], r = LOD_MAX, n = 0; n < TOTAL_LODS; n++) {
        var a = Math.pow(2, r);
        t.push(a);
        var o = 1 / a;
        n > LOD_MAX - LOD_MIN ? o = EXTRA_LOD_SIGMA[n - LOD_MAX + LOD_MIN - 1] : 0 == n && (o = 0),
        i.push(o);
        for (var s = 1 / (a - 1), l = -s / 2, h = 1 + s / 2, c = [l, l, h, l, h, h, l, l, h, h, l, h], p = new Float32Array(108), u = new Float32Array(72), d = new Float32Array(36), f = 0; f < 6; f++) {
            var m = f % 3 * 2 / 3 - 1
              , g = f > 2 ? 0 : -1
              , v = [m, g, 0, m + 2 / 3, g, 0, m + 2 / 3, g + 1, 0, m, g, 0, m + 2 / 3, g + 1, 0, m, g + 1, 0];
            p.set(v, 18 * f),
            u.set(c, 12 * f);
            var y = [f, f, f, f, f, f];
            d.set(y, 6 * f)
        }
        var _ = new BufferGeometry;
        _.setAttribute("position", new BufferAttribute(p,3)),
        _.setAttribute("uv", new BufferAttribute(u,2)),
        _.setAttribute("faceIndex", new BufferAttribute(d,1)),
        e.push(_),
        r > LOD_MIN && r--
    }
    return {
        _lodPlanes: e,
        _sizeLods: t,
        _sigmas: i
    }
}
function _createRenderTarget(e) {
    var t = new WebGLRenderTarget(3 * SIZE_MAX,3 * SIZE_MAX,e);
    return t.texture.mapping = CubeUVReflectionMapping,
    t.texture.name = "PMREM.cubeUv",
    t.scissorTest = !0,
    t
}
function _setViewport(e, t, i, r, n) {
    e.viewport.set(t, i, r, n),
    e.scissor.set(t, i, r, n)
}
function _getBlurShader(e) {
    var t = new Float32Array(e)
      , i = new Vector3(0,1,0);
    return new RawShaderMaterial({
        name: "SphericalGaussianBlur",
        defines: {
            n: e
        },
        uniforms: {
            envMap: {
                value: null
            },
            samples: {
                value: 1
            },
            weights: {
                value: t
            },
            latitudinal: {
                value: !1
            },
            dTheta: {
                value: 0
            },
            mipInt: {
                value: 0
            },
            poleAxis: {
                value: i
            },
            inputEncoding: {
                value: ENCODINGS[LinearEncoding]
            },
            outputEncoding: {
                value: ENCODINGS[LinearEncoding]
            }
        },
        vertexShader: _getCommonVertexShader(),
        fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat(_getEncodings(), "\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
        blending: NoBlending,
        depthTest: !1,
        depthWrite: !1
    })
}
function _getEquirectShader() {
    var e = new Vector2(1,1);
    return new RawShaderMaterial({
        name: "EquirectangularToCubeUV",
        uniforms: {
            envMap: {
                value: null
            },
            texelSize: {
                value: e
            },
            inputEncoding: {
                value: ENCODINGS[LinearEncoding]
            },
            outputEncoding: {
                value: ENCODINGS[LinearEncoding]
            }
        },
        vertexShader: _getCommonVertexShader(),
        fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat(_getEncodings(), "\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
        blending: NoBlending,
        depthTest: !1,
        depthWrite: !1
    })
}
function _getCubemapShader() {
    return new RawShaderMaterial({
        name: "CubemapToCubeUV",
        uniforms: {
            envMap: {
                value: null
            },
            inputEncoding: {
                value: ENCODINGS[LinearEncoding]
            },
            outputEncoding: {
                value: ENCODINGS[LinearEncoding]
            }
        },
        vertexShader: _getCommonVertexShader(),
        fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat(_getEncodings(), "\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
        blending: NoBlending,
        depthTest: !1,
        depthWrite: !1
    })
}
function _getCommonVertexShader() {
    return "\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"
}
function _getEncodings() {
    return "\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"
}
function WebGLCubeUVMaps(e) {
    var t = new WeakMap
      , i = null;
    function r(e) {
        var i = e.target;
        i.removeEventListener("dispose", r);
        var n = t.get(i);
        void 0 !== n && (t.delete(i),
        n.dispose())
    }
    return {
        get: function(n) {
            if (n && n.isTexture && !1 === n.isRenderTargetTexture) {
                var a = n.mapping
                  , o = a === EquirectangularReflectionMapping || a === EquirectangularRefractionMapping
                  , s = a === CubeReflectionMapping || a === CubeRefractionMapping;
                if (o || s) {
                    if (t.has(n))
                        return t.get(n).texture;
                    var l = n.image;
                    if (o && l && l.height > 0 || s && l && function(e) {
                        for (var t = 0, i = 0; i < 6; i++)
                            void 0 !== e[i] && t++;
                        return 6 === t
                    }(l)) {
                        var h = e.getRenderTarget();
                        null === i && (i = new PMREMGenerator(e));
                        var c = o ? i.fromEquirectangular(n) : i.fromCubemap(n);
                        return t.set(n, c),
                        e.setRenderTarget(h),
                        n.addEventListener("dispose", r),
                        c.texture
                    }
                    return null
                }
            }
            return n
        },
        dispose: function() {
            t = new WeakMap,
            null !== i && (i.dispose(),
            i = null)
        }
    }
}
function WebGLExtensions(e) {
    var t = {};
    function i(i) {
        if (void 0 !== t[i])
            return t[i];
        var r;
        switch (i) {
        case "WEBGL_depth_texture":
            r = e.getExtension("WEBGL_depth_texture") || e.getExtension("MOZ_WEBGL_depth_texture") || e.getExtension("WEBKIT_WEBGL_depth_texture");
            break;
        case "EXT_texture_filter_anisotropic":
            r = e.getExtension("EXT_texture_filter_anisotropic") || e.getExtension("MOZ_EXT_texture_filter_anisotropic") || e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
            break;
        case "WEBGL_compressed_texture_s3tc":
            r = e.getExtension("WEBGL_compressed_texture_s3tc") || e.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
            break;
        case "WEBGL_compressed_texture_pvrtc":
            r = e.getExtension("WEBGL_compressed_texture_pvrtc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
            break;
        default:
            r = e.getExtension(i)
        }
        return t[i] = r,
        r
    }
    return {
        has: function(e) {
            return null !== i(e)
        },
        init: function(e) {
            e.isWebGL2 ? i("EXT_color_buffer_float") : (i("WEBGL_depth_texture"),
            i("OES_texture_float"),
            i("OES_texture_half_float"),
            i("OES_texture_half_float_linear"),
            i("OES_standard_derivatives"),
            i("OES_element_index_uint"),
            i("OES_vertex_array_object"),
            i("ANGLE_instanced_arrays")),
            i("OES_texture_float_linear"),
            i("EXT_color_buffer_half_float")
        },
        get: function(e) {
            var t = i(e);
            return null === t && console.warn("THREE.WebGLRenderer: " + e + " extension not supported."),
            t
        }
    }
}
function WebGLGeometries(e, t, i, r) {
    var n = {}
      , a = new WeakMap;
    function o(e) {
        var s = e.target;
        for (var l in null !== s.index && t.remove(s.index),
        s.attributes)
            t.remove(s.attributes[l]);
        s.removeEventListener("dispose", o),
        delete n[s.id];
        var h = a.get(s);
        h && (t.remove(h),
        a.delete(s)),
        r.releaseStatesOfGeometry(s),
        !0 === s.isInstancedBufferGeometry && delete s._maxInstanceCount,
        i.memory.geometries--
    }
    function s(e) {
        var i = []
          , r = e.index
          , n = e.attributes.position
          , o = 0;
        if (null !== r) {
            var s = r.array;
            o = r.version;
            for (var l = 0, h = s.length; l < h; l += 3) {
                var c = s[l + 0]
                  , p = s[l + 1]
                  , u = s[l + 2];
                i.push(c, p, p, u, u, c)
            }
        } else {
            var d = n.array;
            o = n.version;
            for (var f = 0, m = d.length / 3 - 1; f < m; f += 3) {
                var g = f + 0
                  , v = f + 1
                  , y = f + 2;
                i.push(g, v, v, y, y, g)
            }
        }
        var _ = new (arrayMax(i) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute)(i,1);
        _.version = o;
        var b = a.get(e);
        b && t.remove(b),
        a.set(e, _)
    }
    return {
        get: function(e, t) {
            return !0 === n[t.id] || (t.addEventListener("dispose", o),
            n[t.id] = !0,
            i.memory.geometries++),
            t
        },
        update: function(e) {
            var i = e.attributes;
            for (var r in i)
                t.update(i[r], 34962);
            var n = e.morphAttributes;
            for (var a in n)
                for (var o = n[a], s = 0, l = o.length; s < l; s++)
                    t.update(o[s], 34962)
        },
        getWireframeAttribute: function(e) {
            var t = a.get(e);
            if (t) {
                var i = e.index;
                null !== i && t.version < i.version && s(e)
            } else
                s(e);
            return a.get(e)
        }
    }
}
function WebGLIndexedBufferRenderer(e, t, i, r) {
    var n, a, o, s = r.isWebGL2;
    this.setMode = function(e) {
        n = e
    }
    ,
    this.setIndex = function(e) {
        a = e.type,
        o = e.bytesPerElement
    }
    ,
    this.render = function(t, r) {
        e.drawElements(n, r, a, t * o),
        i.update(r, n, 1)
    }
    ,
    this.renderInstances = function(r, l, h) {
        if (0 !== h) {
            var c, p;
            if (s)
                c = e,
                p = "drawElementsInstanced";
            else if (p = "drawElementsInstancedANGLE",
            null === (c = t.get("ANGLE_instanced_arrays")))
                return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
            c[p](n, l, a, r * o, h),
            i.update(l, n, h)
        }
    }
}
function WebGLInfo(e) {
    var t = {
        frame: 0,
        calls: 0,
        triangles: 0,
        points: 0,
        lines: 0
    };
    return {
        memory: {
            geometries: 0,
            textures: 0
        },
        render: t,
        programs: null,
        autoReset: !0,
        reset: function() {
            t.frame++,
            t.calls = 0,
            t.triangles = 0,
            t.points = 0,
            t.lines = 0
        },
        update: function(e, i, r) {
            switch (t.calls++,
            i) {
            case 4:
                t.triangles += r * (e / 3);
                break;
            case 1:
                t.lines += r * (e / 2);
                break;
            case 3:
                t.lines += r * (e - 1);
                break;
            case 2:
                t.lines += r * e;
                break;
            case 0:
                t.points += r * e;
                break;
            default:
                console.error("THREE.WebGLInfo: Unknown draw mode:", i)
            }
        }
    }
}
var DataTexture2DArray = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        return _classCallCheck2(this, i),
        (e = t.call(this, null)).image = {
            data: r,
            width: n,
            height: a,
            depth: o
        },
        e.magFilter = NearestFilter,
        e.minFilter = NearestFilter,
        e.wrapR = ClampToEdgeWrapping,
        e.generateMipmaps = !1,
        e.flipY = !1,
        e.unpackAlignment = 1,
        e.needsUpdate = !0,
        e
    }
    return _createClass2(i)
}();
function numericalSort(e, t) {
    return e[0] - t[0]
}
function absNumericalSort(e, t) {
    return Math.abs(t[1]) - Math.abs(e[1])
}
function denormalize(e, t) {
    var i = 1
      , r = t.isInterleavedBufferAttribute ? t.data.array : t.array;
    r instanceof Int8Array ? i = 127 : r instanceof Int16Array ? i = 32767 : r instanceof Int32Array ? i = 2147483647 : console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ", r),
    e.divideScalar(i)
}
function WebGLMorphtargets(e, t, i) {
    for (var r = {}, n = new Float32Array(8), a = new WeakMap, o = new Vector3, s = [], l = 0; l < 8; l++)
        s[l] = [l, 0];
    return {
        update: function(l, h, c, p) {
            var u = l.morphTargetInfluences;
            if (!0 === t.isWebGL2) {
                var d = h.morphAttributes.position.length
                  , f = a.get(h);
                if (void 0 === f || f.count !== d) {
                    void 0 !== f && f.texture.dispose();
                    var m = void 0 !== h.morphAttributes.normal
                      , g = h.morphAttributes.position
                      , v = h.morphAttributes.normal || []
                      , y = !0 === m ? 2 : 1
                      , _ = h.attributes.position.count * y
                      , b = 1;
                    _ > t.maxTextureSize && (b = Math.ceil(_ / t.maxTextureSize),
                    _ = t.maxTextureSize);
                    var x = new Float32Array(_ * b * 4 * d)
                      , w = new DataTexture2DArray(x,_,b,d);
                    w.format = RGBAFormat,
                    w.type = FloatType;
                    for (var S = 4 * y, T = 0; T < d; T++)
                        for (var k = g[T], E = v[T], M = _ * b * 4 * T, P = 0; P < k.count; P++) {
                            o.fromBufferAttribute(k, P),
                            !0 === k.normalized && denormalize(o, k);
                            var C = P * S;
                            x[M + C + 0] = o.x,
                            x[M + C + 1] = o.y,
                            x[M + C + 2] = o.z,
                            x[M + C + 3] = 0,
                            !0 === m && (o.fromBufferAttribute(E, P),
                            !0 === E.normalized && denormalize(o, E),
                            x[M + C + 4] = o.x,
                            x[M + C + 5] = o.y,
                            x[M + C + 6] = o.z,
                            x[M + C + 7] = 0)
                        }
                    f = {
                        count: d,
                        texture: w,
                        size: new Vector2(_,b)
                    },
                    a.set(h, f)
                }
                for (var A = 0, L = 0; L < u.length; L++)
                    A += u[L];
                var D = h.morphTargetsRelative ? 1 : 1 - A;
                p.getUniforms().setValue(e, "morphTargetBaseInfluence", D),
                p.getUniforms().setValue(e, "morphTargetInfluences", u),
                p.getUniforms().setValue(e, "morphTargetsTexture", f.texture, i),
                p.getUniforms().setValue(e, "morphTargetsTextureSize", f.size)
            } else {
                var I = void 0 === u ? 0 : u.length
                  , R = r[h.id];
                if (void 0 === R || R.length !== I) {
                    R = [];
                    for (var F = 0; F < I; F++)
                        R[F] = [F, 0];
                    r[h.id] = R
                }
                for (var B = 0; B < I; B++) {
                    var O = R[B];
                    O[0] = B,
                    O[1] = u[B]
                }
                R.sort(absNumericalSort);
                for (var N = 0; N < 8; N++)
                    N < I && R[N][1] ? (s[N][0] = R[N][0],
                    s[N][1] = R[N][1]) : (s[N][0] = Number.MAX_SAFE_INTEGER,
                    s[N][1] = 0);
                s.sort(numericalSort);
                for (var V = h.morphAttributes.position, z = h.morphAttributes.normal, G = 0, H = 0; H < 8; H++) {
                    var U = s[H]
                      , W = U[0]
                      , j = U[1];
                    W !== Number.MAX_SAFE_INTEGER && j ? (V && h.getAttribute("morphTarget" + H) !== V[W] && h.setAttribute("morphTarget" + H, V[W]),
                    z && h.getAttribute("morphNormal" + H) !== z[W] && h.setAttribute("morphNormal" + H, z[W]),
                    n[H] = j,
                    G += j) : (V && !0 === h.hasAttribute("morphTarget" + H) && h.deleteAttribute("morphTarget" + H),
                    z && !0 === h.hasAttribute("morphNormal" + H) && h.deleteAttribute("morphNormal" + H),
                    n[H] = 0)
                }
                var $ = h.morphTargetsRelative ? 1 : 1 - G;
                p.getUniforms().setValue(e, "morphTargetBaseInfluence", $),
                p.getUniforms().setValue(e, "morphTargetInfluences", n)
            }
        }
    }
}
function WebGLObjects(e, t, i, r) {
    var n = new WeakMap;
    function a(e) {
        var t = e.target;
        t.removeEventListener("dispose", a),
        i.remove(t.instanceMatrix),
        null !== t.instanceColor && i.remove(t.instanceColor)
    }
    return {
        update: function(e) {
            var o = r.render.frame
              , s = e.geometry
              , l = t.get(e, s);
            return n.get(l) !== o && (t.update(l),
            n.set(l, o)),
            e.isInstancedMesh && (!1 === e.hasEventListener("dispose", a) && e.addEventListener("dispose", a),
            i.update(e.instanceMatrix, 34962),
            null !== e.instanceColor && i.update(e.instanceColor, 34962)),
            l
        },
        dispose: function() {
            n = new WeakMap
        }
    }
}
DataTexture2DArray.prototype.isDataTexture2DArray = !0;
var DataTexture3D = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        return _classCallCheck2(this, i),
        (e = t.call(this, null)).image = {
            data: r,
            width: n,
            height: a,
            depth: o
        },
        e.magFilter = NearestFilter,
        e.minFilter = NearestFilter,
        e.wrapR = ClampToEdgeWrapping,
        e.generateMipmaps = !1,
        e.flipY = !1,
        e.unpackAlignment = 1,
        e.needsUpdate = !0,
        e
    }
    return _createClass2(i)
}();
DataTexture3D.prototype.isDataTexture3D = !0;
var emptyTexture = new Texture
  , emptyTexture2dArray = new DataTexture2DArray
  , emptyTexture3d = new DataTexture3D
  , emptyCubeTexture = new CubeTexture
  , arrayCacheF32 = []
  , arrayCacheI32 = []
  , mat4array = new Float32Array(16)
  , mat3array = new Float32Array(9)
  , mat2array = new Float32Array(4);
function flatten$1(e, t, i) {
    var r = e[0];
    if (r <= 0 || r > 0)
        return e;
    var n = t * i
      , a = arrayCacheF32[n];
    if (void 0 === a && (a = new Float32Array(n),
    arrayCacheF32[n] = a),
    0 !== t) {
        r.toArray(a, 0);
        for (var o = 1, s = 0; o !== t; ++o)
            s += i,
            e[o].toArray(a, s)
    }
    return a
}
function arraysEqual(e, t) {
    if (e.length !== t.length)
        return !1;
    for (var i = 0, r = e.length; i < r; i++)
        if (e[i] !== t[i])
            return !1;
    return !0
}
function copyArray(e, t) {
    for (var i = 0, r = t.length; i < r; i++)
        e[i] = t[i]
}
function allocTexUnits(e, t) {
    var i = arrayCacheI32[t];
    void 0 === i && (i = new Int32Array(t),
    arrayCacheI32[t] = i);
    for (var r = 0; r !== t; ++r)
        i[r] = e.allocateTextureUnit();
    return i
}
function setValueV1f(e, t) {
    var i = this.cache;
    i[0] !== t && (e.uniform1f(this.addr, t),
    i[0] = t)
}
function setValueV2f(e, t) {
    var i = this.cache;
    if (void 0 !== t.x)
        i[0] === t.x && i[1] === t.y || (e.uniform2f(this.addr, t.x, t.y),
        i[0] = t.x,
        i[1] = t.y);
    else {
        if (arraysEqual(i, t))
            return;
        e.uniform2fv(this.addr, t),
        copyArray(i, t)
    }
}
function setValueV3f(e, t) {
    var i = this.cache;
    if (void 0 !== t.x)
        i[0] === t.x && i[1] === t.y && i[2] === t.z || (e.uniform3f(this.addr, t.x, t.y, t.z),
        i[0] = t.x,
        i[1] = t.y,
        i[2] = t.z);
    else if (void 0 !== t.r)
        i[0] === t.r && i[1] === t.g && i[2] === t.b || (e.uniform3f(this.addr, t.r, t.g, t.b),
        i[0] = t.r,
        i[1] = t.g,
        i[2] = t.b);
    else {
        if (arraysEqual(i, t))
            return;
        e.uniform3fv(this.addr, t),
        copyArray(i, t)
    }
}
function setValueV4f(e, t) {
    var i = this.cache;
    if (void 0 !== t.x)
        i[0] === t.x && i[1] === t.y && i[2] === t.z && i[3] === t.w || (e.uniform4f(this.addr, t.x, t.y, t.z, t.w),
        i[0] = t.x,
        i[1] = t.y,
        i[2] = t.z,
        i[3] = t.w);
    else {
        if (arraysEqual(i, t))
            return;
        e.uniform4fv(this.addr, t),
        copyArray(i, t)
    }
}
function setValueM2(e, t) {
    var i = this.cache
      , r = t.elements;
    if (void 0 === r) {
        if (arraysEqual(i, t))
            return;
        e.uniformMatrix2fv(this.addr, !1, t),
        copyArray(i, t)
    } else {
        if (arraysEqual(i, r))
            return;
        mat2array.set(r),
        e.uniformMatrix2fv(this.addr, !1, mat2array),
        copyArray(i, r)
    }
}
function setValueM3(e, t) {
    var i = this.cache
      , r = t.elements;
    if (void 0 === r) {
        if (arraysEqual(i, t))
            return;
        e.uniformMatrix3fv(this.addr, !1, t),
        copyArray(i, t)
    } else {
        if (arraysEqual(i, r))
            return;
        mat3array.set(r),
        e.uniformMatrix3fv(this.addr, !1, mat3array),
        copyArray(i, r)
    }
}
function setValueM4(e, t) {
    var i = this.cache
      , r = t.elements;
    if (void 0 === r) {
        if (arraysEqual(i, t))
            return;
        e.uniformMatrix4fv(this.addr, !1, t),
        copyArray(i, t)
    } else {
        if (arraysEqual(i, r))
            return;
        mat4array.set(r),
        e.uniformMatrix4fv(this.addr, !1, mat4array),
        copyArray(i, r)
    }
}
function setValueV1i(e, t) {
    var i = this.cache;
    i[0] !== t && (e.uniform1i(this.addr, t),
    i[0] = t)
}
function setValueV2i(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform2iv(this.addr, t),
    copyArray(i, t))
}
function setValueV3i(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform3iv(this.addr, t),
    copyArray(i, t))
}
function setValueV4i(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform4iv(this.addr, t),
    copyArray(i, t))
}
function setValueV1ui(e, t) {
    var i = this.cache;
    i[0] !== t && (e.uniform1ui(this.addr, t),
    i[0] = t)
}
function setValueV2ui(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform2uiv(this.addr, t),
    copyArray(i, t))
}
function setValueV3ui(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform3uiv(this.addr, t),
    copyArray(i, t))
}
function setValueV4ui(e, t) {
    var i = this.cache;
    arraysEqual(i, t) || (e.uniform4uiv(this.addr, t),
    copyArray(i, t))
}
function setValueT1(e, t, i) {
    var r = this.cache
      , n = i.allocateTextureUnit();
    r[0] !== n && (e.uniform1i(this.addr, n),
    r[0] = n),
    i.safeSetTexture2D(t || emptyTexture, n)
}
function setValueT3D1(e, t, i) {
    var r = this.cache
      , n = i.allocateTextureUnit();
    r[0] !== n && (e.uniform1i(this.addr, n),
    r[0] = n),
    i.setTexture3D(t || emptyTexture3d, n)
}
function setValueT6(e, t, i) {
    var r = this.cache
      , n = i.allocateTextureUnit();
    r[0] !== n && (e.uniform1i(this.addr, n),
    r[0] = n),
    i.safeSetTextureCube(t || emptyCubeTexture, n)
}
function setValueT2DArray1(e, t, i) {
    var r = this.cache
      , n = i.allocateTextureUnit();
    r[0] !== n && (e.uniform1i(this.addr, n),
    r[0] = n),
    i.setTexture2DArray(t || emptyTexture2dArray, n)
}
function getSingularSetter(e) {
    switch (e) {
    case 5126:
        return setValueV1f;
    case 35664:
        return setValueV2f;
    case 35665:
        return setValueV3f;
    case 35666:
        return setValueV4f;
    case 35674:
        return setValueM2;
    case 35675:
        return setValueM3;
    case 35676:
        return setValueM4;
    case 5124:
    case 35670:
        return setValueV1i;
    case 35667:
    case 35671:
        return setValueV2i;
    case 35668:
    case 35672:
        return setValueV3i;
    case 35669:
    case 35673:
        return setValueV4i;
    case 5125:
        return setValueV1ui;
    case 36294:
        return setValueV2ui;
    case 36295:
        return setValueV3ui;
    case 36296:
        return setValueV4ui;
    case 35678:
    case 36198:
    case 36298:
    case 36306:
    case 35682:
        return setValueT1;
    case 35679:
    case 36299:
    case 36307:
        return setValueT3D1;
    case 35680:
    case 36300:
    case 36308:
    case 36293:
        return setValueT6;
    case 36289:
    case 36303:
    case 36311:
    case 36292:
        return setValueT2DArray1
    }
}
function setValueV1fArray(e, t) {
    e.uniform1fv(this.addr, t)
}
function setValueV2fArray(e, t) {
    var i = flatten$1(t, this.size, 2);
    e.uniform2fv(this.addr, i)
}
function setValueV3fArray(e, t) {
    var i = flatten$1(t, this.size, 3);
    e.uniform3fv(this.addr, i)
}
function setValueV4fArray(e, t) {
    var i = flatten$1(t, this.size, 4);
    e.uniform4fv(this.addr, i)
}
function setValueM2Array(e, t) {
    var i = flatten$1(t, this.size, 4);
    e.uniformMatrix2fv(this.addr, !1, i)
}
function setValueM3Array(e, t) {
    var i = flatten$1(t, this.size, 9);
    e.uniformMatrix3fv(this.addr, !1, i)
}
function setValueM4Array(e, t) {
    var i = flatten$1(t, this.size, 16);
    e.uniformMatrix4fv(this.addr, !1, i)
}
function setValueV1iArray(e, t) {
    e.uniform1iv(this.addr, t)
}
function setValueV2iArray(e, t) {
    e.uniform2iv(this.addr, t)
}
function setValueV3iArray(e, t) {
    e.uniform3iv(this.addr, t)
}
function setValueV4iArray(e, t) {
    e.uniform4iv(this.addr, t)
}
function setValueV1uiArray(e, t) {
    e.uniform1uiv(this.addr, t)
}
function setValueV2uiArray(e, t) {
    e.uniform2uiv(this.addr, t)
}
function setValueV3uiArray(e, t) {
    e.uniform3uiv(this.addr, t)
}
function setValueV4uiArray(e, t) {
    e.uniform4uiv(this.addr, t)
}
function setValueT1Array(e, t, i) {
    var r = t.length
      , n = allocTexUnits(i, r);
    e.uniform1iv(this.addr, n);
    for (var a = 0; a !== r; ++a)
        i.safeSetTexture2D(t[a] || emptyTexture, n[a])
}
function setValueT6Array(e, t, i) {
    var r = t.length
      , n = allocTexUnits(i, r);
    e.uniform1iv(this.addr, n);
    for (var a = 0; a !== r; ++a)
        i.safeSetTextureCube(t[a] || emptyCubeTexture, n[a])
}
function getPureArraySetter(e) {
    switch (e) {
    case 5126:
        return setValueV1fArray;
    case 35664:
        return setValueV2fArray;
    case 35665:
        return setValueV3fArray;
    case 35666:
        return setValueV4fArray;
    case 35674:
        return setValueM2Array;
    case 35675:
        return setValueM3Array;
    case 35676:
        return setValueM4Array;
    case 5124:
    case 35670:
        return setValueV1iArray;
    case 35667:
    case 35671:
        return setValueV2iArray;
    case 35668:
    case 35672:
        return setValueV3iArray;
    case 35669:
    case 35673:
        return setValueV4iArray;
    case 5125:
        return setValueV1uiArray;
    case 36294:
        return setValueV2uiArray;
    case 36295:
        return setValueV3uiArray;
    case 36296:
        return setValueV4uiArray;
    case 35678:
    case 36198:
    case 36298:
    case 36306:
    case 35682:
        return setValueT1Array;
    case 35680:
    case 36300:
    case 36308:
    case 36293:
        return setValueT6Array
    }
}
function SingleUniform(e, t, i) {
    this.id = e,
    this.addr = i,
    this.cache = [],
    this.setValue = getSingularSetter(t.type)
}
function PureArrayUniform(e, t, i) {
    this.id = e,
    this.addr = i,
    this.cache = [],
    this.size = t.size,
    this.setValue = getPureArraySetter(t.type)
}
function StructuredUniform(e) {
    this.id = e,
    this.seq = [],
    this.map = {}
}
PureArrayUniform.prototype.updateCache = function(e) {
    var t = this.cache;
    e instanceof Float32Array && t.length !== e.length && (this.cache = new Float32Array(e.length)),
    copyArray(t, e)
}
,
StructuredUniform.prototype.setValue = function(e, t, i) {
    for (var r = this.seq, n = 0, a = r.length; n !== a; ++n) {
        var o = r[n];
        o.setValue(e, t[o.id], i)
    }
}
;
var RePathPart = /(\w+)(\])?(\[|\.)?/g;
function addUniform(e, t) {
    e.seq.push(t),
    e.map[t.id] = t
}
function parseUniform(e, t, i) {
    var r = e.name
      , n = r.length;
    for (RePathPart.lastIndex = 0; ; ) {
        var a = RePathPart.exec(r)
          , o = RePathPart.lastIndex
          , s = a[1]
          , l = "]" === a[2]
          , h = a[3];
        if (l && (s |= 0),
        void 0 === h || "[" === h && o + 2 === n) {
            addUniform(i, void 0 === h ? new SingleUniform(s,e,t) : new PureArrayUniform(s,e,t));
            break
        }
        var c = i.map[s];
        void 0 === c && addUniform(i, c = new StructuredUniform(s)),
        i = c
    }
}
function WebGLUniforms(e, t) {
    this.seq = [],
    this.map = {};
    for (var i = e.getProgramParameter(t, 35718), r = 0; r < i; ++r) {
        var n = e.getActiveUniform(t, r);
        parseUniform(n, e.getUniformLocation(t, n.name), this)
    }
}
function WebGLShader(e, t, i) {
    var r = e.createShader(t);
    return e.shaderSource(r, i),
    e.compileShader(r),
    r
}
WebGLUniforms.prototype.setValue = function(e, t, i, r) {
    var n = this.map[t];
    void 0 !== n && n.setValue(e, i, r)
}
,
WebGLUniforms.prototype.setOptional = function(e, t, i) {
    var r = t[i];
    void 0 !== r && this.setValue(e, i, r)
}
,
WebGLUniforms.upload = function(e, t, i, r) {
    for (var n = 0, a = t.length; n !== a; ++n) {
        var o = t[n]
          , s = i[o.id];
        !1 !== s.needsUpdate && o.setValue(e, s.value, r)
    }
}
,
WebGLUniforms.seqWithValue = function(e, t) {
    for (var i = [], r = 0, n = e.length; r !== n; ++r) {
        var a = e[r];
        a.id in t && i.push(a)
    }
    return i
}
;
var programIdCount = 0;
function addLineNumbers(e) {
    for (var t = e.split("\n"), i = 0; i < t.length; i++)
        t[i] = i + 1 + ": " + t[i];
    return t.join("\n")
}
function getEncodingComponents(e) {
    switch (e) {
    case LinearEncoding:
        return ["Linear", "( value )"];
    case sRGBEncoding:
        return ["sRGB", "( value )"];
    case RGBEEncoding:
        return ["RGBE", "( value )"];
    case RGBM7Encoding:
        return ["RGBM", "( value, 7.0 )"];
    case RGBM16Encoding:
        return ["RGBM", "( value, 16.0 )"];
    case RGBDEncoding:
        return ["RGBD", "( value, 256.0 )"];
    case GammaEncoding:
        return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
    case LogLuvEncoding:
        return ["LogLuv", "( value )"];
    default:
        return console.warn("THREE.WebGLProgram: Unsupported encoding:", e),
        ["Linear", "( value )"]
    }
}
function getShaderErrors(e, t, i) {
    var r = e.getShaderParameter(t, 35713)
      , n = e.getShaderInfoLog(t).trim();
    return r && "" === n ? "" : i.toUpperCase() + "\n\n" + n + "\n\n" + addLineNumbers(e.getShaderSource(t))
}
function getTexelDecodingFunction(e, t) {
    var i = getEncodingComponents(t);
    return "vec4 " + e + "( vec4 value ) { return " + i[0] + "ToLinear" + i[1] + "; }"
}
function getTexelEncodingFunction(e, t) {
    var i = getEncodingComponents(t);
    return "vec4 " + e + "( vec4 value ) { return LinearTo" + i[0] + i[1] + "; }"
}
function getToneMappingFunction(e, t) {
    var i;
    switch (t) {
    case LinearToneMapping:
        i = "Linear";
        break;
    case ReinhardToneMapping:
        i = "Reinhard";
        break;
    case CineonToneMapping:
        i = "OptimizedCineon";
        break;
    case ACESFilmicToneMapping:
        i = "ACESFilmic";
        break;
    case CustomToneMapping:
        i = "Custom";
        break;
    default:
        console.warn("THREE.WebGLProgram: Unsupported toneMapping:", t),
        i = "Linear"
    }
    return "vec3 " + e + "( vec3 color ) { return " + i + "ToneMapping( color ); }"
}
function generateExtensions(e) {
    return [e.extensionDerivatives || e.envMapCubeUV || e.bumpMap || e.tangentSpaceNormalMap || e.clearcoatNormalMap || e.flatShading || "physical" === e.shaderID ? "#extension GL_OES_standard_derivatives : enable" : "", (e.extensionFragDepth || e.logarithmicDepthBuffer) && e.rendererExtensionFragDepth ? "#extension GL_EXT_frag_depth : enable" : "", e.extensionDrawBuffers && e.rendererExtensionDrawBuffers ? "#extension GL_EXT_draw_buffers : require" : "", (e.extensionShaderTextureLOD || e.envMap || e.transmission) && e.rendererExtensionShaderTextureLod ? "#extension GL_EXT_shader_texture_lod : enable" : ""].filter(filterEmptyLine).join("\n")
}
function generateDefines(e) {
    var t = [];
    for (var i in e) {
        var r = e[i];
        !1 !== r && t.push("#define " + i + " " + r)
    }
    return t.join("\n")
}
function fetchAttributeLocations(e, t) {
    for (var i = {}, r = e.getProgramParameter(t, 35721), n = 0; n < r; n++) {
        var a = e.getActiveAttrib(t, n)
          , o = a.name
          , s = 1;
        35674 === a.type && (s = 2),
        35675 === a.type && (s = 3),
        35676 === a.type && (s = 4),
        i[o] = {
            type: a.type,
            location: e.getAttribLocation(t, o),
            locationSize: s
        }
    }
    return i
}
function filterEmptyLine(e) {
    return "" !== e
}
function replaceLightNums(e, t) {
    return e.replace(/NUM_DIR_LIGHTS/g, t.numDirLights).replace(/NUM_SPOT_LIGHTS/g, t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g, t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g, t.numPointLights).replace(/NUM_HEMI_LIGHTS/g, t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g, t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g, t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g, t.numPointLightShadows)
}
function replaceClippingPlaneNums(e, t) {
    return e.replace(/NUM_CLIPPING_PLANES/g, t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g, t.numClippingPlanes - t.numClipIntersection)
}
var includePattern = /^[ \t]*#include +<([\w\d./]+)>/gm;
function resolveIncludes(e) {
    return e.replace(includePattern, includeReplacer)
}
function includeReplacer(e, t) {
    var i = ShaderChunk[t];
    if (void 0 === i)
        throw new Error("Can not resolve #include <" + t + ">");
    return resolveIncludes(i)
}
var deprecatedUnrollLoopPattern = /#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g
  , unrollLoopPattern = /#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;
function unrollLoops(e) {
    return e.replace(unrollLoopPattern, loopReplacer).replace(deprecatedUnrollLoopPattern, deprecatedLoopReplacer)
}
function deprecatedLoopReplacer(e, t, i, r) {
    return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),
    loopReplacer(e, t, i, r)
}
function loopReplacer(e, t, i, r) {
    for (var n = "", a = parseInt(t); a < parseInt(i); a++)
        n += r.replace(/\[\s*i\s*\]/g, "[ " + a + " ]").replace(/UNROLLED_LOOP_INDEX/g, a);
    return n
}
function generatePrecision(e) {
    var t = "precision " + e.precision + " float;\nprecision " + e.precision + " int;";
    return "highp" === e.precision ? t += "\n#define HIGH_PRECISION" : "mediump" === e.precision ? t += "\n#define MEDIUM_PRECISION" : "lowp" === e.precision && (t += "\n#define LOW_PRECISION"),
    t
}
function generateShadowMapTypeDefine(e) {
    var t = "SHADOWMAP_TYPE_BASIC";
    return e.shadowMapType === PCFShadowMap ? t = "SHADOWMAP_TYPE_PCF" : e.shadowMapType === PCFSoftShadowMap ? t = "SHADOWMAP_TYPE_PCF_SOFT" : e.shadowMapType === VSMShadowMap && (t = "SHADOWMAP_TYPE_VSM"),
    t
}
function generateEnvMapTypeDefine(e) {
    var t = "ENVMAP_TYPE_CUBE";
    if (e.envMap)
        switch (e.envMapMode) {
        case CubeReflectionMapping:
        case CubeRefractionMapping:
            t = "ENVMAP_TYPE_CUBE";
            break;
        case CubeUVReflectionMapping:
        case CubeUVRefractionMapping:
            t = "ENVMAP_TYPE_CUBE_UV"
        }
    return t
}
function generateEnvMapModeDefine(e) {
    var t = "ENVMAP_MODE_REFLECTION";
    if (e.envMap)
        switch (e.envMapMode) {
        case CubeRefractionMapping:
        case CubeUVRefractionMapping:
            t = "ENVMAP_MODE_REFRACTION"
        }
    return t
}
function generateEnvMapBlendingDefine(e) {
    var t = "ENVMAP_BLENDING_NONE";
    if (e.envMap)
        switch (e.combine) {
        case MultiplyOperation:
            t = "ENVMAP_BLENDING_MULTIPLY";
            break;
        case MixOperation:
            t = "ENVMAP_BLENDING_MIX";
            break;
        case AddOperation:
            t = "ENVMAP_BLENDING_ADD"
        }
    return t
}
function WebGLProgram(e, t, i, r) {
    var n, a, o = e.getContext(), s = i.defines, l = i.vertexShader, h = i.fragmentShader, c = generateShadowMapTypeDefine(i), p = generateEnvMapTypeDefine(i), u = generateEnvMapModeDefine(i), d = generateEnvMapBlendingDefine(i), f = e.gammaFactor > 0 ? e.gammaFactor : 1, m = i.isWebGL2 ? "" : generateExtensions(i), g = generateDefines(s), v = o.createProgram(), y = i.glslVersion ? "#version " + i.glslVersion + "\n" : "";
    i.isRawShaderMaterial ? ((n = [g].filter(filterEmptyLine).join("\n")).length > 0 && (n += "\n"),
    (a = [m, g].filter(filterEmptyLine).join("\n")).length > 0 && (a += "\n")) : (n = [generatePrecision(i), "#define SHADER_NAME " + i.shaderName, g, i.instancing ? "#define USE_INSTANCING" : "", i.instancingColor ? "#define USE_INSTANCING_COLOR" : "", i.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", "#define GAMMA_FACTOR " + f, "#define MAX_BONES " + i.maxBones, i.useFog && i.fog ? "#define USE_FOG" : "", i.useFog && i.fogExp2 ? "#define FOG_EXP2" : "", i.map ? "#define USE_MAP" : "", i.envMap ? "#define USE_ENVMAP" : "", i.envMap ? "#define " + u : "", i.lightMap ? "#define USE_LIGHTMAP" : "", i.aoMap ? "#define USE_AOMAP" : "", i.emissiveMap ? "#define USE_EMISSIVEMAP" : "", i.bumpMap ? "#define USE_BUMPMAP" : "", i.normalMap ? "#define USE_NORMALMAP" : "", i.normalMap && i.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", i.normalMap && i.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", i.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", i.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", i.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", i.displacementMap && i.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "", i.specularMap ? "#define USE_SPECULARMAP" : "", i.specularIntensityMap ? "#define USE_SPECULARINTENSITYMAP" : "", i.specularTintMap ? "#define USE_SPECULARTINTMAP" : "", i.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", i.metalnessMap ? "#define USE_METALNESSMAP" : "", i.alphaMap ? "#define USE_ALPHAMAP" : "", i.transmission ? "#define USE_TRANSMISSION" : "", i.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", i.thicknessMap ? "#define USE_THICKNESSMAP" : "", i.vertexTangents ? "#define USE_TANGENT" : "", i.vertexColors ? "#define USE_COLOR" : "", i.vertexAlphas ? "#define USE_COLOR_ALPHA" : "", i.vertexUvs ? "#define USE_UV" : "", i.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", i.flatShading ? "#define FLAT_SHADED" : "", i.skinning ? "#define USE_SKINNING" : "", i.useVertexTexture ? "#define BONE_TEXTURE" : "", i.morphTargets ? "#define USE_MORPHTARGETS" : "", i.morphNormals && !1 === i.flatShading ? "#define USE_MORPHNORMALS" : "", i.morphTargets && i.isWebGL2 ? "#define MORPHTARGETS_TEXTURE" : "", i.morphTargets && i.isWebGL2 ? "#define MORPHTARGETS_COUNT " + i.morphTargetsCount : "", i.doubleSided ? "#define DOUBLE_SIDED" : "", i.flipSided ? "#define FLIP_SIDED" : "", i.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", i.shadowMapEnabled ? "#define " + c : "", i.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", i.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", i.logarithmicDepthBuffer && i.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", "#ifdef USE_INSTANCING", "\tattribute mat4 instanceMatrix;", "#endif", "#ifdef USE_INSTANCING_COLOR", "\tattribute vec3 instanceColor;", "#endif", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "#ifdef USE_TANGENT", "\tattribute vec4 tangent;", "#endif", "#if defined( USE_COLOR_ALPHA )", "\tattribute vec4 color;", "#elif defined( USE_COLOR )", "\tattribute vec3 color;", "#endif", "#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )", "\tattribute vec3 morphTarget0;", "\tattribute vec3 morphTarget1;", "\tattribute vec3 morphTarget2;", "\tattribute vec3 morphTarget3;", "\t#ifdef USE_MORPHNORMALS", "\t\tattribute vec3 morphNormal0;", "\t\tattribute vec3 morphNormal1;", "\t\tattribute vec3 morphNormal2;", "\t\tattribute vec3 morphNormal3;", "\t#else", "\t\tattribute vec3 morphTarget4;", "\t\tattribute vec3 morphTarget5;", "\t\tattribute vec3 morphTarget6;", "\t\tattribute vec3 morphTarget7;", "\t#endif", "#endif", "#ifdef USE_SKINNING", "\tattribute vec4 skinIndex;", "\tattribute vec4 skinWeight;", "#endif", "\n"].filter(filterEmptyLine).join("\n"),
    a = [m, generatePrecision(i), "#define SHADER_NAME " + i.shaderName, g, "#define GAMMA_FACTOR " + f, i.useFog && i.fog ? "#define USE_FOG" : "", i.useFog && i.fogExp2 ? "#define FOG_EXP2" : "", i.map ? "#define USE_MAP" : "", i.matcap ? "#define USE_MATCAP" : "", i.envMap ? "#define USE_ENVMAP" : "", i.envMap ? "#define " + p : "", i.envMap ? "#define " + u : "", i.envMap ? "#define " + d : "", i.lightMap ? "#define USE_LIGHTMAP" : "", i.aoMap ? "#define USE_AOMAP" : "", i.emissiveMap ? "#define USE_EMISSIVEMAP" : "", i.bumpMap ? "#define USE_BUMPMAP" : "", i.normalMap ? "#define USE_NORMALMAP" : "", i.normalMap && i.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", i.normalMap && i.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", i.clearcoat ? "#define USE_CLEARCOAT" : "", i.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", i.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", i.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", i.specularMap ? "#define USE_SPECULARMAP" : "", i.specularIntensityMap ? "#define USE_SPECULARINTENSITYMAP" : "", i.specularTintMap ? "#define USE_SPECULARTINTMAP" : "", i.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", i.metalnessMap ? "#define USE_METALNESSMAP" : "", i.alphaMap ? "#define USE_ALPHAMAP" : "", i.alphaTest ? "#define USE_ALPHATEST" : "", i.sheen ? "#define USE_SHEEN" : "", i.transmission ? "#define USE_TRANSMISSION" : "", i.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", i.thicknessMap ? "#define USE_THICKNESSMAP" : "", i.vertexTangents ? "#define USE_TANGENT" : "", i.vertexColors || i.instancingColor ? "#define USE_COLOR" : "", i.vertexAlphas ? "#define USE_COLOR_ALPHA" : "", i.vertexUvs ? "#define USE_UV" : "", i.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", i.gradientMap ? "#define USE_GRADIENTMAP" : "", i.flatShading ? "#define FLAT_SHADED" : "", i.doubleSided ? "#define DOUBLE_SIDED" : "", i.flipSided ? "#define FLIP_SIDED" : "", i.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", i.shadowMapEnabled ? "#define " + c : "", i.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "", i.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "", i.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", i.logarithmicDepthBuffer && i.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", (i.extensionShaderTextureLOD || i.envMap) && i.rendererExtensionShaderTextureLod ? "#define TEXTURE_LOD_EXT" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", i.toneMapping !== NoToneMapping ? "#define TONE_MAPPING" : "", i.toneMapping !== NoToneMapping ? ShaderChunk.tonemapping_pars_fragment : "", i.toneMapping !== NoToneMapping ? getToneMappingFunction("toneMapping", i.toneMapping) : "", i.dithering ? "#define DITHERING" : "", i.format === RGBFormat ? "#define OPAQUE" : "", ShaderChunk.encodings_pars_fragment, i.map ? getTexelDecodingFunction("mapTexelToLinear", i.mapEncoding) : "", i.matcap ? getTexelDecodingFunction("matcapTexelToLinear", i.matcapEncoding) : "", i.envMap ? getTexelDecodingFunction("envMapTexelToLinear", i.envMapEncoding) : "", i.emissiveMap ? getTexelDecodingFunction("emissiveMapTexelToLinear", i.emissiveMapEncoding) : "", i.specularTintMap ? getTexelDecodingFunction("specularTintMapTexelToLinear", i.specularTintMapEncoding) : "", i.lightMap ? getTexelDecodingFunction("lightMapTexelToLinear", i.lightMapEncoding) : "", getTexelEncodingFunction("linearToOutputTexel", i.outputEncoding), i.depthPacking ? "#define DEPTH_PACKING " + i.depthPacking : "", "\n"].filter(filterEmptyLine).join("\n")),
    l = replaceClippingPlaneNums(l = replaceLightNums(l = resolveIncludes(l), i), i),
    h = replaceClippingPlaneNums(h = replaceLightNums(h = resolveIncludes(h), i), i),
    l = unrollLoops(l),
    h = unrollLoops(h),
    i.isWebGL2 && !0 !== i.isRawShaderMaterial && (y = "#version 300 es\n",
    n = ["precision mediump sampler2DArray;", "#define attribute in", "#define varying out", "#define texture2D texture"].join("\n") + "\n" + n,
    a = ["#define varying in", i.glslVersion === GLSL3 ? "" : "out highp vec4 pc_fragColor;", i.glslVersion === GLSL3 ? "" : "#define gl_FragColor pc_fragColor", "#define gl_FragDepthEXT gl_FragDepth", "#define texture2D texture", "#define textureCube texture", "#define texture2DProj textureProj", "#define texture2DLodEXT textureLod", "#define texture2DProjLodEXT textureProjLod", "#define textureCubeLodEXT textureLod", "#define texture2DGradEXT textureGrad", "#define texture2DProjGradEXT textureProjGrad", "#define textureCubeGradEXT textureGrad"].join("\n") + "\n" + a);
    var _, b, x = y + a + h, w = WebGLShader(o, 35633, y + n + l), S = WebGLShader(o, 35632, x);
    if (o.attachShader(v, w),
    o.attachShader(v, S),
    void 0 !== i.index0AttributeName ? o.bindAttribLocation(v, 0, i.index0AttributeName) : !0 === i.morphTargets && o.bindAttribLocation(v, 0, "position"),
    o.linkProgram(v),
    e.debug.checkShaderErrors) {
        var T = o.getProgramInfoLog(v).trim()
          , k = o.getShaderInfoLog(w).trim()
          , E = o.getShaderInfoLog(S).trim()
          , M = !0
          , P = !0;
        if (!1 === o.getProgramParameter(v, 35714)) {
            M = !1;
            var C = getShaderErrors(o, w, "vertex")
              , A = getShaderErrors(o, S, "fragment");
            console.error("THREE.WebGLProgram: Shader Error " + o.getError() + " - VALIDATE_STATUS " + o.getProgramParameter(v, 35715) + "\n\nProgram Info Log: " + T + "\n" + C + "\n" + A)
        } else
            "" !== T ? console.warn("THREE.WebGLProgram: Program Info Log:", T) : "" !== k && "" !== E || (P = !1);
        P && (this.diagnostics = {
            runnable: M,
            programLog: T,
            vertexShader: {
                log: k,
                prefix: n
            },
            fragmentShader: {
                log: E,
                prefix: a
            }
        })
    }
    return o.deleteShader(w),
    o.deleteShader(S),
    this.getUniforms = function() {
        return void 0 === _ && (_ = new WebGLUniforms(o,v)),
        _
    }
    ,
    this.getAttributes = function() {
        return void 0 === b && (b = fetchAttributeLocations(o, v)),
        b
    }
    ,
    this.destroy = function() {
        r.releaseStatesOfProgram(this),
        o.deleteProgram(v),
        this.program = void 0
    }
    ,
    this.name = i.shaderName,
    this.id = programIdCount++,
    this.cacheKey = t,
    this.usedTimes = 1,
    this.program = v,
    this.vertexShader = w,
    this.fragmentShader = S,
    this
}
function WebGLPrograms(e, t, i, r, n, a, o) {
    var s = []
      , l = n.isWebGL2
      , h = n.logarithmicDepthBuffer
      , c = n.floatVertexTextures
      , p = n.maxVertexUniforms
      , u = n.vertexTextures
      , d = n.precision
      , f = {
        MeshDepthMaterial: "depth",
        MeshDistanceMaterial: "distanceRGBA",
        MeshNormalMaterial: "normal",
        MeshBasicMaterial: "basic",
        MeshLambertMaterial: "lambert",
        MeshPhongMaterial: "phong",
        MeshToonMaterial: "toon",
        MeshStandardMaterial: "physical",
        MeshPhysicalMaterial: "physical",
        MeshMatcapMaterial: "matcap",
        LineBasicMaterial: "basic",
        LineDashedMaterial: "dashed",
        PointsMaterial: "points",
        ShadowMaterial: "shadow",
        SpriteMaterial: "sprite"
    }
      , m = ["precision", "isWebGL2", "supportsVertexTextures", "outputEncoding", "instancing", "instancingColor", "map", "mapEncoding", "matcap", "matcapEncoding", "envMap", "envMapMode", "envMapEncoding", "envMapCubeUV", "lightMap", "lightMapEncoding", "aoMap", "emissiveMap", "emissiveMapEncoding", "bumpMap", "normalMap", "objectSpaceNormalMap", "tangentSpaceNormalMap", "clearcoat", "clearcoatMap", "clearcoatRoughnessMap", "clearcoatNormalMap", "displacementMap", "specularMap", "specularIntensityMap", "specularTintMap", "specularTintMapEncoding", "roughnessMap", "metalnessMap", "gradientMap", "alphaMap", "alphaTest", "combine", "vertexColors", "vertexAlphas", "vertexTangents", "vertexUvs", "uvsVertexOnly", "fog", "useFog", "fogExp2", "flatShading", "sizeAttenuation", "logarithmicDepthBuffer", "skinning", "maxBones", "useVertexTexture", "morphTargets", "morphNormals", "morphTargetsCount", "premultipliedAlpha", "numDirLights", "numPointLights", "numSpotLights", "numHemiLights", "numRectAreaLights", "numDirLightShadows", "numPointLightShadows", "numSpotLightShadows", "shadowMapEnabled", "shadowMapType", "toneMapping", "physicallyCorrectLights", "doubleSided", "flipSided", "numClippingPlanes", "numClipIntersection", "depthPacking", "dithering", "format", "sheen", "transmission", "transmissionMap", "thicknessMap"];
    function g(e) {
        var t;
        return e && e.isTexture ? t = e.encoding : e && e.isWebGLRenderTarget ? (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),
        t = e.texture.encoding) : t = LinearEncoding,
        l && e && e.isTexture && e.format === RGBAFormat && e.type === UnsignedByteType && e.encoding === sRGBEncoding && (t = LinearEncoding),
        t
    }
    return {
        getParameters: function(a, s, m, v, y) {
            var _, b, x = v.fog, w = a.isMeshStandardMaterial ? v.environment : null, S = (a.isMeshStandardMaterial ? i : t).get(a.envMap || w), T = f[a.type], k = y.isSkinnedMesh ? function(e) {
                var t = e.skeleton.bones;
                if (c)
                    return 1024;
                var i = p
                  , r = Math.floor((i - 20) / 4)
                  , n = Math.min(r, t.length);
                return n < t.length ? (console.warn("THREE.WebGLRenderer: Skeleton has " + t.length + " bones. This GPU supports " + n + "."),
                0) : n
            }(y) : 0;
            if (null !== a.precision && (d = n.getMaxPrecision(a.precision)) !== a.precision && console.warn("THREE.WebGLProgram.getParameters:", a.precision, "not supported, using", d, "instead."),
            T) {
                var E = ShaderLib[T];
                _ = E.vertexShader,
                b = E.fragmentShader
            } else
                _ = a.vertexShader,
                b = a.fragmentShader;
            var M = e.getRenderTarget()
              , P = a.alphaTest > 0
              , C = a.clearcoat > 0;
            return {
                isWebGL2: l,
                shaderID: T,
                shaderName: a.type,
                vertexShader: _,
                fragmentShader: b,
                defines: a.defines,
                isRawShaderMaterial: !0 === a.isRawShaderMaterial,
                glslVersion: a.glslVersion,
                precision: d,
                instancing: !0 === y.isInstancedMesh,
                instancingColor: !0 === y.isInstancedMesh && null !== y.instanceColor,
                supportsVertexTextures: u,
                outputEncoding: null !== M ? g(M.texture) : e.outputEncoding,
                map: !!a.map,
                mapEncoding: g(a.map),
                matcap: !!a.matcap,
                matcapEncoding: g(a.matcap),
                envMap: !!S,
                envMapMode: S && S.mapping,
                envMapEncoding: g(S),
                envMapCubeUV: !!S && (S.mapping === CubeUVReflectionMapping || S.mapping === CubeUVRefractionMapping),
                lightMap: !!a.lightMap,
                lightMapEncoding: g(a.lightMap),
                aoMap: !!a.aoMap,
                emissiveMap: !!a.emissiveMap,
                emissiveMapEncoding: g(a.emissiveMap),
                bumpMap: !!a.bumpMap,
                normalMap: !!a.normalMap,
                objectSpaceNormalMap: a.normalMapType === ObjectSpaceNormalMap,
                tangentSpaceNormalMap: a.normalMapType === TangentSpaceNormalMap,
                clearcoat: C,
                clearcoatMap: C && !!a.clearcoatMap,
                clearcoatRoughnessMap: C && !!a.clearcoatRoughnessMap,
                clearcoatNormalMap: C && !!a.clearcoatNormalMap,
                displacementMap: !!a.displacementMap,
                roughnessMap: !!a.roughnessMap,
                metalnessMap: !!a.metalnessMap,
                specularMap: !!a.specularMap,
                specularIntensityMap: !!a.specularIntensityMap,
                specularTintMap: !!a.specularTintMap,
                specularTintMapEncoding: g(a.specularTintMap),
                alphaMap: !!a.alphaMap,
                alphaTest: P,
                gradientMap: !!a.gradientMap,
                sheen: a.sheen > 0,
                transmission: a.transmission > 0,
                transmissionMap: !!a.transmissionMap,
                thicknessMap: !!a.thicknessMap,
                combine: a.combine,
                vertexTangents: !!a.normalMap && !!y.geometry && !!y.geometry.attributes.tangent,
                vertexColors: a.vertexColors,
                vertexAlphas: !0 === a.vertexColors && !!y.geometry && !!y.geometry.attributes.color && 4 === y.geometry.attributes.color.itemSize,
                vertexUvs: !!(a.map || a.bumpMap || a.normalMap || a.specularMap || a.alphaMap || a.emissiveMap || a.roughnessMap || a.metalnessMap || a.clearcoatMap || a.clearcoatRoughnessMap || a.clearcoatNormalMap || a.displacementMap || a.transmissionMap || a.thicknessMap || a.specularIntensityMap || a.specularTintMap),
                uvsVertexOnly: !(a.map || a.bumpMap || a.normalMap || a.specularMap || a.alphaMap || a.emissiveMap || a.roughnessMap || a.metalnessMap || a.clearcoatNormalMap || a.transmission > 0 || a.transmissionMap || a.thicknessMap || a.specularIntensityMap || a.specularTintMap || !a.displacementMap),
                fog: !!x,
                useFog: a.fog,
                fogExp2: x && x.isFogExp2,
                flatShading: !!a.flatShading,
                sizeAttenuation: a.sizeAttenuation,
                logarithmicDepthBuffer: h,
                skinning: !0 === y.isSkinnedMesh && k > 0,
                maxBones: k,
                useVertexTexture: c,
                morphTargets: !!y.geometry && !!y.geometry.morphAttributes.position,
                morphNormals: !!y.geometry && !!y.geometry.morphAttributes.normal,
                morphTargetsCount: y.geometry && y.geometry.morphAttributes.position ? y.geometry.morphAttributes.position.length : 0,
                numDirLights: s.directional.length,
                numPointLights: s.point.length,
                numSpotLights: s.spot.length,
                numRectAreaLights: s.rectArea.length,
                numHemiLights: s.hemi.length,
                numDirLightShadows: s.directionalShadowMap.length,
                numPointLightShadows: s.pointShadowMap.length,
                numSpotLightShadows: s.spotShadowMap.length,
                numClippingPlanes: o.numPlanes,
                numClipIntersection: o.numIntersection,
                format: a.format,
                dithering: a.dithering,
                shadowMapEnabled: e.shadowMap.enabled && m.length > 0,
                shadowMapType: e.shadowMap.type,
                toneMapping: a.toneMapped ? e.toneMapping : NoToneMapping,
                physicallyCorrectLights: e.physicallyCorrectLights,
                premultipliedAlpha: a.premultipliedAlpha,
                doubleSided: a.side === DoubleSide,
                flipSided: a.side === BackSide,
                depthPacking: void 0 !== a.depthPacking && a.depthPacking,
                index0AttributeName: a.index0AttributeName,
                extensionDerivatives: a.extensions && a.extensions.derivatives,
                extensionFragDepth: a.extensions && a.extensions.fragDepth,
                extensionDrawBuffers: a.extensions && a.extensions.drawBuffers,
                extensionShaderTextureLOD: a.extensions && a.extensions.shaderTextureLOD,
                rendererExtensionFragDepth: l || r.has("EXT_frag_depth"),
                rendererExtensionDrawBuffers: l || r.has("WEBGL_draw_buffers"),
                rendererExtensionShaderTextureLod: l || r.has("EXT_shader_texture_lod"),
                customProgramCacheKey: a.customProgramCacheKey()
            }
        },
        getProgramCacheKey: function(t) {
            var i = [];
            if (t.shaderID ? i.push(t.shaderID) : (i.push(t.fragmentShader),
            i.push(t.vertexShader)),
            void 0 !== t.defines)
                for (var r in t.defines)
                    i.push(r),
                    i.push(t.defines[r]);
            if (!1 === t.isRawShaderMaterial) {
                for (var n = 0; n < m.length; n++)
                    i.push(t[m[n]]);
                i.push(e.outputEncoding),
                i.push(e.gammaFactor)
            }
            return i.push(t.customProgramCacheKey),
            i.join()
        },
        getUniforms: function(e) {
            var t, i = f[e.type];
            if (i) {
                var r = ShaderLib[i];
                t = UniformsUtils.clone(r.uniforms)
            } else
                t = e.uniforms;
            return t
        },
        acquireProgram: function(t, i) {
            for (var r, n = 0, o = s.length; n < o; n++) {
                var l = s[n];
                if (l.cacheKey === i) {
                    ++(r = l).usedTimes;
                    break
                }
            }
            return void 0 === r && (r = new WebGLProgram(e,i,t,a),
            s.push(r)),
            r
        },
        releaseProgram: function(e) {
            if (0 == --e.usedTimes) {
                var t = s.indexOf(e);
                s[t] = s[s.length - 1],
                s.pop(),
                e.destroy()
            }
        },
        programs: s
    }
}
function WebGLProperties() {
    var e = new WeakMap;
    return {
        get: function(t) {
            var i = e.get(t);
            return void 0 === i && (i = {},
            e.set(t, i)),
            i
        },
        remove: function(t) {
            e.delete(t)
        },
        update: function(t, i, r) {
            e.get(t)[i] = r
        },
        dispose: function() {
            e = new WeakMap
        }
    }
}
function painterSortStable(e, t) {
    return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.program !== t.program ? e.program.id - t.program.id : e.material.id !== t.material.id ? e.material.id - t.material.id : e.z !== t.z ? e.z - t.z : e.id - t.id
}
function reversePainterSortStable(e, t) {
    return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.z !== t.z ? t.z - e.z : e.id - t.id
}
function WebGLRenderList(e) {
    var t = []
      , i = 0
      , r = []
      , n = []
      , a = []
      , o = {
        id: -1
    };
    function s(r, n, a, s, l, h) {
        var c = t[i]
          , p = e.get(a);
        return void 0 === c ? (c = {
            id: r.id,
            object: r,
            geometry: n,
            material: a,
            program: p.program || o,
            groupOrder: s,
            renderOrder: r.renderOrder,
            z: l,
            group: h
        },
        t[i] = c) : (c.id = r.id,
        c.object = r,
        c.geometry = n,
        c.material = a,
        c.program = p.program || o,
        c.groupOrder = s,
        c.renderOrder = r.renderOrder,
        c.z = l,
        c.group = h),
        i++,
        c
    }
    return {
        opaque: r,
        transmissive: n,
        transparent: a,
        init: function() {
            i = 0,
            r.length = 0,
            n.length = 0,
            a.length = 0
        },
        push: function(e, t, i, o, l, h) {
            var c = s(e, t, i, o, l, h);
            i.transmission > 0 ? n.push(c) : !0 === i.transparent ? a.push(c) : r.push(c)
        },
        unshift: function(e, t, i, o, l, h) {
            var c = s(e, t, i, o, l, h);
            i.transmission > 0 ? n.unshift(c) : !0 === i.transparent ? a.unshift(c) : r.unshift(c)
        },
        finish: function() {
            for (var e = i, r = t.length; e < r; e++) {
                var n = t[e];
                if (null === n.id)
                    break;
                n.id = null,
                n.object = null,
                n.geometry = null,
                n.material = null,
                n.program = null,
                n.group = null
            }
        },
        sort: function(e, t) {
            r.length > 1 && r.sort(e || painterSortStable),
            n.length > 1 && n.sort(t || reversePainterSortStable),
            a.length > 1 && a.sort(t || reversePainterSortStable)
        }
    }
}
function WebGLRenderLists(e) {
    var t = new WeakMap;
    return {
        get: function(i, r) {
            var n;
            return !1 === t.has(i) ? (n = new WebGLRenderList(e),
            t.set(i, [n])) : r >= t.get(i).length ? (n = new WebGLRenderList(e),
            t.get(i).push(n)) : n = t.get(i)[r],
            n
        },
        dispose: function() {
            t = new WeakMap
        }
    }
}
function UniformsCache() {
    var e = {};
    return {
        get: function(t) {
            if (void 0 !== e[t.id])
                return e[t.id];
            var i;
            switch (t.type) {
            case "DirectionalLight":
                i = {
                    direction: new Vector3,
                    color: new Color
                };
                break;
            case "SpotLight":
                i = {
                    position: new Vector3,
                    direction: new Vector3,
                    color: new Color,
                    distance: 0,
                    coneCos: 0,
                    penumbraCos: 0,
                    decay: 0
                };
                break;
            case "PointLight":
                i = {
                    position: new Vector3,
                    color: new Color,
                    distance: 0,
                    decay: 0
                };
                break;
            case "HemisphereLight":
                i = {
                    direction: new Vector3,
                    skyColor: new Color,
                    groundColor: new Color
                };
                break;
            case "RectAreaLight":
                i = {
                    color: new Color,
                    position: new Vector3,
                    halfWidth: new Vector3,
                    halfHeight: new Vector3
                }
            }
            return e[t.id] = i,
            i
        }
    }
}
function ShadowUniformsCache() {
    var e = {};
    return {
        get: function(t) {
            if (void 0 !== e[t.id])
                return e[t.id];
            var i;
            switch (t.type) {
            case "DirectionalLight":
            case "SpotLight":
                i = {
                    shadowBias: 0,
                    shadowNormalBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new Vector2
                };
                break;
            case "PointLight":
                i = {
                    shadowBias: 0,
                    shadowNormalBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new Vector2,
                    shadowCameraNear: 1,
                    shadowCameraFar: 1e3
                }
            }
            return e[t.id] = i,
            i
        }
    }
}
var nextVersion = 0;
function shadowCastingLightsFirst(e, t) {
    return (t.castShadow ? 1 : 0) - (e.castShadow ? 1 : 0)
}
function WebGLLights(e, t) {
    for (var i = new UniformsCache, r = ShadowUniformsCache(), n = {
        version: 0,
        hash: {
            directionalLength: -1,
            pointLength: -1,
            spotLength: -1,
            rectAreaLength: -1,
            hemiLength: -1,
            numDirectionalShadows: -1,
            numPointShadows: -1,
            numSpotShadows: -1
        },
        ambient: [0, 0, 0],
        probe: [],
        directional: [],
        directionalShadow: [],
        directionalShadowMap: [],
        directionalShadowMatrix: [],
        spot: [],
        spotShadow: [],
        spotShadowMap: [],
        spotShadowMatrix: [],
        rectArea: [],
        rectAreaLTC1: null,
        rectAreaLTC2: null,
        point: [],
        pointShadow: [],
        pointShadowMap: [],
        pointShadowMatrix: [],
        hemi: []
    }, a = 0; a < 9; a++)
        n.probe.push(new Vector3);
    var o = new Vector3
      , s = new Matrix4
      , l = new Matrix4;
    return {
        setup: function(a, o) {
            for (var s = 0, l = 0, h = 0, c = 0; c < 9; c++)
                n.probe[c].set(0, 0, 0);
            var p = 0
              , u = 0
              , d = 0
              , f = 0
              , m = 0
              , g = 0
              , v = 0
              , y = 0;
            a.sort(shadowCastingLightsFirst);
            for (var _ = !0 !== o ? Math.PI : 1, b = 0, x = a.length; b < x; b++) {
                var w = a[b]
                  , S = w.color
                  , T = w.intensity
                  , k = w.distance
                  , E = w.shadow && w.shadow.map ? w.shadow.map.texture : null;
                if (w.isAmbientLight)
                    s += S.r * T * _,
                    l += S.g * T * _,
                    h += S.b * T * _;
                else if (w.isLightProbe)
                    for (var M = 0; M < 9; M++)
                        n.probe[M].addScaledVector(w.sh.coefficients[M], T);
                else if (w.isDirectionalLight) {
                    var P = i.get(w);
                    if (P.color.copy(w.color).multiplyScalar(w.intensity * _),
                    w.castShadow) {
                        var C = w.shadow
                          , A = r.get(w);
                        A.shadowBias = C.bias,
                        A.shadowNormalBias = C.normalBias,
                        A.shadowRadius = C.radius,
                        A.shadowMapSize = C.mapSize,
                        n.directionalShadow[p] = A,
                        n.directionalShadowMap[p] = E,
                        n.directionalShadowMatrix[p] = w.shadow.matrix,
                        g++
                    }
                    n.directional[p] = P,
                    p++
                } else if (w.isSpotLight) {
                    var L = i.get(w);
                    if (L.position.setFromMatrixPosition(w.matrixWorld),
                    L.color.copy(S).multiplyScalar(T * _),
                    L.distance = k,
                    L.coneCos = Math.cos(w.angle),
                    L.penumbraCos = Math.cos(w.angle * (1 - w.penumbra)),
                    L.decay = w.decay,
                    w.castShadow) {
                        var D = w.shadow
                          , I = r.get(w);
                        I.shadowBias = D.bias,
                        I.shadowNormalBias = D.normalBias,
                        I.shadowRadius = D.radius,
                        I.shadowMapSize = D.mapSize,
                        n.spotShadow[d] = I,
                        n.spotShadowMap[d] = E,
                        n.spotShadowMatrix[d] = w.shadow.matrix,
                        y++
                    }
                    n.spot[d] = L,
                    d++
                } else if (w.isRectAreaLight) {
                    var R = i.get(w);
                    R.color.copy(S).multiplyScalar(T),
                    R.halfWidth.set(.5 * w.width, 0, 0),
                    R.halfHeight.set(0, .5 * w.height, 0),
                    n.rectArea[f] = R,
                    f++
                } else if (w.isPointLight) {
                    var F = i.get(w);
                    if (F.color.copy(w.color).multiplyScalar(w.intensity * _),
                    F.distance = w.distance,
                    F.decay = w.decay,
                    w.castShadow) {
                        var B = w.shadow
                          , O = r.get(w);
                        O.shadowBias = B.bias,
                        O.shadowNormalBias = B.normalBias,
                        O.shadowRadius = B.radius,
                        O.shadowMapSize = B.mapSize,
                        O.shadowCameraNear = B.camera.near,
                        O.shadowCameraFar = B.camera.far,
                        n.pointShadow[u] = O,
                        n.pointShadowMap[u] = E,
                        n.pointShadowMatrix[u] = w.shadow.matrix,
                        v++
                    }
                    n.point[u] = F,
                    u++
                } else if (w.isHemisphereLight) {
                    var N = i.get(w);
                    N.skyColor.copy(w.color).multiplyScalar(T * _),
                    N.groundColor.copy(w.groundColor).multiplyScalar(T * _),
                    n.hemi[m] = N,
                    m++
                }
            }
            f > 0 && (t.isWebGL2 || !0 === e.has("OES_texture_float_linear") ? (n.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1,
            n.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2) : !0 === e.has("OES_texture_half_float_linear") ? (n.rectAreaLTC1 = UniformsLib.LTC_HALF_1,
            n.rectAreaLTC2 = UniformsLib.LTC_HALF_2) : console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),
            n.ambient[0] = s,
            n.ambient[1] = l,
            n.ambient[2] = h;
            var V = n.hash;
            V.directionalLength === p && V.pointLength === u && V.spotLength === d && V.rectAreaLength === f && V.hemiLength === m && V.numDirectionalShadows === g && V.numPointShadows === v && V.numSpotShadows === y || (n.directional.length = p,
            n.spot.length = d,
            n.rectArea.length = f,
            n.point.length = u,
            n.hemi.length = m,
            n.directionalShadow.length = g,
            n.directionalShadowMap.length = g,
            n.pointShadow.length = v,
            n.pointShadowMap.length = v,
            n.spotShadow.length = y,
            n.spotShadowMap.length = y,
            n.directionalShadowMatrix.length = g,
            n.pointShadowMatrix.length = v,
            n.spotShadowMatrix.length = y,
            V.directionalLength = p,
            V.pointLength = u,
            V.spotLength = d,
            V.rectAreaLength = f,
            V.hemiLength = m,
            V.numDirectionalShadows = g,
            V.numPointShadows = v,
            V.numSpotShadows = y,
            n.version = nextVersion++)
        },
        setupView: function(e, t) {
            for (var i = 0, r = 0, a = 0, h = 0, c = 0, p = t.matrixWorldInverse, u = 0, d = e.length; u < d; u++) {
                var f = e[u];
                if (f.isDirectionalLight) {
                    var m = n.directional[i];
                    m.direction.setFromMatrixPosition(f.matrixWorld),
                    o.setFromMatrixPosition(f.target.matrixWorld),
                    m.direction.sub(o),
                    m.direction.transformDirection(p),
                    i++
                } else if (f.isSpotLight) {
                    var g = n.spot[a];
                    g.position.setFromMatrixPosition(f.matrixWorld),
                    g.position.applyMatrix4(p),
                    g.direction.setFromMatrixPosition(f.matrixWorld),
                    o.setFromMatrixPosition(f.target.matrixWorld),
                    g.direction.sub(o),
                    g.direction.transformDirection(p),
                    a++
                } else if (f.isRectAreaLight) {
                    var v = n.rectArea[h];
                    v.position.setFromMatrixPosition(f.matrixWorld),
                    v.position.applyMatrix4(p),
                    l.identity(),
                    s.copy(f.matrixWorld),
                    s.premultiply(p),
                    l.extractRotation(s),
                    v.halfWidth.set(.5 * f.width, 0, 0),
                    v.halfHeight.set(0, .5 * f.height, 0),
                    v.halfWidth.applyMatrix4(l),
                    v.halfHeight.applyMatrix4(l),
                    h++
                } else if (f.isPointLight) {
                    var y = n.point[r];
                    y.position.setFromMatrixPosition(f.matrixWorld),
                    y.position.applyMatrix4(p),
                    r++
                } else if (f.isHemisphereLight) {
                    var _ = n.hemi[c];
                    _.direction.setFromMatrixPosition(f.matrixWorld),
                    _.direction.transformDirection(p),
                    _.direction.normalize(),
                    c++
                }
            }
        },
        state: n
    }
}
function WebGLRenderState(e, t) {
    var i = new WebGLLights(e,t)
      , r = []
      , n = [];
    return {
        init: function() {
            r.length = 0,
            n.length = 0
        },
        state: {
            lightsArray: r,
            shadowsArray: n,
            lights: i
        },
        setupLights: function(e) {
            i.setup(r, e)
        },
        setupLightsView: function(e) {
            i.setupView(r, e)
        },
        pushLight: function(e) {
            r.push(e)
        },
        pushShadow: function(e) {
            n.push(e)
        }
    }
}
function WebGLRenderStates(e, t) {
    var i = new WeakMap;
    return {
        get: function(r) {
            var n, a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return !1 === i.has(r) ? (n = new WebGLRenderState(e,t),
            i.set(r, [n])) : a >= i.get(r).length ? (n = new WebGLRenderState(e,t),
            i.get(r).push(n)) : n = i.get(r)[a],
            n
        },
        dispose: function() {
            i = new WeakMap
        }
    }
}
var MeshDepthMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshDepthMaterial",
        r.depthPacking = BasicDepthPacking,
        r.map = null,
        r.alphaMap = null,
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.fog = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.depthPacking = e.depthPacking,
            this.map = e.map,
            this.alphaMap = e.alphaMap,
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this
        }
    }]),
    i
}();
MeshDepthMaterial.prototype.isMeshDepthMaterial = !0;
var MeshDistanceMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshDistanceMaterial",
        r.referencePosition = new Vector3,
        r.nearDistance = 1,
        r.farDistance = 1e3,
        r.map = null,
        r.alphaMap = null,
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.fog = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.referencePosition.copy(e.referencePosition),
            this.nearDistance = e.nearDistance,
            this.farDistance = e.farDistance,
            this.map = e.map,
            this.alphaMap = e.alphaMap,
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this
        }
    }]),
    i
}();
MeshDistanceMaterial.prototype.isMeshDistanceMaterial = !0;
var vertex = "void main() {\n\tgl_Position = vec4( position, 1.0 );\n}"
  , fragment = "uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";
function WebGLShadowMap(e, t, i) {
    var r = new Frustum
      , n = new Vector2
      , a = new Vector2
      , o = new Vector4
      , s = new MeshDepthMaterial({
        depthPacking: RGBADepthPacking
    })
      , l = new MeshDistanceMaterial
      , h = {}
      , c = i.maxTextureSize
      , p = {
        0: BackSide,
        1: FrontSide,
        2: DoubleSide
    }
      , u = new ShaderMaterial({
        uniforms: {
            shadow_pass: {
                value: null
            },
            resolution: {
                value: new Vector2
            },
            radius: {
                value: 4
            },
            samples: {
                value: 8
            }
        },
        vertexShader: vertex,
        fragmentShader: fragment
    })
      , d = u.clone();
    d.defines.HORIZONTAL_PASS = 1;
    var f = new BufferGeometry;
    f.setAttribute("position", new BufferAttribute(new Float32Array([-1, -1, .5, 3, -1, .5, -1, 3, .5]),3));
    var m = new Mesh(f,u)
      , g = this;
    function v(i, r) {
        var n = t.update(m);
        u.uniforms.shadow_pass.value = i.map.texture,
        u.uniforms.resolution.value = i.mapSize,
        u.uniforms.radius.value = i.radius,
        u.uniforms.samples.value = i.blurSamples,
        e.setRenderTarget(i.mapPass),
        e.clear(),
        e.renderBufferDirect(r, null, n, u, m, null),
        d.uniforms.shadow_pass.value = i.mapPass.texture,
        d.uniforms.resolution.value = i.mapSize,
        d.uniforms.radius.value = i.radius,
        d.uniforms.samples.value = i.blurSamples,
        e.setRenderTarget(i.map),
        e.clear(),
        e.renderBufferDirect(r, null, n, d, m, null)
    }
    function y(t, i, r, n, a, o, c) {
        var u = null
          , d = !0 === n.isPointLight ? t.customDistanceMaterial : t.customDepthMaterial;
        if (u = void 0 !== d ? d : !0 === n.isPointLight ? l : s,
        e.localClippingEnabled && !0 === r.clipShadows && 0 !== r.clippingPlanes.length || r.displacementMap && 0 !== r.displacementScale || r.alphaMap && r.alphaTest > 0) {
            var f = u.uuid
              , m = r.uuid
              , g = h[f];
            void 0 === g && (g = {},
            h[f] = g);
            var v = g[m];
            void 0 === v && (v = u.clone(),
            g[m] = v),
            u = v
        }
        return u.visible = r.visible,
        u.wireframe = r.wireframe,
        u.side = c === VSMShadowMap ? null !== r.shadowSide ? r.shadowSide : r.side : null !== r.shadowSide ? r.shadowSide : p[r.side],
        u.alphaMap = r.alphaMap,
        u.alphaTest = r.alphaTest,
        u.clipShadows = r.clipShadows,
        u.clippingPlanes = r.clippingPlanes,
        u.clipIntersection = r.clipIntersection,
        u.displacementMap = r.displacementMap,
        u.displacementScale = r.displacementScale,
        u.displacementBias = r.displacementBias,
        u.wireframeLinewidth = r.wireframeLinewidth,
        u.linewidth = r.linewidth,
        !0 === n.isPointLight && !0 === u.isMeshDistanceMaterial && (u.referencePosition.setFromMatrixPosition(n.matrixWorld),
        u.nearDistance = a,
        u.farDistance = o),
        u
    }
    function _(i, n, a, o, s) {
        if (!1 !== i.visible) {
            if (i.layers.test(n.layers) && (i.isMesh || i.isLine || i.isPoints) && (i.castShadow || i.receiveShadow && s === VSMShadowMap) && (!i.frustumCulled || r.intersectsObject(i))) {
                i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse, i.matrixWorld);
                var l = t.update(i)
                  , h = i.material;
                if (Array.isArray(h))
                    for (var c = l.groups, p = 0, u = c.length; p < u; p++) {
                        var d = c[p]
                          , f = h[d.materialIndex];
                        if (f && f.visible) {
                            var m = y(i, 0, f, o, a.near, a.far, s);
                            e.renderBufferDirect(a, null, l, m, i, d)
                        }
                    }
                else if (h.visible) {
                    var g = y(i, 0, h, o, a.near, a.far, s);
                    e.renderBufferDirect(a, null, l, g, i, null)
                }
            }
            for (var v = i.children, b = 0, x = v.length; b < x; b++)
                _(v[b], n, a, o, s)
        }
    }
    this.enabled = !1,
    this.autoUpdate = !0,
    this.needsUpdate = !1,
    this.type = PCFShadowMap,
    this.render = function(t, i, s) {
        if (!1 !== g.enabled && (!1 !== g.autoUpdate || !1 !== g.needsUpdate) && 0 !== t.length) {
            var l = e.getRenderTarget()
              , h = e.getActiveCubeFace()
              , p = e.getActiveMipmapLevel()
              , u = e.state;
            u.setBlending(NoBlending),
            u.buffers.color.setClear(1, 1, 1, 1),
            u.buffers.depth.setTest(!0),
            u.setScissorTest(!1);
            for (var d = 0, f = t.length; d < f; d++) {
                var m = t[d]
                  , y = m.shadow;
                if (void 0 !== y) {
                    if (!1 !== y.autoUpdate || !1 !== y.needsUpdate) {
                        n.copy(y.mapSize);
                        var b = y.getFrameExtents();
                        if (n.multiply(b),
                        a.copy(y.mapSize),
                        (n.x > c || n.y > c) && (n.x > c && (a.x = Math.floor(c / b.x),
                        n.x = a.x * b.x,
                        y.mapSize.x = a.x),
                        n.y > c && (a.y = Math.floor(c / b.y),
                        n.y = a.y * b.y,
                        y.mapSize.y = a.y)),
                        null === y.map && !y.isPointLightShadow && this.type === VSMShadowMap) {
                            var x = {
                                minFilter: LinearFilter,
                                magFilter: LinearFilter,
                                format: RGBAFormat
                            };
                            y.map = new WebGLRenderTarget(n.x,n.y,x),
                            y.map.texture.name = m.name + ".shadowMap",
                            y.mapPass = new WebGLRenderTarget(n.x,n.y,x),
                            y.camera.updateProjectionMatrix()
                        }
                        if (null === y.map) {
                            var w = {
                                minFilter: NearestFilter,
                                magFilter: NearestFilter,
                                format: RGBAFormat
                            };
                            y.map = new WebGLRenderTarget(n.x,n.y,w),
                            y.map.texture.name = m.name + ".shadowMap",
                            y.camera.updateProjectionMatrix()
                        }
                        e.setRenderTarget(y.map),
                        e.clear();
                        for (var S = y.getViewportCount(), T = 0; T < S; T++) {
                            var k = y.getViewport(T);
                            o.set(a.x * k.x, a.y * k.y, a.x * k.z, a.y * k.w),
                            u.viewport(o),
                            y.updateMatrices(m, T),
                            r = y.getFrustum(),
                            _(i, s, y.camera, m, this.type)
                        }
                        y.isPointLightShadow || this.type !== VSMShadowMap || v(y, s),
                        y.needsUpdate = !1
                    }
                } else
                    console.warn("THREE.WebGLShadowMap:", m, "has no shadow.")
            }
            g.needsUpdate = !1,
            e.setRenderTarget(l, h, p)
        }
    }
}
function WebGLState(e, t, i) {
    var r, n, a = i.isWebGL2, o = new function() {
        var t = !1
          , i = new Vector4
          , r = null
          , n = new Vector4(0,0,0,0);
        return {
            setMask: function(i) {
                r === i || t || (e.colorMask(i, i, i, i),
                r = i)
            },
            setLocked: function(e) {
                t = e
            },
            setClear: function(t, r, a, o, s) {
                !0 === s && (t *= o,
                r *= o,
                a *= o),
                i.set(t, r, a, o),
                !1 === n.equals(i) && (e.clearColor(t, r, a, o),
                n.copy(i))
            },
            reset: function() {
                t = !1,
                r = null,
                n.set(-1, 0, 0, 0)
            }
        }
    }
    , s = new function() {
        var t = !1
          , i = null
          , r = null
          , n = null;
        return {
            setTest: function(e) {
                e ? V(2929) : z(2929)
            },
            setMask: function(r) {
                i === r || t || (e.depthMask(r),
                i = r)
            },
            setFunc: function(t) {
                if (r !== t) {
                    if (t)
                        switch (t) {
                        case NeverDepth:
                            e.depthFunc(512);
                            break;
                        case AlwaysDepth:
                            e.depthFunc(519);
                            break;
                        case LessDepth:
                            e.depthFunc(513);
                            break;
                        case LessEqualDepth:
                            e.depthFunc(515);
                            break;
                        case EqualDepth:
                            e.depthFunc(514);
                            break;
                        case GreaterEqualDepth:
                            e.depthFunc(518);
                            break;
                        case GreaterDepth:
                            e.depthFunc(516);
                            break;
                        case NotEqualDepth:
                            e.depthFunc(517);
                            break;
                        default:
                            e.depthFunc(515)
                        }
                    else
                        e.depthFunc(515);
                    r = t
                }
            },
            setLocked: function(e) {
                t = e
            },
            setClear: function(t) {
                n !== t && (e.clearDepth(t),
                n = t)
            },
            reset: function() {
                t = !1,
                i = null,
                r = null,
                n = null
            }
        }
    }
    , l = new function() {
        var t = !1
          , i = null
          , r = null
          , n = null
          , a = null
          , o = null
          , s = null
          , l = null
          , h = null;
        return {
            setTest: function(e) {
                t || (e ? V(2960) : z(2960))
            },
            setMask: function(r) {
                i === r || t || (e.stencilMask(r),
                i = r)
            },
            setFunc: function(t, i, o) {
                r === t && n === i && a === o || (e.stencilFunc(t, i, o),
                r = t,
                n = i,
                a = o)
            },
            setOp: function(t, i, r) {
                o === t && s === i && l === r || (e.stencilOp(t, i, r),
                o = t,
                s = i,
                l = r)
            },
            setLocked: function(e) {
                t = e
            },
            setClear: function(t) {
                h !== t && (e.clearStencil(t),
                h = t)
            },
            reset: function() {
                t = !1,
                i = null,
                r = null,
                n = null,
                a = null,
                o = null,
                s = null,
                l = null,
                h = null
            }
        }
    }
    , h = {}, c = null, p = {}, u = null, d = !1, f = null, m = null, g = null, v = null, y = null, _ = null, b = null, x = !1, w = null, S = null, T = null, k = null, E = null, M = e.getParameter(35661), P = !1, C = 0, A = e.getParameter(7938);
    -1 !== A.indexOf("WebGL") ? (C = parseFloat(/^WebGL (\d)/.exec(A)[1]),
    P = C >= 1) : -1 !== A.indexOf("OpenGL ES") && (C = parseFloat(/^OpenGL ES (\d)/.exec(A)[1]),
    P = C >= 2);
    var L = null
      , D = {}
      , I = e.getParameter(3088)
      , R = e.getParameter(2978)
      , F = (new Vector4).fromArray(I)
      , B = (new Vector4).fromArray(R);
    function O(t, i, r) {
        var n = new Uint8Array(4)
          , a = e.createTexture();
        e.bindTexture(t, a),
        e.texParameteri(t, 10241, 9728),
        e.texParameteri(t, 10240, 9728);
        for (var o = 0; o < r; o++)
            e.texImage2D(i + o, 0, 6408, 1, 1, 0, 6408, 5121, n);
        return a
    }
    var N = {};
    function V(t) {
        !0 !== h[t] && (e.enable(t),
        h[t] = !0)
    }
    function z(t) {
        !1 !== h[t] && (e.disable(t),
        h[t] = !1)
    }
    N[3553] = O(3553, 3553, 1),
    N[34067] = O(34067, 34069, 6),
    o.setClear(0, 0, 0, 1),
    s.setClear(1),
    l.setClear(0),
    V(2929),
    s.setFunc(LessEqualDepth),
    j(!1),
    $(CullFaceBack),
    V(2884),
    W(NoBlending);
    var G = (_defineProperty2(r = {}, AddEquation, 32774),
    _defineProperty2(r, SubtractEquation, 32778),
    _defineProperty2(r, ReverseSubtractEquation, 32779),
    r);
    if (a)
        G[MinEquation] = 32775,
        G[MaxEquation] = 32776;
    else {
        var H = t.get("EXT_blend_minmax");
        null !== H && (G[MinEquation] = H.MIN_EXT,
        G[MaxEquation] = H.MAX_EXT)
    }
    var U = (_defineProperty2(n = {}, ZeroFactor, 0),
    _defineProperty2(n, OneFactor, 1),
    _defineProperty2(n, SrcColorFactor, 768),
    _defineProperty2(n, SrcAlphaFactor, 770),
    _defineProperty2(n, SrcAlphaSaturateFactor, 776),
    _defineProperty2(n, DstColorFactor, 774),
    _defineProperty2(n, DstAlphaFactor, 772),
    _defineProperty2(n, OneMinusSrcColorFactor, 769),
    _defineProperty2(n, OneMinusSrcAlphaFactor, 771),
    _defineProperty2(n, OneMinusDstColorFactor, 775),
    _defineProperty2(n, OneMinusDstAlphaFactor, 773),
    n);
    function W(t, i, r, n, a, o, s, l) {
        if (t !== NoBlending) {
            if (!1 === d && (V(3042),
            d = !0),
            t === CustomBlending)
                a = a || i,
                o = o || r,
                s = s || n,
                i === m && a === y || (e.blendEquationSeparate(G[i], G[a]),
                m = i,
                y = a),
                r === g && n === v && o === _ && s === b || (e.blendFuncSeparate(U[r], U[n], U[o], U[s]),
                g = r,
                v = n,
                _ = o,
                b = s),
                f = t,
                x = null;
            else if (t !== f || l !== x) {
                if (m === AddEquation && y === AddEquation || (e.blendEquation(32774),
                m = AddEquation,
                y = AddEquation),
                l)
                    switch (t) {
                    case NormalBlending:
                        e.blendFuncSeparate(1, 771, 1, 771);
                        break;
                    case AdditiveBlending:
                        e.blendFunc(1, 1);
                        break;
                    case SubtractiveBlending:
                        e.blendFuncSeparate(0, 0, 769, 771);
                        break;
                    case MultiplyBlending:
                        e.blendFuncSeparate(0, 768, 0, 770);
                        break;
                    default:
                        console.error("THREE.WebGLState: Invalid blending: ", t)
                    }
                else
                    switch (t) {
                    case NormalBlending:
                        e.blendFuncSeparate(770, 771, 1, 771);
                        break;
                    case AdditiveBlending:
                        e.blendFunc(770, 1);
                        break;
                    case SubtractiveBlending:
                        e.blendFunc(0, 769);
                        break;
                    case MultiplyBlending:
                        e.blendFunc(0, 768);
                        break;
                    default:
                        console.error("THREE.WebGLState: Invalid blending: ", t)
                    }
                g = null,
                v = null,
                _ = null,
                b = null,
                f = t,
                x = l
            }
        } else
            !0 === d && (z(3042),
            d = !1)
    }
    function j(t) {
        w !== t && (t ? e.frontFace(2304) : e.frontFace(2305),
        w = t)
    }
    function $(t) {
        t !== CullFaceNone ? (V(2884),
        t !== S && (t === CullFaceBack ? e.cullFace(1029) : t === CullFaceFront ? e.cullFace(1028) : e.cullFace(1032))) : z(2884),
        S = t
    }
    function q(t, i, r) {
        t ? (V(32823),
        k === i && E === r || (e.polygonOffset(i, r),
        k = i,
        E = r)) : z(32823)
    }
    function X(t) {
        void 0 === t && (t = 33984 + M - 1),
        L !== t && (e.activeTexture(t),
        L = t)
    }
    return {
        buffers: {
            color: o,
            depth: s,
            stencil: l
        },
        enable: V,
        disable: z,
        bindFramebuffer: function(t, i) {
            return null === i && null !== c && (i = c),
            p[t] !== i && (e.bindFramebuffer(t, i),
            p[t] = i,
            a && (36009 === t && (p[36160] = i),
            36160 === t && (p[36009] = i)),
            !0)
        },
        bindXRFramebuffer: function(t) {
            t !== c && (e.bindFramebuffer(36160, t),
            c = t)
        },
        useProgram: function(t) {
            return u !== t && (e.useProgram(t),
            u = t,
            !0)
        },
        setBlending: W,
        setMaterial: function(e, t) {
            e.side === DoubleSide ? z(2884) : V(2884);
            var i = e.side === BackSide;
            t && (i = !i),
            j(i),
            e.blending === NormalBlending && !1 === e.transparent ? W(NoBlending) : W(e.blending, e.blendEquation, e.blendSrc, e.blendDst, e.blendEquationAlpha, e.blendSrcAlpha, e.blendDstAlpha, e.premultipliedAlpha),
            s.setFunc(e.depthFunc),
            s.setTest(e.depthTest),
            s.setMask(e.depthWrite),
            o.setMask(e.colorWrite);
            var r = e.stencilWrite;
            l.setTest(r),
            r && (l.setMask(e.stencilWriteMask),
            l.setFunc(e.stencilFunc, e.stencilRef, e.stencilFuncMask),
            l.setOp(e.stencilFail, e.stencilZFail, e.stencilZPass)),
            q(e.polygonOffset, e.polygonOffsetFactor, e.polygonOffsetUnits),
            !0 === e.alphaToCoverage ? V(32926) : z(32926)
        },
        setFlipSided: j,
        setCullFace: $,
        setLineWidth: function(t) {
            t !== T && (P && e.lineWidth(t),
            T = t)
        },
        setPolygonOffset: q,
        setScissorTest: function(e) {
            e ? V(3089) : z(3089)
        },
        activeTexture: X,
        bindTexture: function(t, i) {
            null === L && X();
            var r = D[L];
            void 0 === r && (r = {
                type: void 0,
                texture: void 0
            },
            D[L] = r),
            r.type === t && r.texture === i || (e.bindTexture(t, i || N[t]),
            r.type = t,
            r.texture = i)
        },
        unbindTexture: function() {
            var t = D[L];
            void 0 !== t && void 0 !== t.type && (e.bindTexture(t.type, null),
            t.type = void 0,
            t.texture = void 0)
        },
        compressedTexImage2D: function() {
            try {
                e.compressedTexImage2D.apply(e, arguments)
            } catch (t) {
                console.error("THREE.WebGLState:", t)
            }
        },
        texImage2D: function() {
            try {
                e.texImage2D.apply(e, arguments)
            } catch (t) {
                console.error("THREE.WebGLState:", t)
            }
        },
        texImage3D: function() {
            try {
                e.texImage3D.apply(e, arguments)
            } catch (t) {
                console.error("THREE.WebGLState:", t)
            }
        },
        scissor: function(t) {
            !1 === F.equals(t) && (e.scissor(t.x, t.y, t.z, t.w),
            F.copy(t))
        },
        viewport: function(t) {
            !1 === B.equals(t) && (e.viewport(t.x, t.y, t.z, t.w),
            B.copy(t))
        },
        reset: function() {
            e.disable(3042),
            e.disable(2884),
            e.disable(2929),
            e.disable(32823),
            e.disable(3089),
            e.disable(2960),
            e.disable(32926),
            e.blendEquation(32774),
            e.blendFunc(1, 0),
            e.blendFuncSeparate(1, 0, 1, 0),
            e.colorMask(!0, !0, !0, !0),
            e.clearColor(0, 0, 0, 0),
            e.depthMask(!0),
            e.depthFunc(513),
            e.clearDepth(1),
            e.stencilMask(4294967295),
            e.stencilFunc(519, 0, 4294967295),
            e.stencilOp(7680, 7680, 7680),
            e.clearStencil(0),
            e.cullFace(1029),
            e.frontFace(2305),
            e.polygonOffset(0, 0),
            e.activeTexture(33984),
            e.bindFramebuffer(36160, null),
            !0 === a && (e.bindFramebuffer(36009, null),
            e.bindFramebuffer(36008, null)),
            e.useProgram(null),
            e.lineWidth(1),
            e.scissor(0, 0, e.canvas.width, e.canvas.height),
            e.viewport(0, 0, e.canvas.width, e.canvas.height),
            h = {},
            L = null,
            D = {},
            c = null,
            p = {},
            u = null,
            d = !1,
            f = null,
            m = null,
            g = null,
            v = null,
            y = null,
            _ = null,
            b = null,
            x = !1,
            w = null,
            S = null,
            T = null,
            k = null,
            E = null,
            F.set(0, 0, e.canvas.width, e.canvas.height),
            B.set(0, 0, e.canvas.width, e.canvas.height),
            o.reset(),
            s.reset(),
            l.reset()
        }
    }
}
function WebGLTextures(e, t, i, r, n, a, o) {
    var s, l, h, c = n.isWebGL2, p = n.maxTextures, u = n.maxCubemapSize, d = n.maxTextureSize, f = n.maxSamples, m = new WeakMap, g = !1;
    try {
        g = "undefined" != typeof OffscreenCanvas && null !== new OffscreenCanvas(1,1).getContext("2d")
    } catch (V) {}
    function v(e, t) {
        return g ? new OffscreenCanvas(e,t) : createElementNS("canvas")
    }
    function y(e, t, i, r) {
        var n = 1;
        if ((e.width > r || e.height > r) && (n = r / Math.max(e.width, e.height)),
        n < 1 || !0 === t) {
            if ("undefined" != typeof HTMLImageElement && e instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && e instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && e instanceof ImageBitmap) {
                var a = t ? floorPowerOfTwo : Math.floor
                  , o = a(n * e.width)
                  , s = a(n * e.height);
                void 0 === h && (h = v(o, s));
                var l = i ? v(o, s) : h;
                return l.width = o,
                l.height = s,
                l.getContext("2d").drawImage(e, 0, 0, o, s),
                console.warn("THREE.WebGLRenderer: Texture has been resized from (" + e.width + "x" + e.height + ") to (" + o + "x" + s + ")."),
                l
            }
            return "data"in e && console.warn("THREE.WebGLRenderer: Image in DataTexture is too big (" + e.width + "x" + e.height + ")."),
            e
        }
        return e
    }
    function _(e) {
        return isPowerOfTwo(e.width) && isPowerOfTwo(e.height)
    }
    function b(e, t) {
        return e.generateMipmaps && t && e.minFilter !== NearestFilter && e.minFilter !== LinearFilter
    }
    function x(t, i, n, a) {
        var o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1;
        e.generateMipmap(t);
        var s = r.get(i);
        s.__maxMipLevel = Math.log2(Math.max(n, a, o))
    }
    function w(i, r, n, a) {
        if (!1 === c)
            return r;
        if (null !== i) {
            if (void 0 !== e[i])
                return e[i];
            console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '" + i + "'")
        }
        var o = r;
        return 6403 === r && (5126 === n && (o = 33326),
        5131 === n && (o = 33325),
        5121 === n && (o = 33321)),
        6407 === r && (5126 === n && (o = 34837),
        5131 === n && (o = 34843),
        5121 === n && (o = 32849)),
        6408 === r && (5126 === n && (o = 34836),
        5131 === n && (o = 34842),
        5121 === n && (o = a === sRGBEncoding ? 35907 : 32856)),
        33325 !== o && 33326 !== o && 34842 !== o && 34836 !== o || t.get("EXT_color_buffer_float"),
        o
    }
    function S(e) {
        return e === NearestFilter || e === NearestMipmapNearestFilter || e === NearestMipmapLinearFilter ? 9728 : 9729
    }
    function T(t) {
        var i = t.target;
        i.removeEventListener("dispose", T),
        function(t) {
            var i = r.get(t);
            void 0 !== i.__webglInit && (e.deleteTexture(i.__webglTexture),
            r.remove(t))
        }(i),
        i.isVideoTexture && m.delete(i),
        o.memory.textures--
    }
    function k(t) {
        var i = t.target;
        i.removeEventListener("dispose", k),
        function(t) {
            var i = t.texture
              , n = r.get(t)
              , a = r.get(i);
            if (t) {
                if (void 0 !== a.__webglTexture && (e.deleteTexture(a.__webglTexture),
                o.memory.textures--),
                t.depthTexture && t.depthTexture.dispose(),
                t.isWebGLCubeRenderTarget)
                    for (var s = 0; s < 6; s++)
                        e.deleteFramebuffer(n.__webglFramebuffer[s]),
                        n.__webglDepthbuffer && e.deleteRenderbuffer(n.__webglDepthbuffer[s]);
                else
                    e.deleteFramebuffer(n.__webglFramebuffer),
                    n.__webglDepthbuffer && e.deleteRenderbuffer(n.__webglDepthbuffer),
                    n.__webglMultisampledFramebuffer && e.deleteFramebuffer(n.__webglMultisampledFramebuffer),
                    n.__webglColorRenderbuffer && e.deleteRenderbuffer(n.__webglColorRenderbuffer),
                    n.__webglDepthRenderbuffer && e.deleteRenderbuffer(n.__webglDepthRenderbuffer);
                if (t.isWebGLMultipleRenderTargets)
                    for (var l = 0, h = i.length; l < h; l++) {
                        var c = r.get(i[l]);
                        c.__webglTexture && (e.deleteTexture(c.__webglTexture),
                        o.memory.textures--),
                        r.remove(i[l])
                    }
                r.remove(i),
                r.remove(t)
            }
        }(i)
    }
    var E = 0;
    function M(e, t) {
        var n = r.get(e);
        if (e.isVideoTexture && function(e) {
            var t = o.render.frame;
            m.get(e) !== t && (m.set(e, t),
            e.update())
        }(e),
        e.version > 0 && n.__version !== e.version) {
            var a = e.image;
            if (void 0 === a)
                console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");
            else {
                if (!1 !== a.complete)
                    return void I(n, e, t);
                console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")
            }
        }
        i.activeTexture(33984 + t),
        i.bindTexture(3553, n.__webglTexture)
    }
    function P(t, n) {
        var o = r.get(t);
        t.version > 0 && o.__version !== t.version ? function(t, r, n) {
            if (6 === r.image.length) {
                D(t, r),
                i.activeTexture(33984 + n),
                i.bindTexture(34067, t.__webglTexture),
                e.pixelStorei(37440, r.flipY),
                e.pixelStorei(37441, r.premultiplyAlpha),
                e.pixelStorei(3317, r.unpackAlignment),
                e.pixelStorei(37443, 0);
                for (var o = r && (r.isCompressedTexture || r.image[0].isCompressedTexture), s = r.image[0] && r.image[0].isDataTexture, l = [], h = 0; h < 6; h++)
                    l[h] = o || s ? s ? r.image[h].image : r.image[h] : y(r.image[h], !1, !0, u);
                var p, d = l[0], f = _(d) || c, m = a.convert(r.format), g = a.convert(r.type), v = w(r.internalFormat, m, g, r.encoding);
                if (L(34067, r, f),
                o) {
                    for (var S = 0; S < 6; S++) {
                        p = l[S].mipmaps;
                        for (var T = 0; T < p.length; T++) {
                            var k = p[T];
                            r.format !== RGBAFormat && r.format !== RGBFormat ? null !== m ? i.compressedTexImage2D(34069 + S, T, v, k.width, k.height, 0, k.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : i.texImage2D(34069 + S, T, v, k.width, k.height, 0, m, g, k.data)
                        }
                    }
                    t.__maxMipLevel = p.length - 1
                } else {
                    p = r.mipmaps;
                    for (var E = 0; E < 6; E++)
                        if (s) {
                            i.texImage2D(34069 + E, 0, v, l[E].width, l[E].height, 0, m, g, l[E].data);
                            for (var M = 0; M < p.length; M++) {
                                var P = p[M].image[E].image;
                                i.texImage2D(34069 + E, M + 1, v, P.width, P.height, 0, m, g, P.data)
                            }
                        } else {
                            i.texImage2D(34069 + E, 0, v, m, g, l[E]);
                            for (var C = 0; C < p.length; C++) {
                                var A = p[C];
                                i.texImage2D(34069 + E, C + 1, v, m, g, A.image[E])
                            }
                        }
                    t.__maxMipLevel = p.length
                }
                b(r, f) && x(34067, r, d.width, d.height),
                t.__version = r.version,
                r.onUpdate && r.onUpdate(r)
            }
        }(o, t, n) : (i.activeTexture(33984 + n),
        i.bindTexture(34067, o.__webglTexture))
    }
    var C = (_defineProperty2(s = {}, RepeatWrapping, 10497),
    _defineProperty2(s, ClampToEdgeWrapping, 33071),
    _defineProperty2(s, MirroredRepeatWrapping, 33648),
    s)
      , A = (_defineProperty2(l = {}, NearestFilter, 9728),
    _defineProperty2(l, NearestMipmapNearestFilter, 9984),
    _defineProperty2(l, NearestMipmapLinearFilter, 9986),
    _defineProperty2(l, LinearFilter, 9729),
    _defineProperty2(l, LinearMipmapNearestFilter, 9985),
    _defineProperty2(l, LinearMipmapLinearFilter, 9987),
    l);
    function L(i, a, o) {
        if (o ? (e.texParameteri(i, 10242, C[a.wrapS]),
        e.texParameteri(i, 10243, C[a.wrapT]),
        32879 !== i && 35866 !== i || e.texParameteri(i, 32882, C[a.wrapR]),
        e.texParameteri(i, 10240, A[a.magFilter]),
        e.texParameteri(i, 10241, A[a.minFilter])) : (e.texParameteri(i, 10242, 33071),
        e.texParameteri(i, 10243, 33071),
        32879 !== i && 35866 !== i || e.texParameteri(i, 32882, 33071),
        a.wrapS === ClampToEdgeWrapping && a.wrapT === ClampToEdgeWrapping || console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),
        e.texParameteri(i, 10240, S(a.magFilter)),
        e.texParameteri(i, 10241, S(a.minFilter)),
        a.minFilter !== NearestFilter && a.minFilter !== LinearFilter && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),
        !0 === t.has("EXT_texture_filter_anisotropic")) {
            var s = t.get("EXT_texture_filter_anisotropic");
            if (a.type === FloatType && !1 === t.has("OES_texture_float_linear"))
                return;
            if (!1 === c && a.type === HalfFloatType && !1 === t.has("OES_texture_half_float_linear"))
                return;
            (a.anisotropy > 1 || r.get(a).__currentAnisotropy) && (e.texParameterf(i, s.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(a.anisotropy, n.getMaxAnisotropy())),
            r.get(a).__currentAnisotropy = a.anisotropy)
        }
    }
    function D(t, i) {
        void 0 === t.__webglInit && (t.__webglInit = !0,
        i.addEventListener("dispose", T),
        t.__webglTexture = e.createTexture(),
        o.memory.textures++)
    }
    function I(t, r, n) {
        var o = 3553;
        r.isDataTexture2DArray && (o = 35866),
        r.isDataTexture3D && (o = 32879),
        D(t, r),
        i.activeTexture(33984 + n),
        i.bindTexture(o, t.__webglTexture),
        e.pixelStorei(37440, r.flipY),
        e.pixelStorei(37441, r.premultiplyAlpha),
        e.pixelStorei(3317, r.unpackAlignment),
        e.pixelStorei(37443, 0);
        var s, l = function(e) {
            return !c && (e.wrapS !== ClampToEdgeWrapping || e.wrapT !== ClampToEdgeWrapping || e.minFilter !== NearestFilter && e.minFilter !== LinearFilter)
        }(r) && !1 === _(r.image), h = y(r.image, l, !1, d), p = _(h) || c, u = a.convert(r.format), f = a.convert(r.type), m = w(r.internalFormat, u, f, r.encoding);
        L(o, r, p);
        var g = r.mipmaps;
        if (r.isDepthTexture)
            m = 6402,
            c ? m = r.type === FloatType ? 36012 : r.type === UnsignedIntType ? 33190 : r.type === UnsignedInt248Type ? 35056 : 33189 : r.type === FloatType && console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),
            r.format === DepthFormat && 6402 === m && r.type !== UnsignedShortType && r.type !== UnsignedIntType && (console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),
            r.type = UnsignedShortType,
            f = a.convert(r.type)),
            r.format === DepthStencilFormat && 6402 === m && (m = 34041,
            r.type !== UnsignedInt248Type && (console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),
            r.type = UnsignedInt248Type,
            f = a.convert(r.type))),
            i.texImage2D(3553, 0, m, h.width, h.height, 0, u, f, null);
        else if (r.isDataTexture)
            if (g.length > 0 && p) {
                for (var v = 0, S = g.length; v < S; v++)
                    s = g[v],
                    i.texImage2D(3553, v, m, s.width, s.height, 0, u, f, s.data);
                r.generateMipmaps = !1,
                t.__maxMipLevel = g.length - 1
            } else
                i.texImage2D(3553, 0, m, h.width, h.height, 0, u, f, h.data),
                t.__maxMipLevel = 0;
        else if (r.isCompressedTexture) {
            for (var T = 0, k = g.length; T < k; T++)
                s = g[T],
                r.format !== RGBAFormat && r.format !== RGBFormat ? null !== u ? i.compressedTexImage2D(3553, T, m, s.width, s.height, 0, s.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : i.texImage2D(3553, T, m, s.width, s.height, 0, u, f, s.data);
            t.__maxMipLevel = g.length - 1
        } else if (r.isDataTexture2DArray)
            i.texImage3D(35866, 0, m, h.width, h.height, h.depth, 0, u, f, h.data),
            t.__maxMipLevel = 0;
        else if (r.isDataTexture3D)
            i.texImage3D(32879, 0, m, h.width, h.height, h.depth, 0, u, f, h.data),
            t.__maxMipLevel = 0;
        else if (g.length > 0 && p) {
            for (var E = 0, M = g.length; E < M; E++)
                s = g[E],
                i.texImage2D(3553, E, m, u, f, s);
            r.generateMipmaps = !1,
            t.__maxMipLevel = g.length - 1
        } else
            i.texImage2D(3553, 0, m, u, f, h),
            t.__maxMipLevel = 0;
        b(r, p) && x(o, r, h.width, h.height),
        t.__version = r.version,
        r.onUpdate && r.onUpdate(r)
    }
    function R(t, n, o, s, l) {
        var h = a.convert(o.format)
          , c = a.convert(o.type)
          , p = w(o.internalFormat, h, c, o.encoding);
        32879 === l || 35866 === l ? i.texImage3D(l, 0, p, n.width, n.height, n.depth, 0, h, c, null) : i.texImage2D(l, 0, p, n.width, n.height, 0, h, c, null),
        i.bindFramebuffer(36160, t),
        e.framebufferTexture2D(36160, s, l, r.get(o).__webglTexture, 0),
        i.bindFramebuffer(36160, null)
    }
    function F(t, i, r) {
        if (e.bindRenderbuffer(36161, t),
        i.depthBuffer && !i.stencilBuffer) {
            var n = 33189;
            if (r) {
                var o = i.depthTexture;
                o && o.isDepthTexture && (o.type === FloatType ? n = 36012 : o.type === UnsignedIntType && (n = 33190));
                var s = B(i);
                e.renderbufferStorageMultisample(36161, s, n, i.width, i.height)
            } else
                e.renderbufferStorage(36161, n, i.width, i.height);
            e.framebufferRenderbuffer(36160, 36096, 36161, t)
        } else if (i.depthBuffer && i.stencilBuffer) {
            if (r) {
                var l = B(i);
                e.renderbufferStorageMultisample(36161, l, 35056, i.width, i.height)
            } else
                e.renderbufferStorage(36161, 34041, i.width, i.height);
            e.framebufferRenderbuffer(36160, 33306, 36161, t)
        } else {
            var h = !0 === i.isWebGLMultipleRenderTargets ? i.texture[0] : i.texture
              , c = a.convert(h.format)
              , p = a.convert(h.type)
              , u = w(h.internalFormat, c, p, h.encoding);
            if (r) {
                var d = B(i);
                e.renderbufferStorageMultisample(36161, d, u, i.width, i.height)
            } else
                e.renderbufferStorage(36161, u, i.width, i.height)
        }
        e.bindRenderbuffer(36161, null)
    }
    function B(e) {
        return c && e.isWebGLMultisampleRenderTarget ? Math.min(f, e.samples) : 0
    }
    var O = !1
      , N = !1;
    this.allocateTextureUnit = function() {
        var e = E;
        return e >= p && console.warn("THREE.WebGLTextures: Trying to use " + e + " texture units while this GPU supports only " + p),
        E += 1,
        e
    }
    ,
    this.resetTextureUnits = function() {
        E = 0
    }
    ,
    this.setTexture2D = M,
    this.setTexture2DArray = function(e, t) {
        var n = r.get(e);
        e.version > 0 && n.__version !== e.version ? I(n, e, t) : (i.activeTexture(33984 + t),
        i.bindTexture(35866, n.__webglTexture))
    }
    ,
    this.setTexture3D = function(e, t) {
        var n = r.get(e);
        e.version > 0 && n.__version !== e.version ? I(n, e, t) : (i.activeTexture(33984 + t),
        i.bindTexture(32879, n.__webglTexture))
    }
    ,
    this.setTextureCube = P,
    this.setupRenderTarget = function(t) {
        var s = t.texture
          , l = r.get(t)
          , h = r.get(s);
        t.addEventListener("dispose", k),
        !0 !== t.isWebGLMultipleRenderTargets && (h.__webglTexture = e.createTexture(),
        h.__version = s.version,
        o.memory.textures++);
        var p = !0 === t.isWebGLCubeRenderTarget
          , u = !0 === t.isWebGLMultipleRenderTargets
          , d = !0 === t.isWebGLMultisampleRenderTarget
          , f = s.isDataTexture3D || s.isDataTexture2DArray
          , m = _(t) || c;
        if (!c || s.format !== RGBFormat || s.type !== FloatType && s.type !== HalfFloatType || (s.format = RGBAFormat,
        console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),
        p) {
            l.__webglFramebuffer = [];
            for (var g = 0; g < 6; g++)
                l.__webglFramebuffer[g] = e.createFramebuffer()
        } else if (l.__webglFramebuffer = e.createFramebuffer(),
        u)
            if (n.drawBuffers)
                for (var v = t.texture, y = 0, S = v.length; y < S; y++) {
                    var T = r.get(v[y]);
                    void 0 === T.__webglTexture && (T.__webglTexture = e.createTexture(),
                    o.memory.textures++)
                }
            else
                console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");
        else if (d)
            if (c) {
                l.__webglMultisampledFramebuffer = e.createFramebuffer(),
                l.__webglColorRenderbuffer = e.createRenderbuffer(),
                e.bindRenderbuffer(36161, l.__webglColorRenderbuffer);
                var E = a.convert(s.format)
                  , P = a.convert(s.type)
                  , C = w(s.internalFormat, E, P, s.encoding)
                  , A = B(t);
                e.renderbufferStorageMultisample(36161, A, C, t.width, t.height),
                i.bindFramebuffer(36160, l.__webglMultisampledFramebuffer),
                e.framebufferRenderbuffer(36160, 36064, 36161, l.__webglColorRenderbuffer),
                e.bindRenderbuffer(36161, null),
                t.depthBuffer && (l.__webglDepthRenderbuffer = e.createRenderbuffer(),
                F(l.__webglDepthRenderbuffer, t, !0)),
                i.bindFramebuffer(36160, null)
            } else
                console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
        if (p) {
            i.bindTexture(34067, h.__webglTexture),
            L(34067, s, m);
            for (var D = 0; D < 6; D++)
                R(l.__webglFramebuffer[D], t, s, 36064, 34069 + D);
            b(s, m) && x(34067, s, t.width, t.height),
            i.unbindTexture()
        } else if (u) {
            for (var I = t.texture, O = 0, N = I.length; O < N; O++) {
                var V = I[O]
                  , z = r.get(V);
                i.bindTexture(3553, z.__webglTexture),
                L(3553, V, m),
                R(l.__webglFramebuffer, t, V, 36064 + O, 3553),
                b(V, m) && x(3553, V, t.width, t.height)
            }
            i.unbindTexture()
        } else {
            var G = 3553;
            f && (c ? G = s.isDataTexture3D ? 32879 : 35866 : console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),
            i.bindTexture(G, h.__webglTexture),
            L(G, s, m),
            R(l.__webglFramebuffer, t, s, 36064, G),
            b(s, m) && x(G, s, t.width, t.height, t.depth),
            i.unbindTexture()
        }
        t.depthBuffer && function(t) {
            var n = r.get(t)
              , a = !0 === t.isWebGLCubeRenderTarget;
            if (t.depthTexture) {
                if (a)
                    throw new Error("target.depthTexture not supported in Cube render targets");
                !function(t, n) {
                    if (n && n.isWebGLCubeRenderTarget)
                        throw new Error("Depth Texture with cube render targets is not supported");
                    if (i.bindFramebuffer(36160, t),
                    !n.depthTexture || !n.depthTexture.isDepthTexture)
                        throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
                    r.get(n.depthTexture).__webglTexture && n.depthTexture.image.width === n.width && n.depthTexture.image.height === n.height || (n.depthTexture.image.width = n.width,
                    n.depthTexture.image.height = n.height,
                    n.depthTexture.needsUpdate = !0),
                    M(n.depthTexture, 0);
                    var a = r.get(n.depthTexture).__webglTexture;
                    if (n.depthTexture.format === DepthFormat)
                        e.framebufferTexture2D(36160, 36096, 3553, a, 0);
                    else {
                        if (n.depthTexture.format !== DepthStencilFormat)
                            throw new Error("Unknown depthTexture format");
                        e.framebufferTexture2D(36160, 33306, 3553, a, 0)
                    }
                }(n.__webglFramebuffer, t)
            } else if (a) {
                n.__webglDepthbuffer = [];
                for (var o = 0; o < 6; o++)
                    i.bindFramebuffer(36160, n.__webglFramebuffer[o]),
                    n.__webglDepthbuffer[o] = e.createRenderbuffer(),
                    F(n.__webglDepthbuffer[o], t, !1)
            } else
                i.bindFramebuffer(36160, n.__webglFramebuffer),
                n.__webglDepthbuffer = e.createRenderbuffer(),
                F(n.__webglDepthbuffer, t, !1);
            i.bindFramebuffer(36160, null)
        }(t)
    }
    ,
    this.updateRenderTargetMipmap = function(e) {
        for (var t = _(e) || c, n = !0 === e.isWebGLMultipleRenderTargets ? e.texture : [e.texture], a = 0, o = n.length; a < o; a++) {
            var s = n[a];
            if (b(s, t)) {
                var l = e.isWebGLCubeRenderTarget ? 34067 : 3553
                  , h = r.get(s).__webglTexture;
                i.bindTexture(l, h),
                x(l, s, e.width, e.height),
                i.unbindTexture()
            }
        }
    }
    ,
    this.updateMultisampleRenderTarget = function(t) {
        if (t.isWebGLMultisampleRenderTarget)
            if (c) {
                var n = t.width
                  , a = t.height
                  , o = 16384;
                t.depthBuffer && (o |= 256),
                t.stencilBuffer && (o |= 1024);
                var s = r.get(t);
                i.bindFramebuffer(36008, s.__webglMultisampledFramebuffer),
                i.bindFramebuffer(36009, s.__webglFramebuffer),
                e.blitFramebuffer(0, 0, n, a, 0, 0, n, a, o, 9728),
                i.bindFramebuffer(36008, null),
                i.bindFramebuffer(36009, s.__webglMultisampledFramebuffer)
            } else
                console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")
    }
    ,
    this.safeSetTexture2D = function(e, t) {
        e && e.isWebGLRenderTarget && (!1 === O && (console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),
        O = !0),
        e = e.texture),
        M(e, t)
    }
    ,
    this.safeSetTextureCube = function(e, t) {
        e && e.isWebGLCubeRenderTarget && (!1 === N && (console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),
        N = !0),
        e = e.texture),
        P(e, t)
    }
}
function WebGLUtils(e, t, i) {
    var r = i.isWebGL2;
    return {
        convert: function(e) {
            var i;
            if (e === UnsignedByteType)
                return 5121;
            if (e === UnsignedShort4444Type)
                return 32819;
            if (e === UnsignedShort5551Type)
                return 32820;
            if (e === UnsignedShort565Type)
                return 33635;
            if (e === ByteType)
                return 5120;
            if (e === ShortType)
                return 5122;
            if (e === UnsignedShortType)
                return 5123;
            if (e === IntType)
                return 5124;
            if (e === UnsignedIntType)
                return 5125;
            if (e === FloatType)
                return 5126;
            if (e === HalfFloatType)
                return r ? 5131 : null !== (i = t.get("OES_texture_half_float")) ? i.HALF_FLOAT_OES : null;
            if (e === AlphaFormat)
                return 6406;
            if (e === RGBFormat)
                return 6407;
            if (e === RGBAFormat)
                return 6408;
            if (e === LuminanceFormat)
                return 6409;
            if (e === LuminanceAlphaFormat)
                return 6410;
            if (e === DepthFormat)
                return 6402;
            if (e === DepthStencilFormat)
                return 34041;
            if (e === RedFormat)
                return 6403;
            if (e === RedIntegerFormat)
                return 36244;
            if (e === RGFormat)
                return 33319;
            if (e === RGIntegerFormat)
                return 33320;
            if (e === RGBIntegerFormat)
                return 36248;
            if (e === RGBAIntegerFormat)
                return 36249;
            if (e === RGB_S3TC_DXT1_Format || e === RGBA_S3TC_DXT1_Format || e === RGBA_S3TC_DXT3_Format || e === RGBA_S3TC_DXT5_Format) {
                if (null === (i = t.get("WEBGL_compressed_texture_s3tc")))
                    return null;
                if (e === RGB_S3TC_DXT1_Format)
                    return i.COMPRESSED_RGB_S3TC_DXT1_EXT;
                if (e === RGBA_S3TC_DXT1_Format)
                    return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;
                if (e === RGBA_S3TC_DXT3_Format)
                    return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;
                if (e === RGBA_S3TC_DXT5_Format)
                    return i.COMPRESSED_RGBA_S3TC_DXT5_EXT
            }
            if (e === RGB_PVRTC_4BPPV1_Format || e === RGB_PVRTC_2BPPV1_Format || e === RGBA_PVRTC_4BPPV1_Format || e === RGBA_PVRTC_2BPPV1_Format) {
                if (null === (i = t.get("WEBGL_compressed_texture_pvrtc")))
                    return null;
                if (e === RGB_PVRTC_4BPPV1_Format)
                    return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                if (e === RGB_PVRTC_2BPPV1_Format)
                    return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                if (e === RGBA_PVRTC_4BPPV1_Format)
                    return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                if (e === RGBA_PVRTC_2BPPV1_Format)
                    return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG
            }
            if (e === RGB_ETC1_Format)
                return null !== (i = t.get("WEBGL_compressed_texture_etc1")) ? i.COMPRESSED_RGB_ETC1_WEBGL : null;
            if ((e === RGB_ETC2_Format || e === RGBA_ETC2_EAC_Format) && null !== (i = t.get("WEBGL_compressed_texture_etc"))) {
                if (e === RGB_ETC2_Format)
                    return i.COMPRESSED_RGB8_ETC2;
                if (e === RGBA_ETC2_EAC_Format)
                    return i.COMPRESSED_RGBA8_ETC2_EAC
            }
            return e === RGBA_ASTC_4x4_Format || e === RGBA_ASTC_5x4_Format || e === RGBA_ASTC_5x5_Format || e === RGBA_ASTC_6x5_Format || e === RGBA_ASTC_6x6_Format || e === RGBA_ASTC_8x5_Format || e === RGBA_ASTC_8x6_Format || e === RGBA_ASTC_8x8_Format || e === RGBA_ASTC_10x5_Format || e === RGBA_ASTC_10x6_Format || e === RGBA_ASTC_10x8_Format || e === RGBA_ASTC_10x10_Format || e === RGBA_ASTC_12x10_Format || e === RGBA_ASTC_12x12_Format || e === SRGB8_ALPHA8_ASTC_4x4_Format || e === SRGB8_ALPHA8_ASTC_5x4_Format || e === SRGB8_ALPHA8_ASTC_5x5_Format || e === SRGB8_ALPHA8_ASTC_6x5_Format || e === SRGB8_ALPHA8_ASTC_6x6_Format || e === SRGB8_ALPHA8_ASTC_8x5_Format || e === SRGB8_ALPHA8_ASTC_8x6_Format || e === SRGB8_ALPHA8_ASTC_8x8_Format || e === SRGB8_ALPHA8_ASTC_10x5_Format || e === SRGB8_ALPHA8_ASTC_10x6_Format || e === SRGB8_ALPHA8_ASTC_10x8_Format || e === SRGB8_ALPHA8_ASTC_10x10_Format || e === SRGB8_ALPHA8_ASTC_12x10_Format || e === SRGB8_ALPHA8_ASTC_12x12_Format ? null !== (i = t.get("WEBGL_compressed_texture_astc")) ? e : null : e === RGBA_BPTC_Format ? null !== (i = t.get("EXT_texture_compression_bptc")) ? e : null : e === UnsignedInt248Type ? r ? 34042 : null !== (i = t.get("WEBGL_depth_texture")) ? i.UNSIGNED_INT_24_8_WEBGL : null : void 0
        }
    }
}
var ArrayCamera = function(e) {
    _inherits(i, PerspectiveCamera);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
        return _classCallCheck2(this, i),
        (e = t.call(this)).cameras = r,
        e
    }
    return _createClass2(i)
}();
ArrayCamera.prototype.isArrayCamera = !0;
var Group = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Group",
        e
    }
    return _createClass2(i)
}();
Group.prototype.isGroup = !0;
var _moveEvent = {
    type: "move"
}
  , WebXRController = function() {
    function e() {
        _classCallCheck2(this, e),
        this._targetRay = null,
        this._grip = null,
        this._hand = null
    }
    return _createClass2(e, [{
        key: "getHandSpace",
        value: function() {
            return null === this._hand && (this._hand = new Group,
            this._hand.matrixAutoUpdate = !1,
            this._hand.visible = !1,
            this._hand.joints = {},
            this._hand.inputState = {
                pinching: !1
            }),
            this._hand
        }
    }, {
        key: "getTargetRaySpace",
        value: function() {
            return null === this._targetRay && (this._targetRay = new Group,
            this._targetRay.matrixAutoUpdate = !1,
            this._targetRay.visible = !1,
            this._targetRay.hasLinearVelocity = !1,
            this._targetRay.linearVelocity = new Vector3,
            this._targetRay.hasAngularVelocity = !1,
            this._targetRay.angularVelocity = new Vector3),
            this._targetRay
        }
    }, {
        key: "getGripSpace",
        value: function() {
            return null === this._grip && (this._grip = new Group,
            this._grip.matrixAutoUpdate = !1,
            this._grip.visible = !1,
            this._grip.hasLinearVelocity = !1,
            this._grip.linearVelocity = new Vector3,
            this._grip.hasAngularVelocity = !1,
            this._grip.angularVelocity = new Vector3),
            this._grip
        }
    }, {
        key: "dispatchEvent",
        value: function(e) {
            return null !== this._targetRay && this._targetRay.dispatchEvent(e),
            null !== this._grip && this._grip.dispatchEvent(e),
            null !== this._hand && this._hand.dispatchEvent(e),
            this
        }
    }, {
        key: "disconnect",
        value: function(e) {
            return this.dispatchEvent({
                type: "disconnected",
                data: e
            }),
            null !== this._targetRay && (this._targetRay.visible = !1),
            null !== this._grip && (this._grip.visible = !1),
            null !== this._hand && (this._hand.visible = !1),
            this
        }
    }, {
        key: "update",
        value: function(e, t, i) {
            var r = null
              , n = null
              , a = null
              , o = this._targetRay
              , s = this._grip
              , l = this._hand;
            if (e && "visible-blurred" !== t.session.visibilityState)
                if (null !== o && null !== (r = t.getPose(e.targetRaySpace, i)) && (o.matrix.fromArray(r.transform.matrix),
                o.matrix.decompose(o.position, o.rotation, o.scale),
                r.linearVelocity ? (o.hasLinearVelocity = !0,
                o.linearVelocity.copy(r.linearVelocity)) : o.hasLinearVelocity = !1,
                r.angularVelocity ? (o.hasAngularVelocity = !0,
                o.angularVelocity.copy(r.angularVelocity)) : o.hasAngularVelocity = !1,
                this.dispatchEvent(_moveEvent)),
                l && e.hand) {
                    a = !0;
                    var h, c = _createForOfIteratorHelper(e.hand.values());
                    try {
                        for (c.s(); !(h = c.n()).done; ) {
                            var p = h.value
                              , u = t.getJointPose(p, i);
                            if (void 0 === l.joints[p.jointName]) {
                                var d = new Group;
                                d.matrixAutoUpdate = !1,
                                d.visible = !1,
                                l.joints[p.jointName] = d,
                                l.add(d)
                            }
                            var f = l.joints[p.jointName];
                            null !== u && (f.matrix.fromArray(u.transform.matrix),
                            f.matrix.decompose(f.position, f.rotation, f.scale),
                            f.jointRadius = u.radius),
                            f.visible = null !== u
                        }
                    } catch (y) {
                        c.e(y)
                    } finally {
                        c.f()
                    }
                    var m = l.joints["index-finger-tip"]
                      , g = l.joints["thumb-tip"]
                      , v = m.position.distanceTo(g.position);
                    l.inputState.pinching && v > .025 ? (l.inputState.pinching = !1,
                    this.dispatchEvent({
                        type: "pinchend",
                        handedness: e.handedness,
                        target: this
                    })) : !l.inputState.pinching && v <= .015 && (l.inputState.pinching = !0,
                    this.dispatchEvent({
                        type: "pinchstart",
                        handedness: e.handedness,
                        target: this
                    }))
                } else
                    null !== s && e.gripSpace && null !== (n = t.getPose(e.gripSpace, i)) && (s.matrix.fromArray(n.transform.matrix),
                    s.matrix.decompose(s.position, s.rotation, s.scale),
                    n.linearVelocity ? (s.hasLinearVelocity = !0,
                    s.linearVelocity.copy(n.linearVelocity)) : s.hasLinearVelocity = !1,
                    n.angularVelocity ? (s.hasAngularVelocity = !0,
                    s.angularVelocity.copy(n.angularVelocity)) : s.hasAngularVelocity = !1);
            return null !== o && (o.visible = null !== r),
            null !== s && (s.visible = null !== n),
            null !== l && (l.visible = null !== a),
            this
        }
    }]),
    e
}()
  , WebXRManager = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        _classCallCheck2(this, i);
        var a = _assertThisInitialized(n = t.call(this))
          , o = e.state
          , s = null
          , l = 1
          , h = null
          , c = "local-floor"
          , p = null
          , u = null
          , d = null
          , f = null
          , m = null
          , g = !1
          , v = null
          , y = null
          , _ = null
          , b = null
          , x = null
          , w = null
          , S = []
          , T = new Map
          , k = new PerspectiveCamera;
        k.layers.enable(1),
        k.viewport = new Vector4;
        var E = new PerspectiveCamera;
        E.layers.enable(2),
        E.viewport = new Vector4;
        var M = [k, E]
          , P = new ArrayCamera;
        P.layers.enable(1),
        P.layers.enable(2);
        var C = null
          , A = null;
        function L(e) {
            var t = T.get(e.inputSource);
            t && t.dispatchEvent({
                type: e.type,
                data: e.inputSource
            })
        }
        function D() {
            T.forEach((function(e, t) {
                e.disconnect(t)
            }
            )),
            T.clear(),
            C = null,
            A = null,
            o.bindXRFramebuffer(null),
            e.setRenderTarget(e.getRenderTarget()),
            d && r.deleteFramebuffer(d),
            v && r.deleteFramebuffer(v),
            y && r.deleteRenderbuffer(y),
            _ && r.deleteRenderbuffer(_),
            d = null,
            v = null,
            y = null,
            _ = null,
            m = null,
            f = null,
            u = null,
            s = null,
            N.stop(),
            a.isPresenting = !1,
            a.dispatchEvent({
                type: "sessionend"
            })
        }
        function I(e) {
            for (var t = s.inputSources, i = 0; i < S.length; i++)
                T.set(t[i], S[i]);
            for (var r = 0; r < e.removed.length; r++) {
                var n = e.removed[r]
                  , a = T.get(n);
                a && (a.dispatchEvent({
                    type: "disconnected",
                    data: n
                }),
                T.delete(n))
            }
            for (var o = 0; o < e.added.length; o++) {
                var l = e.added[o]
                  , h = T.get(l);
                h && h.dispatchEvent({
                    type: "connected",
                    data: l
                })
            }
        }
        n.cameraAutoUpdate = !0,
        n.enabled = !1,
        n.isPresenting = !1,
        n.getController = function(e) {
            var t = S[e];
            return void 0 === t && (t = new WebXRController,
            S[e] = t),
            t.getTargetRaySpace()
        }
        ,
        n.getControllerGrip = function(e) {
            var t = S[e];
            return void 0 === t && (t = new WebXRController,
            S[e] = t),
            t.getGripSpace()
        }
        ,
        n.getHand = function(e) {
            var t = S[e];
            return void 0 === t && (t = new WebXRController,
            S[e] = t),
            t.getHandSpace()
        }
        ,
        n.setFramebufferScaleFactor = function(e) {
            l = e,
            !0 === a.isPresenting && console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")
        }
        ,
        n.setReferenceSpaceType = function(e) {
            c = e,
            !0 === a.isPresenting && console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")
        }
        ,
        n.getReferenceSpace = function() {
            return h
        }
        ,
        n.getBaseLayer = function() {
            return null !== f ? f : m
        }
        ,
        n.getBinding = function() {
            return u
        }
        ,
        n.getFrame = function() {
            return b
        }
        ,
        n.getSession = function() {
            return s
        }
        ,
        n.setSession = function() {
            var e = _asyncToGenerator2(_regeneratorRuntime().mark((function e(t) {
                var i, n, p, b, S;
                return _regeneratorRuntime().wrap((function(e) {
                    for (; ; )
                        switch (e.prev = e.next) {
                        case 0:
                            if (null === (s = t)) {
                                e.next = 22;
                                break
                            }
                            if (s.addEventListener("select", L),
                            s.addEventListener("selectstart", L),
                            s.addEventListener("selectend", L),
                            s.addEventListener("squeeze", L),
                            s.addEventListener("squeezestart", L),
                            s.addEventListener("squeezeend", L),
                            s.addEventListener("end", D),
                            s.addEventListener("inputsourceschange", I),
                            !0 === (i = r.getContextAttributes()).xrCompatible) {
                                e.next = 14;
                                break
                            }
                            return e.next = 14,
                            r.makeXRCompatible();
                        case 14:
                            return void 0 === s.renderState.layers ? (n = {
                                antialias: i.antialias,
                                alpha: i.alpha,
                                depth: i.depth,
                                stencil: i.stencil,
                                framebufferScaleFactor: l
                            },
                            m = new XRWebGLLayer(s,r,n),
                            s.updateRenderState({
                                baseLayer: m
                            })) : r instanceof WebGLRenderingContext ? (p = {
                                antialias: !0,
                                alpha: i.alpha,
                                depth: i.depth,
                                stencil: i.stencil,
                                framebufferScaleFactor: l
                            },
                            m = new XRWebGLLayer(s,r,p),
                            s.updateRenderState({
                                layers: [m]
                            })) : (g = i.antialias,
                            b = null,
                            i.depth && (w = 256,
                            i.stencil && (w |= 1024),
                            x = i.stencil ? 33306 : 36096,
                            b = i.stencil ? 35056 : 33190),
                            S = {
                                colorFormat: i.alpha ? 32856 : 32849,
                                depthFormat: b,
                                scaleFactor: l
                            },
                            u = new XRWebGLBinding(s,r),
                            f = u.createProjectionLayer(S),
                            d = r.createFramebuffer(),
                            s.updateRenderState({
                                layers: [f]
                            }),
                            g && (v = r.createFramebuffer(),
                            y = r.createRenderbuffer(),
                            r.bindRenderbuffer(36161, y),
                            r.renderbufferStorageMultisample(36161, 4, 32856, f.textureWidth, f.textureHeight),
                            o.bindFramebuffer(36160, v),
                            r.framebufferRenderbuffer(36160, 36064, 36161, y),
                            r.bindRenderbuffer(36161, null),
                            null !== b && (_ = r.createRenderbuffer(),
                            r.bindRenderbuffer(36161, _),
                            r.renderbufferStorageMultisample(36161, 4, b, f.textureWidth, f.textureHeight),
                            r.framebufferRenderbuffer(36160, x, 36161, _),
                            r.bindRenderbuffer(36161, null)),
                            o.bindFramebuffer(36160, null))),
                            e.next = 17,
                            s.requestReferenceSpace(c);
                        case 17:
                            h = e.sent,
                            N.setContext(s),
                            N.start(),
                            a.isPresenting = !0,
                            a.dispatchEvent({
                                type: "sessionstart"
                            });
                        case 22:
                        case "end":
                            return e.stop()
                        }
                }
                ), e)
            }
            )));
            return function(t) {
                return e.apply(this, arguments)
            }
        }();
        var R = new Vector3
          , F = new Vector3;
        function B(e, t) {
            null === t ? e.matrixWorld.copy(e.matrix) : e.matrixWorld.multiplyMatrices(t.matrixWorld, e.matrix),
            e.matrixWorldInverse.copy(e.matrixWorld).invert()
        }
        n.updateCamera = function(e) {
            if (null !== s) {
                P.near = E.near = k.near = e.near,
                P.far = E.far = k.far = e.far,
                C === P.near && A === P.far || (s.updateRenderState({
                    depthNear: P.near,
                    depthFar: P.far
                }),
                C = P.near,
                A = P.far);
                var t = e.parent
                  , i = P.cameras;
                B(P, t);
                for (var r = 0; r < i.length; r++)
                    B(i[r], t);
                P.matrixWorld.decompose(P.position, P.quaternion, P.scale),
                e.position.copy(P.position),
                e.quaternion.copy(P.quaternion),
                e.scale.copy(P.scale),
                e.matrix.copy(P.matrix),
                e.matrixWorld.copy(P.matrixWorld);
                for (var n = e.children, a = 0, o = n.length; a < o; a++)
                    n[a].updateMatrixWorld(!0);
                2 === i.length ? function(e, t, i) {
                    R.setFromMatrixPosition(t.matrixWorld),
                    F.setFromMatrixPosition(i.matrixWorld);
                    var r = R.distanceTo(F)
                      , n = t.projectionMatrix.elements
                      , a = i.projectionMatrix.elements
                      , o = n[14] / (n[10] - 1)
                      , s = n[14] / (n[10] + 1)
                      , l = (n[9] + 1) / n[5]
                      , h = (n[9] - 1) / n[5]
                      , c = (n[8] - 1) / n[0]
                      , p = (a[8] + 1) / a[0]
                      , u = o * c
                      , d = o * p
                      , f = r / (-c + p)
                      , m = f * -c;
                    t.matrixWorld.decompose(e.position, e.quaternion, e.scale),
                    e.translateX(m),
                    e.translateZ(f),
                    e.matrixWorld.compose(e.position, e.quaternion, e.scale),
                    e.matrixWorldInverse.copy(e.matrixWorld).invert();
                    var g = o + f
                      , v = s + f
                      , y = u - m
                      , _ = d + (r - m)
                      , b = l * s / v * g
                      , x = h * s / v * g;
                    e.projectionMatrix.makePerspective(y, _, b, x, g, v)
                }(P, k, E) : P.projectionMatrix.copy(k.projectionMatrix)
            }
        }
        ,
        n.getCamera = function() {
            return P
        }
        ,
        n.getFoveation = function() {
            return null !== f ? f.fixedFoveation : null !== m ? m.fixedFoveation : void 0
        }
        ,
        n.setFoveation = function(e) {
            null !== f && (f.fixedFoveation = e),
            null !== m && void 0 !== m.fixedFoveation && (m.fixedFoveation = e)
        }
        ;
        var O = null
          , N = new WebGLAnimation;
        return N.setAnimationLoop((function(e, t) {
            if (p = t.getViewerPose(h),
            b = t,
            null !== p) {
                var i = p.views;
                null !== m && o.bindXRFramebuffer(m.framebuffer);
                var n = !1;
                i.length !== P.cameras.length && (P.cameras.length = 0,
                n = !0);
                for (var a = 0; a < i.length; a++) {
                    var l = i[a]
                      , c = null;
                    if (null !== m)
                        c = m.getViewport(l);
                    else {
                        var y = u.getViewSubImage(f, l);
                        o.bindXRFramebuffer(d),
                        void 0 !== y.depthStencilTexture && r.framebufferTexture2D(36160, x, 3553, y.depthStencilTexture, 0),
                        r.framebufferTexture2D(36160, 36064, 3553, y.colorTexture, 0),
                        c = y.viewport
                    }
                    var _ = M[a];
                    _.matrix.fromArray(l.transform.matrix),
                    _.projectionMatrix.fromArray(l.projectionMatrix),
                    _.viewport.set(c.x, c.y, c.width, c.height),
                    0 === a && P.matrix.copy(_.matrix),
                    !0 === n && P.cameras.push(_)
                }
                g && (o.bindXRFramebuffer(v),
                null !== w && r.clear(w))
            }
            for (var T = s.inputSources, k = 0; k < S.length; k++) {
                var E = S[k]
                  , C = T[k];
                E.update(C, t, h)
            }
            if (O && O(e, t),
            g) {
                var A = f.textureWidth
                  , L = f.textureHeight;
                o.bindFramebuffer(36008, v),
                o.bindFramebuffer(36009, d),
                r.invalidateFramebuffer(36008, [x]),
                r.invalidateFramebuffer(36009, [x]),
                r.blitFramebuffer(0, 0, A, L, 0, 0, A, L, 16384, 9728),
                r.invalidateFramebuffer(36008, [36064]),
                o.bindFramebuffer(36008, null),
                o.bindFramebuffer(36009, null),
                o.bindFramebuffer(36160, v)
            }
            b = null
        }
        )),
        n.setAnimationLoop = function(e) {
            O = e
        }
        ,
        n.dispose = function() {}
        ,
        n
    }
    return _createClass2(i)
}();
function WebGLMaterials(e) {
    function t(t, i) {
        t.opacity.value = i.opacity,
        i.color && t.diffuse.value.copy(i.color),
        i.emissive && t.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),
        i.map && (t.map.value = i.map),
        i.alphaMap && (t.alphaMap.value = i.alphaMap),
        i.specularMap && (t.specularMap.value = i.specularMap),
        i.alphaTest > 0 && (t.alphaTest.value = i.alphaTest);
        var r, n, a = e.get(i).envMap;
        if (a) {
            t.envMap.value = a,
            t.flipEnvMap.value = a.isCubeTexture && !1 === a.isRenderTargetTexture ? -1 : 1,
            t.reflectivity.value = i.reflectivity,
            t.ior.value = i.ior,
            t.refractionRatio.value = i.refractionRatio;
            var o = e.get(a).__maxMipLevel;
            void 0 !== o && (t.maxMipLevel.value = o)
        }
        i.lightMap && (t.lightMap.value = i.lightMap,
        t.lightMapIntensity.value = i.lightMapIntensity),
        i.aoMap && (t.aoMap.value = i.aoMap,
        t.aoMapIntensity.value = i.aoMapIntensity),
        i.map ? r = i.map : i.specularMap ? r = i.specularMap : i.displacementMap ? r = i.displacementMap : i.normalMap ? r = i.normalMap : i.bumpMap ? r = i.bumpMap : i.roughnessMap ? r = i.roughnessMap : i.metalnessMap ? r = i.metalnessMap : i.alphaMap ? r = i.alphaMap : i.emissiveMap ? r = i.emissiveMap : i.clearcoatMap ? r = i.clearcoatMap : i.clearcoatNormalMap ? r = i.clearcoatNormalMap : i.clearcoatRoughnessMap ? r = i.clearcoatRoughnessMap : i.specularIntensityMap ? r = i.specularIntensityMap : i.specularTintMap ? r = i.specularTintMap : i.transmissionMap ? r = i.transmissionMap : i.thicknessMap && (r = i.thicknessMap),
        void 0 !== r && (r.isWebGLRenderTarget && (r = r.texture),
        !0 === r.matrixAutoUpdate && r.updateMatrix(),
        t.uvTransform.value.copy(r.matrix)),
        i.aoMap ? n = i.aoMap : i.lightMap && (n = i.lightMap),
        void 0 !== n && (n.isWebGLRenderTarget && (n = n.texture),
        !0 === n.matrixAutoUpdate && n.updateMatrix(),
        t.uv2Transform.value.copy(n.matrix))
    }
    function i(t, i) {
        t.roughness.value = i.roughness,
        t.metalness.value = i.metalness,
        i.roughnessMap && (t.roughnessMap.value = i.roughnessMap),
        i.metalnessMap && (t.metalnessMap.value = i.metalnessMap),
        i.emissiveMap && (t.emissiveMap.value = i.emissiveMap),
        i.bumpMap && (t.bumpMap.value = i.bumpMap,
        t.bumpScale.value = i.bumpScale,
        i.side === BackSide && (t.bumpScale.value *= -1)),
        i.normalMap && (t.normalMap.value = i.normalMap,
        t.normalScale.value.copy(i.normalScale),
        i.side === BackSide && t.normalScale.value.negate()),
        i.displacementMap && (t.displacementMap.value = i.displacementMap,
        t.displacementScale.value = i.displacementScale,
        t.displacementBias.value = i.displacementBias),
        e.get(i).envMap && (t.envMapIntensity.value = i.envMapIntensity)
    }
    return {
        refreshFogUniforms: function(e, t) {
            e.fogColor.value.copy(t.color),
            t.isFog ? (e.fogNear.value = t.near,
            e.fogFar.value = t.far) : t.isFogExp2 && (e.fogDensity.value = t.density)
        },
        refreshMaterialUniforms: function(e, r, n, a, o) {
            r.isMeshBasicMaterial ? t(e, r) : r.isMeshLambertMaterial ? (t(e, r),
            function(e, t) {
                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap)
            }(e, r)) : r.isMeshToonMaterial ? (t(e, r),
            function(e, t) {
                t.gradientMap && (e.gradientMap.value = t.gradientMap),
                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                e.bumpScale.value = t.bumpScale,
                t.side === BackSide && (e.bumpScale.value *= -1)),
                t.normalMap && (e.normalMap.value = t.normalMap,
                e.normalScale.value.copy(t.normalScale),
                t.side === BackSide && e.normalScale.value.negate()),
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias)
            }(e, r)) : r.isMeshPhongMaterial ? (t(e, r),
            function(e, t) {
                e.specular.value.copy(t.specular),
                e.shininess.value = Math.max(t.shininess, 1e-4),
                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                e.bumpScale.value = t.bumpScale,
                t.side === BackSide && (e.bumpScale.value *= -1)),
                t.normalMap && (e.normalMap.value = t.normalMap,
                e.normalScale.value.copy(t.normalScale),
                t.side === BackSide && e.normalScale.value.negate()),
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias)
            }(e, r)) : r.isMeshStandardMaterial ? (t(e, r),
            r.isMeshPhysicalMaterial ? function(e, t, r) {
                i(e, t),
                e.ior.value = t.ior,
                t.sheen > 0 && (e.sheenTint.value.copy(t.sheenTint).multiplyScalar(t.sheen),
                e.sheenRoughness.value = t.sheenRoughness),
                t.clearcoat > 0 && (e.clearcoat.value = t.clearcoat,
                e.clearcoatRoughness.value = t.clearcoatRoughness,
                t.clearcoatMap && (e.clearcoatMap.value = t.clearcoatMap),
                t.clearcoatRoughnessMap && (e.clearcoatRoughnessMap.value = t.clearcoatRoughnessMap),
                t.clearcoatNormalMap && (e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),
                e.clearcoatNormalMap.value = t.clearcoatNormalMap,
                t.side === BackSide && e.clearcoatNormalScale.value.negate())),
                t.transmission > 0 && (e.transmission.value = t.transmission,
                e.transmissionSamplerMap.value = r.texture,
                e.transmissionSamplerSize.value.set(r.width, r.height),
                t.transmissionMap && (e.transmissionMap.value = t.transmissionMap),
                e.thickness.value = t.thickness,
                t.thicknessMap && (e.thicknessMap.value = t.thicknessMap),
                e.attenuationDistance.value = t.attenuationDistance,
                e.attenuationTint.value.copy(t.attenuationTint)),
                e.specularIntensity.value = t.specularIntensity,
                e.specularTint.value.copy(t.specularTint),
                t.specularIntensityMap && (e.specularIntensityMap.value = t.specularIntensityMap),
                t.specularTintMap && (e.specularTintMap.value = t.specularTintMap)
            }(e, r, o) : i(e, r)) : r.isMeshMatcapMaterial ? (t(e, r),
            function(e, t) {
                t.matcap && (e.matcap.value = t.matcap),
                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                e.bumpScale.value = t.bumpScale,
                t.side === BackSide && (e.bumpScale.value *= -1)),
                t.normalMap && (e.normalMap.value = t.normalMap,
                e.normalScale.value.copy(t.normalScale),
                t.side === BackSide && e.normalScale.value.negate()),
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias)
            }(e, r)) : r.isMeshDepthMaterial ? (t(e, r),
            function(e, t) {
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias)
            }(e, r)) : r.isMeshDistanceMaterial ? (t(e, r),
            function(e, t) {
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias),
                e.referencePosition.value.copy(t.referencePosition),
                e.nearDistance.value = t.nearDistance,
                e.farDistance.value = t.farDistance
            }(e, r)) : r.isMeshNormalMaterial ? (t(e, r),
            function(e, t) {
                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                e.bumpScale.value = t.bumpScale,
                t.side === BackSide && (e.bumpScale.value *= -1)),
                t.normalMap && (e.normalMap.value = t.normalMap,
                e.normalScale.value.copy(t.normalScale),
                t.side === BackSide && e.normalScale.value.negate()),
                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                e.displacementScale.value = t.displacementScale,
                e.displacementBias.value = t.displacementBias)
            }(e, r)) : r.isLineBasicMaterial ? (function(e, t) {
                e.diffuse.value.copy(t.color),
                e.opacity.value = t.opacity
            }(e, r),
            r.isLineDashedMaterial && function(e, t) {
                e.dashSize.value = t.dashSize,
                e.totalSize.value = t.dashSize + t.gapSize,
                e.scale.value = t.scale
            }(e, r)) : r.isPointsMaterial ? function(e, t, i, r) {
                var n;
                e.diffuse.value.copy(t.color),
                e.opacity.value = t.opacity,
                e.size.value = t.size * i,
                e.scale.value = .5 * r,
                t.map && (e.map.value = t.map),
                t.alphaMap && (e.alphaMap.value = t.alphaMap),
                t.alphaTest > 0 && (e.alphaTest.value = t.alphaTest),
                t.map ? n = t.map : t.alphaMap && (n = t.alphaMap),
                void 0 !== n && (!0 === n.matrixAutoUpdate && n.updateMatrix(),
                e.uvTransform.value.copy(n.matrix))
            }(e, r, n, a) : r.isSpriteMaterial ? function(e, t) {
                var i;
                e.diffuse.value.copy(t.color),
                e.opacity.value = t.opacity,
                e.rotation.value = t.rotation,
                t.map && (e.map.value = t.map),
                t.alphaMap && (e.alphaMap.value = t.alphaMap),
                t.alphaTest > 0 && (e.alphaTest.value = t.alphaTest),
                t.map ? i = t.map : t.alphaMap && (i = t.alphaMap),
                void 0 !== i && (!0 === i.matrixAutoUpdate && i.updateMatrix(),
                e.uvTransform.value.copy(i.matrix))
            }(e, r) : r.isShadowMaterial ? (e.color.value.copy(r.color),
            e.opacity.value = r.opacity) : r.isShaderMaterial && (r.uniformsNeedUpdate = !1)
        }
    }
}
function createCanvasElement() {
    var e = createElementNS("canvas");
    return e.style.display = "block",
    e
}
function WebGLRenderer() {
    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
      , t = void 0 !== e.canvas ? e.canvas : createCanvasElement()
      , i = void 0 !== e.context ? e.context : null
      , r = void 0 !== e.alpha && e.alpha
      , n = void 0 === e.depth || e.depth
      , a = void 0 === e.stencil || e.stencil
      , o = void 0 !== e.antialias && e.antialias
      , s = void 0 === e.premultipliedAlpha || e.premultipliedAlpha
      , l = void 0 !== e.preserveDrawingBuffer && e.preserveDrawingBuffer
      , h = void 0 !== e.powerPreference ? e.powerPreference : "default"
      , c = void 0 !== e.failIfMajorPerformanceCaveat && e.failIfMajorPerformanceCaveat
      , p = null
      , u = null
      , d = []
      , f = [];
    this.domElement = t,
    this.debug = {
        checkShaderErrors: !0
    },
    this.autoClear = !0,
    this.autoClearColor = !0,
    this.autoClearDepth = !0,
    this.autoClearStencil = !0,
    this.sortObjects = !0,
    this.clippingPlanes = [],
    this.localClippingEnabled = !1,
    this.gammaFactor = 2,
    this.outputEncoding = LinearEncoding,
    this.physicallyCorrectLights = !1,
    this.toneMapping = NoToneMapping,
    this.toneMappingExposure = 1;
    var m = this
      , g = !1
      , v = 0
      , y = 0
      , _ = null
      , b = -1
      , x = null
      , w = new Vector4
      , S = new Vector4
      , T = null
      , k = t.width
      , E = t.height
      , M = 1
      , P = null
      , C = null
      , A = new Vector4(0,0,k,E)
      , L = new Vector4(0,0,k,E)
      , D = !1
      , I = []
      , R = new Frustum
      , F = !1
      , B = !1
      , O = null
      , N = new Matrix4
      , V = new Vector3
      , z = {
        background: null,
        fog: null,
        environment: null,
        overrideMaterial: null,
        isScene: !0
    };
    function G() {
        return null === _ ? M : 1
    }
    var H, U, W, j, $, q, X, Y, K, Z, J, Q, ee, te, ie, re, ne, ae, oe, se, le, he, ce, pe = i;
    function ue(e, i) {
        for (var r = 0; r < e.length; r++) {
            var n = e[r]
              , a = t.getContext(n, i);
            if (null !== a)
                return a
        }
        return null
    }
    try {
        var de = {
            alpha: r,
            depth: n,
            stencil: a,
            antialias: o,
            premultipliedAlpha: s,
            preserveDrawingBuffer: l,
            powerPreference: h,
            failIfMajorPerformanceCaveat: c
        };
        if (t.addEventListener("webglcontextlost", ve, !1),
        t.addEventListener("webglcontextrestored", ye, !1),
        null === pe) {
            var fe = ["webgl2", "webgl", "experimental-webgl"];
            if (!0 === m.isWebGL1Renderer && fe.shift(),
            null === (pe = ue(fe, de)))
                throw ue(fe) ? new Error("Error creating WebGL context with your selected attributes.") : new Error("Error creating WebGL context.")
        }
        void 0 === pe.getShaderPrecisionFormat && (pe.getShaderPrecisionFormat = function() {
            return {
                rangeMin: 1,
                rangeMax: 1,
                precision: 1
            }
        }
        )
    } catch (Ne) {
        throw console.error("THREE.WebGLRenderer: " + Ne.message),
        Ne
    }
    function me() {
        H = new WebGLExtensions(pe),
        U = new WebGLCapabilities(pe,H,e),
        H.init(U),
        he = new WebGLUtils(pe,H,U),
        W = new WebGLState(pe,H,U),
        I[0] = 1029,
        j = new WebGLInfo,
        $ = new WebGLProperties,
        q = new WebGLTextures(pe,H,W,$,U,he,j),
        X = new WebGLCubeMaps(m),
        Y = new WebGLCubeUVMaps(m),
        K = new WebGLAttributes(pe,U),
        ce = new WebGLBindingStates(pe,H,K,U),
        Z = new WebGLGeometries(pe,K,j,ce),
        J = new WebGLObjects(pe,Z,K,j),
        oe = new WebGLMorphtargets(pe,U,q),
        re = new WebGLClipping($),
        Q = new WebGLPrograms(m,X,Y,H,U,ce,re),
        ee = new WebGLMaterials($),
        te = new WebGLRenderLists($),
        ie = new WebGLRenderStates(H,U),
        ae = new WebGLBackground(m,X,W,J,s),
        ne = new WebGLShadowMap(m,J,U),
        se = new WebGLBufferRenderer(pe,H,j,U),
        le = new WebGLIndexedBufferRenderer(pe,H,j,U),
        j.programs = Q.programs,
        m.capabilities = U,
        m.extensions = H,
        m.properties = $,
        m.renderLists = te,
        m.shadowMap = ne,
        m.state = W,
        m.info = j
    }
    me();
    var ge = new WebXRManager(m,pe);
    function ve(e) {
        e.preventDefault(),
        console.log("THREE.WebGLRenderer: Context Lost."),
        g = !0
    }
    function ye() {
        console.log("THREE.WebGLRenderer: Context Restored."),
        g = !1;
        var e = j.autoReset
          , t = ne.enabled
          , i = ne.autoUpdate
          , r = ne.needsUpdate
          , n = ne.type;
        me(),
        j.autoReset = e,
        ne.enabled = t,
        ne.autoUpdate = i,
        ne.needsUpdate = r,
        ne.type = n
    }
    function _e(e) {
        var t = e.target;
        t.removeEventListener("dispose", _e),
        be(t)
    }
    function be(e) {
        xe(e),
        $.remove(e)
    }
    function xe(e) {
        var t = $.get(e).programs;
        void 0 !== t && t.forEach((function(e) {
            Q.releaseProgram(e)
        }
        ))
    }
    function we(e, t) {
        e.render((function(e) {
            m.renderBufferImmediate(e, t)
        }
        ))
    }
    this.xr = ge,
    this.getContext = function() {
        return pe
    }
    ,
    this.getContextAttributes = function() {
        return pe.getContextAttributes()
    }
    ,
    this.forceContextLoss = function() {
        var e = H.get("WEBGL_lose_context");
        e && e.loseContext()
    }
    ,
    this.forceContextRestore = function() {
        var e = H.get("WEBGL_lose_context");
        e && e.restoreContext()
    }
    ,
    this.getPixelRatio = function() {
        return M
    }
    ,
    this.setPixelRatio = function(e) {
        void 0 !== e && (M = e,
        this.setSize(k, E, !1))
    }
    ,
    this.getSize = function(e) {
        return e.set(k, E)
    }
    ,
    this.setSize = function(e, i, r) {
        ge.isPresenting ? console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.") : (k = e,
        E = i,
        t.width = Math.floor(e * M),
        t.height = Math.floor(i * M),
        !1 !== r && (t.style.width = e + "px",
        t.style.height = i + "px"),
        this.setViewport(0, 0, e, i))
    }
    ,
    this.getDrawingBufferSize = function(e) {
        return e.set(k * M, E * M).floor()
    }
    ,
    this.setDrawingBufferSize = function(e, i, r) {
        k = e,
        E = i,
        M = r,
        t.width = Math.floor(e * r),
        t.height = Math.floor(i * r),
        this.setViewport(0, 0, e, i)
    }
    ,
    this.getCurrentViewport = function(e) {
        return e.copy(w)
    }
    ,
    this.getViewport = function(e) {
        return e.copy(A)
    }
    ,
    this.setViewport = function(e, t, i, r) {
        e.isVector4 ? A.set(e.x, e.y, e.z, e.w) : A.set(e, t, i, r),
        W.viewport(w.copy(A).multiplyScalar(M).floor())
    }
    ,
    this.getScissor = function(e) {
        return e.copy(L)
    }
    ,
    this.setScissor = function(e, t, i, r) {
        e.isVector4 ? L.set(e.x, e.y, e.z, e.w) : L.set(e, t, i, r),
        W.scissor(S.copy(L).multiplyScalar(M).floor())
    }
    ,
    this.getScissorTest = function() {
        return D
    }
    ,
    this.setScissorTest = function(e) {
        W.setScissorTest(D = e)
    }
    ,
    this.setOpaqueSort = function(e) {
        P = e
    }
    ,
    this.setTransparentSort = function(e) {
        C = e
    }
    ,
    this.getClearColor = function(e) {
        return e.copy(ae.getClearColor())
    }
    ,
    this.setClearColor = function() {
        ae.setClearColor.apply(ae, arguments)
    }
    ,
    this.getClearAlpha = function() {
        return ae.getClearAlpha()
    }
    ,
    this.setClearAlpha = function() {
        ae.setClearAlpha.apply(ae, arguments)
    }
    ,
    this.clear = function(e, t, i) {
        var r = 0;
        (void 0 === e || e) && (r |= 16384),
        (void 0 === t || t) && (r |= 256),
        (void 0 === i || i) && (r |= 1024),
        pe.clear(r)
    }
    ,
    this.clearColor = function() {
        this.clear(!0, !1, !1)
    }
    ,
    this.clearDepth = function() {
        this.clear(!1, !0, !1)
    }
    ,
    this.clearStencil = function() {
        this.clear(!1, !1, !0)
    }
    ,
    this.dispose = function() {
        t.removeEventListener("webglcontextlost", ve, !1),
        t.removeEventListener("webglcontextrestored", ye, !1),
        te.dispose(),
        ie.dispose(),
        $.dispose(),
        X.dispose(),
        Y.dispose(),
        J.dispose(),
        ce.dispose(),
        ge.dispose(),
        ge.removeEventListener("sessionstart", ke),
        ge.removeEventListener("sessionend", Ee),
        O && (O.dispose(),
        O = null),
        Me.stop()
    }
    ,
    this.renderBufferImmediate = function(e, t) {
        ce.initAttributes();
        var i = $.get(e);
        e.hasPositions && !i.position && (i.position = pe.createBuffer()),
        e.hasNormals && !i.normal && (i.normal = pe.createBuffer()),
        e.hasUvs && !i.uv && (i.uv = pe.createBuffer()),
        e.hasColors && !i.color && (i.color = pe.createBuffer());
        var r = t.getAttributes();
        e.hasPositions && (pe.bindBuffer(34962, i.position),
        pe.bufferData(34962, e.positionArray, 35048),
        ce.enableAttribute(r.position.location),
        pe.vertexAttribPointer(r.position.location, 3, 5126, !1, 0, 0)),
        e.hasNormals && (pe.bindBuffer(34962, i.normal),
        pe.bufferData(34962, e.normalArray, 35048),
        ce.enableAttribute(r.normal.location),
        pe.vertexAttribPointer(r.normal.location, 3, 5126, !1, 0, 0)),
        e.hasUvs && (pe.bindBuffer(34962, i.uv),
        pe.bufferData(34962, e.uvArray, 35048),
        ce.enableAttribute(r.uv.location),
        pe.vertexAttribPointer(r.uv.location, 2, 5126, !1, 0, 0)),
        e.hasColors && (pe.bindBuffer(34962, i.color),
        pe.bufferData(34962, e.colorArray, 35048),
        ce.enableAttribute(r.color.location),
        pe.vertexAttribPointer(r.color.location, 3, 5126, !1, 0, 0)),
        ce.disableUnusedAttributes(),
        pe.drawArrays(4, 0, e.count),
        e.count = 0
    }
    ,
    this.renderBufferDirect = function(e, t, i, r, n, a) {
        null === t && (t = z);
        var o = n.isMesh && n.matrixWorld.determinant() < 0
          , s = Fe(e, t, i, r, n);
        W.setMaterial(r, o);
        var l = i.index
          , h = i.attributes.position;
        if (null === l) {
            if (void 0 === h || 0 === h.count)
                return
        } else if (0 === l.count)
            return;
        var c, p = 1;
        !0 === r.wireframe && (l = Z.getWireframeAttribute(i),
        p = 2),
        ce.setup(n, r, s, i, l);
        var u = se;
        null !== l && (c = K.get(l),
        (u = le).setIndex(c));
        var d = null !== l ? l.count : h.count
          , f = i.drawRange.start * p
          , m = i.drawRange.count * p
          , g = null !== a ? a.start * p : 0
          , v = null !== a ? a.count * p : 1 / 0
          , y = Math.max(f, g)
          , _ = Math.min(d, f + m, g + v) - 1
          , b = Math.max(0, _ - y + 1);
        if (0 !== b) {
            if (n.isMesh)
                !0 === r.wireframe ? (W.setLineWidth(r.wireframeLinewidth * G()),
                u.setMode(1)) : u.setMode(4);
            else if (n.isLine) {
                var x = r.linewidth;
                void 0 === x && (x = 1),
                W.setLineWidth(x * G()),
                n.isLineSegments ? u.setMode(1) : n.isLineLoop ? u.setMode(2) : u.setMode(3)
            } else
                n.isPoints ? u.setMode(0) : n.isSprite && u.setMode(4);
            if (n.isInstancedMesh)
                u.renderInstances(y, b, n.count);
            else if (i.isInstancedBufferGeometry) {
                var w = Math.min(i.instanceCount, i._maxInstanceCount);
                u.renderInstances(y, b, w)
            } else
                u.render(y, b)
        }
    }
    ,
    this.compile = function(e, t) {
        (u = ie.get(e)).init(),
        f.push(u),
        e.traverseVisible((function(e) {
            e.isLight && e.layers.test(t.layers) && (u.pushLight(e),
            e.castShadow && u.pushShadow(e))
        }
        )),
        u.setupLights(m.physicallyCorrectLights),
        e.traverse((function(t) {
            var i = t.material;
            if (i)
                if (Array.isArray(i))
                    for (var r = 0; r < i.length; r++)
                        Ie(i[r], e, t);
                else
                    Ie(i, e, t)
        }
        )),
        f.pop(),
        u = null
    }
    ;
    var Se = null;
    function Te(e) {
        Se && Se(e)
    }
    function ke() {
        Me.stop()
    }
    function Ee() {
        Me.start()
    }
    var Me = new WebGLAnimation;
    function Pe(e, t, i, r) {
        if (!1 !== e.visible) {
            if (e.layers.test(t.layers))
                if (e.isGroup)
                    i = e.renderOrder;
                else if (e.isLOD)
                    !0 === e.autoUpdate && e.update(t);
                else if (e.isLight)
                    u.pushLight(e),
                    e.castShadow && u.pushShadow(e);
                else if (e.isSprite) {
                    if (!e.frustumCulled || R.intersectsSprite(e)) {
                        r && V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N);
                        var n = J.update(e)
                          , a = e.material;
                        a.visible && p.push(e, n, a, i, V.z, null)
                    }
                } else if (e.isImmediateRenderObject)
                    r && V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N),
                    p.push(e, null, e.material, i, V.z, null);
                else if ((e.isMesh || e.isLine || e.isPoints) && (e.isSkinnedMesh && e.skeleton.frame !== j.render.frame && (e.skeleton.update(),
                e.skeleton.frame = j.render.frame),
                !e.frustumCulled || R.intersectsObject(e))) {
                    r && V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N);
                    var o = J.update(e)
                      , s = e.material;
                    if (Array.isArray(s))
                        for (var l = o.groups, h = 0, c = l.length; h < c; h++) {
                            var d = l[h]
                              , f = s[d.materialIndex];
                            f && f.visible && p.push(e, o, f, i, V.z, d)
                        }
                    else
                        s.visible && p.push(e, o, s, i, V.z, null)
                }
            for (var m = e.children, g = 0, v = m.length; g < v; g++)
                Pe(m[g], t, i, r)
        }
    }
    function Ce(e, t, i, r) {
        var n = e.opaque
          , a = e.transmissive
          , o = e.transparent;
        u.setupLightsView(i),
        a.length > 0 && Ae(n, t, i),
        r && W.viewport(w.copy(r)),
        n.length > 0 && Le(n, t, i),
        a.length > 0 && Le(a, t, i),
        o.length > 0 && Le(o, t, i)
    }
    function Ae(e, t, i) {
        if (null === O) {
            var r = !0 === o && !0 === U.isWebGL2;
            O = new (r ? WebGLMultisampleRenderTarget : WebGLRenderTarget)(1024,1024,{
                generateMipmaps: !0,
                type: null !== he.convert(HalfFloatType) ? HalfFloatType : UnsignedByteType,
                minFilter: LinearMipmapLinearFilter,
                magFilter: NearestFilter,
                wrapS: ClampToEdgeWrapping,
                wrapT: ClampToEdgeWrapping
            })
        }
        var n = m.getRenderTarget();
        m.setRenderTarget(O),
        m.clear();
        var a = m.toneMapping;
        m.toneMapping = NoToneMapping,
        Le(e, t, i),
        m.toneMapping = a,
        q.updateMultisampleRenderTarget(O),
        q.updateRenderTargetMipmap(O),
        m.setRenderTarget(n)
    }
    function Le(e, t, i) {
        for (var r = !0 === t.isScene ? t.overrideMaterial : null, n = 0, a = e.length; n < a; n++) {
            var o = e[n]
              , s = o.object
              , l = o.geometry
              , h = null === r ? o.material : r
              , c = o.group;
            s.layers.test(i.layers) && De(s, t, i, l, h, c)
        }
    }
    function De(e, t, i, r, n, a) {
        if (e.onBeforeRender(m, t, i, r, n, a),
        e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse, e.matrixWorld),
        e.normalMatrix.getNormalMatrix(e.modelViewMatrix),
        n.onBeforeRender(m, t, i, r, e, a),
        e.isImmediateRenderObject) {
            var o = Fe(i, t, r, n, e);
            W.setMaterial(n),
            ce.reset(),
            we(e, o)
        } else
            !0 === n.transparent && n.side === DoubleSide ? (n.side = BackSide,
            n.needsUpdate = !0,
            m.renderBufferDirect(i, t, r, n, e, a),
            n.side = FrontSide,
            n.needsUpdate = !0,
            m.renderBufferDirect(i, t, r, n, e, a),
            n.side = DoubleSide) : m.renderBufferDirect(i, t, r, n, e, a);
        e.onAfterRender(m, t, i, r, n, a)
    }
    function Ie(e, t, i) {
        !0 !== t.isScene && (t = z);
        var r = $.get(e)
          , n = u.state.lights
          , a = u.state.shadowsArray
          , o = n.state.version
          , s = Q.getParameters(e, n.state, a, t, i)
          , l = Q.getProgramCacheKey(s)
          , h = r.programs;
        r.environment = e.isMeshStandardMaterial ? t.environment : null,
        r.fog = t.fog,
        r.envMap = (e.isMeshStandardMaterial ? Y : X).get(e.envMap || r.environment),
        void 0 === h && (e.addEventListener("dispose", _e),
        h = new Map,
        r.programs = h);
        var c = h.get(l);
        if (void 0 !== c) {
            if (r.currentProgram === c && r.lightsStateVersion === o)
                return Re(e, s),
                c
        } else
            s.uniforms = Q.getUniforms(e),
            e.onBuild(s, m),
            e.onBeforeCompile(s, m),
            c = Q.acquireProgram(s, l),
            h.set(l, c),
            r.uniforms = s.uniforms;
        var p = r.uniforms;
        (e.isShaderMaterial || e.isRawShaderMaterial) && !0 !== e.clipping || (p.clippingPlanes = re.uniform),
        Re(e, s),
        r.needsLights = Oe(e),
        r.lightsStateVersion = o,
        r.needsLights && (p.ambientLightColor.value = n.state.ambient,
        p.lightProbe.value = n.state.probe,
        p.directionalLights.value = n.state.directional,
        p.directionalLightShadows.value = n.state.directionalShadow,
        p.spotLights.value = n.state.spot,
        p.spotLightShadows.value = n.state.spotShadow,
        p.rectAreaLights.value = n.state.rectArea,
        p.ltc_1.value = n.state.rectAreaLTC1,
        p.ltc_2.value = n.state.rectAreaLTC2,
        p.pointLights.value = n.state.point,
        p.pointLightShadows.value = n.state.pointShadow,
        p.hemisphereLights.value = n.state.hemi,
        p.directionalShadowMap.value = n.state.directionalShadowMap,
        p.directionalShadowMatrix.value = n.state.directionalShadowMatrix,
        p.spotShadowMap.value = n.state.spotShadowMap,
        p.spotShadowMatrix.value = n.state.spotShadowMatrix,
        p.pointShadowMap.value = n.state.pointShadowMap,
        p.pointShadowMatrix.value = n.state.pointShadowMatrix);
        var d = c.getUniforms()
          , f = WebGLUniforms.seqWithValue(d.seq, p);
        return r.currentProgram = c,
        r.uniformsList = f,
        c
    }
    function Re(e, t) {
        var i = $.get(e);
        i.outputEncoding = t.outputEncoding,
        i.instancing = t.instancing,
        i.skinning = t.skinning,
        i.morphTargets = t.morphTargets,
        i.morphNormals = t.morphNormals,
        i.morphTargetsCount = t.morphTargetsCount,
        i.numClippingPlanes = t.numClippingPlanes,
        i.numIntersection = t.numClipIntersection,
        i.vertexAlphas = t.vertexAlphas,
        i.vertexTangents = t.vertexTangents
    }
    function Fe(e, t, i, r, n) {
        !0 !== t.isScene && (t = z),
        q.resetTextureUnits();
        var a = t.fog
          , o = r.isMeshStandardMaterial ? t.environment : null
          , s = null === _ ? m.outputEncoding : _.texture.encoding
          , l = (r.isMeshStandardMaterial ? Y : X).get(r.envMap || o)
          , h = !0 === r.vertexColors && !!i && !!i.attributes.color && 4 === i.attributes.color.itemSize
          , c = !!r.normalMap && !!i && !!i.attributes.tangent
          , p = !!i && !!i.morphAttributes.position
          , d = !!i && !!i.morphAttributes.normal
          , f = i && i.morphAttributes.position ? i.morphAttributes.position.length : 0
          , g = $.get(r)
          , v = u.state.lights;
        if (!0 === F && (!0 === B || e !== x)) {
            var y = e === x && r.id === b;
            re.setState(r, e, y)
        }
        var w = !1;
        r.version === g.__version ? g.needsLights && g.lightsStateVersion !== v.state.version || g.outputEncoding !== s || n.isInstancedMesh && !1 === g.instancing ? w = !0 : n.isInstancedMesh || !0 !== g.instancing ? n.isSkinnedMesh && !1 === g.skinning ? w = !0 : n.isSkinnedMesh || !0 !== g.skinning ? g.envMap !== l || r.fog && g.fog !== a ? w = !0 : void 0 === g.numClippingPlanes || g.numClippingPlanes === re.numPlanes && g.numIntersection === re.numIntersection ? (g.vertexAlphas !== h || g.vertexTangents !== c || g.morphTargets !== p || g.morphNormals !== d || !0 === U.isWebGL2 && g.morphTargetsCount !== f) && (w = !0) : w = !0 : w = !0 : w = !0 : (w = !0,
        g.__version = r.version);
        var S = g.currentProgram;
        !0 === w && (S = Ie(r, t, n));
        var T = !1
          , k = !1
          , P = !1
          , C = S.getUniforms()
          , A = g.uniforms;
        if (W.useProgram(S.program) && (T = !0,
        k = !0,
        P = !0),
        r.id !== b && (b = r.id,
        k = !0),
        T || x !== e) {
            if (C.setValue(pe, "projectionMatrix", e.projectionMatrix),
            U.logarithmicDepthBuffer && C.setValue(pe, "logDepthBufFC", 2 / (Math.log(e.far + 1) / Math.LN2)),
            x !== e && (x = e,
            k = !0,
            P = !0),
            r.isShaderMaterial || r.isMeshPhongMaterial || r.isMeshToonMaterial || r.isMeshStandardMaterial || r.envMap) {
                var L = C.map.cameraPosition;
                void 0 !== L && L.setValue(pe, V.setFromMatrixPosition(e.matrixWorld))
            }
            (r.isMeshPhongMaterial || r.isMeshToonMaterial || r.isMeshLambertMaterial || r.isMeshBasicMaterial || r.isMeshStandardMaterial || r.isShaderMaterial) && C.setValue(pe, "isOrthographic", !0 === e.isOrthographicCamera),
            (r.isMeshPhongMaterial || r.isMeshToonMaterial || r.isMeshLambertMaterial || r.isMeshBasicMaterial || r.isMeshStandardMaterial || r.isShaderMaterial || r.isShadowMaterial || n.isSkinnedMesh) && C.setValue(pe, "viewMatrix", e.matrixWorldInverse)
        }
        if (n.isSkinnedMesh) {
            C.setOptional(pe, n, "bindMatrix"),
            C.setOptional(pe, n, "bindMatrixInverse");
            var D = n.skeleton;
            D && (U.floatVertexTextures ? (null === D.boneTexture && D.computeBoneTexture(),
            C.setValue(pe, "boneTexture", D.boneTexture, q),
            C.setValue(pe, "boneTextureSize", D.boneTextureSize)) : C.setOptional(pe, D, "boneMatrices"))
        }
        return !i || void 0 === i.morphAttributes.position && void 0 === i.morphAttributes.normal || oe.update(n, i, r, S),
        (k || g.receiveShadow !== n.receiveShadow) && (g.receiveShadow = n.receiveShadow,
        C.setValue(pe, "receiveShadow", n.receiveShadow)),
        k && (C.setValue(pe, "toneMappingExposure", m.toneMappingExposure),
        g.needsLights && Be(A, P),
        a && r.fog && ee.refreshFogUniforms(A, a),
        ee.refreshMaterialUniforms(A, r, M, E, O),
        WebGLUniforms.upload(pe, g.uniformsList, A, q)),
        r.isShaderMaterial && !0 === r.uniformsNeedUpdate && (WebGLUniforms.upload(pe, g.uniformsList, A, q),
        r.uniformsNeedUpdate = !1),
        r.isSpriteMaterial && C.setValue(pe, "center", n.center),
        C.setValue(pe, "modelViewMatrix", n.modelViewMatrix),
        C.setValue(pe, "normalMatrix", n.normalMatrix),
        C.setValue(pe, "modelMatrix", n.matrixWorld),
        S
    }
    function Be(e, t) {
        e.ambientLightColor.needsUpdate = t,
        e.lightProbe.needsUpdate = t,
        e.directionalLights.needsUpdate = t,
        e.directionalLightShadows.needsUpdate = t,
        e.pointLights.needsUpdate = t,
        e.pointLightShadows.needsUpdate = t,
        e.spotLights.needsUpdate = t,
        e.spotLightShadows.needsUpdate = t,
        e.rectAreaLights.needsUpdate = t,
        e.hemisphereLights.needsUpdate = t
    }
    function Oe(e) {
        return e.isMeshLambertMaterial || e.isMeshToonMaterial || e.isMeshPhongMaterial || e.isMeshStandardMaterial || e.isShadowMaterial || e.isShaderMaterial && !0 === e.lights
    }
    Me.setAnimationLoop(Te),
    "undefined" != typeof window && Me.setContext(window),
    this.setAnimationLoop = function(e) {
        Se = e,
        ge.setAnimationLoop(e),
        null === e ? Me.stop() : Me.start()
    }
    ,
    ge.addEventListener("sessionstart", ke),
    ge.addEventListener("sessionend", Ee),
    this.render = function(e, t) {
        if (void 0 === t || !0 === t.isCamera) {
            if (!0 !== g) {
                !0 === e.autoUpdate && e.updateMatrixWorld(),
                null === t.parent && t.updateMatrixWorld(),
                !0 === ge.enabled && !0 === ge.isPresenting && (!0 === ge.cameraAutoUpdate && ge.updateCamera(t),
                t = ge.getCamera()),
                !0 === e.isScene && e.onBeforeRender(m, e, t, _),
                (u = ie.get(e, f.length)).init(),
                f.push(u),
                N.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse),
                R.setFromProjectionMatrix(N),
                B = this.localClippingEnabled,
                F = re.init(this.clippingPlanes, B, t),
                (p = te.get(e, d.length)).init(),
                d.push(p),
                Pe(e, t, 0, m.sortObjects),
                p.finish(),
                !0 === m.sortObjects && p.sort(P, C),
                !0 === F && re.beginShadows();
                var i = u.state.shadowsArray;
                if (ne.render(i, e, t),
                !0 === F && re.endShadows(),
                !0 === this.info.autoReset && this.info.reset(),
                ae.render(p, e),
                u.setupLights(m.physicallyCorrectLights),
                t.isArrayCamera)
                    for (var r = t.cameras, n = 0, a = r.length; n < a; n++) {
                        var o = r[n];
                        Ce(p, e, o, o.viewport)
                    }
                else
                    Ce(p, e, t);
                null !== _ && (q.updateMultisampleRenderTarget(_),
                q.updateRenderTargetMipmap(_)),
                !0 === e.isScene && e.onAfterRender(m, e, t),
                W.buffers.depth.setTest(!0),
                W.buffers.depth.setMask(!0),
                W.buffers.color.setMask(!0),
                W.setPolygonOffset(!1),
                ce.resetDefaultState(),
                b = -1,
                x = null,
                f.pop(),
                u = f.length > 0 ? f[f.length - 1] : null,
                d.pop(),
                p = d.length > 0 ? d[d.length - 1] : null
            }
        } else
            console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")
    }
    ,
    this.getActiveCubeFace = function() {
        return v
    }
    ,
    this.getActiveMipmapLevel = function() {
        return y
    }
    ,
    this.getRenderTarget = function() {
        return _
    }
    ,
    this.setRenderTarget = function(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
        _ = e,
        v = t,
        y = i,
        e && void 0 === $.get(e).__webglFramebuffer && q.setupRenderTarget(e);
        var r = null
          , n = !1
          , a = !1;
        if (e) {
            var o = e.texture;
            (o.isDataTexture3D || o.isDataTexture2DArray) && (a = !0);
            var s = $.get(e).__webglFramebuffer;
            e.isWebGLCubeRenderTarget ? (r = s[t],
            n = !0) : r = e.isWebGLMultisampleRenderTarget ? $.get(e).__webglMultisampledFramebuffer : s,
            w.copy(e.viewport),
            S.copy(e.scissor),
            T = e.scissorTest
        } else
            w.copy(A).multiplyScalar(M).floor(),
            S.copy(L).multiplyScalar(M).floor(),
            T = D;
        var l = W.bindFramebuffer(36160, r);
        if (l && U.drawBuffers) {
            var h = !1;
            if (e)
                if (e.isWebGLMultipleRenderTargets) {
                    var c = e.texture;
                    if (I.length !== c.length || 36064 !== I[0]) {
                        for (var p = 0, u = c.length; p < u; p++)
                            I[p] = 36064 + p;
                        I.length = c.length,
                        h = !0
                    }
                } else
                    1 === I.length && 36064 === I[0] || (I[0] = 36064,
                    I.length = 1,
                    h = !0);
            else
                1 === I.length && 1029 === I[0] || (I[0] = 1029,
                I.length = 1,
                h = !0);
            h && (U.isWebGL2 ? pe.drawBuffers(I) : H.get("WEBGL_draw_buffers").drawBuffersWEBGL(I))
        }
        if (W.viewport(w),
        W.scissor(S),
        W.setScissorTest(T),
        n) {
            var d = $.get(e.texture);
            pe.framebufferTexture2D(36160, 36064, 34069 + t, d.__webglTexture, i)
        } else if (a) {
            var f = $.get(e.texture)
              , m = t || 0;
            pe.framebufferTextureLayer(36160, 36064, f.__webglTexture, i || 0, m)
        }
        b = -1
    }
    ,
    this.readRenderTargetPixels = function(e, t, i, r, n, a, o) {
        if (e && e.isWebGLRenderTarget) {
            var s = $.get(e).__webglFramebuffer;
            if (e.isWebGLCubeRenderTarget && void 0 !== o && (s = s[o]),
            s) {
                W.bindFramebuffer(36160, s);
                try {
                    var l = e.texture
                      , h = l.format
                      , c = l.type;
                    if (h !== RGBAFormat && he.convert(h) !== pe.getParameter(35739))
                        return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
                    var p = c === HalfFloatType && (H.has("EXT_color_buffer_half_float") || U.isWebGL2 && H.has("EXT_color_buffer_float"));
                    if (!(c === UnsignedByteType || he.convert(c) === pe.getParameter(35738) || c === FloatType && (U.isWebGL2 || H.has("OES_texture_float") || H.has("WEBGL_color_buffer_float")) || p))
                        return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
                    36053 === pe.checkFramebufferStatus(36160) ? t >= 0 && t <= e.width - r && i >= 0 && i <= e.height - n && pe.readPixels(t, i, r, n, he.convert(h), he.convert(c), a) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")
                } finally {
                    var u = null !== _ ? $.get(_).__webglFramebuffer : null;
                    W.bindFramebuffer(36160, u)
                }
            }
        } else
            console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")
    }
    ,
    this.copyFramebufferToTexture = function(e, t) {
        var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
          , r = Math.pow(2, -i)
          , n = Math.floor(t.image.width * r)
          , a = Math.floor(t.image.height * r)
          , o = he.convert(t.format);
        U.isWebGL2 && (6407 === o && (o = 32849),
        6408 === o && (o = 32856)),
        q.setTexture2D(t, 0),
        pe.copyTexImage2D(3553, i, o, e.x, e.y, n, a, 0),
        W.unbindTexture()
    }
    ,
    this.copyTextureToTexture = function(e, t, i) {
        var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
          , n = t.image.width
          , a = t.image.height
          , o = he.convert(i.format)
          , s = he.convert(i.type);
        q.setTexture2D(i, 0),
        pe.pixelStorei(37440, i.flipY),
        pe.pixelStorei(37441, i.premultiplyAlpha),
        pe.pixelStorei(3317, i.unpackAlignment),
        t.isDataTexture ? pe.texSubImage2D(3553, r, e.x, e.y, n, a, o, s, t.image.data) : t.isCompressedTexture ? pe.compressedTexSubImage2D(3553, r, e.x, e.y, t.mipmaps[0].width, t.mipmaps[0].height, o, t.mipmaps[0].data) : pe.texSubImage2D(3553, r, e.x, e.y, o, s, t.image),
        0 === r && i.generateMipmaps && pe.generateMipmap(3553),
        W.unbindTexture()
    }
    ,
    this.copyTextureToTexture3D = function(e, t, i, r) {
        var n = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0;
        if (m.isWebGL1Renderer)
            console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");
        else {
            var a, o = e.max.x - e.min.x + 1, s = e.max.y - e.min.y + 1, l = e.max.z - e.min.z + 1, h = he.convert(r.format), c = he.convert(r.type);
            if (r.isDataTexture3D)
                q.setTexture3D(r, 0),
                a = 32879;
            else {
                if (!r.isDataTexture2DArray)
                    return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");
                q.setTexture2DArray(r, 0),
                a = 35866
            }
            pe.pixelStorei(37440, r.flipY),
            pe.pixelStorei(37441, r.premultiplyAlpha),
            pe.pixelStorei(3317, r.unpackAlignment);
            var p = pe.getParameter(3314)
              , u = pe.getParameter(32878)
              , d = pe.getParameter(3316)
              , f = pe.getParameter(3315)
              , g = pe.getParameter(32877)
              , v = i.isCompressedTexture ? i.mipmaps[0] : i.image;
            pe.pixelStorei(3314, v.width),
            pe.pixelStorei(32878, v.height),
            pe.pixelStorei(3316, e.min.x),
            pe.pixelStorei(3315, e.min.y),
            pe.pixelStorei(32877, e.min.z),
            i.isDataTexture || i.isDataTexture3D ? pe.texSubImage3D(a, n, t.x, t.y, t.z, o, s, l, h, c, v.data) : i.isCompressedTexture ? (console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),
            pe.compressedTexSubImage3D(a, n, t.x, t.y, t.z, o, s, l, h, v.data)) : pe.texSubImage3D(a, n, t.x, t.y, t.z, o, s, l, h, c, v),
            pe.pixelStorei(3314, p),
            pe.pixelStorei(32878, u),
            pe.pixelStorei(3316, d),
            pe.pixelStorei(3315, f),
            pe.pixelStorei(32877, g),
            0 === n && r.generateMipmaps && pe.generateMipmap(a),
            W.unbindTexture()
        }
    }
    ,
    this.initTexture = function(e) {
        q.setTexture2D(e, 0),
        W.unbindTexture()
    }
    ,
    this.resetState = function() {
        v = 0,
        y = 0,
        _ = null,
        W.reset(),
        ce.reset()
    }
    ,
    "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{
        detail: this
    }))
}
var WebGL1Renderer = function(e) {
    _inherits(i, WebGLRenderer);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
WebGL1Renderer.prototype.isWebGL1Renderer = !0;
var Scene = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Scene",
        e.background = null,
        e.environment = null,
        e.fog = null,
        e.overrideMaterial = null,
        e.autoUpdate = !0,
        "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{
            detail: _assertThisInitialized(e)
        })),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e, t) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e, t),
            null !== e.background && (this.background = e.background.clone()),
            null !== e.environment && (this.environment = e.environment.clone()),
            null !== e.fog && (this.fog = e.fog.clone()),
            null !== e.overrideMaterial && (this.overrideMaterial = e.overrideMaterial.clone()),
            this.autoUpdate = e.autoUpdate,
            this.matrixAutoUpdate = e.matrixAutoUpdate,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return null !== this.fog && (t.object.fog = this.fog.toJSON()),
            t
        }
    }]),
    i
}();
Scene.prototype.isScene = !0;
var InterleavedBuffer = function() {
    function e(t, i) {
        _classCallCheck2(this, e),
        this.array = t,
        this.stride = i,
        this.count = void 0 !== t ? t.length / i : 0,
        this.usage = StaticDrawUsage,
        this.updateRange = {
            offset: 0,
            count: -1
        },
        this.version = 0,
        this.uuid = generateUUID()
    }
    return _createClass2(e, [{
        key: "onUploadCallback",
        value: function() {}
    }, {
        key: "needsUpdate",
        set: function(e) {
            !0 === e && this.version++
        }
    }, {
        key: "setUsage",
        value: function(e) {
            return this.usage = e,
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.array = new e.array.constructor(e.array),
            this.count = e.count,
            this.stride = e.stride,
            this.usage = e.usage,
            this
        }
    }, {
        key: "copyAt",
        value: function(e, t, i) {
            e *= this.stride,
            i *= t.stride;
            for (var r = 0, n = this.stride; r < n; r++)
                this.array[e + r] = t.array[i + r];
            return this
        }
    }, {
        key: "set",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return this.array.set(e, t),
            this
        }
    }, {
        key: "clone",
        value: function(e) {
            void 0 === e.arrayBuffers && (e.arrayBuffers = {}),
            void 0 === this.array.buffer._uuid && (this.array.buffer._uuid = generateUUID()),
            void 0 === e.arrayBuffers[this.array.buffer._uuid] && (e.arrayBuffers[this.array.buffer._uuid] = this.array.slice(0).buffer);
            var t = new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid])
              , i = new this.constructor(t,this.stride);
            return i.setUsage(this.usage),
            i
        }
    }, {
        key: "onUpload",
        value: function(e) {
            return this.onUploadCallback = e,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            return void 0 === e.arrayBuffers && (e.arrayBuffers = {}),
            void 0 === this.array.buffer._uuid && (this.array.buffer._uuid = generateUUID()),
            void 0 === e.arrayBuffers[this.array.buffer._uuid] && (e.arrayBuffers[this.array.buffer._uuid] = Array.prototype.slice.call(new Uint32Array(this.array.buffer))),
            {
                uuid: this.uuid,
                buffer: this.array.buffer._uuid,
                type: this.array.constructor.name,
                stride: this.stride
            }
        }
    }]),
    e
}();
InterleavedBuffer.prototype.isInterleavedBuffer = !0;
var _vector$6 = new Vector3
  , InterleavedBufferAttribute = function() {
    function e(t, i, r) {
        var n = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
        _classCallCheck2(this, e),
        this.name = "",
        this.data = t,
        this.itemSize = i,
        this.offset = r,
        this.normalized = !0 === n
    }
    return _createClass2(e, [{
        key: "count",
        get: function() {
            return this.data.count
        }
    }, {
        key: "array",
        get: function() {
            return this.data.array
        }
    }, {
        key: "needsUpdate",
        set: function(e) {
            this.data.needsUpdate = e
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            for (var t = 0, i = this.data.count; t < i; t++)
                _vector$6.x = this.getX(t),
                _vector$6.y = this.getY(t),
                _vector$6.z = this.getZ(t),
                _vector$6.applyMatrix4(e),
                this.setXYZ(t, _vector$6.x, _vector$6.y, _vector$6.z);
            return this
        }
    }, {
        key: "applyNormalMatrix",
        value: function(e) {
            for (var t = 0, i = this.count; t < i; t++)
                _vector$6.x = this.getX(t),
                _vector$6.y = this.getY(t),
                _vector$6.z = this.getZ(t),
                _vector$6.applyNormalMatrix(e),
                this.setXYZ(t, _vector$6.x, _vector$6.y, _vector$6.z);
            return this
        }
    }, {
        key: "transformDirection",
        value: function(e) {
            for (var t = 0, i = this.count; t < i; t++)
                _vector$6.x = this.getX(t),
                _vector$6.y = this.getY(t),
                _vector$6.z = this.getZ(t),
                _vector$6.transformDirection(e),
                this.setXYZ(t, _vector$6.x, _vector$6.y, _vector$6.z);
            return this
        }
    }, {
        key: "setX",
        value: function(e, t) {
            return this.data.array[e * this.data.stride + this.offset] = t,
            this
        }
    }, {
        key: "setY",
        value: function(e, t) {
            return this.data.array[e * this.data.stride + this.offset + 1] = t,
            this
        }
    }, {
        key: "setZ",
        value: function(e, t) {
            return this.data.array[e * this.data.stride + this.offset + 2] = t,
            this
        }
    }, {
        key: "setW",
        value: function(e, t) {
            return this.data.array[e * this.data.stride + this.offset + 3] = t,
            this
        }
    }, {
        key: "getX",
        value: function(e) {
            return this.data.array[e * this.data.stride + this.offset]
        }
    }, {
        key: "getY",
        value: function(e) {
            return this.data.array[e * this.data.stride + this.offset + 1]
        }
    }, {
        key: "getZ",
        value: function(e) {
            return this.data.array[e * this.data.stride + this.offset + 2]
        }
    }, {
        key: "getW",
        value: function(e) {
            return this.data.array[e * this.data.stride + this.offset + 3]
        }
    }, {
        key: "setXY",
        value: function(e, t, i) {
            return e = e * this.data.stride + this.offset,
            this.data.array[e + 0] = t,
            this.data.array[e + 1] = i,
            this
        }
    }, {
        key: "setXYZ",
        value: function(e, t, i, r) {
            return e = e * this.data.stride + this.offset,
            this.data.array[e + 0] = t,
            this.data.array[e + 1] = i,
            this.data.array[e + 2] = r,
            this
        }
    }, {
        key: "setXYZW",
        value: function(e, t, i, r, n) {
            return e = e * this.data.stride + this.offset,
            this.data.array[e + 0] = t,
            this.data.array[e + 1] = i,
            this.data.array[e + 2] = r,
            this.data.array[e + 3] = n,
            this
        }
    }, {
        key: "clone",
        value: function(t) {
            if (void 0 === t) {
                console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");
                for (var i = [], r = 0; r < this.count; r++)
                    for (var n = r * this.data.stride + this.offset, a = 0; a < this.itemSize; a++)
                        i.push(this.data.array[n + a]);
                return new BufferAttribute(new this.array.constructor(i),this.itemSize,this.normalized)
            }
            return void 0 === t.interleavedBuffers && (t.interleavedBuffers = {}),
            void 0 === t.interleavedBuffers[this.data.uuid] && (t.interleavedBuffers[this.data.uuid] = this.data.clone(t)),
            new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)
        }
    }, {
        key: "toJSON",
        value: function(e) {
            if (void 0 === e) {
                console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");
                for (var t = [], i = 0; i < this.count; i++)
                    for (var r = i * this.data.stride + this.offset, n = 0; n < this.itemSize; n++)
                        t.push(this.data.array[r + n]);
                return {
                    itemSize: this.itemSize,
                    type: this.array.constructor.name,
                    array: t,
                    normalized: this.normalized
                }
            }
            return void 0 === e.interleavedBuffers && (e.interleavedBuffers = {}),
            void 0 === e.interleavedBuffers[this.data.uuid] && (e.interleavedBuffers[this.data.uuid] = this.data.toJSON(e)),
            {
                isInterleavedBufferAttribute: !0,
                itemSize: this.itemSize,
                data: this.data.uuid,
                offset: this.offset,
                normalized: this.normalized
            }
        }
    }]),
    e
}();
InterleavedBufferAttribute.prototype.isInterleavedBufferAttribute = !0;
var SpriteMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "SpriteMaterial",
        r.color = new Color(16777215),
        r.map = null,
        r.alphaMap = null,
        r.rotation = 0,
        r.sizeAttenuation = !0,
        r.transparent = !0,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.map = e.map,
            this.alphaMap = e.alphaMap,
            this.rotation = e.rotation,
            this.sizeAttenuation = e.sizeAttenuation,
            this
        }
    }]),
    i
}(), _geometry;
SpriteMaterial.prototype.isSpriteMaterial = !0;
var _intersectPoint = new Vector3
  , _worldScale = new Vector3
  , _mvPosition = new Vector3
  , _alignedPosition = new Vector2
  , _rotatedPosition = new Vector2
  , _viewWorldMatrix = new Matrix4
  , _vA = new Vector3
  , _vB = new Vector3
  , _vC = new Vector3
  , _uvA = new Vector2
  , _uvB = new Vector2
  , _uvC = new Vector2
  , Sprite = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i(e) {
        var r;
        if (_classCallCheck2(this, i),
        (r = t.call(this)).type = "Sprite",
        void 0 === _geometry) {
            _geometry = new BufferGeometry;
            var n = new Float32Array([-.5, -.5, 0, 0, 0, .5, -.5, 0, 1, 0, .5, .5, 0, 1, 1, -.5, .5, 0, 0, 1])
              , a = new InterleavedBuffer(n,5);
            _geometry.setIndex([0, 1, 2, 0, 2, 3]),
            _geometry.setAttribute("position", new InterleavedBufferAttribute(a,3,0,!1)),
            _geometry.setAttribute("uv", new InterleavedBufferAttribute(a,2,3,!1))
        }
        return r.geometry = _geometry,
        r.material = void 0 !== e ? e : new SpriteMaterial,
        r.center = new Vector2(.5,.5),
        r
    }
    return _createClass2(i, [{
        key: "raycast",
        value: function(e, t) {
            null === e.camera && console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),
            _worldScale.setFromMatrixScale(this.matrixWorld),
            _viewWorldMatrix.copy(e.camera.matrixWorld),
            this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse, this.matrixWorld),
            _mvPosition.setFromMatrixPosition(this.modelViewMatrix),
            e.camera.isPerspectiveCamera && !1 === this.material.sizeAttenuation && _worldScale.multiplyScalar(-_mvPosition.z);
            var i, r, n = this.material.rotation;
            0 !== n && (r = Math.cos(n),
            i = Math.sin(n));
            var a = this.center;
            transformVertex(_vA.set(-.5, -.5, 0), _mvPosition, a, _worldScale, i, r),
            transformVertex(_vB.set(.5, -.5, 0), _mvPosition, a, _worldScale, i, r),
            transformVertex(_vC.set(.5, .5, 0), _mvPosition, a, _worldScale, i, r),
            _uvA.set(0, 0),
            _uvB.set(1, 0),
            _uvC.set(1, 1);
            var o = e.ray.intersectTriangle(_vA, _vB, _vC, !1, _intersectPoint);
            if (null !== o || (transformVertex(_vB.set(-.5, .5, 0), _mvPosition, a, _worldScale, i, r),
            _uvB.set(0, 1),
            null !== (o = e.ray.intersectTriangle(_vA, _vC, _vB, !1, _intersectPoint)))) {
                var s = e.ray.origin.distanceTo(_intersectPoint);
                s < e.near || s > e.far || t.push({
                    distance: s,
                    point: _intersectPoint.clone(),
                    uv: Triangle.getUV(_intersectPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2),
                    face: null,
                    object: this
                })
            }
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            void 0 !== e.center && this.center.copy(e.center),
            this.material = e.material,
            this
        }
    }]),
    i
}();
function transformVertex(e, t, i, r, n, a) {
    _alignedPosition.subVectors(e, i).addScalar(.5).multiply(r),
    void 0 !== n ? (_rotatedPosition.x = a * _alignedPosition.x - n * _alignedPosition.y,
    _rotatedPosition.y = n * _alignedPosition.x + a * _alignedPosition.y) : _rotatedPosition.copy(_alignedPosition),
    e.copy(t),
    e.x += _rotatedPosition.x,
    e.y += _rotatedPosition.y,
    e.applyMatrix4(_viewWorldMatrix)
}
Sprite.prototype.isSprite = !0;
var _basePosition = new Vector3
  , _skinIndex = new Vector4
  , _skinWeight = new Vector4
  , _vector$5 = new Vector3
  , _matrix = new Matrix4
  , SkinnedMesh = function(e) {
    _inherits(i, Mesh);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "SkinnedMesh",
        n.bindMode = "attached",
        n.bindMatrix = new Matrix4,
        n.bindMatrixInverse = new Matrix4,
        n
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.bindMode = e.bindMode,
            this.bindMatrix.copy(e.bindMatrix),
            this.bindMatrixInverse.copy(e.bindMatrixInverse),
            this.skeleton = e.skeleton,
            this
        }
    }, {
        key: "bind",
        value: function(e, t) {
            this.skeleton = e,
            void 0 === t && (this.updateMatrixWorld(!0),
            this.skeleton.calculateInverses(),
            t = this.matrixWorld),
            this.bindMatrix.copy(t),
            this.bindMatrixInverse.copy(t).invert()
        }
    }, {
        key: "pose",
        value: function() {
            this.skeleton.pose()
        }
    }, {
        key: "normalizeSkinWeights",
        value: function() {
            for (var e = new Vector4, t = this.geometry.attributes.skinWeight, i = 0, r = t.count; i < r; i++) {
                e.x = t.getX(i),
                e.y = t.getY(i),
                e.z = t.getZ(i),
                e.w = t.getW(i);
                var n = 1 / e.manhattanLength();
                n !== 1 / 0 ? e.multiplyScalar(n) : e.set(1, 0, 0, 0),
                t.setXYZW(i, e.x, e.y, e.z, e.w)
            }
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e),
            "attached" === this.bindMode ? this.bindMatrixInverse.copy(this.matrixWorld).invert() : "detached" === this.bindMode ? this.bindMatrixInverse.copy(this.bindMatrix).invert() : console.warn("THREE.SkinnedMesh: Unrecognized bindMode: " + this.bindMode)
        }
    }, {
        key: "boneTransform",
        value: function(e, t) {
            var i = this.skeleton
              , r = this.geometry;
            _skinIndex.fromBufferAttribute(r.attributes.skinIndex, e),
            _skinWeight.fromBufferAttribute(r.attributes.skinWeight, e),
            _basePosition.copy(t).applyMatrix4(this.bindMatrix),
            t.set(0, 0, 0);
            for (var n = 0; n < 4; n++) {
                var a = _skinWeight.getComponent(n);
                if (0 !== a) {
                    var o = _skinIndex.getComponent(n);
                    _matrix.multiplyMatrices(i.bones[o].matrixWorld, i.boneInverses[o]),
                    t.addScaledVector(_vector$5.copy(_basePosition).applyMatrix4(_matrix), a)
                }
            }
            return t.applyMatrix4(this.bindMatrixInverse)
        }
    }]),
    i
}();
SkinnedMesh.prototype.isSkinnedMesh = !0;
var Bone = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Bone",
        e
    }
    return _createClass2(i)
}();
Bone.prototype.isBone = !0;
var DataTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 ? arguments[3] : void 0, s = arguments.length > 4 ? arguments[4] : void 0, l = arguments.length > 5 ? arguments[5] : void 0, h = arguments.length > 6 ? arguments[6] : void 0, c = arguments.length > 7 ? arguments[7] : void 0, p = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : NearestFilter, u = arguments.length > 9 && void 0 !== arguments[9] ? arguments[9] : NearestFilter, d = arguments.length > 10 ? arguments[10] : void 0, f = arguments.length > 11 ? arguments[11] : void 0;
        return _classCallCheck2(this, i),
        (e = t.call(this, null, l, h, c, p, u, o, s, d, f)).image = {
            data: r,
            width: n,
            height: a
        },
        e.magFilter = p,
        e.minFilter = u,
        e.generateMipmaps = !1,
        e.flipY = !1,
        e.unpackAlignment = 1,
        e.needsUpdate = !0,
        e
    }
    return _createClass2(i)
}();
DataTexture.prototype.isDataTexture = !0;
var _offsetMatrix = new Matrix4
  , _identityMatrix = new Matrix4
  , Skeleton = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        _classCallCheck2(this, e),
        this.uuid = generateUUID(),
        this.bones = t.slice(0),
        this.boneInverses = i,
        this.boneMatrices = null,
        this.boneTexture = null,
        this.boneTextureSize = 0,
        this.frame = -1,
        this.init()
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            var e = this.bones
              , t = this.boneInverses;
            if (this.boneMatrices = new Float32Array(16 * e.length),
            0 === t.length)
                this.calculateInverses();
            else if (e.length !== t.length) {
                console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),
                this.boneInverses = [];
                for (var i = 0, r = this.bones.length; i < r; i++)
                    this.boneInverses.push(new Matrix4)
            }
        }
    }, {
        key: "calculateInverses",
        value: function() {
            this.boneInverses.length = 0;
            for (var e = 0, t = this.bones.length; e < t; e++) {
                var i = new Matrix4;
                this.bones[e] && i.copy(this.bones[e].matrixWorld).invert(),
                this.boneInverses.push(i)
            }
        }
    }, {
        key: "pose",
        value: function() {
            for (var e = 0, t = this.bones.length; e < t; e++) {
                var i = this.bones[e];
                i && i.matrixWorld.copy(this.boneInverses[e]).invert()
            }
            for (var r = 0, n = this.bones.length; r < n; r++) {
                var a = this.bones[r];
                a && (a.parent && a.parent.isBone ? (a.matrix.copy(a.parent.matrixWorld).invert(),
                a.matrix.multiply(a.matrixWorld)) : a.matrix.copy(a.matrixWorld),
                a.matrix.decompose(a.position, a.quaternion, a.scale))
            }
        }
    }, {
        key: "update",
        value: function() {
            for (var e = this.bones, t = this.boneInverses, i = this.boneMatrices, r = this.boneTexture, n = 0, a = e.length; n < a; n++) {
                var o = e[n] ? e[n].matrixWorld : _identityMatrix;
                _offsetMatrix.multiplyMatrices(o, t[n]),
                _offsetMatrix.toArray(i, 16 * n)
            }
            null !== r && (r.needsUpdate = !0)
        }
    }, {
        key: "clone",
        value: function() {
            return new e(this.bones,this.boneInverses)
        }
    }, {
        key: "computeBoneTexture",
        value: function() {
            var e = Math.sqrt(4 * this.bones.length);
            e = ceilPowerOfTwo(e),
            e = Math.max(e, 4);
            var t = new Float32Array(e * e * 4);
            t.set(this.boneMatrices);
            var i = new DataTexture(t,e,e,RGBAFormat,FloatType);
            return this.boneMatrices = t,
            this.boneTexture = i,
            this.boneTextureSize = e,
            this
        }
    }, {
        key: "getBoneByName",
        value: function(e) {
            for (var t = 0, i = this.bones.length; t < i; t++) {
                var r = this.bones[t];
                if (r.name === e)
                    return r
            }
        }
    }, {
        key: "dispose",
        value: function() {
            null !== this.boneTexture && (this.boneTexture.dispose(),
            this.boneTexture = null)
        }
    }, {
        key: "fromJSON",
        value: function(e, t) {
            this.uuid = e.uuid;
            for (var i = 0, r = e.bones.length; i < r; i++) {
                var n = e.bones[i]
                  , a = t[n];
                void 0 === a && (console.warn("THREE.Skeleton: No bone found with UUID:", n),
                a = new Bone),
                this.bones.push(a),
                this.boneInverses.push((new Matrix4).fromArray(e.boneInverses[i]))
            }
            return this.init(),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = {
                metadata: {
                    version: 4.5,
                    type: "Skeleton",
                    generator: "Skeleton.toJSON"
                },
                bones: [],
                boneInverses: []
            };
            e.uuid = this.uuid;
            for (var t = this.bones, i = this.boneInverses, r = 0, n = t.length; r < n; r++) {
                var a = t[r];
                e.bones.push(a.uuid);
                var o = i[r];
                e.boneInverses.push(o.toArray())
            }
            return e
        }
    }]),
    e
}()
  , InstancedBufferAttribute = function(e) {
    _inherits(i, BufferAttribute);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        return _classCallCheck2(this, i),
        "number" == typeof n && (o = n,
        n = !1,
        console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),
        (a = t.call(this, e, r, n)).meshPerAttribute = o,
        a
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.meshPerAttribute = e.meshPerAttribute,
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.meshPerAttribute = this.meshPerAttribute,
            e.isInstancedBufferAttribute = !0,
            e
        }
    }]),
    i
}();
InstancedBufferAttribute.prototype.isInstancedBufferAttribute = !0;
var _instanceLocalMatrix = new Matrix4
  , _instanceWorldMatrix = new Matrix4
  , _instanceIntersects = []
  , _mesh = new Mesh
  , InstancedMesh = function(e) {
    _inherits(i, Mesh);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        return _classCallCheck2(this, i),
        (a = t.call(this, e, r)).instanceMatrix = new InstancedBufferAttribute(new Float32Array(16 * n),16),
        a.instanceColor = null,
        a.count = n,
        a.frustumCulled = !1,
        a
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.instanceMatrix.copy(e.instanceMatrix),
            null !== e.instanceColor && (this.instanceColor = e.instanceColor.clone()),
            this.count = e.count,
            this
        }
    }, {
        key: "getColorAt",
        value: function(e, t) {
            t.fromArray(this.instanceColor.array, 3 * e)
        }
    }, {
        key: "getMatrixAt",
        value: function(e, t) {
            t.fromArray(this.instanceMatrix.array, 16 * e)
        }
    }, {
        key: "raycast",
        value: function(e, t) {
            var i = this.matrixWorld
              , r = this.count;
            if (_mesh.geometry = this.geometry,
            _mesh.material = this.material,
            void 0 !== _mesh.material)
                for (var n = 0; n < r; n++) {
                    this.getMatrixAt(n, _instanceLocalMatrix),
                    _instanceWorldMatrix.multiplyMatrices(i, _instanceLocalMatrix),
                    _mesh.matrixWorld = _instanceWorldMatrix,
                    _mesh.raycast(e, _instanceIntersects);
                    for (var a = 0, o = _instanceIntersects.length; a < o; a++) {
                        var s = _instanceIntersects[a];
                        s.instanceId = n,
                        s.object = this,
                        t.push(s)
                    }
                    _instanceIntersects.length = 0
                }
        }
    }, {
        key: "setColorAt",
        value: function(e, t) {
            null === this.instanceColor && (this.instanceColor = new InstancedBufferAttribute(new Float32Array(3 * this.instanceMatrix.count),3)),
            t.toArray(this.instanceColor.array, 3 * e)
        }
    }, {
        key: "setMatrixAt",
        value: function(e, t) {
            t.toArray(this.instanceMatrix.array, 16 * e)
        }
    }, {
        key: "updateMorphTargets",
        value: function() {}
    }, {
        key: "dispose",
        value: function() {
            this.dispatchEvent({
                type: "dispose"
            })
        }
    }]),
    i
}();
InstancedMesh.prototype.isInstancedMesh = !0;
var LineBasicMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "LineBasicMaterial",
        r.color = new Color(16777215),
        r.linewidth = 1,
        r.linecap = "round",
        r.linejoin = "round",
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.linewidth = e.linewidth,
            this.linecap = e.linecap,
            this.linejoin = e.linejoin,
            this
        }
    }]),
    i
}();
LineBasicMaterial.prototype.isLineBasicMaterial = !0;
var _start$1 = new Vector3
  , _end$1 = new Vector3
  , _inverseMatrix$1 = new Matrix4
  , _ray$1 = new Ray
  , _sphere$1$1 = new Sphere
  , Line = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new BufferGeometry, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new LineBasicMaterial;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Line",
        e.geometry = r,
        e.material = n,
        e.updateMorphTargets(),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.material = e.material,
            this.geometry = e.geometry,
            this
        }
    }, {
        key: "computeLineDistances",
        value: function() {
            var e = this.geometry;
            if (e.isBufferGeometry)
                if (null === e.index) {
                    for (var t = e.attributes.position, i = [0], r = 1, n = t.count; r < n; r++)
                        _start$1.fromBufferAttribute(t, r - 1),
                        _end$1.fromBufferAttribute(t, r),
                        i[r] = i[r - 1],
                        i[r] += _start$1.distanceTo(_end$1);
                    e.setAttribute("lineDistance", new Float32BufferAttribute(i,1))
                } else
                    console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
            else
                e.isGeometry && console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
            return this
        }
    }, {
        key: "raycast",
        value: function(e, t) {
            var i = this.geometry
              , r = this.matrixWorld
              , n = e.params.Line.threshold
              , a = i.drawRange;
            if (null === i.boundingSphere && i.computeBoundingSphere(),
            _sphere$1$1.copy(i.boundingSphere),
            _sphere$1$1.applyMatrix4(r),
            _sphere$1$1.radius += n,
            !1 !== e.ray.intersectsSphere(_sphere$1$1)) {
                _inverseMatrix$1.copy(r).invert(),
                _ray$1.copy(e.ray).applyMatrix4(_inverseMatrix$1);
                var o = n / ((this.scale.x + this.scale.y + this.scale.z) / 3)
                  , s = o * o
                  , l = new Vector3
                  , h = new Vector3
                  , c = new Vector3
                  , p = new Vector3
                  , u = this.isLineSegments ? 2 : 1;
                if (i.isBufferGeometry) {
                    var d = i.index
                      , f = i.attributes.position;
                    if (null !== d)
                        for (var m = Math.max(0, a.start), g = Math.min(d.count, a.start + a.count) - 1; m < g; m += u) {
                            var v = d.getX(m)
                              , y = d.getX(m + 1);
                            if (l.fromBufferAttribute(f, v),
                            h.fromBufferAttribute(f, y),
                            !(_ray$1.distanceSqToSegment(l, h, p, c) > s)) {
                                p.applyMatrix4(this.matrixWorld);
                                var _ = e.ray.origin.distanceTo(p);
                                _ < e.near || _ > e.far || t.push({
                                    distance: _,
                                    point: c.clone().applyMatrix4(this.matrixWorld),
                                    index: m,
                                    face: null,
                                    faceIndex: null,
                                    object: this
                                })
                            }
                        }
                    else
                        for (var b = Math.max(0, a.start), x = Math.min(f.count, a.start + a.count) - 1; b < x; b += u)
                            if (l.fromBufferAttribute(f, b),
                            h.fromBufferAttribute(f, b + 1),
                            !(_ray$1.distanceSqToSegment(l, h, p, c) > s)) {
                                p.applyMatrix4(this.matrixWorld);
                                var w = e.ray.origin.distanceTo(p);
                                w < e.near || w > e.far || t.push({
                                    distance: w,
                                    point: c.clone().applyMatrix4(this.matrixWorld),
                                    index: b,
                                    face: null,
                                    faceIndex: null,
                                    object: this
                                })
                            }
                } else
                    i.isGeometry && console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")
            }
        }
    }, {
        key: "updateMorphTargets",
        value: function() {
            var e = this.geometry;
            if (e.isBufferGeometry) {
                var t = e.morphAttributes
                  , i = Object.keys(t);
                if (i.length > 0) {
                    var r = t[i[0]];
                    if (void 0 !== r) {
                        this.morphTargetInfluences = [],
                        this.morphTargetDictionary = {};
                        for (var n = 0, a = r.length; n < a; n++) {
                            var o = r[n].name || String(n);
                            this.morphTargetInfluences.push(0),
                            this.morphTargetDictionary[o] = n
                        }
                    }
                }
            } else {
                var s = e.morphTargets;
                void 0 !== s && s.length > 0 && console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")
            }
        }
    }]),
    i
}();
Line.prototype.isLine = !0;
var _start = new Vector3
  , _end = new Vector3
  , LineSegments = function(e) {
    _inherits(i, Line);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "LineSegments",
        n
    }
    return _createClass2(i, [{
        key: "computeLineDistances",
        value: function() {
            var e = this.geometry;
            if (e.isBufferGeometry)
                if (null === e.index) {
                    for (var t = e.attributes.position, i = [], r = 0, n = t.count; r < n; r += 2)
                        _start.fromBufferAttribute(t, r),
                        _end.fromBufferAttribute(t, r + 1),
                        i[r] = 0 === r ? 0 : i[r - 1],
                        i[r + 1] = i[r] + _start.distanceTo(_end);
                    e.setAttribute("lineDistance", new Float32BufferAttribute(i,1))
                } else
                    console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
            else
                e.isGeometry && console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
            return this
        }
    }]),
    i
}();
LineSegments.prototype.isLineSegments = !0;
var LineLoop = function(e) {
    _inherits(i, Line);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "LineLoop",
        n
    }
    return _createClass2(i)
}();
LineLoop.prototype.isLineLoop = !0;
var PointsMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "PointsMaterial",
        r.color = new Color(16777215),
        r.map = null,
        r.alphaMap = null,
        r.size = 1,
        r.sizeAttenuation = !0,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.map = e.map,
            this.alphaMap = e.alphaMap,
            this.size = e.size,
            this.sizeAttenuation = e.sizeAttenuation,
            this
        }
    }]),
    i
}();
PointsMaterial.prototype.isPointsMaterial = !0;
var _inverseMatrix = new Matrix4
  , _ray = new Ray
  , _sphere$4 = new Sphere
  , _position$2 = new Vector3
  , Points = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new BufferGeometry, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new PointsMaterial;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "Points",
        e.geometry = r,
        e.material = n,
        e.updateMorphTargets(),
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.material = e.material,
            this.geometry = e.geometry,
            this
        }
    }, {
        key: "raycast",
        value: function(e, t) {
            var i = this.geometry
              , r = this.matrixWorld
              , n = e.params.Points.threshold
              , a = i.drawRange;
            if (null === i.boundingSphere && i.computeBoundingSphere(),
            _sphere$4.copy(i.boundingSphere),
            _sphere$4.applyMatrix4(r),
            _sphere$4.radius += n,
            !1 !== e.ray.intersectsSphere(_sphere$4)) {
                _inverseMatrix.copy(r).invert(),
                _ray.copy(e.ray).applyMatrix4(_inverseMatrix);
                var o = n / ((this.scale.x + this.scale.y + this.scale.z) / 3)
                  , s = o * o;
                if (i.isBufferGeometry) {
                    var l = i.index
                      , h = i.attributes.position;
                    if (null !== l)
                        for (var c = Math.max(0, a.start), p = Math.min(l.count, a.start + a.count); c < p; c++) {
                            var u = l.getX(c);
                            _position$2.fromBufferAttribute(h, u),
                            testPoint(_position$2, u, s, r, e, t, this)
                        }
                    else
                        for (var d = Math.max(0, a.start), f = Math.min(h.count, a.start + a.count); d < f; d++)
                            _position$2.fromBufferAttribute(h, d),
                            testPoint(_position$2, d, s, r, e, t, this)
                } else
                    console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")
            }
        }
    }, {
        key: "updateMorphTargets",
        value: function() {
            var e = this.geometry;
            if (e.isBufferGeometry) {
                var t = e.morphAttributes
                  , i = Object.keys(t);
                if (i.length > 0) {
                    var r = t[i[0]];
                    if (void 0 !== r) {
                        this.morphTargetInfluences = [],
                        this.morphTargetDictionary = {};
                        for (var n = 0, a = r.length; n < a; n++) {
                            var o = r[n].name || String(n);
                            this.morphTargetInfluences.push(0),
                            this.morphTargetDictionary[o] = n
                        }
                    }
                }
            } else {
                var s = e.morphTargets;
                void 0 !== s && s.length > 0 && console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")
            }
        }
    }]),
    i
}();
function testPoint(e, t, i, r, n, a, o) {
    var s = _ray.distanceSqToPoint(e);
    if (s < i) {
        var l = new Vector3;
        _ray.closestPointToPoint(e, l),
        l.applyMatrix4(r);
        var h = n.ray.origin.distanceTo(l);
        if (h < n.near || h > n.far)
            return;
        a.push({
            distance: h,
            distanceToRay: Math.sqrt(s),
            point: l,
            index: t,
            face: null,
            object: o
        })
    }
}
Points.prototype.isPoints = !0;
var VideoTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s, l, h, c) {
        var p;
        _classCallCheck2(this, i),
        (p = t.call(this, e, r, n, a, o, s, l, h, c)).format = void 0 !== l ? l : RGBFormat,
        p.minFilter = void 0 !== s ? s : LinearFilter,
        p.magFilter = void 0 !== o ? o : LinearFilter,
        p.generateMipmaps = !1;
        var u = _assertThisInitialized(p);
        return "requestVideoFrameCallback"in e && e.requestVideoFrameCallback((function t() {
            u.needsUpdate = !0,
            e.requestVideoFrameCallback(t)
        }
        )),
        p
    }
    return _createClass2(i, [{
        key: "clone",
        value: function() {
            return new this.constructor(this.image).copy(this)
        }
    }, {
        key: "update",
        value: function() {
            var e = this.image;
            !1 == "requestVideoFrameCallback"in e && e.readyState >= e.HAVE_CURRENT_DATA && (this.needsUpdate = !0)
        }
    }]),
    i
}();
VideoTexture.prototype.isVideoTexture = !0;
var CompressedTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s, l, h, c, p, u, d) {
        var f;
        return _classCallCheck2(this, i),
        (f = t.call(this, null, s, l, h, c, p, a, o, u, d)).image = {
            width: r,
            height: n
        },
        f.mipmaps = e,
        f.flipY = !1,
        f.generateMipmaps = !1,
        f
    }
    return _createClass2(i)
}();
CompressedTexture.prototype.isCompressedTexture = !0;
var CanvasTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s, l, h, c) {
        var p;
        return _classCallCheck2(this, i),
        (p = t.call(this, e, r, n, a, o, s, l, h, c)).needsUpdate = !0,
        p
    }
    return _createClass2(i)
}();
CanvasTexture.prototype.isCanvasTexture = !0;
var DepthTexture = function(e) {
    _inherits(i, Texture);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s, l, h, c, p) {
        var u;
        if (_classCallCheck2(this, i),
        (p = void 0 !== p ? p : DepthFormat) !== DepthFormat && p !== DepthStencilFormat)
            throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
        return void 0 === n && p === DepthFormat && (n = UnsignedShortType),
        void 0 === n && p === DepthStencilFormat && (n = UnsignedInt248Type),
        (u = t.call(this, null, a, o, s, l, h, p, n, c)).image = {
            width: e,
            height: r
        },
        u.magFilter = void 0 !== l ? l : NearestFilter,
        u.minFilter = void 0 !== h ? h : NearestFilter,
        u.flipY = !1,
        u.generateMipmaps = !1,
        u
    }
    return _createClass2(i)
}();
DepthTexture.prototype.isDepthTexture = !0;
var CylinderGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 8, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1, l = arguments.length > 5 && void 0 !== arguments[5] && arguments[5], h = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0, c = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : 2 * Math.PI;
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "CylinderGeometry",
        e.parameters = {
            radiusTop: r,
            radiusBottom: n,
            height: a,
            radialSegments: o,
            heightSegments: s,
            openEnded: l,
            thetaStart: h,
            thetaLength: c
        };
        var p = _assertThisInitialized(e);
        o = Math.floor(o),
        s = Math.floor(s);
        var u = []
          , d = []
          , f = []
          , m = []
          , g = 0
          , v = []
          , y = a / 2
          , _ = 0;
        function b() {
            for (var e = new Vector3, t = new Vector3, i = 0, l = (n - r) / a, b = 0; b <= s; b++) {
                for (var x = [], w = b / s, S = w * (n - r) + r, T = 0; T <= o; T++) {
                    var k = T / o
                      , E = k * c + h
                      , M = Math.sin(E)
                      , P = Math.cos(E);
                    t.x = S * M,
                    t.y = -w * a + y,
                    t.z = S * P,
                    d.push(t.x, t.y, t.z),
                    e.set(M, l, P).normalize(),
                    f.push(e.x, e.y, e.z),
                    m.push(k, 1 - w),
                    x.push(g++)
                }
                v.push(x)
            }
            for (var C = 0; C < o; C++)
                for (var A = 0; A < s; A++) {
                    var L = v[A][C]
                      , D = v[A + 1][C]
                      , I = v[A + 1][C + 1]
                      , R = v[A][C + 1];
                    u.push(L, D, R),
                    u.push(D, I, R),
                    i += 6
                }
            p.addGroup(_, i, 0),
            _ += i
        }
        function x(e) {
            for (var t = g, i = new Vector2, a = new Vector3, s = 0, l = !0 === e ? r : n, v = !0 === e ? 1 : -1, b = 1; b <= o; b++)
                d.push(0, y * v, 0),
                f.push(0, v, 0),
                m.push(.5, .5),
                g++;
            for (var x = g, w = 0; w <= o; w++) {
                var S = w / o * c + h
                  , T = Math.cos(S)
                  , k = Math.sin(S);
                a.x = l * k,
                a.y = y * v,
                a.z = l * T,
                d.push(a.x, a.y, a.z),
                f.push(0, v, 0),
                i.x = .5 * T + .5,
                i.y = .5 * k * v + .5,
                m.push(i.x, i.y),
                g++
            }
            for (var E = 0; E < o; E++) {
                var M = t + E
                  , P = x + E;
                !0 === e ? u.push(P, P + 1, M) : u.push(P + 1, P, M),
                s += 3
            }
            p.addGroup(_, s, !0 === e ? 1 : 2),
            _ += s
        }
        return b(),
        !1 === l && (r > 0 && x(!0),
        n > 0 && x(!1)),
        e.setIndex(u),
        e.setAttribute("position", new Float32BufferAttribute(d,3)),
        e.setAttribute("normal", new Float32BufferAttribute(f,3)),
        e.setAttribute("uv", new Float32BufferAttribute(m,2)),
        e
    }
    return _createClass2(i, null, [{
        key: "fromJSON",
        value: function(e) {
            return new i(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)
        }
    }]),
    i
}()
  , ConeGeometry = function(e) {
    _inherits(i, CylinderGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 8, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1, s = arguments.length > 4 && void 0 !== arguments[4] && arguments[4], l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0, h = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 2 * Math.PI;
        return _classCallCheck2(this, i),
        (e = t.call(this, 0, r, n, a, o, s, l, h)).type = "ConeGeometry",
        e.parameters = {
            radius: r,
            height: n,
            radialSegments: a,
            heightSegments: o,
            openEnded: s,
            thetaStart: l,
            thetaLength: h
        },
        e
    }
    return _createClass2(i, null, [{
        key: "fromJSON",
        value: function(e) {
            return new i(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)
        }
    }]),
    i
}();
new Vector3,
new Vector3,
new Vector3,
new Triangle;
var Curve = function() {
    function e() {
        _classCallCheck2(this, e),
        this.type = "Curve",
        this.arcLengthDivisions = 200
    }
    return _createClass2(e, [{
        key: "getPoint",
        value: function() {
            return console.warn("THREE.Curve: .getPoint() not implemented."),
            null
        }
    }, {
        key: "getPointAt",
        value: function(e, t) {
            var i = this.getUtoTmapping(e);
            return this.getPoint(i, t)
        }
    }, {
        key: "getPoints",
        value: function() {
            for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 5, t = [], i = 0; i <= e; i++)
                t.push(this.getPoint(i / e));
            return t
        }
    }, {
        key: "getSpacedPoints",
        value: function() {
            for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 5, t = [], i = 0; i <= e; i++)
                t.push(this.getPointAt(i / e));
            return t
        }
    }, {
        key: "getLength",
        value: function() {
            var e = this.getLengths();
            return e[e.length - 1]
        }
    }, {
        key: "getLengths",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.arcLengthDivisions;
            if (this.cacheArcLengths && this.cacheArcLengths.length === e + 1 && !this.needsUpdate)
                return this.cacheArcLengths;
            this.needsUpdate = !1;
            var t, i = [], r = this.getPoint(0), n = 0;
            i.push(0);
            for (var a = 1; a <= e; a++)
                n += (t = this.getPoint(a / e)).distanceTo(r),
                i.push(n),
                r = t;
            return this.cacheArcLengths = i,
            i
        }
    }, {
        key: "updateArcLengths",
        value: function() {
            this.needsUpdate = !0,
            this.getLengths()
        }
    }, {
        key: "getUtoTmapping",
        value: function(e, t) {
            var i, r = this.getLengths(), n = 0, a = r.length;
            i = t || e * r[a - 1];
            for (var o, s = 0, l = a - 1; s <= l; )
                if ((o = r[n = Math.floor(s + (l - s) / 2)] - i) < 0)
                    s = n + 1;
                else {
                    if (!(o > 0)) {
                        l = n;
                        break
                    }
                    l = n - 1
                }
            if (r[n = l] === i)
                return n / (a - 1);
            var h = r[n];
            return (n + (i - h) / (r[n + 1] - h)) / (a - 1)
        }
    }, {
        key: "getTangent",
        value: function(e, t) {
            var i = 1e-4
              , r = e - i
              , n = e + i;
            r < 0 && (r = 0),
            n > 1 && (n = 1);
            var a = this.getPoint(r)
              , o = this.getPoint(n)
              , s = t || (a.isVector2 ? new Vector2 : new Vector3);
            return s.copy(o).sub(a).normalize(),
            s
        }
    }, {
        key: "getTangentAt",
        value: function(e, t) {
            var i = this.getUtoTmapping(e);
            return this.getTangent(i, t)
        }
    }, {
        key: "computeFrenetFrames",
        value: function(e, t) {
            for (var i = new Vector3, r = [], n = [], a = [], o = new Vector3, s = new Matrix4, l = 0; l <= e; l++) {
                var h = l / e;
                r[l] = this.getTangentAt(h, new Vector3)
            }
            n[0] = new Vector3,
            a[0] = new Vector3;
            var c = Number.MAX_VALUE
              , p = Math.abs(r[0].x)
              , u = Math.abs(r[0].y)
              , d = Math.abs(r[0].z);
            p <= c && (c = p,
            i.set(1, 0, 0)),
            u <= c && (c = u,
            i.set(0, 1, 0)),
            d <= c && i.set(0, 0, 1),
            o.crossVectors(r[0], i).normalize(),
            n[0].crossVectors(r[0], o),
            a[0].crossVectors(r[0], n[0]);
            for (var f = 1; f <= e; f++) {
                if (n[f] = n[f - 1].clone(),
                a[f] = a[f - 1].clone(),
                o.crossVectors(r[f - 1], r[f]),
                o.length() > Number.EPSILON) {
                    o.normalize();
                    var m = Math.acos(clamp(r[f - 1].dot(r[f]), -1, 1));
                    n[f].applyMatrix4(s.makeRotationAxis(o, m))
                }
                a[f].crossVectors(r[f], n[f])
            }
            if (!0 === t) {
                var g = Math.acos(clamp(n[0].dot(n[e]), -1, 1));
                g /= e,
                r[0].dot(o.crossVectors(n[0], n[e])) > 0 && (g = -g);
                for (var v = 1; v <= e; v++)
                    n[v].applyMatrix4(s.makeRotationAxis(r[v], g * v)),
                    a[v].crossVectors(r[v], n[v])
            }
            return {
                tangents: r,
                normals: n,
                binormals: a
            }
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.arcLengthDivisions = e.arcLengthDivisions,
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = {
                metadata: {
                    version: 4.5,
                    type: "Curve",
                    generator: "Curve.toJSON"
                }
            };
            return e.arcLengthDivisions = this.arcLengthDivisions,
            e.type = this.type,
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return this.arcLengthDivisions = e.arcLengthDivisions,
            this
        }
    }]),
    e
}()
  , EllipseCurve = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 2 * Math.PI, h = arguments.length > 6 && void 0 !== arguments[6] && arguments[6], c = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : 0;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "EllipseCurve",
        e.aX = r,
        e.aY = n,
        e.xRadius = a,
        e.yRadius = o,
        e.aStartAngle = s,
        e.aEndAngle = l,
        e.aClockwise = h,
        e.aRotation = c,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e, t) {
            for (var i = t || new Vector2, r = 2 * Math.PI, n = this.aEndAngle - this.aStartAngle, a = Math.abs(n) < Number.EPSILON; n < 0; )
                n += r;
            for (; n > r; )
                n -= r;
            n < Number.EPSILON && (n = a ? 0 : r),
            !0 !== this.aClockwise || a || (n === r ? n = -r : n -= r);
            var o = this.aStartAngle + e * n
              , s = this.aX + this.xRadius * Math.cos(o)
              , l = this.aY + this.yRadius * Math.sin(o);
            if (0 !== this.aRotation) {
                var h = Math.cos(this.aRotation)
                  , c = Math.sin(this.aRotation)
                  , p = s - this.aX
                  , u = l - this.aY;
                s = p * h - u * c + this.aX,
                l = p * c + u * h + this.aY
            }
            return i.set(s, l)
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.aX = e.aX,
            this.aY = e.aY,
            this.xRadius = e.xRadius,
            this.yRadius = e.yRadius,
            this.aStartAngle = e.aStartAngle,
            this.aEndAngle = e.aEndAngle,
            this.aClockwise = e.aClockwise,
            this.aRotation = e.aRotation,
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.aX = this.aX,
            e.aY = this.aY,
            e.xRadius = this.xRadius,
            e.yRadius = this.yRadius,
            e.aStartAngle = this.aStartAngle,
            e.aEndAngle = this.aEndAngle,
            e.aClockwise = this.aClockwise,
            e.aRotation = this.aRotation,
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.aX = e.aX,
            this.aY = e.aY,
            this.xRadius = e.xRadius,
            this.yRadius = e.yRadius,
            this.aStartAngle = e.aStartAngle,
            this.aEndAngle = e.aEndAngle,
            this.aClockwise = e.aClockwise,
            this.aRotation = e.aRotation,
            this
        }
    }]),
    i
}();
EllipseCurve.prototype.isEllipseCurve = !0;
var ArcCurve = function(e) {
    _inherits(i, EllipseCurve);
    var t = _createSuper(i);
    function i(e, r, n, a, o, s) {
        var l;
        return _classCallCheck2(this, i),
        (l = t.call(this, e, r, n, n, a, o, s)).type = "ArcCurve",
        l
    }
    return _createClass2(i)
}();
function CubicPoly() {
    var e = 0
      , t = 0
      , i = 0
      , r = 0;
    function n(n, a, o, s) {
        e = n,
        t = o,
        i = -3 * n + 3 * a - 2 * o - s,
        r = 2 * n - 2 * a + o + s
    }
    return {
        initCatmullRom: function(e, t, i, r, a) {
            n(t, i, a * (i - e), a * (r - t))
        },
        initNonuniformCatmullRom: function(e, t, i, r, a, o, s) {
            var l = (t - e) / a - (i - e) / (a + o) + (i - t) / o
              , h = (i - t) / o - (r - t) / (o + s) + (r - i) / s;
            n(t, i, l *= o, h *= o)
        },
        calc: function(n) {
            var a = n * n;
            return e + t * n + i * a + r * (a * n)
        }
    }
}
ArcCurve.prototype.isArcCurve = !0;
var tmp = new Vector3
  , px = new CubicPoly
  , py = new CubicPoly
  , pz = new CubicPoly
  , CatmullRomCurve3 = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [], n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1], a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "centripetal", o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : .5;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "CatmullRomCurve3",
        e.points = r,
        e.closed = n,
        e.curveType = a,
        e.tension = o,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t, i, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3, n = r, a = this.points, o = a.length, s = (o - (this.closed ? 0 : 1)) * e, l = Math.floor(s), h = s - l;
            this.closed ? l += l > 0 ? 0 : (Math.floor(Math.abs(l) / o) + 1) * o : 0 === h && l === o - 1 && (l = o - 2,
            h = 1),
            this.closed || l > 0 ? t = a[(l - 1) % o] : (tmp.subVectors(a[0], a[1]).add(a[0]),
            t = tmp);
            var c = a[l % o]
              , p = a[(l + 1) % o];
            if (this.closed || l + 2 < o ? i = a[(l + 2) % o] : (tmp.subVectors(a[o - 1], a[o - 2]).add(a[o - 1]),
            i = tmp),
            "centripetal" === this.curveType || "chordal" === this.curveType) {
                var u = "chordal" === this.curveType ? .5 : .25
                  , d = Math.pow(t.distanceToSquared(c), u)
                  , f = Math.pow(c.distanceToSquared(p), u)
                  , m = Math.pow(p.distanceToSquared(i), u);
                f < 1e-4 && (f = 1),
                d < 1e-4 && (d = f),
                m < 1e-4 && (m = f),
                px.initNonuniformCatmullRom(t.x, c.x, p.x, i.x, d, f, m),
                py.initNonuniformCatmullRom(t.y, c.y, p.y, i.y, d, f, m),
                pz.initNonuniformCatmullRom(t.z, c.z, p.z, i.z, d, f, m)
            } else
                "catmullrom" === this.curveType && (px.initCatmullRom(t.x, c.x, p.x, i.x, this.tension),
                py.initCatmullRom(t.y, c.y, p.y, i.y, this.tension),
                pz.initCatmullRom(t.z, c.z, p.z, i.z, this.tension));
            return n.set(px.calc(h), py.calc(h), pz.calc(h)),
            n
        }
    }, {
        key: "copy",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.points = [];
            for (var t = 0, r = e.points.length; t < r; t++) {
                var n = e.points[t];
                this.points.push(n.clone())
            }
            return this.closed = e.closed,
            this.curveType = e.curveType,
            this.tension = e.tension,
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            e.points = [];
            for (var t = 0, r = this.points.length; t < r; t++) {
                var n = this.points[t];
                e.points.push(n.toArray())
            }
            return e.closed = this.closed,
            e.curveType = this.curveType,
            e.tension = this.tension,
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.points = [];
            for (var t = 0, r = e.points.length; t < r; t++) {
                var n = e.points[t];
                this.points.push((new Vector3).fromArray(n))
            }
            return this.closed = e.closed,
            this.curveType = e.curveType,
            this.tension = e.tension,
            this
        }
    }]),
    i
}();
function CatmullRom(e, t, i, r, n) {
    var a = .5 * (r - t)
      , o = .5 * (n - i)
      , s = e * e;
    return (2 * i - 2 * r + a + o) * (e * s) + (-3 * i + 3 * r - 2 * a - o) * s + a * e + i
}
function QuadraticBezierP0(e, t) {
    var i = 1 - e;
    return i * i * t
}
function QuadraticBezierP1(e, t) {
    return 2 * (1 - e) * e * t
}
function QuadraticBezierP2(e, t) {
    return e * e * t
}
function QuadraticBezier(e, t, i, r) {
    return QuadraticBezierP0(e, t) + QuadraticBezierP1(e, i) + QuadraticBezierP2(e, r)
}
function CubicBezierP0(e, t) {
    var i = 1 - e;
    return i * i * i * t
}
function CubicBezierP1(e, t) {
    var i = 1 - e;
    return 3 * i * i * e * t
}
function CubicBezierP2(e, t) {
    return 3 * (1 - e) * e * e * t
}
function CubicBezierP3(e, t) {
    return e * e * e * t
}
function CubicBezier(e, t, i, r, n) {
    return CubicBezierP0(e, t) + CubicBezierP1(e, i) + CubicBezierP2(e, r) + CubicBezierP3(e, n)
}
CatmullRomCurve3.prototype.isCatmullRomCurve3 = !0;
var CubicBezierCurve = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector2, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Vector2, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : new Vector2;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "CubicBezierCurve",
        e.v0 = r,
        e.v1 = n,
        e.v2 = a,
        e.v3 = o,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2
              , i = t
              , r = this.v0
              , n = this.v1
              , a = this.v2
              , o = this.v3;
            return i.set(CubicBezier(e, r.x, n.x, a.x, o.x), CubicBezier(e, r.y, n.y, a.y, o.y)),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v0.copy(e.v0),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this.v3.copy(e.v3),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v0 = this.v0.toArray(),
            e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e.v3 = this.v3.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v0.fromArray(e.v0),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this.v3.fromArray(e.v3),
            this
        }
    }]),
    i
}();
CubicBezierCurve.prototype.isCubicBezierCurve = !0;
var CubicBezierCurve3 = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Vector3, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : new Vector3;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "CubicBezierCurve3",
        e.v0 = r,
        e.v1 = n,
        e.v2 = a,
        e.v3 = o,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3
              , i = t
              , r = this.v0
              , n = this.v1
              , a = this.v2
              , o = this.v3;
            return i.set(CubicBezier(e, r.x, n.x, a.x, o.x), CubicBezier(e, r.y, n.y, a.y, o.y), CubicBezier(e, r.z, n.z, a.z, o.z)),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v0.copy(e.v0),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this.v3.copy(e.v3),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v0 = this.v0.toArray(),
            e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e.v3 = this.v3.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v0.fromArray(e.v0),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this.v3.fromArray(e.v3),
            this
        }
    }]),
    i
}();
CubicBezierCurve3.prototype.isCubicBezierCurve3 = !0;
var LineCurve = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector2, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "LineCurve",
        e.v1 = r,
        e.v2 = n,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2
              , i = t;
            return 1 === e ? i.copy(this.v2) : (i.copy(this.v2).sub(this.v1),
            i.multiplyScalar(e).add(this.v1)),
            i
        }
    }, {
        key: "getPointAt",
        value: function(e, t) {
            return this.getPoint(e, t)
        }
    }, {
        key: "getTangent",
        value: function(e, t) {
            var i = t || new Vector2;
            return i.copy(this.v2).sub(this.v1).normalize(),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this
        }
    }]),
    i
}();
LineCurve.prototype.isLineCurve = !0;
var LineCurve3 = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "LineCurve3",
        e.isLineCurve3 = !0,
        e.v1 = r,
        e.v2 = n,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3
              , i = t;
            return 1 === e ? i.copy(this.v2) : (i.copy(this.v2).sub(this.v1),
            i.multiplyScalar(e).add(this.v1)),
            i
        }
    }, {
        key: "getPointAt",
        value: function(e, t) {
            return this.getPoint(e, t)
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this
        }
    }]),
    i
}()
  , QuadraticBezierCurve = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector2, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Vector2;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "QuadraticBezierCurve",
        e.v0 = r,
        e.v1 = n,
        e.v2 = a,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2
              , i = t
              , r = this.v0
              , n = this.v1
              , a = this.v2;
            return i.set(QuadraticBezier(e, r.x, n.x, a.x), QuadraticBezier(e, r.y, n.y, a.y)),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v0.copy(e.v0),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v0 = this.v0.toArray(),
            e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v0.fromArray(e.v0),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this
        }
    }]),
    i
}();
QuadraticBezierCurve.prototype.isQuadraticBezierCurve = !0;
var QuadraticBezierCurve3 = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Vector3;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "QuadraticBezierCurve3",
        e.v0 = r,
        e.v1 = n,
        e.v2 = a,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3
              , i = t
              , r = this.v0
              , n = this.v1
              , a = this.v2;
            return i.set(QuadraticBezier(e, r.x, n.x, a.x), QuadraticBezier(e, r.y, n.y, a.y), QuadraticBezier(e, r.z, n.z, a.z)),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.v0.copy(e.v0),
            this.v1.copy(e.v1),
            this.v2.copy(e.v2),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.v0 = this.v0.toArray(),
            e.v1 = this.v1.toArray(),
            e.v2 = this.v2.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.v0.fromArray(e.v0),
            this.v1.fromArray(e.v1),
            this.v2.fromArray(e.v2),
            this
        }
    }]),
    i
}();
QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3 = !0;
var SplineCurve = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "SplineCurve",
        e.points = r,
        e
    }
    return _createClass2(i, [{
        key: "getPoint",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector2
              , i = t
              , r = this.points
              , n = (r.length - 1) * e
              , a = Math.floor(n)
              , o = n - a
              , s = r[0 === a ? a : a - 1]
              , l = r[a]
              , h = r[a > r.length - 2 ? r.length - 1 : a + 1]
              , c = r[a > r.length - 3 ? r.length - 1 : a + 2];
            return i.set(CatmullRom(o, s.x, l.x, h.x, c.x), CatmullRom(o, s.y, l.y, h.y, c.y)),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.points = [];
            for (var t = 0, r = e.points.length; t < r; t++) {
                var n = e.points[t];
                this.points.push(n.clone())
            }
            return this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            e.points = [];
            for (var t = 0, r = this.points.length; t < r; t++) {
                var n = this.points[t];
                e.points.push(n.toArray())
            }
            return e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.points = [];
            for (var t = 0, r = e.points.length; t < r; t++) {
                var n = e.points[t];
                this.points.push((new Vector2).fromArray(n))
            }
            return this
        }
    }]),
    i
}();
SplineCurve.prototype.isSplineCurve = !0;
var Curves = Object.freeze({
    __proto__: null,
    ArcCurve,
    CatmullRomCurve3,
    CubicBezierCurve,
    CubicBezierCurve3,
    EllipseCurve,
    LineCurve,
    LineCurve3,
    QuadraticBezierCurve,
    QuadraticBezierCurve3,
    SplineCurve
})
  , CurvePath = function(e) {
    _inherits(i, Curve);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "CurvePath",
        e.curves = [],
        e.autoClose = !1,
        e
    }
    return _createClass2(i, [{
        key: "add",
        value: function(e) {
            this.curves.push(e)
        }
    }, {
        key: "closePath",
        value: function() {
            var e = this.curves[0].getPoint(0)
              , t = this.curves[this.curves.length - 1].getPoint(1);
            e.equals(t) || this.curves.push(new LineCurve(t,e))
        }
    }, {
        key: "getPoint",
        value: function(e, t) {
            for (var i = e * this.getLength(), r = this.getCurveLengths(), n = 0; n < r.length; ) {
                if (r[n] >= i) {
                    var a = r[n] - i
                      , o = this.curves[n]
                      , s = o.getLength()
                      , l = 0 === s ? 0 : 1 - a / s;
                    return o.getPointAt(l, t)
                }
                n++
            }
            return null
        }
    }, {
        key: "getLength",
        value: function() {
            var e = this.getCurveLengths();
            return e[e.length - 1]
        }
    }, {
        key: "updateArcLengths",
        value: function() {
            this.needsUpdate = !0,
            this.cacheLengths = null,
            this.getCurveLengths()
        }
    }, {
        key: "getCurveLengths",
        value: function() {
            if (this.cacheLengths && this.cacheLengths.length === this.curves.length)
                return this.cacheLengths;
            for (var e = [], t = 0, i = 0, r = this.curves.length; i < r; i++)
                t += this.curves[i].getLength(),
                e.push(t);
            return this.cacheLengths = e,
            e
        }
    }, {
        key: "getSpacedPoints",
        value: function() {
            for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 40, t = [], i = 0; i <= e; i++)
                t.push(this.getPoint(i / e));
            return this.autoClose && t.push(t[0]),
            t
        }
    }, {
        key: "getPoints",
        value: function() {
            for (var e, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 12, i = [], r = 0, n = this.curves; r < n.length; r++)
                for (var a = n[r], o = a && a.isEllipseCurve ? 2 * t : a && (a.isLineCurve || a.isLineCurve3) ? 1 : a && a.isSplineCurve ? t * a.points.length : t, s = a.getPoints(o), l = 0; l < s.length; l++) {
                    var h = s[l];
                    e && e.equals(h) || (i.push(h),
                    e = h)
                }
            return this.autoClose && i.length > 1 && !i[i.length - 1].equals(i[0]) && i.push(i[0]),
            i
        }
    }, {
        key: "copy",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.curves = [];
            for (var t = 0, r = e.curves.length; t < r; t++) {
                var n = e.curves[t];
                this.curves.push(n.clone())
            }
            return this.autoClose = e.autoClose,
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            e.autoClose = this.autoClose,
            e.curves = [];
            for (var t = 0, r = this.curves.length; t < r; t++) {
                var n = this.curves[t];
                e.curves.push(n.toJSON())
            }
            return e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.autoClose = e.autoClose,
            this.curves = [];
            for (var t = 0, r = e.curves.length; t < r; t++) {
                var n = e.curves[t];
                this.curves.push((new Curves[n.type]).fromJSON(n))
            }
            return this
        }
    }]),
    i
}()
  , Path = function(e) {
    _inherits(i, CurvePath);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "Path",
        r.currentPoint = new Vector2,
        e && r.setFromPoints(e),
        r
    }
    return _createClass2(i, [{
        key: "setFromPoints",
        value: function(e) {
            this.moveTo(e[0].x, e[0].y);
            for (var t = 1, i = e.length; t < i; t++)
                this.lineTo(e[t].x, e[t].y);
            return this
        }
    }, {
        key: "moveTo",
        value: function(e, t) {
            return this.currentPoint.set(e, t),
            this
        }
    }, {
        key: "lineTo",
        value: function(e, t) {
            var i = new LineCurve(this.currentPoint.clone(),new Vector2(e,t));
            return this.curves.push(i),
            this.currentPoint.set(e, t),
            this
        }
    }, {
        key: "quadraticCurveTo",
        value: function(e, t, i, r) {
            var n = new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(i,r));
            return this.curves.push(n),
            this.currentPoint.set(i, r),
            this
        }
    }, {
        key: "bezierCurveTo",
        value: function(e, t, i, r, n, a) {
            var o = new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(i,r),new Vector2(n,a));
            return this.curves.push(o),
            this.currentPoint.set(n, a),
            this
        }
    }, {
        key: "splineThru",
        value: function(e) {
            var t = [this.currentPoint.clone()].concat(e)
              , i = new SplineCurve(t);
            return this.curves.push(i),
            this.currentPoint.copy(e[e.length - 1]),
            this
        }
    }, {
        key: "arc",
        value: function(e, t, i, r, n, a) {
            var o = this.currentPoint.x
              , s = this.currentPoint.y;
            return this.absarc(e + o, t + s, i, r, n, a),
            this
        }
    }, {
        key: "absarc",
        value: function(e, t, i, r, n, a) {
            return this.absellipse(e, t, i, i, r, n, a),
            this
        }
    }, {
        key: "ellipse",
        value: function(e, t, i, r, n, a, o, s) {
            var l = this.currentPoint.x
              , h = this.currentPoint.y;
            return this.absellipse(e + l, t + h, i, r, n, a, o, s),
            this
        }
    }, {
        key: "absellipse",
        value: function(e, t, i, r, n, a, o, s) {
            var l = new EllipseCurve(e,t,i,r,n,a,o,s);
            if (this.curves.length > 0) {
                var h = l.getPoint(0);
                h.equals(this.currentPoint) || this.lineTo(h.x, h.y)
            }
            this.curves.push(l);
            var c = l.getPoint(1);
            return this.currentPoint.copy(c),
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.currentPoint.copy(e.currentPoint),
            this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return e.currentPoint = this.currentPoint.toArray(),
            e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.currentPoint.fromArray(e.currentPoint),
            this
        }
    }]),
    i
}()
  , Shape = function(e) {
    _inherits(i, Path);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).uuid = generateUUID(),
        r.type = "Shape",
        r.holes = [],
        r
    }
    return _createClass2(i, [{
        key: "getPointsHoles",
        value: function(e) {
            for (var t = [], i = 0, r = this.holes.length; i < r; i++)
                t[i] = this.holes[i].getPoints(e);
            return t
        }
    }, {
        key: "extractPoints",
        value: function(e) {
            return {
                shape: this.getPoints(e),
                holes: this.getPointsHoles(e)
            }
        }
    }, {
        key: "copy",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.holes = [];
            for (var t = 0, r = e.holes.length; t < r; t++) {
                var n = e.holes[t];
                this.holes.push(n.clone())
            }
            return this
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            e.uuid = this.uuid,
            e.holes = [];
            for (var t = 0, r = this.holes.length; t < r; t++) {
                var n = this.holes[t];
                e.holes.push(n.toJSON())
            }
            return e
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "fromJSON", this).call(this, e),
            this.uuid = e.uuid,
            this.holes = [];
            for (var t = 0, r = e.holes.length; t < r; t++) {
                var n = e.holes[t];
                this.holes.push((new Path).fromJSON(n))
            }
            return this
        }
    }]),
    i
}()
  , Earcut = {
    triangulate: function(e, t) {
        var i, r, n, a, o, s, l, h = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 2, c = t && t.length, p = c ? t[0] * h : e.length, u = linkedList(e, 0, p, h, !0), d = [];
        if (!u || u.next === u.prev)
            return d;
        if (c && (u = eliminateHoles(e, t, u, h)),
        e.length > 80 * h) {
            i = n = e[0],
            r = a = e[1];
            for (var f = h; f < p; f += h)
                (o = e[f]) < i && (i = o),
                (s = e[f + 1]) < r && (r = s),
                o > n && (n = o),
                s > a && (a = s);
            l = 0 !== (l = Math.max(n - i, a - r)) ? 1 / l : 0
        }
        return earcutLinked(u, d, h, i, r, l),
        d
    }
};
function linkedList(e, t, i, r, n) {
    var a, o;
    if (n === signedArea(e, t, i, r) > 0)
        for (a = t; a < i; a += r)
            o = insertNode(a, e[a], e[a + 1], o);
    else
        for (a = i - r; a >= t; a -= r)
            o = insertNode(a, e[a], e[a + 1], o);
    return o && equals(o, o.next) && (removeNode(o),
    o = o.next),
    o
}
function filterPoints(e, t) {
    if (!e)
        return e;
    t || (t = e);
    var i, r = e;
    do {
        if (i = !1,
        r.steiner || !equals(r, r.next) && 0 !== area(r.prev, r, r.next))
            r = r.next;
        else {
            if (removeNode(r),
            (r = t = r.prev) === r.next)
                break;
            i = !0
        }
    } while (i || r !== t);
    return t
}
function earcutLinked(e, t, i, r, n, a, o) {
    if (e) {
        !o && a && indexCurve(e, r, n, a);
        for (var s, l, h = e; e.prev !== e.next; )
            if (s = e.prev,
            l = e.next,
            a ? isEarHashed(e, r, n, a) : isEar(e))
                t.push(s.i / i),
                t.push(e.i / i),
                t.push(l.i / i),
                removeNode(e),
                e = l.next,
                h = l.next;
            else if ((e = l) === h) {
                o ? 1 === o ? earcutLinked(e = cureLocalIntersections(filterPoints(e), t, i), t, i, r, n, a, 2) : 2 === o && splitEarcut(e, t, i, r, n, a) : earcutLinked(filterPoints(e), t, i, r, n, a, 1);
                break
            }
    }
}
function isEar(e) {
    var t = e.prev
      , i = e
      , r = e.next;
    if (area(t, i, r) >= 0)
        return !1;
    for (var n = e.next.next; n !== e.prev; ) {
        if (pointInTriangle(t.x, t.y, i.x, i.y, r.x, r.y, n.x, n.y) && area(n.prev, n, n.next) >= 0)
            return !1;
        n = n.next
    }
    return !0
}
function isEarHashed(e, t, i, r) {
    var n = e.prev
      , a = e
      , o = e.next;
    if (area(n, a, o) >= 0)
        return !1;
    for (var s = n.x < a.x ? n.x < o.x ? n.x : o.x : a.x < o.x ? a.x : o.x, l = n.y < a.y ? n.y < o.y ? n.y : o.y : a.y < o.y ? a.y : o.y, h = n.x > a.x ? n.x > o.x ? n.x : o.x : a.x > o.x ? a.x : o.x, c = n.y > a.y ? n.y > o.y ? n.y : o.y : a.y > o.y ? a.y : o.y, p = zOrder(s, l, t, i, r), u = zOrder(h, c, t, i, r), d = e.prevZ, f = e.nextZ; d && d.z >= p && f && f.z <= u; ) {
        if (d !== e.prev && d !== e.next && pointInTriangle(n.x, n.y, a.x, a.y, o.x, o.y, d.x, d.y) && area(d.prev, d, d.next) >= 0)
            return !1;
        if (d = d.prevZ,
        f !== e.prev && f !== e.next && pointInTriangle(n.x, n.y, a.x, a.y, o.x, o.y, f.x, f.y) && area(f.prev, f, f.next) >= 0)
            return !1;
        f = f.nextZ
    }
    for (; d && d.z >= p; ) {
        if (d !== e.prev && d !== e.next && pointInTriangle(n.x, n.y, a.x, a.y, o.x, o.y, d.x, d.y) && area(d.prev, d, d.next) >= 0)
            return !1;
        d = d.prevZ
    }
    for (; f && f.z <= u; ) {
        if (f !== e.prev && f !== e.next && pointInTriangle(n.x, n.y, a.x, a.y, o.x, o.y, f.x, f.y) && area(f.prev, f, f.next) >= 0)
            return !1;
        f = f.nextZ
    }
    return !0
}
function cureLocalIntersections(e, t, i) {
    var r = e;
    do {
        var n = r.prev
          , a = r.next.next;
        !equals(n, a) && intersects(n, r, r.next, a) && locallyInside(n, a) && locallyInside(a, n) && (t.push(n.i / i),
        t.push(r.i / i),
        t.push(a.i / i),
        removeNode(r),
        removeNode(r.next),
        r = e = a),
        r = r.next
    } while (r !== e);
    return filterPoints(r)
}
function splitEarcut(e, t, i, r, n, a) {
    var o = e;
    do {
        for (var s = o.next.next; s !== o.prev; ) {
            if (o.i !== s.i && isValidDiagonal(o, s)) {
                var l = splitPolygon(o, s);
                return o = filterPoints(o, o.next),
                l = filterPoints(l, l.next),
                earcutLinked(o, t, i, r, n, a),
                void earcutLinked(l, t, i, r, n, a)
            }
            s = s.next
        }
        o = o.next
    } while (o !== e)
}
function eliminateHoles(e, t, i, r) {
    var n, a, o, s = [];
    for (n = 0,
    a = t.length; n < a; n++)
        (o = linkedList(e, t[n] * r, n < a - 1 ? t[n + 1] * r : e.length, r, !1)) === o.next && (o.steiner = !0),
        s.push(getLeftmost(o));
    for (s.sort(compareX),
    n = 0; n < s.length; n++)
        eliminateHole(s[n], i),
        i = filterPoints(i, i.next);
    return i
}
function compareX(e, t) {
    return e.x - t.x
}
function eliminateHole(e, t) {
    if (t = findHoleBridge(e, t)) {
        var i = splitPolygon(t, e);
        filterPoints(t, t.next),
        filterPoints(i, i.next)
    }
}
function findHoleBridge(e, t) {
    var i, r = t, n = e.x, a = e.y, o = -1 / 0;
    do {
        if (a <= r.y && a >= r.next.y && r.next.y !== r.y) {
            var s = r.x + (a - r.y) * (r.next.x - r.x) / (r.next.y - r.y);
            if (s <= n && s > o) {
                if (o = s,
                s === n) {
                    if (a === r.y)
                        return r;
                    if (a === r.next.y)
                        return r.next
                }
                i = r.x < r.next.x ? r : r.next
            }
        }
        r = r.next
    } while (r !== t);
    if (!i)
        return null;
    if (n === o)
        return i;
    var l, h = i, c = i.x, p = i.y, u = 1 / 0;
    r = i;
    do {
        n >= r.x && r.x >= c && n !== r.x && pointInTriangle(a < p ? n : o, a, c, p, a < p ? o : n, a, r.x, r.y) && (l = Math.abs(a - r.y) / (n - r.x),
        locallyInside(r, e) && (l < u || l === u && (r.x > i.x || r.x === i.x && sectorContainsSector(i, r))) && (i = r,
        u = l)),
        r = r.next
    } while (r !== h);
    return i
}
function sectorContainsSector(e, t) {
    return area(e.prev, e, t.prev) < 0 && area(t.next, e, e.next) < 0
}
function indexCurve(e, t, i, r) {
    var n = e;
    do {
        null === n.z && (n.z = zOrder(n.x, n.y, t, i, r)),
        n.prevZ = n.prev,
        n.nextZ = n.next,
        n = n.next
    } while (n !== e);
    n.prevZ.nextZ = null,
    n.prevZ = null,
    sortLinked(n)
}
function sortLinked(e) {
    var t, i, r, n, a, o, s, l, h = 1;
    do {
        for (i = e,
        e = null,
        a = null,
        o = 0; i; ) {
            for (o++,
            r = i,
            s = 0,
            t = 0; t < h && (s++,
            r = r.nextZ); t++)
                ;
            for (l = h; s > 0 || l > 0 && r; )
                0 !== s && (0 === l || !r || i.z <= r.z) ? (n = i,
                i = i.nextZ,
                s--) : (n = r,
                r = r.nextZ,
                l--),
                a ? a.nextZ = n : e = n,
                n.prevZ = a,
                a = n;
            i = r
        }
        a.nextZ = null,
        h *= 2
    } while (o > 1);
    return e
}
function zOrder(e, t, i, r, n) {
    return (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - i) * n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) | (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) << 1
}
function getLeftmost(e) {
    var t = e
      , i = e;
    do {
        (t.x < i.x || t.x === i.x && t.y < i.y) && (i = t),
        t = t.next
    } while (t !== e);
    return i
}
function pointInTriangle(e, t, i, r, n, a, o, s) {
    return (n - o) * (t - s) - (e - o) * (a - s) >= 0 && (e - o) * (r - s) - (i - o) * (t - s) >= 0 && (i - o) * (a - s) - (n - o) * (r - s) >= 0
}
function isValidDiagonal(e, t) {
    return e.next.i !== t.i && e.prev.i !== t.i && !intersectsPolygon(e, t) && (locallyInside(e, t) && locallyInside(t, e) && middleInside(e, t) && (area(e.prev, e, t.prev) || area(e, t.prev, t)) || equals(e, t) && area(e.prev, e, e.next) > 0 && area(t.prev, t, t.next) > 0)
}
function area(e, t, i) {
    return (t.y - e.y) * (i.x - t.x) - (t.x - e.x) * (i.y - t.y)
}
function equals(e, t) {
    return e.x === t.x && e.y === t.y
}
function intersects(e, t, i, r) {
    var n = sign(area(e, t, i))
      , a = sign(area(e, t, r))
      , o = sign(area(i, r, e))
      , s = sign(area(i, r, t));
    return n !== a && o !== s || !(0 !== n || !onSegment(e, i, t)) || !(0 !== a || !onSegment(e, r, t)) || !(0 !== o || !onSegment(i, e, r)) || !(0 !== s || !onSegment(i, t, r))
}
function onSegment(e, t, i) {
    return t.x <= Math.max(e.x, i.x) && t.x >= Math.min(e.x, i.x) && t.y <= Math.max(e.y, i.y) && t.y >= Math.min(e.y, i.y)
}
function sign(e) {
    return e > 0 ? 1 : e < 0 ? -1 : 0
}
function intersectsPolygon(e, t) {
    var i = e;
    do {
        if (i.i !== e.i && i.next.i !== e.i && i.i !== t.i && i.next.i !== t.i && intersects(i, i.next, e, t))
            return !0;
        i = i.next
    } while (i !== e);
    return !1
}
function locallyInside(e, t) {
    return area(e.prev, e, e.next) < 0 ? area(e, t, e.next) >= 0 && area(e, e.prev, t) >= 0 : area(e, t, e.prev) < 0 || area(e, e.next, t) < 0
}
function middleInside(e, t) {
    var i = e
      , r = !1
      , n = (e.x + t.x) / 2
      , a = (e.y + t.y) / 2;
    do {
        i.y > a != i.next.y > a && i.next.y !== i.y && n < (i.next.x - i.x) * (a - i.y) / (i.next.y - i.y) + i.x && (r = !r),
        i = i.next
    } while (i !== e);
    return r
}
function splitPolygon(e, t) {
    var i = new Node$1(e.i,e.x,e.y)
      , r = new Node$1(t.i,t.x,t.y)
      , n = e.next
      , a = t.prev;
    return e.next = t,
    t.prev = e,
    i.next = n,
    n.prev = i,
    r.next = i,
    i.prev = r,
    a.next = r,
    r.prev = a,
    r
}
function insertNode(e, t, i, r) {
    var n = new Node$1(e,t,i);
    return r ? (n.next = r.next,
    n.prev = r,
    r.next.prev = n,
    r.next = n) : (n.prev = n,
    n.next = n),
    n
}
function removeNode(e) {
    e.next.prev = e.prev,
    e.prev.next = e.next,
    e.prevZ && (e.prevZ.nextZ = e.nextZ),
    e.nextZ && (e.nextZ.prevZ = e.prevZ)
}
function Node$1(e, t, i) {
    this.i = e,
    this.x = t,
    this.y = i,
    this.prev = null,
    this.next = null,
    this.z = null,
    this.prevZ = null,
    this.nextZ = null,
    this.steiner = !1
}
function signedArea(e, t, i, r) {
    for (var n = 0, a = t, o = i - r; a < i; a += r)
        n += (e[o] - e[a]) * (e[a + 1] + e[o + 1]),
        o = a;
    return n
}
var ShapeUtils = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, null, [{
        key: "area",
        value: function(e) {
            for (var t = e.length, i = 0, r = t - 1, n = 0; n < t; r = n++)
                i += e[r].x * e[n].y - e[n].x * e[r].y;
            return .5 * i
        }
    }, {
        key: "isClockWise",
        value: function(t) {
            return e.area(t) < 0
        }
    }, {
        key: "triangulateShape",
        value: function(e, t) {
            var i = []
              , r = []
              , n = [];
            removeDupEndPts(e),
            addContour(i, e);
            var a = e.length;
            t.forEach(removeDupEndPts);
            for (var o = 0; o < t.length; o++)
                r.push(a),
                a += t[o].length,
                addContour(i, t[o]);
            for (var s = Earcut.triangulate(i, r), l = 0; l < s.length; l += 3)
                n.push(s.slice(l, l + 3));
            return n
        }
    }]),
    e
}();
function removeDupEndPts(e) {
    var t = e.length;
    t > 2 && e[t - 1].equals(e[0]) && e.pop()
}
function addContour(e, t) {
    for (var i = 0; i < t.length; i++)
        e.push(t[i].x),
        e.push(t[i].y)
}
var ExtrudeGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Shape([new Vector2(.5,.5), new Vector2(-.5,.5), new Vector2(-.5,-.5), new Vector2(.5,-.5)]), n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "ExtrudeGeometry",
        e.parameters = {
            shapes: r,
            options: n
        },
        r = Array.isArray(r) ? r : [r];
        for (var a = _assertThisInitialized(e), o = [], s = [], l = 0, h = r.length; l < h; l++) {
            var c = r[l];
            p(c)
        }
        function p(e) {
            var t = []
              , i = void 0 !== n.curveSegments ? n.curveSegments : 12
              , r = void 0 !== n.steps ? n.steps : 1
              , l = void 0 !== n.depth ? n.depth : 1
              , h = void 0 === n.bevelEnabled || n.bevelEnabled
              , c = void 0 !== n.bevelThickness ? n.bevelThickness : .2
              , p = void 0 !== n.bevelSize ? n.bevelSize : c - .1
              , u = void 0 !== n.bevelOffset ? n.bevelOffset : 0
              , d = void 0 !== n.bevelSegments ? n.bevelSegments : 3
              , f = n.extrudePath
              , m = void 0 !== n.UVGenerator ? n.UVGenerator : WorldUVGenerator;
            void 0 !== n.amount && (console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),
            l = n.amount);
            var g, v, y, _, b, x = !1;
            f && (g = f.getSpacedPoints(r),
            x = !0,
            h = !1,
            v = f.computeFrenetFrames(r, !1),
            y = new Vector3,
            _ = new Vector3,
            b = new Vector3),
            h || (d = 0,
            c = 0,
            p = 0,
            u = 0);
            var w = e.extractPoints(i)
              , S = w.shape
              , T = w.holes;
            if (!ShapeUtils.isClockWise(S)) {
                S = S.reverse();
                for (var k = 0, E = T.length; k < E; k++) {
                    var M = T[k];
                    ShapeUtils.isClockWise(M) && (T[k] = M.reverse())
                }
            }
            for (var P = ShapeUtils.triangulateShape(S, T), C = S, A = 0, L = T.length; A < L; A++) {
                var D = T[A];
                S = S.concat(D)
            }
            function I(e, t, i) {
                return t || console.error("THREE.ExtrudeGeometry: vec does not exist"),
                t.clone().multiplyScalar(i).add(e)
            }
            var R = S.length
              , F = P.length;
            function B(e, t, i) {
                var r, n, a, o = e.x - t.x, s = e.y - t.y, l = i.x - e.x, h = i.y - e.y, c = o * o + s * s, p = o * h - s * l;
                if (Math.abs(p) > Number.EPSILON) {
                    var u = Math.sqrt(c)
                      , d = Math.sqrt(l * l + h * h)
                      , f = t.x - s / u
                      , m = t.y + o / u
                      , g = ((i.x - h / d - f) * h - (i.y + l / d - m) * l) / (o * h - s * l)
                      , v = (r = f + o * g - e.x) * r + (n = m + s * g - e.y) * n;
                    if (v <= 2)
                        return new Vector2(r,n);
                    a = Math.sqrt(v / 2)
                } else {
                    var y = !1;
                    o > Number.EPSILON ? l > Number.EPSILON && (y = !0) : o < -Number.EPSILON ? l < -Number.EPSILON && (y = !0) : Math.sign(s) === Math.sign(h) && (y = !0),
                    y ? (r = -s,
                    n = o,
                    a = Math.sqrt(c)) : (r = o,
                    n = s,
                    a = Math.sqrt(c / 2))
                }
                return new Vector2(r / a,n / a)
            }
            for (var O = [], N = 0, V = C.length, z = V - 1, G = N + 1; N < V; N++,
            z++,
            G++)
                z === V && (z = 0),
                G === V && (G = 0),
                O[N] = B(C[N], C[z], C[G]);
            for (var H, U = [], W = O.concat(), j = 0, $ = T.length; j < $; j++) {
                var q = T[j];
                H = [];
                for (var X = 0, Y = q.length, K = Y - 1, Z = X + 1; X < Y; X++,
                K++,
                Z++)
                    K === Y && (K = 0),
                    Z === Y && (Z = 0),
                    H[X] = B(q[X], q[K], q[Z]);
                U.push(H),
                W = W.concat(H)
            }
            for (var J = 0; J < d; J++) {
                for (var Q = J / d, ee = c * Math.cos(Q * Math.PI / 2), te = p * Math.sin(Q * Math.PI / 2) + u, ie = 0, re = C.length; ie < re; ie++) {
                    var ne = I(C[ie], O[ie], te);
                    Le(ne.x, ne.y, -ee)
                }
                for (var ae = 0, oe = T.length; ae < oe; ae++) {
                    var se = T[ae];
                    H = U[ae];
                    for (var le = 0, he = se.length; le < he; le++) {
                        var ce = I(se[le], H[le], te);
                        Le(ce.x, ce.y, -ee)
                    }
                }
            }
            for (var pe = p + u, ue = 0; ue < R; ue++) {
                var de = h ? I(S[ue], W[ue], pe) : S[ue];
                x ? (_.copy(v.normals[0]).multiplyScalar(de.x),
                y.copy(v.binormals[0]).multiplyScalar(de.y),
                b.copy(g[0]).add(_).add(y),
                Le(b.x, b.y, b.z)) : Le(de.x, de.y, 0)
            }
            for (var fe = 1; fe <= r; fe++)
                for (var me = 0; me < R; me++) {
                    var ge = h ? I(S[me], W[me], pe) : S[me];
                    x ? (_.copy(v.normals[fe]).multiplyScalar(ge.x),
                    y.copy(v.binormals[fe]).multiplyScalar(ge.y),
                    b.copy(g[fe]).add(_).add(y),
                    Le(b.x, b.y, b.z)) : Le(ge.x, ge.y, l / r * fe)
                }
            for (var ve = d - 1; ve >= 0; ve--) {
                for (var ye = ve / d, _e = c * Math.cos(ye * Math.PI / 2), be = p * Math.sin(ye * Math.PI / 2) + u, xe = 0, we = C.length; xe < we; xe++) {
                    var Se = I(C[xe], O[xe], be);
                    Le(Se.x, Se.y, l + _e)
                }
                for (var Te = 0, ke = T.length; Te < ke; Te++) {
                    var Ee = T[Te];
                    H = U[Te];
                    for (var Me = 0, Pe = Ee.length; Me < Pe; Me++) {
                        var Ce = I(Ee[Me], H[Me], be);
                        x ? Le(Ce.x, Ce.y + g[r - 1].y, g[r - 1].x + _e) : Le(Ce.x, Ce.y, l + _e)
                    }
                }
            }
            function Ae(e, t) {
                for (var i = e.length; --i >= 0; ) {
                    var n = i
                      , a = i - 1;
                    a < 0 && (a = e.length - 1);
                    for (var o = 0, s = r + 2 * d; o < s; o++) {
                        var l = R * o
                          , h = R * (o + 1);
                        Ie(t + n + l, t + a + l, t + a + h, t + n + h)
                    }
                }
            }
            function Le(e, i, r) {
                t.push(e),
                t.push(i),
                t.push(r)
            }
            function De(e, t, i) {
                Re(e),
                Re(t),
                Re(i);
                var r = o.length / 3
                  , n = m.generateTopUV(a, o, r - 3, r - 2, r - 1);
                Fe(n[0]),
                Fe(n[1]),
                Fe(n[2])
            }
            function Ie(e, t, i, r) {
                Re(e),
                Re(t),
                Re(r),
                Re(t),
                Re(i),
                Re(r);
                var n = o.length / 3
                  , s = m.generateSideWallUV(a, o, n - 6, n - 3, n - 2, n - 1);
                Fe(s[0]),
                Fe(s[1]),
                Fe(s[3]),
                Fe(s[1]),
                Fe(s[2]),
                Fe(s[3])
            }
            function Re(e) {
                o.push(t[3 * e + 0]),
                o.push(t[3 * e + 1]),
                o.push(t[3 * e + 2])
            }
            function Fe(e) {
                s.push(e.x),
                s.push(e.y)
            }
            !function() {
                var e = o.length / 3;
                if (h) {
                    for (var t = 0, i = R * t, n = 0; n < F; n++) {
                        var s = P[n];
                        De(s[2] + i, s[1] + i, s[0] + i)
                    }
                    i = R * (t = r + 2 * d);
                    for (var l = 0; l < F; l++) {
                        var c = P[l];
                        De(c[0] + i, c[1] + i, c[2] + i)
                    }
                } else {
                    for (var p = 0; p < F; p++) {
                        var u = P[p];
                        De(u[2], u[1], u[0])
                    }
                    for (var f = 0; f < F; f++) {
                        var m = P[f];
                        De(m[0] + R * r, m[1] + R * r, m[2] + R * r)
                    }
                }
                a.addGroup(e, o.length / 3 - e, 0)
            }(),
            function() {
                var e = o.length / 3
                  , t = 0;
                Ae(C, t),
                t += C.length;
                for (var i = 0, r = T.length; i < r; i++) {
                    var n = T[i];
                    Ae(n, t),
                    t += n.length
                }
                a.addGroup(e, o.length / 3 - e, 1)
            }()
        }
        return e.setAttribute("position", new Float32BufferAttribute(o,3)),
        e.setAttribute("uv", new Float32BufferAttribute(s,2)),
        e.computeVertexNormals(),
        e
    }
    return _createClass2(i, [{
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return toJSON$1(this.parameters.shapes, this.parameters.options, e)
        }
    }], [{
        key: "fromJSON",
        value: function(e, t) {
            for (var r = [], n = 0, a = e.shapes.length; n < a; n++) {
                var o = t[e.shapes[n]];
                r.push(o)
            }
            var s = e.options.extrudePath;
            return void 0 !== s && (e.options.extrudePath = (new Curves[s.type]).fromJSON(s)),
            new i(r,e.options)
        }
    }]),
    i
}()
  , WorldUVGenerator = {
    generateTopUV: function(e, t, i, r, n) {
        var a = t[3 * i]
          , o = t[3 * i + 1]
          , s = t[3 * r]
          , l = t[3 * r + 1]
          , h = t[3 * n]
          , c = t[3 * n + 1];
        return [new Vector2(a,o), new Vector2(s,l), new Vector2(h,c)]
    },
    generateSideWallUV: function(e, t, i, r, n, a) {
        var o = t[3 * i]
          , s = t[3 * i + 1]
          , l = t[3 * i + 2]
          , h = t[3 * r]
          , c = t[3 * r + 1]
          , p = t[3 * r + 2]
          , u = t[3 * n]
          , d = t[3 * n + 1]
          , f = t[3 * n + 2]
          , m = t[3 * a]
          , g = t[3 * a + 1]
          , v = t[3 * a + 2];
        return Math.abs(s - c) < Math.abs(o - h) ? [new Vector2(o,1 - l), new Vector2(h,1 - p), new Vector2(u,1 - f), new Vector2(m,1 - v)] : [new Vector2(s,1 - l), new Vector2(c,1 - p), new Vector2(d,1 - f), new Vector2(g,1 - v)]
    }
};
function toJSON$1(e, t, i) {
    if (i.shapes = [],
    Array.isArray(e))
        for (var r = 0, n = e.length; r < n; r++) {
            var a = e[r];
            i.shapes.push(a.uuid)
        }
    else
        i.shapes.push(e.uuid);
    return void 0 !== t.extrudePath && (i.options.extrudePath = t.extrudePath.toJSON()),
    i
}
var ShapeGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Shape([new Vector2(0,.5), new Vector2(-.5,-.5), new Vector2(.5,-.5)]), n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 12;
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "ShapeGeometry",
        e.parameters = {
            shapes: r,
            curveSegments: n
        };
        var a = []
          , o = []
          , s = []
          , l = []
          , h = 0
          , c = 0;
        if (!1 === Array.isArray(r))
            u(r);
        else
            for (var p = 0; p < r.length; p++)
                u(r[p]),
                e.addGroup(h, c, p),
                h += c,
                c = 0;
        function u(e) {
            var t = o.length / 3
              , i = e.extractPoints(n)
              , r = i.shape
              , h = i.holes;
            !1 === ShapeUtils.isClockWise(r) && (r = r.reverse());
            for (var p = 0, u = h.length; p < u; p++) {
                var d = h[p];
                !0 === ShapeUtils.isClockWise(d) && (h[p] = d.reverse())
            }
            for (var f = ShapeUtils.triangulateShape(r, h), m = 0, g = h.length; m < g; m++) {
                var v = h[m];
                r = r.concat(v)
            }
            for (var y = 0, _ = r.length; y < _; y++) {
                var b = r[y];
                o.push(b.x, b.y, 0),
                s.push(0, 0, 1),
                l.push(b.x, b.y)
            }
            for (var x = 0, w = f.length; x < w; x++) {
                var S = f[x]
                  , T = S[0] + t
                  , k = S[1] + t
                  , E = S[2] + t;
                a.push(T, k, E),
                c += 3
            }
        }
        return e.setIndex(a),
        e.setAttribute("position", new Float32BufferAttribute(o,3)),
        e.setAttribute("normal", new Float32BufferAttribute(s,3)),
        e.setAttribute("uv", new Float32BufferAttribute(l,2)),
        e
    }
    return _createClass2(i, [{
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this);
            return _toJSON(this.parameters.shapes, e)
        }
    }], [{
        key: "fromJSON",
        value: function(e, t) {
            for (var r = [], n = 0, a = e.shapes.length; n < a; n++) {
                var o = t[e.shapes[n]];
                r.push(o)
            }
            return new i(r,e.curveSegments)
        }
    }]),
    i
}();
function _toJSON(e, t) {
    if (t.shapes = [],
    Array.isArray(e))
        for (var i = 0, r = e.length; i < r; i++) {
            var n = e[i];
            t.shapes.push(n.uuid)
        }
    else
        t.shapes.push(e.uuid);
    return t
}
var SphereGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 32, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 16, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 2 * Math.PI, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0, h = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : Math.PI;
        _classCallCheck2(this, i),
        (e = t.call(this)).type = "SphereGeometry",
        e.parameters = {
            radius: r,
            widthSegments: n,
            heightSegments: a,
            phiStart: o,
            phiLength: s,
            thetaStart: l,
            thetaLength: h
        },
        n = Math.max(3, Math.floor(n)),
        a = Math.max(2, Math.floor(a));
        for (var c = Math.min(l + h, Math.PI), p = 0, u = [], d = new Vector3, f = new Vector3, m = [], g = [], v = [], y = [], _ = 0; _ <= a; _++) {
            var b = []
              , x = _ / a
              , w = 0;
            0 == _ && 0 == l ? w = .5 / n : _ == a && c == Math.PI && (w = -.5 / n);
            for (var S = 0; S <= n; S++) {
                var T = S / n;
                d.x = -r * Math.cos(o + T * s) * Math.sin(l + x * h),
                d.y = r * Math.cos(l + x * h),
                d.z = r * Math.sin(o + T * s) * Math.sin(l + x * h),
                g.push(d.x, d.y, d.z),
                f.copy(d).normalize(),
                v.push(f.x, f.y, f.z),
                y.push(T + w, 1 - x),
                b.push(p++)
            }
            u.push(b)
        }
        for (var k = 0; k < a; k++)
            for (var E = 0; E < n; E++) {
                var M = u[k][E + 1]
                  , P = u[k][E]
                  , C = u[k + 1][E]
                  , A = u[k + 1][E + 1];
                (0 !== k || l > 0) && m.push(M, P, A),
                (k !== a - 1 || c < Math.PI) && m.push(P, C, A)
            }
        return e.setIndex(m),
        e.setAttribute("position", new Float32BufferAttribute(g,3)),
        e.setAttribute("normal", new Float32BufferAttribute(v,3)),
        e.setAttribute("uv", new Float32BufferAttribute(y,2)),
        e
    }
    return _createClass2(i, null, [{
        key: "fromJSON",
        value: function(e) {
            return new i(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)
        }
    }]),
    i
}()
  , ShadowMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "ShadowMaterial",
        r.color = new Color(0),
        r.transparent = !0,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this
        }
    }]),
    i
}();
ShadowMaterial.prototype.isShadowMaterial = !0;
var MeshStandardMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).defines = {
            STANDARD: ""
        },
        r.type = "MeshStandardMaterial",
        r.color = new Color(16777215),
        r.roughness = 1,
        r.metalness = 0,
        r.map = null,
        r.lightMap = null,
        r.lightMapIntensity = 1,
        r.aoMap = null,
        r.aoMapIntensity = 1,
        r.emissive = new Color(0),
        r.emissiveIntensity = 1,
        r.emissiveMap = null,
        r.bumpMap = null,
        r.bumpScale = 1,
        r.normalMap = null,
        r.normalMapType = TangentSpaceNormalMap,
        r.normalScale = new Vector2(1,1),
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.roughnessMap = null,
        r.metalnessMap = null,
        r.alphaMap = null,
        r.envMap = null,
        r.envMapIntensity = 1,
        r.refractionRatio = .98,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.wireframeLinecap = "round",
        r.wireframeLinejoin = "round",
        r.flatShading = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.defines = {
                STANDARD: ""
            },
            this.color.copy(e.color),
            this.roughness = e.roughness,
            this.metalness = e.metalness,
            this.map = e.map,
            this.lightMap = e.lightMap,
            this.lightMapIntensity = e.lightMapIntensity,
            this.aoMap = e.aoMap,
            this.aoMapIntensity = e.aoMapIntensity,
            this.emissive.copy(e.emissive),
            this.emissiveMap = e.emissiveMap,
            this.emissiveIntensity = e.emissiveIntensity,
            this.bumpMap = e.bumpMap,
            this.bumpScale = e.bumpScale,
            this.normalMap = e.normalMap,
            this.normalMapType = e.normalMapType,
            this.normalScale.copy(e.normalScale),
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.roughnessMap = e.roughnessMap,
            this.metalnessMap = e.metalnessMap,
            this.alphaMap = e.alphaMap,
            this.envMap = e.envMap,
            this.envMapIntensity = e.envMapIntensity,
            this.refractionRatio = e.refractionRatio,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.wireframeLinecap = e.wireframeLinecap,
            this.wireframeLinejoin = e.wireframeLinejoin,
            this.flatShading = e.flatShading,
            this
        }
    }]),
    i
}();
MeshStandardMaterial.prototype.isMeshStandardMaterial = !0;
var MeshPhysicalMaterial = function(e) {
    _inherits(i, MeshStandardMaterial);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).defines = {
            STANDARD: "",
            PHYSICAL: ""
        },
        r.type = "MeshPhysicalMaterial",
        r.clearcoatMap = null,
        r.clearcoatRoughness = 0,
        r.clearcoatRoughnessMap = null,
        r.clearcoatNormalScale = new Vector2(1,1),
        r.clearcoatNormalMap = null,
        r.ior = 1.5,
        Object.defineProperty(_assertThisInitialized(r), "reflectivity", {
            get: function() {
                return clamp(2.5 * (this.ior - 1) / (this.ior + 1), 0, 1)
            },
            set: function(e) {
                this.ior = (1 + .4 * e) / (1 - .4 * e)
            }
        }),
        r.sheenTint = new Color(0),
        r.sheenRoughness = 1,
        r.transmissionMap = null,
        r.thickness = .01,
        r.thicknessMap = null,
        r.attenuationDistance = 0,
        r.attenuationTint = new Color(1,1,1),
        r.specularIntensity = 1,
        r.specularIntensityMap = null,
        r.specularTint = new Color(1,1,1),
        r.specularTintMap = null,
        r._sheen = 0,
        r._clearcoat = 0,
        r._transmission = 0,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "sheen",
        get: function() {
            return this._sheen
        },
        set: function(e) {
            this._sheen > 0 != e > 0 && this.version++,
            this._sheen = e
        }
    }, {
        key: "clearcoat",
        get: function() {
            return this._clearcoat
        },
        set: function(e) {
            this._clearcoat > 0 != e > 0 && this.version++,
            this._clearcoat = e
        }
    }, {
        key: "transmission",
        get: function() {
            return this._transmission
        },
        set: function(e) {
            this._transmission > 0 != e > 0 && this.version++,
            this._transmission = e
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.defines = {
                STANDARD: "",
                PHYSICAL: ""
            },
            this.clearcoat = e.clearcoat,
            this.clearcoatMap = e.clearcoatMap,
            this.clearcoatRoughness = e.clearcoatRoughness,
            this.clearcoatRoughnessMap = e.clearcoatRoughnessMap,
            this.clearcoatNormalMap = e.clearcoatNormalMap,
            this.clearcoatNormalScale.copy(e.clearcoatNormalScale),
            this.ior = e.ior,
            this.sheen = e.sheen,
            this.sheenTint.copy(e.sheenTint),
            this.sheenRoughness = e.sheenRoughness,
            this.transmission = e.transmission,
            this.transmissionMap = e.transmissionMap,
            this.thickness = e.thickness,
            this.thicknessMap = e.thicknessMap,
            this.attenuationDistance = e.attenuationDistance,
            this.attenuationTint.copy(e.attenuationTint),
            this.specularIntensity = e.specularIntensity,
            this.specularIntensityMap = e.specularIntensityMap,
            this.specularTint.copy(e.specularTint),
            this.specularTintMap = e.specularTintMap,
            this
        }
    }]),
    i
}();
MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = !0;
var MeshPhongMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshPhongMaterial",
        r.color = new Color(16777215),
        r.specular = new Color(1118481),
        r.shininess = 30,
        r.map = null,
        r.lightMap = null,
        r.lightMapIntensity = 1,
        r.aoMap = null,
        r.aoMapIntensity = 1,
        r.emissive = new Color(0),
        r.emissiveIntensity = 1,
        r.emissiveMap = null,
        r.bumpMap = null,
        r.bumpScale = 1,
        r.normalMap = null,
        r.normalMapType = TangentSpaceNormalMap,
        r.normalScale = new Vector2(1,1),
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.specularMap = null,
        r.alphaMap = null,
        r.envMap = null,
        r.combine = MultiplyOperation,
        r.reflectivity = 1,
        r.refractionRatio = .98,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.wireframeLinecap = "round",
        r.wireframeLinejoin = "round",
        r.flatShading = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.specular.copy(e.specular),
            this.shininess = e.shininess,
            this.map = e.map,
            this.lightMap = e.lightMap,
            this.lightMapIntensity = e.lightMapIntensity,
            this.aoMap = e.aoMap,
            this.aoMapIntensity = e.aoMapIntensity,
            this.emissive.copy(e.emissive),
            this.emissiveMap = e.emissiveMap,
            this.emissiveIntensity = e.emissiveIntensity,
            this.bumpMap = e.bumpMap,
            this.bumpScale = e.bumpScale,
            this.normalMap = e.normalMap,
            this.normalMapType = e.normalMapType,
            this.normalScale.copy(e.normalScale),
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.specularMap = e.specularMap,
            this.alphaMap = e.alphaMap,
            this.envMap = e.envMap,
            this.combine = e.combine,
            this.reflectivity = e.reflectivity,
            this.refractionRatio = e.refractionRatio,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.wireframeLinecap = e.wireframeLinecap,
            this.wireframeLinejoin = e.wireframeLinejoin,
            this.flatShading = e.flatShading,
            this
        }
    }]),
    i
}();
MeshPhongMaterial.prototype.isMeshPhongMaterial = !0;
var MeshToonMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).defines = {
            TOON: ""
        },
        r.type = "MeshToonMaterial",
        r.color = new Color(16777215),
        r.map = null,
        r.gradientMap = null,
        r.lightMap = null,
        r.lightMapIntensity = 1,
        r.aoMap = null,
        r.aoMapIntensity = 1,
        r.emissive = new Color(0),
        r.emissiveIntensity = 1,
        r.emissiveMap = null,
        r.bumpMap = null,
        r.bumpScale = 1,
        r.normalMap = null,
        r.normalMapType = TangentSpaceNormalMap,
        r.normalScale = new Vector2(1,1),
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.alphaMap = null,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.wireframeLinecap = "round",
        r.wireframeLinejoin = "round",
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.map = e.map,
            this.gradientMap = e.gradientMap,
            this.lightMap = e.lightMap,
            this.lightMapIntensity = e.lightMapIntensity,
            this.aoMap = e.aoMap,
            this.aoMapIntensity = e.aoMapIntensity,
            this.emissive.copy(e.emissive),
            this.emissiveMap = e.emissiveMap,
            this.emissiveIntensity = e.emissiveIntensity,
            this.bumpMap = e.bumpMap,
            this.bumpScale = e.bumpScale,
            this.normalMap = e.normalMap,
            this.normalMapType = e.normalMapType,
            this.normalScale.copy(e.normalScale),
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.alphaMap = e.alphaMap,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.wireframeLinecap = e.wireframeLinecap,
            this.wireframeLinejoin = e.wireframeLinejoin,
            this
        }
    }]),
    i
}();
MeshToonMaterial.prototype.isMeshToonMaterial = !0;
var MeshNormalMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshNormalMaterial",
        r.bumpMap = null,
        r.bumpScale = 1,
        r.normalMap = null,
        r.normalMapType = TangentSpaceNormalMap,
        r.normalScale = new Vector2(1,1),
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.fog = !1,
        r.flatShading = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.bumpMap = e.bumpMap,
            this.bumpScale = e.bumpScale,
            this.normalMap = e.normalMap,
            this.normalMapType = e.normalMapType,
            this.normalScale.copy(e.normalScale),
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.flatShading = e.flatShading,
            this
        }
    }]),
    i
}();
MeshNormalMaterial.prototype.isMeshNormalMaterial = !0;
var MeshLambertMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "MeshLambertMaterial",
        r.color = new Color(16777215),
        r.map = null,
        r.lightMap = null,
        r.lightMapIntensity = 1,
        r.aoMap = null,
        r.aoMapIntensity = 1,
        r.emissive = new Color(0),
        r.emissiveIntensity = 1,
        r.emissiveMap = null,
        r.specularMap = null,
        r.alphaMap = null,
        r.envMap = null,
        r.combine = MultiplyOperation,
        r.reflectivity = 1,
        r.refractionRatio = .98,
        r.wireframe = !1,
        r.wireframeLinewidth = 1,
        r.wireframeLinecap = "round",
        r.wireframeLinejoin = "round",
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.map = e.map,
            this.lightMap = e.lightMap,
            this.lightMapIntensity = e.lightMapIntensity,
            this.aoMap = e.aoMap,
            this.aoMapIntensity = e.aoMapIntensity,
            this.emissive.copy(e.emissive),
            this.emissiveMap = e.emissiveMap,
            this.emissiveIntensity = e.emissiveIntensity,
            this.specularMap = e.specularMap,
            this.alphaMap = e.alphaMap,
            this.envMap = e.envMap,
            this.combine = e.combine,
            this.reflectivity = e.reflectivity,
            this.refractionRatio = e.refractionRatio,
            this.wireframe = e.wireframe,
            this.wireframeLinewidth = e.wireframeLinewidth,
            this.wireframeLinecap = e.wireframeLinecap,
            this.wireframeLinejoin = e.wireframeLinejoin,
            this
        }
    }]),
    i
}();
MeshLambertMaterial.prototype.isMeshLambertMaterial = !0;
var MeshMatcapMaterial = function(e) {
    _inherits(i, Material);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).defines = {
            MATCAP: ""
        },
        r.type = "MeshMatcapMaterial",
        r.color = new Color(16777215),
        r.matcap = null,
        r.map = null,
        r.bumpMap = null,
        r.bumpScale = 1,
        r.normalMap = null,
        r.normalMapType = TangentSpaceNormalMap,
        r.normalScale = new Vector2(1,1),
        r.displacementMap = null,
        r.displacementScale = 1,
        r.displacementBias = 0,
        r.alphaMap = null,
        r.flatShading = !1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.defines = {
                MATCAP: ""
            },
            this.color.copy(e.color),
            this.matcap = e.matcap,
            this.map = e.map,
            this.bumpMap = e.bumpMap,
            this.bumpScale = e.bumpScale,
            this.normalMap = e.normalMap,
            this.normalMapType = e.normalMapType,
            this.normalScale.copy(e.normalScale),
            this.displacementMap = e.displacementMap,
            this.displacementScale = e.displacementScale,
            this.displacementBias = e.displacementBias,
            this.alphaMap = e.alphaMap,
            this.flatShading = e.flatShading,
            this
        }
    }]),
    i
}();
MeshMatcapMaterial.prototype.isMeshMatcapMaterial = !0;
var LineDashedMaterial = function(e) {
    _inherits(i, LineBasicMaterial);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "LineDashedMaterial",
        r.scale = 1,
        r.dashSize = 3,
        r.gapSize = 1,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.scale = e.scale,
            this.dashSize = e.dashSize,
            this.gapSize = e.gapSize,
            this
        }
    }]),
    i
}();
LineDashedMaterial.prototype.isLineDashedMaterial = !0;
var AnimationUtils = {
    arraySlice: function(e, t, i) {
        return AnimationUtils.isTypedArray(e) ? new e.constructor(e.subarray(t, void 0 !== i ? i : e.length)) : e.slice(t, i)
    },
    convertArray: function(e, t, i) {
        return !e || !i && e.constructor === t ? e : "number" == typeof t.BYTES_PER_ELEMENT ? new t(e) : Array.prototype.slice.call(e)
    },
    isTypedArray: function(e) {
        return ArrayBuffer.isView(e) && !(e instanceof DataView)
    },
    getKeyframeOrder: function(e) {
        for (var t = e.length, i = new Array(t), r = 0; r !== t; ++r)
            i[r] = r;
        return i.sort((function(t, i) {
            return e[t] - e[i]
        }
        )),
        i
    },
    sortedArray: function(e, t, i) {
        for (var r = e.length, n = new e.constructor(r), a = 0, o = 0; o !== r; ++a)
            for (var s = i[a] * t, l = 0; l !== t; ++l)
                n[o++] = e[s + l];
        return n
    },
    flattenJSON: function(e, t, i, r) {
        for (var n = 1, a = e[0]; void 0 !== a && void 0 === a[r]; )
            a = e[n++];
        if (void 0 !== a) {
            var o = a[r];
            if (void 0 !== o)
                if (Array.isArray(o))
                    do {
                        void 0 !== (o = a[r]) && (t.push(a.time),
                        i.push.apply(i, o)),
                        a = e[n++]
                    } while (void 0 !== a);
                else if (void 0 !== o.toArray)
                    do {
                        void 0 !== (o = a[r]) && (t.push(a.time),
                        o.toArray(i, i.length)),
                        a = e[n++]
                    } while (void 0 !== a);
                else
                    do {
                        void 0 !== (o = a[r]) && (t.push(a.time),
                        i.push(o)),
                        a = e[n++]
                    } while (void 0 !== a)
        }
    },
    subclip: function(e, t, i, r) {
        var n = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 30
          , a = e.clone();
        a.name = t;
        for (var o = [], s = 0; s < a.tracks.length; ++s) {
            for (var l = a.tracks[s], h = l.getValueSize(), c = [], p = [], u = 0; u < l.times.length; ++u) {
                var d = l.times[u] * n;
                if (!(d < i || d >= r)) {
                    c.push(l.times[u]);
                    for (var f = 0; f < h; ++f)
                        p.push(l.values[u * h + f])
                }
            }
            0 !== c.length && (l.times = AnimationUtils.convertArray(c, l.times.constructor),
            l.values = AnimationUtils.convertArray(p, l.values.constructor),
            o.push(l))
        }
        a.tracks = o;
        for (var m = 1 / 0, g = 0; g < a.tracks.length; ++g)
            m > a.tracks[g].times[0] && (m = a.tracks[g].times[0]);
        for (var v = 0; v < a.tracks.length; ++v)
            a.tracks[v].shift(-1 * m);
        return a.resetDuration(),
        a
    },
    makeClipAdditive: function(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : e
          , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 30;
        r <= 0 && (r = 30);
        for (var n = i.tracks.length, a = t / r, o = function(t) {
            var r = i.tracks[t]
              , n = r.ValueTypeName;
            if ("bool" === n || "string" === n)
                return "continue";
            var o = e.tracks.find((function(e) {
                return e.name === r.name && e.ValueTypeName === n
            }
            ));
            if (void 0 === o)
                return "continue";
            var s = 0
              , l = r.getValueSize();
            r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline && (s = l / 3);
            var h = 0
              , c = o.getValueSize();
            o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline && (h = c / 3);
            var p = r.times.length - 1
              , u = void 0;
            if (a <= r.times[0]) {
                var d = s
                  , f = l - s;
                u = AnimationUtils.arraySlice(r.values, d, f)
            } else if (a >= r.times[p]) {
                var m = p * l + s
                  , g = m + l - s;
                u = AnimationUtils.arraySlice(r.values, m, g)
            } else {
                var v = r.createInterpolant()
                  , y = s
                  , _ = l - s;
                v.evaluate(a),
                u = AnimationUtils.arraySlice(v.resultBuffer, y, _)
            }
            "quaternion" === n && (new Quaternion).fromArray(u).normalize().conjugate().toArray(u);
            for (var b = o.times.length, x = 0; x < b; ++x) {
                var w = x * c + h;
                if ("quaternion" === n)
                    Quaternion.multiplyQuaternionsFlat(o.values, w, u, 0, o.values, w);
                else
                    for (var S = c - 2 * h, T = 0; T < S; ++T)
                        o.values[w + T] -= u[T]
            }
        }, s = 0; s < n; ++s)
            o(s);
        return e.blendMode = AdditiveAnimationBlendMode,
        e
    }
}
  , Interpolant = function() {
    function e(t, i, r, n) {
        _classCallCheck2(this, e),
        this.parameterPositions = t,
        this._cachedIndex = 0,
        this.resultBuffer = void 0 !== n ? n : new i.constructor(r),
        this.sampleValues = i,
        this.valueSize = r,
        this.settings = null,
        this.DefaultSettings_ = {}
    }
    return _createClass2(e, [{
        key: "evaluate",
        value: function(e) {
            var t = this.parameterPositions
              , i = this._cachedIndex
              , r = t[i]
              , n = t[i - 1];
            e: {
                t: {
                    var a;
                    i: {
                        r: if (!(e < r)) {
                            for (var o = i + 2; ; ) {
                                if (void 0 === r) {
                                    if (e < n)
                                        break r;
                                    return i = t.length,
                                    this._cachedIndex = i,
                                    this.afterEnd_(i - 1, e, n)
                                }
                                if (i === o)
                                    break;
                                if (n = r,
                                e < (r = t[++i]))
                                    break t
                            }
                            a = t.length;
                            break i
                        }
                        if (e >= n)
                            break e;
                        var s = t[1];
                        e < s && (i = 2,
                        n = s);
                        for (var l = i - 2; ; ) {
                            if (void 0 === n)
                                return this._cachedIndex = 0,
                                this.beforeStart_(0, e, r);
                            if (i === l)
                                break;
                            if (r = n,
                            e >= (n = t[--i - 1]))
                                break t
                        }
                        a = i,
                        i = 0
                    }
                    for (; i < a; ) {
                        var h = i + a >>> 1;
                        e < t[h] ? a = h : i = h + 1
                    }
                    if (r = t[i],
                    void 0 === (n = t[i - 1]))
                        return this._cachedIndex = 0,
                        this.beforeStart_(0, e, r);
                    if (void 0 === r)
                        return i = t.length,
                        this._cachedIndex = i,
                        this.afterEnd_(i - 1, n, e)
                }
                this._cachedIndex = i,
                this.intervalChanged_(i, n, r)
            }
            return this.interpolate_(i, n, e, r)
        }
    }, {
        key: "getSettings_",
        value: function() {
            return this.settings || this.DefaultSettings_
        }
    }, {
        key: "copySampleValue_",
        value: function(e) {
            for (var t = this.resultBuffer, i = this.sampleValues, r = this.valueSize, n = e * r, a = 0; a !== r; ++a)
                t[a] = i[n + a];
            return t
        }
    }, {
        key: "interpolate_",
        value: function() {
            throw new Error("call to abstract method")
        }
    }, {
        key: "intervalChanged_",
        value: function() {}
    }]),
    e
}();
Interpolant.prototype.beforeStart_ = Interpolant.prototype.copySampleValue_,
Interpolant.prototype.afterEnd_ = Interpolant.prototype.copySampleValue_;
var CubicInterpolant = function(e) {
    _inherits(i, Interpolant);
    var t = _createSuper(i);
    function i(e, r, n, a) {
        var o;
        return _classCallCheck2(this, i),
        (o = t.call(this, e, r, n, a))._weightPrev = -0,
        o._offsetPrev = -0,
        o._weightNext = -0,
        o._offsetNext = -0,
        o.DefaultSettings_ = {
            endingStart: ZeroCurvatureEnding,
            endingEnd: ZeroCurvatureEnding
        },
        o
    }
    return _createClass2(i, [{
        key: "intervalChanged_",
        value: function(e, t, i) {
            var r = this.parameterPositions
              , n = e - 2
              , a = e + 1
              , o = r[n]
              , s = r[a];
            if (void 0 === o)
                switch (this.getSettings_().endingStart) {
                case ZeroSlopeEnding:
                    n = e,
                    o = 2 * t - i;
                    break;
                case WrapAroundEnding:
                    o = t + r[n = r.length - 2] - r[n + 1];
                    break;
                default:
                    n = e,
                    o = i
                }
            if (void 0 === s)
                switch (this.getSettings_().endingEnd) {
                case ZeroSlopeEnding:
                    a = e,
                    s = 2 * i - t;
                    break;
                case WrapAroundEnding:
                    a = 1,
                    s = i + r[1] - r[0];
                    break;
                default:
                    a = e - 1,
                    s = t
                }
            var l = .5 * (i - t)
              , h = this.valueSize;
            this._weightPrev = l / (t - o),
            this._weightNext = l / (s - i),
            this._offsetPrev = n * h,
            this._offsetNext = a * h
        }
    }, {
        key: "interpolate_",
        value: function(e, t, i, r) {
            for (var n = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = e * o, l = s - o, h = this._offsetPrev, c = this._offsetNext, p = this._weightPrev, u = this._weightNext, d = (i - t) / (r - t), f = d * d, m = f * d, g = -p * m + 2 * p * f - p * d, v = (1 + p) * m + (-1.5 - 2 * p) * f + (-.5 + p) * d + 1, y = (-1 - u) * m + (1.5 + u) * f + .5 * d, _ = u * m - u * f, b = 0; b !== o; ++b)
                n[b] = g * a[h + b] + v * a[l + b] + y * a[s + b] + _ * a[c + b];
            return n
        }
    }]),
    i
}()
  , LinearInterpolant = function(e) {
    _inherits(i, Interpolant);
    var t = _createSuper(i);
    function i(e, r, n, a) {
        return _classCallCheck2(this, i),
        t.call(this, e, r, n, a)
    }
    return _createClass2(i, [{
        key: "interpolate_",
        value: function(e, t, i, r) {
            for (var n = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = e * o, l = s - o, h = (i - t) / (r - t), c = 1 - h, p = 0; p !== o; ++p)
                n[p] = a[l + p] * c + a[s + p] * h;
            return n
        }
    }]),
    i
}()
  , DiscreteInterpolant = function(e) {
    _inherits(i, Interpolant);
    var t = _createSuper(i);
    function i(e, r, n, a) {
        return _classCallCheck2(this, i),
        t.call(this, e, r, n, a)
    }
    return _createClass2(i, [{
        key: "interpolate_",
        value: function(e) {
            return this.copySampleValue_(e - 1)
        }
    }]),
    i
}()
  , KeyframeTrack = function() {
    function e(t, i, r, n) {
        if (_classCallCheck2(this, e),
        void 0 === t)
            throw new Error("THREE.KeyframeTrack: track name is undefined");
        if (void 0 === i || 0 === i.length)
            throw new Error("THREE.KeyframeTrack: no keyframes in track named " + t);
        this.name = t,
        this.times = AnimationUtils.convertArray(i, this.TimeBufferType),
        this.values = AnimationUtils.convertArray(r, this.ValueBufferType),
        this.setInterpolation(n || this.DefaultInterpolation)
    }
    return _createClass2(e, [{
        key: "InterpolantFactoryMethodDiscrete",
        value: function(e) {
            return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)
        }
    }, {
        key: "InterpolantFactoryMethodLinear",
        value: function(e) {
            return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)
        }
    }, {
        key: "InterpolantFactoryMethodSmooth",
        value: function(e) {
            return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)
        }
    }, {
        key: "setInterpolation",
        value: function(e) {
            var t;
            switch (e) {
            case InterpolateDiscrete:
                t = this.InterpolantFactoryMethodDiscrete;
                break;
            case InterpolateLinear:
                t = this.InterpolantFactoryMethodLinear;
                break;
            case InterpolateSmooth:
                t = this.InterpolantFactoryMethodSmooth
            }
            if (void 0 === t) {
                var i = "unsupported interpolation for " + this.ValueTypeName + " keyframe track named " + this.name;
                if (void 0 === this.createInterpolant) {
                    if (e === this.DefaultInterpolation)
                        throw new Error(i);
                    this.setInterpolation(this.DefaultInterpolation)
                }
                return console.warn("THREE.KeyframeTrack:", i),
                this
            }
            return this.createInterpolant = t,
            this
        }
    }, {
        key: "getInterpolation",
        value: function() {
            switch (this.createInterpolant) {
            case this.InterpolantFactoryMethodDiscrete:
                return InterpolateDiscrete;
            case this.InterpolantFactoryMethodLinear:
                return InterpolateLinear;
            case this.InterpolantFactoryMethodSmooth:
                return InterpolateSmooth
            }
        }
    }, {
        key: "getValueSize",
        value: function() {
            return this.values.length / this.times.length
        }
    }, {
        key: "shift",
        value: function(e) {
            if (0 !== e)
                for (var t = this.times, i = 0, r = t.length; i !== r; ++i)
                    t[i] += e;
            return this
        }
    }, {
        key: "scale",
        value: function(e) {
            if (1 !== e)
                for (var t = this.times, i = 0, r = t.length; i !== r; ++i)
                    t[i] *= e;
            return this
        }
    }, {
        key: "trim",
        value: function(e, t) {
            for (var i = this.times, r = i.length, n = 0, a = r - 1; n !== r && i[n] < e; )
                ++n;
            for (; -1 !== a && i[a] > t; )
                --a;
            if (++a,
            0 !== n || a !== r) {
                n >= a && (n = (a = Math.max(a, 1)) - 1);
                var o = this.getValueSize();
                this.times = AnimationUtils.arraySlice(i, n, a),
                this.values = AnimationUtils.arraySlice(this.values, n * o, a * o)
            }
            return this
        }
    }, {
        key: "validate",
        value: function() {
            var e = !0
              , t = this.getValueSize();
            t - Math.floor(t) != 0 && (console.error("THREE.KeyframeTrack: Invalid value size in track.", this),
            e = !1);
            var i = this.times
              , r = this.values
              , n = i.length;
            0 === n && (console.error("THREE.KeyframeTrack: Track is empty.", this),
            e = !1);
            for (var a = null, o = 0; o !== n; o++) {
                var s = i[o];
                if ("number" == typeof s && isNaN(s)) {
                    console.error("THREE.KeyframeTrack: Time is not a valid number.", this, o, s),
                    e = !1;
                    break
                }
                if (null !== a && a > s) {
                    console.error("THREE.KeyframeTrack: Out of order keys.", this, o, s, a),
                    e = !1;
                    break
                }
                a = s
            }
            if (void 0 !== r && AnimationUtils.isTypedArray(r))
                for (var l = 0, h = r.length; l !== h; ++l) {
                    var c = r[l];
                    if (isNaN(c)) {
                        console.error("THREE.KeyframeTrack: Value is not a valid number.", this, l, c),
                        e = !1;
                        break
                    }
                }
            return e
        }
    }, {
        key: "optimize",
        value: function() {
            for (var e = AnimationUtils.arraySlice(this.times), t = AnimationUtils.arraySlice(this.values), i = this.getValueSize(), r = this.getInterpolation() === InterpolateSmooth, n = e.length - 1, a = 1, o = 1; o < n; ++o) {
                var s = !1
                  , l = e[o];
                if (l !== e[o + 1] && (1 !== o || l !== e[0]))
                    if (r)
                        s = !0;
                    else
                        for (var h = o * i, c = h - i, p = h + i, u = 0; u !== i; ++u) {
                            var d = t[h + u];
                            if (d !== t[c + u] || d !== t[p + u]) {
                                s = !0;
                                break
                            }
                        }
                if (s) {
                    if (o !== a) {
                        e[a] = e[o];
                        for (var f = o * i, m = a * i, g = 0; g !== i; ++g)
                            t[m + g] = t[f + g]
                    }
                    ++a
                }
            }
            if (n > 0) {
                e[a] = e[n];
                for (var v = n * i, y = a * i, _ = 0; _ !== i; ++_)
                    t[y + _] = t[v + _];
                ++a
            }
            return a !== e.length ? (this.times = AnimationUtils.arraySlice(e, 0, a),
            this.values = AnimationUtils.arraySlice(t, 0, a * i)) : (this.times = e,
            this.values = t),
            this
        }
    }, {
        key: "clone",
        value: function() {
            var e = AnimationUtils.arraySlice(this.times, 0)
              , t = AnimationUtils.arraySlice(this.values, 0)
              , i = new (0,
            this.constructor)(this.name,e,t);
            return i.createInterpolant = this.createInterpolant,
            i
        }
    }], [{
        key: "toJSON",
        value: function(e) {
            var t, i = e.constructor;
            if (i.toJSON !== this.toJSON)
                t = i.toJSON(e);
            else {
                t = {
                    name: e.name,
                    times: AnimationUtils.convertArray(e.times, Array),
                    values: AnimationUtils.convertArray(e.values, Array)
                };
                var r = e.getInterpolation();
                r !== e.DefaultInterpolation && (t.interpolation = r)
            }
            return t.type = e.ValueTypeName,
            t
        }
    }]),
    e
}();
KeyframeTrack.prototype.TimeBufferType = Float32Array,
KeyframeTrack.prototype.ValueBufferType = Float32Array,
KeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;
var BooleanKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
BooleanKeyframeTrack.prototype.ValueTypeName = "bool",
BooleanKeyframeTrack.prototype.ValueBufferType = Array,
BooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete,
BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = void 0,
BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = void 0;
var ColorKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
ColorKeyframeTrack.prototype.ValueTypeName = "color";
var NumberKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
NumberKeyframeTrack.prototype.ValueTypeName = "number";
var QuaternionLinearInterpolant = function(e) {
    _inherits(i, Interpolant);
    var t = _createSuper(i);
    function i(e, r, n, a) {
        return _classCallCheck2(this, i),
        t.call(this, e, r, n, a)
    }
    return _createClass2(i, [{
        key: "interpolate_",
        value: function(e, t, i, r) {
            for (var n = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = (i - t) / (r - t), l = e * o, h = l + o; l !== h; l += 4)
                Quaternion.slerpFlat(n, 0, a, l - o, a, l, s);
            return n
        }
    }]),
    i
}()
  , QuaternionKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i, [{
        key: "InterpolantFactoryMethodLinear",
        value: function(e) {
            return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)
        }
    }]),
    i
}();
QuaternionKeyframeTrack.prototype.ValueTypeName = "quaternion",
QuaternionKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear,
QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = void 0;
var StringKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
StringKeyframeTrack.prototype.ValueTypeName = "string",
StringKeyframeTrack.prototype.ValueBufferType = Array,
StringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete,
StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = void 0,
StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = void 0;
var VectorKeyframeTrack = function(e) {
    _inherits(i, KeyframeTrack);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i)
}();
VectorKeyframeTrack.prototype.ValueTypeName = "vector";
var AnimationClip = function() {
    function e(t) {
        var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : -1
          , r = arguments.length > 2 ? arguments[2] : void 0
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : NormalAnimationBlendMode;
        _classCallCheck2(this, e),
        this.name = t,
        this.tracks = r,
        this.duration = i,
        this.blendMode = n,
        this.uuid = generateUUID(),
        this.duration < 0 && this.resetDuration()
    }
    return _createClass2(e, [{
        key: "resetDuration",
        value: function() {
            for (var e = 0, t = 0, i = this.tracks.length; t !== i; ++t) {
                var r = this.tracks[t];
                e = Math.max(e, r.times[r.times.length - 1])
            }
            return this.duration = e,
            this
        }
    }, {
        key: "trim",
        value: function() {
            for (var e = 0; e < this.tracks.length; e++)
                this.tracks[e].trim(0, this.duration);
            return this
        }
    }, {
        key: "validate",
        value: function() {
            for (var e = !0, t = 0; t < this.tracks.length; t++)
                e = e && this.tracks[t].validate();
            return e
        }
    }, {
        key: "optimize",
        value: function() {
            for (var e = 0; e < this.tracks.length; e++)
                this.tracks[e].optimize();
            return this
        }
    }, {
        key: "clone",
        value: function() {
            for (var e = [], t = 0; t < this.tracks.length; t++)
                e.push(this.tracks[t].clone());
            return new this.constructor(this.name,this.duration,e,this.blendMode)
        }
    }, {
        key: "toJSON",
        value: function() {
            return this.constructor.toJSON(this)
        }
    }], [{
        key: "parse",
        value: function(e) {
            for (var t = [], i = e.tracks, r = 1 / (e.fps || 1), n = 0, a = i.length; n !== a; ++n)
                t.push(parseKeyframeTrack(i[n]).scale(r));
            var o = new this(e.name,e.duration,t,e.blendMode);
            return o.uuid = e.uuid,
            o
        }
    }, {
        key: "toJSON",
        value: function(e) {
            for (var t = [], i = e.tracks, r = {
                name: e.name,
                duration: e.duration,
                tracks: t,
                uuid: e.uuid,
                blendMode: e.blendMode
            }, n = 0, a = i.length; n !== a; ++n)
                t.push(KeyframeTrack.toJSON(i[n]));
            return r
        }
    }, {
        key: "CreateFromMorphTargetSequence",
        value: function(e, t, i, r) {
            for (var n = t.length, a = [], o = 0; o < n; o++) {
                var s = []
                  , l = [];
                s.push((o + n - 1) % n, o, (o + 1) % n),
                l.push(0, 1, 0);
                var h = AnimationUtils.getKeyframeOrder(s);
                s = AnimationUtils.sortedArray(s, 1, h),
                l = AnimationUtils.sortedArray(l, 1, h),
                r || 0 !== s[0] || (s.push(n),
                l.push(l[0])),
                a.push(new NumberKeyframeTrack(".morphTargetInfluences[" + t[o].name + "]",s,l).scale(1 / i))
            }
            return new this(e,-1,a)
        }
    }, {
        key: "findByName",
        value: function(e, t) {
            var i = e;
            if (!Array.isArray(e)) {
                var r = e;
                i = r.geometry && r.geometry.animations || r.animations
            }
            for (var n = 0; n < i.length; n++)
                if (i[n].name === t)
                    return i[n];
            return null
        }
    }, {
        key: "CreateClipsFromMorphTargetSequences",
        value: function(e, t, i) {
            for (var r = {}, n = /^([\w-]*?)([\d]+)$/, a = 0, o = e.length; a < o; a++) {
                var s = e[a]
                  , l = s.name.match(n);
                if (l && l.length > 1) {
                    var h = l[1]
                      , c = r[h];
                    c || (r[h] = c = []),
                    c.push(s)
                }
            }
            var p = [];
            for (var u in r)
                p.push(this.CreateFromMorphTargetSequence(u, r[u], t, i));
            return p
        }
    }, {
        key: "parseAnimation",
        value: function(e, t) {
            if (!e)
                return console.error("THREE.AnimationClip: No animation in JSONLoader data."),
                null;
            for (var i = function(e, t, i, r, n) {
                if (0 !== i.length) {
                    var a = []
                      , o = [];
                    AnimationUtils.flattenJSON(i, a, o, r),
                    0 !== a.length && n.push(new e(t,a,o))
                }
            }, r = [], n = e.name || "default", a = e.fps || 30, o = e.blendMode, s = e.length || -1, l = e.hierarchy || [], h = 0; h < l.length; h++) {
                var c = l[h].keys;
                if (c && 0 !== c.length)
                    if (c[0].morphTargets) {
                        var p = {}
                          , u = void 0;
                        for (u = 0; u < c.length; u++)
                            if (c[u].morphTargets)
                                for (var d = 0; d < c[u].morphTargets.length; d++)
                                    p[c[u].morphTargets[d]] = -1;
                        for (var f in p) {
                            for (var m = [], g = [], v = 0; v !== c[u].morphTargets.length; ++v) {
                                var y = c[u];
                                m.push(y.time),
                                g.push(y.morphTarget === f ? 1 : 0)
                            }
                            r.push(new NumberKeyframeTrack(".morphTargetInfluence[" + f + "]",m,g))
                        }
                        s = p.length * (a || 1)
                    } else {
                        var _ = ".bones[" + t[h].name + "]";
                        i(VectorKeyframeTrack, _ + ".position", c, "pos", r),
                        i(QuaternionKeyframeTrack, _ + ".quaternion", c, "rot", r),
                        i(VectorKeyframeTrack, _ + ".scale", c, "scl", r)
                    }
            }
            return 0 === r.length ? null : new this(n,s,r,o)
        }
    }]),
    e
}();
function getTrackTypeForValueTypeName(e) {
    switch (e.toLowerCase()) {
    case "scalar":
    case "double":
    case "float":
    case "number":
    case "integer":
        return NumberKeyframeTrack;
    case "vector":
    case "vector2":
    case "vector3":
    case "vector4":
        return VectorKeyframeTrack;
    case "color":
        return ColorKeyframeTrack;
    case "quaternion":
        return QuaternionKeyframeTrack;
    case "bool":
    case "boolean":
        return BooleanKeyframeTrack;
    case "string":
        return StringKeyframeTrack
    }
    throw new Error("THREE.KeyframeTrack: Unsupported typeName: " + e)
}
function parseKeyframeTrack(e) {
    if (void 0 === e.type)
        throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");
    var t = getTrackTypeForValueTypeName(e.type);
    if (void 0 === e.times) {
        var i = []
          , r = [];
        AnimationUtils.flattenJSON(e.keys, i, r, "value"),
        e.times = i,
        e.values = r
    }
    return void 0 !== t.parse ? t.parse(e) : new t(e.name,e.times,e.values,e.interpolation)
}
var Cache = {
    enabled: !1,
    files: {},
    add: function(e, t) {
        !1 !== this.enabled && (this.files[e] = t)
    },
    get: function(e) {
        if (!1 !== this.enabled)
            return this.files[e]
    },
    remove: function(e) {
        delete this.files[e]
    },
    clear: function() {
        this.files = {}
    }
}
  , LoadingManager = _createClass2((function e(t, i, r) {
    _classCallCheck2(this, e);
    var n = this
      , a = !1
      , o = 0
      , s = 0
      , l = void 0
      , h = [];
    this.onStart = void 0,
    this.onLoad = t,
    this.onProgress = i,
    this.onError = r,
    this.itemStart = function(e) {
        s++,
        !1 === a && void 0 !== n.onStart && n.onStart(e, o, s),
        a = !0
    }
    ,
    this.itemEnd = function(e) {
        o++,
        void 0 !== n.onProgress && n.onProgress(e, o, s),
        o === s && (a = !1,
        void 0 !== n.onLoad && n.onLoad())
    }
    ,
    this.itemError = function(e) {
        void 0 !== n.onError && n.onError(e)
    }
    ,
    this.resolveURL = function(e) {
        return l ? l(e) : e
    }
    ,
    this.setURLModifier = function(e) {
        return l = e,
        this
    }
    ,
    this.addHandler = function(e, t) {
        return h.push(e, t),
        this
    }
    ,
    this.removeHandler = function(e) {
        var t = h.indexOf(e);
        return -1 !== t && h.splice(t, 2),
        this
    }
    ,
    this.getHandler = function(e) {
        for (var t = 0, i = h.length; t < i; t += 2) {
            var r = h[t]
              , n = h[t + 1];
            if (r.global && (r.lastIndex = 0),
            r.test(e))
                return n
        }
        return null
    }
}
))
  , DefaultLoadingManager = new LoadingManager
  , Loader = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.manager = void 0 !== t ? t : DefaultLoadingManager,
        this.crossOrigin = "anonymous",
        this.withCredentials = !1,
        this.path = "",
        this.resourcePath = "",
        this.requestHeader = {}
    }
    return _createClass2(e, [{
        key: "load",
        value: function() {}
    }, {
        key: "loadAsync",
        value: function(e, t) {
            var i = this;
            return new Promise((function(r, n) {
                i.load(e, r, t, n)
            }
            ))
        }
    }, {
        key: "parse",
        value: function() {}
    }, {
        key: "setCrossOrigin",
        value: function(e) {
            return this.crossOrigin = e,
            this
        }
    }, {
        key: "setWithCredentials",
        value: function(e) {
            return this.withCredentials = e,
            this
        }
    }, {
        key: "setPath",
        value: function(e) {
            return this.path = e,
            this
        }
    }, {
        key: "setResourcePath",
        value: function(e) {
            return this.resourcePath = e,
            this
        }
    }, {
        key: "setRequestHeader",
        value: function(e) {
            return this.requestHeader = e,
            this
        }
    }]),
    e
}()
  , loading = {}
  , FileLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            void 0 === e && (e = ""),
            void 0 !== this.path && (e = this.path + e),
            e = this.manager.resolveURL(e);
            var n = this
              , a = Cache.get(e);
            if (void 0 !== a)
                return n.manager.itemStart(e),
                setTimeout((function() {
                    t && t(a),
                    n.manager.itemEnd(e)
                }
                ), 0),
                a;
            if (void 0 === loading[e]) {
                var o, s = e.match(/^data:(.*?)(;base64)?,(.*)$/);
                if (s) {
                    var l = s[1]
                      , h = !!s[2]
                      , c = s[3];
                    c = decodeURIComponent(c),
                    h && (c = atob(c));
                    try {
                        var p, u = (this.responseType || "").toLowerCase();
                        switch (u) {
                        case "arraybuffer":
                        case "blob":
                            for (var d = new Uint8Array(c.length), f = 0; f < c.length; f++)
                                d[f] = c.charCodeAt(f);
                            p = "blob" === u ? new Blob([d.buffer],{
                                type: l
                            }) : d.buffer;
                            break;
                        case "document":
                            var m = new DOMParser;
                            p = m.parseFromString(c, l);
                            break;
                        case "json":
                            p = JSON.parse(c);
                            break;
                        default:
                            p = c
                        }
                        setTimeout((function() {
                            t && t(p),
                            n.manager.itemEnd(e)
                        }
                        ), 0)
                    } catch (v) {
                        setTimeout((function() {
                            r && r(v),
                            n.manager.itemError(e),
                            n.manager.itemEnd(e)
                        }
                        ), 0)
                    }
                } else {
                    for (var g in loading[e] = [],
                    loading[e].push({
                        onLoad: t,
                        onProgress: i,
                        onError: r
                    }),
                    (o = new XMLHttpRequest).open("GET", e, !0),
                    o.addEventListener("load", (function(t) {
                        var i = this.response
                          , r = loading[e];
                        if (delete loading[e],
                        200 === this.status || 0 === this.status) {
                            0 === this.status && console.warn("THREE.FileLoader: HTTP Status 0 received."),
                            Cache.add(e, i);
                            for (var a = 0, o = r.length; a < o; a++) {
                                var s = r[a];
                                s.onLoad && s.onLoad(i)
                            }
                            n.manager.itemEnd(e)
                        } else {
                            for (var l = 0, h = r.length; l < h; l++) {
                                var c = r[l];
                                c.onError && c.onError(t)
                            }
                            n.manager.itemError(e),
                            n.manager.itemEnd(e)
                        }
                    }
                    ), !1),
                    o.addEventListener("progress", (function(t) {
                        for (var i = loading[e], r = 0, n = i.length; r < n; r++) {
                            var a = i[r];
                            a.onProgress && a.onProgress(t)
                        }
                    }
                    ), !1),
                    o.addEventListener("error", (function(t) {
                        var i = loading[e];
                        delete loading[e];
                        for (var r = 0, a = i.length; r < a; r++) {
                            var o = i[r];
                            o.onError && o.onError(t)
                        }
                        n.manager.itemError(e),
                        n.manager.itemEnd(e)
                    }
                    ), !1),
                    o.addEventListener("abort", (function(t) {
                        var i = loading[e];
                        delete loading[e];
                        for (var r = 0, a = i.length; r < a; r++) {
                            var o = i[r];
                            o.onError && o.onError(t)
                        }
                        n.manager.itemError(e),
                        n.manager.itemEnd(e)
                    }
                    ), !1),
                    void 0 !== this.responseType && (o.responseType = this.responseType),
                    void 0 !== this.withCredentials && (o.withCredentials = this.withCredentials),
                    o.overrideMimeType && o.overrideMimeType(void 0 !== this.mimeType ? this.mimeType : "text/plain"),
                    this.requestHeader)
                        o.setRequestHeader(g, this.requestHeader[g]);
                    o.send(null)
                }
                return n.manager.itemStart(e),
                o
            }
            loading[e].push({
                onLoad: t,
                onProgress: i,
                onError: r
            })
        }
    }, {
        key: "setResponseType",
        value: function(e) {
            return this.responseType = e,
            this
        }
    }, {
        key: "setMimeType",
        value: function(e) {
            return this.mimeType = e,
            this
        }
    }]),
    i
}()
  , ImageLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            void 0 !== this.path && (e = this.path + e),
            e = this.manager.resolveURL(e);
            var n = this
              , a = Cache.get(e);
            if (void 0 !== a)
                return n.manager.itemStart(e),
                setTimeout((function() {
                    t && t(a),
                    n.manager.itemEnd(e)
                }
                ), 0),
                a;
            var o = createElementNS("img");
            function s() {
                o.removeEventListener("load", s, !1),
                o.removeEventListener("error", l, !1),
                Cache.add(e, this),
                t && t(this),
                n.manager.itemEnd(e)
            }
            function l(t) {
                o.removeEventListener("load", s, !1),
                o.removeEventListener("error", l, !1),
                r && r(t),
                n.manager.itemError(e),
                n.manager.itemEnd(e)
            }
            return o.addEventListener("load", s, !1),
            o.addEventListener("error", l, !1),
            "data:" !== e.substr(0, 5) && void 0 !== this.crossOrigin && (o.crossOrigin = this.crossOrigin),
            n.manager.itemStart(e),
            o.src = e,
            o
        }
    }]),
    i
}()
  , CubeTextureLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            var n = new CubeTexture
              , a = new ImageLoader(this.manager);
            a.setCrossOrigin(this.crossOrigin),
            a.setPath(this.path);
            var o = 0;
            function s(i) {
                a.load(e[i], (function(e) {
                    n.images[i] = e,
                    6 == ++o && (n.needsUpdate = !0,
                    t && t(n))
                }
                ), void 0, r)
            }
            for (var l = 0; l < e.length; ++l)
                s(l);
            return n
        }
    }]),
    i
}()
  , DataTextureLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            var n = this
              , a = new DataTexture
              , o = new FileLoader(this.manager);
            return o.setResponseType("arraybuffer"),
            o.setRequestHeader(this.requestHeader),
            o.setPath(this.path),
            o.setWithCredentials(n.withCredentials),
            o.load(e, (function(e) {
                var i = n.parse(e);
                i && (void 0 !== i.image ? a.image = i.image : void 0 !== i.data && (a.image.width = i.width,
                a.image.height = i.height,
                a.image.data = i.data),
                a.wrapS = void 0 !== i.wrapS ? i.wrapS : ClampToEdgeWrapping,
                a.wrapT = void 0 !== i.wrapT ? i.wrapT : ClampToEdgeWrapping,
                a.magFilter = void 0 !== i.magFilter ? i.magFilter : LinearFilter,
                a.minFilter = void 0 !== i.minFilter ? i.minFilter : LinearFilter,
                a.anisotropy = void 0 !== i.anisotropy ? i.anisotropy : 1,
                void 0 !== i.encoding && (a.encoding = i.encoding),
                void 0 !== i.flipY && (a.flipY = i.flipY),
                void 0 !== i.format && (a.format = i.format),
                void 0 !== i.type && (a.type = i.type),
                void 0 !== i.mipmaps && (a.mipmaps = i.mipmaps,
                a.minFilter = LinearMipmapLinearFilter),
                1 === i.mipmapCount && (a.minFilter = LinearFilter),
                void 0 !== i.generateMipmaps && (a.generateMipmaps = i.generateMipmaps),
                a.needsUpdate = !0,
                t && t(a, i))
            }
            ), i, r),
            a
        }
    }]),
    i
}()
  , TextureLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            var n = new Texture
              , a = new ImageLoader(this.manager);
            return a.setCrossOrigin(this.crossOrigin),
            a.setPath(this.path),
            a.load(e, (function(e) {
                n.image = e,
                n.needsUpdate = !0,
                void 0 !== t && t(n)
            }
            ), i, r),
            n
        }
    }]),
    i
}()
  , Light = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i(e) {
        var r, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "Light",
        r.color = new Color(e),
        r.intensity = n,
        r
    }
    return _createClass2(i, [{
        key: "dispose",
        value: function() {}
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.color.copy(e.color),
            this.intensity = e.intensity,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.object.color = this.color.getHex(),
            t.object.intensity = this.intensity,
            void 0 !== this.groundColor && (t.object.groundColor = this.groundColor.getHex()),
            void 0 !== this.distance && (t.object.distance = this.distance),
            void 0 !== this.angle && (t.object.angle = this.angle),
            void 0 !== this.decay && (t.object.decay = this.decay),
            void 0 !== this.penumbra && (t.object.penumbra = this.penumbra),
            void 0 !== this.shadow && (t.object.shadow = this.shadow.toJSON()),
            t
        }
    }]),
    i
}();
Light.prototype.isLight = !0;
var HemisphereLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        return _classCallCheck2(this, i),
        (a = t.call(this, e, n)).type = "HemisphereLight",
        a.position.copy(Object3D.DefaultUp),
        a.updateMatrix(),
        a.groundColor = new Color(r),
        a
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return Light.prototype.copy.call(this, e),
            this.groundColor.copy(e.groundColor),
            this
        }
    }]),
    i
}();
HemisphereLight.prototype.isHemisphereLight = !0;
var _projScreenMatrix$1 = new Matrix4
  , _lightPositionWorld$1 = new Vector3
  , _lookTarget$1 = new Vector3
  , LightShadow = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.camera = t,
        this.bias = 0,
        this.normalBias = 0,
        this.radius = 1,
        this.blurSamples = 8,
        this.mapSize = new Vector2(512,512),
        this.map = null,
        this.mapPass = null,
        this.matrix = new Matrix4,
        this.autoUpdate = !0,
        this.needsUpdate = !1,
        this._frustum = new Frustum,
        this._frameExtents = new Vector2(1,1),
        this._viewportCount = 1,
        this._viewports = [new Vector4(0,0,1,1)]
    }
    return _createClass2(e, [{
        key: "getViewportCount",
        value: function() {
            return this._viewportCount
        }
    }, {
        key: "getFrustum",
        value: function() {
            return this._frustum
        }
    }, {
        key: "updateMatrices",
        value: function(e) {
            var t = this.camera
              , i = this.matrix;
            _lightPositionWorld$1.setFromMatrixPosition(e.matrixWorld),
            t.position.copy(_lightPositionWorld$1),
            _lookTarget$1.setFromMatrixPosition(e.target.matrixWorld),
            t.lookAt(_lookTarget$1),
            t.updateMatrixWorld(),
            _projScreenMatrix$1.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse),
            this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),
            i.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1),
            i.multiply(t.projectionMatrix),
            i.multiply(t.matrixWorldInverse)
        }
    }, {
        key: "getViewport",
        value: function(e) {
            return this._viewports[e]
        }
    }, {
        key: "getFrameExtents",
        value: function() {
            return this._frameExtents
        }
    }, {
        key: "dispose",
        value: function() {
            this.map && this.map.dispose(),
            this.mapPass && this.mapPass.dispose()
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.camera = e.camera.clone(),
            this.bias = e.bias,
            this.radius = e.radius,
            this.mapSize.copy(e.mapSize),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = {};
            return 0 !== this.bias && (e.bias = this.bias),
            0 !== this.normalBias && (e.normalBias = this.normalBias),
            1 !== this.radius && (e.radius = this.radius),
            512 === this.mapSize.x && 512 === this.mapSize.y || (e.mapSize = this.mapSize.toArray()),
            e.camera = this.camera.toJSON(!1).object,
            delete e.camera.matrix,
            e
        }
    }]),
    e
}()
  , SpotLightShadow = function(e) {
    _inherits(i, LightShadow);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this, new PerspectiveCamera(50,1,.5,500))).focus = 1,
        e
    }
    return _createClass2(i, [{
        key: "updateMatrices",
        value: function(e) {
            var t = this.camera
              , r = 2 * RAD2DEG * e.angle * this.focus
              , n = this.mapSize.width / this.mapSize.height
              , a = e.distance || t.far;
            r === t.fov && n === t.aspect && a === t.far || (t.fov = r,
            t.aspect = n,
            t.far = a,
            t.updateProjectionMatrix()),
            _get(_getPrototypeOf(i.prototype), "updateMatrices", this).call(this, e)
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.focus = e.focus,
            this
        }
    }]),
    i
}();
SpotLightShadow.prototype.isSpotLightShadow = !0;
var SpotLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : Math.PI / 3, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 1;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "SpotLight",
        n.position.copy(Object3D.DefaultUp),
        n.updateMatrix(),
        n.target = new Object3D,
        n.distance = a,
        n.angle = o,
        n.penumbra = s,
        n.decay = l,
        n.shadow = new SpotLightShadow,
        n
    }
    return _createClass2(i, [{
        key: "power",
        get: function() {
            return this.intensity * Math.PI
        },
        set: function(e) {
            this.intensity = e / Math.PI
        }
    }, {
        key: "dispose",
        value: function() {
            this.shadow.dispose()
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.distance = e.distance,
            this.angle = e.angle,
            this.penumbra = e.penumbra,
            this.decay = e.decay,
            this.target = e.target.clone(),
            this.shadow = e.shadow.clone(),
            this
        }
    }]),
    i
}();
SpotLight.prototype.isSpotLight = !0;
var _projScreenMatrix$2 = new Matrix4
  , _lightPositionWorld = new Vector3
  , _lookTarget = new Vector3
  , PointLightShadow = function(e) {
    _inherits(i, LightShadow);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this, new PerspectiveCamera(90,1,.5,500)))._frameExtents = new Vector2(4,2),
        e._viewportCount = 6,
        e._viewports = [new Vector4(2,1,1,1), new Vector4(0,1,1,1), new Vector4(3,1,1,1), new Vector4(1,1,1,1), new Vector4(3,0,1,1), new Vector4(1,0,1,1)],
        e._cubeDirections = [new Vector3(1,0,0), new Vector3(-1,0,0), new Vector3(0,0,1), new Vector3(0,0,-1), new Vector3(0,1,0), new Vector3(0,-1,0)],
        e._cubeUps = [new Vector3(0,1,0), new Vector3(0,1,0), new Vector3(0,1,0), new Vector3(0,1,0), new Vector3(0,0,1), new Vector3(0,0,-1)],
        e
    }
    return _createClass2(i, [{
        key: "updateMatrices",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
              , i = this.camera
              , r = this.matrix
              , n = e.distance || i.far;
            n !== i.far && (i.far = n,
            i.updateProjectionMatrix()),
            _lightPositionWorld.setFromMatrixPosition(e.matrixWorld),
            i.position.copy(_lightPositionWorld),
            _lookTarget.copy(i.position),
            _lookTarget.add(this._cubeDirections[t]),
            i.up.copy(this._cubeUps[t]),
            i.lookAt(_lookTarget),
            i.updateMatrixWorld(),
            r.makeTranslation(-_lightPositionWorld.x, -_lightPositionWorld.y, -_lightPositionWorld.z),
            _projScreenMatrix$2.multiplyMatrices(i.projectionMatrix, i.matrixWorldInverse),
            this._frustum.setFromProjectionMatrix(_projScreenMatrix$2)
        }
    }]),
    i
}();
PointLightShadow.prototype.isPointLightShadow = !0;
var PointLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "PointLight",
        n.distance = a,
        n.decay = o,
        n.shadow = new PointLightShadow,
        n
    }
    return _createClass2(i, [{
        key: "power",
        get: function() {
            return 4 * this.intensity * Math.PI
        },
        set: function(e) {
            this.intensity = e / (4 * Math.PI)
        }
    }, {
        key: "dispose",
        value: function() {
            this.shadow.dispose()
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.distance = e.distance,
            this.decay = e.decay,
            this.shadow = e.shadow.clone(),
            this
        }
    }]),
    i
}();
PointLight.prototype.isPointLight = !0;
var DirectionalLightShadow = function(e) {
    _inherits(i, LightShadow);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.call(this, new OrthographicCamera(-5,5,5,-5,.5,500))
    }
    return _createClass2(i)
}();
DirectionalLightShadow.prototype.isDirectionalLightShadow = !0;
var DirectionalLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "DirectionalLight",
        n.position.copy(Object3D.DefaultUp),
        n.updateMatrix(),
        n.target = new Object3D,
        n.shadow = new DirectionalLightShadow,
        n
    }
    return _createClass2(i, [{
        key: "dispose",
        value: function() {
            this.shadow.dispose()
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.target = e.target.clone(),
            this.shadow = e.shadow.clone(),
            this
        }
    }]),
    i
}();
DirectionalLight.prototype.isDirectionalLight = !0;
var AmbientLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "AmbientLight",
        n
    }
    return _createClass2(i)
}();
AmbientLight.prototype.isAmbientLight = !0;
var RectAreaLight = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 10, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 10;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).type = "RectAreaLight",
        n.width = a,
        n.height = o,
        n
    }
    return _createClass2(i, [{
        key: "power",
        get: function() {
            return this.intensity * this.width * this.height * Math.PI
        },
        set: function(e) {
            this.intensity = e / (this.width * this.height * Math.PI)
        }
    }, {
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.width = e.width,
            this.height = e.height,
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.object.width = this.width,
            t.object.height = this.height,
            t
        }
    }]),
    i
}();
RectAreaLight.prototype.isRectAreaLight = !0;
var SphericalHarmonics3 = function() {
    function e() {
        _classCallCheck2(this, e),
        this.coefficients = [];
        for (var t = 0; t < 9; t++)
            this.coefficients.push(new Vector3)
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e) {
            for (var t = 0; t < 9; t++)
                this.coefficients[t].copy(e[t]);
            return this
        }
    }, {
        key: "zero",
        value: function() {
            for (var e = 0; e < 9; e++)
                this.coefficients[e].set(0, 0, 0);
            return this
        }
    }, {
        key: "getAt",
        value: function(e, t) {
            var i = e.x
              , r = e.y
              , n = e.z
              , a = this.coefficients;
            return t.copy(a[0]).multiplyScalar(.282095),
            t.addScaledVector(a[1], .488603 * r),
            t.addScaledVector(a[2], .488603 * n),
            t.addScaledVector(a[3], .488603 * i),
            t.addScaledVector(a[4], i * r * 1.092548),
            t.addScaledVector(a[5], r * n * 1.092548),
            t.addScaledVector(a[6], .315392 * (3 * n * n - 1)),
            t.addScaledVector(a[7], i * n * 1.092548),
            t.addScaledVector(a[8], .546274 * (i * i - r * r)),
            t
        }
    }, {
        key: "getIrradianceAt",
        value: function(e, t) {
            var i = e.x
              , r = e.y
              , n = e.z
              , a = this.coefficients;
            return t.copy(a[0]).multiplyScalar(.886227),
            t.addScaledVector(a[1], 1.023328 * r),
            t.addScaledVector(a[2], 1.023328 * n),
            t.addScaledVector(a[3], 1.023328 * i),
            t.addScaledVector(a[4], .858086 * i * r),
            t.addScaledVector(a[5], .858086 * r * n),
            t.addScaledVector(a[6], .743125 * n * n - .247708),
            t.addScaledVector(a[7], .858086 * i * n),
            t.addScaledVector(a[8], .429043 * (i * i - r * r)),
            t
        }
    }, {
        key: "add",
        value: function(e) {
            for (var t = 0; t < 9; t++)
                this.coefficients[t].add(e.coefficients[t]);
            return this
        }
    }, {
        key: "addScaledSH",
        value: function(e, t) {
            for (var i = 0; i < 9; i++)
                this.coefficients[i].addScaledVector(e.coefficients[i], t);
            return this
        }
    }, {
        key: "scale",
        value: function(e) {
            for (var t = 0; t < 9; t++)
                this.coefficients[t].multiplyScalar(e);
            return this
        }
    }, {
        key: "lerp",
        value: function(e, t) {
            for (var i = 0; i < 9; i++)
                this.coefficients[i].lerp(e.coefficients[i], t);
            return this
        }
    }, {
        key: "equals",
        value: function(e) {
            for (var t = 0; t < 9; t++)
                if (!this.coefficients[t].equals(e.coefficients[t]))
                    return !1;
            return !0
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.set(e.coefficients)
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "fromArray",
        value: function(e) {
            for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = this.coefficients, r = 0; r < 9; r++)
                i[r].fromArray(e, t + 3 * r);
            return this
        }
    }, {
        key: "toArray",
        value: function() {
            for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [], t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = this.coefficients, r = 0; r < 9; r++)
                i[r].toArray(e, t + 3 * r);
            return e
        }
    }], [{
        key: "getBasisAt",
        value: function(e, t) {
            var i = e.x
              , r = e.y
              , n = e.z;
            t[0] = .282095,
            t[1] = .488603 * r,
            t[2] = .488603 * n,
            t[3] = .488603 * i,
            t[4] = 1.092548 * i * r,
            t[5] = 1.092548 * r * n,
            t[6] = .315392 * (3 * n * n - 1),
            t[7] = 1.092548 * i * n,
            t[8] = .546274 * (i * i - r * r)
        }
    }]),
    e
}();
SphericalHarmonics3.prototype.isSphericalHarmonics3 = !0;
var LightProbe = function(e) {
    _inherits(i, Light);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new SphericalHarmonics3, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
        return _classCallCheck2(this, i),
        (e = t.call(this, void 0, n)).sh = r,
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.sh.copy(e.sh),
            this
        }
    }, {
        key: "fromJSON",
        value: function(e) {
            return this.intensity = e.intensity,
            this.sh.fromArray(e.sh),
            this
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.object.sh = this.sh.toArray(),
            t
        }
    }]),
    i
}();
LightProbe.prototype.isLightProbe = !0;
var LoaderUtils = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, null, [{
        key: "decodeText",
        value: function(e) {
            if ("undefined" != typeof TextDecoder)
                return (new TextDecoder).decode(e);
            for (var t = "", i = 0, r = e.length; i < r; i++)
                t += String.fromCharCode(e[i]);
            try {
                return decodeURIComponent(escape(t))
            } catch (n) {
                return t
            }
        }
    }, {
        key: "extractUrlBase",
        value: function(e) {
            var t = e.lastIndexOf("/");
            return -1 === t ? "./" : e.substr(0, t + 1)
        }
    }]),
    e
}()
  , InstancedBufferGeometry = function(e) {
    _inherits(i, BufferGeometry);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "InstancedBufferGeometry",
        e.instanceCount = 1 / 0,
        e
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.instanceCount = e.instanceCount,
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "toJSON",
        value: function() {
            var e = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, this);
            return e.instanceCount = this.instanceCount,
            e.isInstancedBufferGeometry = !0,
            e
        }
    }]),
    i
}();
InstancedBufferGeometry.prototype.isInstancedBufferGeometry = !0;
var ImageBitmapLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        r = t.call(this, e),
        "undefined" == typeof createImageBitmap && console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),
        "undefined" == typeof fetch && console.warn("THREE.ImageBitmapLoader: fetch() not supported."),
        r.options = {
            premultiplyAlpha: "none"
        },
        r
    }
    return _createClass2(i, [{
        key: "setOptions",
        value: function(e) {
            return this.options = e,
            this
        }
    }, {
        key: "load",
        value: function(e, t, i, r) {
            void 0 === e && (e = ""),
            void 0 !== this.path && (e = this.path + e),
            e = this.manager.resolveURL(e);
            var n = this
              , a = Cache.get(e);
            if (void 0 !== a)
                return n.manager.itemStart(e),
                setTimeout((function() {
                    t && t(a),
                    n.manager.itemEnd(e)
                }
                ), 0),
                a;
            var o = {};
            o.credentials = "anonymous" === this.crossOrigin ? "same-origin" : "include",
            o.headers = this.requestHeader,
            fetch(e, o).then((function(e) {
                return e.blob()
            }
            )).then((function(e) {
                return createImageBitmap(e, Object.assign(n.options, {
                    colorSpaceConversion: "none"
                }))
            }
            )).then((function(i) {
                Cache.add(e, i),
                t && t(i),
                n.manager.itemEnd(e)
            }
            )).catch((function(t) {
                r && r(t),
                n.manager.itemError(e),
                n.manager.itemEnd(e)
            }
            )),
            n.manager.itemStart(e)
        }
    }]),
    i
}(), _context;
ImageBitmapLoader.prototype.isImageBitmapLoader = !0;
var AudioContext = {
    getContext: function() {
        return void 0 === _context && (_context = new (window.AudioContext || window.webkitAudioContext)),
        _context
    },
    setContext: function(e) {
        _context = e
    }
}
  , AudioLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        t.call(this, e)
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            var n = this
              , a = new FileLoader(this.manager);
            a.setResponseType("arraybuffer"),
            a.setPath(this.path),
            a.setRequestHeader(this.requestHeader),
            a.setWithCredentials(this.withCredentials),
            a.load(e, (function(i) {
                try {
                    var a = i.slice(0);
                    AudioContext.getContext().decodeAudioData(a, (function(e) {
                        t(e)
                    }
                    ))
                } catch (o) {
                    r ? r(o) : console.error(o),
                    n.manager.itemError(e)
                }
            }
            ), i, r)
        }
    }]),
    i
}()
  , HemisphereLightProbe = function(e) {
    _inherits(i, LightProbe);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1;
        _classCallCheck2(this, i),
        n = t.call(this, void 0, a);
        var o = (new Color).set(e)
          , s = (new Color).set(r)
          , l = new Vector3(o.r,o.g,o.b)
          , h = new Vector3(s.r,s.g,s.b)
          , c = Math.sqrt(Math.PI)
          , p = c * Math.sqrt(.75);
        return n.sh.coefficients[0].copy(l).add(h).multiplyScalar(c),
        n.sh.coefficients[1].copy(l).sub(h).multiplyScalar(p),
        n
    }
    return _createClass2(i)
}();
HemisphereLightProbe.prototype.isHemisphereLightProbe = !0;
var AmbientLightProbe = function(e) {
    _inherits(i, LightProbe);
    var t = _createSuper(i);
    function i(e) {
        var r, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
        _classCallCheck2(this, i),
        r = t.call(this, void 0, n);
        var a = (new Color).set(e);
        return r.sh.coefficients[0].set(a.r, a.g, a.b).multiplyScalar(2 * Math.sqrt(Math.PI)),
        r
    }
    return _createClass2(i)
}();
AmbientLightProbe.prototype.isAmbientLightProbe = !0;
var Clock = function() {
    function e() {
        var t = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
        _classCallCheck2(this, e),
        this.autoStart = t,
        this.startTime = 0,
        this.oldTime = 0,
        this.elapsedTime = 0,
        this.running = !1
    }
    return _createClass2(e, [{
        key: "start",
        value: function() {
            this.startTime = now(),
            this.oldTime = this.startTime,
            this.elapsedTime = 0,
            this.running = !0
        }
    }, {
        key: "stop",
        value: function() {
            this.getElapsedTime(),
            this.running = !1,
            this.autoStart = !1
        }
    }, {
        key: "getElapsedTime",
        value: function() {
            return this.getDelta(),
            this.elapsedTime
        }
    }, {
        key: "getDelta",
        value: function() {
            var e = 0;
            if (this.autoStart && !this.running)
                return this.start(),
                0;
            if (this.running) {
                var t = now();
                e = (t - this.oldTime) / 1e3,
                this.oldTime = t,
                this.elapsedTime += e
            }
            return e
        }
    }]),
    e
}();
function now() {
    return ("undefined" == typeof performance ? Date : performance).now()
}
var _position$1 = new Vector3
  , _quaternion$1 = new Quaternion
  , _scale$1 = new Vector3
  , _orientation$1 = new Vector3
  , AudioListener = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).type = "AudioListener",
        e.context = AudioContext.getContext(),
        e.gain = e.context.createGain(),
        e.gain.connect(e.context.destination),
        e.filter = null,
        e.timeDelta = 0,
        e._clock = new Clock,
        e
    }
    return _createClass2(i, [{
        key: "getInput",
        value: function() {
            return this.gain
        }
    }, {
        key: "removeFilter",
        value: function() {
            return null !== this.filter && (this.gain.disconnect(this.filter),
            this.filter.disconnect(this.context.destination),
            this.gain.connect(this.context.destination),
            this.filter = null),
            this
        }
    }, {
        key: "getFilter",
        value: function() {
            return this.filter
        }
    }, {
        key: "setFilter",
        value: function(e) {
            return null !== this.filter ? (this.gain.disconnect(this.filter),
            this.filter.disconnect(this.context.destination)) : this.gain.disconnect(this.context.destination),
            this.filter = e,
            this.gain.connect(this.filter),
            this.filter.connect(this.context.destination),
            this
        }
    }, {
        key: "getMasterVolume",
        value: function() {
            return this.gain.gain.value
        }
    }, {
        key: "setMasterVolume",
        value: function(e) {
            return this.gain.gain.setTargetAtTime(e, this.context.currentTime, .01),
            this
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e);
            var t = this.context.listener
              , r = this.up;
            if (this.timeDelta = this._clock.getDelta(),
            this.matrixWorld.decompose(_position$1, _quaternion$1, _scale$1),
            _orientation$1.set(0, 0, -1).applyQuaternion(_quaternion$1),
            t.positionX) {
                var n = this.context.currentTime + this.timeDelta;
                t.positionX.linearRampToValueAtTime(_position$1.x, n),
                t.positionY.linearRampToValueAtTime(_position$1.y, n),
                t.positionZ.linearRampToValueAtTime(_position$1.z, n),
                t.forwardX.linearRampToValueAtTime(_orientation$1.x, n),
                t.forwardY.linearRampToValueAtTime(_orientation$1.y, n),
                t.forwardZ.linearRampToValueAtTime(_orientation$1.z, n),
                t.upX.linearRampToValueAtTime(r.x, n),
                t.upY.linearRampToValueAtTime(r.y, n),
                t.upZ.linearRampToValueAtTime(r.z, n)
            } else
                t.setPosition(_position$1.x, _position$1.y, _position$1.z),
                t.setOrientation(_orientation$1.x, _orientation$1.y, _orientation$1.z, r.x, r.y, r.z)
        }
    }]),
    i
}()
  , Audio$1 = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).type = "Audio",
        r.listener = e,
        r.context = e.context,
        r.gain = r.context.createGain(),
        r.gain.connect(e.getInput()),
        r.autoplay = !1,
        r.buffer = null,
        r.detune = 0,
        r.loop = !1,
        r.loopStart = 0,
        r.loopEnd = 0,
        r.offset = 0,
        r.duration = void 0,
        r.playbackRate = 1,
        r.isPlaying = !1,
        r.hasPlaybackControl = !0,
        r.source = null,
        r.sourceType = "empty",
        r._startedAt = 0,
        r._progress = 0,
        r._connected = !1,
        r.filters = [],
        r
    }
    return _createClass2(i, [{
        key: "getOutput",
        value: function() {
            return this.gain
        }
    }, {
        key: "setNodeSource",
        value: function(e) {
            return this.hasPlaybackControl = !1,
            this.sourceType = "audioNode",
            this.source = e,
            this.connect(),
            this
        }
    }, {
        key: "setMediaElementSource",
        value: function(e) {
            return this.hasPlaybackControl = !1,
            this.sourceType = "mediaNode",
            this.source = this.context.createMediaElementSource(e),
            this.connect(),
            this
        }
    }, {
        key: "setMediaStreamSource",
        value: function(e) {
            return this.hasPlaybackControl = !1,
            this.sourceType = "mediaStreamNode",
            this.source = this.context.createMediaStreamSource(e),
            this.connect(),
            this
        }
    }, {
        key: "setBuffer",
        value: function(e) {
            return this.buffer = e,
            this.sourceType = "buffer",
            this.autoplay && this.play(),
            this
        }
    }, {
        key: "play",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0;
            if (!0 !== this.isPlaying) {
                if (!1 !== this.hasPlaybackControl) {
                    this._startedAt = this.context.currentTime + e;
                    var t = this.context.createBufferSource();
                    return t.buffer = this.buffer,
                    t.loop = this.loop,
                    t.loopStart = this.loopStart,
                    t.loopEnd = this.loopEnd,
                    t.onended = this.onEnded.bind(this),
                    t.start(this._startedAt, this._progress + this.offset, this.duration),
                    this.isPlaying = !0,
                    this.source = t,
                    this.setDetune(this.detune),
                    this.setPlaybackRate(this.playbackRate),
                    this.connect()
                }
                console.warn("THREE.Audio: this Audio has no playback control.")
            } else
                console.warn("THREE.Audio: Audio is already playing.")
        }
    }, {
        key: "pause",
        value: function() {
            if (!1 !== this.hasPlaybackControl)
                return !0 === this.isPlaying && (this._progress += Math.max(this.context.currentTime - this._startedAt, 0) * this.playbackRate,
                !0 === this.loop && (this._progress = this._progress % (this.duration || this.buffer.duration)),
                this.source.stop(),
                this.source.onended = null,
                this.isPlaying = !1),
                this;
            console.warn("THREE.Audio: this Audio has no playback control.")
        }
    }, {
        key: "stop",
        value: function() {
            if (!1 !== this.hasPlaybackControl)
                return this._progress = 0,
                this.source.stop(),
                this.source.onended = null,
                this.isPlaying = !1,
                this;
            console.warn("THREE.Audio: this Audio has no playback control.")
        }
    }, {
        key: "connect",
        value: function() {
            if (this.filters.length > 0) {
                this.source.connect(this.filters[0]);
                for (var e = 1, t = this.filters.length; e < t; e++)
                    this.filters[e - 1].connect(this.filters[e]);
                this.filters[this.filters.length - 1].connect(this.getOutput())
            } else
                this.source.connect(this.getOutput());
            return this._connected = !0,
            this
        }
    }, {
        key: "disconnect",
        value: function() {
            if (this.filters.length > 0) {
                this.source.disconnect(this.filters[0]);
                for (var e = 1, t = this.filters.length; e < t; e++)
                    this.filters[e - 1].disconnect(this.filters[e]);
                this.filters[this.filters.length - 1].disconnect(this.getOutput())
            } else
                this.source.disconnect(this.getOutput());
            return this._connected = !1,
            this
        }
    }, {
        key: "getFilters",
        value: function() {
            return this.filters
        }
    }, {
        key: "setFilters",
        value: function(e) {
            return e || (e = []),
            !0 === this._connected ? (this.disconnect(),
            this.filters = e.slice(),
            this.connect()) : this.filters = e.slice(),
            this
        }
    }, {
        key: "setDetune",
        value: function(e) {
            if (this.detune = e,
            void 0 !== this.source.detune)
                return !0 === this.isPlaying && this.source.detune.setTargetAtTime(this.detune, this.context.currentTime, .01),
                this
        }
    }, {
        key: "getDetune",
        value: function() {
            return this.detune
        }
    }, {
        key: "getFilter",
        value: function() {
            return this.getFilters()[0]
        }
    }, {
        key: "setFilter",
        value: function(e) {
            return this.setFilters(e ? [e] : [])
        }
    }, {
        key: "setPlaybackRate",
        value: function(e) {
            if (!1 !== this.hasPlaybackControl)
                return this.playbackRate = e,
                !0 === this.isPlaying && this.source.playbackRate.setTargetAtTime(this.playbackRate, this.context.currentTime, .01),
                this;
            console.warn("THREE.Audio: this Audio has no playback control.")
        }
    }, {
        key: "getPlaybackRate",
        value: function() {
            return this.playbackRate
        }
    }, {
        key: "onEnded",
        value: function() {
            this.isPlaying = !1
        }
    }, {
        key: "getLoop",
        value: function() {
            return !1 === this.hasPlaybackControl ? (console.warn("THREE.Audio: this Audio has no playback control."),
            !1) : this.loop
        }
    }, {
        key: "setLoop",
        value: function(e) {
            if (!1 !== this.hasPlaybackControl)
                return this.loop = e,
                !0 === this.isPlaying && (this.source.loop = this.loop),
                this;
            console.warn("THREE.Audio: this Audio has no playback control.")
        }
    }, {
        key: "setLoopStart",
        value: function(e) {
            return this.loopStart = e,
            this
        }
    }, {
        key: "setLoopEnd",
        value: function(e) {
            return this.loopEnd = e,
            this
        }
    }, {
        key: "getVolume",
        value: function() {
            return this.gain.gain.value
        }
    }, {
        key: "setVolume",
        value: function(e) {
            return this.gain.gain.setTargetAtTime(e, this.context.currentTime, .01),
            this
        }
    }]),
    i
}()
  , _position = new Vector3
  , _quaternion = new Quaternion
  , _scale = new Vector3
  , _orientation = new Vector3
  , PositionalAudio = function(e) {
    _inherits(i, Audio$1);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).panner = r.context.createPanner(),
        r.panner.panningModel = "HRTF",
        r.panner.connect(r.gain),
        r
    }
    return _createClass2(i, [{
        key: "getOutput",
        value: function() {
            return this.panner
        }
    }, {
        key: "getRefDistance",
        value: function() {
            return this.panner.refDistance
        }
    }, {
        key: "setRefDistance",
        value: function(e) {
            return this.panner.refDistance = e,
            this
        }
    }, {
        key: "getRolloffFactor",
        value: function() {
            return this.panner.rolloffFactor
        }
    }, {
        key: "setRolloffFactor",
        value: function(e) {
            return this.panner.rolloffFactor = e,
            this
        }
    }, {
        key: "getDistanceModel",
        value: function() {
            return this.panner.distanceModel
        }
    }, {
        key: "setDistanceModel",
        value: function(e) {
            return this.panner.distanceModel = e,
            this
        }
    }, {
        key: "getMaxDistance",
        value: function() {
            return this.panner.maxDistance
        }
    }, {
        key: "setMaxDistance",
        value: function(e) {
            return this.panner.maxDistance = e,
            this
        }
    }, {
        key: "setDirectionalCone",
        value: function(e, t, i) {
            return this.panner.coneInnerAngle = e,
            this.panner.coneOuterAngle = t,
            this.panner.coneOuterGain = i,
            this
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            if (_get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e),
            !0 !== this.hasPlaybackControl || !1 !== this.isPlaying) {
                this.matrixWorld.decompose(_position, _quaternion, _scale),
                _orientation.set(0, 0, 1).applyQuaternion(_quaternion);
                var t = this.panner;
                if (t.positionX) {
                    var r = this.context.currentTime + this.listener.timeDelta;
                    t.positionX.linearRampToValueAtTime(_position.x, r),
                    t.positionY.linearRampToValueAtTime(_position.y, r),
                    t.positionZ.linearRampToValueAtTime(_position.z, r),
                    t.orientationX.linearRampToValueAtTime(_orientation.x, r),
                    t.orientationY.linearRampToValueAtTime(_orientation.y, r),
                    t.orientationZ.linearRampToValueAtTime(_orientation.z, r)
                } else
                    t.setPosition(_position.x, _position.y, _position.z),
                    t.setOrientation(_orientation.x, _orientation.y, _orientation.z)
            }
        }
    }]),
    i
}()
  , PropertyMixer = function() {
    function e(t, i, r) {
        var n, a, o;
        switch (_classCallCheck2(this, e),
        this.binding = t,
        this.valueSize = r,
        i) {
        case "quaternion":
            n = this._slerp,
            a = this._slerpAdditive,
            o = this._setAdditiveIdentityQuaternion,
            this.buffer = new Float64Array(6 * r),
            this._workIndex = 5;
            break;
        case "string":
        case "bool":
            n = this._select,
            a = this._select,
            o = this._setAdditiveIdentityOther,
            this.buffer = new Array(5 * r);
            break;
        default:
            n = this._lerp,
            a = this._lerpAdditive,
            o = this._setAdditiveIdentityNumeric,
            this.buffer = new Float64Array(5 * r)
        }
        this._mixBufferRegion = n,
        this._mixBufferRegionAdditive = a,
        this._setIdentity = o,
        this._origIndex = 3,
        this._addIndex = 4,
        this.cumulativeWeight = 0,
        this.cumulativeWeightAdditive = 0,
        this.useCount = 0,
        this.referenceCount = 0
    }
    return _createClass2(e, [{
        key: "accumulate",
        value: function(e, t) {
            var i = this.buffer
              , r = this.valueSize
              , n = e * r + r
              , a = this.cumulativeWeight;
            if (0 === a) {
                for (var o = 0; o !== r; ++o)
                    i[n + o] = i[o];
                a = t
            } else {
                var s = t / (a += t);
                this._mixBufferRegion(i, n, 0, s, r)
            }
            this.cumulativeWeight = a
        }
    }, {
        key: "accumulateAdditive",
        value: function(e) {
            var t = this.buffer
              , i = this.valueSize
              , r = i * this._addIndex;
            0 === this.cumulativeWeightAdditive && this._setIdentity(),
            this._mixBufferRegionAdditive(t, r, 0, e, i),
            this.cumulativeWeightAdditive += e
        }
    }, {
        key: "apply",
        value: function(e) {
            var t = this.valueSize
              , i = this.buffer
              , r = e * t + t
              , n = this.cumulativeWeight
              , a = this.cumulativeWeightAdditive
              , o = this.binding;
            if (this.cumulativeWeight = 0,
            this.cumulativeWeightAdditive = 0,
            n < 1) {
                var s = t * this._origIndex;
                this._mixBufferRegion(i, r, s, 1 - n, t)
            }
            a > 0 && this._mixBufferRegionAdditive(i, r, this._addIndex * t, 1, t);
            for (var l = t, h = t + t; l !== h; ++l)
                if (i[l] !== i[l + t]) {
                    o.setValue(i, r);
                    break
                }
        }
    }, {
        key: "saveOriginalState",
        value: function() {
            var e = this.binding
              , t = this.buffer
              , i = this.valueSize
              , r = i * this._origIndex;
            e.getValue(t, r);
            for (var n = i, a = r; n !== a; ++n)
                t[n] = t[r + n % i];
            this._setIdentity(),
            this.cumulativeWeight = 0,
            this.cumulativeWeightAdditive = 0
        }
    }, {
        key: "restoreOriginalState",
        value: function() {
            var e = 3 * this.valueSize;
            this.binding.setValue(this.buffer, e)
        }
    }, {
        key: "_setAdditiveIdentityNumeric",
        value: function() {
            for (var e = this._addIndex * this.valueSize, t = e + this.valueSize, i = e; i < t; i++)
                this.buffer[i] = 0
        }
    }, {
        key: "_setAdditiveIdentityQuaternion",
        value: function() {
            this._setAdditiveIdentityNumeric(),
            this.buffer[this._addIndex * this.valueSize + 3] = 1
        }
    }, {
        key: "_setAdditiveIdentityOther",
        value: function() {
            for (var e = this._origIndex * this.valueSize, t = this._addIndex * this.valueSize, i = 0; i < this.valueSize; i++)
                this.buffer[t + i] = this.buffer[e + i]
        }
    }, {
        key: "_select",
        value: function(e, t, i, r, n) {
            if (r >= .5)
                for (var a = 0; a !== n; ++a)
                    e[t + a] = e[i + a]
        }
    }, {
        key: "_slerp",
        value: function(e, t, i, r) {
            Quaternion.slerpFlat(e, t, e, t, e, i, r)
        }
    }, {
        key: "_slerpAdditive",
        value: function(e, t, i, r, n) {
            var a = this._workIndex * n;
            Quaternion.multiplyQuaternionsFlat(e, a, e, t, e, i),
            Quaternion.slerpFlat(e, t, e, t, e, a, r)
        }
    }, {
        key: "_lerp",
        value: function(e, t, i, r, n) {
            for (var a = 1 - r, o = 0; o !== n; ++o) {
                var s = t + o;
                e[s] = e[s] * a + e[i + o] * r
            }
        }
    }, {
        key: "_lerpAdditive",
        value: function(e, t, i, r, n) {
            for (var a = 0; a !== n; ++a) {
                var o = t + a;
                e[o] = e[o] + e[i + a] * r
            }
        }
    }]),
    e
}()
  , _RESERVED_CHARS_RE = "\\[\\]\\.:\\/"
  , _reservedRe = new RegExp("[" + _RESERVED_CHARS_RE + "]","g")
  , _wordChar = "[^" + _RESERVED_CHARS_RE + "]"
  , _wordCharOrDot = "[^" + _RESERVED_CHARS_RE.replace("\\.", "") + "]"
  , _directoryRe = /((?:WC+[\/:])*)/.source.replace("WC", _wordChar)
  , _nodeRe = /(WCOD+)?/.source.replace("WCOD", _wordCharOrDot)
  , _objectRe = /(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC", _wordChar)
  , _propertyRe = /\.(WC+)(?:\[(.+)\])?/.source.replace("WC", _wordChar)
  , _trackRe = new RegExp("^" + _directoryRe + _nodeRe + _objectRe + _propertyRe + "$")
  , _supportedObjectNames = ["material", "materials", "bones"]
  , Composite = function() {
    function e(t, i, r) {
        _classCallCheck2(this, e);
        var n = r || PropertyBinding.parseTrackName(i);
        this._targetGroup = t,
        this._bindings = t.subscribe_(i, n)
    }
    return _createClass2(e, [{
        key: "getValue",
        value: function(e, t) {
            this.bind();
            var i = this._targetGroup.nCachedObjects_
              , r = this._bindings[i];
            void 0 !== r && r.getValue(e, t)
        }
    }, {
        key: "setValue",
        value: function(e, t) {
            for (var i = this._bindings, r = this._targetGroup.nCachedObjects_, n = i.length; r !== n; ++r)
                i[r].setValue(e, t)
        }
    }, {
        key: "bind",
        value: function() {
            for (var e = this._bindings, t = this._targetGroup.nCachedObjects_, i = e.length; t !== i; ++t)
                e[t].bind()
        }
    }, {
        key: "unbind",
        value: function() {
            for (var e = this._bindings, t = this._targetGroup.nCachedObjects_, i = e.length; t !== i; ++t)
                e[t].unbind()
        }
    }]),
    e
}()
  , PropertyBinding = function() {
    function e(t, i, r) {
        _classCallCheck2(this, e),
        this.path = i,
        this.parsedPath = r || e.parseTrackName(i),
        this.node = e.findNode(t, this.parsedPath.nodeName) || t,
        this.rootNode = t,
        this.getValue = this._getValue_unbound,
        this.setValue = this._setValue_unbound
    }
    return _createClass2(e, [{
        key: "_getValue_unavailable",
        value: function() {}
    }, {
        key: "_setValue_unavailable",
        value: function() {}
    }, {
        key: "_getValue_direct",
        value: function(e, t) {
            e[t] = this.targetObject[this.propertyName]
        }
    }, {
        key: "_getValue_array",
        value: function(e, t) {
            for (var i = this.resolvedProperty, r = 0, n = i.length; r !== n; ++r)
                e[t++] = i[r]
        }
    }, {
        key: "_getValue_arrayElement",
        value: function(e, t) {
            e[t] = this.resolvedProperty[this.propertyIndex]
        }
    }, {
        key: "_getValue_toArray",
        value: function(e, t) {
            this.resolvedProperty.toArray(e, t)
        }
    }, {
        key: "_setValue_direct",
        value: function(e, t) {
            this.targetObject[this.propertyName] = e[t]
        }
    }, {
        key: "_setValue_direct_setNeedsUpdate",
        value: function(e, t) {
            this.targetObject[this.propertyName] = e[t],
            this.targetObject.needsUpdate = !0
        }
    }, {
        key: "_setValue_direct_setMatrixWorldNeedsUpdate",
        value: function(e, t) {
            this.targetObject[this.propertyName] = e[t],
            this.targetObject.matrixWorldNeedsUpdate = !0
        }
    }, {
        key: "_setValue_array",
        value: function(e, t) {
            for (var i = this.resolvedProperty, r = 0, n = i.length; r !== n; ++r)
                i[r] = e[t++]
        }
    }, {
        key: "_setValue_array_setNeedsUpdate",
        value: function(e, t) {
            for (var i = this.resolvedProperty, r = 0, n = i.length; r !== n; ++r)
                i[r] = e[t++];
            this.targetObject.needsUpdate = !0
        }
    }, {
        key: "_setValue_array_setMatrixWorldNeedsUpdate",
        value: function(e, t) {
            for (var i = this.resolvedProperty, r = 0, n = i.length; r !== n; ++r)
                i[r] = e[t++];
            this.targetObject.matrixWorldNeedsUpdate = !0
        }
    }, {
        key: "_setValue_arrayElement",
        value: function(e, t) {
            this.resolvedProperty[this.propertyIndex] = e[t]
        }
    }, {
        key: "_setValue_arrayElement_setNeedsUpdate",
        value: function(e, t) {
            this.resolvedProperty[this.propertyIndex] = e[t],
            this.targetObject.needsUpdate = !0
        }
    }, {
        key: "_setValue_arrayElement_setMatrixWorldNeedsUpdate",
        value: function(e, t) {
            this.resolvedProperty[this.propertyIndex] = e[t],
            this.targetObject.matrixWorldNeedsUpdate = !0
        }
    }, {
        key: "_setValue_fromArray",
        value: function(e, t) {
            this.resolvedProperty.fromArray(e, t)
        }
    }, {
        key: "_setValue_fromArray_setNeedsUpdate",
        value: function(e, t) {
            this.resolvedProperty.fromArray(e, t),
            this.targetObject.needsUpdate = !0
        }
    }, {
        key: "_setValue_fromArray_setMatrixWorldNeedsUpdate",
        value: function(e, t) {
            this.resolvedProperty.fromArray(e, t),
            this.targetObject.matrixWorldNeedsUpdate = !0
        }
    }, {
        key: "_getValue_unbound",
        value: function(e, t) {
            this.bind(),
            this.getValue(e, t)
        }
    }, {
        key: "_setValue_unbound",
        value: function(e, t) {
            this.bind(),
            this.setValue(e, t)
        }
    }, {
        key: "bind",
        value: function() {
            var t = this.node
              , i = this.parsedPath
              , r = i.objectName
              , n = i.propertyName
              , a = i.propertyIndex;
            if (t || (t = e.findNode(this.rootNode, i.nodeName) || this.rootNode,
            this.node = t),
            this.getValue = this._getValue_unavailable,
            this.setValue = this._setValue_unavailable,
            t) {
                if (r) {
                    var o = i.objectIndex;
                    switch (r) {
                    case "materials":
                        if (!t.material)
                            return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.", this);
                        if (!t.material.materials)
                            return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.", this);
                        t = t.material.materials;
                        break;
                    case "bones":
                        if (!t.skeleton)
                            return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.", this);
                        t = t.skeleton.bones;
                        for (var s = 0; s < t.length; s++)
                            if (t[s].name === o) {
                                o = s;
                                break
                            }
                        break;
                    default:
                        if (void 0 === t[r])
                            return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.", this);
                        t = t[r]
                    }
                    if (void 0 !== o) {
                        if (void 0 === t[o])
                            return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.", this, t);
                        t = t[o]
                    }
                }
                var l = t[n];
                if (void 0 !== l) {
                    var h = this.Versioning.None;
                    this.targetObject = t,
                    void 0 !== t.needsUpdate ? h = this.Versioning.NeedsUpdate : void 0 !== t.matrixWorldNeedsUpdate && (h = this.Versioning.MatrixWorldNeedsUpdate);
                    var c = this.BindingType.Direct;
                    if (void 0 !== a) {
                        if ("morphTargetInfluences" === n) {
                            if (!t.geometry)
                                return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.", this);
                            if (!t.geometry.isBufferGeometry)
                                return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.", this);
                            if (!t.geometry.morphAttributes)
                                return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.", this);
                            void 0 !== t.morphTargetDictionary[a] && (a = t.morphTargetDictionary[a])
                        }
                        c = this.BindingType.ArrayElement,
                        this.resolvedProperty = l,
                        this.propertyIndex = a
                    } else
                        void 0 !== l.fromArray && void 0 !== l.toArray ? (c = this.BindingType.HasFromToArray,
                        this.resolvedProperty = l) : Array.isArray(l) ? (c = this.BindingType.EntireArray,
                        this.resolvedProperty = l) : this.propertyName = n;
                    this.getValue = this.GetterByBindingType[c],
                    this.setValue = this.SetterByBindingTypeAndVersioning[c][h]
                } else {
                    var p = i.nodeName;
                    console.error("THREE.PropertyBinding: Trying to update property for track: " + p + "." + n + " but it wasn't found.", t)
                }
            } else
                console.error("THREE.PropertyBinding: Trying to update node for track: " + this.path + " but it wasn't found.")
        }
    }, {
        key: "unbind",
        value: function() {
            this.node = null,
            this.getValue = this._getValue_unbound,
            this.setValue = this._setValue_unbound
        }
    }], [{
        key: "create",
        value: function(t, i, r) {
            return t && t.isAnimationObjectGroup ? new e.Composite(t,i,r) : new e(t,i,r)
        }
    }, {
        key: "sanitizeNodeName",
        value: function(e) {
            return e.replace(/\s/g, "_").replace(_reservedRe, "")
        }
    }, {
        key: "parseTrackName",
        value: function(e) {
            var t = _trackRe.exec(e);
            if (!t)
                throw new Error("PropertyBinding: Cannot parse trackName: " + e);
            var i = {
                nodeName: t[2],
                objectName: t[3],
                objectIndex: t[4],
                propertyName: t[5],
                propertyIndex: t[6]
            }
              , r = i.nodeName && i.nodeName.lastIndexOf(".");
            if (void 0 !== r && -1 !== r) {
                var n = i.nodeName.substring(r + 1);
                -1 !== _supportedObjectNames.indexOf(n) && (i.nodeName = i.nodeName.substring(0, r),
                i.objectName = n)
            }
            if (null === i.propertyName || 0 === i.propertyName.length)
                throw new Error("PropertyBinding: can not parse propertyName from trackName: " + e);
            return i
        }
    }, {
        key: "findNode",
        value: function(e, t) {
            if (!t || "" === t || "." === t || -1 === t || t === e.name || t === e.uuid)
                return e;
            if (e.skeleton) {
                var i = e.skeleton.getBoneByName(t);
                if (void 0 !== i)
                    return i
            }
            if (e.children) {
                var r = function e(i) {
                    for (var r = 0; r < i.length; r++) {
                        var n = i[r];
                        if (n.name === t || n.uuid === t)
                            return n;
                        var a = e(n.children);
                        if (a)
                            return a
                    }
                    return null
                }(e.children);
                if (r)
                    return r
            }
            return null
        }
    }]),
    e
}();
PropertyBinding.Composite = Composite,
PropertyBinding.prototype.BindingType = {
    Direct: 0,
    EntireArray: 1,
    ArrayElement: 2,
    HasFromToArray: 3
},
PropertyBinding.prototype.Versioning = {
    None: 0,
    NeedsUpdate: 1,
    MatrixWorldNeedsUpdate: 2
},
PropertyBinding.prototype.GetterByBindingType = [PropertyBinding.prototype._getValue_direct, PropertyBinding.prototype._getValue_array, PropertyBinding.prototype._getValue_arrayElement, PropertyBinding.prototype._getValue_toArray],
PropertyBinding.prototype.SetterByBindingTypeAndVersioning = [[PropertyBinding.prototype._setValue_direct, PropertyBinding.prototype._setValue_direct_setNeedsUpdate, PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate], [PropertyBinding.prototype._setValue_array, PropertyBinding.prototype._setValue_array_setNeedsUpdate, PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate], [PropertyBinding.prototype._setValue_arrayElement, PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate, PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate], [PropertyBinding.prototype._setValue_fromArray, PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate, PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];
var AnimationAction = function() {
    function e(t, i) {
        var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : i.blendMode;
        _classCallCheck2(this, e),
        this._mixer = t,
        this._clip = i,
        this._localRoot = r,
        this.blendMode = n;
        for (var a = i.tracks, o = a.length, s = new Array(o), l = {
            endingStart: ZeroCurvatureEnding,
            endingEnd: ZeroCurvatureEnding
        }, h = 0; h !== o; ++h) {
            var c = a[h].createInterpolant(null);
            s[h] = c,
            c.settings = l
        }
        this._interpolantSettings = l,
        this._interpolants = s,
        this._propertyBindings = new Array(o),
        this._cacheIndex = null,
        this._byClipCacheIndex = null,
        this._timeScaleInterpolant = null,
        this._weightInterpolant = null,
        this.loop = LoopRepeat,
        this._loopCount = -1,
        this._startTime = null,
        this.time = 0,
        this.timeScale = 1,
        this._effectiveTimeScale = 1,
        this.weight = 1,
        this._effectiveWeight = 1,
        this.repetitions = 1 / 0,
        this.paused = !1,
        this.enabled = !0,
        this.clampWhenFinished = !1,
        this.zeroSlopeAtStart = !0,
        this.zeroSlopeAtEnd = !0
    }
    return _createClass2(e, [{
        key: "play",
        value: function() {
            return this._mixer._activateAction(this),
            this
        }
    }, {
        key: "stop",
        value: function() {
            return this._mixer._deactivateAction(this),
            this.reset()
        }
    }, {
        key: "reset",
        value: function() {
            return this.paused = !1,
            this.enabled = !0,
            this.time = 0,
            this._loopCount = -1,
            this._startTime = null,
            this.stopFading().stopWarping()
        }
    }, {
        key: "isRunning",
        value: function() {
            return this.enabled && !this.paused && 0 !== this.timeScale && null === this._startTime && this._mixer._isActiveAction(this)
        }
    }, {
        key: "isScheduled",
        value: function() {
            return this._mixer._isActiveAction(this)
        }
    }, {
        key: "startAt",
        value: function(e) {
            return this._startTime = e,
            this
        }
    }, {
        key: "setLoop",
        value: function(e, t) {
            return this.loop = e,
            this.repetitions = t,
            this
        }
    }, {
        key: "setEffectiveWeight",
        value: function(e) {
            return this.weight = e,
            this._effectiveWeight = this.enabled ? e : 0,
            this.stopFading()
        }
    }, {
        key: "getEffectiveWeight",
        value: function() {
            return this._effectiveWeight
        }
    }, {
        key: "fadeIn",
        value: function(e) {
            return this._scheduleFading(e, 0, 1)
        }
    }, {
        key: "fadeOut",
        value: function(e) {
            return this._scheduleFading(e, 1, 0)
        }
    }, {
        key: "crossFadeFrom",
        value: function(e, t, i) {
            if (e.fadeOut(t),
            this.fadeIn(t),
            i) {
                var r = this._clip.duration
                  , n = e._clip.duration
                  , a = n / r
                  , o = r / n;
                e.warp(1, a, t),
                this.warp(o, 1, t)
            }
            return this
        }
    }, {
        key: "crossFadeTo",
        value: function(e, t, i) {
            return e.crossFadeFrom(this, t, i)
        }
    }, {
        key: "stopFading",
        value: function() {
            var e = this._weightInterpolant;
            return null !== e && (this._weightInterpolant = null,
            this._mixer._takeBackControlInterpolant(e)),
            this
        }
    }, {
        key: "setEffectiveTimeScale",
        value: function(e) {
            return this.timeScale = e,
            this._effectiveTimeScale = this.paused ? 0 : e,
            this.stopWarping()
        }
    }, {
        key: "getEffectiveTimeScale",
        value: function() {
            return this._effectiveTimeScale
        }
    }, {
        key: "setDuration",
        value: function(e) {
            return this.timeScale = this._clip.duration / e,
            this.stopWarping()
        }
    }, {
        key: "syncWith",
        value: function(e) {
            return this.time = e.time,
            this.timeScale = e.timeScale,
            this.stopWarping()
        }
    }, {
        key: "halt",
        value: function(e) {
            return this.warp(this._effectiveTimeScale, 0, e)
        }
    }, {
        key: "warp",
        value: function(e, t, i) {
            var r = this._mixer
              , n = r.time
              , a = this.timeScale
              , o = this._timeScaleInterpolant;
            null === o && (o = r._lendControlInterpolant(),
            this._timeScaleInterpolant = o);
            var s = o.parameterPositions
              , l = o.sampleValues;
            return s[0] = n,
            s[1] = n + i,
            l[0] = e / a,
            l[1] = t / a,
            this
        }
    }, {
        key: "stopWarping",
        value: function() {
            var e = this._timeScaleInterpolant;
            return null !== e && (this._timeScaleInterpolant = null,
            this._mixer._takeBackControlInterpolant(e)),
            this
        }
    }, {
        key: "getMixer",
        value: function() {
            return this._mixer
        }
    }, {
        key: "getClip",
        value: function() {
            return this._clip
        }
    }, {
        key: "getRoot",
        value: function() {
            return this._localRoot || this._mixer._root
        }
    }, {
        key: "_update",
        value: function(e, t, i, r) {
            if (this.enabled) {
                var n = this._startTime;
                if (null !== n) {
                    var a = (e - n) * i;
                    if (a < 0 || 0 === i)
                        return;
                    this._startTime = null,
                    t = i * a
                }
                t *= this._updateTimeScale(e);
                var o = this._updateTime(t)
                  , s = this._updateWeight(e);
                if (s > 0) {
                    var l = this._interpolants
                      , h = this._propertyBindings;
                    if (this.blendMode === AdditiveAnimationBlendMode)
                        for (var c = 0, p = l.length; c !== p; ++c)
                            l[c].evaluate(o),
                            h[c].accumulateAdditive(s);
                    else
                        for (var u = 0, d = l.length; u !== d; ++u)
                            l[u].evaluate(o),
                            h[u].accumulate(r, s)
                }
            } else
                this._updateWeight(e)
        }
    }, {
        key: "_updateWeight",
        value: function(e) {
            var t = 0;
            if (this.enabled) {
                t = this.weight;
                var i = this._weightInterpolant;
                if (null !== i) {
                    var r = i.evaluate(e)[0];
                    t *= r,
                    e > i.parameterPositions[1] && (this.stopFading(),
                    0 === r && (this.enabled = !1))
                }
            }
            return this._effectiveWeight = t,
            t
        }
    }, {
        key: "_updateTimeScale",
        value: function(e) {
            var t = 0;
            if (!this.paused) {
                t = this.timeScale;
                var i = this._timeScaleInterpolant;
                null !== i && (t *= i.evaluate(e)[0],
                e > i.parameterPositions[1] && (this.stopWarping(),
                0 === t ? this.paused = !0 : this.timeScale = t))
            }
            return this._effectiveTimeScale = t,
            t
        }
    }, {
        key: "_updateTime",
        value: function(e) {
            var t = this._clip.duration
              , i = this.loop
              , r = this.time + e
              , n = this._loopCount
              , a = i === LoopPingPong;
            if (0 === e)
                return -1 === n ? r : a && 1 == (1 & n) ? t - r : r;
            if (i === LoopOnce) {
                -1 === n && (this._loopCount = 0,
                this._setEndings(!0, !0, !1));
                e: {
                    if (r >= t)
                        r = t;
                    else {
                        if (!(r < 0)) {
                            this.time = r;
                            break e
                        }
                        r = 0
                    }
                    this.clampWhenFinished ? this.paused = !0 : this.enabled = !1,
                    this.time = r,
                    this._mixer.dispatchEvent({
                        type: "finished",
                        action: this,
                        direction: e < 0 ? -1 : 1
                    })
                }
            } else {
                if (-1 === n && (e >= 0 ? (n = 0,
                this._setEndings(!0, 0 === this.repetitions, a)) : this._setEndings(0 === this.repetitions, !0, a)),
                r >= t || r < 0) {
                    var o = Math.floor(r / t);
                    r -= t * o,
                    n += Math.abs(o);
                    var s = this.repetitions - n;
                    if (s <= 0)
                        this.clampWhenFinished ? this.paused = !0 : this.enabled = !1,
                        r = e > 0 ? t : 0,
                        this.time = r,
                        this._mixer.dispatchEvent({
                            type: "finished",
                            action: this,
                            direction: e > 0 ? 1 : -1
                        });
                    else {
                        if (1 === s) {
                            var l = e < 0;
                            this._setEndings(l, !l, a)
                        } else
                            this._setEndings(!1, !1, a);
                        this._loopCount = n,
                        this.time = r,
                        this._mixer.dispatchEvent({
                            type: "loop",
                            action: this,
                            loopDelta: o
                        })
                    }
                } else
                    this.time = r;
                if (a && 1 == (1 & n))
                    return t - r
            }
            return r
        }
    }, {
        key: "_setEndings",
        value: function(e, t, i) {
            var r = this._interpolantSettings;
            i ? (r.endingStart = ZeroSlopeEnding,
            r.endingEnd = ZeroSlopeEnding) : (r.endingStart = e ? this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding : WrapAroundEnding,
            r.endingEnd = t ? this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding : WrapAroundEnding)
        }
    }, {
        key: "_scheduleFading",
        value: function(e, t, i) {
            var r = this._mixer
              , n = r.time
              , a = this._weightInterpolant;
            null === a && (a = r._lendControlInterpolant(),
            this._weightInterpolant = a);
            var o = a.parameterPositions
              , s = a.sampleValues;
            return o[0] = n,
            s[0] = t,
            o[1] = n + e,
            s[1] = i,
            this
        }
    }]),
    e
}()
  , AnimationMixer = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this))._root = e,
        r._initMemoryManager(),
        r._accuIndex = 0,
        r.time = 0,
        r.timeScale = 1,
        r
    }
    return _createClass2(i, [{
        key: "_bindAction",
        value: function(e, t) {
            var i = e._localRoot || this._root
              , r = e._clip.tracks
              , n = r.length
              , a = e._propertyBindings
              , o = e._interpolants
              , s = i.uuid
              , l = this._bindingsByRootAndName
              , h = l[s];
            void 0 === h && (h = {},
            l[s] = h);
            for (var c = 0; c !== n; ++c) {
                var p = r[c]
                  , u = p.name
                  , d = h[u];
                if (void 0 !== d)
                    a[c] = d;
                else {
                    if (void 0 !== (d = a[c])) {
                        null === d._cacheIndex && (++d.referenceCount,
                        this._addInactiveBinding(d, s, u));
                        continue
                    }
                    var f = t && t._propertyBindings[c].binding.parsedPath;
                    ++(d = new PropertyMixer(PropertyBinding.create(i, u, f),p.ValueTypeName,p.getValueSize())).referenceCount,
                    this._addInactiveBinding(d, s, u),
                    a[c] = d
                }
                o[c].resultBuffer = d.buffer
            }
        }
    }, {
        key: "_activateAction",
        value: function(e) {
            if (!this._isActiveAction(e)) {
                if (null === e._cacheIndex) {
                    var t = (e._localRoot || this._root).uuid
                      , i = e._clip.uuid
                      , r = this._actionsByClip[i];
                    this._bindAction(e, r && r.knownActions[0]),
                    this._addInactiveAction(e, i, t)
                }
                for (var n = e._propertyBindings, a = 0, o = n.length; a !== o; ++a) {
                    var s = n[a];
                    0 == s.useCount++ && (this._lendBinding(s),
                    s.saveOriginalState())
                }
                this._lendAction(e)
            }
        }
    }, {
        key: "_deactivateAction",
        value: function(e) {
            if (this._isActiveAction(e)) {
                for (var t = e._propertyBindings, i = 0, r = t.length; i !== r; ++i) {
                    var n = t[i];
                    0 == --n.useCount && (n.restoreOriginalState(),
                    this._takeBackBinding(n))
                }
                this._takeBackAction(e)
            }
        }
    }, {
        key: "_initMemoryManager",
        value: function() {
            this._actions = [],
            this._nActiveActions = 0,
            this._actionsByClip = {},
            this._bindings = [],
            this._nActiveBindings = 0,
            this._bindingsByRootAndName = {},
            this._controlInterpolants = [],
            this._nActiveControlInterpolants = 0;
            var e = this;
            this.stats = {
                actions: {
                    get total() {
                        return e._actions.length
                    },
                    get inUse() {
                        return e._nActiveActions
                    }
                },
                bindings: {
                    get total() {
                        return e._bindings.length
                    },
                    get inUse() {
                        return e._nActiveBindings
                    }
                },
                controlInterpolants: {
                    get total() {
                        return e._controlInterpolants.length
                    },
                    get inUse() {
                        return e._nActiveControlInterpolants
                    }
                }
            }
        }
    }, {
        key: "_isActiveAction",
        value: function(e) {
            var t = e._cacheIndex;
            return null !== t && t < this._nActiveActions
        }
    }, {
        key: "_addInactiveAction",
        value: function(e, t, i) {
            var r = this._actions
              , n = this._actionsByClip
              , a = n[t];
            if (void 0 === a)
                a = {
                    knownActions: [e],
                    actionByRoot: {}
                },
                e._byClipCacheIndex = 0,
                n[t] = a;
            else {
                var o = a.knownActions;
                e._byClipCacheIndex = o.length,
                o.push(e)
            }
            e._cacheIndex = r.length,
            r.push(e),
            a.actionByRoot[i] = e
        }
    }, {
        key: "_removeInactiveAction",
        value: function(e) {
            var t = this._actions
              , i = t[t.length - 1]
              , r = e._cacheIndex;
            i._cacheIndex = r,
            t[r] = i,
            t.pop(),
            e._cacheIndex = null;
            var n = e._clip.uuid
              , a = this._actionsByClip
              , o = a[n]
              , s = o.knownActions
              , l = s[s.length - 1]
              , h = e._byClipCacheIndex;
            l._byClipCacheIndex = h,
            s[h] = l,
            s.pop(),
            e._byClipCacheIndex = null,
            delete o.actionByRoot[(e._localRoot || this._root).uuid],
            0 === s.length && delete a[n],
            this._removeInactiveBindingsForAction(e)
        }
    }, {
        key: "_removeInactiveBindingsForAction",
        value: function(e) {
            for (var t = e._propertyBindings, i = 0, r = t.length; i !== r; ++i) {
                var n = t[i];
                0 == --n.referenceCount && this._removeInactiveBinding(n)
            }
        }
    }, {
        key: "_lendAction",
        value: function(e) {
            var t = this._actions
              , i = e._cacheIndex
              , r = this._nActiveActions++
              , n = t[r];
            e._cacheIndex = r,
            t[r] = e,
            n._cacheIndex = i,
            t[i] = n
        }
    }, {
        key: "_takeBackAction",
        value: function(e) {
            var t = this._actions
              , i = e._cacheIndex
              , r = --this._nActiveActions
              , n = t[r];
            e._cacheIndex = r,
            t[r] = e,
            n._cacheIndex = i,
            t[i] = n
        }
    }, {
        key: "_addInactiveBinding",
        value: function(e, t, i) {
            var r = this._bindingsByRootAndName
              , n = this._bindings
              , a = r[t];
            void 0 === a && (a = {},
            r[t] = a),
            a[i] = e,
            e._cacheIndex = n.length,
            n.push(e)
        }
    }, {
        key: "_removeInactiveBinding",
        value: function(e) {
            var t = this._bindings
              , i = e.binding
              , r = i.rootNode.uuid
              , n = i.path
              , a = this._bindingsByRootAndName
              , o = a[r]
              , s = t[t.length - 1]
              , l = e._cacheIndex;
            s._cacheIndex = l,
            t[l] = s,
            t.pop(),
            delete o[n],
            0 === Object.keys(o).length && delete a[r]
        }
    }, {
        key: "_lendBinding",
        value: function(e) {
            var t = this._bindings
              , i = e._cacheIndex
              , r = this._nActiveBindings++
              , n = t[r];
            e._cacheIndex = r,
            t[r] = e,
            n._cacheIndex = i,
            t[i] = n
        }
    }, {
        key: "_takeBackBinding",
        value: function(e) {
            var t = this._bindings
              , i = e._cacheIndex
              , r = --this._nActiveBindings
              , n = t[r];
            e._cacheIndex = r,
            t[r] = e,
            n._cacheIndex = i,
            t[i] = n
        }
    }, {
        key: "_lendControlInterpolant",
        value: function() {
            var e = this._controlInterpolants
              , t = this._nActiveControlInterpolants++
              , i = e[t];
            return void 0 === i && ((i = new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex = t,
            e[t] = i),
            i
        }
    }, {
        key: "_takeBackControlInterpolant",
        value: function(e) {
            var t = this._controlInterpolants
              , i = e.__cacheIndex
              , r = --this._nActiveControlInterpolants
              , n = t[r];
            e.__cacheIndex = r,
            t[r] = e,
            n.__cacheIndex = i,
            t[i] = n
        }
    }, {
        key: "clipAction",
        value: function(e, t, i) {
            var r = t || this._root
              , n = r.uuid
              , a = "string" == typeof e ? AnimationClip.findByName(r, e) : e
              , o = null !== a ? a.uuid : e
              , s = this._actionsByClip[o]
              , l = null;
            if (void 0 === i && (i = null !== a ? a.blendMode : NormalAnimationBlendMode),
            void 0 !== s) {
                var h = s.actionByRoot[n];
                if (void 0 !== h && h.blendMode === i)
                    return h;
                l = s.knownActions[0],
                null === a && (a = l._clip)
            }
            if (null === a)
                return null;
            var c = new AnimationAction(this,a,t,i);
            return this._bindAction(c, l),
            this._addInactiveAction(c, o, n),
            c
        }
    }, {
        key: "existingAction",
        value: function(e, t) {
            var i = t || this._root
              , r = i.uuid
              , n = "string" == typeof e ? AnimationClip.findByName(i, e) : e
              , a = n ? n.uuid : e
              , o = this._actionsByClip[a];
            return void 0 !== o && o.actionByRoot[r] || null
        }
    }, {
        key: "stopAllAction",
        value: function() {
            for (var e = this._actions, t = this._nActiveActions - 1; t >= 0; --t)
                e[t].stop();
            return this
        }
    }, {
        key: "update",
        value: function(e) {
            e *= this.timeScale;
            for (var t = this._actions, i = this._nActiveActions, r = this.time += e, n = Math.sign(e), a = this._accuIndex ^= 1, o = 0; o !== i; ++o)
                t[o]._update(r, e, n, a);
            for (var s = this._bindings, l = this._nActiveBindings, h = 0; h !== l; ++h)
                s[h].apply(a);
            return this
        }
    }, {
        key: "setTime",
        value: function(e) {
            this.time = 0;
            for (var t = 0; t < this._actions.length; t++)
                this._actions[t].time = 0;
            return this.update(e)
        }
    }, {
        key: "getRoot",
        value: function() {
            return this._root
        }
    }, {
        key: "uncacheClip",
        value: function(e) {
            var t = this._actions
              , i = e.uuid
              , r = this._actionsByClip
              , n = r[i];
            if (void 0 !== n) {
                for (var a = n.knownActions, o = 0, s = a.length; o !== s; ++o) {
                    var l = a[o];
                    this._deactivateAction(l);
                    var h = l._cacheIndex
                      , c = t[t.length - 1];
                    l._cacheIndex = null,
                    l._byClipCacheIndex = null,
                    c._cacheIndex = h,
                    t[h] = c,
                    t.pop(),
                    this._removeInactiveBindingsForAction(l)
                }
                delete r[i]
            }
        }
    }, {
        key: "uncacheRoot",
        value: function(e) {
            var t = e.uuid
              , i = this._actionsByClip;
            for (var r in i) {
                var n = i[r].actionByRoot[t];
                void 0 !== n && (this._deactivateAction(n),
                this._removeInactiveAction(n))
            }
            var a = this._bindingsByRootAndName[t];
            if (void 0 !== a)
                for (var o in a) {
                    var s = a[o];
                    s.restoreOriginalState(),
                    this._removeInactiveBinding(s)
                }
        }
    }, {
        key: "uncacheAction",
        value: function(e, t) {
            var i = this.existingAction(e, t);
            null !== i && (this._deactivateAction(i),
            this._removeInactiveAction(i))
        }
    }]),
    i
}();
AnimationMixer.prototype._controlInterpolantsResultBuffer = new Float32Array(1);
var InstancedInterleavedBuffer = function(e) {
    _inherits(i, InterleavedBuffer);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, r)).meshPerAttribute = a,
        n
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.meshPerAttribute = e.meshPerAttribute,
            this
        }
    }, {
        key: "clone",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "clone", this).call(this, e);
            return t.meshPerAttribute = this.meshPerAttribute,
            t
        }
    }, {
        key: "toJSON",
        value: function(e) {
            var t = _get(_getPrototypeOf(i.prototype), "toJSON", this).call(this, e);
            return t.isInstancedInterleavedBuffer = !0,
            t.meshPerAttribute = this.meshPerAttribute,
            t
        }
    }]),
    i
}();
InstancedInterleavedBuffer.prototype.isInstancedInterleavedBuffer = !0;
var Raycaster = function() {
    function e(t, i) {
        var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1 / 0;
        _classCallCheck2(this, e),
        this.ray = new Ray(t,i),
        this.near = r,
        this.far = n,
        this.camera = null,
        this.layers = new Layers,
        this.params = {
            Mesh: {},
            Line: {
                threshold: 1
            },
            LOD: {},
            Points: {
                threshold: 1
            },
            Sprite: {}
        }
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t) {
            this.ray.set(e, t)
        }
    }, {
        key: "setFromCamera",
        value: function(e, t) {
            t && t.isPerspectiveCamera ? (this.ray.origin.setFromMatrixPosition(t.matrixWorld),
            this.ray.direction.set(e.x, e.y, .5).unproject(t).sub(this.ray.origin).normalize(),
            this.camera = t) : t && t.isOrthographicCamera ? (this.ray.origin.set(e.x, e.y, (t.near + t.far) / (t.near - t.far)).unproject(t),
            this.ray.direction.set(0, 0, -1).transformDirection(t.matrixWorld),
            this.camera = t) : console.error("THREE.Raycaster: Unsupported camera type: " + t.type)
        }
    }, {
        key: "intersectObject",
        value: function(e) {
            var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
              , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : [];
            return _intersectObject(e, this, i, t),
            i.sort(ascSort),
            i
        }
    }, {
        key: "intersectObjects",
        value: function(e) {
            for (var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1], i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : [], r = 0, n = e.length; r < n; r++)
                _intersectObject(e[r], this, i, t);
            return i.sort(ascSort),
            i
        }
    }]),
    e
}();
function ascSort(e, t) {
    return e.distance - t.distance
}
function _intersectObject(e, t, i, r) {
    if (e.layers.test(t.layers) && e.raycast(t, i),
    !0 === r)
        for (var n = e.children, a = 0, o = n.length; a < o; a++)
            _intersectObject(n[a], t, i, !0)
}
var Spherical = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
        return _classCallCheck2(this, e),
        this.radius = t,
        this.phi = i,
        this.theta = r,
        this
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i) {
            return this.radius = e,
            this.phi = t,
            this.theta = i,
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.radius = e.radius,
            this.phi = e.phi,
            this.theta = e.theta,
            this
        }
    }, {
        key: "makeSafe",
        value: function() {
            var e = 1e-6;
            return this.phi = Math.max(e, Math.min(Math.PI - e, this.phi)),
            this
        }
    }, {
        key: "setFromVector3",
        value: function(e) {
            return this.setFromCartesianCoords(e.x, e.y, e.z)
        }
    }, {
        key: "setFromCartesianCoords",
        value: function(e, t, i) {
            return this.radius = Math.sqrt(e * e + t * t + i * i),
            0 === this.radius ? (this.theta = 0,
            this.phi = 0) : (this.theta = Math.atan2(e, i),
            this.phi = Math.acos(clamp(t / this.radius, -1, 1))),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }]),
    e
}()
  , ImmediateRenderObject = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this)).material = e,
        r.render = function() {}
        ,
        r.hasPositions = !1,
        r.hasNormals = !1,
        r.hasColors = !1,
        r.hasUvs = !1,
        r.positionArray = null,
        r.normalArray = null,
        r.colorArray = null,
        r.uvArray = null,
        r.count = 0,
        r
    }
    return _createClass2(i)
}();
ImmediateRenderObject.prototype.isImmediateRenderObject = !0;
var _vector$2 = new Vector3
  , _boneMatrix = new Matrix4
  , _matrixWorldInv = new Matrix4
  , SkeletonHelper = function(e) {
    _inherits(i, LineSegments);
    var t = _createSuper(i);
    function i(e) {
        var r;
        _classCallCheck2(this, i);
        for (var n = getBoneList(e), a = new BufferGeometry, o = [], s = [], l = new Color(0,0,1), h = new Color(0,1,0), c = 0; c < n.length; c++) {
            var p = n[c];
            p.parent && p.parent.isBone && (o.push(0, 0, 0),
            o.push(0, 0, 0),
            s.push(l.r, l.g, l.b),
            s.push(h.r, h.g, h.b))
        }
        a.setAttribute("position", new Float32BufferAttribute(o,3)),
        a.setAttribute("color", new Float32BufferAttribute(s,3));
        var u = new LineBasicMaterial({
            vertexColors: !0,
            depthTest: !1,
            depthWrite: !1,
            toneMapped: !1,
            transparent: !0
        });
        return (r = t.call(this, a, u)).type = "SkeletonHelper",
        r.isSkeletonHelper = !0,
        r.root = e,
        r.bones = n,
        r.matrix = e.matrixWorld,
        r.matrixAutoUpdate = !1,
        r
    }
    return _createClass2(i, [{
        key: "updateMatrixWorld",
        value: function(e) {
            var t = this.bones
              , r = this.geometry
              , n = r.getAttribute("position");
            _matrixWorldInv.copy(this.root.matrixWorld).invert();
            for (var a = 0, o = 0; a < t.length; a++) {
                var s = t[a];
                s.parent && s.parent.isBone && (_boneMatrix.multiplyMatrices(_matrixWorldInv, s.matrixWorld),
                _vector$2.setFromMatrixPosition(_boneMatrix),
                n.setXYZ(o, _vector$2.x, _vector$2.y, _vector$2.z),
                _boneMatrix.multiplyMatrices(_matrixWorldInv, s.parent.matrixWorld),
                _vector$2.setFromMatrixPosition(_boneMatrix),
                n.setXYZ(o + 1, _vector$2.x, _vector$2.y, _vector$2.z),
                o += 2)
            }
            r.getAttribute("position").needsUpdate = !0,
            _get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e)
        }
    }]),
    i
}();
function getBoneList(e) {
    var t = [];
    e && e.isBone && t.push(e);
    for (var i = 0; i < e.children.length; i++)
        t.push.apply(t, getBoneList(e.children[i]));
    return t
}
var GridHelper = function(e) {
    _inherits(i, LineSegments);
    var t = _createSuper(i);
    function i() {
        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 10, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 10, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 4473924, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 8947848;
        _classCallCheck2(this, i),
        a = new Color(a),
        o = new Color(o);
        for (var s = n / 2, l = r / n, h = r / 2, c = [], p = [], u = 0, d = 0, f = -h; u <= n; u++,
        f += l) {
            c.push(-h, 0, f, h, 0, f),
            c.push(f, 0, -h, f, 0, h);
            var m = u === s ? a : o;
            m.toArray(p, d),
            d += 3,
            m.toArray(p, d),
            d += 3,
            m.toArray(p, d),
            d += 3,
            m.toArray(p, d),
            d += 3
        }
        var g = new BufferGeometry;
        g.setAttribute("position", new Float32BufferAttribute(c,3)),
        g.setAttribute("color", new Float32BufferAttribute(p,3));
        var v = new LineBasicMaterial({
            vertexColors: !0,
            toneMapped: !1
        });
        return (e = t.call(this, g, v)).type = "GridHelper",
        e
    }
    return _createClass2(i)
}()
  , _floatView = new Float32Array(1)
  , _int32View = new Int32Array(_floatView.buffer)
  , DataUtils = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, null, [{
        key: "toHalfFloat",
        value: function(e) {
            e > 65504 && (console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),
            e = 65504),
            _floatView[0] = e;
            var t = _int32View[0]
              , i = t >> 16 & 32768
              , r = t >> 12 & 2047
              , n = t >> 23 & 255;
            return n < 103 ? i : n > 142 ? (i |= 31744,
            i |= (255 == n ? 0 : 1) && 8388607 & t) : n < 113 ? i |= ((r |= 2048) >> 114 - n) + (r >> 113 - n & 1) : (i |= n - 112 << 10 | r >> 1,
            i += 1 & r)
        }
    }]),
    e
}();
function ownKeys(e, t) {
    var i = Object.keys(e);
    if (Object.getOwnPropertySymbols) {
        var r = Object.getOwnPropertySymbols(e);
        t && (r = r.filter((function(t) {
            return Object.getOwnPropertyDescriptor(e, t).enumerable
        }
        ))),
        i.push.apply(i, r)
    }
    return i
}
function _objectSpread2(e) {
    for (var t = 1; t < arguments.length; t++) {
        var i = null != arguments[t] ? arguments[t] : {};
        t % 2 ? ownKeys(Object(i), !0).forEach((function(t) {
            _defineProperty(e, t, i[t])
        }
        )) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : ownKeys(Object(i)).forEach((function(t) {
            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
        }
        ))
    }
    return e
}
function asyncGeneratorStep(e, t, i, r, n, a, o) {
    try {
        var s = e[a](o)
          , l = s.value
    } catch (h) {
        return void i(h)
    }
    s.done ? t(l) : Promise.resolve(l).then(r, n)
}
function _asyncToGenerator(e) {
    return function() {
        var t = this
          , i = arguments;
        return new Promise((function(r, n) {
            var a = e.apply(t, i);
            function o(e) {
                asyncGeneratorStep(a, r, n, o, s, "next", e)
            }
            function s(e) {
                asyncGeneratorStep(a, r, n, o, s, "throw", e)
            }
            o(void 0)
        }
        ))
    }
}
function _defineProperty(e, t, i) {
    return t in e ? Object.defineProperty(e, t, {
        value: i,
        enumerable: !0,
        configurable: !0,
        writable: !0
    }) : e[t] = i,
    e
}
function _taggedTemplateLiteral(e, t) {
    return t || (t = e.slice(0)),
    Object.freeze(Object.defineProperties(e, {
        raw: {
            value: Object.freeze(t)
        }
    }))
}
function __decorate(e, t, i, r) {
    var n, a = arguments.length, o = a < 3 ? t : null === r ? r = Object.getOwnPropertyDescriptor(t, i) : r;
    if ("object" == ("undefined" == typeof Reflect ? "undefined" : _typeof2(Reflect)) && "function" == typeof Reflect.decorate)
        o = Reflect.decorate(e, t, i, r);
    else
        for (var s = e.length - 1; s >= 0; s--)
            (n = e[s]) && (o = (a < 3 ? n(o) : a > 3 ? n(t, i, o) : n(t, i)) || o);
    return a > 3 && o && Object.defineProperty(t, i, o),
    o
}
Curve.create = function(e, t) {
    return console.log("THREE.Curve.create() has been deprecated"),
    e.prototype = Object.create(Curve.prototype),
    e.prototype.constructor = e,
    e.prototype.getPoint = t,
    e
}
,
Path.prototype.fromPoints = function(e) {
    return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),
    this.setFromPoints(e)
}
,
GridHelper.prototype.setColors = function() {
    console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")
}
,
SkeletonHelper.prototype.update = function() {
    console.error("THREE.SkeletonHelper: update() no longer needs to be called.")
}
,
Loader.prototype.extractUrlBase = function(e) {
    return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),
    LoaderUtils.extractUrlBase(e)
}
,
Loader.Handlers = {
    add: function() {
        console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")
    },
    get: function() {
        console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")
    }
},
Box3.prototype.center = function(e) {
    return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),
    this.getCenter(e)
}
,
Box3.prototype.empty = function() {
    return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),
    this.isEmpty()
}
,
Box3.prototype.isIntersectionBox = function(e) {
    return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),
    this.intersectsBox(e)
}
,
Box3.prototype.isIntersectionSphere = function(e) {
    return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),
    this.intersectsSphere(e)
}
,
Box3.prototype.size = function(e) {
    return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),
    this.getSize(e)
}
,
Sphere.prototype.empty = function() {
    return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),
    this.isEmpty()
}
,
Frustum.prototype.setFromMatrix = function(e) {
    return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),
    this.setFromProjectionMatrix(e)
}
,
Matrix3.prototype.flattenToArrayOffset = function(e, t) {
    return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),
    this.toArray(e, t)
}
,
Matrix3.prototype.multiplyVector3 = function(e) {
    return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),
    e.applyMatrix3(this)
}
,
Matrix3.prototype.multiplyVector3Array = function() {
    console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")
}
,
Matrix3.prototype.applyToBufferAttribute = function(e) {
    return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),
    e.applyMatrix3(this)
}
,
Matrix3.prototype.applyToVector3Array = function() {
    console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")
}
,
Matrix3.prototype.getInverse = function(e) {
    return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),
    this.copy(e).invert()
}
,
Matrix4.prototype.extractPosition = function(e) {
    return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),
    this.copyPosition(e)
}
,
Matrix4.prototype.flattenToArrayOffset = function(e, t) {
    return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),
    this.toArray(e, t)
}
,
Matrix4.prototype.getPosition = function() {
    return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),
    (new Vector3).setFromMatrixColumn(this, 3)
}
,
Matrix4.prototype.setRotationFromQuaternion = function(e) {
    return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),
    this.makeRotationFromQuaternion(e)
}
,
Matrix4.prototype.multiplyToArray = function() {
    console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")
}
,
Matrix4.prototype.multiplyVector3 = function(e) {
    return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),
    e.applyMatrix4(this)
}
,
Matrix4.prototype.multiplyVector4 = function(e) {
    return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),
    e.applyMatrix4(this)
}
,
Matrix4.prototype.multiplyVector3Array = function() {
    console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")
}
,
Matrix4.prototype.rotateAxis = function(e) {
    console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),
    e.transformDirection(this)
}
,
Matrix4.prototype.crossVector = function(e) {
    return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),
    e.applyMatrix4(this)
}
,
Matrix4.prototype.translate = function() {
    console.error("THREE.Matrix4: .translate() has been removed.")
}
,
Matrix4.prototype.rotateX = function() {
    console.error("THREE.Matrix4: .rotateX() has been removed.")
}
,
Matrix4.prototype.rotateY = function() {
    console.error("THREE.Matrix4: .rotateY() has been removed.")
}
,
Matrix4.prototype.rotateZ = function() {
    console.error("THREE.Matrix4: .rotateZ() has been removed.")
}
,
Matrix4.prototype.rotateByAxis = function() {
    console.error("THREE.Matrix4: .rotateByAxis() has been removed.")
}
,
Matrix4.prototype.applyToBufferAttribute = function(e) {
    return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),
    e.applyMatrix4(this)
}
,
Matrix4.prototype.applyToVector3Array = function() {
    console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")
}
,
Matrix4.prototype.makeFrustum = function(e, t, i, r, n, a) {
    return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),
    this.makePerspective(e, t, r, i, n, a)
}
,
Matrix4.prototype.getInverse = function(e) {
    return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),
    this.copy(e).invert()
}
,
Plane.prototype.isIntersectionLine = function(e) {
    return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),
    this.intersectsLine(e)
}
,
Quaternion.prototype.multiplyVector3 = function(e) {
    return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),
    e.applyQuaternion(this)
}
,
Quaternion.prototype.inverse = function() {
    return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),
    this.invert()
}
,
Ray.prototype.isIntersectionBox = function(e) {
    return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),
    this.intersectsBox(e)
}
,
Ray.prototype.isIntersectionPlane = function(e) {
    return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),
    this.intersectsPlane(e)
}
,
Ray.prototype.isIntersectionSphere = function(e) {
    return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),
    this.intersectsSphere(e)
}
,
Triangle.prototype.area = function() {
    return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),
    this.getArea()
}
,
Triangle.prototype.barycoordFromPoint = function(e, t) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),
    this.getBarycoord(e, t)
}
,
Triangle.prototype.midpoint = function(e) {
    return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),
    this.getMidpoint(e)
}
,
Triangle.prototypenormal = function(e) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),
    this.getNormal(e)
}
,
Triangle.prototype.plane = function(e) {
    return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),
    this.getPlane(e)
}
,
Triangle.barycoordFromPoint = function(e, t, i, r, n) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),
    Triangle.getBarycoord(e, t, i, r, n)
}
,
Triangle.normal = function(e, t, i, r) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),
    Triangle.getNormal(e, t, i, r)
}
,
Shape.prototype.extractAllPoints = function(e) {
    return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),
    this.extractPoints(e)
}
,
Shape.prototype.extrude = function(e) {
    return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),
    new ExtrudeGeometry(this,e)
}
,
Shape.prototype.makeGeometry = function(e) {
    return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),
    new ShapeGeometry(this,e)
}
,
Vector2.prototype.fromAttribute = function(e, t, i) {
    return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),
    this.fromBufferAttribute(e, t, i)
}
,
Vector2.prototype.distanceToManhattan = function(e) {
    return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),
    this.manhattanDistanceTo(e)
}
,
Vector2.prototype.lengthManhattan = function() {
    return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),
    this.manhattanLength()
}
,
Vector3.prototype.setEulerFromRotationMatrix = function() {
    console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")
}
,
Vector3.prototype.setEulerFromQuaternion = function() {
    console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")
}
,
Vector3.prototype.getPositionFromMatrix = function(e) {
    return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),
    this.setFromMatrixPosition(e)
}
,
Vector3.prototype.getScaleFromMatrix = function(e) {
    return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),
    this.setFromMatrixScale(e)
}
,
Vector3.prototype.getColumnFromMatrix = function(e, t) {
    return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),
    this.setFromMatrixColumn(t, e)
}
,
Vector3.prototype.applyProjection = function(e) {
    return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),
    this.applyMatrix4(e)
}
,
Vector3.prototype.fromAttribute = function(e, t, i) {
    return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),
    this.fromBufferAttribute(e, t, i)
}
,
Vector3.prototype.distanceToManhattan = function(e) {
    return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),
    this.manhattanDistanceTo(e)
}
,
Vector3.prototype.lengthManhattan = function() {
    return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),
    this.manhattanLength()
}
,
Vector4.prototype.fromAttribute = function(e, t, i) {
    return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),
    this.fromBufferAttribute(e, t, i)
}
,
Vector4.prototype.lengthManhattan = function() {
    return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),
    this.manhattanLength()
}
,
Object3D.prototype.getChildByName = function(e) {
    return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),
    this.getObjectByName(e)
}
,
Object3D.prototype.renderDepth = function() {
    console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")
}
,
Object3D.prototype.translate = function(e, t) {
    return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),
    this.translateOnAxis(t, e)
}
,
Object3D.prototype.getWorldRotation = function() {
    console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")
}
,
Object3D.prototype.applyMatrix = function(e) {
    return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),
    this.applyMatrix4(e)
}
,
Object.defineProperties(Object3D.prototype, {
    eulerOrder: {
        get: function() {
            return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),
            this.rotation.order
        },
        set: function(e) {
            console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),
            this.rotation.order = e
        }
    },
    useQuaternion: {
        get: function() {
            console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
        },
        set: function() {
            console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
        }
    }
}),
Mesh.prototype.setDrawMode = function() {
    console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")
}
,
Object.defineProperties(Mesh.prototype, {
    drawMode: {
        get: function() {
            return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),
            TrianglesDrawMode
        },
        set: function() {
            console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")
        }
    }
}),
SkinnedMesh.prototype.initBones = function() {
    console.error("THREE.SkinnedMesh: initBones() has been removed.")
}
,
PerspectiveCamera.prototype.setLens = function(e, t) {
    console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),
    void 0 !== t && (this.filmGauge = t),
    this.setFocalLength(e)
}
,
Object.defineProperties(Light.prototype, {
    onlyShadow: {
        set: function() {
            console.warn("THREE.Light: .onlyShadow has been removed.")
        }
    },
    shadowCameraFov: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),
            this.shadow.camera.fov = e
        }
    },
    shadowCameraLeft: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),
            this.shadow.camera.left = e
        }
    },
    shadowCameraRight: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),
            this.shadow.camera.right = e
        }
    },
    shadowCameraTop: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),
            this.shadow.camera.top = e
        }
    },
    shadowCameraBottom: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),
            this.shadow.camera.bottom = e
        }
    },
    shadowCameraNear: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),
            this.shadow.camera.near = e
        }
    },
    shadowCameraFar: {
        set: function(e) {
            console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),
            this.shadow.camera.far = e
        }
    },
    shadowCameraVisible: {
        set: function() {
            console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")
        }
    },
    shadowBias: {
        set: function(e) {
            console.warn("THREE.Light: .shadowBias is now .shadow.bias."),
            this.shadow.bias = e
        }
    },
    shadowDarkness: {
        set: function() {
            console.warn("THREE.Light: .shadowDarkness has been removed.")
        }
    },
    shadowMapWidth: {
        set: function(e) {
            console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),
            this.shadow.mapSize.width = e
        }
    },
    shadowMapHeight: {
        set: function(e) {
            console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),
            this.shadow.mapSize.height = e
        }
    }
}),
Object.defineProperties(BufferAttribute.prototype, {
    length: {
        get: function() {
            return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),
            this.array.length
        }
    },
    dynamic: {
        get: function() {
            return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),
            this.usage === DynamicDrawUsage
        },
        set: function() {
            console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),
            this.setUsage(DynamicDrawUsage)
        }
    }
}),
BufferAttribute.prototype.setDynamic = function(e) {
    return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),
    this.setUsage(!0 === e ? DynamicDrawUsage : StaticDrawUsage),
    this
}
,
BufferAttribute.prototype.copyIndicesArray = function() {
    console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")
}
,
BufferAttribute.prototype.setArray = function() {
    console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")
}
,
BufferGeometry.prototype.addIndex = function(e) {
    console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),
    this.setIndex(e)
}
,
BufferGeometry.prototype.addAttribute = function(e, t) {
    return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),
    t && t.isBufferAttribute || t && t.isInterleavedBufferAttribute ? "index" === e ? (console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),
    this.setIndex(t),
    this) : this.setAttribute(e, t) : (console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),
    this.setAttribute(e, new BufferAttribute(arguments[1],arguments[2])))
}
,
BufferGeometry.prototype.addDrawCall = function(e, t, i) {
    void 0 !== i && console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),
    console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),
    this.addGroup(e, t)
}
,
BufferGeometry.prototype.clearDrawCalls = function() {
    console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),
    this.clearGroups()
}
,
BufferGeometry.prototype.computeOffsets = function() {
    console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")
}
,
BufferGeometry.prototype.removeAttribute = function(e) {
    return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),
    this.deleteAttribute(e)
}
,
BufferGeometry.prototype.applyMatrix = function(e) {
    return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),
    this.applyMatrix4(e)
}
,
Object.defineProperties(BufferGeometry.prototype, {
    drawcalls: {
        get: function() {
            return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),
            this.groups
        }
    },
    offsets: {
        get: function() {
            return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),
            this.groups
        }
    }
}),
InterleavedBuffer.prototype.setDynamic = function(e) {
    return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),
    this.setUsage(!0 === e ? DynamicDrawUsage : StaticDrawUsage),
    this
}
,
InterleavedBuffer.prototype.setArray = function() {
    console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")
}
,
ExtrudeGeometry.prototype.getArrays = function() {
    console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")
}
,
ExtrudeGeometry.prototype.addShapeList = function() {
    console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")
}
,
ExtrudeGeometry.prototype.addShape = function() {
    console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")
}
,
Scene.prototype.dispose = function() {
    console.error("THREE.Scene: .dispose() has been removed.")
}
,
Object.defineProperties(Material.prototype, {
    wrapAround: {
        get: function() {
            console.warn("THREE.Material: .wrapAround has been removed.")
        },
        set: function() {
            console.warn("THREE.Material: .wrapAround has been removed.")
        }
    },
    overdraw: {
        get: function() {
            console.warn("THREE.Material: .overdraw has been removed.")
        },
        set: function() {
            console.warn("THREE.Material: .overdraw has been removed.")
        }
    },
    wrapRGB: {
        get: function() {
            return console.warn("THREE.Material: .wrapRGB has been removed."),
            new Color
        }
    },
    shading: {
        get: function() {
            console.error("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead.")
        },
        set: function(e) {
            console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."),
            this.flatShading = e === FlatShading
        }
    },
    stencilMask: {
        get: function() {
            return console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."),
            this.stencilFuncMask
        },
        set: function(e) {
            console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."),
            this.stencilFuncMask = e
        }
    },
    vertexTangents: {
        get: function() {
            console.warn("THREE." + this.type + ": .vertexTangents has been removed.")
        },
        set: function() {
            console.warn("THREE." + this.type + ": .vertexTangents has been removed.")
        }
    }
}),
Object.defineProperties(ShaderMaterial.prototype, {
    derivatives: {
        get: function() {
            return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),
            this.extensions.derivatives
        },
        set: function(e) {
            console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),
            this.extensions.derivatives = e
        }
    }
}),
WebGLRenderer.prototype.clearTarget = function(e, t, i, r) {
    console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),
    this.setRenderTarget(e),
    this.clear(t, i, r)
}
,
WebGLRenderer.prototype.animate = function(e) {
    console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),
    this.setAnimationLoop(e)
}
,
WebGLRenderer.prototype.getCurrentRenderTarget = function() {
    return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),
    this.getRenderTarget()
}
,
WebGLRenderer.prototype.getMaxAnisotropy = function() {
    return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),
    this.capabilities.getMaxAnisotropy()
}
,
WebGLRenderer.prototype.getPrecision = function() {
    return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),
    this.capabilities.precision
}
,
WebGLRenderer.prototype.resetGLState = function() {
    return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),
    this.state.reset()
}
,
WebGLRenderer.prototype.supportsFloatTextures = function() {
    return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),
    this.extensions.get("OES_texture_float")
}
,
WebGLRenderer.prototype.supportsHalfFloatTextures = function() {
    return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),
    this.extensions.get("OES_texture_half_float")
}
,
WebGLRenderer.prototype.supportsStandardDerivatives = function() {
    return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),
    this.extensions.get("OES_standard_derivatives")
}
,
WebGLRenderer.prototype.supportsCompressedTextureS3TC = function() {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),
    this.extensions.get("WEBGL_compressed_texture_s3tc")
}
,
WebGLRenderer.prototype.supportsCompressedTexturePVRTC = function() {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),
    this.extensions.get("WEBGL_compressed_texture_pvrtc")
}
,
WebGLRenderer.prototype.supportsBlendMinMax = function() {
    return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),
    this.extensions.get("EXT_blend_minmax")
}
,
WebGLRenderer.prototype.supportsVertexTextures = function() {
    return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),
    this.capabilities.vertexTextures
}
,
WebGLRenderer.prototype.supportsInstancedArrays = function() {
    return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),
    this.extensions.get("ANGLE_instanced_arrays")
}
,
WebGLRenderer.prototype.enableScissorTest = function(e) {
    console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),
    this.setScissorTest(e)
}
,
WebGLRenderer.prototype.initMaterial = function() {
    console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")
}
,
WebGLRenderer.prototype.addPrePlugin = function() {
    console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")
}
,
WebGLRenderer.prototype.addPostPlugin = function() {
    console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")
}
,
WebGLRenderer.prototype.updateShadowMap = function() {
    console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")
}
,
WebGLRenderer.prototype.setFaceCulling = function() {
    console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")
}
,
WebGLRenderer.prototype.allocTextureUnit = function() {
    console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")
}
,
WebGLRenderer.prototype.setTexture = function() {
    console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")
}
,
WebGLRenderer.prototype.setTexture2D = function() {
    console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")
}
,
WebGLRenderer.prototype.setTextureCube = function() {
    console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")
}
,
WebGLRenderer.prototype.getActiveMipMapLevel = function() {
    return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),
    this.getActiveMipmapLevel()
}
,
Object.defineProperties(WebGLRenderer.prototype, {
    shadowMapEnabled: {
        get: function() {
            return this.shadowMap.enabled
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),
            this.shadowMap.enabled = e
        }
    },
    shadowMapType: {
        get: function() {
            return this.shadowMap.type
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),
            this.shadowMap.type = e
        }
    },
    shadowMapCullFace: {
        get: function() {
            console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")
        }
    },
    context: {
        get: function() {
            return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),
            this.getContext()
        }
    },
    vr: {
        get: function() {
            return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),
            this.xr
        }
    },
    gammaInput: {
        get: function() {
            return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),
            !1
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")
        }
    },
    gammaOutput: {
        get: function() {
            return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),
            !1
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),
            this.outputEncoding = !0 === e ? sRGBEncoding : LinearEncoding
        }
    },
    toneMappingWhitePoint: {
        get: function() {
            return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),
            1
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")
        }
    }
}),
Object.defineProperties(WebGLShadowMap.prototype, {
    cullFace: {
        get: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")
        }
    },
    renderReverseSided: {
        get: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")
        }
    },
    renderSingleSided: {
        get: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")
        },
        set: function() {
            console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")
        }
    }
}),
Object.defineProperties(WebGLRenderTarget.prototype, {
    wrapS: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),
            this.texture.wrapS
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),
            this.texture.wrapS = e
        }
    },
    wrapT: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),
            this.texture.wrapT
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),
            this.texture.wrapT = e
        }
    },
    magFilter: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),
            this.texture.magFilter
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),
            this.texture.magFilter = e
        }
    },
    minFilter: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),
            this.texture.minFilter
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),
            this.texture.minFilter = e
        }
    },
    anisotropy: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),
            this.texture.anisotropy
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),
            this.texture.anisotropy = e
        }
    },
    offset: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),
            this.texture.offset
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),
            this.texture.offset = e
        }
    },
    repeat: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),
            this.texture.repeat
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),
            this.texture.repeat = e
        }
    },
    format: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),
            this.texture.format
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),
            this.texture.format = e
        }
    },
    type: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),
            this.texture.type
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),
            this.texture.type = e
        }
    },
    generateMipmaps: {
        get: function() {
            return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),
            this.texture.generateMipmaps
        },
        set: function(e) {
            console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),
            this.texture.generateMipmaps = e
        }
    }
}),
Audio$1.prototype.load = function(e) {
    console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
    var t = this;
    return (new AudioLoader).load(e, (function(e) {
        t.setBuffer(e)
    }
    )),
    this
}
,
CubeCamera.prototype.updateCubeMap = function(e, t) {
    return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),
    this.update(e, t)
}
,
CubeCamera.prototype.clear = function(e, t, i, r) {
    return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),
    this.renderTarget.clear(e, t, i, r)
}
,
ImageUtils.crossOrigin = void 0,
ImageUtils.loadTexture = function(e, t, i, r) {
    console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
    var n = new TextureLoader;
    n.setCrossOrigin(this.crossOrigin);
    var a = n.load(e, i, void 0, r);
    return t && (a.mapping = t),
    a
}
,
ImageUtils.loadTextureCube = function(e, t, i, r) {
    console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
    var n = new CubeTextureLoader;
    n.setCrossOrigin(this.crossOrigin);
    var a = n.load(e, i, void 0, r);
    return t && (a.mapping = t),
    a
}
,
ImageUtils.loadCompressedTexture = function() {
    console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")
}
,
ImageUtils.loadCompressedTextureCube = function() {
    console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")
}
,
"undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{
    detail: {
        revision: REVISION
    }
})),
"undefined" != typeof window && (window.__THREE__ ? console.warn("WARNING: Multiple instances of Three.js being imported.") : window.__THREE__ = REVISION);
var t$3 = window.ShadowRoot && (void 0 === window.ShadyCSS || window.ShadyCSS.nativeShadow) && "adoptedStyleSheets"in Document.prototype && "replace"in CSSStyleSheet.prototype, e$8 = Symbol(), n$5 = new Map, s$3 = function() {
    function e(t, i) {
        if (_classCallCheck2(this, e),
        this._$cssResult$ = !0,
        i !== e$8)
            throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");
        this.cssText = t
    }
    return _createClass2(e, [{
        key: "styleSheet",
        get: function() {
            var e = n$5.get(this.cssText);
            return t$3 && void 0 === e && (n$5.set(this.cssText, e = new CSSStyleSheet),
            e.replaceSync(this.cssText)),
            e
        }
    }, {
        key: "toString",
        value: function() {
            return this.cssText
        }
    }]),
    e
}(), o$5 = function(e) {
    return new s$3("string" == typeof e ? e : e + "",e$8)
}, r$3 = function(e) {
    for (var t = arguments.length, i = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++)
        i[r - 1] = arguments[r];
    var n = 1 === e.length ? e[0] : i.reduce((function(t, i, r) {
        return t + function(e) {
            if (!0 === e._$cssResult$)
                return e.cssText;
            if ("number" == typeof e)
                return e;
            throw Error("Value passed to 'css' function must be a 'css' function result: " + e + ". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")
        }(i) + e[r + 1]
    }
    ), e[0]);
    return new s$3(n,e$8)
}, i$3 = function(e, t) {
    t$3 ? e.adoptedStyleSheets = t.map((function(e) {
        return e instanceof CSSStyleSheet ? e : e.styleSheet
    }
    )) : t.forEach((function(t) {
        var i = document.createElement("style")
          , r = window.litNonce;
        void 0 !== r && i.setAttribute("nonce", r),
        i.textContent = t.cssText,
        e.appendChild(i)
    }
    ))
}, S$1 = t$3 ? function(e) {
    return e
}
: function(e) {
    return e instanceof CSSStyleSheet ? function(e) {
        var t, i = "", r = _createForOfIteratorHelper(e.cssRules);
        try {
            for (r.s(); !(t = r.n()).done; )
                i += t.value.cssText
        } catch (n) {
            r.e(n)
        } finally {
            r.f()
        }
        return o$5(i)
    }(e) : e
}
, s$2, e$7 = window.trustedTypes, r$2 = e$7 ? e$7.emptyScript : "", h$2 = window.reactiveElementPolyfillSupport, o$4 = {
    toAttribute: function(e, t) {
        switch (t) {
        case Boolean:
            e = e ? r$2 : null;
            break;
        case Object:
        case Array:
            e = null == e ? e : JSON.stringify(e)
        }
        return e
    },
    fromAttribute: function(e, t) {
        var i = e;
        switch (t) {
        case Boolean:
            i = null !== e;
            break;
        case Number:
            i = null === e ? null : Number(e);
            break;
        case Object:
        case Array:
            try {
                i = JSON.parse(e)
            } catch (r) {
                i = null
            }
        }
        return i
    }
}, n$4 = function(e, t) {
    return t !== e && (t == t || e == e)
}, l$3 = {
    attribute: !0,
    type: String,
    converter: o$4,
    reflect: !1,
    hasChanged: n$4
}, t$2, a$1 = function(e) {
    _inherits(i, _wrapNativeSuper(HTMLElement));
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this))._$Et = new Map,
        e.isUpdatePending = !1,
        e.hasUpdated = !1,
        e._$Ei = null,
        e.o(),
        e
    }
    return _createClass2(i, [{
        key: "o",
        value: function() {
            var e, t = this;
            this._$Ep = new Promise((function(e) {
                return t.enableUpdating = e
            }
            )),
            this._$AL = new Map,
            this._$Em(),
            this.requestUpdate(),
            null === (e = this.constructor.l) || void 0 === e || e.forEach((function(e) {
                return e(t)
            }
            ))
        }
    }, {
        key: "addController",
        value: function(e) {
            var t, i;
            (null !== (t = this._$Eg) && void 0 !== t ? t : this._$Eg = []).push(e),
            void 0 !== this.renderRoot && this.isConnected && (null === (i = e.hostConnected) || void 0 === i || i.call(e))
        }
    }, {
        key: "removeController",
        value: function(e) {
            var t;
            null === (t = this._$Eg) || void 0 === t || t.splice(this._$Eg.indexOf(e) >>> 0, 1)
        }
    }, {
        key: "_$Em",
        value: function() {
            var e = this;
            this.constructor.elementProperties.forEach((function(t, i) {
                e.hasOwnProperty(i) && (e._$Et.set(i, e[i]),
                delete e[i])
            }
            ))
        }
    }, {
        key: "createRenderRoot",
        value: function() {
            var e, t = null !== (e = this.shadowRoot) && void 0 !== e ? e : this.attachShadow(this.constructor.shadowRootOptions);
            return i$3(t, this.constructor.elementStyles),
            t
        }
    }, {
        key: "connectedCallback",
        value: function() {
            var e;
            void 0 === this.renderRoot && (this.renderRoot = this.createRenderRoot()),
            this.enableUpdating(!0),
            null === (e = this._$Eg) || void 0 === e || e.forEach((function(e) {
                var t;
                return null === (t = e.hostConnected) || void 0 === t ? void 0 : t.call(e)
            }
            ))
        }
    }, {
        key: "enableUpdating",
        value: function(e) {}
    }, {
        key: "disconnectedCallback",
        value: function() {
            var e;
            null === (e = this._$Eg) || void 0 === e || e.forEach((function(e) {
                var t;
                return null === (t = e.hostDisconnected) || void 0 === t ? void 0 : t.call(e)
            }
            ))
        }
    }, {
        key: "attributeChangedCallback",
        value: function(e, t, i) {
            this._$AK(e, i)
        }
    }, {
        key: "_$ES",
        value: function(e, t) {
            var i, r, n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : l$3, a = this.constructor._$Eh(e, n);
            if (void 0 !== a && !0 === n.reflect) {
                var o = (null !== (r = null === (i = n.converter) || void 0 === i ? void 0 : i.toAttribute) && void 0 !== r ? r : o$4.toAttribute)(t, n.type);
                this._$Ei = e,
                null == o ? this.removeAttribute(a) : this.setAttribute(a, o),
                this._$Ei = null
            }
        }
    }, {
        key: "_$AK",
        value: function(e, t) {
            var i, r, n, a = this.constructor, o = a._$Eu.get(e);
            if (void 0 !== o && this._$Ei !== o) {
                var s = a.getPropertyOptions(o)
                  , l = s.converter
                  , h = null !== (n = null !== (r = null === (i = l) || void 0 === i ? void 0 : i.fromAttribute) && void 0 !== r ? r : "function" == typeof l ? l : null) && void 0 !== n ? n : o$4.fromAttribute;
                this._$Ei = o,
                this[o] = h(t, s.type),
                this._$Ei = null
            }
        }
    }, {
        key: "requestUpdate",
        value: function(e, t, i) {
            var r = !0;
            void 0 !== e && (((i = i || this.constructor.getPropertyOptions(e)).hasChanged || n$4)(this[e], t) ? (this._$AL.has(e) || this._$AL.set(e, t),
            !0 === i.reflect && this._$Ei !== e && (void 0 === this._$E_ && (this._$E_ = new Map),
            this._$E_.set(e, i))) : r = !1),
            !this.isUpdatePending && r && (this._$Ep = this._$EC())
        }
    }, {
        key: "_$EC",
        value: function() {
            var e = this;
            return _asyncToGenerator(_regeneratorRuntime().mark((function t() {
                var i;
                return _regeneratorRuntime().wrap((function(t) {
                    for (; ; )
                        switch (t.prev = t.next) {
                        case 0:
                            return e.isUpdatePending = !0,
                            t.prev = 1,
                            t.next = 4,
                            e._$Ep;
                        case 4:
                            t.next = 9;
                            break;
                        case 6:
                            t.prev = 6,
                            t.t0 = t.catch(1),
                            Promise.reject(t.t0);
                        case 9:
                            if (i = e.scheduleUpdate(),
                            t.t1 = null != i,
                            !t.t1) {
                                t.next = 14;
                                break
                            }
                            return t.next = 14,
                            i;
                        case 14:
                            return t.abrupt("return", !e.isUpdatePending);
                        case 15:
                        case "end":
                            return t.stop()
                        }
                }
                ), t, null, [[1, 6]])
            }
            )))()
        }
    }, {
        key: "scheduleUpdate",
        value: function() {
            return this.performUpdate()
        }
    }, {
        key: "performUpdate",
        value: function() {
            var e, t = this;
            if (this.isUpdatePending) {
                this.hasUpdated,
                this._$Et && (this._$Et.forEach((function(e, i) {
                    return t[i] = e
                }
                )),
                this._$Et = void 0);
                var i = !1
                  , r = this._$AL;
                try {
                    (i = this.shouldUpdate(r)) ? (this.willUpdate(r),
                    null === (e = this._$Eg) || void 0 === e || e.forEach((function(e) {
                        var t;
                        return null === (t = e.hostUpdate) || void 0 === t ? void 0 : t.call(e)
                    }
                    )),
                    this.update(r)) : this._$EU()
                } catch (n) {
                    throw i = !1,
                    this._$EU(),
                    n
                }
                i && this._$AE(r)
            }
        }
    }, {
        key: "willUpdate",
        value: function(e) {}
    }, {
        key: "_$AE",
        value: function(e) {
            var t;
            null === (t = this._$Eg) || void 0 === t || t.forEach((function(e) {
                var t;
                return null === (t = e.hostUpdated) || void 0 === t ? void 0 : t.call(e)
            }
            )),
            this.hasUpdated || (this.hasUpdated = !0,
            this.firstUpdated(e)),
            this.updated(e)
        }
    }, {
        key: "_$EU",
        value: function() {
            this._$AL = new Map,
            this.isUpdatePending = !1
        }
    }, {
        key: "updateComplete",
        get: function() {
            return this.getUpdateComplete()
        }
    }, {
        key: "getUpdateComplete",
        value: function() {
            return this._$Ep
        }
    }, {
        key: "shouldUpdate",
        value: function(e) {
            return !0
        }
    }, {
        key: "update",
        value: function(e) {
            var t = this;
            void 0 !== this._$E_ && (this._$E_.forEach((function(e, i) {
                return t._$ES(i, t[i], e)
            }
            )),
            this._$E_ = void 0),
            this._$EU()
        }
    }, {
        key: "updated",
        value: function(e) {}
    }, {
        key: "firstUpdated",
        value: function(e) {}
    }], [{
        key: "addInitializer",
        value: function(e) {
            var t;
            null !== (t = this.l) && void 0 !== t || (this.l = []),
            this.l.push(e)
        }
    }, {
        key: "observedAttributes",
        get: function() {
            var e = this;
            this.finalize();
            var t = [];
            return this.elementProperties.forEach((function(i, r) {
                var n = e._$Eh(r, i);
                void 0 !== n && (e._$Eu.set(n, r),
                t.push(n))
            }
            )),
            t
        }
    }, {
        key: "createProperty",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : l$3;
            if (t.state && (t.attribute = !1),
            this.finalize(),
            this.elementProperties.set(e, t),
            !t.noAccessor && !this.prototype.hasOwnProperty(e)) {
                var i = "symbol" == _typeof2(e) ? Symbol() : "__" + e
                  , r = this.getPropertyDescriptor(e, i, t);
                void 0 !== r && Object.defineProperty(this.prototype, e, r)
            }
        }
    }, {
        key: "getPropertyDescriptor",
        value: function(e, t, i) {
            return {
                get: function() {
                    return this[t]
                },
                set: function(r) {
                    var n = this[e];
                    this[t] = r,
                    this.requestUpdate(e, n, i)
                },
                configurable: !0,
                enumerable: !0
            }
        }
    }, {
        key: "getPropertyOptions",
        value: function(e) {
            return this.elementProperties.get(e) || l$3
        }
    }, {
        key: "finalize",
        value: function() {
            if (this.hasOwnProperty("finalized"))
                return !1;
            this.finalized = !0;
            var e = Object.getPrototypeOf(this);
            if (e.finalize(),
            this.elementProperties = new Map(e.elementProperties),
            this._$Eu = new Map,
            this.hasOwnProperty("properties")) {
                var t, i = this.properties, r = _createForOfIteratorHelper([].concat(_toConsumableArray(Object.getOwnPropertyNames(i)), _toConsumableArray(Object.getOwnPropertySymbols(i))));
                try {
                    for (r.s(); !(t = r.n()).done; ) {
                        var n = t.value;
                        this.createProperty(n, i[n])
                    }
                } catch (a) {
                    r.e(a)
                } finally {
                    r.f()
                }
            }
            return this.elementStyles = this.finalizeStyles(this.styles),
            !0
        }
    }, {
        key: "finalizeStyles",
        value: function(e) {
            var t = [];
            if (Array.isArray(e)) {
                var i, r = _createForOfIteratorHelper(new Set(e.flat(1 / 0).reverse()));
                try {
                    for (r.s(); !(i = r.n()).done; ) {
                        var n = i.value;
                        t.unshift(S$1(n))
                    }
                } catch (a) {
                    r.e(a)
                } finally {
                    r.f()
                }
            } else
                void 0 !== e && t.push(S$1(e));
            return t
        }
    }, {
        key: "_$Eh",
        value: function(e, t) {
            var i = t.attribute;
            return !1 === i ? void 0 : "string" == typeof i ? i : "string" == typeof e ? e.toLowerCase() : void 0
        }
    }]),
    i
}();
a$1.finalized = !0,
a$1.elementProperties = new Map,
a$1.elementStyles = [],
a$1.shadowRootOptions = {
    mode: "open"
},
null == h$2 || h$2({
    ReactiveElement: a$1
}),
(null !== (s$2 = globalThis.reactiveElementVersions) && void 0 !== s$2 ? s$2 : globalThis.reactiveElementVersions = []).push("1.2.1");
var i$2 = globalThis.trustedTypes
  , s$1 = i$2 ? i$2.createPolicy("lit-html", {
    createHTML: function(e) {
        return e
    }
}) : void 0
  , e$6 = "lit$".concat((Math.random() + "").slice(9), "$")
  , o$3 = "?" + e$6
  , n$3 = "<".concat(o$3, ">")
  , l$2 = document
  , h$1 = function() {
    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
    return l$2.createComment(e)
}
  , r$1 = function(e) {
    return null === e || "object" != _typeof2(e) && "function" != typeof e
}
  , d = Array.isArray
  , u = function(e) {
    var t;
    return d(e) || "function" == typeof (null === (t = e) || void 0 === t ? void 0 : t[Symbol.iterator])
}
  , c = /<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g
  , v = /-->/g
  , a$2 = />/g
  , f = />|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g
  , _ = /'/g
  , m = /"/g
  , g = /^(?:script|style|textarea)$/i
  , p = function(e) {
    return function(t) {
        for (var i = arguments.length, r = new Array(i > 1 ? i - 1 : 0), n = 1; n < i; n++)
            r[n - 1] = arguments[n];
        return {
            _$litType$: e,
            strings: t,
            values: r
        }
    }
}
  , $ = p(1)
  , b$1 = Symbol.for("lit-noChange")
  , w = Symbol.for("lit-nothing")
  , T = new WeakMap
  , x = function(e, t, i) {
    var r, n, a = null !== (r = null == i ? void 0 : i.renderBefore) && void 0 !== r ? r : t, o = a._$litPart$;
    if (void 0 === o) {
        var s = null !== (n = null == i ? void 0 : i.renderBefore) && void 0 !== n ? n : null;
        a._$litPart$ = o = new N(t.insertBefore(h$1(), s),s,void 0,null != i ? i : {})
    }
    return o._$AI(e),
    o
}
  , A = l$2.createTreeWalker(l$2, 129, null, !1)
  , C = function(e, t) {
    for (var i, r = e.length - 1, n = [], a = 2 === t ? "<svg>" : "", o = c, s = 0; s < r; s++) {
        for (var l = e[s], h = void 0, p = void 0, u = -1, d = 0; d < l.length && (o.lastIndex = d,
        null !== (p = o.exec(l))); )
            d = o.lastIndex,
            o === c ? "!--" === p[1] ? o = v : void 0 !== p[1] ? o = a$2 : void 0 !== p[2] ? (g.test(p[2]) && (i = RegExp("</" + p[2], "g")),
            o = f) : void 0 !== p[3] && (o = f) : o === f ? ">" === p[0] ? (o = null != i ? i : c,
            u = -1) : void 0 === p[1] ? u = -2 : (u = o.lastIndex - p[2].length,
            h = p[1],
            o = void 0 === p[3] ? f : '"' === p[3] ? m : _) : o === m || o === _ ? o = f : o === v || o === a$2 ? o = c : (o = f,
            i = void 0);
        var y = o === f && e[s + 1].startsWith("/>") ? " " : "";
        a += o === c ? l + n$3 : u >= 0 ? (n.push(h),
        l.slice(0, u) + "$lit$" + l.slice(u) + e$6 + y) : l + e$6 + (-2 === u ? (n.push(void 0),
        s) : y)
    }
    var b = a + (e[r] || "<?>") + (2 === t ? "</svg>" : "");
    if (!Array.isArray(e) || !e.hasOwnProperty("raw"))
        throw Error("invalid template strings array");
    return [void 0 !== s$1 ? s$1.createHTML(b) : b, n]
}
  , E = function() {
    function e(t, i) {
        _classCallCheck2(this, e);
        var r, n = t.strings, a = t._$litType$;
        this.parts = [];
        var o = 0
          , s = 0
          , l = n.length - 1
          , h = this.parts
          , c = _slicedToArray(C(n, a), 2)
          , p = c[0]
          , u = c[1];
        if (this.el = e.createElement(p, i),
        A.currentNode = this.el.content,
        2 === a) {
            var d = this.el.content
              , f = d.firstChild;
            f.remove(),
            d.append.apply(d, _toConsumableArray(f.childNodes))
        }
        for (; null !== (r = A.nextNode()) && h.length < l; ) {
            if (1 === r.nodeType) {
                if (r.hasAttributes()) {
                    var m, v = [], y = _createForOfIteratorHelper(r.getAttributeNames());
                    try {
                        for (y.s(); !(m = y.n()).done; ) {
                            var _ = m.value;
                            if (_.endsWith("$lit$") || _.startsWith(e$6)) {
                                var b = u[s++];
                                if (v.push(_),
                                void 0 !== b) {
                                    var x = r.getAttribute(b.toLowerCase() + "$lit$").split(e$6)
                                      , w = /([.?@])?(.*)/.exec(b);
                                    h.push({
                                        type: 1,
                                        index: o,
                                        name: w[2],
                                        strings: x,
                                        ctor: "." === w[1] ? M : "?" === w[1] ? H : "@" === w[1] ? I : S
                                    })
                                } else
                                    h.push({
                                        type: 6,
                                        index: o
                                    })
                            }
                        }
                    } catch (F) {
                        y.e(F)
                    } finally {
                        y.f()
                    }
                    for (var T = 0, k = v; T < k.length; T++) {
                        var E = k[T];
                        r.removeAttribute(E)
                    }
                }
                if (g.test(r.tagName)) {
                    var P = r.textContent.split(e$6)
                      , L = P.length - 1;
                    if (L > 0) {
                        r.textContent = i$2 ? i$2.emptyScript : "";
                        for (var D = 0; D < L; D++)
                            r.append(P[D], h$1()),
                            A.nextNode(),
                            h.push({
                                type: 2,
                                index: ++o
                            });
                        r.append(P[L], h$1())
                    }
                }
            } else if (8 === r.nodeType)
                if (r.data === o$3)
                    h.push({
                        type: 2,
                        index: o
                    });
                else
                    for (var R = -1; -1 !== (R = r.data.indexOf(e$6, R + 1)); )
                        h.push({
                            type: 7,
                            index: o
                        }),
                        R += e$6.length - 1;
            o++
        }
    }
    return _createClass2(e, null, [{
        key: "createElement",
        value: function(e, t) {
            var i = l$2.createElement("template");
            return i.innerHTML = e,
            i
        }
    }]),
    e
}();
function P(e, t) {
    var i, r, n, a, o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : e, s = arguments.length > 3 ? arguments[3] : void 0;
    if (t === b$1)
        return t;
    var l = void 0 !== s ? null === (i = o._$Cl) || void 0 === i ? void 0 : i[s] : o._$Cu
      , h = r$1(t) ? void 0 : t._$litDirective$;
    return (null == l ? void 0 : l.constructor) !== h && (null === (r = null == l ? void 0 : l._$AO) || void 0 === r || r.call(l, !1),
    void 0 === h ? l = void 0 : (l = new h(e))._$AT(e, o, s),
    void 0 !== s ? (null !== (n = (a = o)._$Cl) && void 0 !== n ? n : a._$Cl = [])[s] = l : o._$Cu = l),
    void 0 !== l && (t = P(e, l._$AS(e, t.values), l, s)),
    t
}
var V = function() {
    function e(t, i) {
        _classCallCheck2(this, e),
        this.v = [],
        this._$AN = void 0,
        this._$AD = t,
        this._$AM = i
    }
    return _createClass2(e, [{
        key: "parentNode",
        get: function() {
            return this._$AM.parentNode
        }
    }, {
        key: "_$AU",
        get: function() {
            return this._$AM._$AU
        }
    }, {
        key: "p",
        value: function(e) {
            var t, i = this._$AD, r = i.el.content, n = i.parts, a = (null !== (t = null == e ? void 0 : e.creationScope) && void 0 !== t ? t : l$2).importNode(r, !0);
            A.currentNode = a;
            for (var o = A.nextNode(), s = 0, l = 0, h = n[0]; void 0 !== h; ) {
                if (s === h.index) {
                    var c = void 0;
                    2 === h.type ? c = new N(o,o.nextSibling,this,e) : 1 === h.type ? c = new h.ctor(o,h.name,h.strings,this,e) : 6 === h.type && (c = new L(o,this,e)),
                    this.v.push(c),
                    h = n[++l]
                }
                s !== (null == h ? void 0 : h.index) && (o = A.nextNode(),
                s++)
            }
            return a
        }
    }, {
        key: "m",
        value: function(e) {
            var t, i = 0, r = _createForOfIteratorHelper(this.v);
            try {
                for (r.s(); !(t = r.n()).done; ) {
                    var n = t.value;
                    void 0 !== n && (void 0 !== n.strings ? (n._$AI(e, n, i),
                    i += n.strings.length - 2) : n._$AI(e[i])),
                    i++
                }
            } catch (a) {
                r.e(a)
            } finally {
                r.f()
            }
        }
    }]),
    e
}(), N = function() {
    function e(t, i, r, n) {
        var a;
        _classCallCheck2(this, e),
        this.type = 2,
        this._$AH = w,
        this._$AN = void 0,
        this._$AA = t,
        this._$AB = i,
        this._$AM = r,
        this.options = n,
        this._$Cg = null === (a = null == n ? void 0 : n.isConnected) || void 0 === a || a
    }
    return _createClass2(e, [{
        key: "_$AU",
        get: function() {
            var e, t;
            return null !== (t = null === (e = this._$AM) || void 0 === e ? void 0 : e._$AU) && void 0 !== t ? t : this._$Cg
        }
    }, {
        key: "parentNode",
        get: function() {
            var e = this._$AA.parentNode
              , t = this._$AM;
            return void 0 !== t && 11 === e.nodeType && (e = t.parentNode),
            e
        }
    }, {
        key: "startNode",
        get: function() {
            return this._$AA
        }
    }, {
        key: "endNode",
        get: function() {
            return this._$AB
        }
    }, {
        key: "_$AI",
        value: function(e) {
            e = P(this, e, arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this),
            r$1(e) ? e === w || null == e || "" === e ? (this._$AH !== w && this._$AR(),
            this._$AH = w) : e !== this._$AH && e !== b$1 && this.$(e) : void 0 !== e._$litType$ ? this.T(e) : void 0 !== e.nodeType ? this.S(e) : u(e) ? this.A(e) : this.$(e)
        }
    }, {
        key: "M",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this._$AB;
            return this._$AA.parentNode.insertBefore(e, t)
        }
    }, {
        key: "S",
        value: function(e) {
            this._$AH !== e && (this._$AR(),
            this._$AH = this.M(e))
        }
    }, {
        key: "$",
        value: function(e) {
            this._$AH !== w && r$1(this._$AH) ? this._$AA.nextSibling.data = e : this.S(l$2.createTextNode(e)),
            this._$AH = e
        }
    }, {
        key: "T",
        value: function(e) {
            var t, i = e.values, r = e._$litType$, n = "number" == typeof r ? this._$AC(e) : (void 0 === r.el && (r.el = E.createElement(r.h, this.options)),
            r);
            if ((null === (t = this._$AH) || void 0 === t ? void 0 : t._$AD) === n)
                this._$AH.m(i);
            else {
                var a = new V(n,this)
                  , o = a.p(this.options);
                a.m(i),
                this.S(o),
                this._$AH = a
            }
        }
    }, {
        key: "_$AC",
        value: function(e) {
            var t = T.get(e.strings);
            return void 0 === t && T.set(e.strings, t = new E(e)),
            t
        }
    }, {
        key: "A",
        value: function(t) {
            d(this._$AH) || (this._$AH = [],
            this._$AR());
            var i, r, n = this._$AH, a = 0, o = _createForOfIteratorHelper(t);
            try {
                for (o.s(); !(r = o.n()).done; ) {
                    var s = r.value;
                    a === n.length ? n.push(i = new e(this.M(h$1()),this.M(h$1()),this,this.options)) : i = n[a],
                    i._$AI(s),
                    a++
                }
            } catch (l) {
                o.e(l)
            } finally {
                o.f()
            }
            a < n.length && (this._$AR(i && i._$AB.nextSibling, a),
            n.length = a)
        }
    }, {
        key: "_$AR",
        value: function() {
            var e, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this._$AA.nextSibling, i = arguments.length > 1 ? arguments[1] : void 0;
            for (null === (e = this._$AP) || void 0 === e || e.call(this, !1, !0, i); t && t !== this._$AB; ) {
                var r = t.nextSibling;
                t.remove(),
                t = r
            }
        }
    }, {
        key: "setConnected",
        value: function(e) {
            var t;
            void 0 === this._$AM && (this._$Cg = e,
            null === (t = this._$AP) || void 0 === t || t.call(this, e))
        }
    }]),
    e
}(), S = function() {
    function e(t, i, r, n, a) {
        _classCallCheck2(this, e),
        this.type = 1,
        this._$AH = w,
        this._$AN = void 0,
        this.element = t,
        this.name = i,
        this._$AM = n,
        this.options = a,
        r.length > 2 || "" !== r[0] || "" !== r[1] ? (this._$AH = Array(r.length - 1).fill(new String),
        this.strings = r) : this._$AH = w
    }
    return _createClass2(e, [{
        key: "tagName",
        get: function() {
            return this.element.tagName
        }
    }, {
        key: "_$AU",
        get: function() {
            return this._$AM._$AU
        }
    }, {
        key: "_$AI",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this
              , i = arguments.length > 2 ? arguments[2] : void 0
              , r = arguments.length > 3 ? arguments[3] : void 0
              , n = this.strings
              , a = !1;
            if (void 0 === n)
                e = P(this, e, t, 0),
                (a = !r$1(e) || e !== this._$AH && e !== b$1) && (this._$AH = e);
            else {
                var o, s, l = e;
                for (e = n[0],
                o = 0; o < n.length - 1; o++)
                    (s = P(this, l[i + o], t, o)) === b$1 && (s = this._$AH[o]),
                    a || (a = !r$1(s) || s !== this._$AH[o]),
                    s === w ? e = w : e !== w && (e += (null != s ? s : "") + n[o + 1]),
                    this._$AH[o] = s
            }
            a && !r && this.k(e)
        }
    }, {
        key: "k",
        value: function(e) {
            e === w ? this.element.removeAttribute(this.name) : this.element.setAttribute(this.name, null != e ? e : "")
        }
    }]),
    e
}(), M = function(e) {
    _inherits(i, S);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.apply(this, arguments)).type = 3,
        e
    }
    return _createClass2(i, [{
        key: "k",
        value: function(e) {
            this.element[this.name] = e === w ? void 0 : e
        }
    }]),
    i
}(), _k9 = i$2 ? i$2.emptyScript : "", H = function(e) {
    _inherits(i, S);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.apply(this, arguments)).type = 4,
        e
    }
    return _createClass2(i, [{
        key: "k",
        value: function(e) {
            e && e !== w ? this.element.setAttribute(this.name, _k9) : this.element.removeAttribute(this.name)
        }
    }]),
    i
}(), I = function(e) {
    _inherits(i, S);
    var t = _createSuper(i);
    function i(e, r, n, a, o) {
        var s;
        return _classCallCheck2(this, i),
        (s = t.call(this, e, r, n, a, o)).type = 5,
        s
    }
    return _createClass2(i, [{
        key: "_$AI",
        value: function(e) {
            var t;
            if ((e = null !== (t = P(this, e, arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this, 0)) && void 0 !== t ? t : w) !== b$1) {
                var i = this._$AH
                  , r = e === w && i !== w || e.capture !== i.capture || e.once !== i.once || e.passive !== i.passive
                  , n = e !== w && (i === w || r);
                r && this.element.removeEventListener(this.name, this, i),
                n && this.element.addEventListener(this.name, this, e),
                this._$AH = e
            }
        }
    }, {
        key: "handleEvent",
        value: function(e) {
            var t, i;
            "function" == typeof this._$AH ? this._$AH.call(null !== (i = null === (t = this.options) || void 0 === t ? void 0 : t.host) && void 0 !== i ? i : this.element, e) : this._$AH.handleEvent(e)
        }
    }]),
    i
}(), L = function() {
    function e(t, i, r) {
        _classCallCheck2(this, e),
        this.element = t,
        this.type = 6,
        this._$AN = void 0,
        this._$AM = i,
        this.options = r
    }
    return _createClass2(e, [{
        key: "_$AU",
        get: function() {
            return this._$AM._$AU
        }
    }, {
        key: "_$AI",
        value: function(e) {
            P(this, e)
        }
    }]),
    e
}(), z = window.litHtmlPolyfillSupport, l$1, o$2;
null == z || z(E, N),
(null !== (t$2 = globalThis.litHtmlVersions) && void 0 !== t$2 ? t$2 : globalThis.litHtmlVersions = []).push("2.1.2");
var s = function(e) {
    _inherits(i, a$1);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.apply(this, arguments)).renderOptions = {
            host: _assertThisInitialized(e)
        },
        e._$Dt = void 0,
        e
    }
    return _createClass2(i, [{
        key: "createRenderRoot",
        value: function() {
            var e, t, r = _get(_getPrototypeOf(i.prototype), "createRenderRoot", this).call(this);
            return null !== (e = (t = this.renderOptions).renderBefore) && void 0 !== e || (t.renderBefore = r.firstChild),
            r
        }
    }, {
        key: "update",
        value: function(e) {
            var t = this.render();
            this.hasUpdated || (this.renderOptions.isConnected = this.isConnected),
            _get(_getPrototypeOf(i.prototype), "update", this).call(this, e),
            this._$Dt = x(t, this.renderRoot, this.renderOptions)
        }
    }, {
        key: "connectedCallback",
        value: function() {
            var e;
            _get(_getPrototypeOf(i.prototype), "connectedCallback", this).call(this),
            null === (e = this._$Dt) || void 0 === e || e.setConnected(!0)
        }
    }, {
        key: "disconnectedCallback",
        value: function() {
            var e;
            _get(_getPrototypeOf(i.prototype), "disconnectedCallback", this).call(this),
            null === (e = this._$Dt) || void 0 === e || e.setConnected(!1)
        }
    }, {
        key: "render",
        value: function() {
            return b$1
        }
    }]),
    i
}();
s.finalized = !0,
s._$litElement$ = !0,
null === (l$1 = globalThis.litElementHydrateSupport) || void 0 === l$1 || l$1.call(globalThis, {
    LitElement: s
});
var n$2 = globalThis.litElementPolyfillSupport;
null == n$2 || n$2({
    LitElement: s
}),
(null !== (o$2 = globalThis.litElementVersions) && void 0 !== o$2 ? o$2 : globalThis.litElementVersions = []).push("3.1.2");
var n$1 = function(e) {
    return function(t) {
        return "function" == typeof t ? (i = e,
        r = t,
        window.customElements.define(i, r),
        r) : function(e, t) {
            return {
                kind: t.kind,
                elements: t.elements,
                finisher: function(t) {
                    window.customElements.define(e, t)
                }
            }
        }(e, t);
        var i, r
    }
}
  , i$1 = function(e, t) {
    return "method" === t.kind && t.descriptor && !("value"in t.descriptor) ? _objectSpread2(_objectSpread2({}, t), {}, {
        finisher: function(i) {
            i.createProperty(t.key, e)
        }
    }) : {
        kind: "field",
        key: Symbol(),
        placement: "own",
        descriptor: {},
        originalKey: t.key,
        initializer: function() {
            "function" == typeof t.initializer && (this[t.key] = t.initializer.call(this))
        },
        finisher: function(i) {
            i.createProperty(t.key, e)
        }
    }
};
function e$5(e) {
    return function(t, i) {
        return void 0 !== i ? (r = e,
        n = i,
        void t.constructor.createProperty(n, r)) : i$1(e, t);
        var r, n
    }
}
var o$1 = function(e) {
    var t = e.finisher
      , i = e.descriptor;
    return function(e, r) {
        var n;
        if (void 0 === r) {
            var a = null !== (n = e.originalKey) && void 0 !== n ? n : e.key
              , o = null != i ? {
                kind: "method",
                placement: "prototype",
                key: a,
                descriptor: i(e.key)
            } : _objectSpread2(_objectSpread2({}, e), {}, {
                key: a
            });
            return null != t && (o.finisher = function(e) {
                t(e, a)
            }
            ),
            o
        }
        var s = e.constructor;
        void 0 !== i && Object.defineProperty(e, r, i(r)),
        null == t || t(s, r)
    }
}, n;
function i(e, t) {
    return o$1({
        descriptor: function(i) {
            var r = {
                get: function() {
                    var t, i;
                    return null !== (i = null === (t = this.renderRoot) || void 0 === t ? void 0 : t.querySelector(e)) && void 0 !== i ? i : null
                },
                enumerable: !0,
                configurable: !0
            };
            if (t) {
                var n = "symbol" == _typeof2(i) ? Symbol() : "__" + i;
                r.get = function() {
                    var t, i;
                    return void 0 === this[n] && (this[n] = null !== (i = null === (t = this.renderRoot) || void 0 === t ? void 0 : t.querySelector(e)) && void 0 !== i ? i : null),
                    this[n]
                }
            }
            return r
        }
    })
}
null === (n = window.HTMLSlotElement) || void 0 === n || n.prototype.assignedElements;
var lottie$1$1 = {
    exports: {}
};
(function(module) {
    var root, factory;
    "undefined" != typeof navigator && (root = window || {},
    factory = function factory(window) {
        var svgNS = "http://www.w3.org/2000/svg", locationHref = "", initialDefaultFrame = -999999, _useWebWorker = !1, subframeEnabled = !0, idPrefix = "", expressionsPlugin, isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent), bmPow = Math.pow, bmSqrt = Math.sqrt, bmFloor = Math.floor, bmMax = Math.max, bmMin = Math.min, BMMath = {};
        function ProjectInterface() {
            return {}
        }
        !function() {
            var e, t = ["abs", "acos", "acosh", "asin", "asinh", "atan", "atanh", "atan2", "ceil", "cbrt", "expm1", "clz32", "cos", "cosh", "exp", "floor", "fround", "hypot", "imul", "log", "log1p", "log2", "log10", "max", "min", "pow", "random", "round", "sign", "sin", "sinh", "sqrt", "tan", "tanh", "trunc", "E", "LN10", "LN2", "LOG10E", "LOG2E", "PI", "SQRT1_2", "SQRT2"], i = t.length;
            for (e = 0; e < i; e += 1)
                BMMath[t[e]] = Math[t[e]]
        }(),
        BMMath.random = Math.random,
        BMMath.abs = function(e) {
            if ("object" == _typeof2(e) && e.length) {
                var t, i = createSizedArray(e.length), r = e.length;
                for (t = 0; t < r; t += 1)
                    i[t] = Math.abs(e[t]);
                return i
            }
            return Math.abs(e)
        }
        ;
        var defaultCurveSegments = 150
          , degToRads = Math.PI / 180
          , roundCorner = .5519;
        function styleDiv(e) {
            e.style.position = "absolute",
            e.style.top = 0,
            e.style.left = 0,
            e.style.display = "block",
            e.style.transformOrigin = "0 0",
            e.style.webkitTransformOrigin = "0 0",
            e.style.backfaceVisibility = "visible",
            e.style.webkitBackfaceVisibility = "visible",
            e.style.transformStyle = "preserve-3d",
            e.style.webkitTransformStyle = "preserve-3d",
            e.style.mozTransformStyle = "preserve-3d"
        }
        function BMEnterFrameEvent(e, t, i, r) {
            this.type = e,
            this.currentTime = t,
            this.totalTime = i,
            this.direction = r < 0 ? -1 : 1
        }
        function BMCompleteEvent(e, t) {
            this.type = e,
            this.direction = t < 0 ? -1 : 1
        }
        function BMCompleteLoopEvent(e, t, i, r) {
            this.type = e,
            this.currentLoop = i,
            this.totalLoops = t,
            this.direction = r < 0 ? -1 : 1
        }
        function BMSegmentStartEvent(e, t, i) {
            this.type = e,
            this.firstFrame = t,
            this.totalFrames = i
        }
        function BMDestroyEvent(e, t) {
            this.type = e,
            this.target = t
        }
        function BMRenderFrameErrorEvent(e, t) {
            this.type = "renderFrameError",
            this.nativeError = e,
            this.currentTime = t
        }
        function BMConfigErrorEvent(e) {
            this.type = "configError",
            this.nativeError = e
        }
        var createElementID = (_count = 0,
        function() {
            return idPrefix + "__lottie_element_" + (_count += 1)
        }
        ), _count;
        function HSVtoRGB(e, t, i) {
            var r, n, a, o, s, l, h, c;
            switch (l = i * (1 - t),
            h = i * (1 - (s = 6 * e - (o = Math.floor(6 * e))) * t),
            c = i * (1 - (1 - s) * t),
            o % 6) {
            case 0:
                r = i,
                n = c,
                a = l;
                break;
            case 1:
                r = h,
                n = i,
                a = l;
                break;
            case 2:
                r = l,
                n = i,
                a = c;
                break;
            case 3:
                r = l,
                n = h,
                a = i;
                break;
            case 4:
                r = c,
                n = l,
                a = i;
                break;
            case 5:
                r = i,
                n = l,
                a = h
            }
            return [r, n, a]
        }
        function RGBtoHSV(e, t, i) {
            var r, n = Math.max(e, t, i), a = Math.min(e, t, i), o = n - a, s = 0 === n ? 0 : o / n, l = n / 255;
            switch (n) {
            case a:
                r = 0;
                break;
            case e:
                r = t - i + o * (t < i ? 6 : 0),
                r /= 6 * o;
                break;
            case t:
                r = i - e + 2 * o,
                r /= 6 * o;
                break;
            case i:
                r = e - t + 4 * o,
                r /= 6 * o
            }
            return [r, s, l]
        }
        function addSaturationToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[1] += t,
            i[1] > 1 ? i[1] = 1 : i[1] <= 0 && (i[1] = 0),
            HSVtoRGB(i[0], i[1], i[2])
        }
        function addBrightnessToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[2] += t,
            i[2] > 1 ? i[2] = 1 : i[2] < 0 && (i[2] = 0),
            HSVtoRGB(i[0], i[1], i[2])
        }
        function addHueToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[0] += t / 360,
            i[0] > 1 ? i[0] -= 1 : i[0] < 0 && (i[0] += 1),
            HSVtoRGB(i[0], i[1], i[2])
        }
        var rgbToHex = function() {
            var e, t, i = [];
            for (e = 0; e < 256; e += 1)
                t = e.toString(16),
                i[e] = 1 === t.length ? "0" + t : t;
            return function(e, t, r) {
                return e < 0 && (e = 0),
                t < 0 && (t = 0),
                r < 0 && (r = 0),
                "#" + i[e] + i[t] + i[r]
            }
        }();
        function BaseEvent() {}
        BaseEvent.prototype = {
            triggerEvent: function(e, t) {
                if (this._cbs[e])
                    for (var i = this._cbs[e], r = 0; r < i.length; r += 1)
                        i[r](t)
            },
            addEventListener: function(e, t) {
                return this._cbs[e] || (this._cbs[e] = []),
                this._cbs[e].push(t),
                function() {
                    this.removeEventListener(e, t)
                }
                .bind(this)
            },
            removeEventListener: function(e, t) {
                if (t) {
                    if (this._cbs[e]) {
                        for (var i = 0, r = this._cbs[e].length; i < r; )
                            this._cbs[e][i] === t && (this._cbs[e].splice(i, 1),
                            i -= 1,
                            r -= 1),
                            i += 1;
                        this._cbs[e].length || (this._cbs[e] = null)
                    }
                } else
                    this._cbs[e] = null
            }
        };
        var createTypedArray = function() {
            function e(e, t) {
                var i, r = 0, n = [];
                switch (e) {
                case "int16":
                case "uint8c":
                    i = 1;
                    break;
                default:
                    i = 1.1
                }
                for (r = 0; r < t; r += 1)
                    n.push(i);
                return n
            }
            return "function" == typeof Uint8ClampedArray && "function" == typeof Float32Array ? function(t, i) {
                return "float32" === t ? new Float32Array(i) : "int16" === t ? new Int16Array(i) : "uint8c" === t ? new Uint8ClampedArray(i) : e(t, i)
            }
            : e
        }();
        function createSizedArray(e) {
            return Array.apply(null, {
                length: e
            })
        }
        function createNS(e) {
            return document.createElementNS(svgNS, e)
        }
        function createTag(e) {
            return document.createElement(e)
        }
        function DynamicPropertyContainer() {}
        DynamicPropertyContainer.prototype = {
            addDynamicProperty: function(e) {
                -1 === this.dynamicProperties.indexOf(e) && (this.dynamicProperties.push(e),
                this.container.addDynamicProperty(this),
                this._isAnimated = !0)
            },
            iterateDynamicProperties: function() {
                var e;
                this._mdf = !1;
                var t = this.dynamicProperties.length;
                for (e = 0; e < t; e += 1)
                    this.dynamicProperties[e].getValue(),
                    this.dynamicProperties[e]._mdf && (this._mdf = !0)
            },
            initDynamicPropertyContainer: function(e) {
                this.container = e,
                this.dynamicProperties = [],
                this._mdf = !1,
                this._isAnimated = !1
            }
        };
        var getBlendMode = (blendModeEnums = {
            0: "source-over",
            1: "multiply",
            2: "screen",
            3: "overlay",
            4: "darken",
            5: "lighten",
            6: "color-dodge",
            7: "color-burn",
            8: "hard-light",
            9: "soft-light",
            10: "difference",
            11: "exclusion",
            12: "hue",
            13: "saturation",
            14: "color",
            15: "luminosity"
        },
        function(e) {
            return blendModeEnums[e] || ""
        }
        ), blendModeEnums, lineCapEnum = {
            1: "butt",
            2: "round",
            3: "square"
        }, lineJoinEnum = {
            1: "miter",
            2: "round",
            3: "bevel"
        }, Matrix = function() {
            var e = Math.cos
              , t = Math.sin
              , i = Math.tan
              , r = Math.round;
            function n() {
                return this.props[0] = 1,
                this.props[1] = 0,
                this.props[2] = 0,
                this.props[3] = 0,
                this.props[4] = 0,
                this.props[5] = 1,
                this.props[6] = 0,
                this.props[7] = 0,
                this.props[8] = 0,
                this.props[9] = 0,
                this.props[10] = 1,
                this.props[11] = 0,
                this.props[12] = 0,
                this.props[13] = 0,
                this.props[14] = 0,
                this.props[15] = 1,
                this
            }
            function a(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, -n, 0, 0, n, r, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function o(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(1, 0, 0, 0, 0, r, -n, 0, 0, n, r, 0, 0, 0, 0, 1)
            }
            function s(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, 0, n, 0, 0, 1, 0, 0, -n, 0, r, 0, 0, 0, 0, 1)
            }
            function l(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, -n, 0, 0, n, r, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function h(e, t) {
                return this._t(1, t, e, 1, 0, 0)
            }
            function c(e, t) {
                return this.shear(i(e), i(t))
            }
            function p(r, n) {
                var a = e(n)
                  , o = t(n);
                return this._t(a, o, 0, 0, -o, a, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)._t(1, 0, 0, 0, i(r), 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)._t(a, -o, 0, 0, o, a, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function u(e, t, i) {
                return i || 0 === i || (i = 1),
                1 === e && 1 === t && 1 === i ? this : this._t(e, 0, 0, 0, 0, t, 0, 0, 0, 0, i, 0, 0, 0, 0, 1)
            }
            function d(e, t, i, r, n, a, o, s, l, h, c, p, u, d, f, m) {
                return this.props[0] = e,
                this.props[1] = t,
                this.props[2] = i,
                this.props[3] = r,
                this.props[4] = n,
                this.props[5] = a,
                this.props[6] = o,
                this.props[7] = s,
                this.props[8] = l,
                this.props[9] = h,
                this.props[10] = c,
                this.props[11] = p,
                this.props[12] = u,
                this.props[13] = d,
                this.props[14] = f,
                this.props[15] = m,
                this
            }
            function f(e, t, i) {
                return i = i || 0,
                0 !== e || 0 !== t || 0 !== i ? this._t(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, e, t, i, 1) : this
            }
            function m(e, t, i, r, n, a, o, s, l, h, c, p, u, d, f, m) {
                var g = this.props;
                if (1 === e && 0 === t && 0 === i && 0 === r && 0 === n && 1 === a && 0 === o && 0 === s && 0 === l && 0 === h && 1 === c && 0 === p)
                    return g[12] = g[12] * e + g[15] * u,
                    g[13] = g[13] * a + g[15] * d,
                    g[14] = g[14] * c + g[15] * f,
                    g[15] *= m,
                    this._identityCalculated = !1,
                    this;
                var v = g[0]
                  , y = g[1]
                  , _ = g[2]
                  , b = g[3]
                  , x = g[4]
                  , w = g[5]
                  , S = g[6]
                  , T = g[7]
                  , k = g[8]
                  , E = g[9]
                  , M = g[10]
                  , P = g[11]
                  , C = g[12]
                  , A = g[13]
                  , L = g[14]
                  , D = g[15];
                return g[0] = v * e + y * n + _ * l + b * u,
                g[1] = v * t + y * a + _ * h + b * d,
                g[2] = v * i + y * o + _ * c + b * f,
                g[3] = v * r + y * s + _ * p + b * m,
                g[4] = x * e + w * n + S * l + T * u,
                g[5] = x * t + w * a + S * h + T * d,
                g[6] = x * i + w * o + S * c + T * f,
                g[7] = x * r + w * s + S * p + T * m,
                g[8] = k * e + E * n + M * l + P * u,
                g[9] = k * t + E * a + M * h + P * d,
                g[10] = k * i + E * o + M * c + P * f,
                g[11] = k * r + E * s + M * p + P * m,
                g[12] = C * e + A * n + L * l + D * u,
                g[13] = C * t + A * a + L * h + D * d,
                g[14] = C * i + A * o + L * c + D * f,
                g[15] = C * r + A * s + L * p + D * m,
                this._identityCalculated = !1,
                this
            }
            function g() {
                return this._identityCalculated || (this._identity = !(1 !== this.props[0] || 0 !== this.props[1] || 0 !== this.props[2] || 0 !== this.props[3] || 0 !== this.props[4] || 1 !== this.props[5] || 0 !== this.props[6] || 0 !== this.props[7] || 0 !== this.props[8] || 0 !== this.props[9] || 1 !== this.props[10] || 0 !== this.props[11] || 0 !== this.props[12] || 0 !== this.props[13] || 0 !== this.props[14] || 1 !== this.props[15]),
                this._identityCalculated = !0),
                this._identity
            }
            function v(e) {
                for (var t = 0; t < 16; ) {
                    if (e.props[t] !== this.props[t])
                        return !1;
                    t += 1
                }
                return !0
            }
            function y(e) {
                var t;
                for (t = 0; t < 16; t += 1)
                    e.props[t] = this.props[t];
                return e
            }
            function _(e) {
                var t;
                for (t = 0; t < 16; t += 1)
                    this.props[t] = e[t]
            }
            function b(e, t, i) {
                return {
                    x: e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12],
                    y: e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13],
                    z: e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]
                }
            }
            function x(e, t, i) {
                return e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12]
            }
            function w(e, t, i) {
                return e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13]
            }
            function S(e, t, i) {
                return e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]
            }
            function T() {
                var e = this.props[0] * this.props[5] - this.props[1] * this.props[4]
                  , t = this.props[5] / e
                  , i = -this.props[1] / e
                  , r = -this.props[4] / e
                  , n = this.props[0] / e
                  , a = (this.props[4] * this.props[13] - this.props[5] * this.props[12]) / e
                  , o = -(this.props[0] * this.props[13] - this.props[1] * this.props[12]) / e
                  , s = new Matrix;
                return s.props[0] = t,
                s.props[1] = i,
                s.props[4] = r,
                s.props[5] = n,
                s.props[12] = a,
                s.props[13] = o,
                s
            }
            function k(e) {
                return this.getInverseMatrix().applyToPointArray(e[0], e[1], e[2] || 0)
            }
            function E(e) {
                var t, i = e.length, r = [];
                for (t = 0; t < i; t += 1)
                    r[t] = k(e[t]);
                return r
            }
            function M(e, t, i) {
                var r = createTypedArray("float32", 6);
                if (this.isIdentity())
                    r[0] = e[0],
                    r[1] = e[1],
                    r[2] = t[0],
                    r[3] = t[1],
                    r[4] = i[0],
                    r[5] = i[1];
                else {
                    var n = this.props[0]
                      , a = this.props[1]
                      , o = this.props[4]
                      , s = this.props[5]
                      , l = this.props[12]
                      , h = this.props[13];
                    r[0] = e[0] * n + e[1] * o + l,
                    r[1] = e[0] * a + e[1] * s + h,
                    r[2] = t[0] * n + t[1] * o + l,
                    r[3] = t[0] * a + t[1] * s + h,
                    r[4] = i[0] * n + i[1] * o + l,
                    r[5] = i[0] * a + i[1] * s + h
                }
                return r
            }
            function P(e, t, i) {
                return this.isIdentity() ? [e, t, i] : [e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12], e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13], e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]]
            }
            function C(e, t) {
                if (this.isIdentity())
                    return e + "," + t;
                var i = this.props;
                return Math.round(100 * (e * i[0] + t * i[4] + i[12])) / 100 + "," + Math.round(100 * (e * i[1] + t * i[5] + i[13])) / 100
            }
            function A() {
                for (var e = 0, t = this.props, i = "matrix3d("; e < 16; )
                    i += r(1e4 * t[e]) / 1e4,
                    i += 15 === e ? ")" : ",",
                    e += 1;
                return i
            }
            function L(e) {
                return e < 1e-6 && e > 0 || e > -1e-6 && e < 0 ? r(1e4 * e) / 1e4 : e
            }
            function D() {
                var e = this.props;
                return "matrix(" + L(e[0]) + "," + L(e[1]) + "," + L(e[4]) + "," + L(e[5]) + "," + L(e[12]) + "," + L(e[13]) + ")"
            }
            return function() {
                this.reset = n,
                this.rotate = a,
                this.rotateX = o,
                this.rotateY = s,
                this.rotateZ = l,
                this.skew = c,
                this.skewFromAxis = p,
                this.shear = h,
                this.scale = u,
                this.setTransform = d,
                this.translate = f,
                this.transform = m,
                this.applyToPoint = b,
                this.applyToX = x,
                this.applyToY = w,
                this.applyToZ = S,
                this.applyToPointArray = P,
                this.applyToTriplePoints = M,
                this.applyToPointStringified = C,
                this.toCSS = A,
                this.to2dCSS = D,
                this.clone = y,
                this.cloneFromProps = _,
                this.equals = v,
                this.inversePoints = E,
                this.inversePoint = k,
                this.getInverseMatrix = T,
                this._t = this.transform,
                this.isIdentity = g,
                this._identity = !0,
                this._identityCalculated = !1,
                this.props = createTypedArray("float32", 16),
                this.reset()
            }
        }();
        !function(e, t) {
            var i = this
              , r = 256
              , n = t.pow(r, 6)
              , a = t.pow(2, 52)
              , o = 2 * a
              , s = 255;
            function l(e) {
                var t, i = e.length, n = this, a = 0, o = n.i = n.j = 0, l = n.S = [];
                for (i || (e = [i++]); a < r; )
                    l[a] = a++;
                for (a = 0; a < r; a++)
                    l[a] = l[o = s & o + e[a % i] + (t = l[a])],
                    l[o] = t;
                n.g = function(e) {
                    for (var t, i = 0, a = n.i, o = n.j, l = n.S; e--; )
                        t = l[a = s & a + 1],
                        i = i * r + l[s & (l[a] = l[o = s & o + t]) + (l[o] = t)];
                    return n.i = a,
                    n.j = o,
                    i
                }
            }
            function h(e, t) {
                return t.i = e.i,
                t.j = e.j,
                t.S = e.S.slice(),
                t
            }
            function c(e, t) {
                var i, r = [], n = _typeof2(e);
                if (t && "object" == n)
                    for (i in e)
                        try {
                            r.push(c(e[i], t - 1))
                        } catch (a) {}
                return r.length ? r : "string" == n ? e : e + "\0"
            }
            function p(e, t) {
                for (var i, r = e + "", n = 0; n < r.length; )
                    t[s & n] = s & (i ^= 19 * t[s & n]) + r.charCodeAt(n++);
                return u(t)
            }
            function u(e) {
                return String.fromCharCode.apply(0, e)
            }
            t.seedrandom = function(s, d, f) {
                var m = []
                  , g = p(c((d = !0 === d ? {
                    entropy: !0
                } : d || {}).entropy ? [s, u(e)] : null === s ? function() {
                    try {
                        var t = new Uint8Array(r);
                        return (i.crypto || i.msCrypto).getRandomValues(t),
                        u(t)
                    } catch (o) {
                        var n = i.navigator
                          , a = n && n.plugins;
                        return [+new Date, i, a, i.screen, u(e)]
                    }
                }() : s, 3), m)
                  , v = new l(m)
                  , y = function() {
                    for (var e = v.g(6), t = n, i = 0; e < a; )
                        e = (e + i) * r,
                        t *= r,
                        i = v.g(1);
                    for (; e >= o; )
                        e /= 2,
                        t /= 2,
                        i >>>= 1;
                    return (e + i) / t
                };
                return y.int32 = function() {
                    return 0 | v.g(4)
                }
                ,
                y.quick = function() {
                    return v.g(4) / 4294967296
                }
                ,
                y.double = y,
                p(u(v.S), e),
                (d.pass || f || function(e, i, r, n) {
                    return n && (n.S && h(n, v),
                    e.state = function() {
                        return h(v, {})
                    }
                    ),
                    r ? (t.random = e,
                    i) : e
                }
                )(y, g, "global"in d ? d.global : this == t, d.state)
            }
            ,
            p(t.random(), e)
        }([], BMMath);
        var BezierFactory = function() {
            var e = {
                getBezierEasing: function(e, i, r, n, a) {
                    var o = a || ("bez_" + e + "_" + i + "_" + r + "_" + n).replace(/\./g, "p");
                    if (t[o])
                        return t[o];
                    var s = new h([e, i, r, n]);
                    return t[o] = s,
                    s
                }
            }
              , t = {}
              , i = .1
              , r = "function" == typeof Float32Array;
            function n(e, t) {
                return 1 - 3 * t + 3 * e
            }
            function a(e, t) {
                return 3 * t - 6 * e
            }
            function o(e) {
                return 3 * e
            }
            function s(e, t, i) {
                return ((n(t, i) * e + a(t, i)) * e + o(t)) * e
            }
            function l(e, t, i) {
                return 3 * n(t, i) * e * e + 2 * a(t, i) * e + o(t)
            }
            function h(e) {
                this._p = e,
                this._mSampleValues = r ? new Float32Array(11) : new Array(11),
                this._precomputed = !1,
                this.get = this.get.bind(this)
            }
            return h.prototype = {
                get: function(e) {
                    var t = this._p[0]
                      , i = this._p[1]
                      , r = this._p[2]
                      , n = this._p[3];
                    return this._precomputed || this._precompute(),
                    t === i && r === n ? e : 0 === e ? 0 : 1 === e ? 1 : s(this._getTForX(e), i, n)
                },
                _precompute: function() {
                    var e = this._p[0]
                      , t = this._p[1]
                      , i = this._p[2]
                      , r = this._p[3];
                    this._precomputed = !0,
                    e === t && i === r || this._calcSampleValues()
                },
                _calcSampleValues: function() {
                    for (var e = this._p[0], t = this._p[2], r = 0; r < 11; ++r)
                        this._mSampleValues[r] = s(r * i, e, t)
                },
                _getTForX: function(e) {
                    for (var t = this._p[0], r = this._p[2], n = this._mSampleValues, a = 0, o = 1; 10 !== o && n[o] <= e; ++o)
                        a += i;
                    var h = a + (e - n[--o]) / (n[o + 1] - n[o]) * i
                      , c = l(h, t, r);
                    return c >= .001 ? function(e, t, i, r) {
                        for (var n = 0; n < 4; ++n) {
                            var a = l(t, i, r);
                            if (0 === a)
                                return t;
                            t -= (s(t, i, r) - e) / a
                        }
                        return t
                    }(e, h, t, r) : 0 === c ? h : function(e, t, i, r, n) {
                        var a, o, l = 0;
                        do {
                            (a = s(o = t + (i - t) / 2, r, n) - e) > 0 ? i = o : t = o
                        } while (Math.abs(a) > 1e-7 && ++l < 10);
                        return o
                    }(e, a, a + i, t, r)
                }
            },
            e
        }();
        function extendPrototype(e, t) {
            var i, r, n = e.length;
            for (i = 0; i < n; i += 1)
                for (var a in r = e[i].prototype)
                    Object.prototype.hasOwnProperty.call(r, a) && (t.prototype[a] = r[a])
        }
        function getDescriptor(e, t) {
            return Object.getOwnPropertyDescriptor(e, t)
        }
        function createProxyFunction(e) {
            function t() {}
            return t.prototype = e,
            t
        }
        function bezFunction() {
            var e = Math;
            function t(e, t, i, r, n, a) {
                var o = e * r + t * n + i * a - n * r - a * e - i * t;
                return o > -.001 && o < .001
            }
            var i = function(e, t, i, r) {
                var n, a, o, s, l, h, c = defaultCurveSegments, p = 0, u = [], d = [], f = bezierLengthPool.newElement();
                for (o = i.length,
                n = 0; n < c; n += 1) {
                    for (l = n / (c - 1),
                    h = 0,
                    a = 0; a < o; a += 1)
                        s = bmPow(1 - l, 3) * e[a] + 3 * bmPow(1 - l, 2) * l * i[a] + 3 * (1 - l) * bmPow(l, 2) * r[a] + bmPow(l, 3) * t[a],
                        u[a] = s,
                        null !== d[a] && (h += bmPow(u[a] - d[a], 2)),
                        d[a] = u[a];
                    h && (p += h = bmSqrt(h)),
                    f.percents[n] = l,
                    f.lengths[n] = p
                }
                return f.addedLength = p,
                f
            };
            function r(e) {
                this.segmentLength = 0,
                this.points = new Array(e)
            }
            function n(e, t) {
                this.partialLength = e,
                this.point = t
            }
            var a, o = (a = {},
            function(e, i, o, s) {
                var l = (e[0] + "_" + e[1] + "_" + i[0] + "_" + i[1] + "_" + o[0] + "_" + o[1] + "_" + s[0] + "_" + s[1]).replace(/\./g, "p");
                if (!a[l]) {
                    var h, c, p, u, d, f, m, g = defaultCurveSegments, v = 0, y = null;
                    2 === e.length && (e[0] !== i[0] || e[1] !== i[1]) && t(e[0], e[1], i[0], i[1], e[0] + o[0], e[1] + o[1]) && t(e[0], e[1], i[0], i[1], i[0] + s[0], i[1] + s[1]) && (g = 2);
                    var _ = new r(g);
                    for (p = o.length,
                    h = 0; h < g; h += 1) {
                        for (m = createSizedArray(p),
                        d = h / (g - 1),
                        f = 0,
                        c = 0; c < p; c += 1)
                            u = bmPow(1 - d, 3) * e[c] + 3 * bmPow(1 - d, 2) * d * (e[c] + o[c]) + 3 * (1 - d) * bmPow(d, 2) * (i[c] + s[c]) + bmPow(d, 3) * i[c],
                            m[c] = u,
                            null !== y && (f += bmPow(m[c] - y[c], 2));
                        v += f = bmSqrt(f),
                        _.points[h] = new n(f,m),
                        y = m
                    }
                    _.segmentLength = v,
                    a[l] = _
                }
                return a[l]
            }
            );
            function s(e, t) {
                var i = t.percents
                  , r = t.lengths
                  , n = i.length
                  , a = bmFloor((n - 1) * e)
                  , o = e * t.addedLength
                  , s = 0;
                if (a === n - 1 || 0 === a || o === r[a])
                    return i[a];
                for (var l = r[a] > o ? -1 : 1, h = !0; h; )
                    if (r[a] <= o && r[a + 1] > o ? (s = (o - r[a]) / (r[a + 1] - r[a]),
                    h = !1) : a += l,
                    a < 0 || a >= n - 1) {
                        if (a === n - 1)
                            return i[a];
                        h = !1
                    }
                return i[a] + (i[a + 1] - i[a]) * s
            }
            var l = createTypedArray("float32", 8);
            return {
                getSegmentsLength: function(e) {
                    var t, r = segmentsLengthPool.newElement(), n = e.c, a = e.v, o = e.o, s = e.i, l = e._length, h = r.lengths, c = 0;
                    for (t = 0; t < l - 1; t += 1)
                        h[t] = i(a[t], a[t + 1], o[t], s[t + 1]),
                        c += h[t].addedLength;
                    return n && l && (h[t] = i(a[t], a[0], o[t], s[0]),
                    c += h[t].addedLength),
                    r.totalLength = c,
                    r
                },
                getNewSegment: function(t, i, r, n, a, o, h) {
                    a < 0 ? a = 0 : a > 1 && (a = 1);
                    var c, p = s(a, h), u = s(o = o > 1 ? 1 : o, h), d = t.length, f = 1 - p, m = 1 - u, g = f * f * f, v = p * f * f * 3, y = p * p * f * 3, _ = p * p * p, b = f * f * m, x = p * f * m + f * p * m + f * f * u, w = p * p * m + f * p * u + p * f * u, S = p * p * u, T = f * m * m, k = p * m * m + f * u * m + f * m * u, E = p * u * m + f * u * u + p * m * u, M = p * u * u, P = m * m * m, C = u * m * m + m * u * m + m * m * u, A = u * u * m + m * u * u + u * m * u, L = u * u * u;
                    for (c = 0; c < d; c += 1)
                        l[4 * c] = e.round(1e3 * (g * t[c] + v * r[c] + y * n[c] + _ * i[c])) / 1e3,
                        l[4 * c + 1] = e.round(1e3 * (b * t[c] + x * r[c] + w * n[c] + S * i[c])) / 1e3,
                        l[4 * c + 2] = e.round(1e3 * (T * t[c] + k * r[c] + E * n[c] + M * i[c])) / 1e3,
                        l[4 * c + 3] = e.round(1e3 * (P * t[c] + C * r[c] + A * n[c] + L * i[c])) / 1e3;
                    return l
                },
                getPointInSegment: function(t, i, r, n, a, o) {
                    var l = s(a, o)
                      , h = 1 - l;
                    return [e.round(1e3 * (h * h * h * t[0] + (l * h * h + h * l * h + h * h * l) * r[0] + (l * l * h + h * l * l + l * h * l) * n[0] + l * l * l * i[0])) / 1e3, e.round(1e3 * (h * h * h * t[1] + (l * h * h + h * l * h + h * h * l) * r[1] + (l * l * h + h * l * l + l * h * l) * n[1] + l * l * l * i[1])) / 1e3]
                },
                buildBezierData: o,
                pointOnLine2D: t,
                pointOnLine3D: function(i, r, n, a, o, s, l, h, c) {
                    if (0 === n && 0 === s && 0 === c)
                        return t(i, r, a, o, l, h);
                    var p, u = e.sqrt(e.pow(a - i, 2) + e.pow(o - r, 2) + e.pow(s - n, 2)), d = e.sqrt(e.pow(l - i, 2) + e.pow(h - r, 2) + e.pow(c - n, 2)), f = e.sqrt(e.pow(l - a, 2) + e.pow(h - o, 2) + e.pow(c - s, 2));
                    return (p = u > d ? u > f ? u - d - f : f - d - u : f > d ? f - d - u : d - u - f) > -1e-4 && p < 1e-4
                }
            }
        }
        !function() {
            for (var e = 0, t = ["ms", "moz", "webkit", "o"], i = 0; i < t.length && !window.requestAnimationFrame; ++i)
                window.requestAnimationFrame = window[t[i] + "RequestAnimationFrame"],
                window.cancelAnimationFrame = window[t[i] + "CancelAnimationFrame"] || window[t[i] + "CancelRequestAnimationFrame"];
            window.requestAnimationFrame || (window.requestAnimationFrame = function(t) {
                var i = (new Date).getTime()
                  , r = Math.max(0, 16 - (i - e))
                  , n = setTimeout((function() {
                    t(i + r)
                }
                ), r);
                return e = i + r,
                n
            }
            ),
            window.cancelAnimationFrame || (window.cancelAnimationFrame = function(e) {
                clearTimeout(e)
            }
            )
        }();
        var bez = bezFunction()
          , dataManager = function() {
            var e, t, i = 1, r = [], n = {
                onmessage: function() {},
                postMessage: function(t) {
                    e({
                        data: t
                    })
                }
            }, a = {
                postMessage: function(e) {
                    n.onmessage({
                        data: e
                    })
                }
            };
            function o() {
                t || ((t = function(t) {
                    if (window.Worker && window.Blob && _useWebWorker) {
                        var i = new Blob(["var _workerSelf = self; self.onmessage = ", t.toString()],{
                            type: "text/javascript"
                        })
                          , r = URL.createObjectURL(i);
                        return new Worker(r)
                    }
                    return e = t,
                    n
                }((function(e) {
                    if (a.dataManager || (a.dataManager = function() {
                        function e(n, a) {
                            var o, s, l, h, c, p, u, d = n.length;
                            for (s = 0; s < d; s += 1)
                                if ("ks"in (o = n[s]) && !o.completed) {
                                    if (o.completed = !0,
                                    o.tt && (n[s - 1].td = o.tt),
                                    o.hasMask) {
                                        var f = o.masksProperties;
                                        for (h = f.length,
                                        l = 0; l < h; l += 1)
                                            if (f[l].pt.k.i)
                                                r(f[l].pt.k);
                                            else
                                                for (p = f[l].pt.k.length,
                                                c = 0; c < p; c += 1)
                                                    f[l].pt.k[c].s && r(f[l].pt.k[c].s[0]),
                                                    f[l].pt.k[c].e && r(f[l].pt.k[c].e[0])
                                    }
                                    0 === o.ty ? (o.layers = t(o.refId, a),
                                    e(o.layers, a)) : 4 === o.ty ? i(o.shapes) : 5 === o.ty && (0 !== (u = o).t.a.length || "m"in u.t.p || (u.singleShape = !0))
                                }
                        }
                        function t(e, t) {
                            for (var i = 0, r = t.length; i < r; ) {
                                if (t[i].id === e)
                                    return t[i].layers.__used ? JSON.parse(JSON.stringify(t[i].layers)) : (t[i].layers.__used = !0,
                                    t[i].layers);
                                i += 1
                            }
                            return null
                        }
                        function i(e) {
                            var t, n, a;
                            for (t = e.length - 1; t >= 0; t -= 1)
                                if ("sh" === e[t].ty)
                                    if (e[t].ks.k.i)
                                        r(e[t].ks.k);
                                    else
                                        for (a = e[t].ks.k.length,
                                        n = 0; n < a; n += 1)
                                            e[t].ks.k[n].s && r(e[t].ks.k[n].s[0]),
                                            e[t].ks.k[n].e && r(e[t].ks.k[n].e[0]);
                                else
                                    "gr" === e[t].ty && i(e[t].it)
                        }
                        function r(e) {
                            var t, i = e.i.length;
                            for (t = 0; t < i; t += 1)
                                e.i[t][0] += e.v[t][0],
                                e.i[t][1] += e.v[t][1],
                                e.o[t][0] += e.v[t][0],
                                e.o[t][1] += e.v[t][1]
                        }
                        function n(e, t) {
                            var i = t ? t.split(".") : [100, 100, 100];
                            return e[0] > i[0] || !(i[0] > e[0]) && (e[1] > i[1] || !(i[1] > e[1]) && (e[2] > i[2] || !(i[2] > e[2]) && null))
                        }
                        var a, o = function() {
                            var e = [4, 4, 14];
                            function t(e) {
                                var t, i, r, n = e.length;
                                for (t = 0; t < n; t += 1)
                                    5 === e[t].ty && (r = (i = e[t]).t.d,
                                    i.t.d = {
                                        k: [{
                                            s: r,
                                            t: 0
                                        }]
                                    })
                            }
                            return function(i) {
                                if (n(e, i.v) && (t(i.layers),
                                i.assets)) {
                                    var r, a = i.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        i.assets[r].layers && t(i.assets[r].layers)
                                }
                            }
                        }(), s = (a = [4, 7, 99],
                        function(e) {
                            if (e.chars && !n(a, e.v)) {
                                var t, i, o, s, l, h = e.chars.length;
                                for (t = 0; t < h; t += 1)
                                    if (e.chars[t].data && e.chars[t].data.shapes)
                                        for (o = (l = e.chars[t].data.shapes[0].it).length,
                                        i = 0; i < o; i += 1)
                                            (s = l[i].ks.k).__converted || (r(l[i].ks.k),
                                            s.__converted = !0)
                            }
                        }
                        ), l = function() {
                            var e = [5, 7, 15];
                            function t(e) {
                                var t, i, r = e.length;
                                for (t = 0; t < r; t += 1)
                                    5 === e[t].ty && (i = void 0,
                                    "number" == typeof (i = e[t].t.p).a && (i.a = {
                                        a: 0,
                                        k: i.a
                                    }),
                                    "number" == typeof i.p && (i.p = {
                                        a: 0,
                                        k: i.p
                                    }),
                                    "number" == typeof i.r && (i.r = {
                                        a: 0,
                                        k: i.r
                                    }))
                            }
                            return function(i) {
                                if (n(e, i.v) && (t(i.layers),
                                i.assets)) {
                                    var r, a = i.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        i.assets[r].layers && t(i.assets[r].layers)
                                }
                            }
                        }(), h = function() {
                            var e = [4, 1, 9];
                            function t(e) {
                                var i, r, n, a = e.length;
                                for (i = 0; i < a; i += 1)
                                    if ("gr" === e[i].ty)
                                        t(e[i].it);
                                    else if ("fl" === e[i].ty || "st" === e[i].ty)
                                        if (e[i].c.k && e[i].c.k[0].i)
                                            for (n = e[i].c.k.length,
                                            r = 0; r < n; r += 1)
                                                e[i].c.k[r].s && (e[i].c.k[r].s[0] /= 255,
                                                e[i].c.k[r].s[1] /= 255,
                                                e[i].c.k[r].s[2] /= 255,
                                                e[i].c.k[r].s[3] /= 255),
                                                e[i].c.k[r].e && (e[i].c.k[r].e[0] /= 255,
                                                e[i].c.k[r].e[1] /= 255,
                                                e[i].c.k[r].e[2] /= 255,
                                                e[i].c.k[r].e[3] /= 255);
                                        else
                                            e[i].c.k[0] /= 255,
                                            e[i].c.k[1] /= 255,
                                            e[i].c.k[2] /= 255,
                                            e[i].c.k[3] /= 255
                            }
                            function i(e) {
                                var i, r = e.length;
                                for (i = 0; i < r; i += 1)
                                    4 === e[i].ty && t(e[i].shapes)
                            }
                            return function(t) {
                                if (n(e, t.v) && (i(t.layers),
                                t.assets)) {
                                    var r, a = t.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        t.assets[r].layers && i(t.assets[r].layers)
                                }
                            }
                        }(), c = function() {
                            var e = [4, 4, 18];
                            function t(e) {
                                var i, r, n;
                                for (i = e.length - 1; i >= 0; i -= 1)
                                    if ("sh" === e[i].ty)
                                        if (e[i].ks.k.i)
                                            e[i].ks.k.c = e[i].closed;
                                        else
                                            for (n = e[i].ks.k.length,
                                            r = 0; r < n; r += 1)
                                                e[i].ks.k[r].s && (e[i].ks.k[r].s[0].c = e[i].closed),
                                                e[i].ks.k[r].e && (e[i].ks.k[r].e[0].c = e[i].closed);
                                    else
                                        "gr" === e[i].ty && t(e[i].it)
                            }
                            function i(e) {
                                var i, r, n, a, o, s, l = e.length;
                                for (r = 0; r < l; r += 1) {
                                    if ((i = e[r]).hasMask) {
                                        var h = i.masksProperties;
                                        for (a = h.length,
                                        n = 0; n < a; n += 1)
                                            if (h[n].pt.k.i)
                                                h[n].pt.k.c = h[n].cl;
                                            else
                                                for (s = h[n].pt.k.length,
                                                o = 0; o < s; o += 1)
                                                    h[n].pt.k[o].s && (h[n].pt.k[o].s[0].c = h[n].cl),
                                                    h[n].pt.k[o].e && (h[n].pt.k[o].e[0].c = h[n].cl)
                                    }
                                    4 === i.ty && t(i.shapes)
                                }
                            }
                            return function(t) {
                                if (n(e, t.v) && (i(t.layers),
                                t.assets)) {
                                    var r, a = t.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        t.assets[r].layers && i(t.assets[r].layers)
                                }
                            }
                        }(), p = {
                            completeData: function(t) {
                                t.__complete || (h(t),
                                o(t),
                                s(t),
                                l(t),
                                c(t),
                                e(t.layers, t.assets),
                                t.__complete = !0)
                            }
                        };
                        return p.checkColors = h,
                        p.checkChars = s,
                        p.checkPathProperties = l,
                        p.checkShapes = c,
                        p.completeLayers = e,
                        p
                    }()),
                    a.assetLoader || (a.assetLoader = function() {
                        function e(e) {
                            var t = e.getResponseHeader("content-type");
                            return t && "json" === e.responseType && -1 !== t.indexOf("json") || e.response && "object" == _typeof2(e.response) ? e.response : e.response && "string" == typeof e.response ? JSON.parse(e.response) : e.responseText ? JSON.parse(e.responseText) : null
                        }
                        return {
                            load: function(t, i, r, n) {
                                var a, o = new XMLHttpRequest;
                                try {
                                    o.responseType = "json"
                                } catch (s) {}
                                o.onreadystatechange = function() {
                                    if (4 === o.readyState)
                                        if (200 === o.status)
                                            a = e(o),
                                            r(a);
                                        else
                                            try {
                                                a = e(o),
                                                r(a)
                                            } catch (s) {
                                                n && n(s)
                                            }
                                }
                                ;
                                try {
                                    o.open("GET", t, !0)
                                } catch (s) {
                                    o.open("GET", i + "/" + t, !0)
                                }
                                o.send()
                            }
                        }
                    }()),
                    "loadAnimation" === e.data.type)
                        a.assetLoader.load(e.data.path, e.data.fullPath, (function(t) {
                            a.dataManager.completeData(t),
                            a.postMessage({
                                id: e.data.id,
                                payload: t,
                                status: "success"
                            })
                        }
                        ), (function() {
                            a.postMessage({
                                id: e.data.id,
                                status: "error"
                            })
                        }
                        ));
                    else if ("complete" === e.data.type) {
                        var t = e.data.animation;
                        a.dataManager.completeData(t),
                        a.postMessage({
                            id: e.data.id,
                            payload: t,
                            status: "success"
                        })
                    } else
                        "loadData" === e.data.type && a.assetLoader.load(e.data.path, e.data.fullPath, (function(t) {
                            a.postMessage({
                                id: e.data.id,
                                payload: t,
                                status: "success"
                            })
                        }
                        ), (function() {
                            a.postMessage({
                                id: e.data.id,
                                status: "error"
                            })
                        }
                        ))
                }
                ))).onmessage = function(e) {
                    var t = e.data
                      , i = t.id
                      , n = r[i];
                    r[i] = null,
                    "success" === t.status ? n.onComplete(t.payload) : n.onError && n.onError()
                }
                )
            }
            function s(e, t) {
                var n = "processId_" + (i += 1);
                return r[n] = {
                    onComplete: e,
                    onError: t
                },
                n
            }
            return {
                loadAnimation: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "loadAnimation",
                        path: e,
                        fullPath: window.location.origin + window.location.pathname,
                        id: n
                    })
                },
                loadData: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "loadData",
                        path: e,
                        fullPath: window.location.origin + window.location.pathname,
                        id: n
                    })
                },
                completeAnimation: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "complete",
                        animation: e,
                        id: n
                    })
                }
            }
        }();
        function getFontProperties(e) {
            for (var t = e.fStyle ? e.fStyle.split(" ") : [], i = "normal", r = "normal", n = t.length, a = 0; a < n; a += 1)
                switch (t[a].toLowerCase()) {
                case "italic":
                    r = "italic";
                    break;
                case "bold":
                    i = "700";
                    break;
                case "black":
                    i = "900";
                    break;
                case "medium":
                    i = "500";
                    break;
                case "regular":
                case "normal":
                    i = "400";
                    break;
                case "light":
                case "thin":
                    i = "200"
                }
            return {
                style: r,
                weight: e.fWeight || i
            }
        }
        var FontManager = function() {
            var e = {
                w: 0,
                size: 0,
                shapes: []
            }
              , t = [];
            t = t.concat([2304, 2305, 2306, 2307, 2362, 2363, 2364, 2364, 2366, 2367, 2368, 2369, 2370, 2371, 2372, 2373, 2374, 2375, 2376, 2377, 2378, 2379, 2380, 2381, 2382, 2383, 2387, 2388, 2389, 2390, 2391, 2402, 2403]);
            var i = ["d83cdffb", "d83cdffc", "d83cdffd", "d83cdffe", "d83cdfff"]
              , r = [65039, 8205];
            function n(e, t) {
                var i = createTag("span");
                i.setAttribute("aria-hidden", !0),
                i.style.fontFamily = t;
                var r = createTag("span");
                r.innerText = "giItT1WQy@!-/#",
                i.style.position = "absolute",
                i.style.left = "-10000px",
                i.style.top = "-10000px",
                i.style.fontSize = "300px",
                i.style.fontVariant = "normal",
                i.style.fontStyle = "normal",
                i.style.fontWeight = "normal",
                i.style.letterSpacing = "0",
                i.appendChild(r),
                document.body.appendChild(i);
                var n = r.offsetWidth;
                return r.style.fontFamily = function(e) {
                    var t, i = e.split(","), r = i.length, n = [];
                    for (t = 0; t < r; t += 1)
                        "sans-serif" !== i[t] && "monospace" !== i[t] && n.push(i[t]);
                    return n.join(",")
                }(e) + ", " + t,
                {
                    node: r,
                    w: n,
                    parent: i
                }
            }
            function a(e, t) {
                var i = createNS("text");
                i.style.fontSize = "100px";
                var r = getFontProperties(t);
                return i.setAttribute("font-family", t.fFamily),
                i.setAttribute("font-style", r.style),
                i.setAttribute("font-weight", r.weight),
                i.textContent = "1",
                t.fClass ? (i.style.fontFamily = "inherit",
                i.setAttribute("class", t.fClass)) : i.style.fontFamily = t.fFamily,
                e.appendChild(i),
                createTag("canvas").getContext("2d").font = t.fWeight + " " + t.fStyle + " 100px " + t.fFamily,
                i
            }
            var o = function() {
                this.fonts = [],
                this.chars = null,
                this.typekitLoaded = 0,
                this.isLoaded = !1,
                this._warned = !1,
                this.initTime = Date.now(),
                this.setIsLoadedBinded = this.setIsLoaded.bind(this),
                this.checkLoadedFontsBinded = this.checkLoadedFonts.bind(this)
            };
            return o.isModifier = function(e, t) {
                var r = e.toString(16) + t.toString(16);
                return -1 !== i.indexOf(r)
            }
            ,
            o.isZeroWidthJoiner = function(e, t) {
                return t ? e === r[0] && t === r[1] : e === r[1]
            }
            ,
            o.isCombinedCharacter = function(e) {
                return -1 !== t.indexOf(e)
            }
            ,
            o.prototype = {
                addChars: function(e) {
                    if (e) {
                        var t;
                        this.chars || (this.chars = []);
                        var i, r, n = e.length, a = this.chars.length;
                        for (t = 0; t < n; t += 1) {
                            for (i = 0,
                            r = !1; i < a; )
                                this.chars[i].style === e[t].style && this.chars[i].fFamily === e[t].fFamily && this.chars[i].ch === e[t].ch && (r = !0),
                                i += 1;
                            r || (this.chars.push(e[t]),
                            a += 1)
                        }
                    }
                },
                addFonts: function(e, t) {
                    if (e) {
                        if (this.chars)
                            return this.isLoaded = !0,
                            void (this.fonts = e.list);
                        var i, r = e.list, o = r.length, s = o;
                        for (i = 0; i < o; i += 1) {
                            var l, h, c = !0;
                            if (r[i].loaded = !1,
                            r[i].monoCase = n(r[i].fFamily, "monospace"),
                            r[i].sansCase = n(r[i].fFamily, "sans-serif"),
                            r[i].fPath) {
                                if ("p" === r[i].fOrigin || 3 === r[i].origin) {
                                    if ((l = document.querySelectorAll('style[f-forigin="p"][f-family="' + r[i].fFamily + '"], style[f-origin="3"][f-family="' + r[i].fFamily + '"]')).length > 0 && (c = !1),
                                    c) {
                                        var p = createTag("style");
                                        p.setAttribute("f-forigin", r[i].fOrigin),
                                        p.setAttribute("f-origin", r[i].origin),
                                        p.setAttribute("f-family", r[i].fFamily),
                                        p.type = "text/css",
                                        p.innerText = "@font-face {font-family: " + r[i].fFamily + "; font-style: normal; src: url('" + r[i].fPath + "');}",
                                        t.appendChild(p)
                                    }
                                } else if ("g" === r[i].fOrigin || 1 === r[i].origin) {
                                    for (l = document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),
                                    h = 0; h < l.length; h += 1)
                                        -1 !== l[h].href.indexOf(r[i].fPath) && (c = !1);
                                    if (c) {
                                        var u = createTag("link");
                                        u.setAttribute("f-forigin", r[i].fOrigin),
                                        u.setAttribute("f-origin", r[i].origin),
                                        u.type = "text/css",
                                        u.rel = "stylesheet",
                                        u.href = r[i].fPath,
                                        document.body.appendChild(u)
                                    }
                                } else if ("t" === r[i].fOrigin || 2 === r[i].origin) {
                                    for (l = document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),
                                    h = 0; h < l.length; h += 1)
                                        r[i].fPath === l[h].src && (c = !1);
                                    if (c) {
                                        var d = createTag("link");
                                        d.setAttribute("f-forigin", r[i].fOrigin),
                                        d.setAttribute("f-origin", r[i].origin),
                                        d.setAttribute("rel", "stylesheet"),
                                        d.setAttribute("href", r[i].fPath),
                                        t.appendChild(d)
                                    }
                                }
                            } else
                                r[i].loaded = !0,
                                s -= 1;
                            r[i].helper = a(t, r[i]),
                            r[i].cache = {},
                            this.fonts.push(r[i])
                        }
                        0 === s ? this.isLoaded = !0 : setTimeout(this.checkLoadedFonts.bind(this), 100)
                    } else
                        this.isLoaded = !0
                },
                getCharData: function(t, i, r) {
                    for (var n = 0, a = this.chars.length; n < a; ) {
                        if (this.chars[n].ch === t && this.chars[n].style === i && this.chars[n].fFamily === r)
                            return this.chars[n];
                        n += 1
                    }
                    return ("string" == typeof t && 13 !== t.charCodeAt(0) || !t) && console && console.warn && !this._warned && (this._warned = !0,
                    console.warn("Missing character from exported characters list: ", t, i, r)),
                    e
                },
                getFontByName: function(e) {
                    for (var t = 0, i = this.fonts.length; t < i; ) {
                        if (this.fonts[t].fName === e)
                            return this.fonts[t];
                        t += 1
                    }
                    return this.fonts[0]
                },
                measureText: function(e, t, i) {
                    var r = this.getFontByName(t)
                      , n = e.charCodeAt(0);
                    if (!r.cache[n + 1]) {
                        var a = r.helper;
                        if (" " === e) {
                            a.textContent = "|" + e + "|";
                            var o = a.getComputedTextLength();
                            a.textContent = "||";
                            var s = a.getComputedTextLength();
                            r.cache[n + 1] = (o - s) / 100
                        } else
                            a.textContent = e,
                            r.cache[n + 1] = a.getComputedTextLength() / 100
                    }
                    return r.cache[n + 1] * i
                },
                checkLoadedFonts: function() {
                    var e, t, i, r = this.fonts.length, n = r;
                    for (e = 0; e < r; e += 1)
                        this.fonts[e].loaded ? n -= 1 : "n" === this.fonts[e].fOrigin || 0 === this.fonts[e].origin ? this.fonts[e].loaded = !0 : (t = this.fonts[e].monoCase.node,
                        i = this.fonts[e].monoCase.w,
                        t.offsetWidth !== i ? (n -= 1,
                        this.fonts[e].loaded = !0) : (t = this.fonts[e].sansCase.node,
                        i = this.fonts[e].sansCase.w,
                        t.offsetWidth !== i && (n -= 1,
                        this.fonts[e].loaded = !0)),
                        this.fonts[e].loaded && (this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),
                        this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));
                    0 !== n && Date.now() - this.initTime < 5e3 ? setTimeout(this.checkLoadedFontsBinded, 20) : setTimeout(this.setIsLoadedBinded, 10)
                },
                setIsLoaded: function() {
                    this.isLoaded = !0
                }
            },
            o
        }()
          , PropertyFactory = function() {
            var e = initialDefaultFrame
              , t = Math.abs;
            function i(e, t) {
                var i, n = this.offsetTime;
                "multidimensional" === this.propType && (i = createTypedArray("float32", this.pv.length));
                for (var a, o, s, l, h, c, p, u, d, f = t.lastIndex, m = f, g = this.keyframes.length - 1, v = !0; v; ) {
                    if (a = this.keyframes[m],
                    o = this.keyframes[m + 1],
                    m === g - 1 && e >= o.t - n) {
                        a.h && (a = o),
                        f = 0;
                        break
                    }
                    if (o.t - n > e) {
                        f = m;
                        break
                    }
                    m < g - 1 ? m += 1 : (f = 0,
                    v = !1)
                }
                s = this.keyframesMetadata[m] || {};
                var y, _, b, x, w, S, T, k, E, M, P, C, A, L, D, I, R, F, B, O, N, V, z, G, H, U, W, j = o.t - n, $ = a.t - n;
                if (a.to) {
                    s.bezierData || (s.bezierData = bez.buildBezierData(a.s, o.s || a.e, a.to, a.ti));
                    var q = s.bezierData;
                    if (e >= j || e < $) {
                        var X = e >= j ? q.points.length - 1 : 0;
                        for (h = q.points[X].point.length,
                        l = 0; l < h; l += 1)
                            i[l] = q.points[X].point[l]
                    } else {
                        s.__fnct ? d = s.__fnct : (d = BezierFactory.getBezierEasing(a.o.x, a.o.y, a.i.x, a.i.y, a.n).get,
                        s.__fnct = d),
                        c = d((e - $) / (j - $));
                        var Y, K = q.segmentLength * c, Z = t.lastFrame < e && t._lastKeyframeIndex === m ? t._lastAddedLength : 0;
                        for (u = t.lastFrame < e && t._lastKeyframeIndex === m ? t._lastPoint : 0,
                        v = !0,
                        p = q.points.length; v; ) {
                            if (Z += q.points[u].partialLength,
                            0 === K || 0 === c || u === q.points.length - 1) {
                                for (h = q.points[u].point.length,
                                l = 0; l < h; l += 1)
                                    i[l] = q.points[u].point[l];
                                break
                            }
                            if (K >= Z && K < Z + q.points[u + 1].partialLength) {
                                for (Y = (K - Z) / q.points[u + 1].partialLength,
                                h = q.points[u].point.length,
                                l = 0; l < h; l += 1)
                                    i[l] = q.points[u].point[l] + (q.points[u + 1].point[l] - q.points[u].point[l]) * Y;
                                break
                            }
                            u < p - 1 ? u += 1 : v = !1
                        }
                        t._lastPoint = u,
                        t._lastAddedLength = Z - q.points[u].partialLength,
                        t._lastKeyframeIndex = m
                    }
                } else {
                    var J, Q, ee, te, ie;
                    if (g = a.s.length,
                    y = o.s || a.e,
                    this.sh && 1 !== a.h)
                        if (e >= j)
                            i[0] = y[0],
                            i[1] = y[1],
                            i[2] = y[2];
                        else if (e <= $)
                            i[0] = a.s[0],
                            i[1] = a.s[1],
                            i[2] = a.s[2];
                        else {
                            var re = r(a.s);
                            _ = i,
                            C = r(y),
                            A = (e - $) / (j - $),
                            B = [],
                            O = (P = re)[0],
                            N = P[1],
                            V = P[2],
                            z = P[3],
                            (D = O * (G = C[0]) + N * (H = C[1]) + V * (U = C[2]) + z * (W = C[3])) < 0 && (D = -D,
                            G = -G,
                            H = -H,
                            U = -U,
                            W = -W),
                            1 - D > 1e-6 ? (L = Math.acos(D),
                            I = Math.sin(L),
                            R = Math.sin((1 - A) * L) / I,
                            F = Math.sin(A * L) / I) : (R = 1 - A,
                            F = A),
                            B[0] = R * O + F * G,
                            B[1] = R * N + F * H,
                            B[2] = R * V + F * U,
                            B[3] = R * z + F * W,
                            x = (b = B)[0],
                            w = b[1],
                            S = b[2],
                            T = b[3],
                            k = Math.atan2(2 * w * T - 2 * x * S, 1 - 2 * w * w - 2 * S * S),
                            E = Math.asin(2 * x * w + 2 * S * T),
                            M = Math.atan2(2 * x * T - 2 * w * S, 1 - 2 * x * x - 2 * S * S),
                            _[0] = k / degToRads,
                            _[1] = E / degToRads,
                            _[2] = M / degToRads
                        }
                    else
                        for (m = 0; m < g; m += 1)
                            1 !== a.h && (e >= j ? c = 1 : e < $ ? c = 0 : (a.o.x.constructor === Array ? (s.__fnct || (s.__fnct = []),
                            s.__fnct[m] ? d = s.__fnct[m] : (J = void 0 === a.o.x[m] ? a.o.x[0] : a.o.x[m],
                            Q = void 0 === a.o.y[m] ? a.o.y[0] : a.o.y[m],
                            ee = void 0 === a.i.x[m] ? a.i.x[0] : a.i.x[m],
                            te = void 0 === a.i.y[m] ? a.i.y[0] : a.i.y[m],
                            d = BezierFactory.getBezierEasing(J, Q, ee, te).get,
                            s.__fnct[m] = d)) : s.__fnct ? d = s.__fnct : (J = a.o.x,
                            Q = a.o.y,
                            ee = a.i.x,
                            te = a.i.y,
                            d = BezierFactory.getBezierEasing(J, Q, ee, te).get,
                            a.keyframeMetadata = d),
                            c = d((e - $) / (j - $)))),
                            y = o.s || a.e,
                            ie = 1 === a.h ? a.s[m] : a.s[m] + (y[m] - a.s[m]) * c,
                            "multidimensional" === this.propType ? i[m] = ie : i = ie
                }
                return t.lastIndex = f,
                i
            }
            function r(e) {
                var t = e[0] * degToRads
                  , i = e[1] * degToRads
                  , r = e[2] * degToRads
                  , n = Math.cos(t / 2)
                  , a = Math.cos(i / 2)
                  , o = Math.cos(r / 2)
                  , s = Math.sin(t / 2)
                  , l = Math.sin(i / 2)
                  , h = Math.sin(r / 2);
                return [s * l * o + n * a * h, s * a * o + n * l * h, n * l * o - s * a * h, n * a * o - s * l * h]
            }
            function n() {
                var t = this.comp.renderedFrame - this.offsetTime
                  , i = this.keyframes[0].t - this.offsetTime
                  , r = this.keyframes[this.keyframes.length - 1].t - this.offsetTime;
                if (!(t === this._caching.lastFrame || this._caching.lastFrame !== e && (this._caching.lastFrame >= r && t >= r || this._caching.lastFrame < i && t < i))) {
                    this._caching.lastFrame >= t && (this._caching._lastKeyframeIndex = -1,
                    this._caching.lastIndex = 0);
                    var n = this.interpolateValue(t, this._caching);
                    this.pv = n
                }
                return this._caching.lastFrame = t,
                this.pv
            }
            function a(e) {
                var i;
                if ("unidimensional" === this.propType)
                    i = e * this.mult,
                    t(this.v - i) > 1e-5 && (this.v = i,
                    this._mdf = !0);
                else
                    for (var r = 0, n = this.v.length; r < n; )
                        i = e[r] * this.mult,
                        t(this.v[r] - i) > 1e-5 && (this.v[r] = i,
                        this._mdf = !0),
                        r += 1
            }
            function o() {
                if (this.elem.globalData.frameId !== this.frameId && this.effectsSequence.length)
                    if (this.lock)
                        this.setVValue(this.pv);
                    else {
                        var e;
                        this.lock = !0,
                        this._mdf = this._isFirstFrame;
                        var t = this.effectsSequence.length
                          , i = this.kf ? this.pv : this.data.k;
                        for (e = 0; e < t; e += 1)
                            i = this.effectsSequence[e](i);
                        this.setVValue(i),
                        this._isFirstFrame = !1,
                        this.lock = !1,
                        this.frameId = this.elem.globalData.frameId
                    }
            }
            function s(e) {
                this.effectsSequence.push(e),
                this.container.addDynamicProperty(this)
            }
            function l(e, t, i, r) {
                this.propType = "unidimensional",
                this.mult = i || 1,
                this.data = t,
                this.v = i ? t.k * i : t.k,
                this.pv = t.k,
                this._mdf = !1,
                this.elem = e,
                this.container = r,
                this.comp = e.comp,
                this.k = !1,
                this.kf = !1,
                this.vel = 0,
                this.effectsSequence = [],
                this._isFirstFrame = !0,
                this.getValue = o,
                this.setVValue = a,
                this.addEffect = s
            }
            function h(e, t, i, r) {
                var n;
                this.propType = "multidimensional",
                this.mult = i || 1,
                this.data = t,
                this._mdf = !1,
                this.elem = e,
                this.container = r,
                this.comp = e.comp,
                this.k = !1,
                this.kf = !1,
                this.frameId = -1;
                var l = t.k.length;
                for (this.v = createTypedArray("float32", l),
                this.pv = createTypedArray("float32", l),
                this.vel = createTypedArray("float32", l),
                n = 0; n < l; n += 1)
                    this.v[n] = t.k[n] * this.mult,
                    this.pv[n] = t.k[n];
                this._isFirstFrame = !0,
                this.effectsSequence = [],
                this.getValue = o,
                this.setVValue = a,
                this.addEffect = s
            }
            function c(t, r, l, h) {
                this.propType = "unidimensional",
                this.keyframes = r.k,
                this.keyframesMetadata = [],
                this.offsetTime = t.data.st,
                this.frameId = -1,
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0,
                    value: 0,
                    _lastKeyframeIndex: -1
                },
                this.k = !0,
                this.kf = !0,
                this.data = r,
                this.mult = l || 1,
                this.elem = t,
                this.container = h,
                this.comp = t.comp,
                this.v = e,
                this.pv = e,
                this._isFirstFrame = !0,
                this.getValue = o,
                this.setVValue = a,
                this.interpolateValue = i,
                this.effectsSequence = [n.bind(this)],
                this.addEffect = s
            }
            function p(t, r, l, h) {
                var c;
                this.propType = "multidimensional";
                var p, u, d, f, m = r.k.length;
                for (c = 0; c < m - 1; c += 1)
                    r.k[c].to && r.k[c].s && r.k[c + 1] && r.k[c + 1].s && (p = r.k[c].s,
                    u = r.k[c + 1].s,
                    d = r.k[c].to,
                    f = r.k[c].ti,
                    (2 === p.length && (p[0] !== u[0] || p[1] !== u[1]) && bez.pointOnLine2D(p[0], p[1], u[0], u[1], p[0] + d[0], p[1] + d[1]) && bez.pointOnLine2D(p[0], p[1], u[0], u[1], u[0] + f[0], u[1] + f[1]) || 3 === p.length && (p[0] !== u[0] || p[1] !== u[1] || p[2] !== u[2]) && bez.pointOnLine3D(p[0], p[1], p[2], u[0], u[1], u[2], p[0] + d[0], p[1] + d[1], p[2] + d[2]) && bez.pointOnLine3D(p[0], p[1], p[2], u[0], u[1], u[2], u[0] + f[0], u[1] + f[1], u[2] + f[2])) && (r.k[c].to = null,
                    r.k[c].ti = null),
                    p[0] === u[0] && p[1] === u[1] && 0 === d[0] && 0 === d[1] && 0 === f[0] && 0 === f[1] && (2 === p.length || p[2] === u[2] && 0 === d[2] && 0 === f[2]) && (r.k[c].to = null,
                    r.k[c].ti = null));
                this.effectsSequence = [n.bind(this)],
                this.data = r,
                this.keyframes = r.k,
                this.keyframesMetadata = [],
                this.offsetTime = t.data.st,
                this.k = !0,
                this.kf = !0,
                this._isFirstFrame = !0,
                this.mult = l || 1,
                this.elem = t,
                this.container = h,
                this.comp = t.comp,
                this.getValue = o,
                this.setVValue = a,
                this.interpolateValue = i,
                this.frameId = -1;
                var g = r.k[0].s.length;
                for (this.v = createTypedArray("float32", g),
                this.pv = createTypedArray("float32", g),
                c = 0; c < g; c += 1)
                    this.v[c] = e,
                    this.pv[c] = e;
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0,
                    value: createTypedArray("float32", g)
                },
                this.addEffect = s
            }
            return {
                getProp: function(e, t, i, r, n) {
                    var a;
                    if (t.k.length)
                        if ("number" == typeof t.k[0])
                            a = new h(e,t,r,n);
                        else
                            switch (i) {
                            case 0:
                                a = new c(e,t,r,n);
                                break;
                            case 1:
                                a = new p(e,t,r,n)
                            }
                    else
                        a = new l(e,t,r,n);
                    return a.effectsSequence.length && n.addDynamicProperty(a),
                    a
                }
            }
        }()
          , TransformPropertyFactory = function() {
            var e = [0, 0];
            function t(e, t, i) {
                if (this.elem = e,
                this.frameId = -1,
                this.propType = "transform",
                this.data = t,
                this.v = new Matrix,
                this.pre = new Matrix,
                this.appliedTransformations = 0,
                this.initDynamicPropertyContainer(i || e),
                t.p && t.p.s ? (this.px = PropertyFactory.getProp(e, t.p.x, 0, 0, this),
                this.py = PropertyFactory.getProp(e, t.p.y, 0, 0, this),
                t.p.z && (this.pz = PropertyFactory.getProp(e, t.p.z, 0, 0, this))) : this.p = PropertyFactory.getProp(e, t.p || {
                    k: [0, 0, 0]
                }, 1, 0, this),
                t.rx) {
                    if (this.rx = PropertyFactory.getProp(e, t.rx, 0, degToRads, this),
                    this.ry = PropertyFactory.getProp(e, t.ry, 0, degToRads, this),
                    this.rz = PropertyFactory.getProp(e, t.rz, 0, degToRads, this),
                    t.or.k[0].ti) {
                        var r, n = t.or.k.length;
                        for (r = 0; r < n; r += 1)
                            t.or.k[r].to = null,
                            t.or.k[r].ti = null
                    }
                    this.or = PropertyFactory.getProp(e, t.or, 1, degToRads, this),
                    this.or.sh = !0
                } else
                    this.r = PropertyFactory.getProp(e, t.r || {
                        k: 0
                    }, 0, degToRads, this);
                t.sk && (this.sk = PropertyFactory.getProp(e, t.sk, 0, degToRads, this),
                this.sa = PropertyFactory.getProp(e, t.sa, 0, degToRads, this)),
                this.a = PropertyFactory.getProp(e, t.a || {
                    k: [0, 0, 0]
                }, 1, 0, this),
                this.s = PropertyFactory.getProp(e, t.s || {
                    k: [100, 100, 100]
                }, 1, .01, this),
                t.o ? this.o = PropertyFactory.getProp(e, t.o, 0, .01, e) : this.o = {
                    _mdf: !1,
                    v: 1
                },
                this._isDirty = !0,
                this.dynamicProperties.length || this.getValue(!0)
            }
            return t.prototype = {
                applyToMatrix: function(e) {
                    var t = this._mdf;
                    this.iterateDynamicProperties(),
                    this._mdf = this._mdf || t,
                    this.a && e.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                    this.s && e.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                    this.sk && e.skewFromAxis(-this.sk.v, this.sa.v),
                    this.r ? e.rotate(-this.r.v) : e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                    this.data.p.s ? this.data.p.z ? e.translate(this.px.v, this.py.v, -this.pz.v) : e.translate(this.px.v, this.py.v, 0) : e.translate(this.p.v[0], this.p.v[1], -this.p.v[2])
                },
                getValue: function(t) {
                    if (this.elem.globalData.frameId !== this.frameId) {
                        if (this._isDirty && (this.precalculateMatrix(),
                        this._isDirty = !1),
                        this.iterateDynamicProperties(),
                        this._mdf || t) {
                            var i;
                            if (this.v.cloneFromProps(this.pre.props),
                            this.appliedTransformations < 1 && this.v.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                            this.appliedTransformations < 2 && this.v.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                            this.sk && this.appliedTransformations < 3 && this.v.skewFromAxis(-this.sk.v, this.sa.v),
                            this.r && this.appliedTransformations < 4 ? this.v.rotate(-this.r.v) : !this.r && this.appliedTransformations < 4 && this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                            this.autoOriented) {
                                var r, n;
                                if (i = this.elem.globalData.frameRate,
                                this.p && this.p.keyframes && this.p.getValueAtTime)
                                    this.p._caching.lastFrame + this.p.offsetTime <= this.p.keyframes[0].t ? (r = this.p.getValueAtTime((this.p.keyframes[0].t + .01) / i, 0),
                                    n = this.p.getValueAtTime(this.p.keyframes[0].t / i, 0)) : this.p._caching.lastFrame + this.p.offsetTime >= this.p.keyframes[this.p.keyframes.length - 1].t ? (r = this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length - 1].t / i, 0),
                                    n = this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length - 1].t - .05) / i, 0)) : (r = this.p.pv,
                                    n = this.p.getValueAtTime((this.p._caching.lastFrame + this.p.offsetTime - .01) / i, this.p.offsetTime));
                                else if (this.px && this.px.keyframes && this.py.keyframes && this.px.getValueAtTime && this.py.getValueAtTime) {
                                    r = [],
                                    n = [];
                                    var a = this.px
                                      , o = this.py;
                                    a._caching.lastFrame + a.offsetTime <= a.keyframes[0].t ? (r[0] = a.getValueAtTime((a.keyframes[0].t + .01) / i, 0),
                                    r[1] = o.getValueAtTime((o.keyframes[0].t + .01) / i, 0),
                                    n[0] = a.getValueAtTime(a.keyframes[0].t / i, 0),
                                    n[1] = o.getValueAtTime(o.keyframes[0].t / i, 0)) : a._caching.lastFrame + a.offsetTime >= a.keyframes[a.keyframes.length - 1].t ? (r[0] = a.getValueAtTime(a.keyframes[a.keyframes.length - 1].t / i, 0),
                                    r[1] = o.getValueAtTime(o.keyframes[o.keyframes.length - 1].t / i, 0),
                                    n[0] = a.getValueAtTime((a.keyframes[a.keyframes.length - 1].t - .01) / i, 0),
                                    n[1] = o.getValueAtTime((o.keyframes[o.keyframes.length - 1].t - .01) / i, 0)) : (r = [a.pv, o.pv],
                                    n[0] = a.getValueAtTime((a._caching.lastFrame + a.offsetTime - .01) / i, a.offsetTime),
                                    n[1] = o.getValueAtTime((o._caching.lastFrame + o.offsetTime - .01) / i, o.offsetTime))
                                } else
                                    r = n = e;
                                this.v.rotate(-Math.atan2(r[1] - n[1], r[0] - n[0]))
                            }
                            this.data.p && this.data.p.s ? this.data.p.z ? this.v.translate(this.px.v, this.py.v, -this.pz.v) : this.v.translate(this.px.v, this.py.v, 0) : this.v.translate(this.p.v[0], this.p.v[1], -this.p.v[2])
                        }
                        this.frameId = this.elem.globalData.frameId
                    }
                },
                precalculateMatrix: function() {
                    if (!this.a.k && (this.pre.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                    this.appliedTransformations = 1,
                    !this.s.effectsSequence.length)) {
                        if (this.pre.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                        this.appliedTransformations = 2,
                        this.sk) {
                            if (this.sk.effectsSequence.length || this.sa.effectsSequence.length)
                                return;
                            this.pre.skewFromAxis(-this.sk.v, this.sa.v),
                            this.appliedTransformations = 3
                        }
                        this.r ? this.r.effectsSequence.length || (this.pre.rotate(-this.r.v),
                        this.appliedTransformations = 4) : this.rz.effectsSequence.length || this.ry.effectsSequence.length || this.rx.effectsSequence.length || this.or.effectsSequence.length || (this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                        this.appliedTransformations = 4)
                    }
                },
                autoOrient: function() {}
            },
            extendPrototype([DynamicPropertyContainer], t),
            t.prototype.addDynamicProperty = function(e) {
                this._addDynamicProperty(e),
                this.elem.addDynamicProperty(e),
                this._isDirty = !0
            }
            ,
            t.prototype._addDynamicProperty = DynamicPropertyContainer.prototype.addDynamicProperty,
            {
                getTransformProperty: function(e, i, r) {
                    return new t(e,i,r)
                }
            }
        }();
        function ShapePath() {
            this.c = !1,
            this._length = 0,
            this._maxLength = 8,
            this.v = createSizedArray(this._maxLength),
            this.o = createSizedArray(this._maxLength),
            this.i = createSizedArray(this._maxLength)
        }
        ShapePath.prototype.setPathData = function(e, t) {
            this.c = e,
            this.setLength(t);
            for (var i = 0; i < t; )
                this.v[i] = pointPool.newElement(),
                this.o[i] = pointPool.newElement(),
                this.i[i] = pointPool.newElement(),
                i += 1
        }
        ,
        ShapePath.prototype.setLength = function(e) {
            for (; this._maxLength < e; )
                this.doubleArrayLength();
            this._length = e
        }
        ,
        ShapePath.prototype.doubleArrayLength = function() {
            this.v = this.v.concat(createSizedArray(this._maxLength)),
            this.i = this.i.concat(createSizedArray(this._maxLength)),
            this.o = this.o.concat(createSizedArray(this._maxLength)),
            this._maxLength *= 2
        }
        ,
        ShapePath.prototype.setXYAt = function(e, t, i, r, n) {
            var a;
            switch (this._length = Math.max(this._length, r + 1),
            this._length >= this._maxLength && this.doubleArrayLength(),
            i) {
            case "v":
                a = this.v;
                break;
            case "i":
                a = this.i;
                break;
            case "o":
                a = this.o;
                break;
            default:
                a = []
            }
            (!a[r] || a[r] && !n) && (a[r] = pointPool.newElement()),
            a[r][0] = e,
            a[r][1] = t
        }
        ,
        ShapePath.prototype.setTripleAt = function(e, t, i, r, n, a, o, s) {
            this.setXYAt(e, t, "v", o, s),
            this.setXYAt(i, r, "o", o, s),
            this.setXYAt(n, a, "i", o, s)
        }
        ,
        ShapePath.prototype.reverse = function() {
            var e = new ShapePath;
            e.setPathData(this.c, this._length);
            var t = this.v
              , i = this.o
              , r = this.i
              , n = 0;
            this.c && (e.setTripleAt(t[0][0], t[0][1], r[0][0], r[0][1], i[0][0], i[0][1], 0, !1),
            n = 1);
            var a, o = this._length - 1, s = this._length;
            for (a = n; a < s; a += 1)
                e.setTripleAt(t[o][0], t[o][1], r[o][0], r[o][1], i[o][0], i[o][1], a, !1),
                o -= 1;
            return e
        }
        ;
        var ShapePropertyFactory = function() {
            var e = -999999;
            function t(e, t, i) {
                var r, n, a, o, s, l, h, c, p, u = i.lastIndex, d = this.keyframes;
                if (e < d[0].t - this.offsetTime)
                    r = d[0].s[0],
                    a = !0,
                    u = 0;
                else if (e >= d[d.length - 1].t - this.offsetTime)
                    r = d[d.length - 1].s ? d[d.length - 1].s[0] : d[d.length - 2].e[0],
                    a = !0;
                else {
                    for (var f, m, g, v = u, y = d.length - 1, _ = !0; _ && (f = d[v],
                    !((m = d[v + 1]).t - this.offsetTime > e)); )
                        v < y - 1 ? v += 1 : _ = !1;
                    if (g = this.keyframesMetadata[v] || {},
                    u = v,
                    !(a = 1 === f.h)) {
                        if (e >= m.t - this.offsetTime)
                            c = 1;
                        else if (e < f.t - this.offsetTime)
                            c = 0;
                        else {
                            var b;
                            g.__fnct ? b = g.__fnct : (b = BezierFactory.getBezierEasing(f.o.x, f.o.y, f.i.x, f.i.y).get,
                            g.__fnct = b),
                            c = b((e - (f.t - this.offsetTime)) / (m.t - this.offsetTime - (f.t - this.offsetTime)))
                        }
                        n = m.s ? m.s[0] : f.e[0]
                    }
                    r = f.s[0]
                }
                for (l = t._length,
                h = r.i[0].length,
                i.lastIndex = u,
                o = 0; o < l; o += 1)
                    for (s = 0; s < h; s += 1)
                        p = a ? r.i[o][s] : r.i[o][s] + (n.i[o][s] - r.i[o][s]) * c,
                        t.i[o][s] = p,
                        p = a ? r.o[o][s] : r.o[o][s] + (n.o[o][s] - r.o[o][s]) * c,
                        t.o[o][s] = p,
                        p = a ? r.v[o][s] : r.v[o][s] + (n.v[o][s] - r.v[o][s]) * c,
                        t.v[o][s] = p
            }
            function i() {
                var t = this.comp.renderedFrame - this.offsetTime
                  , i = this.keyframes[0].t - this.offsetTime
                  , r = this.keyframes[this.keyframes.length - 1].t - this.offsetTime
                  , n = this._caching.lastFrame;
                return n !== e && (n < i && t < i || n > r && t > r) || (this._caching.lastIndex = n < t ? this._caching.lastIndex : 0,
                this.interpolateShape(t, this.pv, this._caching)),
                this._caching.lastFrame = t,
                this.pv
            }
            function r() {
                this.paths = this.localShapeCollection
            }
            function n(e) {
                (function(e, t) {
                    if (e._length !== t._length || e.c !== t.c)
                        return !1;
                    var i, r = e._length;
                    for (i = 0; i < r; i += 1)
                        if (e.v[i][0] !== t.v[i][0] || e.v[i][1] !== t.v[i][1] || e.o[i][0] !== t.o[i][0] || e.o[i][1] !== t.o[i][1] || e.i[i][0] !== t.i[i][0] || e.i[i][1] !== t.i[i][1])
                            return !1;
                    return !0
                }
                )(this.v, e) || (this.v = shapePool.clone(e),
                this.localShapeCollection.releaseShapes(),
                this.localShapeCollection.addShape(this.v),
                this._mdf = !0,
                this.paths = this.localShapeCollection)
            }
            function a() {
                if (this.elem.globalData.frameId !== this.frameId)
                    if (this.effectsSequence.length)
                        if (this.lock)
                            this.setVValue(this.pv);
                        else {
                            var e, t;
                            this.lock = !0,
                            this._mdf = !1,
                            e = this.kf ? this.pv : this.data.ks ? this.data.ks.k : this.data.pt.k;
                            var i = this.effectsSequence.length;
                            for (t = 0; t < i; t += 1)
                                e = this.effectsSequence[t](e);
                            this.setVValue(e),
                            this.lock = !1,
                            this.frameId = this.elem.globalData.frameId
                        }
                    else
                        this._mdf = !1
            }
            function o(e, t, i) {
                this.propType = "shape",
                this.comp = e.comp,
                this.container = e,
                this.elem = e,
                this.data = t,
                this.k = !1,
                this.kf = !1,
                this._mdf = !1;
                var n = 3 === i ? t.pt.k : t.ks.k;
                this.v = shapePool.clone(n),
                this.pv = shapePool.clone(this.v),
                this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                this.paths = this.localShapeCollection,
                this.paths.addShape(this.v),
                this.reset = r,
                this.effectsSequence = []
            }
            function s(e) {
                this.effectsSequence.push(e),
                this.container.addDynamicProperty(this)
            }
            function l(t, n, a) {
                this.propType = "shape",
                this.comp = t.comp,
                this.elem = t,
                this.container = t,
                this.offsetTime = t.data.st,
                this.keyframes = 3 === a ? n.pt.k : n.ks.k,
                this.keyframesMetadata = [],
                this.k = !0,
                this.kf = !0;
                var o = this.keyframes[0].s[0].i.length;
                this.v = shapePool.newElement(),
                this.v.setPathData(this.keyframes[0].s[0].c, o),
                this.pv = shapePool.clone(this.v),
                this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                this.paths = this.localShapeCollection,
                this.paths.addShape(this.v),
                this.lastFrame = e,
                this.reset = r,
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0
                },
                this.effectsSequence = [i.bind(this)]
            }
            o.prototype.interpolateShape = t,
            o.prototype.getValue = a,
            o.prototype.setVValue = n,
            o.prototype.addEffect = s,
            l.prototype.getValue = a,
            l.prototype.interpolateShape = t,
            l.prototype.setVValue = n,
            l.prototype.addEffect = s;
            var h = function() {
                var e = roundCorner;
                function t(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.setPathData(!0, 4),
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.paths = this.localShapeCollection,
                    this.localShapeCollection.addShape(this.v),
                    this.d = t.d,
                    this.elem = e,
                    this.comp = e.comp,
                    this.frameId = -1,
                    this.initDynamicPropertyContainer(e),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.s = PropertyFactory.getProp(e, t.s, 1, 0, this),
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertEllToPath())
                }
                return t.prototype = {
                    reset: r,
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertEllToPath())
                    },
                    convertEllToPath: function() {
                        var t = this.p.v[0]
                          , i = this.p.v[1]
                          , r = this.s.v[0] / 2
                          , n = this.s.v[1] / 2
                          , a = 3 !== this.d
                          , o = this.v;
                        o.v[0][0] = t,
                        o.v[0][1] = i - n,
                        o.v[1][0] = a ? t + r : t - r,
                        o.v[1][1] = i,
                        o.v[2][0] = t,
                        o.v[2][1] = i + n,
                        o.v[3][0] = a ? t - r : t + r,
                        o.v[3][1] = i,
                        o.i[0][0] = a ? t - r * e : t + r * e,
                        o.i[0][1] = i - n,
                        o.i[1][0] = a ? t + r : t - r,
                        o.i[1][1] = i - n * e,
                        o.i[2][0] = a ? t + r * e : t - r * e,
                        o.i[2][1] = i + n,
                        o.i[3][0] = a ? t - r : t + r,
                        o.i[3][1] = i + n * e,
                        o.o[0][0] = a ? t + r * e : t - r * e,
                        o.o[0][1] = i - n,
                        o.o[1][0] = a ? t + r : t - r,
                        o.o[1][1] = i + n * e,
                        o.o[2][0] = a ? t - r * e : t + r * e,
                        o.o[2][1] = i + n,
                        o.o[3][0] = a ? t - r : t + r,
                        o.o[3][1] = i - n * e
                    }
                },
                extendPrototype([DynamicPropertyContainer], t),
                t
            }()
              , c = function() {
                function e(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.setPathData(!0, 0),
                    this.elem = e,
                    this.comp = e.comp,
                    this.data = t,
                    this.frameId = -1,
                    this.d = t.d,
                    this.initDynamicPropertyContainer(e),
                    1 === t.sy ? (this.ir = PropertyFactory.getProp(e, t.ir, 0, 0, this),
                    this.is = PropertyFactory.getProp(e, t.is, 0, .01, this),
                    this.convertToPath = this.convertStarToPath) : this.convertToPath = this.convertPolygonToPath,
                    this.pt = PropertyFactory.getProp(e, t.pt, 0, 0, this),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.r = PropertyFactory.getProp(e, t.r, 0, degToRads, this),
                    this.or = PropertyFactory.getProp(e, t.or, 0, 0, this),
                    this.os = PropertyFactory.getProp(e, t.os, 0, .01, this),
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.localShapeCollection.addShape(this.v),
                    this.paths = this.localShapeCollection,
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertToPath())
                }
                return e.prototype = {
                    reset: r,
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertToPath())
                    },
                    convertStarToPath: function() {
                        var e, t, i, r, n = 2 * Math.floor(this.pt.v), a = 2 * Math.PI / n, o = !0, s = this.or.v, l = this.ir.v, h = this.os.v, c = this.is.v, p = 2 * Math.PI * s / (2 * n), u = 2 * Math.PI * l / (2 * n), d = -Math.PI / 2;
                        d += this.r.v;
                        var f = 3 === this.data.d ? -1 : 1;
                        for (this.v._length = 0,
                        e = 0; e < n; e += 1) {
                            i = o ? h : c,
                            r = o ? p : u;
                            var m = (t = o ? s : l) * Math.cos(d)
                              , g = t * Math.sin(d)
                              , v = 0 === m && 0 === g ? 0 : g / Math.sqrt(m * m + g * g)
                              , y = 0 === m && 0 === g ? 0 : -m / Math.sqrt(m * m + g * g);
                            m += +this.p.v[0],
                            g += +this.p.v[1],
                            this.v.setTripleAt(m, g, m - v * r * i * f, g - y * r * i * f, m + v * r * i * f, g + y * r * i * f, e, !0),
                            o = !o,
                            d += a * f
                        }
                    },
                    convertPolygonToPath: function() {
                        var e, t = Math.floor(this.pt.v), i = 2 * Math.PI / t, r = this.or.v, n = this.os.v, a = 2 * Math.PI * r / (4 * t), o = .5 * -Math.PI, s = 3 === this.data.d ? -1 : 1;
                        for (o += this.r.v,
                        this.v._length = 0,
                        e = 0; e < t; e += 1) {
                            var l = r * Math.cos(o)
                              , h = r * Math.sin(o)
                              , c = 0 === l && 0 === h ? 0 : h / Math.sqrt(l * l + h * h)
                              , p = 0 === l && 0 === h ? 0 : -l / Math.sqrt(l * l + h * h);
                            l += +this.p.v[0],
                            h += +this.p.v[1],
                            this.v.setTripleAt(l, h, l - c * a * n * s, h - p * a * n * s, l + c * a * n * s, h + p * a * n * s, e, !0),
                            o += i * s
                        }
                        this.paths.length = 0,
                        this.paths[0] = this.v
                    }
                },
                extendPrototype([DynamicPropertyContainer], e),
                e
            }()
              , p = function() {
                function e(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.c = !0,
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.localShapeCollection.addShape(this.v),
                    this.paths = this.localShapeCollection,
                    this.elem = e,
                    this.comp = e.comp,
                    this.frameId = -1,
                    this.d = t.d,
                    this.initDynamicPropertyContainer(e),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.s = PropertyFactory.getProp(e, t.s, 1, 0, this),
                    this.r = PropertyFactory.getProp(e, t.r, 0, 0, this),
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertRectToPath())
                }
                return e.prototype = {
                    convertRectToPath: function() {
                        var e = this.p.v[0]
                          , t = this.p.v[1]
                          , i = this.s.v[0] / 2
                          , r = this.s.v[1] / 2
                          , n = bmMin(i, r, this.r.v)
                          , a = n * (1 - roundCorner);
                        this.v._length = 0,
                        2 === this.d || 1 === this.d ? (this.v.setTripleAt(e + i, t - r + n, e + i, t - r + n, e + i, t - r + a, 0, !0),
                        this.v.setTripleAt(e + i, t + r - n, e + i, t + r - a, e + i, t + r - n, 1, !0),
                        0 !== n ? (this.v.setTripleAt(e + i - n, t + r, e + i - n, t + r, e + i - a, t + r, 2, !0),
                        this.v.setTripleAt(e - i + n, t + r, e - i + a, t + r, e - i + n, t + r, 3, !0),
                        this.v.setTripleAt(e - i, t + r - n, e - i, t + r - n, e - i, t + r - a, 4, !0),
                        this.v.setTripleAt(e - i, t - r + n, e - i, t - r + a, e - i, t - r + n, 5, !0),
                        this.v.setTripleAt(e - i + n, t - r, e - i + n, t - r, e - i + a, t - r, 6, !0),
                        this.v.setTripleAt(e + i - n, t - r, e + i - a, t - r, e + i - n, t - r, 7, !0)) : (this.v.setTripleAt(e - i, t + r, e - i + a, t + r, e - i, t + r, 2),
                        this.v.setTripleAt(e - i, t - r, e - i, t - r + a, e - i, t - r, 3))) : (this.v.setTripleAt(e + i, t - r + n, e + i, t - r + a, e + i, t - r + n, 0, !0),
                        0 !== n ? (this.v.setTripleAt(e + i - n, t - r, e + i - n, t - r, e + i - a, t - r, 1, !0),
                        this.v.setTripleAt(e - i + n, t - r, e - i + a, t - r, e - i + n, t - r, 2, !0),
                        this.v.setTripleAt(e - i, t - r + n, e - i, t - r + n, e - i, t - r + a, 3, !0),
                        this.v.setTripleAt(e - i, t + r - n, e - i, t + r - a, e - i, t + r - n, 4, !0),
                        this.v.setTripleAt(e - i + n, t + r, e - i + n, t + r, e - i + a, t + r, 5, !0),
                        this.v.setTripleAt(e + i - n, t + r, e + i - a, t + r, e + i - n, t + r, 6, !0),
                        this.v.setTripleAt(e + i, t + r - n, e + i, t + r - n, e + i, t + r - a, 7, !0)) : (this.v.setTripleAt(e - i, t - r, e - i + a, t - r, e - i, t - r, 1, !0),
                        this.v.setTripleAt(e - i, t + r, e - i, t + r - a, e - i, t + r, 2, !0),
                        this.v.setTripleAt(e + i, t + r, e + i - a, t + r, e + i, t + r, 3, !0)))
                    },
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertRectToPath())
                    },
                    reset: r
                },
                extendPrototype([DynamicPropertyContainer], e),
                e
            }();
            return {
                getShapeProp: function(e, t, i) {
                    var r;
                    return 3 === i || 4 === i ? r = (3 === i ? t.pt : t.ks).k.length ? new l(e,t,i) : new o(e,t,i) : 5 === i ? r = new p(e,t) : 6 === i ? r = new h(e,t) : 7 === i && (r = new c(e,t)),
                    r.k && e.addDynamicProperty(r),
                    r
                },
                getConstructorFunction: function() {
                    return o
                },
                getKeyframedConstructorFunction: function() {
                    return l
                }
            }
        }(), ShapeModifiers = (ob = {},
        modifiers = {},
        ob.registerModifier = function(e, t) {
            modifiers[e] || (modifiers[e] = t)
        }
        ,
        ob.getModifier = function(e, t, i) {
            return new modifiers[e](t,i)
        }
        ,
        ob), ob, modifiers;
        function ShapeModifier() {}
        function TrimModifier() {}
        function RoundCornersModifier() {}
        function PuckerAndBloatModifier() {}
        function RepeaterModifier() {}
        function ShapeCollection() {
            this._length = 0,
            this._maxLength = 4,
            this.shapes = createSizedArray(this._maxLength)
        }
        function DashProperty(e, t, i, r) {
            var n;
            this.elem = e,
            this.frameId = -1,
            this.dataProps = createSizedArray(t.length),
            this.renderer = i,
            this.k = !1,
            this.dashStr = "",
            this.dashArray = createTypedArray("float32", t.length ? t.length - 1 : 0),
            this.dashoffset = createTypedArray("float32", 1),
            this.initDynamicPropertyContainer(r);
            var a, o = t.length || 0;
            for (n = 0; n < o; n += 1)
                a = PropertyFactory.getProp(e, t[n].v, 0, 0, this),
                this.k = a.k || this.k,
                this.dataProps[n] = {
                    n: t[n].n,
                    p: a
                };
            this.k || this.getValue(!0),
            this._isAnimated = this.k
        }
        function GradientProperty(e, t, i) {
            this.data = t,
            this.c = createTypedArray("uint8c", 4 * t.p);
            var r = t.k.k[0].s ? t.k.k[0].s.length - 4 * t.p : t.k.k.length - 4 * t.p;
            this.o = createTypedArray("float32", r),
            this._cmdf = !1,
            this._omdf = !1,
            this._collapsable = this.checkCollapsable(),
            this._hasOpacity = r,
            this.initDynamicPropertyContainer(i),
            this.prop = PropertyFactory.getProp(e, t.k, 1, null, this),
            this.k = this.prop.k,
            this.getValue(!0)
        }
        ShapeModifier.prototype.initModifierProperties = function() {}
        ,
        ShapeModifier.prototype.addShapeToModifier = function() {}
        ,
        ShapeModifier.prototype.addShape = function(e) {
            if (!this.closed) {
                e.sh.container.addDynamicProperty(e.sh);
                var t = {
                    shape: e.sh,
                    data: e,
                    localShapeCollection: shapeCollectionPool.newShapeCollection()
                };
                this.shapes.push(t),
                this.addShapeToModifier(t),
                this._isAnimated && e.setAsAnimated()
            }
        }
        ,
        ShapeModifier.prototype.init = function(e, t) {
            this.shapes = [],
            this.elem = e,
            this.initDynamicPropertyContainer(e),
            this.initModifierProperties(e, t),
            this.frameId = initialDefaultFrame,
            this.closed = !1,
            this.k = !1,
            this.dynamicProperties.length ? this.k = !0 : this.getValue(!0)
        }
        ,
        ShapeModifier.prototype.processKeys = function() {
            this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
            this.iterateDynamicProperties())
        }
        ,
        extendPrototype([DynamicPropertyContainer], ShapeModifier),
        extendPrototype([ShapeModifier], TrimModifier),
        TrimModifier.prototype.initModifierProperties = function(e, t) {
            this.s = PropertyFactory.getProp(e, t.s, 0, .01, this),
            this.e = PropertyFactory.getProp(e, t.e, 0, .01, this),
            this.o = PropertyFactory.getProp(e, t.o, 0, 0, this),
            this.sValue = 0,
            this.eValue = 0,
            this.getValue = this.processKeys,
            this.m = t.m,
            this._isAnimated = !!this.s.effectsSequence.length || !!this.e.effectsSequence.length || !!this.o.effectsSequence.length
        }
        ,
        TrimModifier.prototype.addShapeToModifier = function(e) {
            e.pathsData = []
        }
        ,
        TrimModifier.prototype.calculateShapeEdges = function(e, t, i, r, n) {
            var a = [];
            t <= 1 ? a.push({
                s: e,
                e: t
            }) : e >= 1 ? a.push({
                s: e - 1,
                e: t - 1
            }) : (a.push({
                s: e,
                e: 1
            }),
            a.push({
                s: 0,
                e: t - 1
            }));
            var o, s, l = [], h = a.length;
            for (o = 0; o < h; o += 1) {
                var c, p;
                (s = a[o]).e * n < r || s.s * n > r + i || (c = s.s * n <= r ? 0 : (s.s * n - r) / i,
                p = s.e * n >= r + i ? 1 : (s.e * n - r) / i,
                l.push([c, p]))
            }
            return l.length || l.push([0, 0]),
            l
        }
        ,
        TrimModifier.prototype.releasePathsData = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                segmentsLengthPool.release(e[t]);
            return e.length = 0,
            e
        }
        ,
        TrimModifier.prototype.processShapes = function(e) {
            var t, i, r, n;
            if (this._mdf || e) {
                var a = this.o.v % 360 / 360;
                if (a < 0 && (a += 1),
                (t = this.s.v > 1 ? 1 + a : this.s.v < 0 ? 0 + a : this.s.v + a) > (i = this.e.v > 1 ? 1 + a : this.e.v < 0 ? 0 + a : this.e.v + a)) {
                    var o = t;
                    t = i,
                    i = o
                }
                t = 1e-4 * Math.round(1e4 * t),
                i = 1e-4 * Math.round(1e4 * i),
                this.sValue = t,
                this.eValue = i
            } else
                t = this.sValue,
                i = this.eValue;
            var s, l, h, c, p, u = this.shapes.length, d = 0;
            if (i === t)
                for (n = 0; n < u; n += 1)
                    this.shapes[n].localShapeCollection.releaseShapes(),
                    this.shapes[n].shape._mdf = !0,
                    this.shapes[n].shape.paths = this.shapes[n].localShapeCollection,
                    this._mdf && (this.shapes[n].pathsData.length = 0);
            else if (1 === i && 0 === t || 0 === i && 1 === t) {
                if (this._mdf)
                    for (n = 0; n < u; n += 1)
                        this.shapes[n].pathsData.length = 0,
                        this.shapes[n].shape._mdf = !0
            } else {
                var f, m, g = [];
                for (n = 0; n < u; n += 1)
                    if ((f = this.shapes[n]).shape._mdf || this._mdf || e || 2 === this.m) {
                        if (l = (r = f.shape.paths)._length,
                        p = 0,
                        !f.shape._mdf && f.pathsData.length)
                            p = f.totalShapeLength;
                        else {
                            for (h = this.releasePathsData(f.pathsData),
                            s = 0; s < l; s += 1)
                                c = bez.getSegmentsLength(r.shapes[s]),
                                h.push(c),
                                p += c.totalLength;
                            f.totalShapeLength = p,
                            f.pathsData = h
                        }
                        d += p,
                        f.shape._mdf = !0
                    } else
                        f.shape.paths = f.localShapeCollection;
                var v, y = t, _ = i, b = 0;
                for (n = u - 1; n >= 0; n -= 1)
                    if ((f = this.shapes[n]).shape._mdf) {
                        for ((m = f.localShapeCollection).releaseShapes(),
                        2 === this.m && u > 1 ? (v = this.calculateShapeEdges(t, i, f.totalShapeLength, b, d),
                        b += f.totalShapeLength) : v = [[y, _]],
                        l = v.length,
                        s = 0; s < l; s += 1) {
                            y = v[s][0],
                            _ = v[s][1],
                            g.length = 0,
                            _ <= 1 ? g.push({
                                s: f.totalShapeLength * y,
                                e: f.totalShapeLength * _
                            }) : y >= 1 ? g.push({
                                s: f.totalShapeLength * (y - 1),
                                e: f.totalShapeLength * (_ - 1)
                            }) : (g.push({
                                s: f.totalShapeLength * y,
                                e: f.totalShapeLength
                            }),
                            g.push({
                                s: 0,
                                e: f.totalShapeLength * (_ - 1)
                            }));
                            var x = this.addShapes(f, g[0]);
                            if (g[0].s !== g[0].e) {
                                if (g.length > 1)
                                    if (f.shape.paths.shapes[f.shape.paths._length - 1].c) {
                                        var w = x.pop();
                                        this.addPaths(x, m),
                                        x = this.addShapes(f, g[1], w)
                                    } else
                                        this.addPaths(x, m),
                                        x = this.addShapes(f, g[1]);
                                this.addPaths(x, m)
                            }
                        }
                        f.shape.paths = m
                    }
            }
        }
        ,
        TrimModifier.prototype.addPaths = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                t.addShape(e[i])
        }
        ,
        TrimModifier.prototype.addSegment = function(e, t, i, r, n, a, o) {
            n.setXYAt(t[0], t[1], "o", a),
            n.setXYAt(i[0], i[1], "i", a + 1),
            o && n.setXYAt(e[0], e[1], "v", a),
            n.setXYAt(r[0], r[1], "v", a + 1)
        }
        ,
        TrimModifier.prototype.addSegmentFromArray = function(e, t, i, r) {
            t.setXYAt(e[1], e[5], "o", i),
            t.setXYAt(e[2], e[6], "i", i + 1),
            r && t.setXYAt(e[0], e[4], "v", i),
            t.setXYAt(e[3], e[7], "v", i + 1)
        }
        ,
        TrimModifier.prototype.addShapes = function(e, t, i) {
            var r, n, a, o, s, l, h, c, p = e.pathsData, u = e.shape.paths.shapes, d = e.shape.paths._length, f = 0, m = [], g = !0;
            for (i ? (s = i._length,
            c = i._length) : (i = shapePool.newElement(),
            s = 0,
            c = 0),
            m.push(i),
            r = 0; r < d; r += 1) {
                for (l = p[r].lengths,
                i.c = u[r].c,
                a = u[r].c ? l.length : l.length + 1,
                n = 1; n < a; n += 1)
                    if (f + (o = l[n - 1]).addedLength < t.s)
                        f += o.addedLength,
                        i.c = !1;
                    else {
                        if (f > t.e) {
                            i.c = !1;
                            break
                        }
                        t.s <= f && t.e >= f + o.addedLength ? (this.addSegment(u[r].v[n - 1], u[r].o[n - 1], u[r].i[n], u[r].v[n], i, s, g),
                        g = !1) : (h = bez.getNewSegment(u[r].v[n - 1], u[r].v[n], u[r].o[n - 1], u[r].i[n], (t.s - f) / o.addedLength, (t.e - f) / o.addedLength, l[n - 1]),
                        this.addSegmentFromArray(h, i, s, g),
                        g = !1,
                        i.c = !1),
                        f += o.addedLength,
                        s += 1
                    }
                if (u[r].c && l.length) {
                    if (o = l[n - 1],
                    f <= t.e) {
                        var v = l[n - 1].addedLength;
                        t.s <= f && t.e >= f + v ? (this.addSegment(u[r].v[n - 1], u[r].o[n - 1], u[r].i[0], u[r].v[0], i, s, g),
                        g = !1) : (h = bez.getNewSegment(u[r].v[n - 1], u[r].v[0], u[r].o[n - 1], u[r].i[0], (t.s - f) / v, (t.e - f) / v, l[n - 1]),
                        this.addSegmentFromArray(h, i, s, g),
                        g = !1,
                        i.c = !1)
                    } else
                        i.c = !1;
                    f += o.addedLength,
                    s += 1
                }
                if (i._length && (i.setXYAt(i.v[c][0], i.v[c][1], "i", c),
                i.setXYAt(i.v[i._length - 1][0], i.v[i._length - 1][1], "o", i._length - 1)),
                f > t.e)
                    break;
                r < d - 1 && (i = shapePool.newElement(),
                g = !0,
                m.push(i),
                s = 0)
            }
            return m
        }
        ,
        ShapeModifiers.registerModifier("tm", TrimModifier),
        extendPrototype([ShapeModifier], RoundCornersModifier),
        RoundCornersModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.rd = PropertyFactory.getProp(e, t.r, 0, null, this),
            this._isAnimated = !!this.rd.effectsSequence.length
        }
        ,
        RoundCornersModifier.prototype.processPath = function(e, t) {
            var i, r = shapePool.newElement();
            r.c = e.c;
            var n, a, o, s, l, h, c, p, u, d, f, m, g = e._length, v = 0;
            for (i = 0; i < g; i += 1)
                n = e.v[i],
                o = e.o[i],
                a = e.i[i],
                n[0] === o[0] && n[1] === o[1] && n[0] === a[0] && n[1] === a[1] ? 0 !== i && i !== g - 1 || e.c ? (s = 0 === i ? e.v[g - 1] : e.v[i - 1],
                h = (l = Math.sqrt(Math.pow(n[0] - s[0], 2) + Math.pow(n[1] - s[1], 2))) ? Math.min(l / 2, t) / l : 0,
                c = f = n[0] + (s[0] - n[0]) * h,
                p = m = n[1] - (n[1] - s[1]) * h,
                u = c - (c - n[0]) * roundCorner,
                d = p - (p - n[1]) * roundCorner,
                r.setTripleAt(c, p, u, d, f, m, v),
                v += 1,
                s = i === g - 1 ? e.v[0] : e.v[i + 1],
                h = (l = Math.sqrt(Math.pow(n[0] - s[0], 2) + Math.pow(n[1] - s[1], 2))) ? Math.min(l / 2, t) / l : 0,
                c = u = n[0] + (s[0] - n[0]) * h,
                p = d = n[1] + (s[1] - n[1]) * h,
                f = c - (c - n[0]) * roundCorner,
                m = p - (p - n[1]) * roundCorner,
                r.setTripleAt(c, p, u, d, f, m, v),
                v += 1) : (r.setTripleAt(n[0], n[1], o[0], o[1], a[0], a[1], v),
                v += 1) : (r.setTripleAt(e.v[i][0], e.v[i][1], e.o[i][0], e.o[i][1], e.i[i][0], e.i[i][1], v),
                v += 1);
            return r
        }
        ,
        RoundCornersModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o, s = this.shapes.length, l = this.rd.v;
            if (0 !== l)
                for (i = 0; i < s; i += 1) {
                    if (o = (a = this.shapes[i]).localShapeCollection,
                    a.shape._mdf || this._mdf || e)
                        for (o.releaseShapes(),
                        a.shape._mdf = !0,
                        t = a.shape.paths.shapes,
                        n = a.shape.paths._length,
                        r = 0; r < n; r += 1)
                            o.addShape(this.processPath(t[r], l));
                    a.shape.paths = a.localShapeCollection
                }
            this.dynamicProperties.length || (this._mdf = !1)
        }
        ,
        ShapeModifiers.registerModifier("rd", RoundCornersModifier),
        extendPrototype([ShapeModifier], PuckerAndBloatModifier),
        PuckerAndBloatModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.amount = PropertyFactory.getProp(e, t.a, 0, null, this),
            this._isAnimated = !!this.amount.effectsSequence.length
        }
        ,
        PuckerAndBloatModifier.prototype.processPath = function(e, t) {
            var i = t / 100
              , r = [0, 0]
              , n = e._length
              , a = 0;
            for (a = 0; a < n; a += 1)
                r[0] += e.v[a][0],
                r[1] += e.v[a][1];
            r[0] /= n,
            r[1] /= n;
            var o, s, l, h, c, p, u = shapePool.newElement();
            for (u.c = e.c,
            a = 0; a < n; a += 1)
                o = e.v[a][0] + (r[0] - e.v[a][0]) * i,
                s = e.v[a][1] + (r[1] - e.v[a][1]) * i,
                l = e.o[a][0] + (r[0] - e.o[a][0]) * -i,
                h = e.o[a][1] + (r[1] - e.o[a][1]) * -i,
                c = e.i[a][0] + (r[0] - e.i[a][0]) * -i,
                p = e.i[a][1] + (r[1] - e.i[a][1]) * -i,
                u.setTripleAt(o, s, l, h, c, p, a);
            return u
        }
        ,
        PuckerAndBloatModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o, s = this.shapes.length, l = this.amount.v;
            if (0 !== l)
                for (i = 0; i < s; i += 1) {
                    if (o = (a = this.shapes[i]).localShapeCollection,
                    a.shape._mdf || this._mdf || e)
                        for (o.releaseShapes(),
                        a.shape._mdf = !0,
                        t = a.shape.paths.shapes,
                        n = a.shape.paths._length,
                        r = 0; r < n; r += 1)
                            o.addShape(this.processPath(t[r], l));
                    a.shape.paths = a.localShapeCollection
                }
            this.dynamicProperties.length || (this._mdf = !1)
        }
        ,
        ShapeModifiers.registerModifier("pb", PuckerAndBloatModifier),
        extendPrototype([ShapeModifier], RepeaterModifier),
        RepeaterModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.c = PropertyFactory.getProp(e, t.c, 0, null, this),
            this.o = PropertyFactory.getProp(e, t.o, 0, null, this),
            this.tr = TransformPropertyFactory.getTransformProperty(e, t.tr, this),
            this.so = PropertyFactory.getProp(e, t.tr.so, 0, .01, this),
            this.eo = PropertyFactory.getProp(e, t.tr.eo, 0, .01, this),
            this.data = t,
            this.dynamicProperties.length || this.getValue(!0),
            this._isAnimated = !!this.dynamicProperties.length,
            this.pMatrix = new Matrix,
            this.rMatrix = new Matrix,
            this.sMatrix = new Matrix,
            this.tMatrix = new Matrix,
            this.matrix = new Matrix
        }
        ,
        RepeaterModifier.prototype.applyTransforms = function(e, t, i, r, n, a) {
            var o = a ? -1 : 1
              , s = r.s.v[0] + (1 - r.s.v[0]) * (1 - n)
              , l = r.s.v[1] + (1 - r.s.v[1]) * (1 - n);
            e.translate(r.p.v[0] * o * n, r.p.v[1] * o * n, r.p.v[2]),
            t.translate(-r.a.v[0], -r.a.v[1], r.a.v[2]),
            t.rotate(-r.r.v * o * n),
            t.translate(r.a.v[0], r.a.v[1], r.a.v[2]),
            i.translate(-r.a.v[0], -r.a.v[1], r.a.v[2]),
            i.scale(a ? 1 / s : s, a ? 1 / l : l),
            i.translate(r.a.v[0], r.a.v[1], r.a.v[2])
        }
        ,
        RepeaterModifier.prototype.init = function(e, t, i, r) {
            for (this.elem = e,
            this.arr = t,
            this.pos = i,
            this.elemsData = r,
            this._currentCopies = 0,
            this._elements = [],
            this._groups = [],
            this.frameId = -1,
            this.initDynamicPropertyContainer(e),
            this.initModifierProperties(e, t[i]); i > 0; )
                i -= 1,
                this._elements.unshift(t[i]);
            this.dynamicProperties.length ? this.k = !0 : this.getValue(!0)
        }
        ,
        RepeaterModifier.prototype.resetElements = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t]._processed = !1,
                "gr" === e[t].ty && this.resetElements(e[t].it)
        }
        ,
        RepeaterModifier.prototype.cloneElements = function(e) {
            var t = JSON.parse(JSON.stringify(e));
            return this.resetElements(t),
            t
        }
        ,
        RepeaterModifier.prototype.changeGroupRender = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                e[i]._render = t,
                "gr" === e[i].ty && this.changeGroupRender(e[i].it, t)
        }
        ,
        RepeaterModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o = !1;
            if (this._mdf || e) {
                var s, l = Math.ceil(this.c.v);
                if (this._groups.length < l) {
                    for (; this._groups.length < l; ) {
                        var h = {
                            it: this.cloneElements(this._elements),
                            ty: "gr"
                        };
                        h.it.push({
                            a: {
                                a: 0,
                                ix: 1,
                                k: [0, 0]
                            },
                            nm: "Transform",
                            o: {
                                a: 0,
                                ix: 7,
                                k: 100
                            },
                            p: {
                                a: 0,
                                ix: 2,
                                k: [0, 0]
                            },
                            r: {
                                a: 1,
                                ix: 6,
                                k: [{
                                    s: 0,
                                    e: 0,
                                    t: 0
                                }, {
                                    s: 0,
                                    e: 0,
                                    t: 1
                                }]
                            },
                            s: {
                                a: 0,
                                ix: 3,
                                k: [100, 100]
                            },
                            sa: {
                                a: 0,
                                ix: 5,
                                k: 0
                            },
                            sk: {
                                a: 0,
                                ix: 4,
                                k: 0
                            },
                            ty: "tr"
                        }),
                        this.arr.splice(0, 0, h),
                        this._groups.splice(0, 0, h),
                        this._currentCopies += 1
                    }
                    this.elem.reloadShapes(),
                    o = !0
                }
                for (a = 0,
                r = 0; r <= this._groups.length - 1; r += 1) {
                    if (s = a < l,
                    this._groups[r]._render = s,
                    this.changeGroupRender(this._groups[r].it, s),
                    !s) {
                        var c = this.elemsData[r].it
                          , p = c[c.length - 1];
                        0 !== p.transform.op.v ? (p.transform.op._mdf = !0,
                        p.transform.op.v = 0) : p.transform.op._mdf = !1
                    }
                    a += 1
                }
                this._currentCopies = l;
                var u = this.o.v
                  , d = u % 1
                  , f = u > 0 ? Math.floor(u) : Math.ceil(u)
                  , m = this.pMatrix.props
                  , g = this.rMatrix.props
                  , v = this.sMatrix.props;
                this.pMatrix.reset(),
                this.rMatrix.reset(),
                this.sMatrix.reset(),
                this.tMatrix.reset(),
                this.matrix.reset();
                var y, _, b = 0;
                if (u > 0) {
                    for (; b < f; )
                        this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !1),
                        b += 1;
                    d && (this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, d, !1),
                    b += d)
                } else if (u < 0) {
                    for (; b > f; )
                        this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !0),
                        b -= 1;
                    d && (this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, -d, !0),
                    b -= d)
                }
                for (r = 1 === this.data.m ? 0 : this._currentCopies - 1,
                n = 1 === this.data.m ? 1 : -1,
                a = this._currentCopies; a; ) {
                    if (_ = (i = (t = this.elemsData[r].it)[t.length - 1].transform.mProps.v.props).length,
                    t[t.length - 1].transform.mProps._mdf = !0,
                    t[t.length - 1].transform.op._mdf = !0,
                    t[t.length - 1].transform.op.v = 1 === this._currentCopies ? this.so.v : this.so.v + (this.eo.v - this.so.v) * (r / (this._currentCopies - 1)),
                    0 !== b) {
                        for ((0 !== r && 1 === n || r !== this._currentCopies - 1 && -1 === n) && this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !1),
                        this.matrix.transform(g[0], g[1], g[2], g[3], g[4], g[5], g[6], g[7], g[8], g[9], g[10], g[11], g[12], g[13], g[14], g[15]),
                        this.matrix.transform(v[0], v[1], v[2], v[3], v[4], v[5], v[6], v[7], v[8], v[9], v[10], v[11], v[12], v[13], v[14], v[15]),
                        this.matrix.transform(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]),
                        y = 0; y < _; y += 1)
                            i[y] = this.matrix.props[y];
                        this.matrix.reset()
                    } else
                        for (this.matrix.reset(),
                        y = 0; y < _; y += 1)
                            i[y] = this.matrix.props[y];
                    b += 1,
                    a -= 1,
                    r += n
                }
            } else
                for (a = this._currentCopies,
                r = 0,
                n = 1; a; )
                    i = (t = this.elemsData[r].it)[t.length - 1].transform.mProps.v.props,
                    t[t.length - 1].transform.mProps._mdf = !1,
                    t[t.length - 1].transform.op._mdf = !1,
                    a -= 1,
                    r += n;
            return o
        }
        ,
        RepeaterModifier.prototype.addShape = function() {}
        ,
        ShapeModifiers.registerModifier("rp", RepeaterModifier),
        ShapeCollection.prototype.addShape = function(e) {
            this._length === this._maxLength && (this.shapes = this.shapes.concat(createSizedArray(this._maxLength)),
            this._maxLength *= 2),
            this.shapes[this._length] = e,
            this._length += 1
        }
        ,
        ShapeCollection.prototype.releaseShapes = function() {
            var e;
            for (e = 0; e < this._length; e += 1)
                shapePool.release(this.shapes[e]);
            this._length = 0
        }
        ,
        DashProperty.prototype.getValue = function(e) {
            if ((this.elem.globalData.frameId !== this.frameId || e) && (this.frameId = this.elem.globalData.frameId,
            this.iterateDynamicProperties(),
            this._mdf = this._mdf || e,
            this._mdf)) {
                var t = 0
                  , i = this.dataProps.length;
                for ("svg" === this.renderer && (this.dashStr = ""),
                t = 0; t < i; t += 1)
                    "o" !== this.dataProps[t].n ? "svg" === this.renderer ? this.dashStr += " " + this.dataProps[t].p.v : this.dashArray[t] = this.dataProps[t].p.v : this.dashoffset[0] = this.dataProps[t].p.v
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], DashProperty),
        GradientProperty.prototype.comparePoints = function(e, t) {
            for (var i = 0, r = this.o.length / 2; i < r; ) {
                if (Math.abs(e[4 * i] - e[4 * t + 2 * i]) > .01)
                    return !1;
                i += 1
            }
            return !0
        }
        ,
        GradientProperty.prototype.checkCollapsable = function() {
            if (this.o.length / 2 != this.c.length / 4)
                return !1;
            if (this.data.k.k[0].s)
                for (var e = 0, t = this.data.k.k.length; e < t; ) {
                    if (!this.comparePoints(this.data.k.k[e].s, this.data.p))
                        return !1;
                    e += 1
                }
            else if (!this.comparePoints(this.data.k.k, this.data.p))
                return !1;
            return !0
        }
        ,
        GradientProperty.prototype.getValue = function(e) {
            if (this.prop.getValue(),
            this._mdf = !1,
            this._cmdf = !1,
            this._omdf = !1,
            this.prop._mdf || e) {
                var t, i, r, n = 4 * this.data.p;
                for (t = 0; t < n; t += 1)
                    i = t % 4 == 0 ? 100 : 255,
                    r = Math.round(this.prop.v[t] * i),
                    this.c[t] !== r && (this.c[t] = r,
                    this._cmdf = !e);
                if (this.o.length)
                    for (n = this.prop.v.length,
                    t = 4 * this.data.p; t < n; t += 1)
                        i = t % 2 == 0 ? 100 : 1,
                        r = t % 2 == 0 ? Math.round(100 * this.prop.v[t]) : this.prop.v[t],
                        this.o[t - 4 * this.data.p] !== r && (this.o[t - 4 * this.data.p] = r,
                        this._omdf = !e);
                this._mdf = !e
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], GradientProperty);
        var buildShapeString = function(e, t, i, r) {
            if (0 === t)
                return "";
            var n, a = e.o, o = e.i, s = e.v, l = " M" + r.applyToPointStringified(s[0][0], s[0][1]);
            for (n = 1; n < t; n += 1)
                l += " C" + r.applyToPointStringified(a[n - 1][0], a[n - 1][1]) + " " + r.applyToPointStringified(o[n][0], o[n][1]) + " " + r.applyToPointStringified(s[n][0], s[n][1]);
            return i && t && (l += " C" + r.applyToPointStringified(a[n - 1][0], a[n - 1][1]) + " " + r.applyToPointStringified(o[0][0], o[0][1]) + " " + r.applyToPointStringified(s[0][0], s[0][1]),
            l += "z"),
            l
        }, audioControllerFactory = function() {
            function e(e) {
                this.audios = [],
                this.audioFactory = e,
                this._volume = 1,
                this._isMuted = !1
            }
            return e.prototype = {
                addAudio: function(e) {
                    this.audios.push(e)
                },
                pause: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].pause()
                },
                resume: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].resume()
                },
                setRate: function(e) {
                    var t, i = this.audios.length;
                    for (t = 0; t < i; t += 1)
                        this.audios[t].setRate(e)
                },
                createAudio: function(e) {
                    return this.audioFactory ? this.audioFactory(e) : Howl ? new Howl({
                        src: [e]
                    }) : {
                        isPlaying: !1,
                        play: function() {
                            this.isPlaying = !0
                        },
                        seek: function() {
                            this.isPlaying = !1
                        },
                        playing: function() {},
                        rate: function() {},
                        setVolume: function() {}
                    }
                },
                setAudioFactory: function(e) {
                    this.audioFactory = e
                },
                setVolume: function(e) {
                    this._volume = e,
                    this._updateVolume()
                },
                mute: function() {
                    this._isMuted = !0,
                    this._updateVolume()
                },
                unmute: function() {
                    this._isMuted = !1,
                    this._updateVolume()
                },
                getVolume: function() {
                    return this._volume
                },
                _updateVolume: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].volume(this._volume * (this._isMuted ? 0 : 1))
                }
            },
            function() {
                return new e
            }
        }(), ImagePreloader = function() {
            var e = function() {
                var e = createTag("canvas");
                e.width = 1,
                e.height = 1;
                var t = e.getContext("2d");
                return t.fillStyle = "rgba(0,0,0,0)",
                t.fillRect(0, 0, 1, 1),
                e
            }();
            function t() {
                this.loadedAssets += 1,
                this.loadedAssets === this.totalImages && this.loadedFootagesCount === this.totalFootages && this.imagesLoadedCb && this.imagesLoadedCb(null)
            }
            function i() {
                this.loadedFootagesCount += 1,
                this.loadedAssets === this.totalImages && this.loadedFootagesCount === this.totalFootages && this.imagesLoadedCb && this.imagesLoadedCb(null)
            }
            function r(e, t, i) {
                var r = "";
                if (e.e)
                    r = e.p;
                else if (t) {
                    var n = e.p;
                    -1 !== n.indexOf("images/") && (n = n.split("/")[1]),
                    r = t + n
                } else
                    r = i,
                    r += e.u ? e.u : "",
                    r += e.p;
                return r
            }
            function n(e) {
                var t = 0
                  , i = setInterval(function() {
                    (e.getBBox().width || t > 500) && (this._imageLoaded(),
                    clearInterval(i)),
                    t += 1
                }
                .bind(this), 50)
            }
            function a(e) {
                var t = {
                    assetData: e
                }
                  , i = r(e, this.assetsPath, this.path);
                return dataManager.loadData(i, function(e) {
                    t.img = e,
                    this._footageLoaded()
                }
                .bind(this), function() {
                    t.img = {},
                    this._footageLoaded()
                }
                .bind(this)),
                t
            }
            function o() {
                this._imageLoaded = t.bind(this),
                this._footageLoaded = i.bind(this),
                this.testImageLoaded = n.bind(this),
                this.createFootageData = a.bind(this),
                this.assetsPath = "",
                this.path = "",
                this.totalImages = 0,
                this.totalFootages = 0,
                this.loadedAssets = 0,
                this.loadedFootagesCount = 0,
                this.imagesLoadedCb = null,
                this.images = []
            }
            return o.prototype = {
                loadAssets: function(e, t) {
                    var i;
                    this.imagesLoadedCb = t;
                    var r = e.length;
                    for (i = 0; i < r; i += 1)
                        e[i].layers || (e[i].t && "seq" !== e[i].t ? 3 === e[i].t && (this.totalFootages += 1,
                        this.images.push(this.createFootageData(e[i]))) : (this.totalImages += 1,
                        this.images.push(this._createImageData(e[i]))))
                },
                setAssetsPath: function(e) {
                    this.assetsPath = e || ""
                },
                setPath: function(e) {
                    this.path = e || ""
                },
                loadedImages: function() {
                    return this.totalImages === this.loadedAssets
                },
                loadedFootages: function() {
                    return this.totalFootages === this.loadedFootagesCount
                },
                destroy: function() {
                    this.imagesLoadedCb = null,
                    this.images.length = 0
                },
                getAsset: function(e) {
                    for (var t = 0, i = this.images.length; t < i; ) {
                        if (this.images[t].assetData === e)
                            return this.images[t].img;
                        t += 1
                    }
                    return null
                },
                createImgData: function(t) {
                    var i = r(t, this.assetsPath, this.path)
                      , n = createTag("img");
                    n.crossOrigin = "anonymous",
                    n.addEventListener("load", this._imageLoaded, !1),
                    n.addEventListener("error", function() {
                        a.img = e,
                        this._imageLoaded()
                    }
                    .bind(this), !1),
                    n.src = i;
                    var a = {
                        img: n,
                        assetData: t
                    };
                    return a
                },
                createImageData: function(t) {
                    var i = r(t, this.assetsPath, this.path)
                      , n = createNS("image");
                    isSafari ? this.testImageLoaded(n) : n.addEventListener("load", this._imageLoaded, !1),
                    n.addEventListener("error", function() {
                        a.img = e,
                        this._imageLoaded()
                    }
                    .bind(this), !1),
                    n.setAttributeNS("http://www.w3.org/1999/xlink", "href", i),
                    this._elementHelper.append ? this._elementHelper.append(n) : this._elementHelper.appendChild(n);
                    var a = {
                        img: n,
                        assetData: t
                    };
                    return a
                },
                imageLoaded: t,
                footageLoaded: i,
                setCacheType: function(e, t) {
                    "svg" === e ? (this._elementHelper = t,
                    this._createImageData = this.createImageData.bind(this)) : this._createImageData = this.createImgData.bind(this)
                }
            },
            o
        }(), featureSupport = (t2 = {
            maskType: !0
        },
        (/MSIE 10/i.test(navigator.userAgent) || /MSIE 9/i.test(navigator.userAgent) || /rv:11.0/i.test(navigator.userAgent) || /Edge\/\d./i.test(navigator.userAgent)) && (t2.maskType = !1),
        t2), filtersFactory = {
            createFilter: function(e, t) {
                var i = createNS("filter");
                return i.setAttribute("id", e),
                !0 !== t && (i.setAttribute("filterUnits", "objectBoundingBox"),
                i.setAttribute("x", "0%"),
                i.setAttribute("y", "0%"),
                i.setAttribute("width", "100%"),
                i.setAttribute("height", "100%")),
                i
            },
            createAlphaToLuminanceFilter: function() {
                var e = createNS("feColorMatrix");
                return e.setAttribute("type", "matrix"),
                e.setAttribute("color-interpolation-filters", "sRGB"),
                e.setAttribute("values", "0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),
                e
            }
        }, t2;
        function TextAnimatorProperty(e, t, i) {
            this._isFirstFrame = !0,
            this._hasMaskedPath = !1,
            this._frameId = -1,
            this._textData = e,
            this._renderType = t,
            this._elem = i,
            this._animatorsData = createSizedArray(this._textData.a.length),
            this._pathData = {},
            this._moreOptions = {
                alignment: {}
            },
            this.renderedLetters = [],
            this.lettersChangedFlag = !1,
            this.initDynamicPropertyContainer(i)
        }
        function TextAnimatorDataProperty(e, t, i) {
            var r = {
                propType: !1
            }
              , n = PropertyFactory.getProp
              , a = t.a;
            this.a = {
                r: a.r ? n(e, a.r, 0, degToRads, i) : r,
                rx: a.rx ? n(e, a.rx, 0, degToRads, i) : r,
                ry: a.ry ? n(e, a.ry, 0, degToRads, i) : r,
                sk: a.sk ? n(e, a.sk, 0, degToRads, i) : r,
                sa: a.sa ? n(e, a.sa, 0, degToRads, i) : r,
                s: a.s ? n(e, a.s, 1, .01, i) : r,
                a: a.a ? n(e, a.a, 1, 0, i) : r,
                o: a.o ? n(e, a.o, 0, .01, i) : r,
                p: a.p ? n(e, a.p, 1, 0, i) : r,
                sw: a.sw ? n(e, a.sw, 0, 0, i) : r,
                sc: a.sc ? n(e, a.sc, 1, 0, i) : r,
                fc: a.fc ? n(e, a.fc, 1, 0, i) : r,
                fh: a.fh ? n(e, a.fh, 0, 0, i) : r,
                fs: a.fs ? n(e, a.fs, 0, .01, i) : r,
                fb: a.fb ? n(e, a.fb, 0, .01, i) : r,
                t: a.t ? n(e, a.t, 0, 0, i) : r
            },
            this.s = TextSelectorProp.getTextSelectorProp(e, t.s, i),
            this.s.t = t.s.t
        }
        function LetterProps(e, t, i, r, n, a) {
            this.o = e,
            this.sw = t,
            this.sc = i,
            this.fc = r,
            this.m = n,
            this.p = a,
            this._mdf = {
                o: !0,
                sw: !!t,
                sc: !!i,
                fc: !!r,
                m: !0,
                p: !0
            }
        }
        function TextProperty(e, t) {
            this._frameId = initialDefaultFrame,
            this.pv = "",
            this.v = "",
            this.kf = !1,
            this._isFirstFrame = !0,
            this._mdf = !1,
            this.data = t,
            this.elem = e,
            this.comp = this.elem.comp,
            this.keysIndex = 0,
            this.canResize = !1,
            this.minimumFontSize = 1,
            this.effectsSequence = [],
            this.currentData = {
                ascent: 0,
                boxWidth: this.defaultBoxWidth,
                f: "",
                fStyle: "",
                fWeight: "",
                fc: "",
                j: "",
                justifyOffset: "",
                l: [],
                lh: 0,
                lineWidths: [],
                ls: "",
                of: "",
                s: "",
                sc: "",
                sw: 0,
                t: 0,
                tr: 0,
                sz: 0,
                ps: null,
                fillColorAnim: !1,
                strokeColorAnim: !1,
                strokeWidthAnim: !1,
                yOffset: 0,
                finalSize: 0,
                finalText: [],
                finalLineHeight: 0,
                __complete: !1
            },
            this.copyData(this.currentData, this.data.d.k[0].s),
            this.searchProperty() || this.completeTextData(this.currentData)
        }
        TextAnimatorProperty.prototype.searchProperties = function() {
            var e, t, i = this._textData.a.length, r = PropertyFactory.getProp;
            for (e = 0; e < i; e += 1)
                t = this._textData.a[e],
                this._animatorsData[e] = new TextAnimatorDataProperty(this._elem,t,this);
            this._textData.p && "m"in this._textData.p ? (this._pathData = {
                a: r(this._elem, this._textData.p.a, 0, 0, this),
                f: r(this._elem, this._textData.p.f, 0, 0, this),
                l: r(this._elem, this._textData.p.l, 0, 0, this),
                r: r(this._elem, this._textData.p.r, 0, 0, this),
                p: r(this._elem, this._textData.p.p, 0, 0, this),
                m: this._elem.maskManager.getMaskProperty(this._textData.p.m)
            },
            this._hasMaskedPath = !0) : this._hasMaskedPath = !1,
            this._moreOptions.alignment = r(this._elem, this._textData.m.a, 1, 0, this)
        }
        ,
        TextAnimatorProperty.prototype.getMeasures = function(e, t) {
            if (this.lettersChangedFlag = t,
            this._mdf || this._isFirstFrame || t || this._hasMaskedPath && this._pathData.m._mdf) {
                this._isFirstFrame = !1;
                var i, r, n, a, o, s, l, h, c, p, u, d, f, m, g, v, y, _, b, x = this._moreOptions.alignment.v, w = this._animatorsData, S = this._textData, T = this.mHelper, k = this._renderType, E = this.renderedLetters.length, M = e.l;
                if (this._hasMaskedPath) {
                    if (b = this._pathData.m,
                    !this._pathData.n || this._pathData._mdf) {
                        var P, C = b.v;
                        for (this._pathData.r.v && (C = C.reverse()),
                        o = {
                            tLength: 0,
                            segments: []
                        },
                        a = C._length - 1,
                        v = 0,
                        n = 0; n < a; n += 1)
                            P = bez.buildBezierData(C.v[n], C.v[n + 1], [C.o[n][0] - C.v[n][0], C.o[n][1] - C.v[n][1]], [C.i[n + 1][0] - C.v[n + 1][0], C.i[n + 1][1] - C.v[n + 1][1]]),
                            o.tLength += P.segmentLength,
                            o.segments.push(P),
                            v += P.segmentLength;
                        n = a,
                        b.v.c && (P = bez.buildBezierData(C.v[n], C.v[0], [C.o[n][0] - C.v[n][0], C.o[n][1] - C.v[n][1]], [C.i[0][0] - C.v[0][0], C.i[0][1] - C.v[0][1]]),
                        o.tLength += P.segmentLength,
                        o.segments.push(P),
                        v += P.segmentLength),
                        this._pathData.pi = o
                    }
                    if (o = this._pathData.pi,
                    s = this._pathData.f.v,
                    u = 0,
                    p = 1,
                    h = 0,
                    c = !0,
                    m = o.segments,
                    s < 0 && b.v.c)
                        for (o.tLength < Math.abs(s) && (s = -Math.abs(s) % o.tLength),
                        p = (f = m[u = m.length - 1].points).length - 1; s < 0; )
                            s += f[p].partialLength,
                            (p -= 1) < 0 && (p = (f = m[u -= 1].points).length - 1);
                    d = (f = m[u].points)[p - 1],
                    g = (l = f[p]).partialLength
                }
                a = M.length,
                i = 0,
                r = 0;
                var A, L, D, I, R, F = 1.2 * e.finalSize * .714, B = !0;
                D = w.length;
                var O, N, V, z, G, H, U, W, j, $, q, X, Y = -1, K = s, Z = u, J = p, Q = -1, ee = "", te = this.defaultPropsArray;
                if (2 === e.j || 1 === e.j) {
                    var ie = 0
                      , re = 0
                      , ne = 2 === e.j ? -.5 : -1
                      , ae = 0
                      , oe = !0;
                    for (n = 0; n < a; n += 1)
                        if (M[n].n) {
                            for (ie && (ie += re); ae < n; )
                                M[ae].animatorJustifyOffset = ie,
                                ae += 1;
                            ie = 0,
                            oe = !0
                        } else {
                            for (L = 0; L < D; L += 1)
                                (A = w[L].a).t.propType && (oe && 2 === e.j && (re += A.t.v * ne),
                                (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? ie += A.t.v * R[0] * ne : ie += A.t.v * R * ne);
                            oe = !1
                        }
                    for (ie && (ie += re); ae < n; )
                        M[ae].animatorJustifyOffset = ie,
                        ae += 1
                }
                for (n = 0; n < a; n += 1) {
                    if (T.reset(),
                    z = 1,
                    M[n].n)
                        i = 0,
                        r += e.yOffset,
                        r += B ? 1 : 0,
                        s = K,
                        B = !1,
                        this._hasMaskedPath && (p = J,
                        d = (f = m[u = Z].points)[p - 1],
                        g = (l = f[p]).partialLength,
                        h = 0),
                        ee = "",
                        q = "",
                        j = "",
                        X = "",
                        te = this.defaultPropsArray;
                    else {
                        if (this._hasMaskedPath) {
                            if (Q !== M[n].line) {
                                switch (e.j) {
                                case 1:
                                    s += v - e.lineWidths[M[n].line];
                                    break;
                                case 2:
                                    s += (v - e.lineWidths[M[n].line]) / 2
                                }
                                Q = M[n].line
                            }
                            Y !== M[n].ind && (M[Y] && (s += M[Y].extra),
                            s += M[n].an / 2,
                            Y = M[n].ind),
                            s += x[0] * M[n].an * .005;
                            var se = 0;
                            for (L = 0; L < D; L += 1)
                                (A = w[L].a).p.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? se += A.p.v[0] * R[0] : se += A.p.v[0] * R),
                                A.a.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? se += A.a.v[0] * R[0] : se += A.a.v[0] * R);
                            for (c = !0,
                            this._pathData.a.v && (s = .5 * M[0].an + (v - this._pathData.f.v - .5 * M[0].an - .5 * M[M.length - 1].an) * Y / (a - 1),
                            s += this._pathData.f.v); c; )
                                h + g >= s + se || !f ? (y = (s + se - h) / l.partialLength,
                                N = d.point[0] + (l.point[0] - d.point[0]) * y,
                                V = d.point[1] + (l.point[1] - d.point[1]) * y,
                                T.translate(-x[0] * M[n].an * .005, -x[1] * F * .01),
                                c = !1) : f && (h += l.partialLength,
                                (p += 1) >= f.length && (p = 0,
                                m[u += 1] ? f = m[u].points : b.v.c ? (p = 0,
                                f = m[u = 0].points) : (h -= l.partialLength,
                                f = null)),
                                f && (d = l,
                                g = (l = f[p]).partialLength));
                            O = M[n].an / 2 - M[n].add,
                            T.translate(-O, 0, 0)
                        } else
                            O = M[n].an / 2 - M[n].add,
                            T.translate(-O, 0, 0),
                            T.translate(-x[0] * M[n].an * .005, -x[1] * F * .01, 0);
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).t.propType && (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            0 === i && 0 === e.j || (this._hasMaskedPath ? R.length ? s += A.t.v * R[0] : s += A.t.v * R : R.length ? i += A.t.v * R[0] : i += A.t.v * R));
                        for (e.strokeWidthAnim && (H = e.sw || 0),
                        e.strokeColorAnim && (G = e.sc ? [e.sc[0], e.sc[1], e.sc[2]] : [0, 0, 0]),
                        e.fillColorAnim && e.fc && (U = [e.fc[0], e.fc[1], e.fc[2]]),
                        L = 0; L < D; L += 1)
                            (A = w[L].a).a.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? T.translate(-A.a.v[0] * R[0], -A.a.v[1] * R[1], A.a.v[2] * R[2]) : T.translate(-A.a.v[0] * R, -A.a.v[1] * R, A.a.v[2] * R));
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).s.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? T.scale(1 + (A.s.v[0] - 1) * R[0], 1 + (A.s.v[1] - 1) * R[1], 1) : T.scale(1 + (A.s.v[0] - 1) * R, 1 + (A.s.v[1] - 1) * R, 1));
                        for (L = 0; L < D; L += 1) {
                            if (A = w[L].a,
                            R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            A.sk.propType && (R.length ? T.skewFromAxis(-A.sk.v * R[0], A.sa.v * R[1]) : T.skewFromAxis(-A.sk.v * R, A.sa.v * R)),
                            A.r.propType && (R.length ? T.rotateZ(-A.r.v * R[2]) : T.rotateZ(-A.r.v * R)),
                            A.ry.propType && (R.length ? T.rotateY(A.ry.v * R[1]) : T.rotateY(A.ry.v * R)),
                            A.rx.propType && (R.length ? T.rotateX(A.rx.v * R[0]) : T.rotateX(A.rx.v * R)),
                            A.o.propType && (R.length ? z += (A.o.v * R[0] - z) * R[0] : z += (A.o.v * R - z) * R),
                            e.strokeWidthAnim && A.sw.propType && (R.length ? H += A.sw.v * R[0] : H += A.sw.v * R),
                            e.strokeColorAnim && A.sc.propType)
                                for (W = 0; W < 3; W += 1)
                                    R.length ? G[W] += (A.sc.v[W] - G[W]) * R[0] : G[W] += (A.sc.v[W] - G[W]) * R;
                            if (e.fillColorAnim && e.fc) {
                                if (A.fc.propType)
                                    for (W = 0; W < 3; W += 1)
                                        R.length ? U[W] += (A.fc.v[W] - U[W]) * R[0] : U[W] += (A.fc.v[W] - U[W]) * R;
                                A.fh.propType && (U = R.length ? addHueToRGB(U, A.fh.v * R[0]) : addHueToRGB(U, A.fh.v * R)),
                                A.fs.propType && (U = R.length ? addSaturationToRGB(U, A.fs.v * R[0]) : addSaturationToRGB(U, A.fs.v * R)),
                                A.fb.propType && (U = R.length ? addBrightnessToRGB(U, A.fb.v * R[0]) : addBrightnessToRGB(U, A.fb.v * R))
                            }
                        }
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).p.propType && (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            this._hasMaskedPath ? R.length ? T.translate(0, A.p.v[1] * R[0], -A.p.v[2] * R[1]) : T.translate(0, A.p.v[1] * R, -A.p.v[2] * R) : R.length ? T.translate(A.p.v[0] * R[0], A.p.v[1] * R[1], -A.p.v[2] * R[2]) : T.translate(A.p.v[0] * R, A.p.v[1] * R, -A.p.v[2] * R));
                        if (e.strokeWidthAnim && (j = H < 0 ? 0 : H),
                        e.strokeColorAnim && ($ = "rgb(" + Math.round(255 * G[0]) + "," + Math.round(255 * G[1]) + "," + Math.round(255 * G[2]) + ")"),
                        e.fillColorAnim && e.fc && (q = "rgb(" + Math.round(255 * U[0]) + "," + Math.round(255 * U[1]) + "," + Math.round(255 * U[2]) + ")"),
                        this._hasMaskedPath) {
                            if (T.translate(0, -e.ls),
                            T.translate(0, x[1] * F * .01 + r, 0),
                            this._pathData.p.v) {
                                _ = (l.point[1] - d.point[1]) / (l.point[0] - d.point[0]);
                                var le = 180 * Math.atan(_) / Math.PI;
                                l.point[0] < d.point[0] && (le += 180),
                                T.rotate(-le * Math.PI / 180)
                            }
                            T.translate(N, V, 0),
                            s -= x[0] * M[n].an * .005,
                            M[n + 1] && Y !== M[n + 1].ind && (s += M[n].an / 2,
                            s += .001 * e.tr * e.finalSize)
                        } else {
                            switch (T.translate(i, r, 0),
                            e.ps && T.translate(e.ps[0], e.ps[1] + e.ascent, 0),
                            e.j) {
                            case 1:
                                T.translate(M[n].animatorJustifyOffset + e.justifyOffset + (e.boxWidth - e.lineWidths[M[n].line]), 0, 0);
                                break;
                            case 2:
                                T.translate(M[n].animatorJustifyOffset + e.justifyOffset + (e.boxWidth - e.lineWidths[M[n].line]) / 2, 0, 0)
                            }
                            T.translate(0, -e.ls),
                            T.translate(O, 0, 0),
                            T.translate(x[0] * M[n].an * .005, x[1] * F * .01, 0),
                            i += M[n].l + .001 * e.tr * e.finalSize
                        }
                        "html" === k ? ee = T.toCSS() : "svg" === k ? ee = T.to2dCSS() : te = [T.props[0], T.props[1], T.props[2], T.props[3], T.props[4], T.props[5], T.props[6], T.props[7], T.props[8], T.props[9], T.props[10], T.props[11], T.props[12], T.props[13], T.props[14], T.props[15]],
                        X = z
                    }
                    E <= n ? (I = new LetterProps(X,j,$,q,ee,te),
                    this.renderedLetters.push(I),
                    E += 1,
                    this.lettersChangedFlag = !0) : (I = this.renderedLetters[n],
                    this.lettersChangedFlag = I.update(X, j, $, q, ee, te) || this.lettersChangedFlag)
                }
            }
        }
        ,
        TextAnimatorProperty.prototype.getValue = function() {
            this._elem.globalData.frameId !== this._frameId && (this._frameId = this._elem.globalData.frameId,
            this.iterateDynamicProperties())
        }
        ,
        TextAnimatorProperty.prototype.mHelper = new Matrix,
        TextAnimatorProperty.prototype.defaultPropsArray = [],
        extendPrototype([DynamicPropertyContainer], TextAnimatorProperty),
        LetterProps.prototype.update = function(e, t, i, r, n, a) {
            this._mdf.o = !1,
            this._mdf.sw = !1,
            this._mdf.sc = !1,
            this._mdf.fc = !1,
            this._mdf.m = !1,
            this._mdf.p = !1;
            var o = !1;
            return this.o !== e && (this.o = e,
            this._mdf.o = !0,
            o = !0),
            this.sw !== t && (this.sw = t,
            this._mdf.sw = !0,
            o = !0),
            this.sc !== i && (this.sc = i,
            this._mdf.sc = !0,
            o = !0),
            this.fc !== r && (this.fc = r,
            this._mdf.fc = !0,
            o = !0),
            this.m !== n && (this.m = n,
            this._mdf.m = !0,
            o = !0),
            !a.length || this.p[0] === a[0] && this.p[1] === a[1] && this.p[4] === a[4] && this.p[5] === a[5] && this.p[12] === a[12] && this.p[13] === a[13] || (this.p = a,
            this._mdf.p = !0,
            o = !0),
            o
        }
        ,
        TextProperty.prototype.defaultBoxWidth = [0, 0],
        TextProperty.prototype.copyData = function(e, t) {
            for (var i in t)
                Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]);
            return e
        }
        ,
        TextProperty.prototype.setCurrentData = function(e) {
            e.__complete || this.completeTextData(e),
            this.currentData = e,
            this.currentData.boxWidth = this.currentData.boxWidth || this.defaultBoxWidth,
            this._mdf = !0
        }
        ,
        TextProperty.prototype.searchProperty = function() {
            return this.searchKeyframes()
        }
        ,
        TextProperty.prototype.searchKeyframes = function() {
            return this.kf = this.data.d.k.length > 1,
            this.kf && this.addEffect(this.getKeyframeValue.bind(this)),
            this.kf
        }
        ,
        TextProperty.prototype.addEffect = function(e) {
            this.effectsSequence.push(e),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.getValue = function(e) {
            if (this.elem.globalData.frameId !== this.frameId && this.effectsSequence.length || e) {
                this.currentData.t = this.data.d.k[this.keysIndex].s.t;
                var t = this.currentData
                  , i = this.keysIndex;
                if (this.lock)
                    this.setCurrentData(this.currentData);
                else {
                    var r;
                    this.lock = !0,
                    this._mdf = !1;
                    var n = this.effectsSequence.length
                      , a = e || this.data.d.k[this.keysIndex].s;
                    for (r = 0; r < n; r += 1)
                        a = i !== this.keysIndex ? this.effectsSequence[r](a, a.t) : this.effectsSequence[r](this.currentData, a.t);
                    t !== a && this.setCurrentData(a),
                    this.v = this.currentData,
                    this.pv = this.v,
                    this.lock = !1,
                    this.frameId = this.elem.globalData.frameId
                }
            }
        }
        ,
        TextProperty.prototype.getKeyframeValue = function() {
            for (var e = this.data.d.k, t = this.elem.comp.renderedFrame, i = 0, r = e.length; i <= r - 1 && !(i === r - 1 || e[i + 1].t > t); )
                i += 1;
            return this.keysIndex !== i && (this.keysIndex = i),
            this.data.d.k[this.keysIndex].s
        }
        ,
        TextProperty.prototype.buildFinalText = function(e) {
            for (var t, i, r = [], n = 0, a = e.length, o = !1; n < a; )
                t = e.charCodeAt(n),
                FontManager.isCombinedCharacter(t) ? r[r.length - 1] += e.charAt(n) : t >= 55296 && t <= 56319 ? (i = e.charCodeAt(n + 1)) >= 56320 && i <= 57343 ? (o || FontManager.isModifier(t, i) ? (r[r.length - 1] += e.substr(n, 2),
                o = !1) : r.push(e.substr(n, 2)),
                n += 1) : r.push(e.charAt(n)) : t > 56319 ? (i = e.charCodeAt(n + 1),
                FontManager.isZeroWidthJoiner(t, i) ? (o = !0,
                r[r.length - 1] += e.substr(n, 2),
                n += 1) : r.push(e.charAt(n))) : FontManager.isZeroWidthJoiner(t) ? (r[r.length - 1] += e.charAt(n),
                o = !0) : r.push(e.charAt(n)),
                n += 1;
            return r
        }
        ,
        TextProperty.prototype.completeTextData = function(e) {
            e.__complete = !0;
            var t, i, r, n, a, o, s, l = this.elem.globalData.fontManager, h = this.data, c = [], p = 0, u = h.m.g, d = 0, f = 0, m = 0, g = [], v = 0, y = 0, _ = l.getFontByName(e.f), b = 0, x = getFontProperties(_);
            e.fWeight = x.weight,
            e.fStyle = x.style,
            e.finalSize = e.s,
            e.finalText = this.buildFinalText(e.t),
            i = e.finalText.length,
            e.finalLineHeight = e.lh;
            var w, S = e.tr / 1e3 * e.finalSize;
            if (e.sz)
                for (var T, k, E = !0, M = e.sz[0], P = e.sz[1]; E; ) {
                    T = 0,
                    v = 0,
                    i = (k = this.buildFinalText(e.t)).length,
                    S = e.tr / 1e3 * e.finalSize;
                    var C = -1;
                    for (t = 0; t < i; t += 1)
                        w = k[t].charCodeAt(0),
                        r = !1,
                        " " === k[t] ? C = t : 13 !== w && 3 !== w || (v = 0,
                        r = !0,
                        T += e.finalLineHeight || 1.2 * e.finalSize),
                        l.chars ? (s = l.getCharData(k[t], _.fStyle, _.fFamily),
                        b = r ? 0 : s.w * e.finalSize / 100) : b = l.measureText(k[t], e.f, e.finalSize),
                        v + b > M && " " !== k[t] ? (-1 === C ? i += 1 : t = C,
                        T += e.finalLineHeight || 1.2 * e.finalSize,
                        k.splice(t, C === t ? 1 : 0, "\r"),
                        C = -1,
                        v = 0) : (v += b,
                        v += S);
                    T += _.ascent * e.finalSize / 100,
                    this.canResize && e.finalSize > this.minimumFontSize && P < T ? (e.finalSize -= 1,
                    e.finalLineHeight = e.finalSize * e.lh / e.s) : (e.finalText = k,
                    i = e.finalText.length,
                    E = !1)
                }
            v = -S,
            b = 0;
            var A, L = 0;
            for (t = 0; t < i; t += 1)
                if (r = !1,
                13 === (w = (A = e.finalText[t]).charCodeAt(0)) || 3 === w ? (L = 0,
                g.push(v),
                y = v > y ? v : y,
                v = -2 * S,
                n = "",
                r = !0,
                m += 1) : n = A,
                l.chars ? (s = l.getCharData(A, _.fStyle, l.getFontByName(e.f).fFamily),
                b = r ? 0 : s.w * e.finalSize / 100) : b = l.measureText(n, e.f, e.finalSize),
                " " === A ? L += b + S : (v += b + S + L,
                L = 0),
                c.push({
                    l: b,
                    an: b,
                    add: d,
                    n: r,
                    anIndexes: [],
                    val: n,
                    line: m,
                    animatorJustifyOffset: 0
                }),
                2 == u) {
                    if (d += b,
                    "" === n || " " === n || t === i - 1) {
                        for ("" !== n && " " !== n || (d -= b); f <= t; )
                            c[f].an = d,
                            c[f].ind = p,
                            c[f].extra = b,
                            f += 1;
                        p += 1,
                        d = 0
                    }
                } else if (3 == u) {
                    if (d += b,
                    "" === n || t === i - 1) {
                        for ("" === n && (d -= b); f <= t; )
                            c[f].an = d,
                            c[f].ind = p,
                            c[f].extra = b,
                            f += 1;
                        d = 0,
                        p += 1
                    }
                } else
                    c[p].ind = p,
                    c[p].extra = 0,
                    p += 1;
            if (e.l = c,
            y = v > y ? v : y,
            g.push(v),
            e.sz)
                e.boxWidth = e.sz[0],
                e.justifyOffset = 0;
            else
                switch (e.boxWidth = y,
                e.j) {
                case 1:
                    e.justifyOffset = -e.boxWidth;
                    break;
                case 2:
                    e.justifyOffset = -e.boxWidth / 2;
                    break;
                default:
                    e.justifyOffset = 0
                }
            e.lineWidths = g;
            var D, I, R, F, B = h.a;
            o = B.length;
            var O = [];
            for (a = 0; a < o; a += 1) {
                for ((D = B[a]).a.sc && (e.strokeColorAnim = !0),
                D.a.sw && (e.strokeWidthAnim = !0),
                (D.a.fc || D.a.fh || D.a.fs || D.a.fb) && (e.fillColorAnim = !0),
                F = 0,
                R = D.s.b,
                t = 0; t < i; t += 1)
                    (I = c[t]).anIndexes[a] = F,
                    (1 == R && "" !== I.val || 2 == R && "" !== I.val && " " !== I.val || 3 == R && (I.n || " " == I.val || t == i - 1) || 4 == R && (I.n || t == i - 1)) && (1 === D.s.rn && O.push(F),
                    F += 1);
                h.a[a].s.totalChars = F;
                var N, V = -1;
                if (1 === D.s.rn)
                    for (t = 0; t < i; t += 1)
                        V != (I = c[t]).anIndexes[a] && (V = I.anIndexes[a],
                        N = O.splice(Math.floor(Math.random() * O.length), 1)[0]),
                        I.anIndexes[a] = N
            }
            e.yOffset = e.finalLineHeight || 1.2 * e.finalSize,
            e.ls = e.ls || 0,
            e.ascent = _.ascent * e.finalSize / 100
        }
        ,
        TextProperty.prototype.updateDocumentData = function(e, t) {
            t = void 0 === t ? this.keysIndex : t;
            var i = this.copyData({}, this.data.d.k[t].s);
            i = this.copyData(i, e),
            this.data.d.k[t].s = i,
            this.recalculate(t),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.recalculate = function(e) {
            var t = this.data.d.k[e].s;
            t.__complete = !1,
            this.keysIndex = 0,
            this._isFirstFrame = !0,
            this.getValue(t)
        }
        ,
        TextProperty.prototype.canResizeFont = function(e) {
            this.canResize = e,
            this.recalculate(this.keysIndex),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.setMinimumFontSize = function(e) {
            this.minimumFontSize = Math.floor(e) || 1,
            this.recalculate(this.keysIndex),
            this.elem.addDynamicProperty(this)
        }
        ;
        var TextSelectorProp = function() {
            var e = Math.max
              , t = Math.min
              , i = Math.floor;
            function r(e, t) {
                this._currentTextLength = -1,
                this.k = !1,
                this.data = t,
                this.elem = e,
                this.comp = e.comp,
                this.finalS = 0,
                this.finalE = 0,
                this.initDynamicPropertyContainer(e),
                this.s = PropertyFactory.getProp(e, t.s || {
                    k: 0
                }, 0, 0, this),
                this.e = "e"in t ? PropertyFactory.getProp(e, t.e, 0, 0, this) : {
                    v: 100
                },
                this.o = PropertyFactory.getProp(e, t.o || {
                    k: 0
                }, 0, 0, this),
                this.xe = PropertyFactory.getProp(e, t.xe || {
                    k: 0
                }, 0, 0, this),
                this.ne = PropertyFactory.getProp(e, t.ne || {
                    k: 0
                }, 0, 0, this),
                this.sm = PropertyFactory.getProp(e, t.sm || {
                    k: 100
                }, 0, 0, this),
                this.a = PropertyFactory.getProp(e, t.a, 0, .01, this),
                this.dynamicProperties.length || this.getValue()
            }
            return r.prototype = {
                getMult: function(r) {
                    this._currentTextLength !== this.elem.textProperty.currentData.l.length && this.getValue();
                    var n = 0
                      , a = 0
                      , o = 1
                      , s = 1;
                    this.ne.v > 0 ? n = this.ne.v / 100 : a = -this.ne.v / 100,
                    this.xe.v > 0 ? o = 1 - this.xe.v / 100 : s = 1 + this.xe.v / 100;
                    var l = BezierFactory.getBezierEasing(n, a, o, s).get
                      , h = 0
                      , c = this.finalS
                      , p = this.finalE
                      , u = this.data.sh;
                    if (2 === u)
                        h = l(h = p === c ? r >= p ? 1 : 0 : e(0, t(.5 / (p - c) + (r - c) / (p - c), 1)));
                    else if (3 === u)
                        h = l(h = p === c ? r >= p ? 0 : 1 : 1 - e(0, t(.5 / (p - c) + (r - c) / (p - c), 1)));
                    else if (4 === u)
                        p === c ? h = 0 : (h = e(0, t(.5 / (p - c) + (r - c) / (p - c), 1))) < .5 ? h *= 2 : h = 1 - 2 * (h - .5),
                        h = l(h);
                    else if (5 === u) {
                        if (p === c)
                            h = 0;
                        else {
                            var d = p - c
                              , f = -d / 2 + (r = t(e(0, r + .5 - c), p - c))
                              , m = d / 2;
                            h = Math.sqrt(1 - f * f / (m * m))
                        }
                        h = l(h)
                    } else
                        6 === u ? (p === c ? h = 0 : (r = t(e(0, r + .5 - c), p - c),
                        h = (1 + Math.cos(Math.PI + 2 * Math.PI * r / (p - c))) / 2),
                        h = l(h)) : (r >= i(c) && (h = e(0, t(r - c < 0 ? t(p, 1) - (c - r) : p - r, 1))),
                        h = l(h));
                    if (100 !== this.sm.v) {
                        var g = .01 * this.sm.v;
                        0 === g && (g = 1e-8);
                        var v = .5 - .5 * g;
                        h < v ? h = 0 : (h = (h - v) / g) > 1 && (h = 1)
                    }
                    return h * this.a.v
                },
                getValue: function(e) {
                    this.iterateDynamicProperties(),
                    this._mdf = e || this._mdf,
                    this._currentTextLength = this.elem.textProperty.currentData.l.length || 0,
                    e && 2 === this.data.r && (this.e.v = this._currentTextLength);
                    var t = 2 === this.data.r ? 1 : 100 / this.data.totalChars
                      , i = this.o.v / t
                      , r = this.s.v / t + i
                      , n = this.e.v / t + i;
                    if (r > n) {
                        var a = r;
                        r = n,
                        n = a
                    }
                    this.finalS = r,
                    this.finalE = n
                }
            },
            extendPrototype([DynamicPropertyContainer], r),
            {
                getTextSelectorProp: function(e, t, i) {
                    return new r(e,t)
                }
            }
        }(), poolFactory = function(e, t, i) {
            var r = 0
              , n = e
              , a = createSizedArray(n);
            return {
                newElement: function() {
                    return r ? a[r -= 1] : t()
                },
                release: function(e) {
                    r === n && (a = pooling.double(a),
                    n *= 2),
                    i && i(e),
                    a[r] = e,
                    r += 1
                }
            }
        }, pooling = {
            double: function(e) {
                return e.concat(createSizedArray(e.length))
            }
        }, pointPool = poolFactory(8, (function() {
            return createTypedArray("float32", 2)
        }
        )), shapePool = (factory = poolFactory(4, (function() {
            return new ShapePath
        }
        ), (function(e) {
            var t, i = e._length;
            for (t = 0; t < i; t += 1)
                pointPool.release(e.v[t]),
                pointPool.release(e.i[t]),
                pointPool.release(e.o[t]),
                e.v[t] = null,
                e.i[t] = null,
                e.o[t] = null;
            e._length = 0,
            e.c = !1
        }
        )),
        factory.clone = function(e) {
            var t, i = factory.newElement(), r = void 0 === e._length ? e.v.length : e._length;
            for (i.setLength(r),
            i.c = e.c,
            t = 0; t < r; t += 1)
                i.setTripleAt(e.v[t][0], e.v[t][1], e.o[t][0], e.o[t][1], e.i[t][0], e.i[t][1], t);
            return i
        }
        ,
        factory), factory, shapeCollectionPool = function() {
            var e = {
                newShapeCollection: function() {
                    return t ? r[t -= 1] : new ShapeCollection
                },
                release: function(e) {
                    var n, a = e._length;
                    for (n = 0; n < a; n += 1)
                        shapePool.release(e.shapes[n]);
                    e._length = 0,
                    t === i && (r = pooling.double(r),
                    i *= 2),
                    r[t] = e,
                    t += 1
                }
            }
              , t = 0
              , i = 4
              , r = createSizedArray(i);
            return e
        }(), segmentsLengthPool = poolFactory(8, (function() {
            return {
                lengths: [],
                totalLength: 0
            }
        }
        ), (function(e) {
            var t, i = e.lengths.length;
            for (t = 0; t < i; t += 1)
                bezierLengthPool.release(e.lengths[t]);
            e.lengths.length = 0
        }
        )), bezierLengthPool = poolFactory(8, (function() {
            return {
                addedLength: 0,
                percents: createTypedArray("float32", defaultCurveSegments),
                lengths: createTypedArray("float32", defaultCurveSegments)
            }
        }
        )), markerParser = function() {
            function e(e) {
                for (var t, i = e.split("\r\n"), r = {}, n = 0, a = 0; a < i.length; a += 1)
                    2 === (t = i[a].split(":")).length && (r[t[0]] = t[1].trim(),
                    n += 1);
                if (0 === n)
                    throw new Error;
                return r
            }
            return function(t) {
                for (var i = [], r = 0; r < t.length; r += 1) {
                    var n = t[r]
                      , a = {
                        time: n.tm,
                        duration: n.dr
                    };
                    try {
                        a.payload = JSON.parse(t[r].cm)
                    } catch (o) {
                        try {
                            a.payload = e(t[r].cm)
                        } catch (s) {
                            a.payload = {
                                name: t[r]
                            }
                        }
                    }
                    i.push(a)
                }
                return i
            }
        }();
        function BaseRenderer() {}
        function SVGRenderer(e, t) {
            this.animationItem = e,
            this.layers = null,
            this.renderedFrame = -1,
            this.svgElement = createNS("svg");
            var i = "";
            if (t && t.title) {
                var r = createNS("title")
                  , n = createElementID();
                r.setAttribute("id", n),
                r.textContent = t.title,
                this.svgElement.appendChild(r),
                i += n
            }
            if (t && t.description) {
                var a = createNS("desc")
                  , o = createElementID();
                a.setAttribute("id", o),
                a.textContent = t.description,
                this.svgElement.appendChild(a),
                i += " " + o
            }
            i && this.svgElement.setAttribute("aria-labelledby", i);
            var s = createNS("defs");
            this.svgElement.appendChild(s);
            var l = createNS("g");
            this.svgElement.appendChild(l),
            this.layerElement = l,
            this.renderConfig = {
                preserveAspectRatio: t && t.preserveAspectRatio || "xMidYMid meet",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                contentVisibility: t && t.contentVisibility || "visible",
                progressiveLoad: t && t.progressiveLoad || !1,
                hideOnTransparent: !(t && !1 === t.hideOnTransparent),
                viewBoxOnly: t && t.viewBoxOnly || !1,
                viewBoxSize: t && t.viewBoxSize || !1,
                className: t && t.className || "",
                id: t && t.id || "",
                focusable: t && t.focusable,
                filterSize: {
                    width: t && t.filterSize && t.filterSize.width || "100%",
                    height: t && t.filterSize && t.filterSize.height || "100%",
                    x: t && t.filterSize && t.filterSize.x || "0%",
                    y: t && t.filterSize && t.filterSize.y || "0%"
                }
            },
            this.globalData = {
                _mdf: !1,
                frameNum: -1,
                defs: s,
                renderConfig: this.renderConfig
            },
            this.elements = [],
            this.pendingElements = [],
            this.destroyed = !1,
            this.rendererType = "svg"
        }
        function CanvasRenderer(e, t) {
            this.animationItem = e,
            this.renderConfig = {
                clearCanvas: !t || void 0 === t.clearCanvas || t.clearCanvas,
                context: t && t.context || null,
                progressiveLoad: t && t.progressiveLoad || !1,
                preserveAspectRatio: t && t.preserveAspectRatio || "xMidYMid meet",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                contentVisibility: t && t.contentVisibility || "visible",
                className: t && t.className || "",
                id: t && t.id || ""
            },
            this.renderConfig.dpr = t && t.dpr || 1,
            this.animationItem.wrapper && (this.renderConfig.dpr = t && t.dpr || window.devicePixelRatio || 1),
            this.renderedFrame = -1,
            this.globalData = {
                frameNum: -1,
                _mdf: !1,
                renderConfig: this.renderConfig,
                currentGlobalAlpha: -1
            },
            this.contextData = new CVContextData,
            this.elements = [],
            this.pendingElements = [],
            this.transformMat = new Matrix,
            this.completeLayers = !1,
            this.rendererType = "canvas"
        }
        function HybridRenderer(e, t) {
            this.animationItem = e,
            this.layers = null,
            this.renderedFrame = -1,
            this.renderConfig = {
                className: t && t.className || "",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                hideOnTransparent: !(t && !1 === t.hideOnTransparent),
                filterSize: {
                    width: t && t.filterSize && t.filterSize.width || "400%",
                    height: t && t.filterSize && t.filterSize.height || "400%",
                    x: t && t.filterSize && t.filterSize.x || "-100%",
                    y: t && t.filterSize && t.filterSize.y || "-100%"
                }
            },
            this.globalData = {
                _mdf: !1,
                frameNum: -1,
                renderConfig: this.renderConfig
            },
            this.pendingElements = [],
            this.elements = [],
            this.threeDElements = [],
            this.destroyed = !1,
            this.camera = null,
            this.supports3d = !0,
            this.rendererType = "html"
        }
        function MaskElement(e, t, i) {
            this.data = e,
            this.element = t,
            this.globalData = i,
            this.storedData = [],
            this.masksProperties = this.data.masksProperties || [],
            this.maskElement = null;
            var r, n, a = this.globalData.defs, o = this.masksProperties ? this.masksProperties.length : 0;
            this.viewData = createSizedArray(o),
            this.solidPath = "";
            var s, l, h, c, p, u, d = this.masksProperties, f = 0, m = [], g = createElementID(), v = "clipPath", y = "clip-path";
            for (r = 0; r < o; r += 1)
                if (("a" !== d[r].mode && "n" !== d[r].mode || d[r].inv || 100 !== d[r].o.k || d[r].o.x) && (v = "mask",
                y = "mask"),
                "s" !== d[r].mode && "i" !== d[r].mode || 0 !== f ? h = null : ((h = createNS("rect")).setAttribute("fill", "#ffffff"),
                h.setAttribute("width", this.element.comp.data.w || 0),
                h.setAttribute("height", this.element.comp.data.h || 0),
                m.push(h)),
                n = createNS("path"),
                "n" === d[r].mode)
                    this.viewData[r] = {
                        op: PropertyFactory.getProp(this.element, d[r].o, 0, .01, this.element),
                        prop: ShapePropertyFactory.getShapeProp(this.element, d[r], 3),
                        elem: n,
                        lastPath: ""
                    },
                    a.appendChild(n);
                else {
                    var _;
                    if (f += 1,
                    n.setAttribute("fill", "s" === d[r].mode ? "#000000" : "#ffffff"),
                    n.setAttribute("clip-rule", "nonzero"),
                    0 !== d[r].x.k ? (v = "mask",
                    y = "mask",
                    u = PropertyFactory.getProp(this.element, d[r].x, 0, null, this.element),
                    _ = createElementID(),
                    (c = createNS("filter")).setAttribute("id", _),
                    (p = createNS("feMorphology")).setAttribute("operator", "erode"),
                    p.setAttribute("in", "SourceGraphic"),
                    p.setAttribute("radius", "0"),
                    c.appendChild(p),
                    a.appendChild(c),
                    n.setAttribute("stroke", "s" === d[r].mode ? "#000000" : "#ffffff")) : (p = null,
                    u = null),
                    this.storedData[r] = {
                        elem: n,
                        x: u,
                        expan: p,
                        lastPath: "",
                        lastOperator: "",
                        filterId: _,
                        lastRadius: 0
                    },
                    "i" === d[r].mode) {
                        l = m.length;
                        var b = createNS("g");
                        for (s = 0; s < l; s += 1)
                            b.appendChild(m[s]);
                        var x = createNS("mask");
                        x.setAttribute("mask-type", "alpha"),
                        x.setAttribute("id", g + "_" + f),
                        x.appendChild(n),
                        a.appendChild(x),
                        b.setAttribute("mask", "url(" + locationHref + "#" + g + "_" + f + ")"),
                        m.length = 0,
                        m.push(b)
                    } else
                        m.push(n);
                    d[r].inv && !this.solidPath && (this.solidPath = this.createLayerSolidPath()),
                    this.viewData[r] = {
                        elem: n,
                        lastPath: "",
                        op: PropertyFactory.getProp(this.element, d[r].o, 0, .01, this.element),
                        prop: ShapePropertyFactory.getShapeProp(this.element, d[r], 3),
                        invRect: h
                    },
                    this.viewData[r].prop.k || this.drawPath(d[r], this.viewData[r].prop.v, this.viewData[r])
                }
            for (this.maskElement = createNS(v),
            o = m.length,
            r = 0; r < o; r += 1)
                this.maskElement.appendChild(m[r]);
            f > 0 && (this.maskElement.setAttribute("id", g),
            this.element.maskedElement.setAttribute(y, "url(" + locationHref + "#" + g + ")"),
            a.appendChild(this.maskElement)),
            this.viewData.length && this.element.addRenderableComponent(this)
        }
        function HierarchyElement() {}
        function FrameElement() {}
        function TransformElement() {}
        function RenderableElement() {}
        function RenderableDOMElement() {}
        function ProcessedElement(e, t) {
            this.elem = e,
            this.pos = t
        }
        function SVGStyleData(e, t) {
            this.data = e,
            this.type = e.ty,
            this.d = "",
            this.lvl = t,
            this._mdf = !1,
            this.closed = !0 === e.hd,
            this.pElem = createNS("path"),
            this.msElem = null
        }
        function SVGShapeData(e, t, i) {
            this.caches = [],
            this.styles = [],
            this.transformers = e,
            this.lStr = "",
            this.sh = i,
            this.lvl = t,
            this._isAnimated = !!i.k;
            for (var r = 0, n = e.length; r < n; ) {
                if (e[r].mProps.dynamicProperties.length) {
                    this._isAnimated = !0;
                    break
                }
                r += 1
            }
        }
        function SVGTransformData(e, t, i) {
            this.transform = {
                mProps: e,
                op: t,
                container: i
            },
            this.elements = [],
            this._isAnimated = this.transform.mProps.dynamicProperties.length || this.transform.op.effectsSequence.length
        }
        function SVGStrokeStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.w = PropertyFactory.getProp(e, t.w, 0, null, this),
            this.d = new DashProperty(e,t.d || {},"svg",this),
            this.c = PropertyFactory.getProp(e, t.c, 1, 255, this),
            this.style = i,
            this._isAnimated = !!this._isAnimated
        }
        function SVGFillStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.c = PropertyFactory.getProp(e, t.c, 1, 255, this),
            this.style = i
        }
        function SVGGradientFillStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.initGradientData(e, t, i)
        }
        function SVGGradientStrokeStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.w = PropertyFactory.getProp(e, t.w, 0, null, this),
            this.d = new DashProperty(e,t.d || {},"svg",this),
            this.initGradientData(e, t, i),
            this._isAnimated = !!this._isAnimated
        }
        function ShapeGroupData() {
            this.it = [],
            this.prevViewData = [],
            this.gr = createNS("g")
        }
        BaseRenderer.prototype.checkLayers = function(e) {
            var t, i, r = this.layers.length;
            for (this.completeLayers = !0,
            t = r - 1; t >= 0; t -= 1)
                this.elements[t] || (i = this.layers[t]).ip - i.st <= e - this.layers[t].st && i.op - i.st > e - this.layers[t].st && this.buildItem(t),
                this.completeLayers = !!this.elements[t] && this.completeLayers;
            this.checkPendingElements()
        }
        ,
        BaseRenderer.prototype.createItem = function(e) {
            switch (e.ty) {
            case 2:
                return this.createImage(e);
            case 0:
                return this.createComp(e);
            case 1:
                return this.createSolid(e);
            case 3:
            default:
                return this.createNull(e);
            case 4:
                return this.createShape(e);
            case 5:
                return this.createText(e);
            case 6:
                return this.createAudio(e);
            case 13:
                return this.createCamera(e);
            case 15:
                return this.createFootage(e)
            }
        }
        ,
        BaseRenderer.prototype.createCamera = function() {
            throw new Error("You're using a 3d camera. Try the html renderer.")
        }
        ,
        BaseRenderer.prototype.createAudio = function(e) {
            return new AudioElement(e,this.globalData,this)
        }
        ,
        BaseRenderer.prototype.createFootage = function(e) {
            return new FootageElement(e,this.globalData,this)
        }
        ,
        BaseRenderer.prototype.buildAllItems = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                this.buildItem(e);
            this.checkPendingElements()
        }
        ,
        BaseRenderer.prototype.includeLayers = function(e) {
            var t;
            this.completeLayers = !1;
            var i, r = e.length, n = this.layers.length;
            for (t = 0; t < r; t += 1)
                for (i = 0; i < n; ) {
                    if (this.layers[i].id === e[t].id) {
                        this.layers[i] = e[t];
                        break
                    }
                    i += 1
                }
        }
        ,
        BaseRenderer.prototype.setProjectInterface = function(e) {
            this.globalData.projectInterface = e
        }
        ,
        BaseRenderer.prototype.initItems = function() {
            this.globalData.progressiveLoad || this.buildAllItems()
        }
        ,
        BaseRenderer.prototype.buildElementParenting = function(e, t, i) {
            for (var r = this.elements, n = this.layers, a = 0, o = n.length; a < o; )
                n[a].ind == t && (r[a] && !0 !== r[a] ? (i.push(r[a]),
                r[a].setAsParent(),
                void 0 !== n[a].parent ? this.buildElementParenting(e, n[a].parent, i) : e.setHierarchy(i)) : (this.buildItem(a),
                this.addPendingElement(e))),
                a += 1
        }
        ,
        BaseRenderer.prototype.addPendingElement = function(e) {
            this.pendingElements.push(e)
        }
        ,
        BaseRenderer.prototype.searchExtraCompositions = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                if (e[t].xt) {
                    var r = this.createComp(e[t]);
                    r.initExpressions(),
                    this.globalData.projectInterface.registerComposition(r)
                }
        }
        ,
        BaseRenderer.prototype.setupGlobalData = function(e, t) {
            this.globalData.fontManager = new FontManager,
            this.globalData.fontManager.addChars(e.chars),
            this.globalData.fontManager.addFonts(e.fonts, t),
            this.globalData.getAssetData = this.animationItem.getAssetData.bind(this.animationItem),
            this.globalData.getAssetsPath = this.animationItem.getAssetsPath.bind(this.animationItem),
            this.globalData.imageLoader = this.animationItem.imagePreloader,
            this.globalData.audioController = this.animationItem.audioController,
            this.globalData.frameId = 0,
            this.globalData.frameRate = e.fr,
            this.globalData.nm = e.nm,
            this.globalData.compSize = {
                w: e.w,
                h: e.h
            }
        }
        ,
        extendPrototype([BaseRenderer], SVGRenderer),
        SVGRenderer.prototype.createNull = function(e) {
            return new NullElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.createShape = function(e) {
            return new SVGShapeElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.createText = function(e) {
            return new SVGTextLottieElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.createImage = function(e) {
            return new IImageElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.createComp = function(e) {
            return new SVGCompElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.createSolid = function(e) {
            return new ISolidElement(e,this.globalData,this)
        }
        ,
        SVGRenderer.prototype.configAnimation = function(e) {
            this.svgElement.setAttribute("xmlns", "http://www.w3.org/2000/svg"),
            this.renderConfig.viewBoxSize ? this.svgElement.setAttribute("viewBox", this.renderConfig.viewBoxSize) : this.svgElement.setAttribute("viewBox", "0 0 " + e.w + " " + e.h),
            this.renderConfig.viewBoxOnly || (this.svgElement.setAttribute("width", e.w),
            this.svgElement.setAttribute("height", e.h),
            this.svgElement.style.width = "100%",
            this.svgElement.style.height = "100%",
            this.svgElement.style.transform = "translate3d(0,0,0)",
            this.svgElement.style.contentVisibility = this.renderConfig.contentVisibility),
            this.renderConfig.className && this.svgElement.setAttribute("class", this.renderConfig.className),
            this.renderConfig.id && this.svgElement.setAttribute("id", this.renderConfig.id),
            void 0 !== this.renderConfig.focusable && this.svgElement.setAttribute("focusable", this.renderConfig.focusable),
            this.svgElement.setAttribute("preserveAspectRatio", this.renderConfig.preserveAspectRatio),
            this.animationItem.wrapper.appendChild(this.svgElement);
            var t = this.globalData.defs;
            this.setupGlobalData(e, t),
            this.globalData.progressiveLoad = this.renderConfig.progressiveLoad,
            this.data = e;
            var i = createNS("clipPath")
              , r = createNS("rect");
            r.setAttribute("width", e.w),
            r.setAttribute("height", e.h),
            r.setAttribute("x", 0),
            r.setAttribute("y", 0);
            var n = createElementID();
            i.setAttribute("id", n),
            i.appendChild(r),
            this.layerElement.setAttribute("clip-path", "url(" + locationHref + "#" + n + ")"),
            t.appendChild(i),
            this.layers = e.layers,
            this.elements = createSizedArray(e.layers.length)
        }
        ,
        SVGRenderer.prototype.destroy = function() {
            var e;
            this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            this.layerElement = null,
            this.globalData.defs = null;
            var t = this.layers ? this.layers.length : 0;
            for (e = 0; e < t; e += 1)
                this.elements[e] && this.elements[e].destroy();
            this.elements.length = 0,
            this.destroyed = !0,
            this.animationItem = null
        }
        ,
        SVGRenderer.prototype.updateContainerSize = function() {}
        ,
        SVGRenderer.prototype.buildItem = function(e) {
            var t = this.elements;
            if (!t[e] && 99 !== this.layers[e].ty) {
                t[e] = !0;
                var i = this.createItem(this.layers[e]);
                t[e] = i,
                expressionsPlugin && (0 === this.layers[e].ty && this.globalData.projectInterface.registerComposition(i),
                i.initExpressions()),
                this.appendElementInPos(i, e),
                this.layers[e].tt && (this.elements[e - 1] && !0 !== this.elements[e - 1] ? i.setMatte(t[e - 1].layerId) : (this.buildItem(e - 1),
                this.addPendingElement(i)))
            }
        }
        ,
        SVGRenderer.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; ) {
                var e = this.pendingElements.pop();
                if (e.checkParenting(),
                e.data.tt)
                    for (var t = 0, i = this.elements.length; t < i; ) {
                        if (this.elements[t] === e) {
                            e.setMatte(this.elements[t - 1].layerId);
                            break
                        }
                        t += 1
                    }
            }
        }
        ,
        SVGRenderer.prototype.renderFrame = function(e) {
            if (this.renderedFrame !== e && !this.destroyed) {
                var t;
                null === e ? e = this.renderedFrame : this.renderedFrame = e,
                this.globalData.frameNum = e,
                this.globalData.frameId += 1,
                this.globalData.projectInterface.currentFrame = e,
                this.globalData._mdf = !1;
                var i = this.layers.length;
                for (this.completeLayers || this.checkLayers(e),
                t = i - 1; t >= 0; t -= 1)
                    (this.completeLayers || this.elements[t]) && this.elements[t].prepareFrame(e - this.layers[t].st);
                if (this.globalData._mdf)
                    for (t = 0; t < i; t += 1)
                        (this.completeLayers || this.elements[t]) && this.elements[t].renderFrame()
            }
        }
        ,
        SVGRenderer.prototype.appendElementInPos = function(e, t) {
            var i = e.getBaseElement();
            if (i) {
                for (var r, n = 0; n < t; )
                    this.elements[n] && !0 !== this.elements[n] && this.elements[n].getBaseElement() && (r = this.elements[n].getBaseElement()),
                    n += 1;
                r ? this.layerElement.insertBefore(i, r) : this.layerElement.appendChild(i)
            }
        }
        ,
        SVGRenderer.prototype.hide = function() {
            this.layerElement.style.display = "none"
        }
        ,
        SVGRenderer.prototype.show = function() {
            this.layerElement.style.display = "block"
        }
        ,
        extendPrototype([BaseRenderer], CanvasRenderer),
        CanvasRenderer.prototype.createShape = function(e) {
            return new CVShapeElement(e,this.globalData,this)
        }
        ,
        CanvasRenderer.prototype.createText = function(e) {
            return new CVTextElement(e,this.globalData,this)
        }
        ,
        CanvasRenderer.prototype.createImage = function(e) {
            return new CVImageElement(e,this.globalData,this)
        }
        ,
        CanvasRenderer.prototype.createComp = function(e) {
            return new CVCompElement(e,this.globalData,this)
        }
        ,
        CanvasRenderer.prototype.createSolid = function(e) {
            return new CVSolidElement(e,this.globalData,this)
        }
        ,
        CanvasRenderer.prototype.createNull = SVGRenderer.prototype.createNull,
        CanvasRenderer.prototype.ctxTransform = function(e) {
            if (1 !== e[0] || 0 !== e[1] || 0 !== e[4] || 1 !== e[5] || 0 !== e[12] || 0 !== e[13])
                if (this.renderConfig.clearCanvas) {
                    this.transformMat.cloneFromProps(e);
                    var t = this.contextData.cTr.props;
                    this.transformMat.transform(t[0], t[1], t[2], t[3], t[4], t[5], t[6], t[7], t[8], t[9], t[10], t[11], t[12], t[13], t[14], t[15]),
                    this.contextData.cTr.cloneFromProps(this.transformMat.props);
                    var i = this.contextData.cTr.props;
                    this.canvasContext.setTransform(i[0], i[1], i[4], i[5], i[12], i[13])
                } else
                    this.canvasContext.transform(e[0], e[1], e[4], e[5], e[12], e[13])
        }
        ,
        CanvasRenderer.prototype.ctxOpacity = function(e) {
            if (!this.renderConfig.clearCanvas)
                return this.canvasContext.globalAlpha *= e < 0 ? 0 : e,
                void (this.globalData.currentGlobalAlpha = this.contextData.cO);
            this.contextData.cO *= e < 0 ? 0 : e,
            this.globalData.currentGlobalAlpha !== this.contextData.cO && (this.canvasContext.globalAlpha = this.contextData.cO,
            this.globalData.currentGlobalAlpha = this.contextData.cO)
        }
        ,
        CanvasRenderer.prototype.reset = function() {
            this.renderConfig.clearCanvas ? this.contextData.reset() : this.canvasContext.restore()
        }
        ,
        CanvasRenderer.prototype.save = function(e) {
            if (this.renderConfig.clearCanvas) {
                e && this.canvasContext.save();
                var t, i = this.contextData.cTr.props;
                this.contextData._length <= this.contextData.cArrPos && this.contextData.duplicate();
                var r = this.contextData.saved[this.contextData.cArrPos];
                for (t = 0; t < 16; t += 1)
                    r[t] = i[t];
                this.contextData.savedOp[this.contextData.cArrPos] = this.contextData.cO,
                this.contextData.cArrPos += 1
            } else
                this.canvasContext.save()
        }
        ,
        CanvasRenderer.prototype.restore = function(e) {
            if (this.renderConfig.clearCanvas) {
                e && (this.canvasContext.restore(),
                this.globalData.blendMode = "source-over"),
                this.contextData.cArrPos -= 1;
                var t, i = this.contextData.saved[this.contextData.cArrPos], r = this.contextData.cTr.props;
                for (t = 0; t < 16; t += 1)
                    r[t] = i[t];
                this.canvasContext.setTransform(i[0], i[1], i[4], i[5], i[12], i[13]),
                i = this.contextData.savedOp[this.contextData.cArrPos],
                this.contextData.cO = i,
                this.globalData.currentGlobalAlpha !== i && (this.canvasContext.globalAlpha = i,
                this.globalData.currentGlobalAlpha = i)
            } else
                this.canvasContext.restore()
        }
        ,
        CanvasRenderer.prototype.configAnimation = function(e) {
            if (this.animationItem.wrapper) {
                this.animationItem.container = createTag("canvas");
                var t = this.animationItem.container.style;
                t.width = "100%",
                t.height = "100%";
                var i = "0px 0px 0px";
                t.transformOrigin = i,
                t.mozTransformOrigin = i,
                t.webkitTransformOrigin = i,
                t["-webkit-transform"] = i,
                t.contentVisibility = this.renderConfig.contentVisibility,
                this.animationItem.wrapper.appendChild(this.animationItem.container),
                this.canvasContext = this.animationItem.container.getContext("2d"),
                this.renderConfig.className && this.animationItem.container.setAttribute("class", this.renderConfig.className),
                this.renderConfig.id && this.animationItem.container.setAttribute("id", this.renderConfig.id)
            } else
                this.canvasContext = this.renderConfig.context;
            this.data = e,
            this.layers = e.layers,
            this.transformCanvas = {
                w: e.w,
                h: e.h,
                sx: 0,
                sy: 0,
                tx: 0,
                ty: 0
            },
            this.setupGlobalData(e, document.body),
            this.globalData.canvasContext = this.canvasContext,
            this.globalData.renderer = this,
            this.globalData.isDashed = !1,
            this.globalData.progressiveLoad = this.renderConfig.progressiveLoad,
            this.globalData.transformCanvas = this.transformCanvas,
            this.elements = createSizedArray(e.layers.length),
            this.updateContainerSize()
        }
        ,
        CanvasRenderer.prototype.updateContainerSize = function() {
            var e, t, i, r;
            if (this.reset(),
            this.animationItem.wrapper && this.animationItem.container ? (e = this.animationItem.wrapper.offsetWidth,
            t = this.animationItem.wrapper.offsetHeight,
            this.animationItem.container.setAttribute("width", e * this.renderConfig.dpr),
            this.animationItem.container.setAttribute("height", t * this.renderConfig.dpr)) : (e = this.canvasContext.canvas.width * this.renderConfig.dpr,
            t = this.canvasContext.canvas.height * this.renderConfig.dpr),
            -1 !== this.renderConfig.preserveAspectRatio.indexOf("meet") || -1 !== this.renderConfig.preserveAspectRatio.indexOf("slice")) {
                var n = this.renderConfig.preserveAspectRatio.split(" ")
                  , a = n[1] || "meet"
                  , o = n[0] || "xMidYMid"
                  , s = o.substr(0, 4)
                  , l = o.substr(4);
                i = e / t,
                (r = this.transformCanvas.w / this.transformCanvas.h) > i && "meet" === a || r < i && "slice" === a ? (this.transformCanvas.sx = e / (this.transformCanvas.w / this.renderConfig.dpr),
                this.transformCanvas.sy = e / (this.transformCanvas.w / this.renderConfig.dpr)) : (this.transformCanvas.sx = t / (this.transformCanvas.h / this.renderConfig.dpr),
                this.transformCanvas.sy = t / (this.transformCanvas.h / this.renderConfig.dpr)),
                this.transformCanvas.tx = "xMid" === s && (r < i && "meet" === a || r > i && "slice" === a) ? (e - this.transformCanvas.w * (t / this.transformCanvas.h)) / 2 * this.renderConfig.dpr : "xMax" === s && (r < i && "meet" === a || r > i && "slice" === a) ? (e - this.transformCanvas.w * (t / this.transformCanvas.h)) * this.renderConfig.dpr : 0,
                this.transformCanvas.ty = "YMid" === l && (r > i && "meet" === a || r < i && "slice" === a) ? (t - this.transformCanvas.h * (e / this.transformCanvas.w)) / 2 * this.renderConfig.dpr : "YMax" === l && (r > i && "meet" === a || r < i && "slice" === a) ? (t - this.transformCanvas.h * (e / this.transformCanvas.w)) * this.renderConfig.dpr : 0
            } else
                "none" === this.renderConfig.preserveAspectRatio ? (this.transformCanvas.sx = e / (this.transformCanvas.w / this.renderConfig.dpr),
                this.transformCanvas.sy = t / (this.transformCanvas.h / this.renderConfig.dpr),
                this.transformCanvas.tx = 0,
                this.transformCanvas.ty = 0) : (this.transformCanvas.sx = this.renderConfig.dpr,
                this.transformCanvas.sy = this.renderConfig.dpr,
                this.transformCanvas.tx = 0,
                this.transformCanvas.ty = 0);
            this.transformCanvas.props = [this.transformCanvas.sx, 0, 0, 0, 0, this.transformCanvas.sy, 0, 0, 0, 0, 1, 0, this.transformCanvas.tx, this.transformCanvas.ty, 0, 1],
            this.ctxTransform(this.transformCanvas.props),
            this.canvasContext.beginPath(),
            this.canvasContext.rect(0, 0, this.transformCanvas.w, this.transformCanvas.h),
            this.canvasContext.closePath(),
            this.canvasContext.clip(),
            this.renderFrame(this.renderedFrame, !0)
        }
        ,
        CanvasRenderer.prototype.destroy = function() {
            var e;
            for (this.renderConfig.clearCanvas && this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            e = (this.layers ? this.layers.length : 0) - 1; e >= 0; e -= 1)
                this.elements[e] && this.elements[e].destroy();
            this.elements.length = 0,
            this.globalData.canvasContext = null,
            this.animationItem.container = null,
            this.destroyed = !0
        }
        ,
        CanvasRenderer.prototype.renderFrame = function(e, t) {
            if ((this.renderedFrame !== e || !0 !== this.renderConfig.clearCanvas || t) && !this.destroyed && -1 !== e) {
                var i;
                this.renderedFrame = e,
                this.globalData.frameNum = e - this.animationItem._isFirstFrame,
                this.globalData.frameId += 1,
                this.globalData._mdf = !this.renderConfig.clearCanvas || t,
                this.globalData.projectInterface.currentFrame = e;
                var r = this.layers.length;
                for (this.completeLayers || this.checkLayers(e),
                i = 0; i < r; i += 1)
                    (this.completeLayers || this.elements[i]) && this.elements[i].prepareFrame(e - this.layers[i].st);
                if (this.globalData._mdf) {
                    for (!0 === this.renderConfig.clearCanvas ? this.canvasContext.clearRect(0, 0, this.transformCanvas.w, this.transformCanvas.h) : this.save(),
                    i = r - 1; i >= 0; i -= 1)
                        (this.completeLayers || this.elements[i]) && this.elements[i].renderFrame();
                    !0 !== this.renderConfig.clearCanvas && this.restore()
                }
            }
        }
        ,
        CanvasRenderer.prototype.buildItem = function(e) {
            var t = this.elements;
            if (!t[e] && 99 !== this.layers[e].ty) {
                var i = this.createItem(this.layers[e], this, this.globalData);
                t[e] = i,
                i.initExpressions()
            }
        }
        ,
        CanvasRenderer.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; )
                this.pendingElements.pop().checkParenting()
        }
        ,
        CanvasRenderer.prototype.hide = function() {
            this.animationItem.container.style.display = "none"
        }
        ,
        CanvasRenderer.prototype.show = function() {
            this.animationItem.container.style.display = "block"
        }
        ,
        extendPrototype([BaseRenderer], HybridRenderer),
        HybridRenderer.prototype.buildItem = SVGRenderer.prototype.buildItem,
        HybridRenderer.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; )
                this.pendingElements.pop().checkParenting()
        }
        ,
        HybridRenderer.prototype.appendElementInPos = function(e, t) {
            var i = e.getBaseElement();
            if (i) {
                var r = this.layers[t];
                if (r.ddd && this.supports3d)
                    this.addTo3dContainer(i, t);
                else if (this.threeDElements)
                    this.addTo3dContainer(i, t);
                else {
                    for (var n, a, o = 0; o < t; )
                        this.elements[o] && !0 !== this.elements[o] && this.elements[o].getBaseElement && (a = this.elements[o],
                        n = (this.layers[o].ddd ? this.getThreeDContainerByPos(o) : a.getBaseElement()) || n),
                        o += 1;
                    n ? r.ddd && this.supports3d || this.layerElement.insertBefore(i, n) : r.ddd && this.supports3d || this.layerElement.appendChild(i)
                }
            }
        }
        ,
        HybridRenderer.prototype.createShape = function(e) {
            return this.supports3d ? new HShapeElement(e,this.globalData,this) : new SVGShapeElement(e,this.globalData,this)
        }
        ,
        HybridRenderer.prototype.createText = function(e) {
            return this.supports3d ? new HTextElement(e,this.globalData,this) : new SVGTextLottieElement(e,this.globalData,this)
        }
        ,
        HybridRenderer.prototype.createCamera = function(e) {
            return this.camera = new HCameraElement(e,this.globalData,this),
            this.camera
        }
        ,
        HybridRenderer.prototype.createImage = function(e) {
            return this.supports3d ? new HImageElement(e,this.globalData,this) : new IImageElement(e,this.globalData,this)
        }
        ,
        HybridRenderer.prototype.createComp = function(e) {
            return this.supports3d ? new HCompElement(e,this.globalData,this) : new SVGCompElement(e,this.globalData,this)
        }
        ,
        HybridRenderer.prototype.createSolid = function(e) {
            return this.supports3d ? new HSolidElement(e,this.globalData,this) : new ISolidElement(e,this.globalData,this)
        }
        ,
        HybridRenderer.prototype.createNull = SVGRenderer.prototype.createNull,
        HybridRenderer.prototype.getThreeDContainerByPos = function(e) {
            for (var t = 0, i = this.threeDElements.length; t < i; ) {
                if (this.threeDElements[t].startPos <= e && this.threeDElements[t].endPos >= e)
                    return this.threeDElements[t].perspectiveElem;
                t += 1
            }
            return null
        }
        ,
        HybridRenderer.prototype.createThreeDContainer = function(e, t) {
            var i, r, n = createTag("div");
            styleDiv(n);
            var a = createTag("div");
            if (styleDiv(a),
            "3d" === t) {
                (i = n.style).width = this.globalData.compSize.w + "px",
                i.height = this.globalData.compSize.h + "px";
                var o = "50% 50%";
                i.webkitTransformOrigin = o,
                i.mozTransformOrigin = o,
                i.transformOrigin = o;
                var s = "matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";
                (r = a.style).transform = s,
                r.webkitTransform = s
            }
            n.appendChild(a);
            var l = {
                container: a,
                perspectiveElem: n,
                startPos: e,
                endPos: e,
                type: t
            };
            return this.threeDElements.push(l),
            l
        }
        ,
        HybridRenderer.prototype.build3dContainers = function() {
            var e, t, i = this.layers.length, r = "";
            for (e = 0; e < i; e += 1)
                this.layers[e].ddd && 3 !== this.layers[e].ty ? ("3d" !== r && (r = "3d",
                t = this.createThreeDContainer(e, "3d")),
                t.endPos = Math.max(t.endPos, e)) : ("2d" !== r && (r = "2d",
                t = this.createThreeDContainer(e, "2d")),
                t.endPos = Math.max(t.endPos, e));
            for (e = (i = this.threeDElements.length) - 1; e >= 0; e -= 1)
                this.resizerElem.appendChild(this.threeDElements[e].perspectiveElem)
        }
        ,
        HybridRenderer.prototype.addTo3dContainer = function(e, t) {
            for (var i = 0, r = this.threeDElements.length; i < r; ) {
                if (t <= this.threeDElements[i].endPos) {
                    for (var n, a = this.threeDElements[i].startPos; a < t; )
                        this.elements[a] && this.elements[a].getBaseElement && (n = this.elements[a].getBaseElement()),
                        a += 1;
                    n ? this.threeDElements[i].container.insertBefore(e, n) : this.threeDElements[i].container.appendChild(e);
                    break
                }
                i += 1
            }
        }
        ,
        HybridRenderer.prototype.configAnimation = function(e) {
            var t = createTag("div")
              , i = this.animationItem.wrapper
              , r = t.style;
            r.width = e.w + "px",
            r.height = e.h + "px",
            this.resizerElem = t,
            styleDiv(t),
            r.transformStyle = "flat",
            r.mozTransformStyle = "flat",
            r.webkitTransformStyle = "flat",
            this.renderConfig.className && t.setAttribute("class", this.renderConfig.className),
            i.appendChild(t),
            r.overflow = "hidden";
            var n = createNS("svg");
            n.setAttribute("width", "1"),
            n.setAttribute("height", "1"),
            styleDiv(n),
            this.resizerElem.appendChild(n);
            var a = createNS("defs");
            n.appendChild(a),
            this.data = e,
            this.setupGlobalData(e, n),
            this.globalData.defs = a,
            this.layers = e.layers,
            this.layerElement = this.resizerElem,
            this.build3dContainers(),
            this.updateContainerSize()
        }
        ,
        HybridRenderer.prototype.destroy = function() {
            var e;
            this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            this.animationItem.container = null,
            this.globalData.defs = null;
            var t = this.layers ? this.layers.length : 0;
            for (e = 0; e < t; e += 1)
                this.elements[e].destroy();
            this.elements.length = 0,
            this.destroyed = !0,
            this.animationItem = null
        }
        ,
        HybridRenderer.prototype.updateContainerSize = function() {
            var e, t, i, r, n = this.animationItem.wrapper.offsetWidth, a = this.animationItem.wrapper.offsetHeight, o = n / a;
            this.globalData.compSize.w / this.globalData.compSize.h > o ? (e = n / this.globalData.compSize.w,
            t = n / this.globalData.compSize.w,
            i = 0,
            r = (a - this.globalData.compSize.h * (n / this.globalData.compSize.w)) / 2) : (e = a / this.globalData.compSize.h,
            t = a / this.globalData.compSize.h,
            i = (n - this.globalData.compSize.w * (a / this.globalData.compSize.h)) / 2,
            r = 0);
            var s = this.resizerElem.style;
            s.webkitTransform = "matrix3d(" + e + ",0,0,0,0," + t + ",0,0,0,0,1,0," + i + "," + r + ",0,1)",
            s.transform = s.webkitTransform
        }
        ,
        HybridRenderer.prototype.renderFrame = SVGRenderer.prototype.renderFrame,
        HybridRenderer.prototype.hide = function() {
            this.resizerElem.style.display = "none"
        }
        ,
        HybridRenderer.prototype.show = function() {
            this.resizerElem.style.display = "block"
        }
        ,
        HybridRenderer.prototype.initItems = function() {
            if (this.buildAllItems(),
            this.camera)
                this.camera.setup();
            else {
                var e, t = this.globalData.compSize.w, i = this.globalData.compSize.h, r = this.threeDElements.length;
                for (e = 0; e < r; e += 1) {
                    var n = this.threeDElements[e].perspectiveElem.style;
                    n.webkitPerspective = Math.sqrt(Math.pow(t, 2) + Math.pow(i, 2)) + "px",
                    n.perspective = n.webkitPerspective
                }
            }
        }
        ,
        HybridRenderer.prototype.searchExtraCompositions = function(e) {
            var t, i = e.length, r = createTag("div");
            for (t = 0; t < i; t += 1)
                if (e[t].xt) {
                    var n = this.createComp(e[t], r, this.globalData.comp, null);
                    n.initExpressions(),
                    this.globalData.projectInterface.registerComposition(n)
                }
        }
        ,
        MaskElement.prototype.getMaskProperty = function(e) {
            return this.viewData[e].prop
        }
        ,
        MaskElement.prototype.renderFrame = function(e) {
            var t, i = this.element.finalTransform.mat, r = this.masksProperties.length;
            for (t = 0; t < r; t += 1)
                if ((this.viewData[t].prop._mdf || e) && this.drawPath(this.masksProperties[t], this.viewData[t].prop.v, this.viewData[t]),
                (this.viewData[t].op._mdf || e) && this.viewData[t].elem.setAttribute("fill-opacity", this.viewData[t].op.v),
                "n" !== this.masksProperties[t].mode && (this.viewData[t].invRect && (this.element.finalTransform.mProp._mdf || e) && this.viewData[t].invRect.setAttribute("transform", i.getInverseMatrix().to2dCSS()),
                this.storedData[t].x && (this.storedData[t].x._mdf || e))) {
                    var n = this.storedData[t].expan;
                    this.storedData[t].x.v < 0 ? ("erode" !== this.storedData[t].lastOperator && (this.storedData[t].lastOperator = "erode",
                    this.storedData[t].elem.setAttribute("filter", "url(" + locationHref + "#" + this.storedData[t].filterId + ")")),
                    n.setAttribute("radius", -this.storedData[t].x.v)) : ("dilate" !== this.storedData[t].lastOperator && (this.storedData[t].lastOperator = "dilate",
                    this.storedData[t].elem.setAttribute("filter", null)),
                    this.storedData[t].elem.setAttribute("stroke-width", 2 * this.storedData[t].x.v))
                }
        }
        ,
        MaskElement.prototype.getMaskelement = function() {
            return this.maskElement
        }
        ,
        MaskElement.prototype.createLayerSolidPath = function() {
            var e = "M0,0 ";
            return e += " h" + this.globalData.compSize.w,
            e += " v" + this.globalData.compSize.h,
            (e += " h-" + this.globalData.compSize.w) + " v-" + this.globalData.compSize.h + " "
        }
        ,
        MaskElement.prototype.drawPath = function(e, t, i) {
            var r, n, a = " M" + t.v[0][0] + "," + t.v[0][1];
            for (n = t._length,
            r = 1; r < n; r += 1)
                a += " C" + t.o[r - 1][0] + "," + t.o[r - 1][1] + " " + t.i[r][0] + "," + t.i[r][1] + " " + t.v[r][0] + "," + t.v[r][1];
            if (t.c && n > 1 && (a += " C" + t.o[r - 1][0] + "," + t.o[r - 1][1] + " " + t.i[0][0] + "," + t.i[0][1] + " " + t.v[0][0] + "," + t.v[0][1]),
            i.lastPath !== a) {
                var o = "";
                i.elem && (t.c && (o = e.inv ? this.solidPath + a : a),
                i.elem.setAttribute("d", o)),
                i.lastPath = a
            }
        }
        ,
        MaskElement.prototype.destroy = function() {
            this.element = null,
            this.globalData = null,
            this.maskElement = null,
            this.data = null,
            this.masksProperties = null
        }
        ,
        HierarchyElement.prototype = {
            initHierarchy: function() {
                this.hierarchy = [],
                this._isParent = !1,
                this.checkParenting()
            },
            setHierarchy: function(e) {
                this.hierarchy = e
            },
            setAsParent: function() {
                this._isParent = !0
            },
            checkParenting: function() {
                void 0 !== this.data.parent && this.comp.buildElementParenting(this, this.data.parent, [])
            }
        },
        FrameElement.prototype = {
            initFrame: function() {
                this._isFirstFrame = !1,
                this.dynamicProperties = [],
                this._mdf = !1
            },
            prepareProperties: function(e, t) {
                var i, r = this.dynamicProperties.length;
                for (i = 0; i < r; i += 1)
                    (t || this._isParent && "transform" === this.dynamicProperties[i].propType) && (this.dynamicProperties[i].getValue(),
                    this.dynamicProperties[i]._mdf && (this.globalData._mdf = !0,
                    this._mdf = !0))
            },
            addDynamicProperty: function(e) {
                -1 === this.dynamicProperties.indexOf(e) && this.dynamicProperties.push(e)
            }
        },
        TransformElement.prototype = {
            initTransform: function() {
                this.finalTransform = {
                    mProp: this.data.ks ? TransformPropertyFactory.getTransformProperty(this, this.data.ks, this) : {
                        o: 0
                    },
                    _matMdf: !1,
                    _opMdf: !1,
                    mat: new Matrix
                },
                this.data.ao && (this.finalTransform.mProp.autoOriented = !0),
                this.data.ty
            },
            renderTransform: function() {
                if (this.finalTransform._opMdf = this.finalTransform.mProp.o._mdf || this._isFirstFrame,
                this.finalTransform._matMdf = this.finalTransform.mProp._mdf || this._isFirstFrame,
                this.hierarchy) {
                    var e, t = this.finalTransform.mat, i = 0, r = this.hierarchy.length;
                    if (!this.finalTransform._matMdf)
                        for (; i < r; ) {
                            if (this.hierarchy[i].finalTransform.mProp._mdf) {
                                this.finalTransform._matMdf = !0;
                                break
                            }
                            i += 1
                        }
                    if (this.finalTransform._matMdf)
                        for (e = this.finalTransform.mProp.v.props,
                        t.cloneFromProps(e),
                        i = 0; i < r; i += 1)
                            e = this.hierarchy[i].finalTransform.mProp.v.props,
                            t.transform(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11], e[12], e[13], e[14], e[15])
                }
            },
            globalToLocal: function(e) {
                var t = [];
                t.push(this.finalTransform);
                for (var i, r = !0, n = this.comp; r; )
                    n.finalTransform ? (n.data.hasMask && t.splice(0, 0, n.finalTransform),
                    n = n.comp) : r = !1;
                var a, o = t.length;
                for (i = 0; i < o; i += 1)
                    a = t[i].mat.applyToPointArray(0, 0, 0),
                    e = [e[0] - a[0], e[1] - a[1], 0];
                return e
            },
            mHelper: new Matrix
        },
        RenderableElement.prototype = {
            initRenderable: function() {
                this.isInRange = !1,
                this.hidden = !1,
                this.isTransparent = !1,
                this.renderableComponents = []
            },
            addRenderableComponent: function(e) {
                -1 === this.renderableComponents.indexOf(e) && this.renderableComponents.push(e)
            },
            removeRenderableComponent: function(e) {
                -1 !== this.renderableComponents.indexOf(e) && this.renderableComponents.splice(this.renderableComponents.indexOf(e), 1)
            },
            prepareRenderableFrame: function(e) {
                this.checkLayerLimits(e)
            },
            checkTransparency: function() {
                this.finalTransform.mProp.o.v <= 0 ? !this.isTransparent && this.globalData.renderConfig.hideOnTransparent && (this.isTransparent = !0,
                this.hide()) : this.isTransparent && (this.isTransparent = !1,
                this.show())
            },
            checkLayerLimits: function(e) {
                this.data.ip - this.data.st <= e && this.data.op - this.data.st > e ? !0 !== this.isInRange && (this.globalData._mdf = !0,
                this._mdf = !0,
                this.isInRange = !0,
                this.show()) : !1 !== this.isInRange && (this.globalData._mdf = !0,
                this.isInRange = !1,
                this.hide())
            },
            renderRenderable: function() {
                var e, t = this.renderableComponents.length;
                for (e = 0; e < t; e += 1)
                    this.renderableComponents[e].renderFrame(this._isFirstFrame)
            },
            sourceRectAtTime: function() {
                return {
                    top: 0,
                    left: 0,
                    width: 100,
                    height: 100
                }
            },
            getLayerSize: function() {
                return 5 === this.data.ty ? {
                    w: this.data.textData.width,
                    h: this.data.textData.height
                } : {
                    w: this.data.width,
                    h: this.data.height
                }
            }
        },
        extendPrototype([RenderableElement, createProxyFunction({
            initElement: function(e, t, i) {
                this.initFrame(),
                this.initBaseData(e, t, i),
                this.initTransform(e, t, i),
                this.initHierarchy(),
                this.initRenderable(),
                this.initRendererElement(),
                this.createContainerElements(),
                this.createRenderableComponents(),
                this.createContent(),
                this.hide()
            },
            hide: function() {
                this.hidden || this.isInRange && !this.isTransparent || ((this.baseElement || this.layerElement).style.display = "none",
                this.hidden = !0)
            },
            show: function() {
                this.isInRange && !this.isTransparent && (this.data.hd || ((this.baseElement || this.layerElement).style.display = "block"),
                this.hidden = !1,
                this._isFirstFrame = !0)
            },
            renderFrame: function() {
                this.data.hd || this.hidden || (this.renderTransform(),
                this.renderRenderable(),
                this.renderElement(),
                this.renderInnerContent(),
                this._isFirstFrame && (this._isFirstFrame = !1))
            },
            renderInnerContent: function() {},
            prepareFrame: function(e) {
                this._mdf = !1,
                this.prepareRenderableFrame(e),
                this.prepareProperties(e, this.isInRange),
                this.checkTransparency()
            },
            destroy: function() {
                this.innerElem = null,
                this.destroyBaseElement()
            }
        })], RenderableDOMElement),
        SVGStyleData.prototype.reset = function() {
            this.d = "",
            this._mdf = !1
        }
        ,
        SVGShapeData.prototype.setAsAnimated = function() {
            this._isAnimated = !0
        }
        ,
        extendPrototype([DynamicPropertyContainer], SVGStrokeStyleData),
        extendPrototype([DynamicPropertyContainer], SVGFillStyleData),
        SVGGradientFillStyleData.prototype.initGradientData = function(e, t, i) {
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.s = PropertyFactory.getProp(e, t.s, 1, null, this),
            this.e = PropertyFactory.getProp(e, t.e, 1, null, this),
            this.h = PropertyFactory.getProp(e, t.h || {
                k: 0
            }, 0, .01, this),
            this.a = PropertyFactory.getProp(e, t.a || {
                k: 0
            }, 0, degToRads, this),
            this.g = new GradientProperty(e,t.g,this),
            this.style = i,
            this.stops = [],
            this.setGradientData(i.pElem, t),
            this.setGradientOpacity(t, i),
            this._isAnimated = !!this._isAnimated
        }
        ,
        SVGGradientFillStyleData.prototype.setGradientData = function(e, t) {
            var i = createElementID()
              , r = createNS(1 === t.t ? "linearGradient" : "radialGradient");
            r.setAttribute("id", i),
            r.setAttribute("spreadMethod", "pad"),
            r.setAttribute("gradientUnits", "userSpaceOnUse");
            var n, a, o, s = [];
            for (o = 4 * t.g.p,
            a = 0; a < o; a += 4)
                n = createNS("stop"),
                r.appendChild(n),
                s.push(n);
            e.setAttribute("gf" === t.ty ? "fill" : "stroke", "url(" + locationHref + "#" + i + ")"),
            this.gf = r,
            this.cst = s
        }
        ,
        SVGGradientFillStyleData.prototype.setGradientOpacity = function(e, t) {
            if (this.g._hasOpacity && !this.g._collapsable) {
                var i, r, n, a = createNS("mask"), o = createNS("path");
                a.appendChild(o);
                var s = createElementID()
                  , l = createElementID();
                a.setAttribute("id", l);
                var h = createNS(1 === e.t ? "linearGradient" : "radialGradient");
                h.setAttribute("id", s),
                h.setAttribute("spreadMethod", "pad"),
                h.setAttribute("gradientUnits", "userSpaceOnUse"),
                n = e.g.k.k[0].s ? e.g.k.k[0].s.length : e.g.k.k.length;
                var c = this.stops;
                for (r = 4 * e.g.p; r < n; r += 2)
                    (i = createNS("stop")).setAttribute("stop-color", "rgb(255,255,255)"),
                    h.appendChild(i),
                    c.push(i);
                o.setAttribute("gf" === e.ty ? "fill" : "stroke", "url(" + locationHref + "#" + s + ")"),
                "gs" === e.ty && (o.setAttribute("stroke-linecap", lineCapEnum[e.lc || 2]),
                o.setAttribute("stroke-linejoin", lineJoinEnum[e.lj || 2]),
                1 === e.lj && o.setAttribute("stroke-miterlimit", e.ml)),
                this.of = h,
                this.ms = a,
                this.ost = c,
                this.maskId = l,
                t.msElem = o
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], SVGGradientFillStyleData),
        extendPrototype([SVGGradientFillStyleData, DynamicPropertyContainer], SVGGradientStrokeStyleData);
        var SVGElementsRenderer = function() {
            var e = new Matrix
              , t = new Matrix;
            function i(e, t, i) {
                (i || t.transform.op._mdf) && t.transform.container.setAttribute("opacity", t.transform.op.v),
                (i || t.transform.mProps._mdf) && t.transform.container.setAttribute("transform", t.transform.mProps.v.to2dCSS())
            }
            function r(i, r, n) {
                var a, o, s, l, h, c, p, u, d, f, m, g = r.styles.length, v = r.lvl;
                for (c = 0; c < g; c += 1) {
                    if (l = r.sh._mdf || n,
                    r.styles[c].lvl < v) {
                        for (u = t.reset(),
                        f = v - r.styles[c].lvl,
                        m = r.transformers.length - 1; !l && f > 0; )
                            l = r.transformers[m].mProps._mdf || l,
                            f -= 1,
                            m -= 1;
                        if (l)
                            for (f = v - r.styles[c].lvl,
                            m = r.transformers.length - 1; f > 0; )
                                d = r.transformers[m].mProps.v.props,
                                u.transform(d[0], d[1], d[2], d[3], d[4], d[5], d[6], d[7], d[8], d[9], d[10], d[11], d[12], d[13], d[14], d[15]),
                                f -= 1,
                                m -= 1
                    } else
                        u = e;
                    if (o = (p = r.sh.paths)._length,
                    l) {
                        for (s = "",
                        a = 0; a < o; a += 1)
                            (h = p.shapes[a]) && h._length && (s += buildShapeString(h, h._length, h.c, u));
                        r.caches[c] = s
                    } else
                        s = r.caches[c];
                    r.styles[c].d += !0 === i.hd ? "" : s,
                    r.styles[c]._mdf = l || r.styles[c]._mdf
                }
            }
            function n(e, t, i) {
                var r = t.style;
                (t.c._mdf || i) && r.pElem.setAttribute("fill", "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
                (t.o._mdf || i) && r.pElem.setAttribute("fill-opacity", t.o.v)
            }
            function a(e, t, i) {
                o(e, t, i),
                s(0, t, i)
            }
            function o(e, t, i) {
                var r, n, a, o, s, l = t.gf, h = t.g._hasOpacity, c = t.s.v, p = t.e.v;
                if (t.o._mdf || i) {
                    var u = "gf" === e.ty ? "fill-opacity" : "stroke-opacity";
                    t.style.pElem.setAttribute(u, t.o.v)
                }
                if (t.s._mdf || i) {
                    var d = 1 === e.t ? "x1" : "cx"
                      , f = "x1" === d ? "y1" : "cy";
                    l.setAttribute(d, c[0]),
                    l.setAttribute(f, c[1]),
                    h && !t.g._collapsable && (t.of.setAttribute(d, c[0]),
                    t.of.setAttribute(f, c[1]))
                }
                if (t.g._cmdf || i) {
                    r = t.cst;
                    var m = t.g.c;
                    for (a = r.length,
                    n = 0; n < a; n += 1)
                        (o = r[n]).setAttribute("offset", m[4 * n] + "%"),
                        o.setAttribute("stop-color", "rgb(" + m[4 * n + 1] + "," + m[4 * n + 2] + "," + m[4 * n + 3] + ")")
                }
                if (h && (t.g._omdf || i)) {
                    var g = t.g.o;
                    for (a = (r = t.g._collapsable ? t.cst : t.ost).length,
                    n = 0; n < a; n += 1)
                        o = r[n],
                        t.g._collapsable || o.setAttribute("offset", g[2 * n] + "%"),
                        o.setAttribute("stop-opacity", g[2 * n + 1])
                }
                if (1 === e.t)
                    (t.e._mdf || i) && (l.setAttribute("x2", p[0]),
                    l.setAttribute("y2", p[1]),
                    h && !t.g._collapsable && (t.of.setAttribute("x2", p[0]),
                    t.of.setAttribute("y2", p[1])));
                else if ((t.s._mdf || t.e._mdf || i) && (s = Math.sqrt(Math.pow(c[0] - p[0], 2) + Math.pow(c[1] - p[1], 2)),
                l.setAttribute("r", s),
                h && !t.g._collapsable && t.of.setAttribute("r", s)),
                t.e._mdf || t.h._mdf || t.a._mdf || i) {
                    s || (s = Math.sqrt(Math.pow(c[0] - p[0], 2) + Math.pow(c[1] - p[1], 2)));
                    var v = Math.atan2(p[1] - c[1], p[0] - c[0])
                      , y = t.h.v;
                    y >= 1 ? y = .99 : y <= -1 && (y = -.99);
                    var _ = s * y
                      , b = Math.cos(v + t.a.v) * _ + c[0]
                      , x = Math.sin(v + t.a.v) * _ + c[1];
                    l.setAttribute("fx", b),
                    l.setAttribute("fy", x),
                    h && !t.g._collapsable && (t.of.setAttribute("fx", b),
                    t.of.setAttribute("fy", x))
                }
            }
            function s(e, t, i) {
                var r = t.style
                  , n = t.d;
                n && (n._mdf || i) && n.dashStr && (r.pElem.setAttribute("stroke-dasharray", n.dashStr),
                r.pElem.setAttribute("stroke-dashoffset", n.dashoffset[0])),
                t.c && (t.c._mdf || i) && r.pElem.setAttribute("stroke", "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
                (t.o._mdf || i) && r.pElem.setAttribute("stroke-opacity", t.o.v),
                (t.w._mdf || i) && (r.pElem.setAttribute("stroke-width", t.w.v),
                r.msElem && r.msElem.setAttribute("stroke-width", t.w.v))
            }
            return {
                createRenderFunction: function(e) {
                    switch (e.ty) {
                    case "fl":
                        return n;
                    case "gf":
                        return o;
                    case "gs":
                        return a;
                    case "st":
                        return s;
                    case "sh":
                    case "el":
                    case "rc":
                    case "sr":
                        return r;
                    case "tr":
                        return i;
                    default:
                        return null
                    }
                }
            }
        }();
        function ShapeTransformManager() {
            this.sequences = {},
            this.sequenceList = [],
            this.transform_key_count = 0
        }
        function CVShapeData(e, t, i, r) {
            this.styledShapes = [],
            this.tr = [0, 0, 0, 0, 0, 0];
            var n, a = 4;
            "rc" === t.ty ? a = 5 : "el" === t.ty ? a = 6 : "sr" === t.ty && (a = 7),
            this.sh = ShapePropertyFactory.getShapeProp(e, t, a, e);
            var o, s = i.length;
            for (n = 0; n < s; n += 1)
                i[n].closed || (o = {
                    transforms: r.addTransformSequence(i[n].transforms),
                    trNodes: []
                },
                this.styledShapes.push(o),
                i[n].elements.push(o))
        }
        function BaseElement() {}
        function NullElement(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initFrame(),
            this.initTransform(e, t, i),
            this.initHierarchy()
        }
        function SVGBaseElement() {}
        function IShapeElement() {}
        function ITextElement() {}
        function ICompElement() {}
        function IImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.initElement(e, t, i),
            this.sourceRect = {
                top: 0,
                left: 0,
                width: this.assetData.w,
                height: this.assetData.h
            }
        }
        function ISolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function AudioElement(e, t, i) {
            this.initFrame(),
            this.initRenderable(),
            this.assetData = t.getAssetData(e.refId),
            this.initBaseData(e, t, i),
            this._isPlaying = !1,
            this._canPlay = !1;
            var r = this.globalData.getAssetsPath(this.assetData);
            this.audio = this.globalData.audioController.createAudio(r),
            this._currentTime = 0,
            this.globalData.audioController.addAudio(this),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function FootageElement(e, t, i) {
            this.initFrame(),
            this.initRenderable(),
            this.assetData = t.getAssetData(e.refId),
            this.footageData = t.imageLoader.getAsset(this.assetData),
            this.initBaseData(e, t, i)
        }
        function SVGCompElement(e, t, i) {
            this.layers = e.layers,
            this.supports3d = !0,
            this.completeLayers = !1,
            this.pendingElements = [],
            this.elements = this.layers ? createSizedArray(this.layers.length) : [],
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function SVGTextLottieElement(e, t, i) {
            this.textSpans = [],
            this.renderType = "svg",
            this.initElement(e, t, i)
        }
        function SVGShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.shapeModifiers = [],
            this.itemsData = [],
            this.processedElements = [],
            this.animatedContents = [],
            this.initElement(e, t, i),
            this.prevViewData = []
        }
        function SVGTintFilter(e, t) {
            this.filterManager = t;
            var i = createNS("feColorMatrix");
            if (i.setAttribute("type", "matrix"),
            i.setAttribute("color-interpolation-filters", "linearRGB"),
            i.setAttribute("values", "0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),
            i.setAttribute("result", "f1"),
            e.appendChild(i),
            (i = createNS("feColorMatrix")).setAttribute("type", "matrix"),
            i.setAttribute("color-interpolation-filters", "sRGB"),
            i.setAttribute("values", "1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),
            i.setAttribute("result", "f2"),
            e.appendChild(i),
            this.matrixFilter = i,
            100 !== t.effectElements[2].p.v || t.effectElements[2].p.k) {
                var r, n = createNS("feMerge");
                e.appendChild(n),
                (r = createNS("feMergeNode")).setAttribute("in", "SourceGraphic"),
                n.appendChild(r),
                (r = createNS("feMergeNode")).setAttribute("in", "f2"),
                n.appendChild(r)
            }
        }
        function SVGFillFilter(e, t) {
            this.filterManager = t;
            var i = createNS("feColorMatrix");
            i.setAttribute("type", "matrix"),
            i.setAttribute("color-interpolation-filters", "sRGB"),
            i.setAttribute("values", "1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),
            e.appendChild(i),
            this.matrixFilter = i
        }
        function SVGGaussianBlurEffect(e, t) {
            e.setAttribute("x", "-100%"),
            e.setAttribute("y", "-100%"),
            e.setAttribute("width", "300%"),
            e.setAttribute("height", "300%"),
            this.filterManager = t;
            var i = createNS("feGaussianBlur");
            e.appendChild(i),
            this.feGaussianBlur = i
        }
        function SVGStrokeEffect(e, t) {
            this.initialized = !1,
            this.filterManager = t,
            this.elem = e,
            this.paths = []
        }
        function SVGTritoneFilter(e, t) {
            this.filterManager = t;
            var i = createNS("feColorMatrix");
            i.setAttribute("type", "matrix"),
            i.setAttribute("color-interpolation-filters", "linearRGB"),
            i.setAttribute("values", "0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),
            i.setAttribute("result", "f1"),
            e.appendChild(i);
            var r = createNS("feComponentTransfer");
            r.setAttribute("color-interpolation-filters", "sRGB"),
            e.appendChild(r),
            this.matrixFilter = r;
            var n = createNS("feFuncR");
            n.setAttribute("type", "table"),
            r.appendChild(n),
            this.feFuncR = n;
            var a = createNS("feFuncG");
            a.setAttribute("type", "table"),
            r.appendChild(a),
            this.feFuncG = a;
            var o = createNS("feFuncB");
            o.setAttribute("type", "table"),
            r.appendChild(o),
            this.feFuncB = o
        }
        function SVGProLevelsFilter(e, t) {
            this.filterManager = t;
            var i = this.filterManager.effectElements
              , r = createNS("feComponentTransfer");
            (i[10].p.k || 0 !== i[10].p.v || i[11].p.k || 1 !== i[11].p.v || i[12].p.k || 1 !== i[12].p.v || i[13].p.k || 0 !== i[13].p.v || i[14].p.k || 1 !== i[14].p.v) && (this.feFuncR = this.createFeFunc("feFuncR", r)),
            (i[17].p.k || 0 !== i[17].p.v || i[18].p.k || 1 !== i[18].p.v || i[19].p.k || 1 !== i[19].p.v || i[20].p.k || 0 !== i[20].p.v || i[21].p.k || 1 !== i[21].p.v) && (this.feFuncG = this.createFeFunc("feFuncG", r)),
            (i[24].p.k || 0 !== i[24].p.v || i[25].p.k || 1 !== i[25].p.v || i[26].p.k || 1 !== i[26].p.v || i[27].p.k || 0 !== i[27].p.v || i[28].p.k || 1 !== i[28].p.v) && (this.feFuncB = this.createFeFunc("feFuncB", r)),
            (i[31].p.k || 0 !== i[31].p.v || i[32].p.k || 1 !== i[32].p.v || i[33].p.k || 1 !== i[33].p.v || i[34].p.k || 0 !== i[34].p.v || i[35].p.k || 1 !== i[35].p.v) && (this.feFuncA = this.createFeFunc("feFuncA", r)),
            (this.feFuncR || this.feFuncG || this.feFuncB || this.feFuncA) && (r.setAttribute("color-interpolation-filters", "sRGB"),
            e.appendChild(r),
            r = createNS("feComponentTransfer")),
            (i[3].p.k || 0 !== i[3].p.v || i[4].p.k || 1 !== i[4].p.v || i[5].p.k || 1 !== i[5].p.v || i[6].p.k || 0 !== i[6].p.v || i[7].p.k || 1 !== i[7].p.v) && (r.setAttribute("color-interpolation-filters", "sRGB"),
            e.appendChild(r),
            this.feFuncRComposed = this.createFeFunc("feFuncR", r),
            this.feFuncGComposed = this.createFeFunc("feFuncG", r),
            this.feFuncBComposed = this.createFeFunc("feFuncB", r))
        }
        function SVGDropShadowEffect(e, t) {
            var i = t.container.globalData.renderConfig.filterSize;
            e.setAttribute("x", i.x),
            e.setAttribute("y", i.y),
            e.setAttribute("width", i.width),
            e.setAttribute("height", i.height),
            this.filterManager = t;
            var r = createNS("feGaussianBlur");
            r.setAttribute("in", "SourceAlpha"),
            r.setAttribute("result", "drop_shadow_1"),
            r.setAttribute("stdDeviation", "0"),
            this.feGaussianBlur = r,
            e.appendChild(r);
            var n = createNS("feOffset");
            n.setAttribute("dx", "25"),
            n.setAttribute("dy", "0"),
            n.setAttribute("in", "drop_shadow_1"),
            n.setAttribute("result", "drop_shadow_2"),
            this.feOffset = n,
            e.appendChild(n);
            var a = createNS("feFlood");
            a.setAttribute("flood-color", "#00ff00"),
            a.setAttribute("flood-opacity", "1"),
            a.setAttribute("result", "drop_shadow_3"),
            this.feFlood = a,
            e.appendChild(a);
            var o = createNS("feComposite");
            o.setAttribute("in", "drop_shadow_3"),
            o.setAttribute("in2", "drop_shadow_2"),
            o.setAttribute("operator", "in"),
            o.setAttribute("result", "drop_shadow_4"),
            e.appendChild(o);
            var s, l = createNS("feMerge");
            e.appendChild(l),
            s = createNS("feMergeNode"),
            l.appendChild(s),
            (s = createNS("feMergeNode")).setAttribute("in", "SourceGraphic"),
            this.feMergeNode = s,
            this.feMerge = l,
            this.originalNodeAdded = !1,
            l.appendChild(s)
        }
        ShapeTransformManager.prototype = {
            addTransformSequence: function(e) {
                var t, i = e.length, r = "_";
                for (t = 0; t < i; t += 1)
                    r += e[t].transform.key + "_";
                var n = this.sequences[r];
                return n || (n = {
                    transforms: [].concat(e),
                    finalTransform: new Matrix,
                    _mdf: !1
                },
                this.sequences[r] = n,
                this.sequenceList.push(n)),
                n
            },
            processSequence: function(e, t) {
                for (var i, r = 0, n = e.transforms.length, a = t; r < n && !t; ) {
                    if (e.transforms[r].transform.mProps._mdf) {
                        a = !0;
                        break
                    }
                    r += 1
                }
                if (a)
                    for (e.finalTransform.reset(),
                    r = n - 1; r >= 0; r -= 1)
                        i = e.transforms[r].transform.mProps.v.props,
                        e.finalTransform.transform(i[0], i[1], i[2], i[3], i[4], i[5], i[6], i[7], i[8], i[9], i[10], i[11], i[12], i[13], i[14], i[15]);
                e._mdf = a
            },
            processSequences: function(e) {
                var t, i = this.sequenceList.length;
                for (t = 0; t < i; t += 1)
                    this.processSequence(this.sequenceList[t], e)
            },
            getNewKey: function() {
                return this.transform_key_count += 1,
                "_" + this.transform_key_count
            }
        },
        CVShapeData.prototype.setAsAnimated = SVGShapeData.prototype.setAsAnimated,
        BaseElement.prototype = {
            checkMasks: function() {
                if (!this.data.hasMask)
                    return !1;
                for (var e = 0, t = this.data.masksProperties.length; e < t; ) {
                    if ("n" !== this.data.masksProperties[e].mode && !1 !== this.data.masksProperties[e].cl)
                        return !0;
                    e += 1
                }
                return !1
            },
            initExpressions: function() {
                this.layerInterface = LayerExpressionInterface(this),
                this.data.hasMask && this.maskManager && this.layerInterface.registerMaskInterface(this.maskManager);
                var e = EffectsExpressionInterface.createEffectsInterface(this, this.layerInterface);
                this.layerInterface.registerEffectsInterface(e),
                0 === this.data.ty || this.data.xt ? this.compInterface = CompExpressionInterface(this) : 4 === this.data.ty ? (this.layerInterface.shapeInterface = ShapeExpressionInterface(this.shapesData, this.itemsData, this.layerInterface),
                this.layerInterface.content = this.layerInterface.shapeInterface) : 5 === this.data.ty && (this.layerInterface.textInterface = TextExpressionInterface(this),
                this.layerInterface.text = this.layerInterface.textInterface)
            },
            setBlendMode: function() {
                var e = getBlendMode(this.data.bm);
                (this.baseElement || this.layerElement).style["mix-blend-mode"] = e
            },
            initBaseData: function(e, t, i) {
                this.globalData = t,
                this.comp = i,
                this.data = e,
                this.layerId = createElementID(),
                this.data.sr || (this.data.sr = 1),
                this.effectsManager = new EffectsManager(this.data,this,this.dynamicProperties)
            },
            getType: function() {
                return this.type
            },
            sourceRectAtTime: function() {}
        },
        NullElement.prototype.prepareFrame = function(e) {
            this.prepareProperties(e, !0)
        }
        ,
        NullElement.prototype.renderFrame = function() {}
        ,
        NullElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        NullElement.prototype.destroy = function() {}
        ,
        NullElement.prototype.sourceRectAtTime = function() {}
        ,
        NullElement.prototype.hide = function() {}
        ,
        extendPrototype([BaseElement, TransformElement, HierarchyElement, FrameElement], NullElement),
        SVGBaseElement.prototype = {
            initRendererElement: function() {
                this.layerElement = createNS("g")
            },
            createContainerElements: function() {
                this.matteElement = createNS("g"),
                this.transformedElement = this.layerElement,
                this.maskedElement = this.layerElement,
                this._sizeChanged = !1;
                var e, t, i, r = null;
                if (this.data.td) {
                    if (3 == this.data.td || 1 == this.data.td) {
                        var n = createNS("mask");
                        n.setAttribute("id", this.layerId),
                        n.setAttribute("mask-type", 3 == this.data.td ? "luminance" : "alpha"),
                        n.appendChild(this.layerElement),
                        r = n,
                        this.globalData.defs.appendChild(n),
                        featureSupport.maskType || 1 != this.data.td || (n.setAttribute("mask-type", "luminance"),
                        e = createElementID(),
                        t = filtersFactory.createFilter(e),
                        this.globalData.defs.appendChild(t),
                        t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),
                        (i = createNS("g")).appendChild(this.layerElement),
                        r = i,
                        n.appendChild(i),
                        i.setAttribute("filter", "url(" + locationHref + "#" + e + ")"))
                    } else if (2 == this.data.td) {
                        var a = createNS("mask");
                        a.setAttribute("id", this.layerId),
                        a.setAttribute("mask-type", "alpha");
                        var o = createNS("g");
                        a.appendChild(o),
                        e = createElementID(),
                        t = filtersFactory.createFilter(e);
                        var s = createNS("feComponentTransfer");
                        s.setAttribute("in", "SourceGraphic"),
                        t.appendChild(s);
                        var l = createNS("feFuncA");
                        l.setAttribute("type", "table"),
                        l.setAttribute("tableValues", "1.0 0.0"),
                        s.appendChild(l),
                        this.globalData.defs.appendChild(t);
                        var h = createNS("rect");
                        h.setAttribute("width", this.comp.data.w),
                        h.setAttribute("height", this.comp.data.h),
                        h.setAttribute("x", "0"),
                        h.setAttribute("y", "0"),
                        h.setAttribute("fill", "#ffffff"),
                        h.setAttribute("opacity", "0"),
                        o.setAttribute("filter", "url(" + locationHref + "#" + e + ")"),
                        o.appendChild(h),
                        o.appendChild(this.layerElement),
                        r = o,
                        featureSupport.maskType || (a.setAttribute("mask-type", "luminance"),
                        t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),
                        i = createNS("g"),
                        o.appendChild(h),
                        i.appendChild(this.layerElement),
                        r = i,
                        o.appendChild(i)),
                        this.globalData.defs.appendChild(a)
                    }
                } else
                    this.data.tt ? (this.matteElement.appendChild(this.layerElement),
                    r = this.matteElement,
                    this.baseElement = this.matteElement) : this.baseElement = this.layerElement;
                if (this.data.ln && this.layerElement.setAttribute("id", this.data.ln),
                this.data.cl && this.layerElement.setAttribute("class", this.data.cl),
                0 === this.data.ty && !this.data.hd) {
                    var c = createNS("clipPath")
                      , p = createNS("path");
                    p.setAttribute("d", "M0,0 L" + this.data.w + ",0 L" + this.data.w + "," + this.data.h + " L0," + this.data.h + "z");
                    var u = createElementID();
                    if (c.setAttribute("id", u),
                    c.appendChild(p),
                    this.globalData.defs.appendChild(c),
                    this.checkMasks()) {
                        var d = createNS("g");
                        d.setAttribute("clip-path", "url(" + locationHref + "#" + u + ")"),
                        d.appendChild(this.layerElement),
                        this.transformedElement = d,
                        r ? r.appendChild(this.transformedElement) : this.baseElement = this.transformedElement
                    } else
                        this.layerElement.setAttribute("clip-path", "url(" + locationHref + "#" + u + ")")
                }
                0 !== this.data.bm && this.setBlendMode()
            },
            renderElement: function() {
                this.finalTransform._matMdf && this.transformedElement.setAttribute("transform", this.finalTransform.mat.to2dCSS()),
                this.finalTransform._opMdf && this.transformedElement.setAttribute("opacity", this.finalTransform.mProp.o.v)
            },
            destroyBaseElement: function() {
                this.layerElement = null,
                this.matteElement = null,
                this.maskManager.destroy()
            },
            getBaseElement: function() {
                return this.data.hd ? null : this.baseElement
            },
            createRenderableComponents: function() {
                this.maskManager = new MaskElement(this.data,this,this.globalData),
                this.renderableEffectsManager = new SVGEffects(this)
            },
            setMatte: function(e) {
                this.matteElement && this.matteElement.setAttribute("mask", "url(" + locationHref + "#" + e + ")")
            }
        },
        IShapeElement.prototype = {
            addShapeToModifiers: function(e) {
                var t, i = this.shapeModifiers.length;
                for (t = 0; t < i; t += 1)
                    this.shapeModifiers[t].addShape(e)
            },
            isShapeInAnimatedModifiers: function(e) {
                for (var t = this.shapeModifiers.length; 0 < t; )
                    if (this.shapeModifiers[0].isAnimatedWithShape(e))
                        return !0;
                return !1
            },
            renderModifiers: function() {
                if (this.shapeModifiers.length) {
                    var e, t = this.shapes.length;
                    for (e = 0; e < t; e += 1)
                        this.shapes[e].sh.reset();
                    for (e = (t = this.shapeModifiers.length) - 1; e >= 0 && !this.shapeModifiers[e].processShapes(this._isFirstFrame); e -= 1)
                        ;
                }
            },
            searchProcessedElement: function(e) {
                for (var t = this.processedElements, i = 0, r = t.length; i < r; ) {
                    if (t[i].elem === e)
                        return t[i].pos;
                    i += 1
                }
                return 0
            },
            addProcessedElement: function(e, t) {
                for (var i = this.processedElements, r = i.length; r; )
                    if (i[r -= 1].elem === e)
                        return void (i[r].pos = t);
                i.push(new ProcessedElement(e,t))
            },
            prepareFrame: function(e) {
                this.prepareRenderableFrame(e),
                this.prepareProperties(e, this.isInRange)
            }
        },
        ITextElement.prototype.initElement = function(e, t, i) {
            this.lettersChangedFlag = !0,
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.textProperty = new TextProperty(this,e.t,this.dynamicProperties),
            this.textAnimator = new TextAnimatorProperty(e.t,this.renderType,this),
            this.initTransform(e, t, i),
            this.initHierarchy(),
            this.initRenderable(),
            this.initRendererElement(),
            this.createContainerElements(),
            this.createRenderableComponents(),
            this.createContent(),
            this.hide(),
            this.textAnimator.searchProperties(this.dynamicProperties)
        }
        ,
        ITextElement.prototype.prepareFrame = function(e) {
            this._mdf = !1,
            this.prepareRenderableFrame(e),
            this.prepareProperties(e, this.isInRange),
            (this.textProperty._mdf || this.textProperty._isFirstFrame) && (this.buildNewText(),
            this.textProperty._isFirstFrame = !1,
            this.textProperty._mdf = !1)
        }
        ,
        ITextElement.prototype.createPathShape = function(e, t) {
            var i, r, n = t.length, a = "";
            for (i = 0; i < n; i += 1)
                r = t[i].ks.k,
                a += buildShapeString(r, r.i.length, !0, e);
            return a
        }
        ,
        ITextElement.prototype.updateDocumentData = function(e, t) {
            this.textProperty.updateDocumentData(e, t)
        }
        ,
        ITextElement.prototype.canResizeFont = function(e) {
            this.textProperty.canResizeFont(e)
        }
        ,
        ITextElement.prototype.setMinimumFontSize = function(e) {
            this.textProperty.setMinimumFontSize(e)
        }
        ,
        ITextElement.prototype.applyTextPropertiesToMatrix = function(e, t, i, r, n) {
            switch (e.ps && t.translate(e.ps[0], e.ps[1] + e.ascent, 0),
            t.translate(0, -e.ls, 0),
            e.j) {
            case 1:
                t.translate(e.justifyOffset + (e.boxWidth - e.lineWidths[i]), 0, 0);
                break;
            case 2:
                t.translate(e.justifyOffset + (e.boxWidth - e.lineWidths[i]) / 2, 0, 0)
            }
            t.translate(r, n, 0)
        }
        ,
        ITextElement.prototype.buildColor = function(e) {
            return "rgb(" + Math.round(255 * e[0]) + "," + Math.round(255 * e[1]) + "," + Math.round(255 * e[2]) + ")"
        }
        ,
        ITextElement.prototype.emptyProp = new LetterProps,
        ITextElement.prototype.destroy = function() {}
        ,
        extendPrototype([BaseElement, TransformElement, HierarchyElement, FrameElement, RenderableDOMElement], ICompElement),
        ICompElement.prototype.initElement = function(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initTransform(e, t, i),
            this.initRenderable(),
            this.initHierarchy(),
            this.initRendererElement(),
            this.createContainerElements(),
            this.createRenderableComponents(),
            !this.data.xt && t.progressiveLoad || this.buildAllItems(),
            this.hide()
        }
        ,
        ICompElement.prototype.prepareFrame = function(e) {
            if (this._mdf = !1,
            this.prepareRenderableFrame(e),
            this.prepareProperties(e, this.isInRange),
            this.isInRange || this.data.xt) {
                if (this.tm._placeholder)
                    this.renderedFrame = e / this.data.sr;
                else {
                    var t = this.tm.v;
                    t === this.data.op && (t = this.data.op - 1),
                    this.renderedFrame = t
                }
                var i, r = this.elements.length;
                for (this.completeLayers || this.checkLayers(this.renderedFrame),
                i = r - 1; i >= 0; i -= 1)
                    (this.completeLayers || this.elements[i]) && (this.elements[i].prepareFrame(this.renderedFrame - this.layers[i].st),
                    this.elements[i]._mdf && (this._mdf = !0))
            }
        }
        ,
        ICompElement.prototype.renderInnerContent = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                (this.completeLayers || this.elements[e]) && this.elements[e].renderFrame()
        }
        ,
        ICompElement.prototype.setElements = function(e) {
            this.elements = e
        }
        ,
        ICompElement.prototype.getElements = function() {
            return this.elements
        }
        ,
        ICompElement.prototype.destroyElements = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                this.elements[e] && this.elements[e].destroy()
        }
        ,
        ICompElement.prototype.destroy = function() {
            this.destroyElements(),
            this.destroyBaseElement()
        }
        ,
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, HierarchyElement, FrameElement, RenderableDOMElement], IImageElement),
        IImageElement.prototype.createContent = function() {
            var e = this.globalData.getAssetsPath(this.assetData);
            this.innerElem = createNS("image"),
            this.innerElem.setAttribute("width", this.assetData.w + "px"),
            this.innerElem.setAttribute("height", this.assetData.h + "px"),
            this.innerElem.setAttribute("preserveAspectRatio", this.assetData.pr || this.globalData.renderConfig.imagePreserveAspectRatio),
            this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink", "href", e),
            this.layerElement.appendChild(this.innerElem)
        }
        ,
        IImageElement.prototype.sourceRectAtTime = function() {
            return this.sourceRect
        }
        ,
        extendPrototype([IImageElement], ISolidElement),
        ISolidElement.prototype.createContent = function() {
            var e = createNS("rect");
            e.setAttribute("width", this.data.sw),
            e.setAttribute("height", this.data.sh),
            e.setAttribute("fill", this.data.sc),
            this.layerElement.appendChild(e)
        }
        ,
        AudioElement.prototype.prepareFrame = function(e) {
            if (this.prepareRenderableFrame(e, !0),
            this.prepareProperties(e, !0),
            this.tm._placeholder)
                this._currentTime = e / this.data.sr;
            else {
                var t = this.tm.v;
                this._currentTime = t
            }
        }
        ,
        extendPrototype([RenderableElement, BaseElement, FrameElement], AudioElement),
        AudioElement.prototype.renderFrame = function() {
            this.isInRange && this._canPlay && (this._isPlaying ? (!this.audio.playing() || Math.abs(this._currentTime / this.globalData.frameRate - this.audio.seek()) > .1) && this.audio.seek(this._currentTime / this.globalData.frameRate) : (this.audio.play(),
            this.audio.seek(this._currentTime / this.globalData.frameRate),
            this._isPlaying = !0))
        }
        ,
        AudioElement.prototype.show = function() {}
        ,
        AudioElement.prototype.hide = function() {
            this.audio.pause(),
            this._isPlaying = !1
        }
        ,
        AudioElement.prototype.pause = function() {
            this.audio.pause(),
            this._isPlaying = !1,
            this._canPlay = !1
        }
        ,
        AudioElement.prototype.resume = function() {
            this._canPlay = !0
        }
        ,
        AudioElement.prototype.setRate = function(e) {
            this.audio.rate(e)
        }
        ,
        AudioElement.prototype.volume = function(e) {
            this.audio.volume(e)
        }
        ,
        AudioElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        AudioElement.prototype.destroy = function() {}
        ,
        AudioElement.prototype.sourceRectAtTime = function() {}
        ,
        AudioElement.prototype.initExpressions = function() {}
        ,
        FootageElement.prototype.prepareFrame = function() {}
        ,
        extendPrototype([RenderableElement, BaseElement, FrameElement], FootageElement),
        FootageElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        FootageElement.prototype.renderFrame = function() {}
        ,
        FootageElement.prototype.destroy = function() {}
        ,
        FootageElement.prototype.initExpressions = function() {
            this.layerInterface = FootageInterface(this)
        }
        ,
        FootageElement.prototype.getFootageData = function() {
            return this.footageData
        }
        ,
        extendPrototype([SVGRenderer, ICompElement, SVGBaseElement], SVGCompElement),
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, HierarchyElement, FrameElement, RenderableDOMElement, ITextElement], SVGTextLottieElement),
        SVGTextLottieElement.prototype.createContent = function() {
            this.data.singleShape && !this.globalData.fontManager.chars && (this.textContainer = createNS("text"))
        }
        ,
        SVGTextLottieElement.prototype.buildTextContents = function(e) {
            for (var t = 0, i = e.length, r = [], n = ""; t < i; )
                e[t] === String.fromCharCode(13) || e[t] === String.fromCharCode(3) ? (r.push(n),
                n = "") : n += e[t],
                t += 1;
            return r.push(n),
            r
        }
        ,
        SVGTextLottieElement.prototype.buildNewText = function() {
            var e, t, i = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(i ? i.l.length : 0),
            i.fc ? this.layerElement.setAttribute("fill", this.buildColor(i.fc)) : this.layerElement.setAttribute("fill", "rgba(0,0,0,0)"),
            i.sc && (this.layerElement.setAttribute("stroke", this.buildColor(i.sc)),
            this.layerElement.setAttribute("stroke-width", i.sw)),
            this.layerElement.setAttribute("font-size", i.finalSize);
            var r = this.globalData.fontManager.getFontByName(i.f);
            if (r.fClass)
                this.layerElement.setAttribute("class", r.fClass);
            else {
                this.layerElement.setAttribute("font-family", r.fFamily);
                var n = i.fWeight
                  , a = i.fStyle;
                this.layerElement.setAttribute("font-style", a),
                this.layerElement.setAttribute("font-weight", n)
            }
            this.layerElement.setAttribute("aria-label", i.t);
            var o, s = i.l || [], l = !!this.globalData.fontManager.chars;
            t = s.length;
            var h, c = this.mHelper, p = "", u = this.data.singleShape, d = 0, f = 0, m = !0, g = .001 * i.tr * i.finalSize;
            if (!u || l || i.sz) {
                var v, y, _ = this.textSpans.length;
                for (e = 0; e < t; e += 1)
                    l && u && 0 !== e || (o = _ > e ? this.textSpans[e] : createNS(l ? "path" : "text"),
                    _ <= e && (o.setAttribute("stroke-linecap", "butt"),
                    o.setAttribute("stroke-linejoin", "round"),
                    o.setAttribute("stroke-miterlimit", "4"),
                    this.textSpans[e] = o,
                    this.layerElement.appendChild(o)),
                    o.style.display = "inherit"),
                    c.reset(),
                    c.scale(i.finalSize / 100, i.finalSize / 100),
                    u && (s[e].n && (d = -g,
                    f += i.yOffset,
                    f += m ? 1 : 0,
                    m = !1),
                    this.applyTextPropertiesToMatrix(i, c, s[e].line, d, f),
                    d += s[e].l || 0,
                    d += g),
                    l ? (h = (v = (y = this.globalData.fontManager.getCharData(i.finalText[e], r.fStyle, this.globalData.fontManager.getFontByName(i.f).fFamily)) && y.data || {}).shapes ? v.shapes[0].it : [],
                    u ? p += this.createPathShape(c, h) : o.setAttribute("d", this.createPathShape(c, h))) : (u && o.setAttribute("transform", "translate(" + c.props[12] + "," + c.props[13] + ")"),
                    o.textContent = s[e].val,
                    o.setAttributeNS("http://www.w3.org/XML/1998/namespace", "xml:space", "preserve"));
                u && o && o.setAttribute("d", p)
            } else {
                var b = this.textContainer
                  , x = "start";
                switch (i.j) {
                case 1:
                    x = "end";
                    break;
                case 2:
                    x = "middle";
                    break;
                default:
                    x = "start"
                }
                b.setAttribute("text-anchor", x),
                b.setAttribute("letter-spacing", g);
                var w = this.buildTextContents(i.finalText);
                for (t = w.length,
                f = i.ps ? i.ps[1] + i.ascent : 0,
                e = 0; e < t; e += 1)
                    (o = this.textSpans[e] || createNS("tspan")).textContent = w[e],
                    o.setAttribute("x", 0),
                    o.setAttribute("y", f),
                    o.style.display = "inherit",
                    b.appendChild(o),
                    this.textSpans[e] = o,
                    f += i.finalLineHeight;
                this.layerElement.appendChild(b)
            }
            for (; e < this.textSpans.length; )
                this.textSpans[e].style.display = "none",
                e += 1;
            this._sizeChanged = !0
        }
        ,
        SVGTextLottieElement.prototype.sourceRectAtTime = function() {
            if (this.prepareFrame(this.comp.renderedFrame - this.data.st),
            this.renderInnerContent(),
            this._sizeChanged) {
                this._sizeChanged = !1;
                var e = this.layerElement.getBBox();
                this.bbox = {
                    top: e.y,
                    left: e.x,
                    width: e.width,
                    height: e.height
                }
            }
            return this.bbox
        }
        ,
        SVGTextLottieElement.prototype.renderInnerContent = function() {
            if (!this.data.singleShape && (this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag),
            this.lettersChangedFlag || this.textAnimator.lettersChangedFlag)) {
                var e, t;
                this._sizeChanged = !0;
                var i, r, n = this.textAnimator.renderedLetters, a = this.textProperty.currentData.l;
                for (t = a.length,
                e = 0; e < t; e += 1)
                    a[e].n || (i = n[e],
                    r = this.textSpans[e],
                    i._mdf.m && r.setAttribute("transform", i.m),
                    i._mdf.o && r.setAttribute("opacity", i.o),
                    i._mdf.sw && r.setAttribute("stroke-width", i.sw),
                    i._mdf.sc && r.setAttribute("stroke", i.sc),
                    i._mdf.fc && r.setAttribute("fill", i.fc))
            }
        }
        ,
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, IShapeElement, HierarchyElement, FrameElement, RenderableDOMElement], SVGShapeElement),
        SVGShapeElement.prototype.initSecondaryElement = function() {}
        ,
        SVGShapeElement.prototype.identityMatrix = new Matrix,
        SVGShapeElement.prototype.buildExpressionInterface = function() {}
        ,
        SVGShapeElement.prototype.createContent = function() {
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.layerElement, 0, [], !0),
            this.filterUniqueShapes()
        }
        ,
        SVGShapeElement.prototype.filterUniqueShapes = function() {
            var e, t, i, r, n = this.shapes.length, a = this.stylesList.length, o = [], s = !1;
            for (i = 0; i < a; i += 1) {
                for (r = this.stylesList[i],
                s = !1,
                o.length = 0,
                e = 0; e < n; e += 1)
                    -1 !== (t = this.shapes[e]).styles.indexOf(r) && (o.push(t),
                    s = t._isAnimated || s);
                o.length > 1 && s && this.setShapesAsAnimated(o)
            }
        }
        ,
        SVGShapeElement.prototype.setShapesAsAnimated = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t].setAsAnimated()
        }
        ,
        SVGShapeElement.prototype.createStyleElement = function(e, t) {
            var i, r = new SVGStyleData(e,t), n = r.pElem;
            return "st" === e.ty ? i = new SVGStrokeStyleData(this,e,r) : "fl" === e.ty ? i = new SVGFillStyleData(this,e,r) : "gf" !== e.ty && "gs" !== e.ty || (i = new ("gf" === e.ty ? SVGGradientFillStyleData : SVGGradientStrokeStyleData)(this,e,r),
            this.globalData.defs.appendChild(i.gf),
            i.maskId && (this.globalData.defs.appendChild(i.ms),
            this.globalData.defs.appendChild(i.of),
            n.setAttribute("mask", "url(" + locationHref + "#" + i.maskId + ")"))),
            "st" !== e.ty && "gs" !== e.ty || (n.setAttribute("stroke-linecap", lineCapEnum[e.lc || 2]),
            n.setAttribute("stroke-linejoin", lineJoinEnum[e.lj || 2]),
            n.setAttribute("fill-opacity", "0"),
            1 === e.lj && n.setAttribute("stroke-miterlimit", e.ml)),
            2 === e.r && n.setAttribute("fill-rule", "evenodd"),
            e.ln && n.setAttribute("id", e.ln),
            e.cl && n.setAttribute("class", e.cl),
            e.bm && (n.style["mix-blend-mode"] = getBlendMode(e.bm)),
            this.stylesList.push(r),
            this.addToAnimatedContents(e, i),
            i
        }
        ,
        SVGShapeElement.prototype.createGroupElement = function(e) {
            var t = new ShapeGroupData;
            return e.ln && t.gr.setAttribute("id", e.ln),
            e.cl && t.gr.setAttribute("class", e.cl),
            e.bm && (t.gr.style["mix-blend-mode"] = getBlendMode(e.bm)),
            t
        }
        ,
        SVGShapeElement.prototype.createTransformElement = function(e, t) {
            var i = TransformPropertyFactory.getTransformProperty(this, e, this)
              , r = new SVGTransformData(i,i.o,t);
            return this.addToAnimatedContents(e, r),
            r
        }
        ,
        SVGShapeElement.prototype.createShapeElement = function(e, t, i) {
            var r = 4;
            "rc" === e.ty ? r = 5 : "el" === e.ty ? r = 6 : "sr" === e.ty && (r = 7);
            var n = new SVGShapeData(t,i,ShapePropertyFactory.getShapeProp(this, e, r, this));
            return this.shapes.push(n),
            this.addShapeToModifiers(n),
            this.addToAnimatedContents(e, n),
            n
        }
        ,
        SVGShapeElement.prototype.addToAnimatedContents = function(e, t) {
            for (var i = 0, r = this.animatedContents.length; i < r; ) {
                if (this.animatedContents[i].element === t)
                    return;
                i += 1
            }
            this.animatedContents.push({
                fn: SVGElementsRenderer.createRenderFunction(e),
                element: t,
                data: e
            })
        }
        ,
        SVGShapeElement.prototype.setElementStyles = function(e) {
            var t, i = e.styles, r = this.stylesList.length;
            for (t = 0; t < r; t += 1)
                this.stylesList[t].closed || i.push(this.stylesList[t])
        }
        ,
        SVGShapeElement.prototype.reloadShapes = function() {
            var e;
            this._isFirstFrame = !0;
            var t = this.itemsData.length;
            for (e = 0; e < t; e += 1)
                this.prevViewData[e] = this.itemsData[e];
            for (this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.layerElement, 0, [], !0),
            this.filterUniqueShapes(),
            t = this.dynamicProperties.length,
            e = 0; e < t; e += 1)
                this.dynamicProperties[e].getValue();
            this.renderModifiers()
        }
        ,
        SVGShapeElement.prototype.searchShapes = function(e, t, i, r, n, a, o) {
            var s, l, h, c, p, u, d = [].concat(a), f = e.length - 1, m = [], g = [];
            for (s = f; s >= 0; s -= 1) {
                if ((u = this.searchProcessedElement(e[s])) ? t[s] = i[u - 1] : e[s]._render = o,
                "fl" === e[s].ty || "st" === e[s].ty || "gf" === e[s].ty || "gs" === e[s].ty)
                    u ? t[s].style.closed = !1 : t[s] = this.createStyleElement(e[s], n),
                    e[s]._render && t[s].style.pElem.parentNode !== r && r.appendChild(t[s].style.pElem),
                    m.push(t[s].style);
                else if ("gr" === e[s].ty) {
                    if (u)
                        for (h = t[s].it.length,
                        l = 0; l < h; l += 1)
                            t[s].prevViewData[l] = t[s].it[l];
                    else
                        t[s] = this.createGroupElement(e[s]);
                    this.searchShapes(e[s].it, t[s].it, t[s].prevViewData, t[s].gr, n + 1, d, o),
                    e[s]._render && t[s].gr.parentNode !== r && r.appendChild(t[s].gr)
                } else
                    "tr" === e[s].ty ? (u || (t[s] = this.createTransformElement(e[s], r)),
                    c = t[s].transform,
                    d.push(c)) : "sh" === e[s].ty || "rc" === e[s].ty || "el" === e[s].ty || "sr" === e[s].ty ? (u || (t[s] = this.createShapeElement(e[s], d, n)),
                    this.setElementStyles(t[s])) : "tm" === e[s].ty || "rd" === e[s].ty || "ms" === e[s].ty || "pb" === e[s].ty ? (u ? (p = t[s]).closed = !1 : ((p = ShapeModifiers.getModifier(e[s].ty)).init(this, e[s]),
                    t[s] = p,
                    this.shapeModifiers.push(p)),
                    g.push(p)) : "rp" === e[s].ty && (u ? (p = t[s]).closed = !0 : (p = ShapeModifiers.getModifier(e[s].ty),
                    t[s] = p,
                    p.init(this, e, s, t),
                    this.shapeModifiers.push(p),
                    o = !1),
                    g.push(p));
                this.addProcessedElement(e[s], s + 1)
            }
            for (f = m.length,
            s = 0; s < f; s += 1)
                m[s].closed = !0;
            for (f = g.length,
            s = 0; s < f; s += 1)
                g[s].closed = !0
        }
        ,
        SVGShapeElement.prototype.renderInnerContent = function() {
            var e;
            this.renderModifiers();
            var t = this.stylesList.length;
            for (e = 0; e < t; e += 1)
                this.stylesList[e].reset();
            for (this.renderShape(),
            e = 0; e < t; e += 1)
                (this.stylesList[e]._mdf || this._isFirstFrame) && (this.stylesList[e].msElem && (this.stylesList[e].msElem.setAttribute("d", this.stylesList[e].d),
                this.stylesList[e].d = "M0 0" + this.stylesList[e].d),
                this.stylesList[e].pElem.setAttribute("d", this.stylesList[e].d || "M0 0"))
        }
        ,
        SVGShapeElement.prototype.renderShape = function() {
            var e, t, i = this.animatedContents.length;
            for (e = 0; e < i; e += 1)
                t = this.animatedContents[e],
                (this._isFirstFrame || t.element._isAnimated) && !0 !== t.data && t.fn(t.data, t.element, this._isFirstFrame)
        }
        ,
        SVGShapeElement.prototype.destroy = function() {
            this.destroyBaseElement(),
            this.shapesData = null,
            this.itemsData = null
        }
        ,
        SVGTintFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = this.filterManager.effectElements[2].p.v / 100;
                this.matrixFilter.setAttribute("values", i[0] - t[0] + " 0 0 0 " + t[0] + " " + (i[1] - t[1]) + " 0 0 0 " + t[1] + " " + (i[2] - t[2]) + " 0 0 0 " + t[2] + " 0 0 0 " + r + " 0")
            }
        }
        ,
        SVGFillFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[2].p.v
                  , i = this.filterManager.effectElements[6].p.v;
                this.matrixFilter.setAttribute("values", "0 0 0 0 " + t[0] + " 0 0 0 0 " + t[1] + " 0 0 0 0 " + t[2] + " 0 0 0 " + i + " 0")
            }
        }
        ,
        SVGGaussianBlurEffect.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = .3 * this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = 3 == i ? 0 : t
                  , n = 2 == i ? 0 : t;
                this.feGaussianBlur.setAttribute("stdDeviation", r + " " + n);
                var a = 1 == this.filterManager.effectElements[2].p.v ? "wrap" : "duplicate";
                this.feGaussianBlur.setAttribute("edgeMode", a)
            }
        }
        ,
        SVGStrokeEffect.prototype.initialize = function() {
            var e, t, i, r, n = this.elem.layerElement.children || this.elem.layerElement.childNodes;
            for (1 === this.filterManager.effectElements[1].p.v ? (r = this.elem.maskManager.masksProperties.length,
            i = 0) : r = 1 + (i = this.filterManager.effectElements[0].p.v - 1),
            (t = createNS("g")).setAttribute("fill", "none"),
            t.setAttribute("stroke-linecap", "round"),
            t.setAttribute("stroke-dashoffset", 1); i < r; i += 1)
                e = createNS("path"),
                t.appendChild(e),
                this.paths.push({
                    p: e,
                    m: i
                });
            if (3 === this.filterManager.effectElements[10].p.v) {
                var a = createNS("mask")
                  , o = createElementID();
                a.setAttribute("id", o),
                a.setAttribute("mask-type", "alpha"),
                a.appendChild(t),
                this.elem.globalData.defs.appendChild(a);
                var s = createNS("g");
                for (s.setAttribute("mask", "url(" + locationHref + "#" + o + ")"); n[0]; )
                    s.appendChild(n[0]);
                this.elem.layerElement.appendChild(s),
                this.masker = a,
                t.setAttribute("stroke", "#fff")
            } else if (1 === this.filterManager.effectElements[10].p.v || 2 === this.filterManager.effectElements[10].p.v) {
                if (2 === this.filterManager.effectElements[10].p.v)
                    for (n = this.elem.layerElement.children || this.elem.layerElement.childNodes; n.length; )
                        this.elem.layerElement.removeChild(n[0]);
                this.elem.layerElement.appendChild(t),
                this.elem.layerElement.removeAttribute("mask"),
                t.setAttribute("stroke", "#fff")
            }
            this.initialized = !0,
            this.pathMasker = t
        }
        ,
        SVGStrokeEffect.prototype.renderFrame = function(e) {
            var t;
            this.initialized || this.initialize();
            var i, r, n = this.paths.length;
            for (t = 0; t < n; t += 1)
                if (-1 !== this.paths[t].m && (i = this.elem.maskManager.viewData[this.paths[t].m],
                r = this.paths[t].p,
                (e || this.filterManager._mdf || i.prop._mdf) && r.setAttribute("d", i.lastPath),
                e || this.filterManager.effectElements[9].p._mdf || this.filterManager.effectElements[4].p._mdf || this.filterManager.effectElements[7].p._mdf || this.filterManager.effectElements[8].p._mdf || i.prop._mdf)) {
                    var a;
                    if (0 !== this.filterManager.effectElements[7].p.v || 100 !== this.filterManager.effectElements[8].p.v) {
                        var o = .01 * Math.min(this.filterManager.effectElements[7].p.v, this.filterManager.effectElements[8].p.v)
                          , s = .01 * Math.max(this.filterManager.effectElements[7].p.v, this.filterManager.effectElements[8].p.v)
                          , l = r.getTotalLength();
                        a = "0 0 0 " + l * o + " ";
                        var h, c = l * (s - o), p = 1 + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01, u = Math.floor(c / p);
                        for (h = 0; h < u; h += 1)
                            a += "1 " + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01 + " ";
                        a += "0 " + 10 * l + " 0 0"
                    } else
                        a = "1 " + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01;
                    r.setAttribute("stroke-dasharray", a)
                }
            if ((e || this.filterManager.effectElements[4].p._mdf) && this.pathMasker.setAttribute("stroke-width", 2 * this.filterManager.effectElements[4].p.v),
            (e || this.filterManager.effectElements[6].p._mdf) && this.pathMasker.setAttribute("opacity", this.filterManager.effectElements[6].p.v),
            (1 === this.filterManager.effectElements[10].p.v || 2 === this.filterManager.effectElements[10].p.v) && (e || this.filterManager.effectElements[3].p._mdf)) {
                var d = this.filterManager.effectElements[3].p.v;
                this.pathMasker.setAttribute("stroke", "rgb(" + bmFloor(255 * d[0]) + "," + bmFloor(255 * d[1]) + "," + bmFloor(255 * d[2]) + ")")
            }
        }
        ,
        SVGTritoneFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = this.filterManager.effectElements[2].p.v
                  , n = r[0] + " " + i[0] + " " + t[0]
                  , a = r[1] + " " + i[1] + " " + t[1]
                  , o = r[2] + " " + i[2] + " " + t[2];
                this.feFuncR.setAttribute("tableValues", n),
                this.feFuncG.setAttribute("tableValues", a),
                this.feFuncB.setAttribute("tableValues", o)
            }
        }
        ,
        SVGProLevelsFilter.prototype.createFeFunc = function(e, t) {
            var i = createNS(e);
            return i.setAttribute("type", "table"),
            t.appendChild(i),
            i
        }
        ,
        SVGProLevelsFilter.prototype.getTableValue = function(e, t, i, r, n) {
            for (var a, o, s = 0, l = Math.min(e, t), h = Math.max(e, t), c = Array.call(null, {
                length: 256
            }), p = 0, u = n - r, d = t - e; s <= 256; )
                o = (a = s / 256) <= l ? d < 0 ? n : r : a >= h ? d < 0 ? r : n : r + u * Math.pow((a - e) / d, 1 / i),
                c[p] = o,
                p += 1,
                s += 256 / 255;
            return c.join(" ")
        }
        ,
        SVGProLevelsFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t, i = this.filterManager.effectElements;
                this.feFuncRComposed && (e || i[3].p._mdf || i[4].p._mdf || i[5].p._mdf || i[6].p._mdf || i[7].p._mdf) && (t = this.getTableValue(i[3].p.v, i[4].p.v, i[5].p.v, i[6].p.v, i[7].p.v),
                this.feFuncRComposed.setAttribute("tableValues", t),
                this.feFuncGComposed.setAttribute("tableValues", t),
                this.feFuncBComposed.setAttribute("tableValues", t)),
                this.feFuncR && (e || i[10].p._mdf || i[11].p._mdf || i[12].p._mdf || i[13].p._mdf || i[14].p._mdf) && (t = this.getTableValue(i[10].p.v, i[11].p.v, i[12].p.v, i[13].p.v, i[14].p.v),
                this.feFuncR.setAttribute("tableValues", t)),
                this.feFuncG && (e || i[17].p._mdf || i[18].p._mdf || i[19].p._mdf || i[20].p._mdf || i[21].p._mdf) && (t = this.getTableValue(i[17].p.v, i[18].p.v, i[19].p.v, i[20].p.v, i[21].p.v),
                this.feFuncG.setAttribute("tableValues", t)),
                this.feFuncB && (e || i[24].p._mdf || i[25].p._mdf || i[26].p._mdf || i[27].p._mdf || i[28].p._mdf) && (t = this.getTableValue(i[24].p.v, i[25].p.v, i[26].p.v, i[27].p.v, i[28].p.v),
                this.feFuncB.setAttribute("tableValues", t)),
                this.feFuncA && (e || i[31].p._mdf || i[32].p._mdf || i[33].p._mdf || i[34].p._mdf || i[35].p._mdf) && (t = this.getTableValue(i[31].p.v, i[32].p.v, i[33].p.v, i[34].p.v, i[35].p.v),
                this.feFuncA.setAttribute("tableValues", t))
            }
        }
        ,
        SVGDropShadowEffect.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                if ((e || this.filterManager.effectElements[4].p._mdf) && this.feGaussianBlur.setAttribute("stdDeviation", this.filterManager.effectElements[4].p.v / 4),
                e || this.filterManager.effectElements[0].p._mdf) {
                    var t = this.filterManager.effectElements[0].p.v;
                    this.feFlood.setAttribute("flood-color", rgbToHex(Math.round(255 * t[0]), Math.round(255 * t[1]), Math.round(255 * t[2])))
                }
                if ((e || this.filterManager.effectElements[1].p._mdf) && this.feFlood.setAttribute("flood-opacity", this.filterManager.effectElements[1].p.v / 255),
                e || this.filterManager.effectElements[2].p._mdf || this.filterManager.effectElements[3].p._mdf) {
                    var i = this.filterManager.effectElements[3].p.v
                      , r = (this.filterManager.effectElements[2].p.v - 90) * degToRads
                      , n = i * Math.cos(r)
                      , a = i * Math.sin(r);
                    this.feOffset.setAttribute("dx", n),
                    this.feOffset.setAttribute("dy", a)
                }
            }
        }
        ;
        var _svgMatteSymbols = [];
        function SVGMatte3Effect(e, t, i) {
            this.initialized = !1,
            this.filterManager = t,
            this.filterElem = e,
            this.elem = i,
            i.matteElement = createNS("g"),
            i.matteElement.appendChild(i.layerElement),
            i.matteElement.appendChild(i.transformedElement),
            i.baseElement = i.matteElement
        }
        function SVGEffects(e) {
            var t, i, r = e.data.ef ? e.data.ef.length : 0, n = createElementID(), a = filtersFactory.createFilter(n, !0), o = 0;
            for (this.filters = [],
            t = 0; t < r; t += 1)
                i = null,
                20 === e.data.ef[t].ty ? (o += 1,
                i = new SVGTintFilter(a,e.effectsManager.effectElements[t])) : 21 === e.data.ef[t].ty ? (o += 1,
                i = new SVGFillFilter(a,e.effectsManager.effectElements[t])) : 22 === e.data.ef[t].ty ? i = new SVGStrokeEffect(e,e.effectsManager.effectElements[t]) : 23 === e.data.ef[t].ty ? (o += 1,
                i = new SVGTritoneFilter(a,e.effectsManager.effectElements[t])) : 24 === e.data.ef[t].ty ? (o += 1,
                i = new SVGProLevelsFilter(a,e.effectsManager.effectElements[t])) : 25 === e.data.ef[t].ty ? (o += 1,
                i = new SVGDropShadowEffect(a,e.effectsManager.effectElements[t])) : 28 === e.data.ef[t].ty ? i = new SVGMatte3Effect(a,e.effectsManager.effectElements[t],e) : 29 === e.data.ef[t].ty && (o += 1,
                i = new SVGGaussianBlurEffect(a,e.effectsManager.effectElements[t])),
                i && this.filters.push(i);
            o && (e.globalData.defs.appendChild(a),
            e.layerElement.setAttribute("filter", "url(" + locationHref + "#" + n + ")")),
            this.filters.length && e.addRenderableComponent(this)
        }
        function CVContextData() {
            var e;
            for (this.saved = [],
            this.cArrPos = 0,
            this.cTr = new Matrix,
            this.cO = 1,
            this.savedOp = createTypedArray("float32", 15),
            e = 0; e < 15; e += 1)
                this.saved[e] = createTypedArray("float32", 16);
            this._length = 15
        }
        function CVBaseElement() {}
        function CVImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.img = t.imageLoader.getAsset(this.assetData),
            this.initElement(e, t, i)
        }
        function CVCompElement(e, t, i) {
            this.completeLayers = !1,
            this.layers = e.layers,
            this.pendingElements = [],
            this.elements = createSizedArray(this.layers.length),
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function CVMaskElement(e, t) {
            var i;
            this.data = e,
            this.element = t,
            this.masksProperties = this.data.masksProperties || [],
            this.viewData = createSizedArray(this.masksProperties.length);
            var r = this.masksProperties.length
              , n = !1;
            for (i = 0; i < r; i += 1)
                "n" !== this.masksProperties[i].mode && (n = !0),
                this.viewData[i] = ShapePropertyFactory.getShapeProp(this.element, this.masksProperties[i], 3);
            this.hasMasks = n,
            n && this.element.addRenderableComponent(this)
        }
        function CVShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.itemsData = [],
            this.prevViewData = [],
            this.shapeModifiers = [],
            this.processedElements = [],
            this.transformsManager = new ShapeTransformManager,
            this.initElement(e, t, i)
        }
        function CVSolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function CVTextElement(e, t, i) {
            this.textSpans = [],
            this.yOffset = 0,
            this.fillColorAnim = !1,
            this.strokeColorAnim = !1,
            this.strokeWidthAnim = !1,
            this.stroke = !1,
            this.fill = !1,
            this.justifyOffset = 0,
            this.currentRender = null,
            this.renderType = "canvas",
            this.values = {
                fill: "rgba(0,0,0,0)",
                stroke: "rgba(0,0,0,0)",
                sWidth: 0,
                fValue: ""
            },
            this.initElement(e, t, i)
        }
        function CVEffects() {}
        function HBaseElement() {}
        function HSolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function HCompElement(e, t, i) {
            this.layers = e.layers,
            this.supports3d = !e.hasMask,
            this.completeLayers = !1,
            this.pendingElements = [],
            this.elements = this.layers ? createSizedArray(this.layers.length) : [],
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function HShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.shapeModifiers = [],
            this.itemsData = [],
            this.processedElements = [],
            this.animatedContents = [],
            this.shapesContainer = createNS("g"),
            this.initElement(e, t, i),
            this.prevViewData = [],
            this.currentBBox = {
                x: 999999,
                y: -999999,
                h: 0,
                w: 0
            }
        }
        function HTextElement(e, t, i) {
            this.textSpans = [],
            this.textPaths = [],
            this.currentBBox = {
                x: 999999,
                y: -999999,
                h: 0,
                w: 0
            },
            this.renderType = "svg",
            this.isMasked = !1,
            this.initElement(e, t, i)
        }
        function HImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.initElement(e, t, i)
        }
        function HCameraElement(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initHierarchy();
            var r = PropertyFactory.getProp;
            if (this.pe = r(this, e.pe, 0, 0, this),
            e.ks.p.s ? (this.px = r(this, e.ks.p.x, 1, 0, this),
            this.py = r(this, e.ks.p.y, 1, 0, this),
            this.pz = r(this, e.ks.p.z, 1, 0, this)) : this.p = r(this, e.ks.p, 1, 0, this),
            e.ks.a && (this.a = r(this, e.ks.a, 1, 0, this)),
            e.ks.or.k.length && e.ks.or.k[0].to) {
                var n, a = e.ks.or.k.length;
                for (n = 0; n < a; n += 1)
                    e.ks.or.k[n].to = null,
                    e.ks.or.k[n].ti = null
            }
            this.or = r(this, e.ks.or, 1, degToRads, this),
            this.or.sh = !0,
            this.rx = r(this, e.ks.rx, 0, degToRads, this),
            this.ry = r(this, e.ks.ry, 0, degToRads, this),
            this.rz = r(this, e.ks.rz, 0, degToRads, this),
            this.mat = new Matrix,
            this._prevMat = new Matrix,
            this._isFirstFrame = !0,
            this.finalTransform = {
                mProp: this
            }
        }
        SVGMatte3Effect.prototype.findSymbol = function(e) {
            for (var t = 0, i = _svgMatteSymbols.length; t < i; ) {
                if (_svgMatteSymbols[t] === e)
                    return _svgMatteSymbols[t];
                t += 1
            }
            return null
        }
        ,
        SVGMatte3Effect.prototype.replaceInParent = function(e, t) {
            var i = e.layerElement.parentNode;
            if (i) {
                for (var r, n = i.children, a = 0, o = n.length; a < o && n[a] !== e.layerElement; )
                    a += 1;
                a <= o - 2 && (r = n[a + 1]);
                var s = createNS("use");
                s.setAttribute("href", "#" + t),
                r ? i.insertBefore(s, r) : i.appendChild(s)
            }
        }
        ,
        SVGMatte3Effect.prototype.setElementAsMask = function(e, t) {
            if (!this.findSymbol(t)) {
                var i = createElementID()
                  , r = createNS("mask");
                r.setAttribute("id", t.layerId),
                r.setAttribute("mask-type", "alpha"),
                _svgMatteSymbols.push(t);
                var n = e.globalData.defs;
                n.appendChild(r);
                var a = createNS("symbol");
                a.setAttribute("id", i),
                this.replaceInParent(t, i),
                a.appendChild(t.layerElement),
                n.appendChild(a);
                var o = createNS("use");
                o.setAttribute("href", "#" + i),
                r.appendChild(o),
                t.data.hd = !1,
                t.show()
            }
            e.setMatte(t.layerId)
        }
        ,
        SVGMatte3Effect.prototype.initialize = function() {
            for (var e = this.filterManager.effectElements[0].p.v, t = this.elem.comp.elements, i = 0, r = t.length; i < r; )
                t[i] && t[i].data.ind === e && this.setElementAsMask(this.elem, t[i]),
                i += 1;
            this.initialized = !0
        }
        ,
        SVGMatte3Effect.prototype.renderFrame = function() {
            this.initialized || this.initialize()
        }
        ,
        SVGEffects.prototype.renderFrame = function(e) {
            var t, i = this.filters.length;
            for (t = 0; t < i; t += 1)
                this.filters[t].renderFrame(e)
        }
        ,
        CVContextData.prototype.duplicate = function() {
            var e = 2 * this._length
              , t = this.savedOp;
            this.savedOp = createTypedArray("float32", e),
            this.savedOp.set(t);
            var i = 0;
            for (i = this._length; i < e; i += 1)
                this.saved[i] = createTypedArray("float32", 16);
            this._length = e
        }
        ,
        CVContextData.prototype.reset = function() {
            this.cArrPos = 0,
            this.cTr.reset(),
            this.cO = 1
        }
        ,
        CVBaseElement.prototype = {
            createElements: function() {},
            initRendererElement: function() {},
            createContainerElements: function() {
                this.canvasContext = this.globalData.canvasContext,
                this.renderableEffectsManager = new CVEffects
            },
            createContent: function() {},
            setBlendMode: function() {
                var e = this.globalData;
                if (e.blendMode !== this.data.bm) {
                    e.blendMode = this.data.bm;
                    var t = getBlendMode(this.data.bm);
                    e.canvasContext.globalCompositeOperation = t
                }
            },
            createRenderableComponents: function() {
                this.maskManager = new CVMaskElement(this.data,this)
            },
            hideElement: function() {
                this.hidden || this.isInRange && !this.isTransparent || (this.hidden = !0)
            },
            showElement: function() {
                this.isInRange && !this.isTransparent && (this.hidden = !1,
                this._isFirstFrame = !0,
                this.maskManager._isFirstFrame = !0)
            },
            renderFrame: function() {
                if (!this.hidden && !this.data.hd) {
                    this.renderTransform(),
                    this.renderRenderable(),
                    this.setBlendMode();
                    var e = 0 === this.data.ty;
                    this.globalData.renderer.save(e),
                    this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),
                    this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),
                    this.renderInnerContent(),
                    this.globalData.renderer.restore(e),
                    this.maskManager.hasMasks && this.globalData.renderer.restore(!0),
                    this._isFirstFrame && (this._isFirstFrame = !1)
                }
            },
            destroy: function() {
                this.canvasContext = null,
                this.data = null,
                this.globalData = null,
                this.maskManager.destroy()
            },
            mHelper: new Matrix
        },
        CVBaseElement.prototype.hide = CVBaseElement.prototype.hideElement,
        CVBaseElement.prototype.show = CVBaseElement.prototype.showElement,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement], CVImageElement),
        CVImageElement.prototype.initElement = SVGShapeElement.prototype.initElement,
        CVImageElement.prototype.prepareFrame = IImageElement.prototype.prepareFrame,
        CVImageElement.prototype.createContent = function() {
            if (this.img.width && (this.assetData.w !== this.img.width || this.assetData.h !== this.img.height)) {
                var e = createTag("canvas");
                e.width = this.assetData.w,
                e.height = this.assetData.h;
                var t, i, r = e.getContext("2d"), n = this.img.width, a = this.img.height, o = n / a, s = this.assetData.w / this.assetData.h, l = this.assetData.pr || this.globalData.renderConfig.imagePreserveAspectRatio;
                o > s && "xMidYMid slice" === l || o < s && "xMidYMid slice" !== l ? t = (i = a) * s : i = (t = n) / s,
                r.drawImage(this.img, (n - t) / 2, (a - i) / 2, t, i, 0, 0, this.assetData.w, this.assetData.h),
                this.img = e
            }
        }
        ,
        CVImageElement.prototype.renderInnerContent = function() {
            this.canvasContext.drawImage(this.img, 0, 0)
        }
        ,
        CVImageElement.prototype.destroy = function() {
            this.img = null
        }
        ,
        extendPrototype([CanvasRenderer, ICompElement, CVBaseElement], CVCompElement),
        CVCompElement.prototype.renderInnerContent = function() {
            var e, t = this.canvasContext;
            for (t.beginPath(),
            t.moveTo(0, 0),
            t.lineTo(this.data.w, 0),
            t.lineTo(this.data.w, this.data.h),
            t.lineTo(0, this.data.h),
            t.lineTo(0, 0),
            t.clip(),
            e = this.layers.length - 1; e >= 0; e -= 1)
                (this.completeLayers || this.elements[e]) && this.elements[e].renderFrame()
        }
        ,
        CVCompElement.prototype.destroy = function() {
            var e;
            for (e = this.layers.length - 1; e >= 0; e -= 1)
                this.elements[e] && this.elements[e].destroy();
            this.layers = null,
            this.elements = null
        }
        ,
        CVMaskElement.prototype.renderFrame = function() {
            if (this.hasMasks) {
                var e, t, i, r, n = this.element.finalTransform.mat, a = this.element.canvasContext, o = this.masksProperties.length;
                for (a.beginPath(),
                e = 0; e < o; e += 1)
                    if ("n" !== this.masksProperties[e].mode) {
                        var s;
                        this.masksProperties[e].inv && (a.moveTo(0, 0),
                        a.lineTo(this.element.globalData.compSize.w, 0),
                        a.lineTo(this.element.globalData.compSize.w, this.element.globalData.compSize.h),
                        a.lineTo(0, this.element.globalData.compSize.h),
                        a.lineTo(0, 0)),
                        r = this.viewData[e].v,
                        t = n.applyToPointArray(r.v[0][0], r.v[0][1], 0),
                        a.moveTo(t[0], t[1]);
                        var l = r._length;
                        for (s = 1; s < l; s += 1)
                            i = n.applyToTriplePoints(r.o[s - 1], r.i[s], r.v[s]),
                            a.bezierCurveTo(i[0], i[1], i[2], i[3], i[4], i[5]);
                        i = n.applyToTriplePoints(r.o[s - 1], r.i[0], r.v[0]),
                        a.bezierCurveTo(i[0], i[1], i[2], i[3], i[4], i[5])
                    }
                this.element.globalData.renderer.save(!0),
                a.clip()
            }
        }
        ,
        CVMaskElement.prototype.getMaskProperty = MaskElement.prototype.getMaskProperty,
        CVMaskElement.prototype.destroy = function() {
            this.element = null
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, IShapeElement, HierarchyElement, FrameElement, RenderableElement], CVShapeElement),
        CVShapeElement.prototype.initElement = RenderableDOMElement.prototype.initElement,
        CVShapeElement.prototype.transformHelper = {
            opacity: 1,
            _opMdf: !1
        },
        CVShapeElement.prototype.dashResetter = [],
        CVShapeElement.prototype.createContent = function() {
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, !0, [])
        }
        ,
        CVShapeElement.prototype.createStyleElement = function(e, t) {
            var i = {
                data: e,
                type: e.ty,
                preTransforms: this.transformsManager.addTransformSequence(t),
                transforms: [],
                elements: [],
                closed: !0 === e.hd
            }
              , r = {};
            if ("fl" === e.ty || "st" === e.ty ? (r.c = PropertyFactory.getProp(this, e.c, 1, 255, this),
            r.c.k || (i.co = "rgb(" + bmFloor(r.c.v[0]) + "," + bmFloor(r.c.v[1]) + "," + bmFloor(r.c.v[2]) + ")")) : "gf" !== e.ty && "gs" !== e.ty || (r.s = PropertyFactory.getProp(this, e.s, 1, null, this),
            r.e = PropertyFactory.getProp(this, e.e, 1, null, this),
            r.h = PropertyFactory.getProp(this, e.h || {
                k: 0
            }, 0, .01, this),
            r.a = PropertyFactory.getProp(this, e.a || {
                k: 0
            }, 0, degToRads, this),
            r.g = new GradientProperty(this,e.g,this)),
            r.o = PropertyFactory.getProp(this, e.o, 0, .01, this),
            "st" === e.ty || "gs" === e.ty) {
                if (i.lc = lineCapEnum[e.lc || 2],
                i.lj = lineJoinEnum[e.lj || 2],
                1 == e.lj && (i.ml = e.ml),
                r.w = PropertyFactory.getProp(this, e.w, 0, null, this),
                r.w.k || (i.wi = r.w.v),
                e.d) {
                    var n = new DashProperty(this,e.d,"canvas",this);
                    r.d = n,
                    r.d.k || (i.da = r.d.dashArray,
                    i.do = r.d.dashoffset[0])
                }
            } else
                i.r = 2 === e.r ? "evenodd" : "nonzero";
            return this.stylesList.push(i),
            r.style = i,
            r
        }
        ,
        CVShapeElement.prototype.createGroupElement = function() {
            return {
                it: [],
                prevViewData: []
            }
        }
        ,
        CVShapeElement.prototype.createTransformElement = function(e) {
            return {
                transform: {
                    opacity: 1,
                    _opMdf: !1,
                    key: this.transformsManager.getNewKey(),
                    op: PropertyFactory.getProp(this, e.o, 0, .01, this),
                    mProps: TransformPropertyFactory.getTransformProperty(this, e, this)
                }
            }
        }
        ,
        CVShapeElement.prototype.createShapeElement = function(e) {
            var t = new CVShapeData(this,e,this.stylesList,this.transformsManager);
            return this.shapes.push(t),
            this.addShapeToModifiers(t),
            t
        }
        ,
        CVShapeElement.prototype.reloadShapes = function() {
            var e;
            this._isFirstFrame = !0;
            var t = this.itemsData.length;
            for (e = 0; e < t; e += 1)
                this.prevViewData[e] = this.itemsData[e];
            for (this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, !0, []),
            t = this.dynamicProperties.length,
            e = 0; e < t; e += 1)
                this.dynamicProperties[e].getValue();
            this.renderModifiers(),
            this.transformsManager.processSequences(this._isFirstFrame)
        }
        ,
        CVShapeElement.prototype.addTransformToStyleList = function(e) {
            var t, i = this.stylesList.length;
            for (t = 0; t < i; t += 1)
                this.stylesList[t].closed || this.stylesList[t].transforms.push(e)
        }
        ,
        CVShapeElement.prototype.removeTransformFromStyleList = function() {
            var e, t = this.stylesList.length;
            for (e = 0; e < t; e += 1)
                this.stylesList[e].closed || this.stylesList[e].transforms.pop()
        }
        ,
        CVShapeElement.prototype.closeStyles = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t].closed = !0
        }
        ,
        CVShapeElement.prototype.searchShapes = function(e, t, i, r, n) {
            var a, o, s, l, h, c, p = e.length - 1, u = [], d = [], f = [].concat(n);
            for (a = p; a >= 0; a -= 1) {
                if ((l = this.searchProcessedElement(e[a])) ? t[a] = i[l - 1] : e[a]._shouldRender = r,
                "fl" === e[a].ty || "st" === e[a].ty || "gf" === e[a].ty || "gs" === e[a].ty)
                    l ? t[a].style.closed = !1 : t[a] = this.createStyleElement(e[a], f),
                    u.push(t[a].style);
                else if ("gr" === e[a].ty) {
                    if (l)
                        for (s = t[a].it.length,
                        o = 0; o < s; o += 1)
                            t[a].prevViewData[o] = t[a].it[o];
                    else
                        t[a] = this.createGroupElement(e[a]);
                    this.searchShapes(e[a].it, t[a].it, t[a].prevViewData, r, f)
                } else
                    "tr" === e[a].ty ? (l || (c = this.createTransformElement(e[a]),
                    t[a] = c),
                    f.push(t[a]),
                    this.addTransformToStyleList(t[a])) : "sh" === e[a].ty || "rc" === e[a].ty || "el" === e[a].ty || "sr" === e[a].ty ? l || (t[a] = this.createShapeElement(e[a])) : "tm" === e[a].ty || "rd" === e[a].ty || "pb" === e[a].ty ? (l ? (h = t[a]).closed = !1 : ((h = ShapeModifiers.getModifier(e[a].ty)).init(this, e[a]),
                    t[a] = h,
                    this.shapeModifiers.push(h)),
                    d.push(h)) : "rp" === e[a].ty && (l ? (h = t[a]).closed = !0 : (h = ShapeModifiers.getModifier(e[a].ty),
                    t[a] = h,
                    h.init(this, e, a, t),
                    this.shapeModifiers.push(h),
                    r = !1),
                    d.push(h));
                this.addProcessedElement(e[a], a + 1)
            }
            for (this.removeTransformFromStyleList(),
            this.closeStyles(u),
            p = d.length,
            a = 0; a < p; a += 1)
                d[a].closed = !0
        }
        ,
        CVShapeElement.prototype.renderInnerContent = function() {
            this.transformHelper.opacity = 1,
            this.transformHelper._opMdf = !1,
            this.renderModifiers(),
            this.transformsManager.processSequences(this._isFirstFrame),
            this.renderShape(this.transformHelper, this.shapesData, this.itemsData, !0)
        }
        ,
        CVShapeElement.prototype.renderShapeTransform = function(e, t) {
            (e._opMdf || t.op._mdf || this._isFirstFrame) && (t.opacity = e.opacity,
            t.opacity *= t.op.v,
            t._opMdf = !0)
        }
        ,
        CVShapeElement.prototype.drawLayer = function() {
            var e, t, i, r, n, a, o, s, l, h = this.stylesList.length, c = this.globalData.renderer, p = this.globalData.canvasContext;
            for (e = 0; e < h; e += 1)
                if (("st" !== (s = (l = this.stylesList[e]).type) && "gs" !== s || 0 !== l.wi) && l.data._shouldRender && 0 !== l.coOp && 0 !== this.globalData.currentGlobalAlpha) {
                    for (c.save(),
                    a = l.elements,
                    "st" === s || "gs" === s ? (p.strokeStyle = "st" === s ? l.co : l.grd,
                    p.lineWidth = l.wi,
                    p.lineCap = l.lc,
                    p.lineJoin = l.lj,
                    p.miterLimit = l.ml || 0) : p.fillStyle = "fl" === s ? l.co : l.grd,
                    c.ctxOpacity(l.coOp),
                    "st" !== s && "gs" !== s && p.beginPath(),
                    c.ctxTransform(l.preTransforms.finalTransform.props),
                    i = a.length,
                    t = 0; t < i; t += 1) {
                        for ("st" !== s && "gs" !== s || (p.beginPath(),
                        l.da && (p.setLineDash(l.da),
                        p.lineDashOffset = l.do)),
                        n = (o = a[t].trNodes).length,
                        r = 0; r < n; r += 1)
                            "m" === o[r].t ? p.moveTo(o[r].p[0], o[r].p[1]) : "c" === o[r].t ? p.bezierCurveTo(o[r].pts[0], o[r].pts[1], o[r].pts[2], o[r].pts[3], o[r].pts[4], o[r].pts[5]) : p.closePath();
                        "st" !== s && "gs" !== s || (p.stroke(),
                        l.da && p.setLineDash(this.dashResetter))
                    }
                    "st" !== s && "gs" !== s && p.fill(l.r),
                    c.restore()
                }
        }
        ,
        CVShapeElement.prototype.renderShape = function(e, t, i, r) {
            var n, a;
            for (a = e,
            n = t.length - 1; n >= 0; n -= 1)
                "tr" === t[n].ty ? (a = i[n].transform,
                this.renderShapeTransform(e, a)) : "sh" === t[n].ty || "el" === t[n].ty || "rc" === t[n].ty || "sr" === t[n].ty ? this.renderPath(t[n], i[n]) : "fl" === t[n].ty ? this.renderFill(t[n], i[n], a) : "st" === t[n].ty ? this.renderStroke(t[n], i[n], a) : "gf" === t[n].ty || "gs" === t[n].ty ? this.renderGradientFill(t[n], i[n], a) : "gr" === t[n].ty ? this.renderShape(a, t[n].it, i[n].it) : t[n].ty;
            r && this.drawLayer()
        }
        ,
        CVShapeElement.prototype.renderStyledShape = function(e, t) {
            if (this._isFirstFrame || t._mdf || e.transforms._mdf) {
                var i, r, n, a = e.trNodes, o = t.paths, s = o._length;
                a.length = 0;
                var l = e.transforms.finalTransform;
                for (n = 0; n < s; n += 1) {
                    var h = o.shapes[n];
                    if (h && h.v) {
                        for (r = h._length,
                        i = 1; i < r; i += 1)
                            1 === i && a.push({
                                t: "m",
                                p: l.applyToPointArray(h.v[0][0], h.v[0][1], 0)
                            }),
                            a.push({
                                t: "c",
                                pts: l.applyToTriplePoints(h.o[i - 1], h.i[i], h.v[i])
                            });
                        1 === r && a.push({
                            t: "m",
                            p: l.applyToPointArray(h.v[0][0], h.v[0][1], 0)
                        }),
                        h.c && r && (a.push({
                            t: "c",
                            pts: l.applyToTriplePoints(h.o[i - 1], h.i[0], h.v[0])
                        }),
                        a.push({
                            t: "z"
                        }))
                    }
                }
                e.trNodes = a
            }
        }
        ,
        CVShapeElement.prototype.renderPath = function(e, t) {
            if (!0 !== e.hd && e._shouldRender) {
                var i, r = t.styledShapes.length;
                for (i = 0; i < r; i += 1)
                    this.renderStyledShape(t.styledShapes[i], t.sh)
            }
        }
        ,
        CVShapeElement.prototype.renderFill = function(e, t, i) {
            var r = t.style;
            (t.c._mdf || this._isFirstFrame) && (r.co = "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
            (t.o._mdf || i._opMdf || this._isFirstFrame) && (r.coOp = t.o.v * i.opacity)
        }
        ,
        CVShapeElement.prototype.renderGradientFill = function(e, t, i) {
            var r, n = t.style;
            if (!n.grd || t.g._mdf || t.s._mdf || t.e._mdf || 1 !== e.t && (t.h._mdf || t.a._mdf)) {
                var a, o = this.globalData.canvasContext, s = t.s.v, l = t.e.v;
                if (1 === e.t)
                    r = o.createLinearGradient(s[0], s[1], l[0], l[1]);
                else {
                    var h = Math.sqrt(Math.pow(s[0] - l[0], 2) + Math.pow(s[1] - l[1], 2))
                      , c = Math.atan2(l[1] - s[1], l[0] - s[0])
                      , p = t.h.v;
                    p >= 1 ? p = .99 : p <= -1 && (p = -.99);
                    var u = h * p
                      , d = Math.cos(c + t.a.v) * u + s[0]
                      , f = Math.sin(c + t.a.v) * u + s[1];
                    r = o.createRadialGradient(d, f, 0, s[0], s[1], h)
                }
                var m = e.g.p
                  , g = t.g.c
                  , v = 1;
                for (a = 0; a < m; a += 1)
                    t.g._hasOpacity && t.g._collapsable && (v = t.g.o[2 * a + 1]),
                    r.addColorStop(g[4 * a] / 100, "rgba(" + g[4 * a + 1] + "," + g[4 * a + 2] + "," + g[4 * a + 3] + "," + v + ")");
                n.grd = r
            }
            n.coOp = t.o.v * i.opacity
        }
        ,
        CVShapeElement.prototype.renderStroke = function(e, t, i) {
            var r = t.style
              , n = t.d;
            n && (n._mdf || this._isFirstFrame) && (r.da = n.dashArray,
            r.do = n.dashoffset[0]),
            (t.c._mdf || this._isFirstFrame) && (r.co = "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
            (t.o._mdf || i._opMdf || this._isFirstFrame) && (r.coOp = t.o.v * i.opacity),
            (t.w._mdf || this._isFirstFrame) && (r.wi = t.w.v)
        }
        ,
        CVShapeElement.prototype.destroy = function() {
            this.shapesData = null,
            this.globalData = null,
            this.canvasContext = null,
            this.stylesList.length = 0,
            this.itemsData.length = 0
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement], CVSolidElement),
        CVSolidElement.prototype.initElement = SVGShapeElement.prototype.initElement,
        CVSolidElement.prototype.prepareFrame = IImageElement.prototype.prepareFrame,
        CVSolidElement.prototype.renderInnerContent = function() {
            var e = this.canvasContext;
            e.fillStyle = this.data.sc,
            e.fillRect(0, 0, this.data.sw, this.data.sh)
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement, ITextElement], CVTextElement),
        CVTextElement.prototype.tHelper = createTag("canvas").getContext("2d"),
        CVTextElement.prototype.buildNewText = function() {
            var e = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(e.l ? e.l.length : 0);
            var t = !1;
            e.fc ? (t = !0,
            this.values.fill = this.buildColor(e.fc)) : this.values.fill = "rgba(0,0,0,0)",
            this.fill = t;
            var i = !1;
            e.sc && (i = !0,
            this.values.stroke = this.buildColor(e.sc),
            this.values.sWidth = e.sw);
            var r, n, a, o, s, l, h, c, p, u, d, f, m = this.globalData.fontManager.getFontByName(e.f), g = e.l, v = this.mHelper;
            this.stroke = i,
            this.values.fValue = e.finalSize + "px " + this.globalData.fontManager.getFontByName(e.f).fFamily,
            n = e.finalText.length;
            var y = this.data.singleShape
              , _ = .001 * e.tr * e.finalSize
              , b = 0
              , x = 0
              , w = !0
              , S = 0;
            for (r = 0; r < n; r += 1) {
                for (o = (a = this.globalData.fontManager.getCharData(e.finalText[r], m.fStyle, this.globalData.fontManager.getFontByName(e.f).fFamily)) && a.data || {},
                v.reset(),
                y && g[r].n && (b = -_,
                x += e.yOffset,
                x += w ? 1 : 0,
                w = !1),
                p = (h = o.shapes ? o.shapes[0].it : []).length,
                v.scale(e.finalSize / 100, e.finalSize / 100),
                y && this.applyTextPropertiesToMatrix(e, v, g[r].line, b, x),
                d = createSizedArray(p),
                c = 0; c < p; c += 1) {
                    for (l = h[c].ks.k.i.length,
                    u = h[c].ks.k,
                    f = [],
                    s = 1; s < l; s += 1)
                        1 === s && f.push(v.applyToX(u.v[0][0], u.v[0][1], 0), v.applyToY(u.v[0][0], u.v[0][1], 0)),
                        f.push(v.applyToX(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToY(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToX(u.i[s][0], u.i[s][1], 0), v.applyToY(u.i[s][0], u.i[s][1], 0), v.applyToX(u.v[s][0], u.v[s][1], 0), v.applyToY(u.v[s][0], u.v[s][1], 0));
                    f.push(v.applyToX(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToY(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToX(u.i[0][0], u.i[0][1], 0), v.applyToY(u.i[0][0], u.i[0][1], 0), v.applyToX(u.v[0][0], u.v[0][1], 0), v.applyToY(u.v[0][0], u.v[0][1], 0)),
                    d[c] = f
                }
                y && (b += g[r].l,
                b += _),
                this.textSpans[S] ? this.textSpans[S].elem = d : this.textSpans[S] = {
                    elem: d
                },
                S += 1
            }
        }
        ,
        CVTextElement.prototype.renderInnerContent = function() {
            var e, t, i, r, n, a, o = this.canvasContext;
            o.font = this.values.fValue,
            o.lineCap = "butt",
            o.lineJoin = "miter",
            o.miterLimit = 4,
            this.data.singleShape || this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag);
            var s, l = this.textAnimator.renderedLetters, h = this.textProperty.currentData.l;
            t = h.length;
            var c, p, u = null, d = null, f = null;
            for (e = 0; e < t; e += 1)
                if (!h[e].n) {
                    if ((s = l[e]) && (this.globalData.renderer.save(),
                    this.globalData.renderer.ctxTransform(s.p),
                    this.globalData.renderer.ctxOpacity(s.o)),
                    this.fill) {
                        for (s && s.fc ? u !== s.fc && (u = s.fc,
                        o.fillStyle = s.fc) : u !== this.values.fill && (u = this.values.fill,
                        o.fillStyle = this.values.fill),
                        r = (c = this.textSpans[e].elem).length,
                        this.globalData.canvasContext.beginPath(),
                        i = 0; i < r; i += 1)
                            for (a = (p = c[i]).length,
                            this.globalData.canvasContext.moveTo(p[0], p[1]),
                            n = 2; n < a; n += 6)
                                this.globalData.canvasContext.bezierCurveTo(p[n], p[n + 1], p[n + 2], p[n + 3], p[n + 4], p[n + 5]);
                        this.globalData.canvasContext.closePath(),
                        this.globalData.canvasContext.fill()
                    }
                    if (this.stroke) {
                        for (s && s.sw ? f !== s.sw && (f = s.sw,
                        o.lineWidth = s.sw) : f !== this.values.sWidth && (f = this.values.sWidth,
                        o.lineWidth = this.values.sWidth),
                        s && s.sc ? d !== s.sc && (d = s.sc,
                        o.strokeStyle = s.sc) : d !== this.values.stroke && (d = this.values.stroke,
                        o.strokeStyle = this.values.stroke),
                        r = (c = this.textSpans[e].elem).length,
                        this.globalData.canvasContext.beginPath(),
                        i = 0; i < r; i += 1)
                            for (a = (p = c[i]).length,
                            this.globalData.canvasContext.moveTo(p[0], p[1]),
                            n = 2; n < a; n += 6)
                                this.globalData.canvasContext.bezierCurveTo(p[n], p[n + 1], p[n + 2], p[n + 3], p[n + 4], p[n + 5]);
                        this.globalData.canvasContext.closePath(),
                        this.globalData.canvasContext.stroke()
                    }
                    s && this.globalData.renderer.restore()
                }
        }
        ,
        CVEffects.prototype.renderFrame = function() {}
        ,
        HBaseElement.prototype = {
            checkBlendMode: function() {},
            initRendererElement: function() {
                this.baseElement = createTag(this.data.tg || "div"),
                this.data.hasMask ? (this.svgElement = createNS("svg"),
                this.layerElement = createNS("g"),
                this.maskedElement = this.layerElement,
                this.svgElement.appendChild(this.layerElement),
                this.baseElement.appendChild(this.svgElement)) : this.layerElement = this.baseElement,
                styleDiv(this.baseElement)
            },
            createContainerElements: function() {
                this.renderableEffectsManager = new CVEffects,
                this.transformedElement = this.baseElement,
                this.maskedElement = this.layerElement,
                this.data.ln && this.layerElement.setAttribute("id", this.data.ln),
                this.data.cl && this.layerElement.setAttribute("class", this.data.cl),
                0 !== this.data.bm && this.setBlendMode()
            },
            renderElement: function() {
                var e = this.transformedElement ? this.transformedElement.style : {};
                if (this.finalTransform._matMdf) {
                    var t = this.finalTransform.mat.toCSS();
                    e.transform = t,
                    e.webkitTransform = t
                }
                this.finalTransform._opMdf && (e.opacity = this.finalTransform.mProp.o.v)
            },
            renderFrame: function() {
                this.data.hd || this.hidden || (this.renderTransform(),
                this.renderRenderable(),
                this.renderElement(),
                this.renderInnerContent(),
                this._isFirstFrame && (this._isFirstFrame = !1))
            },
            destroy: function() {
                this.layerElement = null,
                this.transformedElement = null,
                this.matteElement && (this.matteElement = null),
                this.maskManager && (this.maskManager.destroy(),
                this.maskManager = null)
            },
            createRenderableComponents: function() {
                this.maskManager = new MaskElement(this.data,this,this.globalData)
            },
            addEffects: function() {},
            setMatte: function() {}
        },
        HBaseElement.prototype.getBaseElement = SVGBaseElement.prototype.getBaseElement,
        HBaseElement.prototype.destroyBaseElement = HBaseElement.prototype.destroy,
        HBaseElement.prototype.buildElementParenting = HybridRenderer.prototype.buildElementParenting,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HierarchyElement, FrameElement, RenderableDOMElement], HSolidElement),
        HSolidElement.prototype.createContent = function() {
            var e;
            this.data.hasMask ? ((e = createNS("rect")).setAttribute("width", this.data.sw),
            e.setAttribute("height", this.data.sh),
            e.setAttribute("fill", this.data.sc),
            this.svgElement.setAttribute("width", this.data.sw),
            this.svgElement.setAttribute("height", this.data.sh)) : ((e = createTag("div")).style.width = this.data.sw + "px",
            e.style.height = this.data.sh + "px",
            e.style.backgroundColor = this.data.sc),
            this.layerElement.appendChild(e)
        }
        ,
        extendPrototype([HybridRenderer, ICompElement, HBaseElement], HCompElement),
        HCompElement.prototype._createBaseContainerElements = HCompElement.prototype.createContainerElements,
        HCompElement.prototype.createContainerElements = function() {
            this._createBaseContainerElements(),
            this.data.hasMask ? (this.svgElement.setAttribute("width", this.data.w),
            this.svgElement.setAttribute("height", this.data.h),
            this.transformedElement = this.baseElement) : this.transformedElement = this.layerElement
        }
        ,
        HCompElement.prototype.addTo3dContainer = function(e, t) {
            for (var i, r = 0; r < t; )
                this.elements[r] && this.elements[r].getBaseElement && (i = this.elements[r].getBaseElement()),
                r += 1;
            i ? this.layerElement.insertBefore(e, i) : this.layerElement.appendChild(e)
        }
        ,
        extendPrototype([BaseElement, TransformElement, HSolidElement, SVGShapeElement, HBaseElement, HierarchyElement, FrameElement, RenderableElement], HShapeElement),
        HShapeElement.prototype._renderShapeFrame = HShapeElement.prototype.renderInnerContent,
        HShapeElement.prototype.createContent = function() {
            var e;
            if (this.baseElement.style.fontSize = 0,
            this.data.hasMask)
                this.layerElement.appendChild(this.shapesContainer),
                e = this.svgElement;
            else {
                e = createNS("svg");
                var t = this.comp.data ? this.comp.data : this.globalData.compSize;
                e.setAttribute("width", t.w),
                e.setAttribute("height", t.h),
                e.appendChild(this.shapesContainer),
                this.layerElement.appendChild(e)
            }
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.shapesContainer, 0, [], !0),
            this.filterUniqueShapes(),
            this.shapeCont = e
        }
        ,
        HShapeElement.prototype.getTransformedPoint = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                t = e[i].mProps.v.applyToPointArray(t[0], t[1], 0);
            return t
        }
        ,
        HShapeElement.prototype.calculateShapeBoundingBox = function(e, t) {
            var i, r, n, a, o, s = e.sh.v, l = e.transformers, h = s._length;
            if (!(h <= 1)) {
                for (i = 0; i < h - 1; i += 1)
                    r = this.getTransformedPoint(l, s.v[i]),
                    n = this.getTransformedPoint(l, s.o[i]),
                    a = this.getTransformedPoint(l, s.i[i + 1]),
                    o = this.getTransformedPoint(l, s.v[i + 1]),
                    this.checkBounds(r, n, a, o, t);
                s.c && (r = this.getTransformedPoint(l, s.v[i]),
                n = this.getTransformedPoint(l, s.o[i]),
                a = this.getTransformedPoint(l, s.i[0]),
                o = this.getTransformedPoint(l, s.v[0]),
                this.checkBounds(r, n, a, o, t))
            }
        }
        ,
        HShapeElement.prototype.checkBounds = function(e, t, i, r, n) {
            this.getBoundsOfCurve(e, t, i, r);
            var a = this.shapeBoundingBox;
            n.x = bmMin(a.left, n.x),
            n.xMax = bmMax(a.right, n.xMax),
            n.y = bmMin(a.top, n.y),
            n.yMax = bmMax(a.bottom, n.yMax)
        }
        ,
        HShapeElement.prototype.shapeBoundingBox = {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
        },
        HShapeElement.prototype.tempBoundingBox = {
            x: 0,
            xMax: 0,
            y: 0,
            yMax: 0,
            width: 0,
            height: 0
        },
        HShapeElement.prototype.getBoundsOfCurve = function(e, t, i, r) {
            for (var n, a, o, s, l, h, c, p = [[e[0], r[0]], [e[1], r[1]]], u = 0; u < 2; ++u)
                a = 6 * e[u] - 12 * t[u] + 6 * i[u],
                n = -3 * e[u] + 9 * t[u] - 9 * i[u] + 3 * r[u],
                o = 3 * t[u] - 3 * e[u],
                a |= 0,
                o |= 0,
                0 == (n |= 0) && 0 === a || (0 === n ? (s = -o / a) > 0 && s < 1 && p[u].push(this.calculateF(s, e, t, i, r, u)) : (l = a * a - 4 * o * n) >= 0 && ((h = (-a + bmSqrt(l)) / (2 * n)) > 0 && h < 1 && p[u].push(this.calculateF(h, e, t, i, r, u)),
                (c = (-a - bmSqrt(l)) / (2 * n)) > 0 && c < 1 && p[u].push(this.calculateF(c, e, t, i, r, u))));
            this.shapeBoundingBox.left = bmMin.apply(null, p[0]),
            this.shapeBoundingBox.top = bmMin.apply(null, p[1]),
            this.shapeBoundingBox.right = bmMax.apply(null, p[0]),
            this.shapeBoundingBox.bottom = bmMax.apply(null, p[1])
        }
        ,
        HShapeElement.prototype.calculateF = function(e, t, i, r, n, a) {
            return bmPow(1 - e, 3) * t[a] + 3 * bmPow(1 - e, 2) * e * i[a] + 3 * (1 - e) * bmPow(e, 2) * r[a] + bmPow(e, 3) * n[a]
        }
        ,
        HShapeElement.prototype.calculateBoundingBox = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                e[i] && e[i].sh ? this.calculateShapeBoundingBox(e[i], t) : e[i] && e[i].it && this.calculateBoundingBox(e[i].it, t)
        }
        ,
        HShapeElement.prototype.currentBoxContains = function(e) {
            return this.currentBBox.x <= e.x && this.currentBBox.y <= e.y && this.currentBBox.width + this.currentBBox.x >= e.x + e.width && this.currentBBox.height + this.currentBBox.y >= e.y + e.height
        }
        ,
        HShapeElement.prototype.renderInnerContent = function() {
            if (this._renderShapeFrame(),
            !this.hidden && (this._isFirstFrame || this._mdf)) {
                var e = this.tempBoundingBox
                  , t = 999999;
                if (e.x = t,
                e.xMax = -t,
                e.y = t,
                e.yMax = -t,
                this.calculateBoundingBox(this.itemsData, e),
                e.width = e.xMax < e.x ? 0 : e.xMax - e.x,
                e.height = e.yMax < e.y ? 0 : e.yMax - e.y,
                this.currentBoxContains(e))
                    return;
                var i = !1;
                if (this.currentBBox.w !== e.width && (this.currentBBox.w = e.width,
                this.shapeCont.setAttribute("width", e.width),
                i = !0),
                this.currentBBox.h !== e.height && (this.currentBBox.h = e.height,
                this.shapeCont.setAttribute("height", e.height),
                i = !0),
                i || this.currentBBox.x !== e.x || this.currentBBox.y !== e.y) {
                    this.currentBBox.w = e.width,
                    this.currentBBox.h = e.height,
                    this.currentBBox.x = e.x,
                    this.currentBBox.y = e.y,
                    this.shapeCont.setAttribute("viewBox", this.currentBBox.x + " " + this.currentBBox.y + " " + this.currentBBox.w + " " + this.currentBBox.h);
                    var r = this.shapeCont.style
                      , n = "translate(" + this.currentBBox.x + "px," + this.currentBBox.y + "px)";
                    r.transform = n,
                    r.webkitTransform = n
                }
            }
        }
        ,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HierarchyElement, FrameElement, RenderableDOMElement, ITextElement], HTextElement),
        HTextElement.prototype.createContent = function() {
            if (this.isMasked = this.checkMasks(),
            this.isMasked) {
                this.renderType = "svg",
                this.compW = this.comp.data.w,
                this.compH = this.comp.data.h,
                this.svgElement.setAttribute("width", this.compW),
                this.svgElement.setAttribute("height", this.compH);
                var e = createNS("g");
                this.maskedElement.appendChild(e),
                this.innerElem = e
            } else
                this.renderType = "html",
                this.innerElem = this.layerElement;
            this.checkParenting()
        }
        ,
        HTextElement.prototype.buildNewText = function() {
            var e = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(e.l ? e.l.length : 0);
            var t = this.innerElem.style
              , i = e.fc ? this.buildColor(e.fc) : "rgba(0,0,0,0)";
            t.fill = i,
            t.color = i,
            e.sc && (t.stroke = this.buildColor(e.sc),
            t.strokeWidth = e.sw + "px");
            var r, n, a = this.globalData.fontManager.getFontByName(e.f);
            if (!this.globalData.fontManager.chars)
                if (t.fontSize = e.finalSize + "px",
                t.lineHeight = e.finalSize + "px",
                a.fClass)
                    this.innerElem.className = a.fClass;
                else {
                    t.fontFamily = a.fFamily;
                    var o = e.fWeight
                      , s = e.fStyle;
                    t.fontStyle = s,
                    t.fontWeight = o
                }
            var l, h, c, p = e.l;
            n = p.length;
            var u, d = this.mHelper, f = "", m = 0;
            for (r = 0; r < n; r += 1) {
                if (this.globalData.fontManager.chars ? (this.textPaths[m] ? l = this.textPaths[m] : ((l = createNS("path")).setAttribute("stroke-linecap", lineCapEnum[1]),
                l.setAttribute("stroke-linejoin", lineJoinEnum[2]),
                l.setAttribute("stroke-miterlimit", "4")),
                this.isMasked || (this.textSpans[m] ? c = (h = this.textSpans[m]).children[0] : ((h = createTag("div")).style.lineHeight = 0,
                (c = createNS("svg")).appendChild(l),
                styleDiv(h)))) : this.isMasked ? l = this.textPaths[m] ? this.textPaths[m] : createNS("text") : this.textSpans[m] ? (h = this.textSpans[m],
                l = this.textPaths[m]) : (styleDiv(h = createTag("span")),
                styleDiv(l = createTag("span")),
                h.appendChild(l)),
                this.globalData.fontManager.chars) {
                    var g, v = this.globalData.fontManager.getCharData(e.finalText[r], a.fStyle, this.globalData.fontManager.getFontByName(e.f).fFamily);
                    if (g = v ? v.data : null,
                    d.reset(),
                    g && g.shapes && (u = g.shapes[0].it,
                    d.scale(e.finalSize / 100, e.finalSize / 100),
                    f = this.createPathShape(d, u),
                    l.setAttribute("d", f)),
                    this.isMasked)
                        this.innerElem.appendChild(l);
                    else {
                        if (this.innerElem.appendChild(h),
                        g && g.shapes) {
                            document.body.appendChild(c);
                            var y = c.getBBox();
                            c.setAttribute("width", y.width + 2),
                            c.setAttribute("height", y.height + 2),
                            c.setAttribute("viewBox", y.x - 1 + " " + (y.y - 1) + " " + (y.width + 2) + " " + (y.height + 2));
                            var _ = c.style
                              , b = "translate(" + (y.x - 1) + "px," + (y.y - 1) + "px)";
                            _.transform = b,
                            _.webkitTransform = b,
                            p[r].yOffset = y.y - 1
                        } else
                            c.setAttribute("width", 1),
                            c.setAttribute("height", 1);
                        h.appendChild(c)
                    }
                } else if (l.textContent = p[r].val,
                l.setAttributeNS("http://www.w3.org/XML/1998/namespace", "xml:space", "preserve"),
                this.isMasked)
                    this.innerElem.appendChild(l);
                else {
                    this.innerElem.appendChild(h);
                    var x = l.style
                      , w = "translate3d(0," + -e.finalSize / 1.2 + "px,0)";
                    x.transform = w,
                    x.webkitTransform = w
                }
                this.isMasked ? this.textSpans[m] = l : this.textSpans[m] = h,
                this.textSpans[m].style.display = "block",
                this.textPaths[m] = l,
                m += 1
            }
            for (; m < this.textSpans.length; )
                this.textSpans[m].style.display = "none",
                m += 1
        }
        ,
        HTextElement.prototype.renderInnerContent = function() {
            var e;
            if (this.data.singleShape) {
                if (!this._isFirstFrame && !this.lettersChangedFlag)
                    return;
                if (this.isMasked && this.finalTransform._matMdf) {
                    this.svgElement.setAttribute("viewBox", -this.finalTransform.mProp.p.v[0] + " " + -this.finalTransform.mProp.p.v[1] + " " + this.compW + " " + this.compH),
                    e = this.svgElement.style;
                    var t = "translate(" + -this.finalTransform.mProp.p.v[0] + "px," + -this.finalTransform.mProp.p.v[1] + "px)";
                    e.transform = t,
                    e.webkitTransform = t
                }
            }
            if (this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag),
            this.lettersChangedFlag || this.textAnimator.lettersChangedFlag) {
                var i, r, n, a, o, s = 0, l = this.textAnimator.renderedLetters, h = this.textProperty.currentData.l;
                for (r = h.length,
                i = 0; i < r; i += 1)
                    h[i].n ? s += 1 : (a = this.textSpans[i],
                    o = this.textPaths[i],
                    n = l[s],
                    s += 1,
                    n._mdf.m && (this.isMasked ? a.setAttribute("transform", n.m) : (a.style.webkitTransform = n.m,
                    a.style.transform = n.m)),
                    a.style.opacity = n.o,
                    n.sw && n._mdf.sw && o.setAttribute("stroke-width", n.sw),
                    n.sc && n._mdf.sc && o.setAttribute("stroke", n.sc),
                    n.fc && n._mdf.fc && (o.setAttribute("fill", n.fc),
                    o.style.color = n.fc));
                if (this.innerElem.getBBox && !this.hidden && (this._isFirstFrame || this._mdf)) {
                    var c = this.innerElem.getBBox();
                    if (this.currentBBox.w !== c.width && (this.currentBBox.w = c.width,
                    this.svgElement.setAttribute("width", c.width)),
                    this.currentBBox.h !== c.height && (this.currentBBox.h = c.height,
                    this.svgElement.setAttribute("height", c.height)),
                    this.currentBBox.w !== c.width + 2 || this.currentBBox.h !== c.height + 2 || this.currentBBox.x !== c.x - 1 || this.currentBBox.y !== c.y - 1) {
                        this.currentBBox.w = c.width + 2,
                        this.currentBBox.h = c.height + 2,
                        this.currentBBox.x = c.x - 1,
                        this.currentBBox.y = c.y - 1,
                        this.svgElement.setAttribute("viewBox", this.currentBBox.x + " " + this.currentBBox.y + " " + this.currentBBox.w + " " + this.currentBBox.h),
                        e = this.svgElement.style;
                        var p = "translate(" + this.currentBBox.x + "px," + this.currentBBox.y + "px)";
                        e.transform = p,
                        e.webkitTransform = p
                    }
                }
            }
        }
        ,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HSolidElement, HierarchyElement, FrameElement, RenderableElement], HImageElement),
        HImageElement.prototype.createContent = function() {
            var e = this.globalData.getAssetsPath(this.assetData)
              , t = new Image;
            this.data.hasMask ? (this.imageElem = createNS("image"),
            this.imageElem.setAttribute("width", this.assetData.w + "px"),
            this.imageElem.setAttribute("height", this.assetData.h + "px"),
            this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink", "href", e),
            this.layerElement.appendChild(this.imageElem),
            this.baseElement.setAttribute("width", this.assetData.w),
            this.baseElement.setAttribute("height", this.assetData.h)) : this.layerElement.appendChild(t),
            t.crossOrigin = "anonymous",
            t.src = e,
            this.data.ln && this.baseElement.setAttribute("id", this.data.ln)
        }
        ,
        extendPrototype([BaseElement, FrameElement, HierarchyElement], HCameraElement),
        HCameraElement.prototype.setup = function() {
            var e, t, i, r, n = this.comp.threeDElements.length;
            for (e = 0; e < n; e += 1)
                if ("3d" === (t = this.comp.threeDElements[e]).type) {
                    i = t.perspectiveElem.style,
                    r = t.container.style;
                    var a = this.pe.v + "px"
                      , o = "0px 0px 0px"
                      , s = "matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";
                    i.perspective = a,
                    i.webkitPerspective = a,
                    r.transformOrigin = o,
                    r.mozTransformOrigin = o,
                    r.webkitTransformOrigin = o,
                    i.transform = s,
                    i.webkitTransform = s
                }
        }
        ,
        HCameraElement.prototype.createElements = function() {}
        ,
        HCameraElement.prototype.hide = function() {}
        ,
        HCameraElement.prototype.renderFrame = function() {
            var e, t, i = this._isFirstFrame;
            if (this.hierarchy)
                for (t = this.hierarchy.length,
                e = 0; e < t; e += 1)
                    i = this.hierarchy[e].finalTransform.mProp._mdf || i;
            if (i || this.pe._mdf || this.p && this.p._mdf || this.px && (this.px._mdf || this.py._mdf || this.pz._mdf) || this.rx._mdf || this.ry._mdf || this.rz._mdf || this.or._mdf || this.a && this.a._mdf) {
                if (this.mat.reset(),
                this.hierarchy)
                    for (e = t = this.hierarchy.length - 1; e >= 0; e -= 1) {
                        var r = this.hierarchy[e].finalTransform.mProp;
                        this.mat.translate(-r.p.v[0], -r.p.v[1], r.p.v[2]),
                        this.mat.rotateX(-r.or.v[0]).rotateY(-r.or.v[1]).rotateZ(r.or.v[2]),
                        this.mat.rotateX(-r.rx.v).rotateY(-r.ry.v).rotateZ(r.rz.v),
                        this.mat.scale(1 / r.s.v[0], 1 / r.s.v[1], 1 / r.s.v[2]),
                        this.mat.translate(r.a.v[0], r.a.v[1], r.a.v[2])
                    }
                if (this.p ? this.mat.translate(-this.p.v[0], -this.p.v[1], this.p.v[2]) : this.mat.translate(-this.px.v, -this.py.v, this.pz.v),
                this.a) {
                    var n;
                    n = this.p ? [this.p.v[0] - this.a.v[0], this.p.v[1] - this.a.v[1], this.p.v[2] - this.a.v[2]] : [this.px.v - this.a.v[0], this.py.v - this.a.v[1], this.pz.v - this.a.v[2]];
                    var a = Math.sqrt(Math.pow(n[0], 2) + Math.pow(n[1], 2) + Math.pow(n[2], 2))
                      , o = [n[0] / a, n[1] / a, n[2] / a]
                      , s = Math.sqrt(o[2] * o[2] + o[0] * o[0])
                      , l = Math.atan2(o[1], s)
                      , h = Math.atan2(o[0], -o[2]);
                    this.mat.rotateY(h).rotateX(-l)
                }
                this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),
                this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),
                this.mat.translate(this.globalData.compSize.w / 2, this.globalData.compSize.h / 2, 0),
                this.mat.translate(0, 0, this.pe.v);
                var c = !this._prevMat.equals(this.mat);
                if ((c || this.pe._mdf) && this.comp.threeDElements) {
                    var p, u, d;
                    for (t = this.comp.threeDElements.length,
                    e = 0; e < t; e += 1)
                        if ("3d" === (p = this.comp.threeDElements[e]).type) {
                            if (c) {
                                var f = this.mat.toCSS();
                                (d = p.container.style).transform = f,
                                d.webkitTransform = f
                            }
                            this.pe._mdf && ((u = p.perspectiveElem.style).perspective = this.pe.v + "px",
                            u.webkitPerspective = this.pe.v + "px")
                        }
                    this.mat.clone(this._prevMat)
                }
            }
            this._isFirstFrame = !1
        }
        ,
        HCameraElement.prototype.prepareFrame = function(e) {
            this.prepareProperties(e, !0)
        }
        ,
        HCameraElement.prototype.destroy = function() {}
        ,
        HCameraElement.prototype.getBaseElement = function() {
            return null
        }
        ;
        var animationManager = function() {
            var e = {}
              , t = []
              , i = 0
              , r = 0
              , n = 0
              , a = !0
              , o = !1;
            function s(e) {
                for (var i = 0, n = e.target; i < r; )
                    t[i].animation === n && (t.splice(i, 1),
                    i -= 1,
                    r -= 1,
                    n.isPaused || c()),
                    i += 1
            }
            function l(e, i) {
                if (!e)
                    return null;
                for (var n = 0; n < r; ) {
                    if (t[n].elem === e && null !== t[n].elem)
                        return t[n].animation;
                    n += 1
                }
                var a = new AnimationItem;
                return p(a, e),
                a.setData(e, i),
                a
            }
            function h() {
                n += 1,
                f()
            }
            function c() {
                n -= 1
            }
            function p(e, i) {
                e.addEventListener("destroy", s),
                e.addEventListener("_active", h),
                e.addEventListener("_idle", c),
                t.push({
                    elem: i,
                    animation: e
                }),
                r += 1
            }
            function u(e) {
                var s, l = e - i;
                for (s = 0; s < r; s += 1)
                    t[s].animation.advanceTime(l);
                i = e,
                n && !o ? window.requestAnimationFrame(u) : a = !0
            }
            function d(e) {
                i = e,
                window.requestAnimationFrame(u)
            }
            function f() {
                !o && n && a && (window.requestAnimationFrame(d),
                a = !1)
            }
            return e.registerAnimation = l,
            e.loadAnimation = function(e) {
                var t = new AnimationItem;
                return p(t, null),
                t.setParams(e),
                t
            }
            ,
            e.setSpeed = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setSpeed(e, i)
            }
            ,
            e.setDirection = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setDirection(e, i)
            }
            ,
            e.play = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.play(e)
            }
            ,
            e.pause = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.pause(e)
            }
            ,
            e.stop = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.stop(e)
            }
            ,
            e.togglePause = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.togglePause(e)
            }
            ,
            e.searchAnimations = function(e, t, i) {
                var r, n = [].concat([].slice.call(document.getElementsByClassName("lottie")), [].slice.call(document.getElementsByClassName("bodymovin"))), a = n.length;
                for (r = 0; r < a; r += 1)
                    i && n[r].setAttribute("data-bm-type", i),
                    l(n[r], e);
                if (t && 0 === a) {
                    i || (i = "svg");
                    var o = document.getElementsByTagName("body")[0];
                    o.innerText = "";
                    var s = createTag("div");
                    s.style.width = "100%",
                    s.style.height = "100%",
                    s.setAttribute("data-bm-type", i),
                    o.appendChild(s),
                    l(s, e)
                }
            }
            ,
            e.resize = function() {
                var e;
                for (e = 0; e < r; e += 1)
                    t[e].animation.resize()
            }
            ,
            e.goToAndStop = function(e, i, n) {
                var a;
                for (a = 0; a < r; a += 1)
                    t[a].animation.goToAndStop(e, i, n)
            }
            ,
            e.destroy = function(e) {
                var i;
                for (i = r - 1; i >= 0; i -= 1)
                    t[i].animation.destroy(e)
            }
            ,
            e.freeze = function() {
                o = !0
            }
            ,
            e.unfreeze = function() {
                o = !1,
                f()
            }
            ,
            e.setVolume = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setVolume(e, i)
            }
            ,
            e.mute = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.mute(e)
            }
            ,
            e.unmute = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.unmute(e)
            }
            ,
            e.getRegisteredAnimations = function() {
                var e, i = t.length, r = [];
                for (e = 0; e < i; e += 1)
                    r.push(t[e].animation);
                return r
            }
            ,
            e
        }()
          , AnimationItem = function() {
            this._cbs = [],
            this.name = "",
            this.path = "",
            this.isLoaded = !1,
            this.currentFrame = 0,
            this.currentRawFrame = 0,
            this.firstFrame = 0,
            this.totalFrames = 0,
            this.frameRate = 0,
            this.frameMult = 0,
            this.playSpeed = 1,
            this.playDirection = 1,
            this.playCount = 0,
            this.animationData = {},
            this.assets = [],
            this.isPaused = !0,
            this.autoplay = !1,
            this.loop = !0,
            this.renderer = null,
            this.animationID = createElementID(),
            this.assetsPath = "",
            this.timeCompleted = 0,
            this.segmentPos = 0,
            this.isSubframeEnabled = subframeEnabled,
            this.segments = [],
            this._idle = !0,
            this._completedLoop = !1,
            this.projectInterface = ProjectInterface(),
            this.imagePreloader = new ImagePreloader,
            this.audioController = audioControllerFactory(),
            this.markers = [],
            this.configAnimation = this.configAnimation.bind(this),
            this.onSetupError = this.onSetupError.bind(this),
            this.onSegmentComplete = this.onSegmentComplete.bind(this)
        };
        extendPrototype([BaseEvent], AnimationItem),
        AnimationItem.prototype.setParams = function(e) {
            (e.wrapper || e.container) && (this.wrapper = e.wrapper || e.container);
            var t = "svg";
            switch (e.animType ? t = e.animType : e.renderer && (t = e.renderer),
            t) {
            case "canvas":
                this.renderer = new CanvasRenderer(this,e.rendererSettings);
                break;
            case "svg":
                this.renderer = new SVGRenderer(this,e.rendererSettings);
                break;
            default:
                this.renderer = new HybridRenderer(this,e.rendererSettings)
            }
            this.imagePreloader.setCacheType(t, this.renderer.globalData.defs),
            this.renderer.setProjectInterface(this.projectInterface),
            this.animType = t,
            "" === e.loop || null === e.loop || void 0 === e.loop || !0 === e.loop ? this.loop = !0 : !1 === e.loop ? this.loop = !1 : this.loop = parseInt(e.loop, 10),
            this.autoplay = !("autoplay"in e) || e.autoplay,
            this.name = e.name ? e.name : "",
            this.autoloadSegments = !Object.prototype.hasOwnProperty.call(e, "autoloadSegments") || e.autoloadSegments,
            this.assetsPath = e.assetsPath,
            this.initialSegment = e.initialSegment,
            e.audioFactory && this.audioController.setAudioFactory(e.audioFactory),
            e.animationData ? this.setupAnimation(e.animationData) : e.path && (-1 !== e.path.lastIndexOf("\\") ? this.path = e.path.substr(0, e.path.lastIndexOf("\\") + 1) : this.path = e.path.substr(0, e.path.lastIndexOf("/") + 1),
            this.fileName = e.path.substr(e.path.lastIndexOf("/") + 1),
            this.fileName = this.fileName.substr(0, this.fileName.lastIndexOf(".json")),
            dataManager.loadAnimation(e.path, this.configAnimation, this.onSetupError))
        }
        ,
        AnimationItem.prototype.onSetupError = function() {
            this.trigger("data_failed")
        }
        ,
        AnimationItem.prototype.setupAnimation = function(e) {
            dataManager.completeAnimation(e, this.configAnimation)
        }
        ,
        AnimationItem.prototype.setData = function(e, t) {
            t && "object" != _typeof2(t) && (t = JSON.parse(t));
            var i = {
                wrapper: e,
                animationData: t
            }
              , r = e.attributes;
            i.path = r.getNamedItem("data-animation-path") ? r.getNamedItem("data-animation-path").value : r.getNamedItem("data-bm-path") ? r.getNamedItem("data-bm-path").value : r.getNamedItem("bm-path") ? r.getNamedItem("bm-path").value : "",
            i.animType = r.getNamedItem("data-anim-type") ? r.getNamedItem("data-anim-type").value : r.getNamedItem("data-bm-type") ? r.getNamedItem("data-bm-type").value : r.getNamedItem("bm-type") ? r.getNamedItem("bm-type").value : r.getNamedItem("data-bm-renderer") ? r.getNamedItem("data-bm-renderer").value : r.getNamedItem("bm-renderer") ? r.getNamedItem("bm-renderer").value : "canvas";
            var n = r.getNamedItem("data-anim-loop") ? r.getNamedItem("data-anim-loop").value : r.getNamedItem("data-bm-loop") ? r.getNamedItem("data-bm-loop").value : r.getNamedItem("bm-loop") ? r.getNamedItem("bm-loop").value : "";
            "false" === n ? i.loop = !1 : "true" === n ? i.loop = !0 : "" !== n && (i.loop = parseInt(n, 10));
            var a = r.getNamedItem("data-anim-autoplay") ? r.getNamedItem("data-anim-autoplay").value : r.getNamedItem("data-bm-autoplay") ? r.getNamedItem("data-bm-autoplay").value : !r.getNamedItem("bm-autoplay") || r.getNamedItem("bm-autoplay").value;
            i.autoplay = "false" !== a,
            i.name = r.getNamedItem("data-name") ? r.getNamedItem("data-name").value : r.getNamedItem("data-bm-name") ? r.getNamedItem("data-bm-name").value : r.getNamedItem("bm-name") ? r.getNamedItem("bm-name").value : "",
            "false" === (r.getNamedItem("data-anim-prerender") ? r.getNamedItem("data-anim-prerender").value : r.getNamedItem("data-bm-prerender") ? r.getNamedItem("data-bm-prerender").value : r.getNamedItem("bm-prerender") ? r.getNamedItem("bm-prerender").value : "") && (i.prerender = !1),
            this.setParams(i)
        }
        ,
        AnimationItem.prototype.includeLayers = function(e) {
            e.op > this.animationData.op && (this.animationData.op = e.op,
            this.totalFrames = Math.floor(e.op - this.animationData.ip));
            var t, i, r = this.animationData.layers, n = r.length, a = e.layers, o = a.length;
            for (i = 0; i < o; i += 1)
                for (t = 0; t < n; ) {
                    if (r[t].id === a[i].id) {
                        r[t] = a[i];
                        break
                    }
                    t += 1
                }
            if ((e.chars || e.fonts) && (this.renderer.globalData.fontManager.addChars(e.chars),
            this.renderer.globalData.fontManager.addFonts(e.fonts, this.renderer.globalData.defs)),
            e.assets)
                for (n = e.assets.length,
                t = 0; t < n; t += 1)
                    this.animationData.assets.push(e.assets[t]);
            this.animationData.__complete = !1,
            dataManager.completeAnimation(this.animationData, this.onSegmentComplete)
        }
        ,
        AnimationItem.prototype.onSegmentComplete = function(e) {
            this.animationData = e,
            expressionsPlugin && expressionsPlugin.initExpressions(this),
            this.loadNextSegment()
        }
        ,
        AnimationItem.prototype.loadNextSegment = function() {
            var e = this.animationData.segments;
            if (!e || 0 === e.length || !this.autoloadSegments)
                return this.trigger("data_ready"),
                void (this.timeCompleted = this.totalFrames);
            var t = e.shift();
            this.timeCompleted = t.time * this.frameRate;
            var i = this.path + this.fileName + "_" + this.segmentPos + ".json";
            this.segmentPos += 1,
            dataManager.loadData(i, this.includeLayers.bind(this), function() {
                this.trigger("data_failed")
            }
            .bind(this))
        }
        ,
        AnimationItem.prototype.loadSegments = function() {
            this.animationData.segments || (this.timeCompleted = this.totalFrames),
            this.loadNextSegment()
        }
        ,
        AnimationItem.prototype.imagesLoaded = function() {
            this.trigger("loaded_images"),
            this.checkLoaded()
        }
        ,
        AnimationItem.prototype.preloadImages = function() {
            this.imagePreloader.setAssetsPath(this.assetsPath),
            this.imagePreloader.setPath(this.path),
            this.imagePreloader.loadAssets(this.animationData.assets, this.imagesLoaded.bind(this))
        }
        ,
        AnimationItem.prototype.configAnimation = function(e) {
            if (this.renderer)
                try {
                    this.animationData = e,
                    this.initialSegment ? (this.totalFrames = Math.floor(this.initialSegment[1] - this.initialSegment[0]),
                    this.firstFrame = Math.round(this.initialSegment[0])) : (this.totalFrames = Math.floor(this.animationData.op - this.animationData.ip),
                    this.firstFrame = Math.round(this.animationData.ip)),
                    this.renderer.configAnimation(e),
                    e.assets || (e.assets = []),
                    this.assets = this.animationData.assets,
                    this.frameRate = this.animationData.fr,
                    this.frameMult = this.animationData.fr / 1e3,
                    this.renderer.searchExtraCompositions(e.assets),
                    this.markers = markerParser(e.markers || []),
                    this.trigger("config_ready"),
                    this.preloadImages(),
                    this.loadSegments(),
                    this.updaFrameModifier(),
                    this.waitForFontsLoaded(),
                    this.isPaused && this.audioController.pause()
                } catch (t) {
                    this.triggerConfigError(t)
                }
        }
        ,
        AnimationItem.prototype.waitForFontsLoaded = function() {
            this.renderer && (this.renderer.globalData.fontManager.isLoaded ? this.checkLoaded() : setTimeout(this.waitForFontsLoaded.bind(this), 20))
        }
        ,
        AnimationItem.prototype.checkLoaded = function() {
            !this.isLoaded && this.renderer.globalData.fontManager.isLoaded && (this.imagePreloader.loadedImages() || "canvas" !== this.renderer.rendererType) && this.imagePreloader.loadedFootages() && (this.isLoaded = !0,
            expressionsPlugin && expressionsPlugin.initExpressions(this),
            this.renderer.initItems(),
            setTimeout(function() {
                this.trigger("DOMLoaded")
            }
            .bind(this), 0),
            this.gotoFrame(),
            this.autoplay && this.play())
        }
        ,
        AnimationItem.prototype.resize = function() {
            this.renderer.updateContainerSize()
        }
        ,
        AnimationItem.prototype.setSubframe = function(e) {
            this.isSubframeEnabled = !!e
        }
        ,
        AnimationItem.prototype.gotoFrame = function() {
            this.currentFrame = this.isSubframeEnabled ? this.currentRawFrame : ~~this.currentRawFrame,
            this.timeCompleted !== this.totalFrames && this.currentFrame > this.timeCompleted && (this.currentFrame = this.timeCompleted),
            this.trigger("enterFrame"),
            this.renderFrame(),
            this.trigger("drawnFrame")
        }
        ,
        AnimationItem.prototype.renderFrame = function() {
            if (!1 !== this.isLoaded && this.renderer)
                try {
                    this.renderer.renderFrame(this.currentFrame + this.firstFrame)
                } catch (t2) {
                    this.triggerRenderFrameError(t2)
                }
        }
        ,
        AnimationItem.prototype.play = function(e) {
            e && this.name !== e || !0 === this.isPaused && (this.isPaused = !1,
            this.audioController.resume(),
            this._idle && (this._idle = !1,
            this.trigger("_active")))
        }
        ,
        AnimationItem.prototype.pause = function(e) {
            e && this.name !== e || !1 === this.isPaused && (this.isPaused = !0,
            this._idle = !0,
            this.trigger("_idle"),
            this.audioController.pause())
        }
        ,
        AnimationItem.prototype.togglePause = function(e) {
            e && this.name !== e || (!0 === this.isPaused ? this.play() : this.pause())
        }
        ,
        AnimationItem.prototype.stop = function(e) {
            e && this.name !== e || (this.pause(),
            this.playCount = 0,
            this._completedLoop = !1,
            this.setCurrentRawFrameValue(0))
        }
        ,
        AnimationItem.prototype.getMarkerData = function(e) {
            for (var t, i = 0; i < this.markers.length; i += 1)
                if ((t = this.markers[i]).payload && t.payload.name === e)
                    return t;
            return null
        }
        ,
        AnimationItem.prototype.goToAndStop = function(e, t, i) {
            if (!i || this.name === i) {
                var r = Number(e);
                if (isNaN(r)) {
                    var n = this.getMarkerData(e);
                    n && this.goToAndStop(n.time, !0)
                } else
                    t ? this.setCurrentRawFrameValue(e) : this.setCurrentRawFrameValue(e * this.frameModifier);
                this.pause()
            }
        }
        ,
        AnimationItem.prototype.goToAndPlay = function(e, t, i) {
            if (!i || this.name === i) {
                var r = Number(e);
                if (isNaN(r)) {
                    var n = this.getMarkerData(e);
                    n && (n.duration ? this.playSegments([n.time, n.time + n.duration], !0) : this.goToAndStop(n.time, !0))
                } else
                    this.goToAndStop(r, t, i);
                this.play()
            }
        }
        ,
        AnimationItem.prototype.advanceTime = function(e) {
            if (!0 !== this.isPaused && !1 !== this.isLoaded) {
                var t = this.currentRawFrame + e * this.frameModifier
                  , i = !1;
                t >= this.totalFrames - 1 && this.frameModifier > 0 ? this.loop && this.playCount !== this.loop ? t >= this.totalFrames ? (this.playCount += 1,
                this.checkSegments(t % this.totalFrames) || (this.setCurrentRawFrameValue(t % this.totalFrames),
                this._completedLoop = !0,
                this.trigger("loopComplete"))) : this.setCurrentRawFrameValue(t) : this.checkSegments(t > this.totalFrames ? t % this.totalFrames : 0) || (i = !0,
                t = this.totalFrames - 1) : t < 0 ? this.checkSegments(t % this.totalFrames) || (!this.loop || this.playCount-- <= 0 && !0 !== this.loop ? (i = !0,
                t = 0) : (this.setCurrentRawFrameValue(this.totalFrames + t % this.totalFrames),
                this._completedLoop ? this.trigger("loopComplete") : this._completedLoop = !0)) : this.setCurrentRawFrameValue(t),
                i && (this.setCurrentRawFrameValue(t),
                this.pause(),
                this.trigger("complete"))
            }
        }
        ,
        AnimationItem.prototype.adjustSegment = function(e, t) {
            this.playCount = 0,
            e[1] < e[0] ? (this.frameModifier > 0 && (this.playSpeed < 0 ? this.setSpeed(-this.playSpeed) : this.setDirection(-1)),
            this.totalFrames = e[0] - e[1],
            this.timeCompleted = this.totalFrames,
            this.firstFrame = e[1],
            this.setCurrentRawFrameValue(this.totalFrames - .001 - t)) : e[1] > e[0] && (this.frameModifier < 0 && (this.playSpeed < 0 ? this.setSpeed(-this.playSpeed) : this.setDirection(1)),
            this.totalFrames = e[1] - e[0],
            this.timeCompleted = this.totalFrames,
            this.firstFrame = e[0],
            this.setCurrentRawFrameValue(.001 + t)),
            this.trigger("segmentStart")
        }
        ,
        AnimationItem.prototype.setSegment = function(e, t) {
            var i = -1;
            this.isPaused && (this.currentRawFrame + this.firstFrame < e ? i = e : this.currentRawFrame + this.firstFrame > t && (i = t - e)),
            this.firstFrame = e,
            this.totalFrames = t - e,
            this.timeCompleted = this.totalFrames,
            -1 !== i && this.goToAndStop(i, !0)
        }
        ,
        AnimationItem.prototype.playSegments = function(e, t) {
            if (t && (this.segments.length = 0),
            "object" == _typeof2(e[0])) {
                var i, r = e.length;
                for (i = 0; i < r; i += 1)
                    this.segments.push(e[i])
            } else
                this.segments.push(e);
            this.segments.length && t && this.adjustSegment(this.segments.shift(), 0),
            this.isPaused && this.play()
        }
        ,
        AnimationItem.prototype.resetSegments = function(e) {
            this.segments.length = 0,
            this.segments.push([this.animationData.ip, this.animationData.op]),
            e && this.checkSegments(0)
        }
        ,
        AnimationItem.prototype.checkSegments = function(e) {
            return !!this.segments.length && (this.adjustSegment(this.segments.shift(), e),
            !0)
        }
        ,
        AnimationItem.prototype.destroy = function(e) {
            e && this.name !== e || !this.renderer || (this.renderer.destroy(),
            this.imagePreloader.destroy(),
            this.trigger("destroy"),
            this._cbs = null,
            this.onEnterFrame = null,
            this.onLoopComplete = null,
            this.onComplete = null,
            this.onSegmentStart = null,
            this.onDestroy = null,
            this.renderer = null,
            this.renderer = null,
            this.imagePreloader = null,
            this.projectInterface = null)
        }
        ,
        AnimationItem.prototype.setCurrentRawFrameValue = function(e) {
            this.currentRawFrame = e,
            this.gotoFrame()
        }
        ,
        AnimationItem.prototype.setSpeed = function(e) {
            this.playSpeed = e,
            this.updaFrameModifier()
        }
        ,
        AnimationItem.prototype.setDirection = function(e) {
            this.playDirection = e < 0 ? -1 : 1,
            this.updaFrameModifier()
        }
        ,
        AnimationItem.prototype.setVolume = function(e, t) {
            t && this.name !== t || this.audioController.setVolume(e)
        }
        ,
        AnimationItem.prototype.getVolume = function() {
            return this.audioController.getVolume()
        }
        ,
        AnimationItem.prototype.mute = function(e) {
            e && this.name !== e || this.audioController.mute()
        }
        ,
        AnimationItem.prototype.unmute = function(e) {
            e && this.name !== e || this.audioController.unmute()
        }
        ,
        AnimationItem.prototype.updaFrameModifier = function() {
            this.frameModifier = this.frameMult * this.playSpeed * this.playDirection,
            this.audioController.setRate(this.playSpeed * this.playDirection)
        }
        ,
        AnimationItem.prototype.getPath = function() {
            return this.path
        }
        ,
        AnimationItem.prototype.getAssetsPath = function(e) {
            var t = "";
            if (e.e)
                t = e.p;
            else if (this.assetsPath) {
                var i = e.p;
                -1 !== i.indexOf("images/") && (i = i.split("/")[1]),
                t = this.assetsPath + i
            } else
                t = this.path,
                t += e.u ? e.u : "",
                t += e.p;
            return t
        }
        ,
        AnimationItem.prototype.getAssetData = function(e) {
            for (var t = 0, i = this.assets.length; t < i; ) {
                if (e === this.assets[t].id)
                    return this.assets[t];
                t += 1
            }
            return null
        }
        ,
        AnimationItem.prototype.hide = function() {
            this.renderer.hide()
        }
        ,
        AnimationItem.prototype.show = function() {
            this.renderer.show()
        }
        ,
        AnimationItem.prototype.getDuration = function(e) {
            return e ? this.totalFrames : this.totalFrames / this.frameRate
        }
        ,
        AnimationItem.prototype.trigger = function(e) {
            if (this._cbs && this._cbs[e])
                switch (e) {
                case "enterFrame":
                case "drawnFrame":
                    this.triggerEvent(e, new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));
                    break;
                case "loopComplete":
                    this.triggerEvent(e, new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));
                    break;
                case "complete":
                    this.triggerEvent(e, new BMCompleteEvent(e,this.frameMult));
                    break;
                case "segmentStart":
                    this.triggerEvent(e, new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));
                    break;
                case "destroy":
                    this.triggerEvent(e, new BMDestroyEvent(e,this));
                    break;
                default:
                    this.triggerEvent(e)
                }
            "enterFrame" === e && this.onEnterFrame && this.onEnterFrame.call(this, new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),
            "loopComplete" === e && this.onLoopComplete && this.onLoopComplete.call(this, new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),
            "complete" === e && this.onComplete && this.onComplete.call(this, new BMCompleteEvent(e,this.frameMult)),
            "segmentStart" === e && this.onSegmentStart && this.onSegmentStart.call(this, new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),
            "destroy" === e && this.onDestroy && this.onDestroy.call(this, new BMDestroyEvent(e,this))
        }
        ,
        AnimationItem.prototype.triggerRenderFrameError = function(e) {
            var t = new BMRenderFrameErrorEvent(e,this.currentFrame);
            this.triggerEvent("error", t),
            this.onError && this.onError.call(this, t)
        }
        ,
        AnimationItem.prototype.triggerConfigError = function(e) {
            var t = new BMConfigErrorEvent(e,this.currentFrame);
            this.triggerEvent("error", t),
            this.onError && this.onError.call(this, t)
        }
        ;
        var Expressions = {
            initExpressions: function(e) {
                var t = 0
                  , i = [];
                e.renderer.compInterface = CompExpressionInterface(e.renderer),
                e.renderer.globalData.projectInterface.registerComposition(e.renderer),
                e.renderer.globalData.pushExpression = function() {
                    t += 1
                }
                ,
                e.renderer.globalData.popExpression = function() {
                    0 == (t -= 1) && function() {
                        var e, t = i.length;
                        for (e = 0; e < t; e += 1)
                            i[e].release();
                        i.length = 0
                    }()
                }
                ,
                e.renderer.globalData.registerExpressionProperty = function(e) {
                    -1 === i.indexOf(e) && i.push(e)
                }
            }
        };
        expressionsPlugin = Expressions;
        var ExpressionManager = function() {
            var ob = {}
              , Math = BMMath;
            function initiateExpression(elem, data, property) {
                var val = data.x, needsVelocity = /velocity(?![\w\d])/.test(val), _needsRandom = -1 !== val.indexOf("random"), elemType = elem.data.ty, transform, content, effect, thisProperty = property;
                thisProperty.valueAtTime = thisProperty.getValueAtTime,
                Object.defineProperty(thisProperty, "value", {
                    get: function() {
                        return thisProperty.v
                    }
                }),
                elem.comp.frameDuration = 1 / elem.comp.globalData.frameRate,
                elem.comp.displayStartTime = 0,
                elem.data.ip,
                elem.comp.globalData.frameRate,
                elem.data.op,
                elem.comp.globalData.frameRate,
                elem.data.sw && elem.data.sw,
                elem.data.sh && elem.data.sh,
                elem.data.nm;
                var loopIn, loopOut, fromComp, thisLayer, velocityAtTime, scoped_bm_rt, expression_function = eval("[function _expression_function(){" + val + ";scoped_bm_rt=$bm_rt}]")[0], time, value;
                function seedRandom(e) {
                    BMMath.seedrandom(randSeed + e)
                }
                property.kf && data.k.length,
                !this.data || this.data.hd,
                function(e, t) {
                    var i, r, n = this.pv.length ? this.pv.length : 1, a = createTypedArray("float32", n), o = Math.floor(5 * time);
                    for (i = 0,
                    r = 0; i < o; ) {
                        for (r = 0; r < n; r += 1)
                            a[r] += -t + 2 * t * BMMath.random();
                        i += 1
                    }
                    var s = 5 * time
                      , l = s - Math.floor(s)
                      , h = createTypedArray("float32", n);
                    if (n > 1) {
                        for (r = 0; r < n; r += 1)
                            h[r] = this.pv[r] + a[r] + (-t + 2 * t * BMMath.random()) * l;
                        return h
                    }
                    return this.pv + a[0] + (-t + 2 * t * BMMath.random()) * l
                }
                .bind(this),
                thisProperty.loopIn && (loopIn = thisProperty.loopIn.bind(thisProperty)),
                thisProperty.loopOut && (loopOut = thisProperty.loopOut.bind(thisProperty)),
                thisProperty.smooth && thisProperty.smooth.bind(thisProperty),
                this.getValueAtTime && this.getValueAtTime.bind(this),
                this.getVelocityAtTime && (velocityAtTime = this.getVelocityAtTime.bind(this)),
                elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),
                elem.data.ind,
                elem.hierarchy && elem.hierarchy.length;
                var parent, randSeed = Math.floor(1e6 * Math.random());
                function executeExpression(e) {
                    return value = e,
                    this.frameExpressionId === elem.globalData.frameId && "textSelector" !== this.propType ? value : ("textSelector" === this.propType && (this.textIndex,
                    this.textTotal,
                    this.selectorValue),
                    thisLayer || (elem.layerInterface.text,
                    thisLayer = elem.layerInterface,
                    elem.comp.compInterface,
                    thisLayer.toWorld.bind(thisLayer),
                    thisLayer.fromWorld.bind(thisLayer),
                    fromComp = thisLayer.fromComp.bind(thisLayer),
                    thisLayer.toComp.bind(thisLayer),
                    thisLayer.mask && thisLayer.mask.bind(thisLayer)),
                    transform || (transform = elem.layerInterface("ADBE Transform Group")) && transform.anchorPoint,
                    4 !== elemType || content || (content = thisLayer("ADBE Root Vectors Group")),
                    effect || (effect = thisLayer(4)),
                    !(!elem.hierarchy || !elem.hierarchy.length) && !parent && (parent = elem.hierarchy[0].layerInterface),
                    time = this.comp.renderedFrame / this.comp.globalData.frameRate,
                    _needsRandom && seedRandom(randSeed + time),
                    needsVelocity && velocityAtTime(time),
                    expression_function(),
                    this.frameExpressionId = elem.globalData.frameId,
                    scoped_bm_rt.propType,
                    scoped_bm_rt)
                }
                return elem.globalData,
                executeExpression
            }
            return BezierFactory.getBezierEasing(.333, 0, .833, .833, "easeIn").get,
            BezierFactory.getBezierEasing(.167, .167, .667, 1, "easeOut").get,
            BezierFactory.getBezierEasing(.33, 0, .667, 1, "easeInOut").get,
            ob.initiateExpression = initiateExpression,
            ob
        }()
          , expressionHelpers = {
            searchExpressions: function(e, t, i) {
                t.x && (i.k = !0,
                i.x = !0,
                i.initiateExpression = ExpressionManager.initiateExpression,
                i.effectsSequence.push(i.initiateExpression(e, t, i).bind(i)))
            },
            getSpeedAtTime: function(e) {
                var t = this.getValueAtTime(e)
                  , i = this.getValueAtTime(e + -.01)
                  , r = 0;
                if (t.length) {
                    var n;
                    for (n = 0; n < t.length; n += 1)
                        r += Math.pow(i[n] - t[n], 2);
                    r = 100 * Math.sqrt(r)
                } else
                    r = 0;
                return r
            },
            getVelocityAtTime: function(e) {
                if (void 0 !== this.vel)
                    return this.vel;
                var t, i, r = -.001, n = this.getValueAtTime(e), a = this.getValueAtTime(e + r);
                if (n.length)
                    for (t = createTypedArray("float32", n.length),
                    i = 0; i < n.length; i += 1)
                        t[i] = (a[i] - n[i]) / r;
                else
                    t = (a - n) / r;
                return t
            },
            getValueAtTime: function(e) {
                return e *= this.elem.globalData.frameRate,
                (e -= this.offsetTime) !== this._cachingAtTime.lastFrame && (this._cachingAtTime.lastIndex = this._cachingAtTime.lastFrame < e ? this._cachingAtTime.lastIndex : 0,
                this._cachingAtTime.value = this.interpolateValue(e, this._cachingAtTime),
                this._cachingAtTime.lastFrame = e),
                this._cachingAtTime.value
            },
            getStaticValueAtTime: function() {
                return this.pv
            },
            setGroupProperty: function(e) {
                this.propertyGroup = e
            }
        };
        !function() {
            function e(e, t, i) {
                if (!this.k || !this.keyframes)
                    return this.pv;
                e = e ? e.toLowerCase() : "";
                var r, n, a, o, s, l = this.comp.renderedFrame, h = this.keyframes, c = h[h.length - 1].t;
                if (l <= c)
                    return this.pv;
                if (i ? n = c - (r = t ? Math.abs(c - this.elem.comp.globalData.frameRate * t) : Math.max(0, c - this.elem.data.ip)) : ((!t || t > h.length - 1) && (t = h.length - 1),
                r = c - (n = h[h.length - 1 - t].t)),
                "pingpong" === e) {
                    if (Math.floor((l - n) / r) % 2 != 0)
                        return this.getValueAtTime((r - (l - n) % r + n) / this.comp.globalData.frameRate, 0)
                } else {
                    if ("offset" === e) {
                        var p = this.getValueAtTime(n / this.comp.globalData.frameRate, 0)
                          , u = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , d = this.getValueAtTime(((l - n) % r + n) / this.comp.globalData.frameRate, 0)
                          , f = Math.floor((l - n) / r);
                        if (this.pv.length) {
                            for (o = (s = new Array(p.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = (u[a] - p[a]) * f + d[a];
                            return s
                        }
                        return (u - p) * f + d
                    }
                    if ("continue" === e) {
                        var m = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , g = this.getValueAtTime((c - .001) / this.comp.globalData.frameRate, 0);
                        if (this.pv.length) {
                            for (o = (s = new Array(m.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = m[a] + (m[a] - g[a]) * ((l - c) / this.comp.globalData.frameRate) / 5e-4;
                            return s
                        }
                        return m + (l - c) / .001 * (m - g)
                    }
                }
                return this.getValueAtTime(((l - n) % r + n) / this.comp.globalData.frameRate, 0)
            }
            function t(e, t, i) {
                if (!this.k)
                    return this.pv;
                e = e ? e.toLowerCase() : "";
                var r, n, a, o, s, l = this.comp.renderedFrame, h = this.keyframes, c = h[0].t;
                if (l >= c)
                    return this.pv;
                if (i ? n = c + (r = t ? Math.abs(this.elem.comp.globalData.frameRate * t) : Math.max(0, this.elem.data.op - c)) : ((!t || t > h.length - 1) && (t = h.length - 1),
                r = (n = h[t].t) - c),
                "pingpong" === e) {
                    if (Math.floor((c - l) / r) % 2 == 0)
                        return this.getValueAtTime(((c - l) % r + c) / this.comp.globalData.frameRate, 0)
                } else {
                    if ("offset" === e) {
                        var p = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , u = this.getValueAtTime(n / this.comp.globalData.frameRate, 0)
                          , d = this.getValueAtTime((r - (c - l) % r + c) / this.comp.globalData.frameRate, 0)
                          , f = Math.floor((c - l) / r) + 1;
                        if (this.pv.length) {
                            for (o = (s = new Array(p.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = d[a] - (u[a] - p[a]) * f;
                            return s
                        }
                        return d - (u - p) * f
                    }
                    if ("continue" === e) {
                        var m = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , g = this.getValueAtTime((c + .001) / this.comp.globalData.frameRate, 0);
                        if (this.pv.length) {
                            for (o = (s = new Array(m.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = m[a] + (m[a] - g[a]) * (c - l) / .001;
                            return s
                        }
                        return m + (m - g) * (c - l) / .001
                    }
                }
                return this.getValueAtTime((r - ((c - l) % r + c)) / this.comp.globalData.frameRate, 0)
            }
            function i(e, t) {
                if (!this.k)
                    return this.pv;
                if (e = .5 * (e || .4),
                (t = Math.floor(t || 5)) <= 1)
                    return this.pv;
                var i, r, n = this.comp.renderedFrame / this.comp.globalData.frameRate, a = n - e, o = t > 1 ? (n + e - a) / (t - 1) : 1, s = 0, l = 0;
                for (i = this.pv.length ? createTypedArray("float32", this.pv.length) : 0; s < t; ) {
                    if (r = this.getValueAtTime(a + s * o),
                    this.pv.length)
                        for (l = 0; l < this.pv.length; l += 1)
                            i[l] += r[l];
                    else
                        i += r;
                    s += 1
                }
                if (this.pv.length)
                    for (l = 0; l < this.pv.length; l += 1)
                        i[l] /= t;
                else
                    i /= t;
                return i
            }
            function r(e) {
                this._transformCachingAtTime || (this._transformCachingAtTime = {
                    v: new Matrix
                });
                var t = this._transformCachingAtTime.v;
                if (t.cloneFromProps(this.pre.props),
                this.appliedTransformations < 1) {
                    var i = this.a.getValueAtTime(e);
                    t.translate(-i[0] * this.a.mult, -i[1] * this.a.mult, i[2] * this.a.mult)
                }
                if (this.appliedTransformations < 2) {
                    var r = this.s.getValueAtTime(e);
                    t.scale(r[0] * this.s.mult, r[1] * this.s.mult, r[2] * this.s.mult)
                }
                if (this.sk && this.appliedTransformations < 3) {
                    var n = this.sk.getValueAtTime(e)
                      , a = this.sa.getValueAtTime(e);
                    t.skewFromAxis(-n * this.sk.mult, a * this.sa.mult)
                }
                if (this.r && this.appliedTransformations < 4) {
                    var o = this.r.getValueAtTime(e);
                    t.rotate(-o * this.r.mult)
                } else if (!this.r && this.appliedTransformations < 4) {
                    var s = this.rz.getValueAtTime(e)
                      , l = this.ry.getValueAtTime(e)
                      , h = this.rx.getValueAtTime(e)
                      , c = this.or.getValueAtTime(e);
                    t.rotateZ(-s * this.rz.mult).rotateY(l * this.ry.mult).rotateX(h * this.rx.mult).rotateZ(-c[2] * this.or.mult).rotateY(c[1] * this.or.mult).rotateX(c[0] * this.or.mult)
                }
                if (this.data.p && this.data.p.s) {
                    var p = this.px.getValueAtTime(e)
                      , u = this.py.getValueAtTime(e);
                    if (this.data.p.z) {
                        var d = this.pz.getValueAtTime(e);
                        t.translate(p * this.px.mult, u * this.py.mult, -d * this.pz.mult)
                    } else
                        t.translate(p * this.px.mult, u * this.py.mult, 0)
                } else {
                    var f = this.p.getValueAtTime(e);
                    t.translate(f[0] * this.p.mult, f[1] * this.p.mult, -f[2] * this.p.mult)
                }
                return t
            }
            function n() {
                return this.v.clone(new Matrix)
            }
            var a = TransformPropertyFactory.getTransformProperty;
            TransformPropertyFactory.getTransformProperty = function(e, t, i) {
                var o = a(e, t, i);
                return o.dynamicProperties.length ? o.getValueAtTime = r.bind(o) : o.getValueAtTime = n.bind(o),
                o.setGroupProperty = expressionHelpers.setGroupProperty,
                o
            }
            ;
            var o = PropertyFactory.getProp;
            PropertyFactory.getProp = function(r, n, a, s, l) {
                var h = o(r, n, a, s, l);
                h.kf ? h.getValueAtTime = expressionHelpers.getValueAtTime.bind(h) : h.getValueAtTime = expressionHelpers.getStaticValueAtTime.bind(h),
                h.setGroupProperty = expressionHelpers.setGroupProperty,
                h.loopOut = e,
                h.loopIn = t,
                h.smooth = i,
                h.getVelocityAtTime = expressionHelpers.getVelocityAtTime.bind(h),
                h.getSpeedAtTime = expressionHelpers.getSpeedAtTime.bind(h),
                h.numKeys = 1 === n.a ? n.k.length : 0,
                h.propertyIndex = n.ix;
                var c = 0;
                return 0 !== a && (c = createTypedArray("float32", 1 === n.a ? n.k[0].s.length : n.k.length)),
                h._cachingAtTime = {
                    lastFrame: initialDefaultFrame,
                    lastIndex: 0,
                    value: c
                },
                expressionHelpers.searchExpressions(r, n, h),
                h.k && l.addDynamicProperty(h),
                h
            }
            ;
            var s = ShapePropertyFactory.getConstructorFunction()
              , l = ShapePropertyFactory.getKeyframedConstructorFunction();
            function h() {}
            h.prototype = {
                vertices: function(e, t) {
                    this.k && this.getValue();
                    var i, r = this.v;
                    void 0 !== t && (r = this.getValueAtTime(t, 0));
                    var n = r._length
                      , a = r[e]
                      , o = r.v
                      , s = createSizedArray(n);
                    for (i = 0; i < n; i += 1)
                        s[i] = "i" === e || "o" === e ? [a[i][0] - o[i][0], a[i][1] - o[i][1]] : [a[i][0], a[i][1]];
                    return s
                },
                points: function(e) {
                    return this.vertices("v", e)
                },
                inTangents: function(e) {
                    return this.vertices("i", e)
                },
                outTangents: function(e) {
                    return this.vertices("o", e)
                },
                isClosed: function() {
                    return this.v.c
                },
                pointOnPath: function(e, t) {
                    var i = this.v;
                    void 0 !== t && (i = this.getValueAtTime(t, 0)),
                    this._segmentsLength || (this._segmentsLength = bez.getSegmentsLength(i));
                    for (var r, n = this._segmentsLength, a = n.lengths, o = n.totalLength * e, s = 0, l = a.length, h = 0; s < l; ) {
                        if (h + a[s].addedLength > o) {
                            var c = s
                              , p = i.c && s === l - 1 ? 0 : s + 1
                              , u = (o - h) / a[s].addedLength;
                            r = bez.getPointInSegment(i.v[c], i.v[p], i.o[c], i.i[p], u, a[s]);
                            break
                        }
                        h += a[s].addedLength,
                        s += 1
                    }
                    return r || (r = i.c ? [i.v[0][0], i.v[0][1]] : [i.v[i._length - 1][0], i.v[i._length - 1][1]]),
                    r
                },
                vectorOnPath: function(e, t, i) {
                    1 == e ? e = this.v.c : 0 == e && (e = .999);
                    var r = this.pointOnPath(e, t)
                      , n = this.pointOnPath(e + .001, t)
                      , a = n[0] - r[0]
                      , o = n[1] - r[1]
                      , s = Math.sqrt(Math.pow(a, 2) + Math.pow(o, 2));
                    return 0 === s ? [0, 0] : "tangent" === i ? [a / s, o / s] : [-o / s, a / s]
                },
                tangentOnPath: function(e, t) {
                    return this.vectorOnPath(e, t, "tangent")
                },
                normalOnPath: function(e, t) {
                    return this.vectorOnPath(e, t, "normal")
                },
                setGroupProperty: expressionHelpers.setGroupProperty,
                getValueAtTime: expressionHelpers.getStaticValueAtTime
            },
            extendPrototype([h], s),
            extendPrototype([h], l),
            l.prototype.getValueAtTime = function(e) {
                return this._cachingAtTime || (this._cachingAtTime = {
                    shapeValue: shapePool.clone(this.pv),
                    lastIndex: 0,
                    lastTime: initialDefaultFrame
                }),
                e *= this.elem.globalData.frameRate,
                (e -= this.offsetTime) !== this._cachingAtTime.lastTime && (this._cachingAtTime.lastIndex = this._cachingAtTime.lastTime < e ? this._caching.lastIndex : 0,
                this._cachingAtTime.lastTime = e,
                this.interpolateShape(e, this._cachingAtTime.shapeValue, this._cachingAtTime)),
                this._cachingAtTime.shapeValue
            }
            ,
            l.prototype.initiateExpression = ExpressionManager.initiateExpression;
            var c = ShapePropertyFactory.getShapeProp;
            ShapePropertyFactory.getShapeProp = function(e, t, i, r, n) {
                var a = c(e, t, i, r, n);
                return a.propertyIndex = t.ix,
                a.lock = !1,
                3 === i ? expressionHelpers.searchExpressions(e, t.pt, a) : 4 === i && expressionHelpers.searchExpressions(e, t.ks, a),
                a.k && e.addDynamicProperty(a),
                a
            }
        }(),
        TextProperty.prototype.getExpressionValue = function(e, t) {
            var i = this.calculateExpression(t);
            if (e.t !== i) {
                var r = {};
                return this.copyData(r, e),
                r.t = i.toString(),
                r.__complete = !1,
                r
            }
            return e
        }
        ,
        TextProperty.prototype.searchProperty = function() {
            var e = this.searchKeyframes()
              , t = this.searchExpressions();
            return this.kf = e || t,
            this.kf
        }
        ,
        TextProperty.prototype.searchExpressions = function() {
            return this.data.d.x ? (this.calculateExpression = ExpressionManager.initiateExpression.bind(this)(this.elem, this.data.d, this),
            this.addEffect(this.getExpressionValue.bind(this)),
            !0) : null
        }
        ;
        var ShapePathInterface = function(e, t, i) {
            var r = t.sh;
            function n(e) {
                return "Shape" === e || "shape" === e || "Path" === e || "path" === e || "ADBE Vector Shape" === e || 2 === e ? n.path : null
            }
            var a = propertyGroupFactory(n, i);
            return r.setGroupProperty(PropertyInterface("Path", a)),
            Object.defineProperties(n, {
                path: {
                    get: function() {
                        return r.k && r.getValue(),
                        r
                    }
                },
                shape: {
                    get: function() {
                        return r.k && r.getValue(),
                        r
                    }
                },
                _name: {
                    value: e.nm
                },
                ix: {
                    value: e.ix
                },
                propertyIndex: {
                    value: e.ix
                },
                mn: {
                    value: e.mn
                },
                propertyGroup: {
                    value: i
                }
            }),
            n
        }, propertyGroupFactory = function(e, t) {
            return function(i) {
                return (i = void 0 === i ? 1 : i) <= 0 ? e : t(i - 1)
            }
        }, PropertyInterface = function(e, t) {
            var i = {
                _name: e
            };
            return function(e) {
                return (e = void 0 === e ? 1 : e) <= 0 ? i : t(e - 1)
            }
        }, ShapeExpressionInterface = function() {
            function e(e, o, u) {
                var d, f = [], m = e ? e.length : 0;
                for (d = 0; d < m; d += 1)
                    "gr" === e[d].ty ? f.push(t(e[d], o[d], u)) : "fl" === e[d].ty ? f.push(i(e[d], o[d], u)) : "st" === e[d].ty ? f.push(n(e[d], o[d], u)) : "tm" === e[d].ty ? f.push(a(e[d], o[d], u)) : "tr" === e[d].ty || ("el" === e[d].ty ? f.push(s(e[d], o[d], u)) : "sr" === e[d].ty ? f.push(l(e[d], o[d], u)) : "sh" === e[d].ty ? f.push(ShapePathInterface(e[d], o[d], u)) : "rc" === e[d].ty ? f.push(h(e[d], o[d], u)) : "rd" === e[d].ty ? f.push(c(e[d], o[d], u)) : "rp" === e[d].ty ? f.push(p(e[d], o[d], u)) : "gf" === e[d].ty ? f.push(r(e[d], o[d], u)) : f.push((e[d],
                    o[d],
                    function() {
                        return null
                    }
                    )));
                return f
            }
            function t(t, i, r) {
                var n = function e(t) {
                    switch (t) {
                    case "ADBE Vectors Group":
                    case "Contents":
                    case 2:
                        return e.content;
                    default:
                        return e.transform
                    }
                };
                n.propertyGroup = propertyGroupFactory(n, r);
                var a = function(t, i, r) {
                    var n, a = function(e) {
                        for (var t = 0, i = n.length; t < i; ) {
                            if (n[t]._name === e || n[t].mn === e || n[t].propertyIndex === e || n[t].ix === e || n[t].ind === e)
                                return n[t];
                            t += 1
                        }
                        return "number" == typeof e ? n[e - 1] : null
                    };
                    a.propertyGroup = propertyGroupFactory(a, r),
                    n = e(t.it, i.it, a.propertyGroup),
                    a.numProperties = n.length;
                    var s = o(t.it[t.it.length - 1], i.it[i.it.length - 1], a.propertyGroup);
                    return a.transform = s,
                    a.propertyIndex = t.cix,
                    a._name = t.nm,
                    a
                }(t, i, n.propertyGroup)
                  , s = o(t.it[t.it.length - 1], i.it[i.it.length - 1], n.propertyGroup);
                return n.content = a,
                n.transform = s,
                Object.defineProperty(n, "_name", {
                    get: function() {
                        return t.nm
                    }
                }),
                n.numProperties = t.np,
                n.propertyIndex = t.ix,
                n.nm = t.nm,
                n.mn = t.mn,
                n
            }
            function i(e, t, i) {
                function r(e) {
                    return "Color" === e || "color" === e ? r.color : "Opacity" === e || "opacity" === e ? r.opacity : null
                }
                return Object.defineProperties(r, {
                    color: {
                        get: ExpressionPropertyInterface(t.c)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.c.setGroupProperty(PropertyInterface("Color", i)),
                t.o.setGroupProperty(PropertyInterface("Opacity", i)),
                r
            }
            function r(e, t, i) {
                function r(e) {
                    return "Start Point" === e || "start point" === e ? r.startPoint : "End Point" === e || "end point" === e ? r.endPoint : "Opacity" === e || "opacity" === e ? r.opacity : null
                }
                return Object.defineProperties(r, {
                    startPoint: {
                        get: ExpressionPropertyInterface(t.s)
                    },
                    endPoint: {
                        get: ExpressionPropertyInterface(t.e)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    type: {
                        get: function() {
                            return "a"
                        }
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.s.setGroupProperty(PropertyInterface("Start Point", i)),
                t.e.setGroupProperty(PropertyInterface("End Point", i)),
                t.o.setGroupProperty(PropertyInterface("Opacity", i)),
                r
            }
            function n(e, t, i) {
                var r, n, a = propertyGroupFactory(h, i), o = propertyGroupFactory(l, a), s = e.d ? e.d.length : 0, l = {};
                for (r = 0; r < s; r += 1)
                    n = r,
                    Object.defineProperty(l, e.d[n].nm, {
                        get: ExpressionPropertyInterface(t.d.dataProps[n].p)
                    }),
                    t.d.dataProps[r].p.setGroupProperty(o);
                function h(e) {
                    return "Color" === e || "color" === e ? h.color : "Opacity" === e || "opacity" === e ? h.opacity : "Stroke Width" === e || "stroke width" === e ? h.strokeWidth : null
                }
                return Object.defineProperties(h, {
                    color: {
                        get: ExpressionPropertyInterface(t.c)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    strokeWidth: {
                        get: ExpressionPropertyInterface(t.w)
                    },
                    dash: {
                        get: function() {
                            return l
                        }
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.c.setGroupProperty(PropertyInterface("Color", a)),
                t.o.setGroupProperty(PropertyInterface("Opacity", a)),
                t.w.setGroupProperty(PropertyInterface("Stroke Width", a)),
                h
            }
            function a(e, t, i) {
                function r(t) {
                    return t === e.e.ix || "End" === t || "end" === t ? r.end : t === e.s.ix ? r.start : t === e.o.ix ? r.offset : null
                }
                var n = propertyGroupFactory(r, i);
                return r.propertyIndex = e.ix,
                t.s.setGroupProperty(PropertyInterface("Start", n)),
                t.e.setGroupProperty(PropertyInterface("End", n)),
                t.o.setGroupProperty(PropertyInterface("Offset", n)),
                r.propertyIndex = e.ix,
                r.propertyGroup = i,
                Object.defineProperties(r, {
                    start: {
                        get: ExpressionPropertyInterface(t.s)
                    },
                    end: {
                        get: ExpressionPropertyInterface(t.e)
                    },
                    offset: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function o(e, t, i) {
                function r(t) {
                    return e.a.ix === t || "Anchor Point" === t ? r.anchorPoint : e.o.ix === t || "Opacity" === t ? r.opacity : e.p.ix === t || "Position" === t ? r.position : e.r.ix === t || "Rotation" === t || "ADBE Vector Rotation" === t ? r.rotation : e.s.ix === t || "Scale" === t ? r.scale : e.sk && e.sk.ix === t || "Skew" === t ? r.skew : e.sa && e.sa.ix === t || "Skew Axis" === t ? r.skewAxis : null
                }
                var n = propertyGroupFactory(r, i);
                return t.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity", n)),
                t.transform.mProps.p.setGroupProperty(PropertyInterface("Position", n)),
                t.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point", n)),
                t.transform.mProps.s.setGroupProperty(PropertyInterface("Scale", n)),
                t.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation", n)),
                t.transform.mProps.sk && (t.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew", n)),
                t.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle", n))),
                t.transform.op.setGroupProperty(PropertyInterface("Opacity", n)),
                Object.defineProperties(r, {
                    opacity: {
                        get: ExpressionPropertyInterface(t.transform.mProps.o)
                    },
                    position: {
                        get: ExpressionPropertyInterface(t.transform.mProps.p)
                    },
                    anchorPoint: {
                        get: ExpressionPropertyInterface(t.transform.mProps.a)
                    },
                    scale: {
                        get: ExpressionPropertyInterface(t.transform.mProps.s)
                    },
                    rotation: {
                        get: ExpressionPropertyInterface(t.transform.mProps.r)
                    },
                    skew: {
                        get: ExpressionPropertyInterface(t.transform.mProps.sk)
                    },
                    skewAxis: {
                        get: ExpressionPropertyInterface(t.transform.mProps.sa)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.ty = "tr",
                r.mn = e.mn,
                r.propertyGroup = i,
                r
            }
            function s(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.s.ix === t ? r.size : null
                }
                var n = propertyGroupFactory(r, i);
                r.propertyIndex = e.ix;
                var a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return a.s.setGroupProperty(PropertyInterface("Size", n)),
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                Object.defineProperties(r, {
                    size: {
                        get: ExpressionPropertyInterface(a.s)
                    },
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function l(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.r.ix === t ? r.rotation : e.pt.ix === t ? r.points : e.or.ix === t || "ADBE Vector Star Outer Radius" === t ? r.outerRadius : e.os.ix === t ? r.outerRoundness : !e.ir || e.ir.ix !== t && "ADBE Vector Star Inner Radius" !== t ? e.is && e.is.ix === t ? r.innerRoundness : null : r.innerRadius
                }
                var n = propertyGroupFactory(r, i)
                  , a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return r.propertyIndex = e.ix,
                a.or.setGroupProperty(PropertyInterface("Outer Radius", n)),
                a.os.setGroupProperty(PropertyInterface("Outer Roundness", n)),
                a.pt.setGroupProperty(PropertyInterface("Points", n)),
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                a.r.setGroupProperty(PropertyInterface("Rotation", n)),
                e.ir && (a.ir.setGroupProperty(PropertyInterface("Inner Radius", n)),
                a.is.setGroupProperty(PropertyInterface("Inner Roundness", n))),
                Object.defineProperties(r, {
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    rotation: {
                        get: ExpressionPropertyInterface(a.r)
                    },
                    points: {
                        get: ExpressionPropertyInterface(a.pt)
                    },
                    outerRadius: {
                        get: ExpressionPropertyInterface(a.or)
                    },
                    outerRoundness: {
                        get: ExpressionPropertyInterface(a.os)
                    },
                    innerRadius: {
                        get: ExpressionPropertyInterface(a.ir)
                    },
                    innerRoundness: {
                        get: ExpressionPropertyInterface(a.is)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function h(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.r.ix === t ? r.roundness : e.s.ix === t || "Size" === t || "ADBE Vector Rect Size" === t ? r.size : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return r.propertyIndex = e.ix,
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                a.s.setGroupProperty(PropertyInterface("Size", n)),
                a.r.setGroupProperty(PropertyInterface("Rotation", n)),
                Object.defineProperties(r, {
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    roundness: {
                        get: ExpressionPropertyInterface(a.r)
                    },
                    size: {
                        get: ExpressionPropertyInterface(a.s)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function c(e, t, i) {
                function r(t) {
                    return e.r.ix === t || "Round Corners 1" === t ? r.radius : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = t;
                return r.propertyIndex = e.ix,
                a.rd.setGroupProperty(PropertyInterface("Radius", n)),
                Object.defineProperties(r, {
                    radius: {
                        get: ExpressionPropertyInterface(a.rd)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function p(e, t, i) {
                function r(t) {
                    return e.c.ix === t || "Copies" === t ? r.copies : e.o.ix === t || "Offset" === t ? r.offset : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = t;
                return r.propertyIndex = e.ix,
                a.c.setGroupProperty(PropertyInterface("Copies", n)),
                a.o.setGroupProperty(PropertyInterface("Offset", n)),
                Object.defineProperties(r, {
                    copies: {
                        get: ExpressionPropertyInterface(a.c)
                    },
                    offset: {
                        get: ExpressionPropertyInterface(a.o)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            return function(t, i, r) {
                var n;
                function a(e) {
                    if ("number" == typeof e)
                        return 0 === (e = void 0 === e ? 1 : e) ? r : n[e - 1];
                    for (var t = 0, i = n.length; t < i; ) {
                        if (n[t]._name === e)
                            return n[t];
                        t += 1
                    }
                    return null
                }
                return a.propertyGroup = propertyGroupFactory(a, (function() {
                    return r
                }
                )),
                n = e(t, i, a.propertyGroup),
                a.numProperties = n.length,
                a._name = "Contents",
                a
            }
        }(), TextExpressionInterface = function(e) {
            var t, i;
            function r(e) {
                return "ADBE Text Document" === e ? r.sourceText : null
            }
            return Object.defineProperty(r, "sourceText", {
                get: function() {
                    e.textProperty.getValue();
                    var r = e.textProperty.currentData.t;
                    return r !== t && (e.textProperty.currentData.t = t,
                    (i = new String(r)).value = r || new String(r)),
                    i
                }
            }),
            r
        }, LayerExpressionInterface = function() {
            function e(e) {
                var t = new Matrix;
                return void 0 !== e ? this._elem.finalTransform.mProp.getValueAtTime(e).clone(t) : this._elem.finalTransform.mProp.applyToMatrix(t),
                t
            }
            function t(e, t) {
                var i = this.getMatrix(t);
                return i.props[12] = 0,
                i.props[13] = 0,
                i.props[14] = 0,
                this.applyPoint(i, e)
            }
            function i(e, t) {
                var i = this.getMatrix(t);
                return this.applyPoint(i, e)
            }
            function r(e, t) {
                var i = this.getMatrix(t);
                return i.props[12] = 0,
                i.props[13] = 0,
                i.props[14] = 0,
                this.invertPoint(i, e)
            }
            function n(e, t) {
                var i = this.getMatrix(t);
                return this.invertPoint(i, e)
            }
            function a(e, t) {
                if (this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e)
                }
                return e.applyToPointArray(t[0], t[1], t[2] || 0)
            }
            function o(e, t) {
                if (this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e)
                }
                return e.inversePoint(t)
            }
            function s(e) {
                var t = new Matrix;
                if (t.reset(),
                this._elem.finalTransform.mProp.applyToMatrix(t),
                this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(t);
                    return t.inversePoint(e)
                }
                return t.inversePoint(e)
            }
            function l() {
                return [1, 1, 1, 1]
            }
            return function(h) {
                var c;
                function p(e) {
                    switch (e) {
                    case "ADBE Root Vectors Group":
                    case "Contents":
                    case 2:
                        return p.shapeInterface;
                    case 1:
                    case 6:
                    case "Transform":
                    case "transform":
                    case "ADBE Transform Group":
                        return c;
                    case 4:
                    case "ADBE Effect Parade":
                    case "effects":
                    case "Effects":
                        return p.effect;
                    case "ADBE Text Properties":
                        return p.textInterface;
                    default:
                        return null
                    }
                }
                p.getMatrix = e,
                p.invertPoint = o,
                p.applyPoint = a,
                p.toWorld = i,
                p.toWorldVec = t,
                p.fromWorld = n,
                p.fromWorldVec = r,
                p.toComp = i,
                p.fromComp = s,
                p.sampleImage = l,
                p.sourceRectAtTime = h.sourceRectAtTime.bind(h),
                p._elem = h;
                var u = getDescriptor(c = TransformExpressionInterface(h.finalTransform.mProp), "anchorPoint");
                return Object.defineProperties(p, {
                    hasParent: {
                        get: function() {
                            return h.hierarchy.length
                        }
                    },
                    parent: {
                        get: function() {
                            return h.hierarchy[0].layerInterface
                        }
                    },
                    rotation: getDescriptor(c, "rotation"),
                    scale: getDescriptor(c, "scale"),
                    position: getDescriptor(c, "position"),
                    opacity: getDescriptor(c, "opacity"),
                    anchorPoint: u,
                    anchor_point: u,
                    transform: {
                        get: function() {
                            return c
                        }
                    },
                    active: {
                        get: function() {
                            return h.isInRange
                        }
                    }
                }),
                p.startTime = h.data.st,
                p.index = h.data.ind,
                p.source = h.data.refId,
                p.height = 0 === h.data.ty ? h.data.h : 100,
                p.width = 0 === h.data.ty ? h.data.w : 100,
                p.inPoint = h.data.ip / h.comp.globalData.frameRate,
                p.outPoint = h.data.op / h.comp.globalData.frameRate,
                p._name = h.data.nm,
                p.registerMaskInterface = function(e) {
                    p.mask = new MaskManagerInterface(e,h)
                }
                ,
                p.registerEffectsInterface = function(e) {
                    p.effect = e
                }
                ,
                p
            }
        }(), FootageInterface = (dataInterfaceFactory = function(e) {
            function t(e) {
                return "Outline" === e ? t.outlineInterface() : null
            }
            return t._name = "Outline",
            t.outlineInterface = function(e) {
                var t = ""
                  , i = e.getFootageData();
                function r(e) {
                    if (i[e])
                        return t = e,
                        "object" == _typeof2(i = i[e]) ? r : i;
                    var n = e.indexOf(t);
                    if (-1 !== n) {
                        var a = parseInt(e.substr(n + t.length), 10);
                        return "object" == _typeof2(i = i[a]) ? r : i
                    }
                    return ""
                }
                return function() {
                    return t = "",
                    i = e.getFootageData(),
                    r
                }
            }(e),
            t
        }
        ,
        function(e) {
            function t(e) {
                return "Data" === e ? t.dataInterface : null
            }
            return t._name = "Data",
            t.dataInterface = dataInterfaceFactory(e),
            t
        }
        ), dataInterfaceFactory, CompExpressionInterface = function(e) {
            function t(t) {
                for (var i = 0, r = e.layers.length; i < r; ) {
                    if (e.layers[i].nm === t || e.layers[i].ind === t)
                        return e.elements[i].layerInterface;
                    i += 1
                }
                return null
            }
            return Object.defineProperty(t, "_name", {
                value: e.data.nm
            }),
            t.layer = t,
            t.pixelAspect = 1,
            t.height = e.data.h || e.globalData.compSize.h,
            t.width = e.data.w || e.globalData.compSize.w,
            t.pixelAspect = 1,
            t.frameDuration = 1 / e.globalData.frameRate,
            t.displayStartTime = 0,
            t.numLayers = e.layers.length,
            t
        }, TransformExpressionInterface = function(e) {
            function t(e) {
                switch (e) {
                case "scale":
                case "Scale":
                case "ADBE Scale":
                case 6:
                    return t.scale;
                case "rotation":
                case "Rotation":
                case "ADBE Rotation":
                case "ADBE Rotate Z":
                case 10:
                    return t.rotation;
                case "ADBE Rotate X":
                    return t.xRotation;
                case "ADBE Rotate Y":
                    return t.yRotation;
                case "position":
                case "Position":
                case "ADBE Position":
                case 2:
                    return t.position;
                case "ADBE Position_0":
                    return t.xPosition;
                case "ADBE Position_1":
                    return t.yPosition;
                case "ADBE Position_2":
                    return t.zPosition;
                case "anchorPoint":
                case "AnchorPoint":
                case "Anchor Point":
                case "ADBE AnchorPoint":
                case 1:
                    return t.anchorPoint;
                case "opacity":
                case "Opacity":
                case 11:
                    return t.opacity;
                default:
                    return null
                }
            }
            var i, r, n, a;
            return Object.defineProperty(t, "rotation", {
                get: ExpressionPropertyInterface(e.r || e.rz)
            }),
            Object.defineProperty(t, "zRotation", {
                get: ExpressionPropertyInterface(e.rz || e.r)
            }),
            Object.defineProperty(t, "xRotation", {
                get: ExpressionPropertyInterface(e.rx)
            }),
            Object.defineProperty(t, "yRotation", {
                get: ExpressionPropertyInterface(e.ry)
            }),
            Object.defineProperty(t, "scale", {
                get: ExpressionPropertyInterface(e.s)
            }),
            e.p ? a = ExpressionPropertyInterface(e.p) : (i = ExpressionPropertyInterface(e.px),
            r = ExpressionPropertyInterface(e.py),
            e.pz && (n = ExpressionPropertyInterface(e.pz))),
            Object.defineProperty(t, "position", {
                get: function() {
                    return e.p ? a() : [i(), r(), n ? n() : 0]
                }
            }),
            Object.defineProperty(t, "xPosition", {
                get: ExpressionPropertyInterface(e.px)
            }),
            Object.defineProperty(t, "yPosition", {
                get: ExpressionPropertyInterface(e.py)
            }),
            Object.defineProperty(t, "zPosition", {
                get: ExpressionPropertyInterface(e.pz)
            }),
            Object.defineProperty(t, "anchorPoint", {
                get: ExpressionPropertyInterface(e.a)
            }),
            Object.defineProperty(t, "opacity", {
                get: ExpressionPropertyInterface(e.o)
            }),
            Object.defineProperty(t, "skew", {
                get: ExpressionPropertyInterface(e.sk)
            }),
            Object.defineProperty(t, "skewAxis", {
                get: ExpressionPropertyInterface(e.sa)
            }),
            Object.defineProperty(t, "orientation", {
                get: ExpressionPropertyInterface(e.or)
            }),
            t
        }, ProjectInterface = function() {
            function e(e) {
                this.compositions.push(e)
            }
            return function() {
                function t(e) {
                    for (var t = 0, i = this.compositions.length; t < i; ) {
                        if (this.compositions[t].data && this.compositions[t].data.nm === e)
                            return this.compositions[t].prepareFrame && this.compositions[t].data.xt && this.compositions[t].prepareFrame(this.currentFrame),
                            this.compositions[t].compInterface;
                        t += 1
                    }
                    return null
                }
                return t.compositions = [],
                t.currentFrame = 0,
                t.registerComposition = e,
                t
            }
        }(), EffectsExpressionInterface = function() {
            function e(i, r, n, a) {
                function o(e) {
                    for (var t = i.ef, r = 0, n = t.length; r < n; ) {
                        if (e === t[r].nm || e === t[r].mn || e === t[r].ix)
                            return 5 === t[r].ty ? h[r] : h[r]();
                        r += 1
                    }
                    throw new Error
                }
                var s, l = propertyGroupFactory(o, n), h = [], c = i.ef.length;
                for (s = 0; s < c; s += 1)
                    5 === i.ef[s].ty ? h.push(e(i.ef[s], r.effectElements[s], r.effectElements[s].propertyGroup, a)) : h.push(t(r.effectElements[s], i.ef[s].ty, a, l));
                return "ADBE Color Control" === i.mn && Object.defineProperty(o, "color", {
                    get: function() {
                        return h[0]()
                    }
                }),
                Object.defineProperties(o, {
                    numProperties: {
                        get: function() {
                            return i.np
                        }
                    },
                    _name: {
                        value: i.nm
                    },
                    propertyGroup: {
                        value: l
                    }
                }),
                o.enabled = 0 !== i.en,
                o.active = o.enabled,
                o
            }
            function t(e, t, i, r) {
                var n = ExpressionPropertyInterface(e.p);
                return e.p.setGroupProperty && e.p.setGroupProperty(PropertyInterface("", r)),
                function() {
                    return 10 === t ? i.comp.compInterface(e.p.v) : n()
                }
            }
            return {
                createEffectsInterface: function(t, i) {
                    if (t.effectsManager) {
                        var r, n = [], a = t.data.ef, o = t.effectsManager.effectElements.length;
                        for (r = 0; r < o; r += 1)
                            n.push(e(a[r], t.effectsManager.effectElements[r], i, t));
                        var s = t.data.ef || []
                          , l = function(e) {
                            for (r = 0,
                            o = s.length; r < o; ) {
                                if (e === s[r].nm || e === s[r].mn || e === s[r].ix)
                                    return n[r];
                                r += 1
                            }
                            return null
                        };
                        return Object.defineProperty(l, "numProperties", {
                            get: function() {
                                return s.length
                            }
                        }),
                        l
                    }
                    return null
                }
            }
        }(), MaskManagerInterface = function() {
            function e(e, t) {
                this._mask = e,
                this._data = t
            }
            return Object.defineProperty(e.prototype, "maskPath", {
                get: function() {
                    return this._mask.prop.k && this._mask.prop.getValue(),
                    this._mask.prop
                }
            }),
            Object.defineProperty(e.prototype, "maskOpacity", {
                get: function() {
                    return this._mask.op.k && this._mask.op.getValue(),
                    100 * this._mask.op.v
                }
            }),
            function(t) {
                var i, r = createSizedArray(t.viewData.length), n = t.viewData.length;
                for (i = 0; i < n; i += 1)
                    r[i] = new e(t.viewData[i],t.masksProperties[i]);
                return function(e) {
                    for (i = 0; i < n; ) {
                        if (t.masksProperties[i].nm === e)
                            return r[i];
                        i += 1
                    }
                    return null
                }
            }
        }(), ExpressionPropertyInterface = function() {
            var e = {
                pv: 0,
                v: 0,
                mult: 1
            }
              , t = {
                pv: [0, 0, 0],
                v: [0, 0, 0],
                mult: 1
            };
            function i(e, t, i) {
                Object.defineProperty(e, "velocity", {
                    get: function() {
                        return t.getVelocityAtTime(t.comp.currentFrame)
                    }
                }),
                e.numKeys = t.keyframes ? t.keyframes.length : 0,
                e.key = function(r) {
                    if (!e.numKeys)
                        return 0;
                    var n;
                    n = "s"in t.keyframes[r - 1] ? t.keyframes[r - 1].s : "e"in t.keyframes[r - 2] ? t.keyframes[r - 2].e : t.keyframes[r - 2].s;
                    var a = "unidimensional" === i ? new Number(n) : Object.assign({}, n);
                    return a.time = t.keyframes[r - 1].t / t.elem.comp.globalData.frameRate,
                    a.value = "unidimensional" === i ? n[0] : n,
                    a
                }
                ,
                e.valueAtTime = t.getValueAtTime,
                e.speedAtTime = t.getSpeedAtTime,
                e.velocityAtTime = t.getVelocityAtTime,
                e.propertyGroup = t.propertyGroup
            }
            function r() {
                return e
            }
            return function(n) {
                return n ? "unidimensional" === n.propType ? function(t) {
                    t && "pv"in t || (t = e);
                    var r = 1 / t.mult
                      , n = t.pv * r
                      , a = new Number(n);
                    return a.value = n,
                    i(a, t, "unidimensional"),
                    function() {
                        return t.k && t.getValue(),
                        n = t.v * r,
                        a.value !== n && ((a = new Number(n)).value = n,
                        i(a, t, "unidimensional")),
                        a
                    }
                }(n) : function(e) {
                    e && "pv"in e || (e = t);
                    var r = 1 / e.mult
                      , n = e.data && e.data.l || e.pv.length
                      , a = createTypedArray("float32", n)
                      , o = createTypedArray("float32", n);
                    return a.value = o,
                    i(a, e, "multidimensional"),
                    function() {
                        e.k && e.getValue();
                        for (var t = 0; t < n; t += 1)
                            o[t] = e.v[t] * r,
                            a[t] = o[t];
                        return a
                    }
                }(n) : r
            }
        }(), TextExpressionSelectorPropFactory = function() {
            function e(e, t) {
                return this.textIndex = e + 1,
                this.textTotal = t,
                this.v = this.getValue() * this.mult,
                this.v
            }
            return function(t, i) {
                this.pv = 1,
                this.comp = t.comp,
                this.elem = t,
                this.mult = .01,
                this.propType = "textSelector",
                this.textTotal = i.totalChars,
                this.selectorValue = 100,
                this.lastValue = [1, 1, 1],
                this.k = !0,
                this.x = !0,
                this.getValue = ExpressionManager.initiateExpression.bind(this)(t, i, this),
                this.getMult = e,
                this.getVelocityAtTime = expressionHelpers.getVelocityAtTime,
                this.kf ? this.getValueAtTime = expressionHelpers.getValueAtTime.bind(this) : this.getValueAtTime = expressionHelpers.getStaticValueAtTime.bind(this),
                this.setGroupProperty = expressionHelpers.setGroupProperty
            }
        }(), propertyGetTextProp = TextSelectorProp.getTextSelectorProp;
        function SliderEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function AngleEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function ColorEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 1, 0, i)
        }
        function PointEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 1, 0, i)
        }
        function LayerIndexEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function MaskIndexEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function CheckboxEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function NoValueEffect() {
            this.p = {}
        }
        function EffectsManager(e, t) {
            var i, r = e.ef || [];
            this.effectElements = [];
            var n, a = r.length;
            for (i = 0; i < a; i += 1)
                n = new GroupEffect(r[i],t),
                this.effectElements.push(n)
        }
        function GroupEffect(e, t) {
            this.init(e, t)
        }
        TextSelectorProp.getTextSelectorProp = function(e, t, i) {
            return 1 === t.t ? new TextExpressionSelectorPropFactory(e,t,i) : propertyGetTextProp(e, t, i)
        }
        ,
        extendPrototype([DynamicPropertyContainer], GroupEffect),
        GroupEffect.prototype.getValue = GroupEffect.prototype.iterateDynamicProperties,
        GroupEffect.prototype.init = function(e, t) {
            var i;
            this.data = e,
            this.effectElements = [],
            this.initDynamicPropertyContainer(t);
            var r, n = this.data.ef.length, a = this.data.ef;
            for (i = 0; i < n; i += 1) {
                switch (r = null,
                a[i].ty) {
                case 0:
                    r = new SliderEffect(a[i],t,this);
                    break;
                case 1:
                    r = new AngleEffect(a[i],t,this);
                    break;
                case 2:
                    r = new ColorEffect(a[i],t,this);
                    break;
                case 3:
                    r = new PointEffect(a[i],t,this);
                    break;
                case 4:
                case 7:
                    r = new CheckboxEffect(a[i],t,this);
                    break;
                case 10:
                    r = new LayerIndexEffect(a[i],t,this);
                    break;
                case 11:
                    r = new MaskIndexEffect(a[i],t,this);
                    break;
                case 5:
                    r = new EffectsManager(a[i],t);
                    break;
                default:
                    r = new NoValueEffect(a[i])
                }
                r && this.effectElements.push(r)
            }
        }
        ;
        var lottie = {}, queryString;
        function setLocationHref(e) {
            locationHref = e
        }
        function searchAnimations() {
            animationManager.searchAnimations()
        }
        function setSubframeRendering(e) {
            subframeEnabled = e
        }
        function setIDPrefix(e) {
            idPrefix = e
        }
        function loadAnimation(e) {
            return animationManager.loadAnimation(e)
        }
        function setQuality(e) {
            if ("string" == typeof e)
                switch (e) {
                case "high":
                    defaultCurveSegments = 200;
                    break;
                default:
                case "medium":
                    defaultCurveSegments = 50;
                    break;
                case "low":
                    defaultCurveSegments = 10
                }
            else
                !isNaN(e) && e > 1 && (defaultCurveSegments = e)
        }
        function inBrowser() {
            return "undefined" != typeof navigator
        }
        function installPlugin(e, t) {
            "expressions" === e && (expressionsPlugin = t)
        }
        function getFactory(e) {
            switch (e) {
            case "propertyFactory":
                return PropertyFactory;
            case "shapePropertyFactory":
                return ShapePropertyFactory;
            case "matrix":
                return Matrix;
            default:
                return null
            }
        }
        function checkReady() {
            "complete" === document.readyState && (clearInterval(readyStateCheckInterval),
            searchAnimations())
        }
        function getQueryVariable(e) {
            for (var t = queryString.split("&"), i = 0; i < t.length; i += 1) {
                var r = t[i].split("=");
                if (decodeURIComponent(r[0]) == e)
                    return decodeURIComponent(r[1])
            }
            return null
        }
        lottie.play = animationManager.play,
        lottie.pause = animationManager.pause,
        lottie.setLocationHref = setLocationHref,
        lottie.togglePause = animationManager.togglePause,
        lottie.setSpeed = animationManager.setSpeed,
        lottie.setDirection = animationManager.setDirection,
        lottie.stop = animationManager.stop,
        lottie.searchAnimations = searchAnimations,
        lottie.registerAnimation = animationManager.registerAnimation,
        lottie.loadAnimation = loadAnimation,
        lottie.setSubframeRendering = setSubframeRendering,
        lottie.resize = animationManager.resize,
        lottie.goToAndStop = animationManager.goToAndStop,
        lottie.destroy = animationManager.destroy,
        lottie.setQuality = setQuality,
        lottie.inBrowser = inBrowser,
        lottie.installPlugin = installPlugin,
        lottie.freeze = animationManager.freeze,
        lottie.unfreeze = animationManager.unfreeze,
        lottie.setVolume = animationManager.setVolume,
        lottie.mute = animationManager.mute,
        lottie.unmute = animationManager.unmute,
        lottie.getRegisteredAnimations = animationManager.getRegisteredAnimations,
        lottie.useWebWorker = function(e) {
            _useWebWorker = e
        }
        ,
        lottie.setIDPrefix = setIDPrefix,
        lottie.__getFactory = getFactory,
        lottie.version = "5.8.1";
        var scripts = document.getElementsByTagName("script")
          , index = scripts.length - 1
          , myScript = scripts[index] || {
            src: ""
        };
        queryString = myScript.src.replace(/^[^\?]+\??/, ""),
        getQueryVariable("renderer");
        var readyStateCheckInterval = setInterval(checkReady, 100);
        return lottie
    }
    ,
    module.exports ? module.exports = factory(root) : (root.lottie = factory(root),
    root.bodymovin = root.lottie))
}
)(lottie$1$1),
lottie$1$1.exports;
var _templateObject$1, styles = r$3(_templateObject$1 || (_templateObject$1 = _taggedTemplateLiteral(["\n  * {\n    box-sizing: border-box;\n  }\n\n  :host {\n    --lottie-player-toolbar-height: 35px;\n    --lottie-player-toolbar-background-color: transparent;\n    --lottie-player-toolbar-icon-color: #999;\n    --lottie-player-toolbar-icon-hover-color: #222;\n    --lottie-player-toolbar-icon-active-color: #555;\n    --lottie-player-seeker-track-color: #ccc;\n    --lottie-player-seeker-thumb-color: rgba(0, 107, 120, 0.8);\n    --lottie-player-seeker-display: block;\n\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n\n  .main {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n  }\n\n  .animation {\n    width: 100%;\n    height: 100%;\n    display: flex;\n  }\n  .animation.controls {\n    height: calc(100% - 35px);\n  }\n\n  .toolbar {\n    display: flex;\n    align-items: center;\n    justify-items: center;\n    background-color: var(--lottie-player-toolbar-background-color);\n    margin: 0 5px;\n    height: 35px;\n  }\n\n  .toolbar button {\n    cursor: pointer;\n    fill: var(--lottie-player-toolbar-icon-color);\n    display: flex;\n    background: none;\n    border: 0;\n    padding: 0;\n    outline: none;\n    height: 100%;\n  }\n\n  .toolbar button:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button.active {\n    fill: var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button.active:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button:focus {\n    outline: 1px dotted var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button svg {\n  }\n\n  .toolbar button.disabled svg {\n    display: none;\n  }\n\n  .seeker {\n    -webkit-appearance: none;\n    width: 95%;\n    outline: none;\n    background-color: var(--lottie-player-toolbar-background-color);\n    display: var(--lottie-player-seeker-display);\n  }\n\n  .seeker::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-webkit-slider-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n    -webkit-appearance: none;\n    margin-top: -5px;\n  }\n  .seeker:focus::-webkit-slider-runnable-track {\n    background: #999;\n  }\n  .seeker::-moz-range-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-moz-range-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker::-ms-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: transparent;\n    border-color: transparent;\n    color: transparent;\n  }\n  .seeker::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-thumb {\n    border: 0;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker:focus::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n  }\n  .seeker:focus::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n  }\n\n  .error {\n    display: flex;\n    justify-content: center;\n    height: 100%;\n    align-items: center;\n  }\n"]))), _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, PlayerState, PlayMode, PlayerEvents, t2;
function parseSrc(e) {
    if ("object" == _typeof2(e))
        return e;
    try {
        return JSON.parse(e)
    } catch (t) {
        return new URL(e,window.location.href).toString()
    }
}
function isLottie(e) {
    return ["v", "ip", "op", "layers", "fr", "w", "h"].every((function(t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }
    ))
}
function fromURL(e) {
    return _fromURL.apply(this, arguments)
}
function _fromURL() {
    return (_fromURL = _asyncToGenerator(_regeneratorRuntime().mark((function e(t) {
        var i, r, n;
        return _regeneratorRuntime().wrap((function(e) {
            for (; ; )
                switch (e.prev = e.next) {
                case 0:
                    if ("string" == typeof t) {
                        e.next = 2;
                        break
                    }
                    throw new Error("The url value must be a string");
                case 2:
                    return e.prev = 2,
                    r = new URL(t),
                    e.next = 6,
                    fetch(r.toString());
                case 6:
                    return n = e.sent,
                    e.next = 9,
                    n.json();
                case 9:
                    i = e.sent,
                    e.next = 15;
                    break;
                case 12:
                    throw e.prev = 12,
                    e.t0 = e.catch(2),
                    new Error("An error occurred while trying to load the Lottie file from URL");
                case 15:
                    return e.abrupt("return", i);
                case 16:
                case "end":
                    return e.stop()
                }
        }
        ), e, null, [[2, 12]])
    }
    )))).apply(this, arguments)
}
t2 = PlayerState || (PlayerState = {}),
t2.Destroyed = "destroyed",
t2.Error = "error",
t2.Frozen = "frozen",
t2.Loading = "loading",
t2.Paused = "paused",
t2.Playing = "playing",
t2.Stopped = "stopped",
function(e) {
    e.Bounce = "bounce",
    e.Normal = "normal"
}(PlayMode || (PlayMode = {})),
function(e) {
    e.Complete = "complete",
    e.Destroyed = "destroyed",
    e.Error = "error",
    e.Frame = "frame",
    e.Freeze = "freeze",
    e.Load = "load",
    e.Loop = "loop",
    e.Pause = "pause",
    e.Play = "play",
    e.Ready = "ready",
    e.Rendered = "rendered",
    e.Stop = "stop"
}(PlayerEvents || (PlayerEvents = {}));
var LottiePlayer = function(e) {
    _inherits(i, s);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.apply(this, arguments)).autoplay = !1,
        e.background = "transparent",
        e.controls = !1,
        e.currentState = PlayerState.Loading,
        e.description = "Lottie animation",
        e.direction = 1,
        e.hover = !1,
        e.intermission = 1,
        e.loop = !1,
        e.mode = PlayMode.Normal,
        e.preserveAspectRatio = "xMidYMid meet",
        e.renderer = "svg",
        e.speed = 1,
        e._io = void 0,
        e._counter = 1,
        e
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e) {
            var t = this;
            return _asyncToGenerator(_regeneratorRuntime().mark((function i() {
                var r, n, a, o;
                return _regeneratorRuntime().wrap((function(i) {
                    for (; ; )
                        switch (i.prev = i.next) {
                        case 0:
                            if (!t.shadowRoot) {
                                i.next = 22;
                                break
                            }
                            if (r = {
                                container: t.container,
                                loop: !1,
                                autoplay: !1,
                                renderer: t.renderer,
                                rendererSettings: {
                                    preserveAspectRatio: t.preserveAspectRatio,
                                    clearCanvas: !1,
                                    progressiveLoad: !0,
                                    hideOnTransparent: !0
                                }
                            },
                            i.prev = 2,
                            n = parseSrc(e),
                            a = {},
                            o = "string" == typeof n ? "path" : "animationData",
                            t._lottie && t._lottie.destroy(),
                            t.webworkers && lottie$1$1.exports.useWebWorker(!0),
                            t._lottie = lottie$1$1.exports.loadAnimation(Object.assign(Object.assign({}, r), _defineProperty2({}, o, n))),
                            t._attachEventListeners(),
                            "path" !== o) {
                                i.next = 15;
                                break
                            }
                            return i.next = 11,
                            fromURL(n);
                        case 11:
                            a = i.sent,
                            o = "animationData",
                            i.next = 16;
                            break;
                        case 15:
                            a = n;
                        case 16:
                            isLottie(a) || (t.currentState = PlayerState.Error,
                            t.dispatchEvent(new CustomEvent(PlayerEvents.Error))),
                            i.next = 22;
                            break;
                        case 19:
                            i.prev = 19,
                            i.t0 = i.catch(2),
                            t.currentState = PlayerState.Error,
                            t.dispatchEvent(new CustomEvent(PlayerEvents.Error));
                        case 22:
                        case "end":
                            return i.stop()
                        }
                }
                ), i, null, [[2, 19]])
            }
            )))()
        }
    }, {
        key: "getLottie",
        value: function() {
            return this._lottie
        }
    }, {
        key: "play",
        value: function() {
            this._lottie && (this._lottie.play(),
            this.currentState = PlayerState.Playing,
            this.dispatchEvent(new CustomEvent(PlayerEvents.Play)))
        }
    }, {
        key: "pause",
        value: function() {
            this._lottie && (this._lottie.pause(),
            this.currentState = PlayerState.Paused,
            this.dispatchEvent(new CustomEvent(PlayerEvents.Pause)))
        }
    }, {
        key: "stop",
        value: function() {
            this._lottie && (this._counter = 1,
            this._lottie.stop(),
            this.currentState = PlayerState.Stopped,
            this.dispatchEvent(new CustomEvent(PlayerEvents.Stop)))
        }
    }, {
        key: "destroy",
        value: function() {
            this._lottie && (this._lottie.destroy(),
            this._lottie = null,
            this.currentState = PlayerState.Destroyed,
            this.dispatchEvent(new CustomEvent(PlayerEvents.Destroyed)),
            this.remove())
        }
    }, {
        key: "seek",
        value: function(e) {
            if (this._lottie) {
                var t = /^(\d+)(%?)$/.exec(e.toString());
                if (t) {
                    var i = "%" === t[2] ? this._lottie.totalFrames * Number(t[1]) / 100 : Number(t[1]);
                    this.seeker = i,
                    this.currentState === PlayerState.Playing ? this._lottie.goToAndPlay(i, !0) : (this._lottie.goToAndStop(i, !0),
                    this._lottie.pause())
                }
            }
        }
    }, {
        key: "snapshot",
        value: function() {
            var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
            if (this.shadowRoot) {
                var t = this.shadowRoot.querySelector(".animation svg")
                  , i = (new XMLSerializer).serializeToString(t);
                if (e) {
                    var r = document.createElement("a");
                    r.href = "data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(i)),
                    r.download = "download_".concat(this.seeker, ".svg"),
                    document.body.appendChild(r),
                    r.click(),
                    document.body.removeChild(r)
                }
                return i
            }
        }
    }, {
        key: "setSpeed",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1;
            this._lottie && this._lottie.setSpeed(e)
        }
    }, {
        key: "setDirection",
        value: function(e) {
            this._lottie && this._lottie.setDirection(e)
        }
    }, {
        key: "setLooping",
        value: function(e) {
            this._lottie && (this.loop = e,
            this._lottie.loop = e)
        }
    }, {
        key: "togglePlay",
        value: function() {
            return this.currentState === PlayerState.Playing ? this.pause() : this.play()
        }
    }, {
        key: "toggleLooping",
        value: function() {
            this.setLooping(!this.loop)
        }
    }, {
        key: "resize",
        value: function() {
            this._lottie && this._lottie.resize()
        }
    }, {
        key: "disconnectedCallback",
        value: function() {
            var e = this;
            this.isConnected || (this._io && (this._io.disconnect(),
            this._io = void 0),
            document.removeEventListener("visibilitychange", (function() {
                return e._onVisibilityChange()
            }
            )),
            this.destroy())
        }
    }, {
        key: "render",
        value: function() {
            var e = this.controls ? "main controls" : "main"
              , t = this.controls ? "animation controls" : "animation";
            return $(_templateObject || (_templateObject = _taggedTemplateLiteral([' <div\n      id="animation-container"\n      class=', '\n      lang="en"\n      aria-label=', '\n      role="img"\n    >\n      <div\n        id="animation"\n        class=', '\n        style="background:', ';"\n      >\n        ', "\n      </div>\n      ", "\n    </div>"])), e, this.description, t, this.background, this.currentState === PlayerState.Error ? $(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral(['<div class="error"></div>']))) : void 0, this.controls ? this.renderControls() : void 0)
        }
    }, {
        key: "firstUpdated",
        value: function() {
            var e = this;
            "IntersectionObserver"in window && (this._io = new IntersectionObserver((function(t) {
                t[0].isIntersecting ? e.currentState === PlayerState.Frozen && e.play() : e.currentState === PlayerState.Playing && e.freeze()
            }
            )),
            this._io.observe(this.container)),
            void 0 !== document.hidden && document.addEventListener("visibilitychange", (function() {
                return e._onVisibilityChange()
            }
            )),
            this.src && this.load(this.src),
            this.dispatchEvent(new CustomEvent(PlayerEvents.Rendered))
        }
    }, {
        key: "renderControls",
        value: function() {
            var e = this
              , t = this.currentState === PlayerState.Playing
              , i = this.currentState === PlayerState.Paused
              , r = this.currentState === PlayerState.Stopped;
            return $(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral(['\n      <div\n        id="lottie-controls"\n        aria-label="lottie-animation-controls"\n        class="toolbar"\n      >\n        <button\n          id="lottie-play-button"\n          @click=', "\n          class=", '\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="play-pause"\n        >\n          ', '\n        </button>\n        <button\n          id="lottie-stop-button"\n          @click=', "\n          class=", '\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="stop"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path d="M6 6h12v12H6V6z" />\n          </svg>\n        </button>\n        <input\n          id="lottie-seeker-input"\n          class="seeker"\n          type="range"\n          min="0"\n          step="1"\n          max="100"\n          .value=', "\n          @input=", "\n          @mousedown=", "\n          @mouseup=", '\n          aria-valuemin="1"\n          aria-valuemax="100"\n          role="slider"\n          aria-valuenow=', '\n          tabindex="0"\n          aria-label="lottie-seek-input"\n        />\n        <button\n          id="lottie-loop-toggle"\n          @click=', "\n          class=", '\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="loop-toggle"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path\n              d="M17.016 17.016v-4.031h1.969v6h-12v3l-3.984-3.984 3.984-3.984v3h10.031zM6.984 6.984v4.031H5.015v-6h12v-3l3.984 3.984-3.984 3.984v-3H6.984z"\n            />\n          </svg>\n        </button>\n      </div>\n    '])), this.togglePlay, t || i ? "active" : "", $(t ? _templateObject4 || (_templateObject4 = _taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path\n                  d="M14.016 5.016H18v13.969h-3.984V5.016zM6 18.984V5.015h3.984v13.969H6z"\n                />\n              </svg>'])) : _templateObject5 || (_templateObject5 = _taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path d="M8.016 5.016L18.985 12 8.016 18.984V5.015z" />\n              </svg>']))), this.stop, r ? "active" : "", this.seeker, this._handleSeekChange, (function() {
                e._prevState = e.currentState,
                e.freeze()
            }
            ), (function() {
                e._prevState === PlayerState.Playing && e.play()
            }
            ), this.seeker, this.toggleLooping, this.loop ? "active" : "")
        }
    }, {
        key: "_onVisibilityChange",
        value: function() {
            !0 === document.hidden && this.currentState === PlayerState.Playing ? this.freeze() : this.currentState === PlayerState.Frozen && this.play()
        }
    }, {
        key: "_handleSeekChange",
        value: function(e) {
            if (this._lottie && !isNaN(e.target.value)) {
                var t = e.target.value / 100 * this._lottie.totalFrames;
                this.seek(t)
            }
        }
    }, {
        key: "_attachEventListeners",
        value: function() {
            var e = this;
            this._lottie.addEventListener("enterFrame", (function() {
                e.seeker = e._lottie.currentFrame / e._lottie.totalFrames * 100,
                e.dispatchEvent(new CustomEvent(PlayerEvents.Frame,{
                    detail: {
                        frame: e._lottie.currentFrame,
                        seeker: e.seeker
                    }
                }))
            }
            )),
            this._lottie.addEventListener("complete", (function() {
                if (e.currentState === PlayerState.Playing) {
                    if (!e.loop || e.count && e._counter >= e.count) {
                        if (e.dispatchEvent(new CustomEvent(PlayerEvents.Complete)),
                        e.mode !== PlayMode.Bounce)
                            return;
                        if (0 === e._lottie.currentFrame)
                            return
                    }
                    e.mode === PlayMode.Bounce ? (e.count && (e._counter += .5),
                    setTimeout((function() {
                        e.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),
                        e.currentState === PlayerState.Playing && (e._lottie.setDirection(-1 * e._lottie.playDirection),
                        e._lottie.play())
                    }
                    ), e.intermission)) : (e.count && (e._counter += 1),
                    window.setTimeout((function() {
                        e.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),
                        e.currentState === PlayerState.Playing && (-1 === e.direction ? (e.seek("99%"),
                        e.play()) : (e._lottie.stop(),
                        e._lottie.play()))
                    }
                    ), e.intermission))
                } else
                    e.dispatchEvent(new CustomEvent(PlayerEvents.Complete))
            }
            )),
            this._lottie.addEventListener("DOMLoaded", (function() {
                e.setSpeed(e.speed),
                e.setDirection(e.direction),
                e.autoplay && (-1 === e.direction && e.seek("100%"),
                e.play()),
                e.dispatchEvent(new CustomEvent(PlayerEvents.Ready))
            }
            )),
            this._lottie.addEventListener("data_ready", (function() {
                e.dispatchEvent(new CustomEvent(PlayerEvents.Load))
            }
            )),
            this._lottie.addEventListener("data_failed", (function() {
                e.currentState = PlayerState.Error,
                e.dispatchEvent(new CustomEvent(PlayerEvents.Error))
            }
            )),
            this.container.addEventListener("mouseenter", (function() {
                e.hover && e.currentState !== PlayerState.Playing && e.play()
            }
            )),
            this.container.addEventListener("mouseleave", (function() {
                e.hover && e.currentState === PlayerState.Playing && e.stop()
            }
            ))
        }
    }, {
        key: "freeze",
        value: function() {
            this._lottie && (this._lottie.pause(),
            this.currentState = PlayerState.Frozen,
            this.dispatchEvent(new CustomEvent(PlayerEvents.Freeze)))
        }
    }], [{
        key: "styles",
        get: function() {
            return styles
        }
    }]),
    i
}();
__decorate([e$5({
    type: Boolean
})], LottiePlayer.prototype, "autoplay", void 0),
__decorate([e$5({
    type: String,
    reflect: !0
})], LottiePlayer.prototype, "background", void 0),
__decorate([e$5({
    type: Boolean
})], LottiePlayer.prototype, "controls", void 0),
__decorate([e$5({
    type: Number
})], LottiePlayer.prototype, "count", void 0),
__decorate([e$5({
    type: String
})], LottiePlayer.prototype, "currentState", void 0),
__decorate([e$5({
    type: String
})], LottiePlayer.prototype, "description", void 0),
__decorate([e$5({
    type: Number
})], LottiePlayer.prototype, "direction", void 0),
__decorate([e$5({
    type: Boolean
})], LottiePlayer.prototype, "hover", void 0),
__decorate([e$5()], LottiePlayer.prototype, "intermission", void 0),
__decorate([e$5({
    type: Boolean,
    reflect: !0
})], LottiePlayer.prototype, "loop", void 0),
__decorate([e$5()], LottiePlayer.prototype, "mode", void 0),
__decorate([e$5({
    type: String
})], LottiePlayer.prototype, "preserveAspectRatio", void 0),
__decorate([e$5({
    type: String
})], LottiePlayer.prototype, "renderer", void 0),
__decorate([e$5()], LottiePlayer.prototype, "seeker", void 0),
__decorate([e$5({
    type: Number
})], LottiePlayer.prototype, "speed", void 0),
__decorate([e$5({
    type: String
})], LottiePlayer.prototype, "src", void 0),
__decorate([e$5({
    type: Boolean
})], LottiePlayer.prototype, "webworkers", void 0),
__decorate([i(".animation")], LottiePlayer.prototype, "container", void 0),
LottiePlayer = __decorate([n$1("lottie-player")], LottiePlayer);
var isSSR = "undefined" == typeof window, DetectUA = function() {
    function e(e) {
        this.userAgent = e || (!isSSR && window.navigator ? window.navigator.userAgent : ""),
        this.isAndroidDevice = !/like android/i.test(this.userAgent) && /android/i.test(this.userAgent),
        this.iOSDevice = this.match(1, /(iphone|ipod|ipad)/i).toLowerCase(),
        !isSSR && "MacIntel" === navigator.platform && navigator.maxTouchPoints > 2 && !window.MSStream && (this.iOSDevice = "ipad")
    }
    return e.prototype.match = function(e, t) {
        var i = this.userAgent.match(t);
        return i && i.length > 1 && i[e] || ""
    }
    ,
    Object.defineProperty(e.prototype, "isMobile", {
        get: function() {
            return !this.isTablet && (/[^-]mobi/i.test(this.userAgent) || "iphone" === this.iOSDevice || "ipod" === this.iOSDevice || this.isAndroidDevice || /nexus\s*[0-6]\s*/i.test(this.userAgent))
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isTablet", {
        get: function() {
            return /tablet/i.test(this.userAgent) && !/tablet pc/i.test(this.userAgent) || "ipad" === this.iOSDevice || this.isAndroidDevice && !/[^-]mobi/i.test(this.userAgent) || !/nexus\s*[0-6]\s*/i.test(this.userAgent) && /nexus\s*[0-9]+/i.test(this.userAgent)
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isDesktop", {
        get: function() {
            return !this.isMobile && !this.isTablet
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isMacOS", {
        get: function() {
            return /macintosh/i.test(this.userAgent) && {
                version: this.match(1, /mac os x (\d+(\.?_?\d+)+)/i).replace(/[_\s]/g, ".").split(".").map((function(e) {
                    return e
                }
                ))[1]
            }
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isWindows", {
        get: function() {
            return /windows /i.test(this.userAgent) && {
                version: this.match(1, /Windows ((NT|XP)( \d\d?.\d)?)/i)
            }
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isiOS", {
        get: function() {
            return !!this.iOSDevice && {
                version: this.match(1, /os (\d+([_\s]\d+)*) like mac os x/i).replace(/[_\s]/g, ".") || this.match(1, /version\/(\d+(\.\d+)?)/i)
            }
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isAndroid", {
        get: function() {
            return this.isAndroidDevice && {
                version: this.match(1, /android[ \/-](\d+(\.\d+)*)/i)
            }
        },
        enumerable: !1,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "browser", {
        get: function() {
            var e = this.match(1, /version\/(\d+(\.\d+)?)/i);
            return /opera/i.test(this.userAgent) ? {
                name: "Opera",
                version: e || this.match(1, /(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)
            } : /opr\/|opios/i.test(this.userAgent) ? {
                name: "Opera",
                version: this.match(1, /(?:opr|opios)[\s\/](\d+(\.\d+)?)/i) || e
            } : /SamsungBrowser/i.test(this.userAgent) ? {
                name: "Samsung Internet for Android",
                version: e || this.match(1, /(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)
            } : /yabrowser/i.test(this.userAgent) ? {
                name: "Yandex Browser",
                version: e || this.match(1, /(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)
            } : /ucbrowser/i.test(this.userAgent) ? {
                name: "UC Browser",
                version: this.match(1, /(?:ucbrowser)[\s\/](\d+(\.\d+)?)/i)
            } : /msie|trident/i.test(this.userAgent) ? {
                name: "Internet Explorer",
                version: this.match(1, /(?:msie |rv:)(\d+(\.\d+)?)/i)
            } : /(edge|edgios|edga|edg)/i.test(this.userAgent) ? {
                name: "Microsoft Edge",
                version: this.match(2, /(edge|edgios|edga|edg)\/(\d+(\.\d+)?)/i)
            } : /firefox|iceweasel|fxios/i.test(this.userAgent) ? {
                name: "Firefox",
                version: this.match(1, /(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)
            } : /chromium/i.test(this.userAgent) ? {
                name: "Chromium",
                version: this.match(1, /(?:chromium)[\s\/](\d+(?:\.\d+)?)/i) || e
            } : /chrome|crios|crmo/i.test(this.userAgent) ? {
                name: "Chrome",
                version: this.match(1, /(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)
            } : /safari|applewebkit/i.test(this.userAgent) ? {
                name: "Safari",
                version: e
            } : {
                name: this.match(1, /^(.*)\/(.*) /),
                version: this.match(2, /^(.*)\/(.*) /)
            }
        },
        enumerable: !1,
        configurable: !0
    }),
    e
}(), detectUA = new DetectUA, userAgent = (navigator.userAgent || navigator.vendor).toLowerCase(), browserName = detectUA.browser.name, Browser = _createClass2((function e() {
    var t;
    _classCallCheck2(this, e),
    _defineProperty2(this, "device", null),
    _defineProperty2(this, "isMobile", detectUA.isMobile || detectUA.isTablet),
    _defineProperty2(this, "isDesktop", detectUA.isDesktop),
    _defineProperty2(this, "isAndroid", Boolean(detectUA.isAndroid)),
    _defineProperty2(this, "isIOS", Boolean(detectUA.isiOS)),
    _defineProperty2(this, "isMacOS", Boolean(detectUA.isMacOS)),
    _defineProperty2(this, "isWindows", Boolean(null !== detectUA.isWindows.version)),
    _defineProperty2(this, "isLinux", Boolean(-1 != userAgent.indexOf("linux"))),
    _defineProperty2(this, "ua", userAgent),
    _defineProperty2(this, "isEdge", "Microsoft Edge" === browserName),
    _defineProperty2(this, "isIE", "Internet Explorer" === browserName),
    _defineProperty2(this, "isFirefox", "Firefox" === browserName),
    _defineProperty2(this, "isChrome", "Chrome" === browserName),
    _defineProperty2(this, "isOpera", "Opera" === browserName),
    _defineProperty2(this, "isSafari", "Safari" === browserName),
    _defineProperty2(this, "isTablet", detectUA.isTablet),
    _defineProperty2(this, "isRetina", window.devicePixelRatio && window.devicePixelRatio >= 1.5),
    _defineProperty2(this, "devicePixelRatio", window.devicePixelRatio || 1),
    _defineProperty2(this, "cpuCoreCount", navigator.hardwareConcurrency || 1),
    _defineProperty2(this, "baseUrl", document.location.origin),
    _defineProperty2(this, "isIFrame", window.self !== window.top),
    _defineProperty2(this, "isSupportWebP", !(!(t = document.createElement("canvas")).getContext || !t.getContext("2d")) && 0 == t.toDataURL("image/webp").indexOf("data:image/webp")),
    this.isMobile ? this.device = "mobile" : this.device = "desktop"
}
)), browser = new Browser, quickLoader$a = {
    exports: {}
}, minSignal$1 = {
    exports: {}
}, module2;
module2 = minSignal$1,
function(e) {
    function t() {
        this._listeners = [],
        this.dispatchCount = 0
    }
    var i = t.prototype;
    i.add = o,
    i.addOnce = function(t, i, a, s) {
        if (!t)
            throw r;
        var l = this
          , h = function() {
            return l.remove.call(l, t, i),
            t.apply(i, n.call(arguments, 0))
        };
        1 === (s = n.call(arguments, 0)).length && s.push(e),
        s.splice(2, 0, h),
        o.apply(l, s)
    }
    ,
    i.remove = function(e, t) {
        if (!e)
            return this._listeners.length = 0,
            !0;
        for (var i, r = this._listeners, n = r.length; n--; )
            if ((i = r[n]).f === e && (!t || i.c === t))
                return i.j = 0,
                r.splice(n, 1),
                !0;
        return !1
    }
    ,
    i.dispatch = function(e) {
        e = n.call(arguments, 0),
        this.dispatchCount++;
        for (var t, i, r = this.dispatchCount, a = this._listeners, o = a.length; o--; )
            if ((t = a[o]) && t.j < r && (t.j = r,
            !1 === t.r.apply(t.c, t.a.concat(e)))) {
                i = t;
                break
            }
        for (o = (a = this._listeners).length; o--; )
            a[o].j = 0;
        return i
    }
    ;
    var r = "Callback function is missing!"
      , n = Array.prototype.slice;
    function a(e) {
        e.sort((function(e, t) {
            return e = e.p,
            (t = t.p) < e ? 1 : e > t ? -1 : 0
        }
        ))
    }
    function o(e, t, i, o) {
        if (!e)
            throw r;
        i = i || 0;
        for (var s, l, h, c = this._listeners, p = c.length; p--; )
            if ((s = c[p]).f === e && s.c === t)
                return !1;
        "function" == typeof i && (l = i,
        i = o,
        h = 4),
        c.unshift({
            f: e,
            c: t,
            p: i,
            r: l || e,
            a: n.call(arguments, h || 3),
            j: 0
        }),
        a(c)
    }
    module2.exports = t
}();
var MinSignal$2 = minSignal$1.exports, undef$3;
function QuickLoader() {
    this.isLoading = !1,
    this.totalWeight = 0,
    this.loadedWeight = 0,
    this.itemUrls = {},
    this.itemList = [],
    this.loadingSignal = new MinSignal$2,
    this.crossOriginMap = {},
    this.queue = [],
    this.activeItems = [],
    this.maxActiveItems = 4
}
var _p$9 = QuickLoader.prototype;
_p$9.addChunk = addChunk,
_p$9.setCrossOrigin = setCrossOrigin,
_p$9.add = add,
_p$9.load = load$7,
_p$9.start = start,
_p$9.loadNext = loadNext,
_p$9._createItem = _createItem,
_p$9._onLoading = _onLoading$1,
_p$9.VERSION = "0.1.17",
_p$9.register = register,
_p$9.retrieveAll = retrieveAll,
_p$9.retrieve = retrieve,
_p$9.testExtensions = testExtensions,
_p$9.create = create,
_p$9.check = check;
var addedItems = _p$9.addedItems = {}
  , loadedItems = _p$9.loadedItems = {}
  , ITEM_CLASS_LIST = _p$9.ITEM_CLASS_LIST = []
  , ITEM_CLASSES = _p$9.ITEM_CLASSES = {};
function setCrossOrigin(e, t) {
    this.crossOriginMap[e] = t
}
function addChunk(e, t) {
    var i, r, n, a, o, s = retrieveAll(e, t);
    for (i = 0,
    n = s.length; i < n; i++)
        for (r = 0,
        a = (o = s[i]).items.length; r < a; r++)
            this.add(o.items[r], {
                type: o.type
            });
    return s
}
function add(e, t) {
    var i = addedItems[e];
    return i || (i = this._createItem(e, t && t.type ? t.type : retrieve(e).type, t)),
    t && t.onLoad && i.onLoaded.addOnce(t.onLoad),
    this.itemUrls[e] || (this.itemUrls[e] = i,
    this.itemList.push(i),
    this.totalWeight += i.weight),
    i
}
function load$7(e, t) {
    var i = addedItems[e];
    return i || (i = this._createItem(e, t && t.type ? t.type : retrieve(e).type, t)),
    t && t.onLoad && i.onLoaded.addOnce(t.onLoad),
    loadedItems[e] ? i.dispatch() : i.isStartLoaded || i.load(),
    i
}
function start(e) {
    e && this.loadingSignal.add(e),
    this.isLoading = !0;
    var t = this.itemList.length;
    if (t) {
        var i, r = this.itemList.splice(0, this.itemList.length);
        for (var n in this.itemUrls)
            delete this.itemUrls[n];
        for (var a = 0; a < t; a++) {
            i = r[a];
            var o = !!loadedItems[i.url];
            i.onLoaded.addOnce(_onItemLoad, this, -1024, i, r, o),
            i.hasLoading && i.loadingSignal.add(_onLoading$1, this, -1024, i, r, undef$3),
            o ? i.dispatch(_onItemLoad) : i.isStartLoaded || this.queue.push(i)
        }
        this.queue.length && this.loadNext()
    } else
        _onItemLoad.call(this, undef$3, this.itemList)
}
function loadNext() {
    if (this.queue.length && this.activeItems.length < this.maxActiveItems) {
        var e = this.queue.shift();
        this.activeItems.push(e),
        this.loadNext(),
        e.load()
    }
}
function _onLoading$1(e, t, i, r, n) {
    e && !e.isLoaded && 1 === e.getCombinedPercent(r) || (n === undef$3 && (this.loadedWeight = _getLoadedWeight(t),
    n = this.loadedWeight / this.totalWeight),
    (i = i || this.loadingSignal).dispatch(n, e))
}
function _getLoadedWeight(e) {
    for (var t = 0, i = 0, r = e.length; i < r; i++)
        t += e[i].loadedWeight;
    return t
}
function _onItemLoad(e, t, i) {
    if (this.loadedWeight = _getLoadedWeight(t),
    !i)
        for (var r = this.activeItems, n = r.length; n--; )
            if (r[n] === e) {
                r.splice(n, 1);
                break
            }
    var a = this.loadingSignal;
    this.loadedWeight === this.totalWeight ? (this.isLoading = !1,
    this.loadedWeight = 0,
    this.totalWeight = 0,
    this.loadingSignal = new MinSignal$2,
    this._onLoading(e, t, a, 1, 1),
    e && e.noCache && _removeItemCache(e)) : (this._onLoading(e, t, a, 1, this.loadedWeight / this.totalWeight),
    e && e.noCache && _removeItemCache(e),
    i || this.loadNext())
}
function _removeItemCache(e) {
    var t = e.url;
    e.content = undef$3,
    addedItems[t] = undef$3,
    loadedItems[t] = undef$3
}
function _createItem(e, t, i) {
    if (!(i = i || {}).crossOrigin)
        for (var r in this.crossOriginMap)
            if (0 === e.indexOf(r)) {
                i.crossOrigin = this.crossOriginMap[r];
                break
            }
    return new ITEM_CLASSES[t](e,i)
}
function register(e) {
    ITEM_CLASSES[e.type] || (ITEM_CLASS_LIST.push(e),
    ITEM_CLASSES[e.type] = e)
}
function retrieveAll(e, t) {
    var i, r, n = e.length, a = [];
    if (n && "string" != typeof e)
        for (i = 0; i < n; i++)
            (r = retrieve(e[i], t)) && (a = a.concat(r));
    else
        (r = retrieve(e, t)) && (a = a.concat(r));
    return a
}
function retrieve(e, t) {
    var i, r, n, a, o;
    if (t)
        n = (a = ITEM_CLASSES[t]).retrieve(e);
    else
        for (i = 0,
        r = ITEM_CLASS_LIST.length; i < r; i++) {
            if (o = (a = ITEM_CLASS_LIST[i]).type,
            "string" == typeof e) {
                if (testExtensions(e, a)) {
                    n = [e];
                    break
                }
            } else if ((n = a.retrieve(e)) && n.length && "string" == typeof n[0] && testExtensions(n[0], a))
                break;
            n = undef$3,
            o = undef$3
        }
    if (n)
        return {
            type: t || o,
            items: n
        }
}
function testExtensions(e, t) {
    if (e) {
        for (var i = _getExtension(e), r = t.extensions, n = r.length; n--; )
            if (i === r[n])
                return !0;
        return !1
    }
}
function _getExtension(e) {
    return e.split(".").pop().split(/#|\?/)[0]
}
function create() {
    return new QuickLoader
}
function check() {
    var e = []
      , t = [];
    for (var i in addedItems)
        e.push(i),
        loadedItems[i] || t.push(addedItems[i]);
    console.log({
        added: e,
        notLoaded: t
    })
}
quickLoader$a.exports = create();
var MinSignal$1 = minSignal$1.exports
  , quickLoader$9 = quickLoader$a.exports;
function AbstractItem$6(e, t) {
    if (e) {
        for (var i in this.url = e,
        this.loadedWeight = 0,
        this.weight = 1,
        this.postPercent = 0,
        t)
            this[i] = t[i];
        this.type || (this.type = this.constructor.type),
        this.hasLoading && (this.loadingSignal = new MinSignal$1,
        this.loadingSignal.add(_onLoading, this),
        this.onLoading && this.loadingSignal.add(this.onLoading)),
        this.onPost ? (this.onPostLoadingSignal = new MinSignal$1,
        this.onPostLoadingSignal.add(this._onPostLoading, this),
        this.postWeightRatio = this.postWeightRatio || .1) : this.postWeightRatio = 0;
        var r = this;
        this.boundOnLoad = function() {
            r._onLoad()
        }
        ,
        this.onLoaded = new MinSignal$1,
        quickLoader$9.addedItems[e] = this
    }
}
var AbstractItem_1 = AbstractItem$6
  , _p$8 = AbstractItem$6.prototype;
function load$6() {
    this.isStartLoaded = !0
}
function _onLoad$6() {
    this.onPost ? this.onPost.call(this, this.content, this.onPostLoadingSignal) : this._onLoadComplete()
}
function _onPostLoading(e) {
    this.postPercent = e,
    this.hasLoading && this.loadingSignal.dispatch(1),
    1 === e && this._onLoadComplete()
}
function _onLoadComplete() {
    this.isLoaded = !0,
    this.loadedWeight = this.weight,
    quickLoader$9.loadedItems[this.url] = this,
    this.onLoaded.dispatch(this.content)
}
function getCombinedPercent(e) {
    return e * (1 - this.postWeightRatio) + this.postWeightRatio * this.postPercent
}
function _onLoading(e) {
    this.loadedWeight = this.weight * this.getCombinedPercent(e)
}
function dispatch() {
    this.hasLoading && this.loadingSignal.remove(),
    this.onLoaded.dispatch(this.content)
}
_p$8.load = load$6,
_p$8._onLoad = _onLoad$6,
_p$8._onLoading = _onLoading,
_p$8._onPostLoading = _onPostLoading,
_p$8._onLoadComplete = _onLoadComplete,
_p$8.getCombinedPercent = getCombinedPercent,
_p$8.dispatch = dispatch,
AbstractItem$6.extensions = [],
AbstractItem$6.retrieve = function() {
    return !1
}
;
var AbstractItem$5 = AbstractItem_1
  , quickLoader$8 = quickLoader$a.exports;
function __generateFuncName() {
    return "_jsonp" + (new Date).getTime() + ~~(1e8 * Math.random())
}
function JSONPItem(e) {
    e && _super$7.constructor.apply(this, arguments)
}
JSONPItem.type = "jsonp",
JSONPItem.extensions = [],
quickLoader$8.register(JSONPItem),
JSONPItem.retrieve = function(e) {
    return "string" == typeof e && e.indexOf("=") > -1 && [e]
}
;
var _super$7 = AbstractItem$5.prototype
  , _p$7 = JSONPItem.prototype = new AbstractItem$5;
function load$5(e) {
    _super$7.load.apply(this, arguments);
    var t = this
      , i = this.url.lastIndexOf("=") + 1
      , r = this.url.substr(0, i)
      , n = this.url.substr(i);
    0 === n.length ? (n = __generateFuncName(),
    this.jsonpCallback = e) : this.jsonpCallback = this.jsonpCallback || window[n],
    window[n] = function(e) {
        a.parentNode && a.parentNode.removeChild(a),
        t.content = e,
        t._onLoad()
    }
    ;
    var a = document.createElement("script");
    a.type = "text/javascript",
    a.src = r + n,
    document.getElementsByTagName("head")[0].appendChild(a)
}
_p$7.constructor = JSONPItem,
_p$7.load = load$5;
var AbstractItem$4 = AbstractItem_1, quickLoader$7 = quickLoader$a.exports, undef$2, IS_SUPPORT_XML_HTTP_REQUEST = !!window.XMLHttpRequest;
function XHRItem$2(e) {
    e && (_super$6.constructor.apply(this, arguments),
    this.responseType = this.responseType || "",
    this.method = this.method || "GET")
}
var XHRItem_1 = XHRItem$2;
XHRItem$2.type = "xhr",
XHRItem$2.extensions = [],
quickLoader$7.register(XHRItem$2),
XHRItem$2.retrieve = function() {
    return !1
}
;
var _super$6 = AbstractItem$4.prototype
  , _p$6 = XHRItem$2.prototype = new AbstractItem$4;
function load$4() {
    _super$6.load.apply(this, arguments);
    var e, t = this;
    e = this.xmlhttp = IS_SUPPORT_XML_HTTP_REQUEST ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP"),
    this.hasLoading && (e.onprogress = function(e) {
        t._onXmlHttpProgress(e)
    }
    ),
    e.onreadystatechange = function() {
        t._onXmlHttpChange()
    }
    ,
    e.open(this.method, this.url, !0),
    this.xmlhttp.responseType = this.responseType,
    IS_SUPPORT_XML_HTTP_REQUEST ? e.send(null) : e.send()
}
function _onXmlHttpProgress(e) {
    this.loadingSignal.dispatch(e.loaded / e.total)
}
function _onXmlHttpChange() {
    4 === this.xmlhttp.readyState && 200 === this.xmlhttp.status && this._onLoad(this.xmlhttp)
}
function _onLoad$5() {
    this.content || (this.content = this.xmlhttp.response),
    this.xmlhttp = undef$2,
    _super$6._onLoad.call(this)
}
_p$6.constructor = XHRItem$2,
_p$6.load = load$4,
_p$6._onXmlHttpChange = _onXmlHttpChange,
_p$6._onXmlHttpProgress = _onXmlHttpProgress,
_p$6._onLoad = _onLoad$5;
var XHRItem$1 = XHRItem_1
  , quickLoader$6 = quickLoader$a.exports;
function TextItem$1(e, t) {
    e && (t.responseType = "text",
    _super$5.constructor.apply(this, arguments))
}
var TextItem_1 = TextItem$1;
TextItem$1.type = "text",
TextItem$1.extensions = ["html", "txt", "svg"],
quickLoader$6.register(TextItem$1),
TextItem$1.retrieve = function() {
    return !1
}
;
var _super$5 = XHRItem$1.prototype
  , _p$5 = TextItem$1.prototype = new XHRItem$1;
function _onLoad$4() {
    this.content || (this.content = this.xmlhttp.responseText),
    _super$5._onLoad.apply(this, arguments)
}
_p$5.constructor = TextItem$1,
_p$5._onLoad = _onLoad$4;
var TextItem = TextItem_1
  , quickLoader$5 = quickLoader$a.exports;
function JSONItem(e) {
    e && _super$4.constructor.apply(this, arguments)
}
JSONItem.type = "json",
JSONItem.extensions = ["json"],
quickLoader$5.register(JSONItem),
JSONItem.retrieve = function() {
    return !1
}
;
var _super$4 = TextItem.prototype
  , _p$4 = JSONItem.prototype = new TextItem;
function _onLoad$3() {
    this.content || (this.content = window.JSON && window.JSON.parse ? JSON.parse(this.xmlhttp.responseText.toString()) : eval(this.xmlhttp.responseText.toString())),
    _super$4._onLoad.call(this)
}
_p$4.constructor = JSONItem,
_p$4._onLoad = _onLoad$3;
var AbstractItem$3 = AbstractItem_1, quickLoader$4 = quickLoader$a.exports, undef$1;
function AudioItem$1(e, t) {
    if (e) {
        this.loadThrough = !t || t.loadThrough === undef$1 || t.loadThrough,
        _super$3.constructor.apply(this, arguments);
        try {
            this.content = this.content || new Audio
        } catch (i) {
            this.content = this.content || document.createElement("audio")
        }
        this.crossOrigin && (this.content.crossOrigin = this.crossOrigin)
    }
}
AudioItem$1.type = "audio",
AudioItem$1.extensions = ["mp3", "ogg"],
quickLoader$4.register(AudioItem$1),
AudioItem$1.retrieve = function(e) {
    return !1
}
;
var _super$3 = AbstractItem$3.prototype
  , _p$3 = AudioItem$1.prototype = new AbstractItem$3;
function load$3() {
    _super$3.load.apply(this, arguments);
    var e = this
      , t = e.content;
    t.src = this.url,
    this.loadThrough ? t.addEventListener("canplaythrough", this.boundOnLoad, !1) : t.addEventListener("canplay", this.boundOnLoad, !1),
    t.load()
}
function _onLoad$2() {
    this.content.removeEventListener("canplaythrough", this.boundOnLoad, !1),
    this.content.removeEventListener("canplay", this.boundOnLoad, !1),
    this.isLoaded || _super$3._onLoad.call(this)
}
_p$3.constructor = AudioItem$1,
_p$3.load = load$3,
_p$3._onLoad = _onLoad$2;
var AbstractItem$2 = AbstractItem_1, quickLoader$3 = quickLoader$a.exports, undef;
function VideoItem(e, t) {
    if (e) {
        this.loadThrough = !t || t.loadThrough === undef || t.loadThrough,
        _super$2.constructor.apply(this, arguments);
        try {
            this.content = this.content || new Video
        } catch (i) {
            this.content = this.content || document.createElement("video")
        }
        this.crossOrigin && (this.content.crossOrigin = this.crossOrigin)
    }
}
VideoItem.type = "video",
VideoItem.extensions = ["mp4", "webm", "ogv"],
quickLoader$3.register(VideoItem),
VideoItem.retrieve = function(e) {
    return !1
}
;
var _super$2 = AbstractItem$2.prototype
  , _p$2 = VideoItem.prototype = new AbstractItem$2;
function load$2() {
    _super$2.load.apply(this, arguments);
    var e = this.content;
    e.preload = "auto",
    e.src = this.url,
    this.loadThrough ? e.addEventListener("canplaythrough", this.boundOnLoad, !1) : e.addEventListener("canplay", this.boundOnLoad, !1),
    e.load()
}
function _onLoad$1() {
    this.content.removeEventListener("canplaythrough", this.boundOnLoad),
    this.content.removeEventListener("canplay", this.boundOnLoad),
    this.isLoaded || _super$2._onLoad.call(this)
}
_p$2.constructor = VideoItem,
_p$2.load = load$2,
_p$2._onLoad = _onLoad$1;
var AbstractItem$1 = AbstractItem_1
  , quickLoader$2 = quickLoader$a.exports;
function AnyItem$3(e, t) {
    e && (_super$1.constructor.call(this, e, t),
    !this.loadFunc && console && console[console.error || console.log]("require loadFunc in the config object."))
}
AnyItem$3.type = "any",
AnyItem$3.extensions = [],
quickLoader$2.register(AnyItem$3),
AnyItem$3.retrieve = function() {
    return !1
}
;
var _super$1 = AbstractItem$1.prototype
  , _p$1 = AnyItem$3.prototype = new AbstractItem$1;
function load$1() {
    var e = this;
    this.loadFunc(this.url, (function(t) {
        e.content = t,
        _super$1._onLoad.call(e)
    }
    ), this.loadingSignal)
}
function computedStyle$1(e, t, i, r) {
    if (r = (i = window.getComputedStyle) ? i(e) : e.currentStyle)
        return r[t.replace(/-(\w)/gi, (function(e, t) {
            return t.toUpperCase()
        }
        ))]
}
_p$1.constructor = AnyItem$3,
_p$1.load = load$1;
var computedStyle_commonjs = computedStyle$1
  , AbstractItem = AbstractItem_1
  , computedStyle = computedStyle_commonjs
  , quickLoader$1 = quickLoader$a.exports;
function ImageItem$1(e, t) {
    e && (_super.constructor.apply(this, arguments),
    this.content = this.content || new Image,
    this.crossOrigin && (this.content.crossOrigin = this.crossOrigin))
}
var _super = AbstractItem.prototype
  , _p = ImageItem$1.prototype = new AbstractItem;
function load() {
    _super.load.apply(this, arguments);
    var e = this.content;
    e.onload = this.boundOnLoad,
    e.src = this.url
}
function _onLoad() {
    delete this.content.onload,
    this.width = this.content.width,
    this.height = this.content.height,
    _super._onLoad.call(this)
}
function _isNotData(e) {
    return 0 !== e.indexOf("data:")
}
_p.constructor = ImageItem$1,
_p.load = load,
_p._onLoad = _onLoad,
ImageItem$1.retrieve = function(e) {
    if (e.nodeType && e.style) {
        var t = [];
        "img" === e.nodeName.toLowerCase() && e.src.indexOf(";") < 0 && t.push(e.src),
        computedStyle(e, "background-image").replace(/s?url\(\s*?['"]?([^;]*?)['"]?\s*?\)/g, (function(e, i) {
            t.push(i)
        }
        ));
        for (var i = t.length; i--; )
            _isNotData(t[i]) || t.splice(i, 1);
        return !!t.length && t
    }
    return "string" == typeof e && [e]
}
,
ImageItem$1.type = "image",
ImageItem$1.extensions = ["jpg", "gif", "png"],
quickLoader$1.register(ImageItem$1);
var quickLoader = quickLoader$a.exports
  , _bbox = new Box3
  , Misc = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "overrideFromQuery",
        value: function(e) {
            if (window.URLSearchParams) {
                var t = _toConsumableArray(new URLSearchParams(window.location.search)).reduce((function(e, t) {
                    var i = _slicedToArray(t, 2)
                      , r = i[0]
                      , n = i[1];
                    return e[r] = "" === n || n,
                    e
                }
                ), {});
                for (var i in t)
                    if (void 0 !== e[i]) {
                        var r = t[i].toString();
                        "boolean" == typeof e[i] ? e[i] = !("0" === r) : "number" == typeof e[i] ? e[i] = parseFloat(r) : "string" == typeof e[i] && (e[i] = r)
                    }
            }
        }
    }, {
        key: "isSafari",
        value: function() {
            var e = window.navigator ? window.navigator.userAgent : null;
            return !!window.safari || !(!e || !(/\b(iPad|iPhone|iPod)\b/.test(e) || e.match("Safari") && !e.match("Chrome")))
        }
    }, {
        key: "isSafariWithAntialiasingBug",
        value: function() {
            var e = window.navigator ? window.navigator.userAgent : null;
            return !!this.isSafari(window) && e && e.match("Version/15.4 ")
        }
    }, {
        key: "getBoundingBoxSize",
        value: function(e) {
            return _bbox.setFromObject(e),
            _bbox.getSize(new Vector3)
        }
    }, {
        key: "getBoundingSphere",
        value: function(e) {
            return _bbox.setFromObject(e),
            _bbox.getBoundingSphere(new Sphere)
        }
    }, {
        key: "getPathVectors",
        value: function(e) {
            for (var t = [], i = 0; i < e.length; i++)
                t.push(new Vector3(e[i].x,e[i].y,e[i].z));
            return t
        }
    }, {
        key: "checkForCollisionsBetweenTrackAndObject",
        value: function(e, t, i) {
            for (var r = {
                collided: !1,
                object: null,
                track: null
            }, n = 0; n < e.obbMeshes.length; n++)
                for (var a = e.obbMeshes[n], o = 0; o < t.length; o++) {
                    var s = t[o];
                    if (a.obb.center.distanceTo(s.position) < s.userData.bboxSize.x * i) {
                        r.collided = !0,
                        r.object = s,
                        r.track = e;
                        break
                    }
                }
            if (!r.collided && e.liftBlock)
                for (var l = 0; l < t.length; l++) {
                    var h = t[l];
                    if (e.liftBlock.obb.center.distanceTo(h.position) < h.userData.bboxSize.x * i) {
                        r.collided = !0,
                        r.object = h,
                        r.track = e;
                        break
                    }
                }
            return r
        }
    }]),
    e
}()
  , misc = new Misc
  , Settings = _createClass2((function e() {
    _classCallCheck2(this, e),
    _defineProperty2(this, "MODEL_PATH", "assets/models/"),
    _defineProperty2(this, "IMAGE_PATH", "assets/images/"),
    _defineProperty2(this, "TEXTURE_PATH", "assets/textures/"),
    _defineProperty2(this, "AUDIO_PATH", "assets/audio/"),
    _defineProperty2(this, "SVG_PATH", "assets/svgs/"),
    _defineProperty2(this, "DRACO_PATH", "assets/js/draco/"),
    _defineProperty2(this, "DATA_PATH", "assets/data/"),
    _defineProperty2(this, "QUALITY_PATH", browser.isMobile ? "lowres/" : "hires/"),
    _defineProperty2(this, "RENDER_TARGET_FLOAT_TYPE", null),
    _defineProperty2(this, "DATA_FLOAT_TYPE", null),
    _defineProperty2(this, "USE_FLOAT_PACKING", !1),
    _defineProperty2(this, "USE_WEBGL2", !misc.isSafariWithAntialiasingBug()),
    _defineProperty2(this, "DPR", Math.min(1.5, browser.devicePixelRatio) || 1),
    _defineProperty2(this, "USE_PIXEL_LIMIT", !0),
    _defineProperty2(this, "CAMERA_360", !1),
    _defineProperty2(this, "SHOW_UI", !0),
    _defineProperty2(this, "MAX_PIXEL_COUNT", 3686400),
    _defineProperty2(this, "CROSS_ORIGINS", {
        "https://example.com/": "anonymous"
    }),
    _defineProperty2(this, "LOG", !1),
    _defineProperty2(this, "SKIP_ANIMATION", !1),
    _defineProperty2(this, "SHOW_TOOLTIP", !1),
    _defineProperty2(this, "LOOK_DEV_MODE", !1),
    _defineProperty2(this, "ANIMALS_DEV_MODE", !1),
    _defineProperty2(this, "TRACK", ""),
    _defineProperty2(this, "DATA", ""),
    _defineProperty2(this, "DEFAULT_TRACK_CODE", "DFFBHFIJB"),
    _defineProperty2(this, "DEFAULT_COLOR_PALETTE_CODE", "0"),
    _defineProperty2(this, "DEFAULT_COLOR_PALETTE", [new Color("#ef4a4a"), new Color("#6e62ea"), new Color("#45d5ef"), new Color("#ffd857")]),
    _defineProperty2(this, "DEFAULT_DAY_CODE", "D"),
    misc.overrideFromQuery(this)
}
))
  , settings = new Settings
  , Properties = _createClass2((function e() {
    _classCallCheck2(this, e),
    _defineProperty2(this, "loader", quickLoader.create()),
    _defineProperty2(this, "percent", 0),
    _defineProperty2(this, "_isSupportedDevice", !1),
    _defineProperty2(this, "_isSupportedBrowser", !1),
    _defineProperty2(this, "_isSupportedWebGL", !1),
    _defineProperty2(this, "_isSupportedMobileOrientation", !1),
    _defineProperty2(this, "_isSupportedWebXR", !1),
    _defineProperty2(this, "_isSupported", !1),
    _defineProperty2(this, "jpgwebp", browser.isSupportWebP ? "webp" : "jpg"),
    _defineProperty2(this, "lastDateTime", 0),
    _defineProperty2(this, "realTime", 0),
    _defineProperty2(this, "time", 0),
    _defineProperty2(this, "visualTime", 0),
    _defineProperty2(this, "deltaTime", 0),
    _defineProperty2(this, "frameIndex", 0),
    _defineProperty2(this, "isStageReady", !1),
    _defineProperty2(this, "hasInitialized", !1),
    _defineProperty2(this, "pauseStage", !1),
    _defineProperty2(this, "rawWidth", 0),
    _defineProperty2(this, "rawHeight", 0),
    _defineProperty2(this, "width", 0),
    _defineProperty2(this, "height", 0),
    _defineProperty2(this, "renderer", null),
    _defineProperty2(this, "scene", null),
    _defineProperty2(this, "camera", null),
    _defineProperty2(this, "postprocessing", null),
    _defineProperty2(this, "resolution", null),
    _defineProperty2(this, "canvas", null),
    _defineProperty2(this, "gl", null),
    _defineProperty2(this, "webglOpts", {
        antialias: !1,
        alpha: !1,
        xrCompatible: !1,
        powerPreference: "high-performance"
    }),
    _defineProperty2(this, "sharedUniforms", {
        u_time: {
            value: 0
        },
        u_resolution: {
            value: null
        },
        u_bgColor: {
            value: null
        },
        u_envTextureDay: {
            value: null
        },
        u_envTextureNight: {
            value: null
        },
        u_shadowColor: {
            value: new Color("#000000")
        },
        u_shadowStrength: {
            value: .3
        },
        u_cameraQuaternionInverse: {
            value: new Quaternion
        },
        u_nigthModeActiveRatio: {
            value: 0
        }
    }),
    _defineProperty2(this, "cameraLookX", 0),
    _defineProperty2(this, "cameraLookY", 0),
    _defineProperty2(this, "cameraDistance", 5),
    _defineProperty2(this, "cameraLookStrength", .03),
    _defineProperty2(this, "cameraLookEaseDamp", .07),
    _defineProperty2(this, "cameraShakePositionStrength", .03),
    _defineProperty2(this, "cameraShakePositionSpeed", .03),
    _defineProperty2(this, "cameraShakeRotationStrength", 3e-4),
    _defineProperty2(this, "cameraShakeRotationSpeed", .03),
    _defineProperty2(this, "smaa", null),
    _defineProperty2(this, "fxaa", null),
    _defineProperty2(this, "bokeh", null),
    _defineProperty2(this, "bloom", null),
    _defineProperty2(this, "final", null),
    _defineProperty2(this, "bgColorHex", "#000000"),
    _defineProperty2(this, "bgColor", new Color),
    _defineProperty2(this, "opacity", 1),
    _defineProperty2(this, "bloomAmount", 0),
    _defineProperty2(this, "bloomRadius", 0),
    _defineProperty2(this, "bloomThreshold", .6),
    _defineProperty2(this, "bloomSmoothWidth", .75),
    _defineProperty2(this, "haloWidth", .85),
    _defineProperty2(this, "haloRGBShift", .03),
    _defineProperty2(this, "haloStrength", .3),
    _defineProperty2(this, "vignetteFrom", .5),
    _defineProperty2(this, "vignetteTo", 1.6),
    _defineProperty2(this, "vignetteColorHex", "#252c72"),
    _defineProperty2(this, "saturation", 1),
    _defineProperty2(this, "contrast", 0),
    _defineProperty2(this, "brightness", 1),
    _defineProperty2(this, "tintColorHex", "#ff0000"),
    _defineProperty2(this, "tintOpacity", .15),
    _defineProperty2(this, "cameraMotionBlurAmount", .5),
    _defineProperty2(this, "cameraMotionBlurMultiplier", 1),
    _defineProperty2(this, "isPreloaderFinished", !1),
    _defineProperty2(this, "isPreloaderAnimationFinished", !1),
    _defineProperty2(this, "isBokehActive", !1),
    _defineProperty2(this, "bokehFNumber", .5),
    _defineProperty2(this, "bokehKFilmHeight", 24),
    _defineProperty2(this, "trainPosition", new Vector3),
    _defineProperty2(this, "trackAreaSize", 3),
    _defineProperty2(this, "trackAreaHeight", .6),
    _defineProperty2(this, "gltfModelScale", .1),
    _defineProperty2(this, "isHiresSetting", "hires" === settings.QUALITY_PATH),
    _defineProperty2(this, "interactedWithTrackBtn", !1),
    _defineProperty2(this, "isInDevMode", !1)
}
))
  , properties = new Properties
  , Ease = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "quadIn",
        value: function(e) {
            return e * e
        }
    }, {
        key: "quadOut",
        value: function(e) {
            return e * (2 - e)
        }
    }, {
        key: "quadInOut",
        value: function(e) {
            return (e *= 2) < 1 ? .5 * e * e : -.5 * (--e * (e - 2) - 1)
        }
    }, {
        key: "cubicIn",
        value: function(e) {
            return e * e * e
        }
    }, {
        key: "cubicOut",
        value: function(e) {
            return --e * e * e + 1
        }
    }, {
        key: "cubicInOut",
        value: function(e) {
            return (e *= 2) < 1 ? .5 * e * e * e : .5 * ((e -= 2) * e * e + 2)
        }
    }, {
        key: "quartIn",
        value: function(e) {
            return e * e * e * e
        }
    }, {
        key: "quartOut",
        value: function(e) {
            return 1 - --e * e * e * e
        }
    }, {
        key: "quartInOut",
        value: function(e) {
            return (e *= 2) < 1 ? .5 * e * e * e * e : -.5 * ((e -= 2) * e * e * e - 2)
        }
    }, {
        key: "quintIn",
        value: function(e) {
            return e * e * e * e * e
        }
    }, {
        key: "quintOut",
        value: function(e) {
            return --e * e * e * e * e + 1
        }
    }, {
        key: "quintInOut",
        value: function(e) {
            return (e *= 2) < 1 ? .5 * e * e * e * e * e : .5 * ((e -= 2) * e * e * e * e + 2)
        }
    }, {
        key: "sineIn",
        value: function(e) {
            return 1 - Math.cos(e * Math.PI / 2)
        }
    }, {
        key: "sineOut",
        value: function(e) {
            return Math.sin(e * Math.PI / 2)
        }
    }, {
        key: "sineInOut",
        value: function(e) {
            return .5 * (1 - Math.cos(Math.PI * e))
        }
    }, {
        key: "expoIn",
        value: function(e) {
            return 0 === e ? 0 : Math.pow(1024, e - 1)
        }
    }, {
        key: "expoOut",
        value: function(e) {
            return 1 === e ? 1 : 1 - Math.pow(2, -10 * e)
        }
    }, {
        key: "expoInOut",
        value: function(e) {
            return 0 === e ? 0 : 1 === e ? 1 : (e *= 2) < 1 ? .5 * Math.pow(1024, e - 1) : .5 * (2 - Math.pow(2, -10 * (e - 1)))
        }
    }, {
        key: "circIn",
        value: function(e) {
            return 1 - Math.sqrt(1 - e * e)
        }
    }, {
        key: "circOut",
        value: function(e) {
            return Math.sqrt(1 - --e * e)
        }
    }, {
        key: "circInOut",
        value: function(e) {
            return (e *= 2) < 1 ? -.5 * (Math.sqrt(1 - e * e) - 1) : .5 * (Math.sqrt(1 - (e -= 2) * e) + 1)
        }
    }, {
        key: "elasticIn",
        value: function(e) {
            var t, i = .1;
            return 0 === e ? 0 : 1 === e ? 1 : (!i || i < 1 ? (i = 1,
            t = .1) : t = .4 * Math.asin(1 / i) / (2 * Math.PI),
            -i * Math.pow(2, 10 * (e -= 1)) * Math.sin(2 * (e - t) * Math.PI / .4))
        }
    }, {
        key: "elasticOut",
        value: function(e) {
            var t, i = .1;
            return 0 === e ? 0 : 1 === e ? 1 : (!i || i < 1 ? (i = 1,
            t = .1) : t = .4 * Math.asin(1 / i) / (2 * Math.PI),
            i * Math.pow(2, -10 * e) * Math.sin(2 * (e - t) * Math.PI / .4) + 1)
        }
    }, {
        key: "elasticInOut",
        value: function(e) {
            var t, i = .1;
            return 0 === e ? 0 : 1 === e ? 1 : (!i || i < 1 ? (i = 1,
            t = .1) : t = .4 * Math.asin(1 / i) / (2 * Math.PI),
            (e *= 2) < 1 ? -.5 * i * Math.pow(2, 10 * (e -= 1)) * Math.sin(2 * (e - t) * Math.PI / .4) : i * Math.pow(2, -10 * (e -= 1)) * Math.sin(2 * (e - t) * Math.PI / .4) * .5 + 1)
        }
    }, {
        key: "backIn",
        value: function(e) {
            var t = 1.70158;
            return e * e * ((t + 1) * e - t)
        }
    }, {
        key: "backOut",
        value: function(e) {
            var t = 1.70158;
            return --e * e * ((t + 1) * e + t) + 1
        }
    }, {
        key: "backInOut",
        value: function(e) {
            var t = 2.5949095;
            return (e *= 2) < 1 ? .5 * e * e * ((t + 1) * e - t) : .5 * ((e -= 2) * e * ((t + 1) * e + t) + 2)
        }
    }, {
        key: "bounceIn",
        value: function(e) {
            return 1 - this.bounceOut(1 - e)
        }
    }, {
        key: "bounceOut",
        value: function(e) {
            return e < 1 / 2.75 ? 7.5625 * e * e : e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + .75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + .9375 : 7.5625 * (e -= 2.625 / 2.75) * e + .984375
        }
    }, {
        key: "bounceInOut",
        value: function(e) {
            return e < .5 ? .5 * this.bounceIn(2 * e) : .5 * this.bounceOut(2 * e - 1) + .5
        }
    }]),
    e
}()
  , ease = new Ease
  , _v1$5 = new Vector3
  , _q$1 = new Quaternion
  , _m4$1 = new Matrix4
  , MathUtils = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "PI", Math.PI),
        _defineProperty2(this, "PI2", 2 * this.PI),
        _defineProperty2(this, "HALF_PI", .5 * this.PI),
        _defineProperty2(this, "DEG2RAD", this.PI / 180),
        _defineProperty2(this, "RAD2DEG", 180 / this.PI)
    }
    return _createClass2(e, [{
        key: "step",
        value: function(e, t) {
            return t < e ? 0 : 1
        }
    }, {
        key: "clamp",
        value: function(e, t, i) {
            return e < t ? t : e > i ? i : e
        }
    }, {
        key: "mix",
        value: function(e, t, i) {
            return e + (t - e) * i
        }
    }, {
        key: "cMix",
        value: function(e, t, i) {
            return e + (t - e) * this.clamp(i, 0, 1)
        }
    }, {
        key: "unMix",
        value: function(e, t, i) {
            return (i - e) / (t - e)
        }
    }, {
        key: "cUnMix",
        value: function(e, t, i) {
            return this.clamp((i - e) / (t - e), 0, 1)
        }
    }, {
        key: "saturate",
        value: function(e) {
            return this.clamp(e, 0, 1)
        }
    }, {
        key: "fit",
        value: function(e, t, i, r, n, a) {
            return e = this.cUnMix(t, i, e),
            a && (e = a(e)),
            r + e * (n - r)
        }
    }, {
        key: "loop",
        value: function(e, t, i) {
            return i -= t,
            ((e -= t) < 0 ? (i - Math.abs(e) % i) % i : e % i) + t
        }
    }, {
        key: "normalize",
        value: function(e, t, i) {
            return Math.max(0, Math.min(1, e - t / i - t))
        }
    }, {
        key: "smoothstep",
        value: function(e, t, i) {
            return (i = this.cUnMix(e, t, i)) * i * (3 - 2 * i)
        }
    }, {
        key: "fract",
        value: function(e) {
            return e - Math.floor(e)
        }
    }, {
        key: "hash",
        value: function(e) {
            return this.fract(43758.5453123 * Math.sin(e))
        }
    }, {
        key: "hash2",
        value: function(e, t) {
            return this.fract(43758.5453 * Math.sin(12.9898 * e + 4.1414 * t))
        }
    }, {
        key: "sign",
        value: function(e) {
            return e ? e < 0 ? -1 : 1 : 0
        }
    }, {
        key: "isPowerOfTwo",
        value: function(e) {
            return (e & -e) === e
        }
    }, {
        key: "powerTwoCeilingBase",
        value: function(e) {
            return Math.ceil(Math.log(e) / Math.log(2))
        }
    }, {
        key: "powerTwoCeiling",
        value: function(e) {
            return this.isPowerOfTwo(e) ? e : 1 << this.powerTwoCeilingBase(e)
        }
    }, {
        key: "powerTwoFloorBase",
        value: function(e) {
            return Math.floor(Math.log(e) / Math.log(2))
        }
    }, {
        key: "powerTwoFloor",
        value: function(e) {
            return this.isPowerOfTwo(e) ? e : 1 << this.powerTwoFloorBase(e)
        }
    }, {
        key: "latLngBearing",
        value: function(e, t, i, r) {
            var n = Math.sin(r - t) * Math.cos(i)
              , a = Math.cos(e) * Math.sin(i) - Math.sin(e) * Math.cos(i) * Math.cos(r - t);
            return Math.atan2(n, a)
        }
    }, {
        key: "distanceTo",
        value: function(e, t) {
            return Math.sqrt(e * e + t * t)
        }
    }, {
        key: "distanceSqrTo",
        value: function(e, t) {
            return e * e + t * t
        }
    }, {
        key: "distanceTo3",
        value: function(e, t, i) {
            return Math.sqrt(e * e + t * t + i * i)
        }
    }, {
        key: "distanceSqrTo3",
        value: function(e, t, i) {
            return e * e + t * t + i * i
        }
    }, {
        key: "latLngDistance",
        value: function(e, t, i, r) {
            var n = Math.sin((i - e) / 2)
              , a = Math.sin((r - t) / 2)
              , o = n * n + Math.cos(e) * Math.cos(i) * a * a;
            return 2 * Math.atan2(Math.sqrt(o), Math.sqrt(1 - o))
        }
    }, {
        key: "cubicBezier",
        value: function(e, t, i, r, n) {
            var a = 3 * (t - e)
              , o = 3 * (i - t) - a
              , s = n * n;
            return s * n * (r - e - a - o) + o * s + a * n + e
        }
    }, {
        key: "cubicBezierFn",
        value: function(e, t, i, r) {
            var n = 3 * (t - e)
              , a = 3 * (i - t) - n
              , o = r - e - n - a;
            return function(t) {
                var i = t * t;
                return o * (i * t) + a * i + n * t + e
            }
        }
    }, {
        key: "normalizeAngle",
        value: function(e) {
            return (e = (e += this.PI) < 0 ? this.PI2 - Math.abs(e % PI2) : e % this.PI2) - this.PI
        }
    }, {
        key: "closestAngleTo",
        value: function(e, t) {
            return e + this.normalizeAngle(t - e)
        }
    }, {
        key: "lerp",
        value: function(e, t, i) {
            return e * (1 - i) + t * i
        }
    }, {
        key: "mod",
        value: function(e, t) {
            return (e % t + t) % t
        }
    }, {
        key: "obbApplyMatrix4",
        value: function(e, t) {
            _m4$1.setFromMatrix3(e.rotation),
            _q$1.setFromRotationMatrix(_m4$1),
            _m4$1.compose(e.center, _q$1, _v1$5.copy(e.halfSize).multiplyScalar(2)),
            _m4$1.premultiply(t),
            _m4$1.decompose(e.center, _q$1, e.halfSize),
            e.halfSize.divideScalar(2),
            _m4$1.makeRotationFromQuaternion(_q$1),
            e.rotation.setFromMatrix4(_m4$1)
        }
    }]),
    e
}()
  , math = new MathUtils
  , _changeEvent = {
    type: "change"
}
  , _startEvent = {
    type: "start"
}
  , _endEvent = {
    type: "end"
}
  , OrbitControls = function(e) {
    _inherits(i, EventDispatcher);
    var t = _createSuper(i);
    function i(e, r) {
        var n, a, o, s, l, h, c;
        _classCallCheck2(this, i),
        n = t.call(this),
        void 0 === r && console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),
        r === document && console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),
        n.object = e,
        n.domElement = r,
        n.domElement.style.touchAction = "none",
        n.minPanBorderX = -1 / 0,
        n.maxPanBorderX = 1 / 0,
        n.minPanBorderZ = -1 / 0,
        n.maxPanBorderZ = 1 / 0,
        n.panBorderBounceFactor = 0,
        n.enabled = !0,
        n.target = new Vector3,
        n.minDistance = 0,
        n.maxDistance = 1 / 0,
        n.minZoom = 0,
        n.maxZoom = 1 / 0,
        n.minPolarAngle = 0,
        n.maxPolarAngle = Math.PI,
        n.minAzimuthAngle = -1 / 0,
        n.maxAzimuthAngle = 1 / 0,
        n.enableDamping = !1,
        n.dampingFactor = .05,
        n.enableZoom = !0,
        n.zoomSpeed = 1,
        n.enableRotate = !0,
        n.rotateSpeed = 1,
        n.enablePan = !0,
        n.panSpeed = 1,
        n.screenSpacePanning = !0,
        n.keyPanSpeed = 7,
        n.autoRotate = !1,
        n.autoRotateSpeed = 2,
        n.keys = {
            LEFT: "ArrowLeft",
            UP: "ArrowUp",
            RIGHT: "ArrowRight",
            BOTTOM: "ArrowDown"
        },
        n.mouseButtons = {
            LEFT: MOUSE.ROTATE,
            MIDDLE: MOUSE.DOLLY,
            RIGHT: MOUSE.PAN
        },
        n.touches = {
            ONE: TOUCH.PAN,
            TWO: TOUCH.DOLLY_ROTATE
        },
        n.target0 = n.target.clone(),
        n.position0 = n.object.position.clone(),
        n.zoom0 = n.object.zoom,
        n.scale = 1,
        n._domElementKeyEvents = null,
        n.rotateToLeftByDegrees = function(e) {
            L(e),
            this.update()
        }
        ,
        n.getPolarAngle = function() {
            return m.phi
        }
        ,
        n.getAzimuthalAngle = function() {
            return m.theta
        }
        ,
        n.getDistance = function() {
            return this.object.position.distanceTo(this.target)
        }
        ,
        n.listenToKeyEvents = function(e) {
            e.addEventListener("keydown", J),
            this._domElementKeyEvents = e
        }
        ,
        n.saveState = function() {
            p.target0.copy(p.target),
            p.position0.copy(p.object.position),
            p.zoom0 = p.object.zoom
        }
        ,
        n.reset = function() {
            p.target.copy(p.target0),
            p.object.position.copy(p.position0),
            p.object.zoom = p.zoom0,
            p.scale = 1,
            p.object.updateProjectionMatrix(),
            p.dispatchEvent(_changeEvent),
            p.update(),
            d = u.NONE
        }
        ,
        n.update = (a = new Vector3,
        o = (new Quaternion).setFromUnitVectors(new Vector3(0,1,0), e.up),
        s = o.clone().invert(),
        l = new Vector3,
        h = new Quaternion,
        c = 2 * Math.PI,
        function() {
            var e = p.object.position;
            a.copy(e).sub(p.target),
            a.applyQuaternion(o),
            m.setFromVector3(a),
            p.autoRotate && d === u.NONE && L(2 * Math.PI / 60 / 60 * p.autoRotateSpeed),
            p.enableDamping ? (m.theta += g.theta * p.dampingFactor,
            m.phi += g.phi * p.dampingFactor) : (m.theta += g.theta,
            m.phi += g.phi);
            var t = p.minAzimuthAngle
              , i = p.maxAzimuthAngle;
            isFinite(t) && isFinite(i) && (t < -Math.PI ? t += c : t > Math.PI && (t -= c),
            i < -Math.PI ? i += c : i > Math.PI && (i -= c),
            m.theta = t <= i ? Math.max(t, Math.min(i, m.theta)) : m.theta > (t + i) / 2 ? Math.max(t, m.theta) : Math.min(i, m.theta)),
            m.phi = Math.max(p.minPolarAngle, Math.min(p.maxPolarAngle, m.phi)),
            m.makeSafe();
            var r = p.enableDamping ? (p.scale - 1) * p.dampingFactor + 1 : p.scale;
            return m.radius *= r,
            m.radius = Math.max(p.minDistance, Math.min(p.maxDistance, m.radius)),
            p.enablePanBorderCheck && (p.target.x < p.minPanBorderX ? (v.x += p.panBorderBounceFactor,
            p.dispatchEvent(_endEvent),
            d = u.NONE) : p.target.x > p.maxPanBorderX && (v.x -= p.panBorderBounceFactor,
            p.dispatchEvent(_endEvent),
            d = u.NONE),
            p.target.z < p.maxPanBorderZ ? (v.z += p.panBorderBounceFactor,
            p.dispatchEvent(_endEvent),
            d = u.NONE) : p.target.z > p.minPanBorderZ && (v.z -= p.panBorderBounceFactor,
            p.dispatchEvent(_endEvent),
            d = u.NONE)),
            !0 === p.enableDamping ? p.target.addScaledVector(v, p.dampingFactor) : p.target.add(v),
            a.setFromSpherical(m),
            a.applyQuaternion(s),
            e.copy(p.target).add(a),
            p.object.lookAt(p.target),
            !0 === p.enableDamping ? (g.theta *= 1 - p.dampingFactor,
            g.phi *= 1 - p.dampingFactor,
            v.multiplyScalar(1 - p.dampingFactor)) : (g.set(0, 0, 0),
            v.set(0, 0, 0)),
            p.scale = p.scale / r,
            !!(y || l.distanceToSquared(p.object.position) > f || 8 * (1 - h.dot(p.object.quaternion)) > f) && (p.dispatchEvent(_changeEvent),
            l.copy(p.object.position),
            h.copy(p.object.quaternion),
            y = !1,
            !0)
        }
        ),
        n.dispose = function() {
            p.domElement.removeEventListener("contextmenu", Q),
            p.domElement.removeEventListener("pointerdown", q),
            p.domElement.removeEventListener("pointercancel", K),
            p.domElement.removeEventListener("wheel", Z),
            p.domElement.removeEventListener("pointermove", X),
            p.domElement.removeEventListener("pointerup", Y),
            p.domElement.removeEventListener("pointerleave", Y),
            null !== p._domElementKeyEvents && p._domElementKeyEvents.removeEventListener("keydown", J)
        }
        ;
        var p = _assertThisInitialized(n)
          , u = {
            NONE: -1,
            ROTATE: 0,
            DOLLY: 1,
            PAN: 2,
            TOUCH_ROTATE: 3,
            TOUCH_PAN: 4,
            TOUCH_DOLLY_PAN: 5,
            TOUCH_DOLLY_ROTATE: 6
        }
          , d = u.NONE
          , f = 1e-6
          , m = new Spherical
          , g = new Spherical
          , v = new Vector3
          , y = !1
          , _ = new Vector2
          , b = new Vector2
          , x = new Vector2
          , w = new Vector2
          , S = new Vector2
          , T = new Vector2
          , k = new Vector2
          , E = new Vector2
          , M = new Vector2
          , P = []
          , C = {};
        function A() {
            return Math.pow(.95, p.zoomSpeed)
        }
        function L(e) {
            g.theta -= e
        }
        function D(e) {
            g.phi -= e
        }
        var I, R = (I = new Vector3,
        function(e, t) {
            I.setFromMatrixColumn(t, 0),
            I.multiplyScalar(-e),
            v.add(I)
        }
        ), F = function() {
            var e = new Vector3;
            return function(t, i) {
                !0 === p.screenSpacePanning ? e.setFromMatrixColumn(i, 1) : (e.setFromMatrixColumn(i, 0),
                e.crossVectors(p.object.up, e)),
                e.multiplyScalar(t),
                v.add(e)
            }
        }(), B = function() {
            var e = new Vector3;
            return function(t, i) {
                var r = p.domElement;
                if (p.object.isPerspectiveCamera) {
                    var n = p.object.position;
                    e.copy(n).sub(p.target);
                    var a = e.length();
                    a *= Math.tan(p.object.fov / 2 * Math.PI / 180),
                    R(2 * t * a / r.clientHeight, p.object.matrix),
                    F(2 * i * a / r.clientHeight, p.object.matrix)
                } else
                    p.object.isOrthographicCamera ? (R(t * (p.object.right - p.object.left) / p.object.zoom / r.clientWidth, p.object.matrix),
                    F(i * (p.object.top - p.object.bottom) / p.object.zoom / r.clientHeight, p.object.matrix)) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),
                    p.enablePan = !1)
            }
        }();
        function O(e) {
            p.object.isPerspectiveCamera ? p.scale /= e : p.object.isOrthographicCamera ? (p.object.zoom = Math.max(p.minZoom, Math.min(p.maxZoom, p.object.zoom * e)),
            p.object.updateProjectionMatrix(),
            y = !0) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),
            p.enableZoom = !1)
        }
        function N(e) {
            p.object.isPerspectiveCamera ? p.scale *= e : p.object.isOrthographicCamera ? (p.object.zoom = Math.max(p.minZoom, Math.min(p.maxZoom, p.object.zoom / e)),
            p.object.updateProjectionMatrix(),
            y = !0) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),
            p.enableZoom = !1)
        }
        function V(e) {
            _.set(e.clientX, e.clientY)
        }
        function z(e) {
            w.set(e.clientX, e.clientY)
        }
        function G() {
            if (1 === P.length)
                _.set(P[0].pageX, P[0].pageY);
            else {
                var e = .5 * (P[0].pageX + P[1].pageX)
                  , t = .5 * (P[0].pageY + P[1].pageY);
                _.set(e, t)
            }
        }
        function H() {
            if (1 === P.length)
                w.set(P[0].pageX, P[0].pageY);
            else {
                var e = .5 * (P[0].pageX + P[1].pageX)
                  , t = .5 * (P[0].pageY + P[1].pageY);
                w.set(e, t)
            }
        }
        function U() {
            var e = P[0].pageX - P[1].pageX
              , t = P[0].pageY - P[1].pageY
              , i = Math.sqrt(e * e + t * t);
            k.set(0, i)
        }
        function W(e) {
            if (1 == P.length)
                b.set(e.pageX, e.pageY);
            else {
                var t = ie(e)
                  , i = .5 * (e.pageX + t.x)
                  , r = .5 * (e.pageY + t.y);
                b.set(i, r)
            }
            x.subVectors(b, _).multiplyScalar(p.rotateSpeed);
            var n = p.domElement;
            L(2 * Math.PI * x.x / n.clientHeight),
            D(2 * Math.PI * x.y / n.clientHeight),
            _.copy(b)
        }
        function j(e) {
            if (1 === P.length)
                S.set(e.pageX, e.pageY);
            else {
                var t = ie(e)
                  , i = .5 * (e.pageX + t.x)
                  , r = .5 * (e.pageY + t.y);
                S.set(i, r)
            }
            T.subVectors(S, w).multiplyScalar(p.panSpeed),
            B(T.x, T.y),
            w.copy(S)
        }
        function $(e) {
            var t = ie(e)
              , i = e.pageX - t.x
              , r = e.pageY - t.y
              , n = Math.sqrt(i * i + r * r);
            E.set(0, n),
            M.set(0, Math.pow(E.y / k.y, p.zoomSpeed)),
            O(M.y),
            k.copy(E)
        }
        function q(e) {
            !1 !== p.enabled && (0 === P.length && (p.domElement.setPointerCapture(e.pointerId),
            p.domElement.addEventListener("pointermove", X),
            p.domElement.addEventListener("pointerup", Y)),
            function(e) {
                P.push(e)
            }(e),
            "touch" === e.pointerType ? function(e) {
                switch (te(e),
                P.length) {
                case 1:
                    switch (p.touches.ONE) {
                    case TOUCH.ROTATE:
                        if (!1 === p.enableRotate)
                            return;
                        G(),
                        d = u.TOUCH_ROTATE;
                        break;
                    case TOUCH.PAN:
                        if (!1 === p.enablePan)
                            return;
                        H(),
                        d = u.TOUCH_PAN;
                        break;
                    default:
                        d = u.NONE
                    }
                    break;
                case 2:
                    switch (p.touches.TWO) {
                    case TOUCH.DOLLY_PAN:
                        if (!1 === p.enableZoom && !1 === p.enablePan)
                            return;
                        p.enableZoom && U(),
                        p.enablePan && H(),
                        d = u.TOUCH_DOLLY_PAN;
                        break;
                    case TOUCH.DOLLY_ROTATE:
                        if (!1 === p.enableZoom && !1 === p.enableRotate)
                            return;
                        p.enableZoom && U(),
                        p.enableRotate && G(),
                        d = u.TOUCH_DOLLY_ROTATE;
                        break;
                    default:
                        d = u.NONE
                    }
                    break;
                default:
                    d = u.NONE
                }
                d !== u.NONE && p.dispatchEvent(_startEvent)
            }(e) : function(e) {
                var t;
                switch (e.button) {
                case 0:
                    t = p.mouseButtons.LEFT;
                    break;
                case 1:
                    t = p.mouseButtons.MIDDLE;
                    break;
                case 2:
                    t = p.mouseButtons.RIGHT;
                    break;
                default:
                    t = -1
                }
                switch (t) {
                case MOUSE.DOLLY:
                    if (!1 === p.enableZoom)
                        return;
                    !function(e) {
                        k.set(e.clientX, e.clientY)
                    }(e),
                    d = u.DOLLY;
                    break;
                case MOUSE.ROTATE:
                    if (e.ctrlKey || e.metaKey || e.shiftKey) {
                        if (!1 === p.enablePan)
                            return;
                        z(e),
                        d = u.PAN
                    } else {
                        if (!1 === p.enableRotate)
                            return;
                        V(e),
                        d = u.ROTATE
                    }
                    break;
                case MOUSE.PAN:
                    if (e.ctrlKey || e.metaKey || e.shiftKey) {
                        if (!1 === p.enableRotate)
                            return;
                        V(e),
                        d = u.ROTATE
                    } else {
                        if (!1 === p.enablePan)
                            return;
                        z(e),
                        d = u.PAN
                    }
                    break;
                default:
                    d = u.NONE
                }
                d !== u.NONE && p.dispatchEvent(_startEvent)
            }(e))
        }
        function X(e) {
            !1 !== p.enabled && ("touch" === e.pointerType ? function(e) {
                switch (te(e),
                d) {
                case u.TOUCH_ROTATE:
                    if (!1 === p.enableRotate)
                        return;
                    W(e),
                    p.update();
                    break;
                case u.TOUCH_PAN:
                    if (!1 === p.enablePan)
                        return;
                    j(e),
                    p.update();
                    break;
                case u.TOUCH_DOLLY_PAN:
                    if (!1 === p.enableZoom && !1 === p.enablePan)
                        return;
                    !function(e) {
                        p.enableZoom && $(e),
                        p.enablePan && j(e)
                    }(e),
                    p.update();
                    break;
                case u.TOUCH_DOLLY_ROTATE:
                    if (!1 === p.enableZoom && !1 === p.enableRotate)
                        return;
                    !function(e) {
                        p.enableZoom && $(e),
                        p.enableRotate && W(e)
                    }(e),
                    p.update();
                    break;
                default:
                    d = u.NONE
                }
            }(e) : function(e) {
                if (!1 !== p.enabled)
                    switch (d) {
                    case u.ROTATE:
                        if (!1 === p.enableRotate)
                            return;
                        !function(e) {
                            b.set(e.clientX, e.clientY),
                            x.subVectors(b, _).multiplyScalar(p.rotateSpeed);
                            var t = p.domElement;
                            L(2 * Math.PI * x.x / t.clientHeight),
                            D(2 * Math.PI * x.y / t.clientHeight),
                            _.copy(b),
                            p.update()
                        }(e);
                        break;
                    case u.DOLLY:
                        if (!1 === p.enableZoom)
                            return;
                        !function(e) {
                            E.set(e.clientX, e.clientY),
                            M.subVectors(E, k),
                            M.y > 0 ? O(A()) : M.y < 0 && N(A()),
                            k.copy(E),
                            p.update()
                        }(e);
                        break;
                    case u.PAN:
                        if (!1 === p.enablePan)
                            return;
                        !function(e) {
                            S.set(e.clientX, e.clientY),
                            T.subVectors(S, w).multiplyScalar(p.panSpeed),
                            B(T.x, T.y),
                            w.copy(S),
                            p.update()
                        }(e)
                    }
            }(e))
        }
        function Y(e) {
            !1 !== p.enabled && (e.pointerType,
            p.dispatchEvent(_endEvent),
            d = u.NONE,
            ee(e),
            0 === P.length && (p.domElement.releasePointerCapture(e.pointerId),
            p.domElement.removeEventListener("pointermove", X),
            p.domElement.removeEventListener("pointerup", Y)))
        }
        function K(e) {
            ee(e)
        }
        function Z(e) {
            !1 === p.enabled || !1 === p.enableZoom || d !== u.NONE && d !== u.ROTATE || (e.preventDefault(),
            p.dispatchEvent(_startEvent),
            function(e) {
                e.deltaY < 0 ? N(A()) : e.deltaY > 0 && O(A()),
                p.update()
            }(e),
            p.dispatchEvent(_endEvent))
        }
        function J(e) {
            !1 !== p.enabled && !1 !== p.enablePan && function(e) {
                var t = !1;
                switch (e.code) {
                case p.keys.UP:
                    B(0, p.keyPanSpeed),
                    t = !0;
                    break;
                case p.keys.BOTTOM:
                    B(0, -p.keyPanSpeed),
                    t = !0;
                    break;
                case p.keys.LEFT:
                    B(p.keyPanSpeed, 0),
                    t = !0;
                    break;
                case p.keys.RIGHT:
                    B(-p.keyPanSpeed, 0),
                    t = !0
                }
                t && (e.preventDefault(),
                p.update())
            }(e)
        }
        function Q(e) {
            !1 !== p.enabled && e.preventDefault()
        }
        function ee(e) {
            delete C[e.pointerId];
            for (var t = 0; t < P.length; t++)
                if (P[t].pointerId == e.pointerId)
                    return void P.splice(t, 1)
        }
        function te(e) {
            var t = C[e.pointerId];
            void 0 === t && (t = new Vector2,
            C[e.pointerId] = t),
            t.set(e.pageX, e.pageY)
        }
        function ie(e) {
            var t = e.pointerId === P[0].pointerId ? P[1] : P[0];
            return C[t.pointerId]
        }
        return p.domElement.addEventListener("contextmenu", Q),
        p.domElement.addEventListener("pointerdown", q),
        p.domElement.addEventListener("pointercancel", K),
        p.domElement.addEventListener("wheel", Z, {
            passive: !1
        }),
        p.domElement.addEventListener("pointerleave", Y),
        n.update(),
        n
    }
    return _createClass2(i)
}()
  , Simple1DNoise = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "_scale", 1),
        _defineProperty2(this, "_amplitude", 1),
        _defineProperty2(this, "_r", []);
        for (var t = 0; t < e.MAX_VERTICES; ++t)
            this._r.push(Math.random() - .5)
    }
    return _createClass2(e, [{
        key: "getVal",
        value: function(t) {
            var i = t * this._scale
              , r = Math.floor(i)
              , n = i - r
              , a = n * n * (3 - 2 * n)
              , o = r & e.MAX_VERTICES_MASK
              , s = o + 1 & e.MAX_VERTICES_MASK;
            return math.lerp(this._r[o], this._r[s], a) * this._amplitude
        }
    }, {
        key: "amplitude",
        get: function() {
            return this._amplitude
        },
        set: function(e) {
            this._amplitude = e
        }
    }, {
        key: "scale",
        get: function() {
            return this._scale
        },
        set: function(e) {
            this._scale = e
        }
    }]),
    e
}();
_defineProperty2(Simple1DNoise, "MAX_VERTICES", 256),
_defineProperty2(Simple1DNoise, "MAX_VERTICES_MASK", Simple1DNoise.MAX_VERTICES - 1);
var _e = new Euler
  , _v = new Vector3
  , BrownianMotion = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "_position", new Vector3),
        _defineProperty2(this, "_rotation", new Quaternion),
        _defineProperty2(this, "_scale", new Vector3(1,1,1)),
        _defineProperty2(this, "_matrix", new Matrix4),
        _defineProperty2(this, "_enablePositionNoise", !0),
        _defineProperty2(this, "_enableRotationNoise", !0),
        _defineProperty2(this, "_positionFrequency", .25),
        _defineProperty2(this, "_rotationFrequency", .25),
        _defineProperty2(this, "_positionAmplitude", .3),
        _defineProperty2(this, "_rotationAmplitude", .003),
        _defineProperty2(this, "_positionScale", new Vector3(1,1,1)),
        _defineProperty2(this, "_rotationScale", new Vector3(1,1,0)),
        _defineProperty2(this, "_positionFractalLevel", 3),
        _defineProperty2(this, "_rotationFractalLevel", 3),
        _defineProperty2(this, "_times", new Float32Array(6)),
        _defineProperty2(this, "_noise", new Simple1DNoise),
        this.rehash()
    }
    return _createClass2(e, [{
        key: "rehash",
        value: function() {
            for (var e = 0; e < 6; e++)
                this._times[e] = -1e4 * Math.random()
        }
    }, {
        key: "_fbm",
        value: function(e, t) {
            for (var i = 0, r = .5, n = 0; n < t; n++)
                i += r * this._noise.getVal(e),
                e *= 2,
                r *= .5;
            return i
        }
    }, {
        key: "update",
        value: function(t) {
            var i = void 0 === t ? 1e3 / 60 : t;
            if (this._enablePositionNoise) {
                for (var r = 0; r < 3; r++)
                    this._times[r] += this._positionFrequency * i;
                _v.set(this._fbm(this._times[0], this._positionFractalLevel), this._fbm(this._times[1], this._positionFractalLevel), this._fbm(this._times[2], this._positionFractalLevel)),
                _v.multiply(this._positionScale),
                _v.multiplyScalar(this._positionAmplitude * e.FBM_NORM),
                this._position.copy(_v)
            }
            if (this._enableRotationNoise) {
                for (var n = 0; n < 3; n++)
                    this._times[n + 3] += this._rotationFrequency * i;
                _v.set(this._fbm(this._times[3], this._rotationFractalLevel), this._fbm(this._times[4], this._rotationFractalLevel), this._fbm(this._times[5], this._rotationFractalLevel)),
                _v.multiply(this._rotationScale),
                _v.multiplyScalar(this._rotationAmplitude * e.FBM_NORM),
                _e.set(_v.x, _v.y, _v.z),
                this._rotation.setFromEuler(_e)
            }
            this._matrix.compose(this._position, this._rotation, this._scale)
        }
    }, {
        key: "positionAmplitude",
        get: function() {
            return this._positionAmplitude
        },
        set: function(e) {
            this._positionAmplitude = e
        }
    }, {
        key: "positionFrequency",
        get: function() {
            return this._positionFrequency
        },
        set: function(e) {
            this._positionFrequency = e
        }
    }, {
        key: "rotationAmplitude",
        get: function() {
            return this._rotationAmplitude
        },
        set: function(e) {
            this._rotationAmplitude = e
        }
    }, {
        key: "rotationFrequency",
        get: function() {
            return this._rotationFrequency
        },
        set: function(e) {
            this._rotationFrequency = e
        }
    }, {
        key: "matrix",
        get: function() {
            return this._matrix
        },
        set: function(e) {
            this._matrix = e
        }
    }]),
    e
}();
_defineProperty2(BrownianMotion, "FBM_NORM", 1 / .75);
var SpriteAnimation = function() {
    function e(t) {
        var i = t.jsonSheets
          , r = t.spriteSheets
          , n = t.imgContainer
          , a = t.intro
          , o = t.hover
          , s = t.hoverOut
          , l = t.hoverElement;
        _classCallCheck2(this, e),
        this.jsonSheets = i,
        this.spriteSheets = r,
        this.imgContainer = n,
        this.intro = a,
        this.hover = o,
        this.hoverOut = s,
        this.hoverElement = l,
        this.canvas = null,
        this.ctx = null,
        this.bcr = null,
        this.currentSheet = 0,
        this.currentFrame = 0,
        this.offsetX = 0,
        this.offsetY = 0,
        this.previousFrame = 0,
        this.time = 0,
        this.fps = 60,
        this.isAnimating = !1,
        this.speed = 1,
        this.isReverse = !1,
        this.spritesPerSheet = 0,
        this.lastHoverFrame = 0,
        this.multipleSheet = !!this.jsonSheets[0],
        this.onPointerOverCanvas = this.onPointerOverCanvas.bind(this)
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            var e = this;
            this.totalSprites = 0,
            this.multipleSheet ? (this.spritesPerSheet = this.jsonSheets[0].frames.length,
            this.jsonSheets.forEach((function(t) {
                e.totalSprites += t.frames.length
            }
            )),
            this.totalSprites -= 1) : (this.spritesPerSheet = this.jsonSheets.frames.length,
            this.totalSprites += this.jsonSheets.frames.length)
        }
    }, {
        key: "createCanvas",
        value: function(e) {
            var t;
            this.bcr = e.getBoundingClientRect(),
            this.canvas = document.createElement("canvas"),
            this.ctx = this.canvas.getContext("2d"),
            t = this.multipleSheet ? this.jsonSheets[0].frames[0].spriteSourceSize : this.jsonSheets.frames[0].spriteSourceSize,
            this.canvas.width = t.w,
            this.canvas.height = t.h,
            this.canvas.style.width = this.bcr.width + "px",
            this.canvas.style.height = this.bcr.height + "px",
            this.canvas.style.position = "absolute",
            e.style.opacity = 0,
            e.parentNode.appendChild(this.canvas),
            this.hover && this.createEvents(),
            this.currentFrame = 0,
            this.drawSprite()
        }
    }, {
        key: "createEvents",
        value: function() {
            var e = this;
            this.hoverElement ? this.hoverElement.addEventListener("pointerenter", this.onPointerOverCanvas) : this.imgContainer ? this.imgContainer.addEventListener("pointerenter", this.onPointerOverCanvas) : this.canvas.addEventListener("pointerenter", this.onPointerOverCanvas),
            this.hoverOut && (this.hoverElement ? this.hoverElement.addEventListener("pointerleave", (function() {
                return e.reverse({
                    speed: 1
                })
            }
            )) : this.imgContainer ? this.imgContainer.addEventListener("pointerleave", (function() {
                return e.reverse({
                    speed: 1
                })
            }
            )) : this.canvas.addEventListener("pointerleave", (function() {
                return e.reverse({
                    speed: 1
                })
            }
            )))
        }
    }, {
        key: "onPointerOverCanvas",
        value: function() {
            this.isReverse && (this.isReverse = !1,
            this.lastHoverFrame = this.currentFrame,
            0 === this.lastHoverFrame && (this.lastHoverFrame = this.totalSprites),
            this.reset()),
            this.isAnimating = !0
        }
    }, {
        key: "drawSprite",
        value: function() {
            var e;
            this.currentSheet = Math.floor(this.currentFrame / this.spritesPerSheet),
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height),
            this.multipleSheet ? (e = this.jsonSheets[this.currentSheet].frames[this.currentFrame % this.spritesPerSheet],
            this.ctx.drawImage(this.spriteSheets[this.currentSheet], e.frame.x, e.frame.y, e.frame.w, e.frame.h, e.spriteSourceSize.x, e.spriteSourceSize.y, e.spriteSourceSize.w, e.spriteSourceSize.h)) : (e = this.jsonSheets.frames[this.currentFrame % this.spritesPerSheet],
            this.ctx.drawImage(this.spriteSheets, e.frame.x, e.frame.y, e.frame.w, e.frame.h, e.spriteSourceSize.x, e.spriteSourceSize.y, e.spriteSourceSize.w, e.spriteSourceSize.h))
        }
    }, {
        key: "play",
        value: function() {
            this.reset(),
            this.isAnimating = !0,
            this.intro && settings.SKIP_ANIMATION && (properties.isPreloaderAnimationFinished = !0,
            this.isAnimating = !1)
        }
    }, {
        key: "reverse",
        value: function(e) {
            var t = e.speed
              , i = void 0 === t ? 1 : t;
            this.lastHoverFrame = this.currentFrame,
            0 === this.lastHoverFrame && (this.lastHoverFrame = this.totalSprites),
            this.reset(),
            this.lastHoverFrame > this.totalSprites / 2 ? this.speed = i : this.speed = 1,
            this.isReverse = !0,
            this.isAnimating = !0
        }
    }, {
        key: "updateSprite",
        value: function(e) {
            if (this.isAnimating) {
                if (this.previousFrame = this.currentFrame,
                this.time += e,
                this.isReverse ? this.currentFrame = this.lastHoverFrame - Math.floor(this.time * this.fps * this.speed) - 1 : this.currentFrame = Math.floor(this.time * this.fps * this.speed),
                this.currentFrame >= this.totalSprites)
                    return this.intro && (properties.isPreloaderAnimationFinished = !0),
                    this.reset();
                if (this.currentFrame < 0)
                    return this.reset();
                this.currentFrame !== this.previousFrame && this.drawSprite()
            }
        }
    }, {
        key: "reset",
        value: function() {
            this.isReverse = !1,
            this.isAnimating = !1,
            this.speed = 1,
            this.currentSheet = 0,
            this.currentFrame = 0,
            this.time = 0
        }
    }]),
    e
}()
  , Mouse = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elContainerStill = null,
        this.elContainerHover = null,
        this.elHover = null,
        this.current = {
            x: 0,
            y: 0
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--mouse"),
            this.elContainerStill = this.elContainer.querySelector(".mouse-still"),
            this.elContainerHover = this.elContainer.querySelector(".mouse-hover")
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elHover = document.querySelectorAll("section[data-mouse-hover], button[data-mouse-hover], img[data-mouse-hover], a[data-mouse-hover], input[data-mouse-hover], div[data-mouse-hover]"),
            this.elHover.forEach((function(t) {
                return t.addEventListener("pointerenter", (function() {
                    return e.onElPointerEnter()
                }
                ))
            }
            )),
            this.elHover.forEach((function(t) {
                return t.addEventListener("pointerleave", (function() {
                    return e.onElPointerLeave()
                }
                ))
            }
            )),
            document.addEventListener("pointerenter", (function() {
                return e.onPointerEnterDoc()
            }
            )),
            document.addEventListener("pointerleave", (function() {
                return e.onPointerLeaveDoc()
            }
            ))
        }
    }, {
        key: "onAudioBtnClick",
        value: function() {}
    }, {
        key: "addEventOnDisplayNoneElement",
        value: function(e) {
            var t = this;
            e.addEventListener("pointerenter", (function() {
                return t.onElPointerEnter()
            }
            )),
            e.addEventListener("pointerleave", (function() {
                return t.onElPointerLeave()
            }
            ))
        }
    }, {
        key: "onElPointerEnter",
        value: function() {
            this.elContainerStill.style.display = "none",
            this.elContainerHover.style.display = "block"
        }
    }, {
        key: "onElPointerLeave",
        value: function() {
            this.elContainerStill.style.display = "block",
            this.elContainerHover.style.display = "none"
        }
    }, {
        key: "onPointerEnterDoc",
        value: function() {
            this.elContainer.style.opacity = 1
        }
    }, {
        key: "onPointerLeaveDoc",
        value: function() {
            this.elContainer.style.opacity = 0
        }
    }, {
        key: "removeHideClass",
        value: function() {
            this.elContainer.classList.remove("hide")
        }
    }, {
        key: "update",
        value: function(e) {
            this.current.x = input.mousePixelXY.x,
            this.current.y = input.mousePixelXY.y,
            this.elContainer.style.transform = "translate(".concat(this.current.x - 8, "px, ").concat(this.current.y, "px)")
        }
    }]),
    e
}()
  , mouse = new Mouse
  , minSignal = {
    exports: {}
};
!function(e) {
    !function(t) {
        function i() {
            this._listeners = [],
            this.dispatchCount = 0
        }
        var r = i.prototype;
        r.add = s,
        r.addOnce = function(e, i, r, o) {
            if (!e)
                throw n;
            var l = this
              , h = function() {
                return l.remove.call(l, e, i),
                e.apply(i, a.call(arguments, 0))
            };
            1 === (o = a.call(arguments, 0)).length && o.push(t),
            o.splice(2, 0, h),
            s.apply(l, o)
        }
        ,
        r.remove = function(e, t) {
            if (!e)
                return this._listeners.length = 0,
                !0;
            for (var i, r = this._listeners, n = r.length; n--; )
                if ((i = r[n]).f === e && (!t || i.c === t))
                    return i.j = 0,
                    r.splice(n, 1),
                    !0;
            return !1
        }
        ,
        r.dispatch = function(e) {
            e = a.call(arguments, 0),
            this.dispatchCount++;
            for (var t, i, r = this.dispatchCount, n = this._listeners, o = n.length; o--; )
                if ((t = n[o]) && t.j < r && (t.j = r,
                !1 === t.r.apply(t.c, t.a.concat(e)))) {
                    i = t;
                    break
                }
            for (o = (n = this._listeners).length; o--; )
                n[o].j = 0;
            return i
        }
        ;
        var n = "Callback function is missing!"
          , a = Array.prototype.slice;
        function o(e) {
            e.sort((function(e, t) {
                return e = e.p,
                (t = t.p) < e ? 1 : t > e ? -1 : 0
            }
            ))
        }
        function s(e, t, i, r) {
            if (!e)
                throw n;
            i = i || 0;
            for (var s, l, h, c = this._listeners, p = c.length; p--; )
                if ((s = c[p]).f === e && s.c === t)
                    return !1;
            "function" == typeof i && (l = i,
            i = r,
            h = 4),
            c.unshift({
                f: e,
                c: t,
                p: i,
                r: l || e,
                a: a.call(arguments, h || 3),
                j: 0
            }),
            o(c)
        }
        e.exports = i
    }()
}(minSignal);
var MinSignal = minSignal.exports
  , blitVert = "#define GLSLIFY 1\nattribute vec2 position;varying vec2 v_uv;void main(){v_uv=position*0.5+0.5;gl_Position=vec4(position,0.0,1.0);}"
  , blitFrag = "#define GLSLIFY 1\nuniform sampler2D u_texture;varying vec2 v_uv;void main(){gl_FragColor=texture2D(u_texture,v_uv);}"
  , flipYVert = "#define GLSLIFY 1\nattribute vec2 position;varying vec2 v_uv;void main(){v_uv=position*0.5+0.5;v_uv.y=1.0-v_uv.y;gl_Position=vec4(position,0.0,1.0);}"
  , uvBlitVert = "#define GLSLIFY 1\nattribute vec2 position;attribute vec2 uv;varying vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position,0.0,1.0);}"
  , clearFrag = "#define GLSLIFY 1\nuniform vec4 u_color;varying vec2 v_uv;void main(){gl_FragColor=u_color;}"
  , debugVert = "#define GLSLIFY 1\nattribute vec3 position;attribute vec2 uv;uniform vec4 u_transform;varying vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy*u_transform.zw+u_transform.xy,0.0,1.0);}"
  , FboHelper = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "renderer", void 0),
        _defineProperty2(this, "quadGeom", void 0),
        _defineProperty2(this, "triGeom", void 0),
        _defineProperty2(this, "floatType", void 0),
        _defineProperty2(this, "precisionPrefix", void 0),
        _defineProperty2(this, "precisionPrefix2", void 0),
        _defineProperty2(this, "vertexShader", void 0),
        _defineProperty2(this, "_scene", void 0),
        _defineProperty2(this, "_camera", void 0),
        _defineProperty2(this, "_tri", void 0),
        _defineProperty2(this, "copyMaterial", void 0),
        _defineProperty2(this, "flipYMaterial", void 0),
        _defineProperty2(this, "uvCopyMaterial", void 0),
        _defineProperty2(this, "clearMaterial", void 0),
        _defineProperty2(this, "_debugScene", void 0),
        _defineProperty2(this, "_debugMesh", void 0),
        _defineProperty2(this, "_debugMaterial", void 0)
    }
    return _createClass2(e, [{
        key: "init",
        value: function(e, t) {
            this.renderer = e,
            this.floatType = t,
            this._scene = new Scene,
            this._camera = new Camera,
            this._camera.position.z = 1,
            this.triGeom = new BufferGeometry,
            this.triGeom.setAttribute("position", new BufferAttribute(new Float32Array([-1, -1, 0, 4, -1, 0, -1, 4, 0]),3)),
            this.quadGeom = new PlaneGeometry(2,2),
            this._tri = new Mesh(this.triGeom),
            this._tri.frustumCulled = !1,
            this._scene.add(this._tri),
            this.precisionPrefix = "precision ".concat(this.renderer.capabilities.precision, " float;\n"),
            this.precisionPrefix2 = "#version 300 es\n\t\t\tprecision ".concat(this.renderer.capabilities.precision, " float;\n\t\t\tprecision ").concat(this.renderer.capabilities.precision, " int;\n\t\t\t#define IS_WEBGL2 true\n\t\t"),
            this.vertexShader = this.precisionPrefix + blitVert,
            this.copyMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    }
                },
                vertexShader: this.vertexShader,
                fragmentShader: this.precisionPrefix + blitFrag,
                depthTest: !1,
                depthWrite: !1,
                blending: NoBlending
            }),
            this.flipYMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    }
                },
                vertexShader: this.precisionPrefix + flipYVert,
                fragmentShader: this.precisionPrefix + blitFrag,
                depthTest: !1,
                depthWrite: !1,
                blending: NoBlending
            }),
            this.uvCopyMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    }
                },
                vertexShader: this.precisionPrefix + uvBlitVert,
                fragmentShader: this.precisionPrefix + blitFrag,
                depthTest: !1,
                depthWrite: !1,
                blending: NoBlending
            }),
            this.clearMaterial = new RawShaderMaterial({
                uniforms: {
                    u_color: {
                        value: new Vector4(1,1,1,1)
                    }
                },
                vertexShader: this.vertexShader,
                fragmentShader: this.precisionPrefix + clearFrag,
                depthTest: !1,
                depthWrite: !1,
                transparent: !0,
                blending: NoBlending
            });
            var i = new PlaneGeometry(1,1);
            i.translate(.5, -.5, 0),
            this._debugMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_transform: {
                        value: new Vector4(0,0,1,1)
                    }
                },
                vertexShader: this.precisionPrefix + debugVert,
                fragmentShader: this.precisionPrefix + blitFrag,
                depthTest: !1,
                depthWrite: !1,
                blending: NoBlending
            }),
            this._debugMesh = new Mesh(i,this._debugMaterial),
            this._debugScene = new Scene,
            this._debugScene.frustumCulled = !1,
            this._debugScene.add(this._debugMesh)
        }
    }, {
        key: "copy",
        value: function(e, t) {
            var i = this.copyMaterial;
            i && (i.uniforms.u_texture.value = e,
            this.render(i, t))
        }
    }, {
        key: "flipY",
        value: function(e, t) {
            var i = this.flipYMaterial;
            i && (i.uniforms.u_texture.value = e,
            this.render(i, t))
        }
    }, {
        key: "uvCopy",
        value: function(e, t) {
            var i = this.uvCopyMaterial;
            i && (i.uniforms.u_texture.value = e,
            this.render(i, t))
        }
    }, {
        key: "render",
        value: function(e, t) {
            this._tri && this.renderer && this._scene && this._camera && (this._tri.material = e,
            t && this.renderer.setRenderTarget(t),
            this.renderer.render(this._scene, this._camera),
            t && this.renderer.setRenderTarget(null))
        }
    }, {
        key: "renderGeometry",
        value: function(e, t, i) {
            this._tri && this.triGeom && (this._tri.geometry = e,
            this.render(t, i),
            this._tri.geometry = this.triGeom)
        }
    }, {
        key: "renderMesh",
        value: function(e, t) {
            this._tri && this.renderer && this._scene && this._camera && (this._tri.visible = !1,
            this._scene.add(e),
            t && this.renderer.setRenderTarget(t || null),
            this.renderer.render(this._scene, this._camera),
            t && this.renderer.setRenderTarget(null),
            this._scene.remove(e),
            this._tri.visible = !0)
        }
    }, {
        key: "debugTo",
        value: function(e, t, i, r, n) {
            if (this.renderer && this._debugMaterial && this._debugScene && this._camera) {
                t = t || 200,
                i = i || 200,
                r = r || 0,
                n = n || 0;
                var a = this.renderer.getSize(new Vector2);
                r = r / a.width * 2 - 1,
                n = 1 - n / a.height * 2,
                t = t / a.width * 2,
                i = i / a.height * 2,
                this._debugMaterial.uniforms.u_texture.value = e,
                this._debugMaterial.uniforms.u_transform.value.set(r, n, t, i);
                var o = this.getColorState();
                this.renderer.autoClearColor = !1,
                this.renderer.setRenderTarget(null),
                this.renderer.render(this._debugScene, this._camera),
                this.setColorState(o)
            }
        }
    }, {
        key: "parseDefines",
        value: function(e) {
            var t = "";
            for (var i in e) {
                var r = e[i];
                t += !0 === r ? "#define ".concat(i, "\n") : "#define ".concat(i, " ").concat(r, "\n")
            }
            return t
        }
    }, {
        key: "clearColor",
        value: function(e, t, i, r, n) {
            this.clearMaterial && (this.clearMaterial.uniforms.u_color.value.set(e, t, i, r),
            this.clearMaterial.transparent = r < 1,
            this.clearMaterial.blending = r < 1 ? NormalBlending : NoBlending,
            this.render(this.clearMaterial, n),
            this.clearMaterial.transparent = !1,
            this.clearMaterial.blending = NoBlending)
        }
    }, {
        key: "getColorState",
        value: function() {
            if (!this.renderer)
                return {
                    autoClear: !0,
                    autoClearColor: !0,
                    autoClearStencil: !0,
                    autoClearDepth: !0,
                    clearColor: 0,
                    clearAlpha: 1
                };
            var e = new Color;
            return this.renderer.getClearColor(e),
            {
                autoClear: this.renderer.autoClear,
                autoClearColor: this.renderer.autoClearColor,
                autoClearStencil: this.renderer.autoClearStencil,
                autoClearDepth: this.renderer.autoClearDepth,
                clearColor: e.getHex(),
                clearAlpha: this.renderer.getClearAlpha()
            }
        }
    }, {
        key: "setColorState",
        value: function(e) {
            this.renderer && (this.renderer.setClearColor(e.clearColor, e.clearAlpha),
            this.renderer.autoClear = e.autoClear,
            this.renderer.autoClearColor = e.autoClearColor,
            this.renderer.autoClearStencil = e.autoClearStencil,
            this.renderer.autoClearDepth = e.autoClearDepth)
        }
    }, {
        key: "createRenderTarget",
        value: function(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2]
              , r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]
              , n = arguments.length > 4 && void 0 !== arguments[4] && arguments[4];
            return new WebGLRenderTarget(e,t,{
                wrapS: ClampToEdgeWrapping,
                wrapT: ClampToEdgeWrapping,
                magFilter: r ? NearestFilter : LinearFilter,
                minFilter: r ? NearestFilter : LinearFilter,
                format: i ? RGBAFormat : RGBFormat,
                type: n ? this.floatType : UnsignedByteType,
                anisotropy: 0,
                encoding: LinearEncoding,
                depthBuffer: !1,
                stencilBuffer: !1
            })
        }
    }, {
        key: "createMultisampleRenderTarget",
        value: function(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2]
              , r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]
              , n = arguments.length > 4 && void 0 !== arguments[4] && arguments[4];
            return this.renderer && this.renderer.capabilities.isWebGL2 ? new WebGLMultisampleRenderTarget(e,t,{
                wrapS: ClampToEdgeWrapping,
                wrapT: ClampToEdgeWrapping,
                magFilter: r ? NearestFilter : LinearFilter,
                minFilter: r ? NearestFilter : LinearFilter,
                format: i ? RGBAFormat : RGBFormat,
                type: n ? this.floatType : UnsignedByteType,
                anisotropy: 0,
                encoding: LinearEncoding,
                depthBuffer: !1,
                stencilBuffer: !1
            }) : this.createRenderTarget(e, t, i, r, n)
        }
    }]),
    e
}()
  , fboHelper = new FboHelper
  , cacheFrag = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform float u_sampleCount;varying vec2 v_uv;void main(){gl_FragColor=texture2D(u_texture,vec2(v_uv.x,1.0-v_uv.y))/u_sampleCount;}"
  , ShaderHelper = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "glslifyStrip",
        value: function(e) {
            return e.replace(/#define\sGLSLIFY\s./, "")
        }
    }, {
        key: "addChunk",
        value: function(e, t) {
            ShaderChunk[e] = this.glslifyStrip(t)
        }
    }, {
        key: "_wrapInclude",
        value: function(e) {
            return "#include <" + e + ">"
        }
    }, {
        key: "insertBefore",
        value: function(e, t, i) {
            var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
            return i = this.glslifyStrip(i),
            r && (i = this._wrapInclude(i)),
            e.replace(t, (function(e) {
                return i + "\n" + e
            }
            ))
        }
    }, {
        key: "insertAfter",
        value: function(e, t, i) {
            var r = this
              , n = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
            return i = this.glslifyStrip(i),
            n && (i = this._wrapInclude(i)),
            e.replace(t, (function(e) {
                return e + "\n" + r.glslifyStrip(snippet) + "\n"
            }
            ))
        }
    }, {
        key: "replace",
        value: function(e, t, i) {
            var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
            return i = this.glslifyStrip(i),
            r && (i = this._wrapInclude(i)),
            e.replace(t, "\n" + this.glslifyStrip(snippet) + "\n")
        }
    }]),
    e
}()
  , shaderHelper = new ShaderHelper
  , shader = "#define GLSLIFY 1\nuniform vec2 u_glPositionOffset;vec4 glPositionOffset(vec4 glPosition){return glPosition+vec4(u_glPositionOffset*glPosition.w,0.0,0.0);}"
  , GlPositionOffset = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "offset", new Vector2),
        _defineProperty2(this, "sharedUniforms", {
            u_glPositionOffset: {
                value: null
            }
        })
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this.sharedUniforms.u_glPositionOffset.value = this.offset,
            shaderHelper.addChunk("glPositionOffset", shader)
        }
    }, {
        key: "setOffset",
        value: function(e, t) {
            return this.offset.set(e, t)
        }
    }, {
        key: "applyMaterial",
        value: function(e) {
            e.uniforms.u_glPositionOffset || (e.uniforms.u_glPositionOffset = this.sharedUniforms.u_glPositionOffset,
            e.vertexShader = shaderHelper.insertBefore(e.vertexShader, /void\s+main\s*\(\)/g, "glPositionOffset", !0),
            e.vertexShader = e.vertexShader.substring(0, e.vertexShader.lastIndexOf("}")) + "gl_Position = glPositionOffset(gl_Position);}")
        }
    }]),
    e
}()
  , glPositionOffset = new GlPositionOffset
  , Exporter = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "isExporting", !1),
        _defineProperty2(this, "_width", 2e3),
        _defineProperty2(this, "_height", 2e3),
        _defineProperty2(this, "_sampleCount", 16),
        _defineProperty2(this, "_currSampleCount", 0),
        _defineProperty2(this, "onStarted", new MinSignal),
        _defineProperty2(this, "onUpdated", new MinSignal),
        _defineProperty2(this, "onCompleted", new MinSignal),
        _defineProperty2(this, "_cacheRenderTarget", void 0),
        _defineProperty2(this, "_outRenderTarget", void 0),
        _defineProperty2(this, "_canvas", void 0),
        _defineProperty2(this, "_ctx", void 0),
        _defineProperty2(this, "_imageData", void 0),
        _defineProperty2(this, "_buffer", []),
        _defineProperty2(this, "_cacheMaterial", void 0),
        _defineProperty2(this, "_thumbCanvas", void 0),
        _defineProperty2(this, "_thumbCtx", void 0)
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this._cacheRenderTarget = fboHelper.createRenderTarget(1, 1, !0, !1, !0),
            this._outRenderTarget = fboHelper.createRenderTarget(1, 1, !0),
            this._canvas = document.createElement("canvas"),
            this._ctx = this._canvas.getContext("2d"),
            this._thumbCanvas = document.createElement("canvas"),
            this._thumbCtx = this._thumbCanvas.getContext("2d"),
            this._cacheMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_sampleCount: {
                        value: 1
                    }
                },
                vertexShader: fboHelper.vertexShader,
                fragmentShader: fboHelper.precisionPrefix + cacheFrag,
                depthTest: !1,
                depthWrite: !1,
                blending: CustomBlending,
                blendSrc: OneFactor,
                blendDst: OneFactor,
                blendSrcAlpha: OneFactor,
                blendDstAlpha: OneFactor
            })
        }
    }, {
        key: "start",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 2e3
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 2e3
              , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 420
              , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 420
              , n = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 32;
            if (!this.isExporting) {
                this.isExporting = !0,
                this._currSampleCount = 0,
                this._width = e,
                this._height = t,
                this._cacheRenderTarget.setSize(e, t),
                this._outRenderTarget.setSize(e, t),
                this._sampleCount = n,
                this._cacheMaterial.uniforms.u_sampleCount.value = n,
                this._canvas.width = e,
                this._canvas.height = t,
                this._thumbCanvas.width = i,
                this._thumbCanvas.height = r;
                var a = e * t * 4;
                this._buffer.length !== a && (this._buffer = new Uint8Array(a),
                this._imageData = this._ctx.createImageData(e, t)),
                this.onStarted.dispatch()
            }
        }
    }, {
        key: "cancel",
        value: function() {
            this.isExporting = !1
        }
    }, {
        key: "update",
        value: function() {
            if (this.isExporting) {
                this._currSampleCount++,
                1 == this._currSampleCount && fboHelper.clearColor(0, 0, 0, 0, this._cacheRenderTarget);
                var e = fboHelper.renderer
                  , t = e.autoClear;
                if (e.autoClear = !1,
                glPositionOffset.setOffset((2 * Math.random() - 1) / this._width, (2 * Math.random() - 1) / this._height),
                this._cacheMaterial.uniforms.u_texture.value = properties.postprocessing.fromTexture,
                fboHelper.render(this._cacheMaterial, this._cacheRenderTarget),
                e.autoClear = t,
                this._currSampleCount >= this._sampleCount) {
                    fboHelper.copy(this._cacheRenderTarget.texture, this._outRenderTarget),
                    e.readRenderTargetPixels(this._outRenderTarget, 0, 0, this._canvas.width, this._canvas.height, this._buffer),
                    this._imageData.data.set(this._buffer),
                    this._ctx.putImageData(this._imageData, 0, 0),
                    this.isExporting = !1,
                    glPositionOffset.setOffset(0, 0);
                    var i = Math.max(this._thumbCanvas.width / this._canvas.width, this._thumbCanvas.height / this._canvas.height)
                      , r = (this._thumbCanvas.width - this._canvas.width * i) / 2
                      , n = (this._thumbCanvas.height - this._canvas.height * i) / 2;
                    this._thumbCtx.drawImage(this._canvas, r, n, this._canvas.width * i, this._canvas.height * i),
                    this.onUpdated.dispatch(this._currSampleCount / this._sampleCount),
                    this.onCompleted.dispatch(this._canvas, this._thumbCanvas)
                } else
                    this.onUpdated.dispatch(this._currSampleCount / this._sampleCount)
            }
        }
    }, {
        key: "downloadCanvas",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "png"
              , i = document.createElement("a");
            this._canvas.toBlob((function(r) {
                i.href = URL.createObjectURL(r),
                i.download = e + "." + t,
                i.click()
            }
            ), "image/" + t)
        }
    }]),
    e
}()
  , exporter = new Exporter
  , Input = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "onDowned", new MinSignal),
        _defineProperty2(this, "onMoved", new MinSignal),
        _defineProperty2(this, "onUped", new MinSignal),
        _defineProperty2(this, "onClicked", new MinSignal),
        _defineProperty2(this, "onWheeled", new MinSignal),
        _defineProperty2(this, "wasDown", !1),
        _defineProperty2(this, "isDown", !0),
        _defineProperty2(this, "downTime", 0),
        _defineProperty2(this, "downXY", new Vector2),
        _defineProperty2(this, "downPixelXY", new Vector2),
        _defineProperty2(this, "hasClicked", !1),
        _defineProperty2(this, "mouseXY", new Vector2),
        _defineProperty2(this, "mousePixelXY", new Vector2),
        _defineProperty2(this, "lastWheelTime", 0),
        _defineProperty2(this, "wheelDelta", 0),
        _defineProperty2(this, "wheelDeltaPixel", 0),
        _defineProperty2(this, "downThroughElems", []),
        _defineProperty2(this, "currThroughElems", []),
        _defineProperty2(this, "prevThroughElems", []),
        _defineProperty2(this, "clickThroughElems", [])
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {}
    }, {
        key: "init",
        value: function() {
            var e = document;
            e.addEventListener("mousedown", this._onDown.bind(this)),
            e.addEventListener("touchstart", this._getTouchBound(this, this._onDown, !0)),
            e.addEventListener("mousemove", this._onMove.bind(this)),
            e.addEventListener("mousemove", this._removeHiddenClassCursor.bind(this), {
                once: !0
            }),
            e.addEventListener("touchmove", this._getTouchBound(this, this._onMove, !0)),
            e.addEventListener("mouseup", this._onUp.bind(this)),
            e.addEventListener("touchend", this._getTouchBound(this, this._onUp, !0)),
            e.addEventListener("mousewheel", this._onWheel.bind(this)),
            e.addEventListener("DOMMouseScroll", this._onWheel.bind(this))
        }
    }, {
        key: "_removeHiddenClassCursor",
        value: function() {
            browser.isMobile || mouse.removeHideClass()
        }
    }, {
        key: "_onWheel",
        value: function(e) {
            var t = (e = e || _win.event).wheelDelta;
            t ? t /= 40 : t = -e.detail,
            this.wheelDelta += Math.min(3, Math.max(t, -3)),
            this.onWheeled.dispatch(e.target, this.wheelDelta, e)
        }
    }, {
        key: "_onDown",
        value: function(e) {
            this.isDown = !0,
            this.downTime = performance.now(),
            this.prevThroughElems.length = 0,
            this._setThroughElementsByEvent(e, this.downThroughElems),
            this._getInputXY(e, this.downXY),
            this._getInputPixelXY(e, this.downPixelXY),
            this._onMove(e),
            this.onDowned.dispatch(e)
        }
    }, {
        key: "_onMove",
        value: function(e) {
            this._getInputXY(e, this.mouseXY),
            this._getInputPixelXY(e, this.mousePixelXY),
            this._setThroughElementsByEvent(e, this.currThroughElems),
            this.onMoved.dispatch(e)
        }
    }, {
        key: "_onUp",
        value: function(e) {
            var t = e.clientX - this.downPixelXY.x
              , i = e.clientY - this.downPixelXY.y;
            Math.sqrt(t * t + i * i) < 40 && +new Date - this.downTime < 300 && (this._setThroughElementsByEvent(e, this.clickThroughElems),
            this._getInputXY(e, this.mouseXY),
            this.hasClicked = !0,
            this.onClicked.dispatch(e)),
            this.isDown = !1,
            this.onUped.dispatch(e)
        }
    }, {
        key: "_getTouchBound",
        value: function(e, t, i) {
            return function(r) {
                i && r.usePreventDefault && r.usePreventDefault(),
                t.call(e, r.changedTouches[0] || r.touches[0])
            }
        }
    }, {
        key: "_getInputXY",
        value: function(e, t) {
            return t.set(e.clientX / window.innerWidth * 2 - 1, 1 - e.clientY / window.innerHeight * 2),
            t
        }
    }, {
        key: "_getInputPixelXY",
        value: function(e, t) {
            t.set(e.clientX, e.clientY)
        }
    }, {
        key: "_setThroughElementsByEvent",
        value: function(e, t) {
            var i = e.target;
            for (t.length = 0; i.parentNode; )
                t.push(i),
                i = i.parentNode
        }
    }, {
        key: "hasThroughElem",
        value: function(e, t) {
            for (var i = this[t + "ThroughElems"] || this.currThroughElems, r = i.length; r--; )
                if (i[r] === e)
                    return !0;
            return !1
        }
    }, {
        key: "hasThroughElemWithClass",
        value: function(e, t) {
            for (var i = this[t + "ThroughElems"] || this.currThroughElems, r = i.length; r--; )
                if (i[r].classList.contains(e))
                    return i[r];
            return null
        }
    }, {
        key: "update",
        value: function(e) {
            this.prevThroughElems.length = 0,
            this.prevThroughElems.concat(this.currThroughElems),
            this.wheelDelta = 0,
            this.wasDown = this.isDown,
            exporter.isExporting || (properties.cameraLookX += (this.mouseXY.y * properties.cameraLookStrength - properties.cameraLookX) * properties.cameraLookEaseDamp,
            properties.cameraLookY += (-this.mouseXY.x * properties.cameraLookStrength - properties.cameraLookY) * properties.cameraLookEaseDamp)
        }
    }]),
    e
}()
  , input = new Input;
window.input = input;
for (var AUDIO_DATA = {
    ui: [{
        id: "placeblock_0",
        url: "placeblock_0.wav",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "placeblock_1",
        url: "placeblock_1.wav",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "hover_0",
        url: "hover_0.wav",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "hover_1",
        url: "hover_1.wav",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "build-mode",
        url: "build-mode.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "camera-mode",
        url: "camera-mode.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "delete-all",
        url: "delete-all.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "placeblock-disabled",
        url: "placeblock-disabled.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "snapshot",
        url: "snapshot.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "train-start",
        url: "train-start.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "train-reset",
        url: "train-reset.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "camera-spin_0",
        url: "camera-spin_0.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "camera-spin_1",
        url: "camera-spin_1.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "camera-spin_2",
        url: "camera-spin_2.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }, {
        id: "completed",
        url: "completed.mp3",
        isLoopable: !1,
        isPositional: !1,
        isPreload: !0,
        isElem: !1
    }],
    sfx: [{
        id: "train-moving",
        url: "train-moving.mp3",
        refDistance: .075,
        isLoopable: !0,
        isPositional: !0,
        isPreload: !0
    }, {
        id: "propeller",
        url: "propeller.mp3",
        refDistance: .5,
        isLoopable: !0,
        isPositional: !0,
        isPreload: !0
    }, {
        id: "cricket",
        url: "cricket.mp3",
        isLoopable: !0,
        isPositional: !1,
        isPreload: !1,
        isElem: !0
    }],
    music: [{
        id: "bgm",
        url: "bgm.mp3",
        isLoopable: !0,
        isPositional: !1,
        isPreload: !1,
        isElem: !0
    }]
}, AudioGroup = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "id", ""),
        _defineProperty2(this, "children", []),
        _defineProperty2(this, "volume", 1)
    }
    return _createClass2(e, [{
        key: "init",
        value: function(e) {
            Object.assign(this, e)
        }
    }, {
        key: "update",
        value: function(e) {
            e *= this.volume,
            this.children.forEach((function(t) {
                t.setFinalVolume(e)
            }
            ))
        }
    }, {
        key: "add",
        value: function(e) {
            this.children.includes(e) || this.children.push(e)
        }
    }, {
        key: "remove",
        value: function(e) {
            this.children.includes(e) && this.children.splice(this.children.indexOf(e), 1)
        }
    }, {
        key: "play",
        value: function() {
            this.children.forEach((function(e) {
                return e.play()
            }
            ))
        }
    }, {
        key: "stop",
        value: function() {
            this.children.forEach((function(e) {
                return e.stop()
            }
            ))
        }
    }]),
    e
}(), AudioItem = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "autoplay", !1),
        _defineProperty2(this, "elem", null),
        _defineProperty2(this, "id", ""),
        _defineProperty2(this, "url", ""),
        _defineProperty2(this, "fileSize", 100),
        _defineProperty2(this, "isMutable", !1),
        _defineProperty2(this, "isPositional", !1),
        _defineProperty2(this, "isLoopable", !1),
        _defineProperty2(this, "isPreload", !0),
        _defineProperty2(this, "onInitialized", new MinSignal),
        _defineProperty2(this, "onEnded", new MinSignal),
        _defineProperty2(this, "onPlayed", new MinSignal),
        _defineProperty2(this, "volume", 1),
        _defineProperty2(this, "audioObject", null),
        _defineProperty2(this, "hasInitialized", !1),
        _defineProperty2(this, "container", null),
        _defineProperty2(this, "refDistance", 1),
        _defineProperty2(this, "_buffer", null),
        _defineProperty2(this, "_originalOnEnd", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            Object.assign(this, e),
            this.isPositional && (this.container = new Object3D)
        }
    }, {
        key: "init",
        value: function(e) {
            !0 !== this.hasInitialized && (this.hasInitialized = !0,
            this.audioObject = this.isPositional ? new PositionalAudio(e) : new Audio$1(e),
            this.isPositional && this.container.add(this.audioObject),
            this._originalOnEnd = this.audioObject.onEnded.bind(this.audioObject),
            this.audioObject.onEnded = this.onEnd.bind(this),
            this.isPositional && this.setRefDistance(this.refDistance),
            this.isElem && !this.elem && (this.elem = document.createElement("audio"),
            this.elem.src = this.url),
            this.elem ? (this.elem.loop = this.isLoopable,
            this.audioObject.setMediaElementSource(this.elem),
            this.elem.addEventListener("ended", this.onEnd.bind(this)),
            this.autoplay && this.play()) : (this.audioObject.setLoop(this.isLoopable),
            this._buffer && this.decodeAudioData()),
            this.onInitialized.dispatch(this))
        }
    }, {
        key: "load",
        value: function(e) {
            var t = this;
            if (this.elem)
                this.elem.src = this.url;
            else {
                var i = this.isPreload ? "add" : "load";
                properties.loader[i](this.url, {
                    weight: this.fileSize,
                    type: "xhr",
                    responseType: "arraybuffer",
                    hasLoading: !0,
                    onLoad: function(i) {
                        t._buffer = i,
                        t.hasInitialized && t.decodeAudioData(),
                        e && e()
                    }
                })
            }
        }
    }, {
        key: "setFinalVolume",
        value: function(e) {
            var t;
            null === (t = this.audioObject) || void 0 === t || t.setVolume(e * this.volume)
        }
    }, {
        key: "setPositionObjectParent",
        value: function(e) {
            this.hasInitialized ? e ? e.add(this.audioObject) : this.audioObject.parent && this.audioObject.parent.remove(this.audioObject) : this.positionObjectParent = e
        }
    }, {
        key: "decodeAudioData",
        value: function() {
            var e = this
              , t = this._buffer.slice(0);
            AudioContext.getContext().decodeAudioData(t, (function(t) {
                e.audioObject.setBuffer(t),
                e.autoplay && e.play()
            }
            ))
        }
    }, {
        key: "onEnd",
        value: function() {
            this._originalOnEnd && this._originalOnEnd(),
            this.onEnded.dispatch(this)
        }
    }, {
        key: "play",
        value: function() {
            this.autoplay = !0,
            this.audioObject && !this.audioObject.isPlaying && (this.elem ? (this.elem.play(),
            this.elem.currentTime = .01,
            this.audioObject.isPlaying = !0) : this.audioObject.play(),
            this.onPlayed.dispatch(this))
        }
    }, {
        key: "stop",
        value: function() {
            this.autoplay = !1,
            this.audioObject && this.audioObject.isPlaying && (this.elem ? (this.elem.pause(),
            this.audioObject.isPlaying = !1) : this.audioObject.stop(),
            this.onEnded.dispatch(this))
        }
    }, {
        key: "setRefDistance",
        value: function(e) {
            this.refDistance = e,
            this.isPositional && this.audioObject && this.audioObject.setRefDistance(this.refDistance)
        }
    }]),
    e
}(), SoundAudio = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "groups", {}),
        _defineProperty2(this, "items", {}),
        _defineProperty2(this, "isActive", !0),
        _defineProperty2(this, "volume", 0),
        _defineProperty2(this, "listener", null),
        _defineProperty2(this, "_boundOnBodyClick", null),
        _defineProperty2(this, "_onBodyClicked", new MinSignal),
        _defineProperty2(this, "_rolloverCount", 0),
        _defineProperty2(this, "_placeblockCount", 0),
        _defineProperty2(this, "_cameraSpinCount", 0),
        _defineProperty2(this, "_crackCounter", 0)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this._boundOnBodyClick = function() {
                return e._onBodyClick()
            }
            ,
            input.onDowned.add(this._boundOnBodyClick);
            var t = function(t) {
                if ("music" !== t) {
                    var i = new AudioGroup
                      , r = AUDIO_DATA[t];
                    i.init({
                        id: t
                    }),
                    e.groups[t] = i,
                    r.forEach((function(i) {
                        var r = new AudioItem;
                        i.url = settings.AUDIO_PATH + i.url,
                        r.preInit(i),
                        r.load((function() {}
                        )),
                        e.items[i.id] = r,
                        e.groups[t].add(r)
                    }
                    ))
                }
            };
            for (var i in AUDIO_DATA)
                t(i)
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.getListener((function(t) {
                for (var i in e.items)
                    e.items[i].init(t)
            }
            ))
        }
    }, {
        key: "update",
        value: function(e) {
            if (this.listener)
                for (var t in this.volume = math.saturate(this.volume + (this.isActive ? 1 : -1) * e),
                this.groups)
                    this.groups[t].update(this.volume)
        }
    }, {
        key: "getListener",
        value: function(e) {
            this.listener ? e(this.listener) : this._onBodyClicked.add(e)
        }
    }, {
        key: "_onBodyClick",
        value: function() {
            input.onDowned.remove(this._boundOnBodyClick),
            this.listener = new AudioListener,
            this._onBodyClicked.dispatch(this.listener),
            properties.camera.add(this.listener)
        }
    }, {
        key: "playCrack",
        value: function() {
            this.items["crack_" + Math.round(11 * Math.random())].play(),
            this._crackCounter++
        }
    }, {
        key: "playRollover",
        value: function() {
            this.items["hover_" + this._rolloverCount % 2].play(),
            this._rolloverCount++
        }
    }, {
        key: "playPlaceBlock",
        value: function() {
            this.items["placeblock_" + this._placeblockCount % 2].play(),
            this._placeblockCount++
        }
    }, {
        key: "playCameraSpin",
        value: function() {
            this.items["camera-spin_" + this._cameraSpinCount % 3].play(),
            this._cameraSpinCount++
        }
    }, {
        key: "playSound",
        value: function(e) {
            this.items[e].play()
        }
    }]),
    e
}(), soundAudio = new SoundAudio, CameraSpin = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponentContainer = null,
        this.elBtn = null,
        this.elLayout = null,
        this.degrees = 45,
        this.indexOfthatLittleActiveGreenLight = 0,
        this.littleActiveGreenLightElements = [],
        this.previousIndex = 0,
        this.currentIndex = 0,
        this.numberOfTurn = 0,
        this.elImgContainer = null,
        this.jsonSheet = null,
        this.spriteSheet = null,
        this.spriteAnimation = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("component--cameraSpin"),
            this.elComponentContainer = document.querySelector(".cameraSpin-btn-container"),
            this.elBtn = document.querySelector(".cameraSpin-btn"),
            this.elImgContainer = document.querySelector(".cameraSpin-btn-icon"),
            this.elLayout = document.querySelector(".cameraSpin-btn-layout"),
            properties.loader.add("".concat(settings.IMAGE_PATH, "camera/cameraSpin/cameraSpinAnimation.json"), {
                weight: 2,
                onLoad: function(t) {
                    e.jsonSheet = t
                }
            }),
            this.spriteSheet = properties.loader.add("".concat(settings.IMAGE_PATH, "camera/cameraSpin/cameraSpinAnimation.png"), {
                weight: 104,
                type: "image",
                flipY: !1
            }).content
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elBtn.addEventListener("pointerdown", (function() {
                return e.onBtnClick()
            }
            )),
            this.elBtn.addEventListener("pointerover", (function() {
                soundAudio.playRollover()
            }
            )),
            window.addEventListener("pointerup", (function() {
                return e.onBtnUp()
            }
            )),
            this.spriteAnimation = new SpriteAnimation({
                jsonSheets: this.jsonSheet,
                spriteSheets: this.spriteSheet,
                imgContainer: this.elContainer,
                hover: !0
            }),
            this.spriteAnimation.init()
        }
    }, {
        key: "show",
        value: function() {
            var e = this;
            this.elContainer.classList.add("is-active"),
            this.spriteAnimation.createCanvas(this.elImgContainer),
            this.elContainer.classList.add("animated"),
            setTimeout((function() {
                e.elBtn.style.transitionDelay = "0s"
            }
            ), 2e3)
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "onBtnClick",
        value: function() {
            cameraControls$1.rotateCameraToLeftByDegrees(this.degrees),
            soundAudio.playCameraSpin(),
            this.elComponentContainer.classList.add("pressed")
        }
    }, {
        key: "onBtnUp",
        value: function() {
            this.elComponentContainer.classList.remove("pressed")
        }
    }, {
        key: "disable",
        value: function() {
            this.elBtn.classList.add("disable-cameraSpin-btn")
        }
    }, {
        key: "enable",
        value: function() {
            this.elBtn.classList.remove("disable-cameraSpin-btn")
        }
    }, {
        key: "getIndexFromCameraRotation",
        value: function() {
            var e, t = MathUtils$1.radToDeg(cameraControls$1._orbitControls.getAzimuthalAngle());
            e = t < 0 ? Math.abs(t) : 360 - t;
            var i = Math.round(e / this.degrees);
            return 8 === i ? 0 : i
        }
    }, {
        key: "setActiveGreenLightThingy",
        value: function() {
            this.previousIndex = this.currentIndex,
            this.currentIndex = this.getIndexFromCameraRotation(),
            0 === this.previousIndex && 7 === this.currentIndex && this.numberOfTurn--,
            0 === this.currentIndex && 7 === this.previousIndex && this.numberOfTurn++,
            this.currentIndex !== this.previousIndex && (this.elLayout.style.transform = "rotate(".concat(45 * this.currentIndex + 360 * this.numberOfTurn, "deg)"))
        }
    }, {
        key: "update",
        value: function(e) {
            this.elBtn.classList.contains("hide") || (this.setActiveGreenLightThingy(),
            this.spriteAnimation && this.spriteAnimation.updateSprite(e))
        }
    }]),
    e
}(), cameraSpin = new CameraSpin, CameraMode = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elCamModeFpBtn = null,
        this.elCamModeFollowBtn = null,
        this.elCamButtons = null,
        this.buttonIcon = {
            isAnimating: !1,
            element: null,
            path: null,
            folder: null,
            currentFrame: 0
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--cameraMode"),
            this.elCamModeFpBtn = document.getElementById("cameraMode-fp-btn"),
            this.elCamModeFollowBtn = document.getElementById("cameraMode-follow-btn"),
            this.elCamButtons = document.querySelectorAll(".camera-btn ")
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elCamModeFpBtn.addEventListener("pointerdown", (function() {
                return e.activateCamModeFp()
            }
            )),
            this.elCamModeFollowBtn.addEventListener("pointerdown", (function() {
                return e.activateCamModeFollow()
            }
            )),
            this.elCamButtons.forEach((function(t) {
                t.addEventListener("pointerdown", (function(t) {
                    return e.onElBtnDown(t)
                }
                )),
                t.addEventListener("pointerover", (function(t) {
                    return e.onCamBtnOver(t)
                }
                ))
            }
            )),
            window.addEventListener("pointerup", this.onElBtnUp),
            this.setAnimation()
        }
    }, {
        key: "cameraAnimation",
        value: function() {
            switch (cameraControls$1._cameraMode) {
            case "firstPerson":
                this.activateCamModeFp();
                break;
            case "follow":
                this.activateCamModeFollow();
                break;
            case "overview":
                this.activateCamModeOverview();
                break;
            default:
                console.log("[cameraMode] show() activeMode not found: ", cameraControls$1._cameraMode),
                this.activateCamModeFollow()
            }
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active")
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "animeIn",
        value: function() {
            this.elContainer.classList.add("animated")
        }
    }, {
        key: "animeOut",
        value: function() {
            this.elContainer.classList.remove("animated")
        }
    }, {
        key: "setAnimation",
        value: function() {
            this.elCamButtons.forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(t / 30, "s")
            }
            ))
        }
    }, {
        key: "activateCamModeFp",
        value: function() {
            cameraControls$1._isTransitioning || (properties.isBokehActive = !1,
            this.elCamModeFollowBtn.classList.remove("is-active"),
            this.elCamModeFpBtn.classList.add("is-active"),
            cameraControls$1.firstPersonMode(),
            cameraSpin.disable())
        }
    }, {
        key: "activateCamModeFollow",
        value: function() {
            cameraControls$1._isTransitioning || (properties.isBokehActive = !0,
            this.elCamModeFpBtn.classList.remove("is-active"),
            this.elCamModeFollowBtn.classList.add("is-active"),
            cameraControls$1.followMode(),
            cameraSpin.disable())
        }
    }, {
        key: "activateCamModeOverview",
        value: function() {
            cameraControls$1._isTransitioning || (properties.isBokehActive = !1,
            cameraControls$1.overviewMode(),
            cameraSpin.enable())
        }
    }, {
        key: "onElBtnDown",
        value: function(e) {
            e.target.querySelector(".camera-btn-container").classList.add("pressed")
        }
    }, {
        key: "onElBtnUp",
        value: function() {
            document.querySelectorAll(".camera-btn-container").forEach((function(e) {
                return e.classList.remove("pressed")
            }
            ))
        }
    }, {
        key: "onCamBtnOver",
        value: function(e) {
            var t = e.target.querySelector("img");
            t.classList.remove("wiggle-animation"),
            t.offsetWidth,
            t.classList.add("wiggle-animation")
        }
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "update",
        value: function(e) {
            properties.cameraMotionBlurMultiplier = math.fit(Math.abs(cameraControls$1._lerpRatio - .5), 0, .5, 3, 1, ease.cubicIn)
        }
    }]),
    e
}(), cameraMode = new CameraMode, trackModelPath = "".concat(settings.MODEL_PATH, "tracks/"), trackTexturePath = "".concat(settings.TEXTURE_PATH, "tracks/"), trackImgPath = "".concat(settings.IMAGE_PATH, "tracks/"), trackColorsImgPath = "".concat(settings.IMAGE_PATH, "tracks/colors/"), qualityPath$3 = "".concat(settings.QUALITY_PATH), trackData = {
    defaultTrackOffset: [0, 0, -.2],
    colorPalettes: [{
        type: "colorPalettes",
        childrens: [{
            type: "colorPalette_0",
            colors: ["#ef4a4a", "#6e62ea", "#45d5ef", "#ffd857"],
            btnImg: "".concat(trackColorsImgPath, "color_0.png")
        }, {
            type: "colorPalette_1",
            colors: ["#FF7AC8", "#F4B2F1", "#EF5172", "#7858F4"],
            btnImg: "".concat(trackColorsImgPath, "color_1.png")
        }, {
            type: "colorPalette_2",
            colors: ["#74CFF7", "#00B1D8", "#00FFDF", "#0093FF"],
            btnImg: "".concat(trackColorsImgPath, "color_2.png")
        }, {
            type: "colorPalette_3",
            colors: ["#89653f", "#543c19", "#8e671e", "#f7be79"],
            btnImg: "".concat(trackColorsImgPath, "color_3.png")
        }, {
            type: "colorPalette_4",
            colors: ["#00EA5D", "#20FFC9", "#34F97F", "#026D33"],
            btnImg: "".concat(trackColorsImgPath, "color_4.png")
        }]
    }],
    trackPieces: [{
        type: "straight",
        childrens: [{
            type: "straight_0",
            size: "s",
            code: 0,
            angle: 0,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "STRAIGHT_0.buf"),
                weight: 7
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "STRAIGHT_0_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "straight/straight_0/").concat(qualityPath$3, "straight_0_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 3 : 9 : properties.jpgwebp ? 1 : 4
            }],
            btnImg: "".concat(trackImgPath, "straight/straight-s.png"),
            btnImgDisabled: "".concat(trackImgPath, "straight/straight-s-disabled.png")
        }, {
            type: "straight_1",
            size: "m",
            code: 1,
            angle: 0,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "STRAIGHT_1.buf"),
                weight: 7
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "STRAIGHT_1_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "straight/straight_1/").concat(qualityPath$3, "straight_1_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 5 : 12 : properties.jpgwebp ? 2 : 5
            }],
            btnImg: "".concat(trackImgPath, "straight/straight-m.png"),
            btnImgDisabled: "".concat(trackImgPath, "straight/straight-m-disabled.png")
        }, {
            type: "straight_2",
            size: "l",
            code: 2,
            angle: 0,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "STRAIGHT_2.buf"),
                weight: 7
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "STRAIGHT_2_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "straight/straight_2/").concat(qualityPath$3, "straight_2_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 5 : 11 : properties.jpgwebp ? 3 : 5
            }],
            btnImg: "".concat(trackImgPath, "straight/straight-l.png"),
            btnImgDisabled: "".concat(trackImgPath, "straight/straight-l-disabled.png")
        }],
        btnImg: "".concat(trackImgPath, "straight/straight-folder.png")
    }, {
        type: "left",
        childrens: [{
            type: "left_0",
            size: "s",
            code: 3,
            angle: Math.PI / 2,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "LEFT_0.buf"),
                weight: 17
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "LEFT_0_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "left/left_0/").concat(qualityPath$3, "left_0_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 8 : 17 : properties.jpgwebp ? 4 : 7
            }],
            btnImg: "".concat(trackImgPath, "left/left-s.png"),
            btnImgDisabled: "".concat(trackImgPath, "left/left-s-disabled.png")
        }, {
            type: "left_1",
            size: "m",
            code: 4,
            angle: Math.PI / 2,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "LEFT_1.buf"),
                weight: 24
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "LEFT_1_SPLINE.buf"),
                weight: 2
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "left/left_1/").concat(qualityPath$3, "left_1_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 9 : 16 : properties.jpgwebp ? 4 : 7
            }],
            btnImg: "".concat(trackImgPath, "left/left-m.png"),
            btnImgDisabled: "".concat(trackImgPath, "left/left-m-disabled.png")
        }],
        btnImg: "".concat(trackImgPath, "left/left-folder.png")
    }, {
        type: "right",
        childrens: [{
            type: "right_0",
            size: "s",
            code: 5,
            angle: -Math.PI / 2,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "RIGHT_0.buf"),
                weight: 17
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "RIGHT_0_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "right/right_0/").concat(qualityPath$3, "right_0_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 9 : 16 : properties.jpgwebp ? 4 : 7
            }],
            btnImg: "".concat(trackImgPath, "right/right-s.png"),
            btnImgDisabled: "".concat(trackImgPath, "right/right-s-disabled.png")
        }, {
            type: "right_1",
            size: "m",
            code: 6,
            angle: -Math.PI / 2,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "RIGHT_1.buf"),
                weight: 25
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "RIGHT_1_SPLINE.buf"),
                weight: 2
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "right/right_1/").concat(qualityPath$3, "right_1_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 11 : 19 : properties.jpgwebp ? 5 : 8
            }],
            btnImg: "".concat(trackImgPath, "right/right-m.png"),
            btnImgDisabled: "".concat(trackImgPath, "right/right-m-disabled.png")
        }],
        btnImg: "".concat(trackImgPath, "right/right-folder.png")
    }, {
        type: "special",
        childrens: [{
            type: "special_0",
            code: 7,
            angle: 0,
            heightDelta: 0,
            wiggle: !1,
            levelPermitFn: function(e) {
                return 0 === e
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "TUNNEL.buf"),
                weight: 58
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "TUNNEL_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "diffuse",
                src: "".concat(trackTexturePath, "tunnel/").concat(qualityPath$3, "tunnel_diffuse.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 10 : 20 : properties.jpgwebp ? 5 : 8
            }, {
                type: "shadow",
                src: "".concat(trackTexturePath, "tunnel/").concat(qualityPath$3, "tunnel_shadow.") + properties.jpgwebp,
                weight: (properties.isHiresSetting,
                properties.jpgwebp ? 1 : 4)
            }],
            shadowSize: [.28952702, 1, .4695 * .965],
            shadowOffset: [.0035, 1e-4, .16],
            btnImg: "".concat(trackImgPath, "special/tunnel/tunnel.png"),
            btnImgDisabled: "".concat(trackImgPath, "special/tunnel/tunnel-disabled.png")
        }, {
            type: "special_1",
            code: 11,
            angle: 0,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return 0 === e
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "BARRIAGE.buf"),
                weight: 14
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "BARRIAGE_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "diffuse",
                src: "".concat(trackTexturePath, "barriage/").concat(qualityPath$3, "barriage_diffuse.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 14 : 20 : properties.jpgwebp ? 7 : 8
            }, {
                type: "shadow",
                src: "".concat(trackTexturePath, "barriage/").concat(qualityPath$3, "barriage_shadow.") + properties.jpgwebp,
                weight: (properties.isHiresSetting,
                10)
            }],
            btnImg: "".concat(trackImgPath, "special/passing/passing_00000.png"),
            btnImgDisabled: "".concat(trackImgPath, "special/passing/passing-disabled.png"),
            wiggle: !1
        }, {
            type: "special_2",
            code: 10,
            angle: 0,
            heightDelta: 0,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "ROLL_RIGHT.buf"),
                weight: 14
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "ROLL_RIGHT_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "roll/").concat(qualityPath$3, "roll_right_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 23 : 27 : (properties.jpgwebp,
                9)
            }],
            btnImg: "".concat(trackImgPath, "special/loop/loop_00000.png"),
            btnImgDisabled: "".concat(trackImgPath, "special/loop/loop-disabled.png")
        }],
        btnImg: "".concat(trackImgPath, "special/star/star_00000.png")
    }, {
        type: "upAndDown",
        childrens: [{
            type: "upAndDown_0",
            code: 8,
            angle: 0,
            heightDelta: 1,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "UP.buf"),
                weight: 15
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "UP_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "up/").concat(qualityPath$3, "up_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 10 : 16 : properties.jpgwebp ? 4 : 6
            }],
            btnImg: "".concat(trackImgPath, "upAndDown/up/up.png"),
            btnImgDisabled: "".concat(trackImgPath, "upAndDown/up/up-disabled.png"),
            wiggle: !1
        }, {
            type: "upAndDown_1",
            code: 9,
            angle: 0,
            heightDelta: -1,
            levelPermitFn: function(e) {
                return !0
            },
            models: [{
                type: "track",
                src: "".concat(trackModelPath, "DOWN.buf"),
                weight: 15
            }, {
                type: "spline",
                src: "".concat(trackModelPath, "DOWN_SPLINE.buf"),
                weight: 1
            }],
            textures: [{
                type: "ao",
                src: "".concat(trackTexturePath, "down/").concat(qualityPath$3, "down_ao.") + properties.jpgwebp,
                weight: properties.isHiresSetting ? properties.jpgwebp ? 9 : 15 : properties.jpgwebp ? 4 : 6
            }],
            btnImg: "".concat(trackImgPath, "upAndDown/down/down.png"),
            btnImgDisabled: "".concat(trackImgPath, "upAndDown/down/down-disabled.png"),
            wiggle: !1
        }],
        btnImg: "".concat(trackImgPath, "upAndDown/arrows/arrows.png"),
        wiggle: !1
    }, {
        type: "station",
        code: null,
        angle: 0,
        heightDelta: 0,
        levelPermitFn: function(e) {
            return 0 === e
        },
        models: [{
            type: "track",
            src: "".concat(trackModelPath, "STATION.buf"),
            weight: 44
        }, {
            type: "spline",
            src: "".concat(trackModelPath, "STATION_SPLINE.buf"),
            weight: 1
        }],
        textures: [{
            type: "diffuseDay",
            src: "".concat(trackTexturePath, "station/").concat(qualityPath$3, "station_diffuse_day.") + properties.jpgwebp,
            weight: properties.isHiresSetting ? properties.jpgwebp ? 118 : 193 : properties.jpgwebp ? 54 : 79
        }, {
            type: "diffuseNight",
            src: "".concat(trackTexturePath, "station/").concat(qualityPath$3, "station_diffuse_night.") + properties.jpgwebp,
            weight: properties.isHiresSetting ? properties.jpgwebp ? 102 : 173 : properties.jpgwebp ? 49 : 76
        }, {
            type: "shadow",
            src: "".concat(trackTexturePath, "station/").concat(qualityPath$3, "station_shadow.") + properties.jpgwebp,
            weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 4 : properties.jpgwebp ? 1 : 2
        }],
        shadowSize: [.19072 * .95, 1, .7395 * .95],
        shadowOffset: [.042, 1e-4, .25]
    }]
}, list = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""), map64ToInt = {}, mapIntTo64 = {}, _i307 = 0; _i307 < list.length; _i307++)
    map64ToInt[list[_i307]] = _i307,
    mapIntTo64[_i307] = list[_i307];
function encode(e) {
    for (var t = "", i = 0; i < e.length; i++)
        t += mapIntTo64[e[i]];
    return t
}
function decode(e) {
    for (var t = [], i = 0; i < e.length; i++) {
        var r = map64ToInt[e[i]];
        void 0 !== r && t.push(r)
    }
    return t
}
var UrlManager = function() {
    function e() {
        _classCallCheck2(this, e),
        this.dataParamValue = null,
        this.trackCode = null,
        this.colorPaletteCode = null,
        this.dayCode = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            if (settings.TRACK)
                this._switchToUrlDataParam();
            else if (settings.DATA) {
                var e = _slicedToArray(settings.DATA.split("/"), 3)
                  , t = e[0]
                  , i = e[1]
                  , r = e[2];
                t && i && r ? (this.trackCode = t,
                this.colorPaletteCode = i,
                this.dayCode = r) : this._setDefaultDataParams(t, i, r)
            } else
                this._setDefaultDataParams()
        }
    }, {
        key: "_switchToUrlDataParam",
        value: function() {
            var e = new URL(window.location.href)
              , t = window.location.search
              , i = new URLSearchParams(t).get("TRACK").split("/")[0];
            e.searchParams.delete("TRACK"),
            window.history.replaceState(null, null, decodeURIComponent(e.href)),
            this._setDefaultDataParams(i)
        }
    }, {
        key: "_setDefaultDataParams",
        value: function(e, t, i) {
            this.trackCode = e || settings.DEFAULT_TRACK_CODE,
            this.colorPaletteCode = t || settings.DEFAULT_COLOR_PALETTE_CODE,
            this.dayCode = i || settings.DEFAULT_DAY_CODE,
            this._updateDataParam()
        }
    }, {
        key: "setTrackCodeParam",
        value: function(e) {
            var t = this._getEncodeTrackSequence(e);
            this.trackCode = t,
            this._updateDataParam()
        }
    }, {
        key: "setColorPaletteCode",
        value: function(e) {
            this.colorPaletteCode = e,
            this._updateDataParam()
        }
    }, {
        key: "setDayCode",
        value: function(e) {
            this.dayCode = e,
            this._updateDataParam()
        }
    }, {
        key: "_updateDataParam",
        value: function() {
            var e = new URL(window.location.href);
            e.searchParams.set("DATA", "".concat(this.trackCode, "/").concat(this.colorPaletteCode, "/").concat(this.dayCode)),
            window.history.replaceState(null, null, decodeURIComponent(e.href))
        }
    }, {
        key: "_getEncodeTrackSequence",
        value: function(e) {
            var t = e.map((function(e) {
                return e.config.code
            }
            )).filter((function(e) {
                return null != e
            }
            ));
            return 0 === t.length ? "" : encode(t)
        }
    }, {
        key: "getDecodedTrackData",
        value: function() {
            return decode(this.trackCode).map((function(e) {
                var t, i = trackData.trackPieces.find((function(t) {
                    return t.code === e
                }
                ));
                return i ? t = i.type : trackData.trackPieces.forEach((function(i) {
                    if (i.childrens) {
                        var r = i.childrens.find((function(t) {
                            return t.code === e
                        }
                        ));
                        r && (t = r.type)
                    }
                }
                )),
                t || properties.isInDevMode && console.log("[UrlManager] _decodeTrackData(): Track type not found!"),
                t
            }
            ))
        }
    }, {
        key: "getDataParam",
        value: function() {
            var e = window.location.search
              , t = new URLSearchParams(e)
              , i = t.get("DATA")
              , r = t.get("TRACK");
            return i || r
        }
    }, {
        key: "getUrl",
        value: function() {
            return new URL(window.location.href).toString()
        }
    }]),
    e
}()
  , urlManager = new UrlManager
  , a = {
    c: null,
    u: [new Vector3, new Vector3, new Vector3],
    e: []
}
  , b = {
    c: null,
    u: [new Vector3, new Vector3, new Vector3],
    e: []
}
  , R = [[], [], []]
  , AbsR = [[], [], []]
  , t = []
  , xAxis = new Vector3
  , yAxis = new Vector3
  , zAxis = new Vector3
  , v1 = new Vector3
  , size = new Vector3
  , closestPoint = new Vector3
  , rotationMatrix = new Matrix3
  , aabb = new Box3
  , matrix = new Matrix4
  , inverse = new Matrix4
  , localRay = new Ray
  , OBB = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new Vector3
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Vector3
          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : new Matrix3;
        _classCallCheck2(this, e),
        this.center = t,
        this.halfSize = i,
        this.rotation = r
    }
    return _createClass2(e, [{
        key: "set",
        value: function(e, t, i) {
            return this.center = e,
            this.halfSize = t,
            this.rotation = i,
            this
        }
    }, {
        key: "copy",
        value: function(e) {
            return this.center.copy(e.center),
            this.halfSize.copy(e.halfSize),
            this.rotation.copy(e.rotation),
            this
        }
    }, {
        key: "clone",
        value: function() {
            return (new this.constructor).copy(this)
        }
    }, {
        key: "getSize",
        value: function(e) {
            return e.copy(this.halfSize).multiplyScalar(2)
        }
    }, {
        key: "clampPoint",
        value: function(e, t) {
            var i = this.halfSize;
            v1.subVectors(e, this.center),
            this.rotation.extractBasis(xAxis, yAxis, zAxis),
            t.copy(this.center);
            var r = MathUtils$1.clamp(v1.dot(xAxis), -i.x, i.x);
            t.add(xAxis.multiplyScalar(r));
            var n = MathUtils$1.clamp(v1.dot(yAxis), -i.y, i.y);
            t.add(yAxis.multiplyScalar(n));
            var a = MathUtils$1.clamp(v1.dot(zAxis), -i.z, i.z);
            return t.add(zAxis.multiplyScalar(a)),
            t
        }
    }, {
        key: "containsPoint",
        value: function(e) {
            return v1.subVectors(e, this.center),
            this.rotation.extractBasis(xAxis, yAxis, zAxis),
            Math.abs(v1.dot(xAxis)) <= this.halfSize.x && Math.abs(v1.dot(yAxis)) <= this.halfSize.y && Math.abs(v1.dot(zAxis)) <= this.halfSize.z
        }
    }, {
        key: "intersectsBox3",
        value: function(e) {
            return this.intersectsOBB(obb.fromBox3(e))
        }
    }, {
        key: "intersectsSphere",
        value: function(e) {
            return this.clampPoint(e.center, closestPoint),
            closestPoint.distanceToSquared(e.center) <= e.radius * e.radius
        }
    }, {
        key: "intersectsOBB",
        value: function(e) {
            var i, r, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : Number.EPSILON;
            a.c = this.center,
            a.e[0] = this.halfSize.x,
            a.e[1] = this.halfSize.y,
            a.e[2] = this.halfSize.z,
            this.rotation.extractBasis(a.u[0], a.u[1], a.u[2]),
            b.c = e.center,
            b.e[0] = e.halfSize.x,
            b.e[1] = e.halfSize.y,
            b.e[2] = e.halfSize.z,
            e.rotation.extractBasis(b.u[0], b.u[1], b.u[2]);
            for (var o = 0; o < 3; o++)
                for (var s = 0; s < 3; s++)
                    R[o][s] = a.u[o].dot(b.u[s]);
            v1.subVectors(b.c, a.c),
            t[0] = v1.dot(a.u[0]),
            t[1] = v1.dot(a.u[1]),
            t[2] = v1.dot(a.u[2]);
            for (var l = 0; l < 3; l++)
                for (var h = 0; h < 3; h++)
                    AbsR[l][h] = Math.abs(R[l][h]) + n;
            for (var c = 0; c < 3; c++)
                if (i = a.e[c],
                r = b.e[0] * AbsR[c][0] + b.e[1] * AbsR[c][1] + b.e[2] * AbsR[c][2],
                Math.abs(t[c]) > i + r)
                    return !1;
            for (var p = 0; p < 3; p++)
                if (i = a.e[0] * AbsR[0][p] + a.e[1] * AbsR[1][p] + a.e[2] * AbsR[2][p],
                r = b.e[p],
                Math.abs(t[0] * R[0][p] + t[1] * R[1][p] + t[2] * R[2][p]) > i + r)
                    return !1;
            return i = a.e[1] * AbsR[2][0] + a.e[2] * AbsR[1][0],
            r = b.e[1] * AbsR[0][2] + b.e[2] * AbsR[0][1],
            !(Math.abs(t[2] * R[1][0] - t[1] * R[2][0]) > i + r || (i = a.e[1] * AbsR[2][1] + a.e[2] * AbsR[1][1],
            r = b.e[0] * AbsR[0][2] + b.e[2] * AbsR[0][0],
            Math.abs(t[2] * R[1][1] - t[1] * R[2][1]) > i + r || (i = a.e[1] * AbsR[2][2] + a.e[2] * AbsR[1][2],
            r = b.e[0] * AbsR[0][1] + b.e[1] * AbsR[0][0],
            Math.abs(t[2] * R[1][2] - t[1] * R[2][2]) > i + r || (i = a.e[0] * AbsR[2][0] + a.e[2] * AbsR[0][0],
            r = b.e[1] * AbsR[1][2] + b.e[2] * AbsR[1][1],
            Math.abs(t[0] * R[2][0] - t[2] * R[0][0]) > i + r || (i = a.e[0] * AbsR[2][1] + a.e[2] * AbsR[0][1],
            r = b.e[0] * AbsR[1][2] + b.e[2] * AbsR[1][0],
            Math.abs(t[0] * R[2][1] - t[2] * R[0][1]) > i + r || (i = a.e[0] * AbsR[2][2] + a.e[2] * AbsR[0][2],
            r = b.e[0] * AbsR[1][1] + b.e[1] * AbsR[1][0],
            Math.abs(t[0] * R[2][2] - t[2] * R[0][2]) > i + r || (i = a.e[0] * AbsR[1][0] + a.e[1] * AbsR[0][0],
            r = b.e[1] * AbsR[2][2] + b.e[2] * AbsR[2][1],
            Math.abs(t[1] * R[0][0] - t[0] * R[1][0]) > i + r || (i = a.e[0] * AbsR[1][1] + a.e[1] * AbsR[0][1],
            r = b.e[0] * AbsR[2][2] + b.e[2] * AbsR[2][0],
            Math.abs(t[1] * R[0][1] - t[0] * R[1][1]) > i + r || (i = a.e[0] * AbsR[1][2] + a.e[1] * AbsR[0][2],
            r = b.e[0] * AbsR[2][1] + b.e[1] * AbsR[2][0],
            Math.abs(t[1] * R[0][2] - t[0] * R[1][2]) > i + r)))))))))
        }
    }, {
        key: "intersectsPlane",
        value: function(e) {
            this.rotation.extractBasis(xAxis, yAxis, zAxis);
            var t = this.halfSize.x * Math.abs(e.normal.dot(xAxis)) + this.halfSize.y * Math.abs(e.normal.dot(yAxis)) + this.halfSize.z * Math.abs(e.normal.dot(zAxis))
              , i = e.normal.dot(this.center) - e.constant;
            return Math.abs(i) <= t
        }
    }, {
        key: "intersectRay",
        value: function(e, t) {
            return this.getSize(size),
            aabb.setFromCenterAndSize(v1.set(0, 0, 0), size),
            matrix.setFromMatrix3(this.rotation),
            matrix.setPosition(this.center),
            inverse.copy(matrix).invert(),
            localRay.copy(e).applyMatrix4(inverse),
            localRay.intersectBox(aabb, t) ? t.applyMatrix4(matrix) : null
        }
    }, {
        key: "intersectsRay",
        value: function(e) {
            return null !== this.intersectRay(e, v1)
        }
    }, {
        key: "fromBox3",
        value: function(e) {
            return e.getCenter(this.center),
            e.getSize(this.halfSize).multiplyScalar(.5),
            this.rotation.identity(),
            this
        }
    }, {
        key: "equals",
        value: function(e) {
            return e.center.equals(this.center) && e.halfSize.equals(this.halfSize) && e.rotation.equals(this.rotation)
        }
    }, {
        key: "applyMatrix4",
        value: function(e) {
            var t = e.elements
              , i = v1.set(t[0], t[1], t[2]).length()
              , r = v1.set(t[4], t[5], t[6]).length()
              , n = v1.set(t[8], t[9], t[10]).length();
            e.determinant() < 0 && (i = -i),
            rotationMatrix.setFromMatrix4(e);
            var a = 1 / i
              , o = 1 / r
              , s = 1 / n;
            return rotationMatrix.elements[0] *= a,
            rotationMatrix.elements[1] *= a,
            rotationMatrix.elements[2] *= a,
            rotationMatrix.elements[3] *= o,
            rotationMatrix.elements[4] *= o,
            rotationMatrix.elements[5] *= o,
            rotationMatrix.elements[6] *= s,
            rotationMatrix.elements[7] *= s,
            rotationMatrix.elements[8] *= s,
            this.rotation.multiply(rotationMatrix),
            this.halfSize.x *= i,
            this.halfSize.y *= r,
            this.halfSize.z *= n,
            v1.setFromMatrixPosition(e),
            this.center.add(v1),
            this
        }
    }]),
    e
}()
  , obb = new OBB
  , animalsModelPath = "".concat(settings.MODEL_PATH, "animals/")
  , animalsTexturePath = "".concat(settings.TEXTURE_PATH, "animals/")
  , animalsSpriteSheetPath = "".concat(settings.TEXTURE_PATH, "animals/spriteSheets/")
  , qualityPath$2 = "".concat(settings.QUALITY_PATH, "/")
  , animalsData = [{
    name: "chicken",
    model: "".concat(animalsModelPath, "chicken.glb"),
    modelWeight: 32,
    textureWeight: 2,
    shadowTexture: "".concat(animalsTexturePath, "shadow_diffuse.png"),
    spriteSheetDay: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "surprised.png"),
        textureSize: new Vector2(832,64),
        spriteSize: new Vector2(64,64),
        frameCount: 12,
        fps: 10,
        tilesHorizontal: 12,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        3)
    },
    spriteSheetNight: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "sleeping.png"),
        textureSize: new Vector2(2304,128),
        spriteSize: new Vector2(128,128),
        frameCount: 18,
        fps: 10,
        tilesHorizontal: 18,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        7)
    },
    diffuseTextureDay: "".concat(animalsTexturePath, "chicken/chicken_diffuse_day.png"),
    diffuseTextureNight: "".concat(animalsTexturePath, "chicken/chicken_diffuse_night.png")
}, {
    name: "duck",
    model: "".concat(animalsModelPath, "duck.glb"),
    modelWeight: 32,
    textureWeight: 2,
    shadowTexture: "".concat(animalsTexturePath, "shadow_diffuse.png"),
    spriteSheetDay: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "surprised.png"),
        textureSize: new Vector2(832,64),
        spriteSize: new Vector2(64,64),
        frameCount: 12,
        fps: 10,
        tilesHorizontal: 12,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        3)
    },
    spriteSheetNight: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "sleeping.png"),
        textureSize: new Vector2(2304,128),
        spriteSize: new Vector2(128,128),
        frameCount: 18,
        fps: 10,
        tilesHorizontal: 18,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        7)
    },
    diffuseTextureDay: "".concat(animalsTexturePath, "duck/duck_diffuse_day.png"),
    diffuseTextureNight: "".concat(animalsTexturePath, "duck/duck_diffuse_night.png")
}, {
    name: "rooster",
    model: "".concat(animalsModelPath, "rooster.glb"),
    modelWeight: 35,
    textureWeight: 2,
    shadowTexture: "".concat(animalsTexturePath, "shadow_diffuse.png"),
    spriteSheetDay: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "surprised.png"),
        textureSize: new Vector2(832,64),
        spriteSize: new Vector2(64,64),
        frameCount: 12,
        fps: 10,
        tilesHorizontal: 12,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        3)
    },
    spriteSheetNight: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "sleeping.png"),
        textureSize: new Vector2(2304,128),
        spriteSize: new Vector2(128,128),
        frameCount: 18,
        fps: 10,
        tilesHorizontal: 18,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        7)
    },
    diffuseTextureDay: "".concat(animalsTexturePath, "rooster/rooster_diffuse_day.png"),
    diffuseTextureNight: "".concat(animalsTexturePath, "rooster/rooster_diffuse_night.png")
}, {
    name: "sheep",
    model: "".concat(animalsModelPath, "sheep.glb"),
    modelWeight: 39,
    textureWeight: 2,
    shadowTexture: "".concat(animalsTexturePath, "shadow_diffuse.png"),
    spriteSheetDay: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "beeeh.png"),
        textureSize: new Vector2(2048,108),
        spriteSize: new Vector2(108,108),
        frameCount: 18,
        fps: 10,
        tilesHorizontal: 18,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        22)
    },
    spriteSheetNight: {
        texture: "".concat(animalsSpriteSheetPath).concat(qualityPath$2, "sleeping.png"),
        textureSize: new Vector2(2304,128),
        spriteSize: new Vector2(128,128),
        frameCount: 18,
        fps: 10,
        tilesHorizontal: 18,
        tilesVertical: 1,
        weight: (properties.isHiresSetting,
        7)
    },
    diffuseTextureDay: "".concat(animalsTexturePath, "sheep/sheep_white_diffuse_day.png"),
    diffuseTextureNight: "".concat(animalsTexturePath, "sheep/sheep_white_diffuse_night.png"),
    diffuseTextureSheepDayBlack: "".concat(animalsTexturePath, "sheep/sheep_black_diffuse_day.png"),
    diffuseTextureSheepNightBlack: "".concat(animalsTexturePath, "sheep/sheep_black_diffuse_night.png")
}]
  , getBlueNoiseShader = "#define GLSLIFY 1\nuniform sampler2D u_blueNoiseTexture;uniform vec2 u_blueNoiseTexelSize;uniform vec2 u_blueNoiseCoordOffset;vec3 getBlueNoise(vec2 coord){return texture2D(u_blueNoiseTexture,coord*u_blueNoiseTexelSize+u_blueNoiseCoordOffset).rgb;}vec3 getStaticBlueNoise(vec2 coord){return texture2D(u_blueNoiseTexture,coord*u_blueNoiseTexelSize).rgb;}"
  , BlueNoise = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "sharedUniforms", {
            u_blueNoiseTexture: {
                value: null
            },
            u_blueNoiseTexelSize: {
                value: null
            },
            u_blueNoiseCoordOffset: {
                value: new Vector2
            }
        }),
        _defineProperty2(this, "TEXTURE_SIZE", 128)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = new Texture(properties.loader.add(settings.TEXTURE_PATH + "LDR_RGB1_0.png", {
                weight: 55,
                onLoad: function() {
                    e.needsUpdate = !0
                }
            }).content);
            e.generateMipmaps = !1,
            e.minFilter = e.magFilter = NearestFilter,
            e.wrapS = e.wrapT = RepeatWrapping,
            this.sharedUniforms.u_blueNoiseTexture.value = e,
            this.sharedUniforms.u_blueNoiseTexelSize.value = new Vector2(1 / this.TEXTURE_SIZE,1 / this.TEXTURE_SIZE),
            shaderHelper.addChunk("getBlueNoise", getBlueNoiseShader)
        }
    }, {
        key: "update",
        value: function(e) {
            this.sharedUniforms.u_blueNoiseCoordOffset.value.set(Math.random(), Math.random())
        }
    }]),
    e
}()
  , blueNoise = new BlueNoise
  , vert$2 = "#define GLSLIFY 1\nvarying vec2 v_uv;void main(){v_uv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"
  , frag$3 = "#define GLSLIFY 1\nuniform sampler2D u_spriteSheet;uniform vec2 u_spriteSheetSize;uniform vec2 u_spriteSize;uniform float u_index;uniform float u_alpha;varying vec2 v_uv;void main(){float w=u_spriteSheetSize.x;float h=u_spriteSheetSize.y;float dx=u_spriteSize.x/w;float dy=u_spriteSize.y/h;float cols=w/u_spriteSize.x;float col=mod(u_index,cols);float row=floor(u_index/cols);vec2 uv=vec2(dx*v_uv.x+col*dx,1.0-dy-row*dy+dy*v_uv.y);vec4 spriteSheetColor=texture2D(u_spriteSheet,uv).rgba;gl_FragColor=vec4(spriteSheetColor.rgb*2.0,spriteSheetColor.a*u_alpha);}"
  , SpriteSheetMaterial = function(e) {
    _inherits(i, ShaderMaterial);
    var t = _createSuper(i);
    function i(e) {
        _classCallCheck2(this, i);
        var r = (e = Object.assign({
            data: null
        }, e)).data.texture;
        return r.wrapS = r.wrapT = RepeatWrapping,
        r.repeat.set(1 / e.data.tilesHorizontal, 1 / e.data.tilesVertical),
        t.call(this, {
            uniforms: {
                u_alpha: {
                    value: 1
                },
                u_spriteSheet: {
                    value: r
                },
                u_spriteSheetSize: {
                    value: e.data.textureSize
                },
                u_spriteSize: {
                    value: e.data.spriteSize
                },
                u_index: {
                    value: 1
                }
            },
            vertexShader: vert$2,
            fragmentShader: frag$3,
            transparent: !0,
            depthWrite: !1
        })
    }
    return _createClass2(i)
}()
  , axis = new Vector3
  , up = new Vector3(0,0,1);
function getWalkingPathAndArea(e) {
    var t = {
        position: {
            x: e.position.x * properties.gltfModelScale,
            y: e.position.z * properties.gltfModelScale,
            z: -e.position.y * properties.gltfModelScale
        },
        size: .126
    }
      , i = t.size / 2
      , r = [{
        x: t.position.x - i,
        y: 0,
        z: t.position.z - i
    }, {
        x: t.position.x + i,
        y: 0,
        z: t.position.z - i
    }, {
        x: t.position.x + i,
        y: 0,
        z: t.position.z + i
    }, {
        x: t.position.x - i,
        y: 0,
        z: t.position.z + i
    }, {
        x: t.position.x - .75 * i,
        y: 0,
        z: t.position.z - .75 * i
    }, {
        x: t.position.x + .75 * i,
        y: 0,
        z: t.position.z - .75 * i
    }, {
        x: t.position.x - .75 * i,
        y: 0,
        z: t.position.z + .75 * i
    }, {
        x: t.position.x + .75 * i,
        y: 0,
        z: t.position.z + .75 * i
    }]
      , n = new CatmullRomCurve3(misc.getPathVectors(r),!0);
    n.centerPoint = (new Vector3).copy(t.position);
    var a = new BoxGeometry(t.size,.05,t.size);
    a.computeBoundingSphere();
    var o = new MeshBasicMaterial({
        color: 16777215 * Math.random(),
        fog: !1
    })
      , s = new Mesh(a,o);
    return s.name = "walkingAreaMesh",
    s.position.set(t.position.x, 0, t.position.z),
    s.boundingSphere = s.geometry.boundingSphere,
    s.visible = !1,
    settings.ANIMALS_DEV_MODE && (s.visible = !0),
    s.matrixAutoUpdate = !1,
    s.updateMatrix(),
    {
        walkingPath: n,
        walkingAreaMesh: s
    }
}
function updateWalking(e, t) {
    var i = t.userData.walkingPath.getPoint(t.userData.counter);
    t.position.set(i.x, 0, i.z);
    var r = t.userData.walkingPath.getTangent(t.userData.counter).normalize();
    axis.crossVectors(up, r).normalize();
    var n = Math.acos(up.dot(r));
    t.quaternion.setFromAxisAngle(axis, n),
    "walk" === t.userData.selectedAction && (t.userData.counter += e * t.userData.walkingSpeed),
    t.userData.counter > 1 && (t.userData.counter = 0)
}
function setSpeechBubble(e, t, i) {
    var r = new SpriteSheetMaterial({
        data: t
    })
      , n = new PlaneGeometry(2,2)
      , a = new Mesh(n,r);
    a.position.y = 3,
    a.userData.frameIndex = 0,
    a.userData.fps = t.fps,
    a.userData.frameCount = t.frameCount,
    a.renderOrder = 1,
    a.matrixAutoUpdate = !1,
    a.updateMatrix(),
    "day" === i ? e.userData.speechBubbleDay = a : e.userData.speechBubbleNight = a,
    e.add(a)
}
function showSpeechbubble(e, t) {
    t.material.uniforms.u_alpha.value = math.clamp(t.material.uniforms.u_alpha.value + 3 * e, 0, 1),
    updateSpeechBubble(e, t)
}
function hideSpeechbubble(e, t) {
    0 !== t.material.uniforms.u_alpha.value && (t.material.uniforms.u_alpha.value = math.clamp(t.material.uniforms.u_alpha.value - 6 * e, 0, 1),
    updateSpeechBubble(e, t))
}
function updateSpeechBubble(e, t) {
    var i = t.userData.frameCount
      , r = t.userData.fps;
    t.userData.frameIndex = (t.userData.frameIndex + e * r) % i,
    t.material.uniforms.u_index.value = Math.floor(t.userData.frameIndex),
    t.lookAt(cameraControls._camera.position),
    t.updateMatrix()
}
var vert$1 = "#define GLSLIFY 1\nvarying vec2 v_uv;varying vec3 v_worldNormal;varying vec3 v_worldPosition;varying vec3 v_viewNormal;varying vec3 v_viewPosition;varying vec3 v_position;\n#ifdef IS_LIFT_BLOCK\nattribute float a_offsetY;\n#endif\nvec3 inverseTransformDirection(in vec3 dir,in mat4 matrix){return normalize((vec4(dir,0.0)*matrix).xyz);}\n#ifdef RECEIVE_SHADOW\n#include <shadowmap_pars_vertex>\n#endif\n#ifdef NEEDS_BOUNCE\nuniform float u_time;uniform float u_bounceMaxY;\n#endif\n#ifdef NEEDS_PREVIEW\nuniform float u_previewRatio;\n#endif\n#include <skinning_pars_vertex>\nvoid main(){vec3 transformed=position;\n#ifdef NEEDS_BOUNCE\nfloat yRatio=position.y/u_bounceMaxY;float bounceCycle=cos(u_time*10.0);float bounceCycle2=cos(u_time*5.0);transformed.y*=mix(1.0,bounceCycle*0.05+0.95,yRatio);transformed.xz*=mix(1.0,1.1-bounceCycle*0.2,(1.0-yRatio)*smoothstep(0.0,0.1,yRatio));transformed.x+=bounceCycle2*0.1*yRatio*yRatio;\n#endif\nvec3 objectNormal=normal;\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <skinning_vertex>\n#ifdef IS_LIFT_BLOCK\ntransformed.y+=a_offsetY;\n#endif\n#ifdef NEEDS_PREVIEW\ntransformed.y+=u_previewRatio*0.0001;\n#endif\nvec3 transformedNormal=objectNormal;\n#ifdef USE_INSTANCING\nmat3 m=mat3(instanceMatrix);transformedNormal/=vec3(dot(m[0],m[0]),dot(m[1],m[1]),dot(m[2],m[2]));transformedNormal=m*transformedNormal;\n#endif\nvec3 viewNormal=normalMatrix*transformedNormal;vec4 mvPosition=vec4(transformed,1.0);\n#ifdef USE_INSTANCING\nmvPosition=instanceMatrix*mvPosition;\n#endif\nmvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;vec4 worldPosition=modelMatrix*vec4(transformed,1.0);v_uv=uv;v_worldNormal=inverseTransformDirection(viewNormal,viewMatrix);v_worldPosition=worldPosition.xyz;v_viewNormal=viewNormal;v_viewPosition=mvPosition.xyz;v_position=transformed;\n#ifdef RECEIVE_SHADOW\n#include <shadowmap_vertex>\n#endif\n}"
  , frag$2 = "#define GLSLIFY 1\nuniform vec3 u_color;uniform float u_opacity;uniform float u_time;uniform sampler2D u_envTextureDay;uniform sampler2D u_envTextureNight;\n#ifdef HAS_TEXTURE\nuniform sampler2D u_texture;\n#endif\n#ifdef HAS_AO_TEXTURE\nuniform sampler2D u_aoTexture;\n#endif\n#ifdef IS_GROUND\nuniform sampler2D u_patternTexture;vec4 hash43(vec3 p){vec4 p4=fract(vec4(p.xyzx)*vec4(.1031,.1030,.0973,.1099));p4+=dot(p4,p4.wzxy+33.33);return fract((p4.xxyz+p4.yzzw)*p4.zywx);}\n#endif\n#ifdef HAS_ALPHA_TEXTURE\nuniform sampler2D u_alphaTexture;float alphaMaskValue;\n#endif\nuniform float u_previewRatio;\n#ifdef NEEDS_PREVIEW\nuniform vec3 u_previewColor;\n#endif\nuniform float u_nigthModeActiveRatio;\n#ifdef HAS_NIGHT_EFFECT\nuniform vec3 u_nightEffectColor;\n#ifdef HAS_NIGHT_EFFECT_TEXTURE\nuniform sampler2D u_nightEffectTexture;\n#endif\n#endif\n#ifdef HAS_WATER_EFFECT\nuniform float u_waterTime;uniform float u_waterSpeed;uniform vec3 u_waterEffectColor;\n#endif\n#ifdef HAS_OUT_OF_BOUND_EFFECT\nuniform float u_halfTrackAreaSize;uniform float u_isOutBoundEffectActive;\n#endif\n#ifdef HAS_GROUND_SHADOW\nuniform sampler2D u_groundShadowTexture;uniform vec2 u_groundShadowWorldToUvScale;\n#endif\n#ifdef RECEIVE_SHADOW\n#include <packing>\nbool receiveShadow=true;\n#include <shadowmap_pars_fragment>\n#include <getBlueNoise>\nfloat getShadowMask(){float shadow=1.0;\n#ifdef USE_SHADOWMAP\n#if NUM_DIR_LIGHT_SHADOWS > 0\nDirectionalLightShadow directionalLightShadow;\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_DIR_LIGHT_SHADOWS;i++){directionalLightShadow=directionalLightShadows[i];vec3 noises=getBlueNoise(gl_FragCoord.xy);shadow=getShadow(directionalShadowMap[i],directionalLightShadow.shadowMapSize,directionalLightShadow.shadowBias+noises.z*0.001,directionalLightShadow.shadowRadius,vDirectionalShadowCoord[i]+vec4((noises.xy-0.5)/directionalLightShadow.shadowMapSize,0.0,0.0));}\n#pragma unroll_loop_end\n#endif\n#endif\nreturn shadow;}\n#endif\n#ifdef IS_LIGHTBEAM\nvec3 permute(vec3 x){return mod(((x*34.0)+1.0)*x,289.0);}float snoise(vec2 v){const vec4 C=vec4(0.211324865405187,0.366025403784439,-0.577350269189626,0.024390243902439);vec2 i=floor(v+dot(v,C.yy));vec2 x0=v-i+dot(i,C.xx);vec2 i1;i1=(x0.x>x0.y)? vec2(1.0,0.0): vec2(0.0,1.0);vec4 x12=x0.xyxy+C.xxzz;x12.xy-=i1;i=mod(i,289.0);vec3 p=permute(permute(i.y+vec3(0.0,i1.y,1.0))+i.x+vec3(0.0,i1.x,1.0));vec3 m=max(0.5-vec3(dot(x0,x0),dot(x12.xy,x12.xy),dot(x12.zw,x12.zw)),0.0);m=m*m;m=m*m;vec3 x=2.0*fract(p*C.www)-1.0;vec3 h=abs(x)-0.5;vec3 ox=floor(x+0.5);vec3 a0=x-ox;m*=1.79284291400159-0.85373472095314*(a0*a0+h*h);vec3 g;g.x=a0.x*x0.x+h.x*x0.y;g.yz=a0.yz*x12.xz+h.yz*x12.yw;return 130.0*dot(m,g);}uniform vec3 u_lightbeamColor;uniform float u_lightbeamScale;uniform float u_lightbeamStrength;uniform float u_lightbeamDirection;\n#endif\nuniform mat3 normalMatrix;uniform vec4 u_cameraQuaternionInverse;varying vec2 v_uv;varying vec3 v_rootPosition;varying vec3 v_worldNormal;varying vec3 v_worldPosition;varying vec3 v_viewNormal;varying vec3 v_viewPosition;varying vec3 v_position;\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\nvec3 inverseTransformDirection(in vec3 dir,in mat4 matrix){return normalize((vec4(dir,0.0)*matrix).xyz);}vec2 equirectUv(in vec3 dir){float u=atan(dir.z,dir.x)*RECIPROCAL_PI2+0.5;float v=asin(clamp(dir.y,-1.0,1.0))*RECIPROCAL_PI+0.5;return vec2(u,v);}vec3 qrotate(vec4 q,vec3 v){return v+2.0*cross(q.xyz,cross(q.xyz,v)+q.w*v);}vec3 colorBurn(vec3 base,vec3 blend){return 1.0-min(vec3(1.0),max(vec3(0.0),1.0-base)/max(vec3(0.0001),blend));}void main(){float alpha=u_opacity;\n#ifdef HAS_TEXTURE\nvec4 diffuse4=texture2D(u_texture,v_uv);vec3 diffuse4SRGB=pow(diffuse4.rgb,vec3(2.2));vec3 diffuse=diffuse4SRGB;alpha*=diffuse4.a;\n#ifdef HAS_NIGHT_EFFECT_TEXTURE\nvec4 diffuse4Night=texture2D(u_nightEffectTexture,v_uv);vec3 diffuse4NightSRGB=pow(diffuse4Night.rgb,vec3(2.2));diffuse=mix(diffuse4SRGB,diffuse4NightSRGB,u_nigthModeActiveRatio);alpha*=diffuse4Night.a;\n#endif\n#else\nvec3 diffuse=u_color;\n#endif\n#ifdef NEEDS_PREVIEW\ndiffuse=mix(diffuse,u_previewColor,u_previewRatio);alpha*=1.0-((cos(u_time*5.0)+1.0)*0.2+0.2)*u_previewRatio;\n#endif\nvec3 color=diffuse;float ao=1.0;\n#ifdef HAS_AO_TEXTURE\nao*=texture2D(u_aoTexture,v_uv).g;\n#endif\n#ifdef RECEIVE_SHADOW\nao*=mix(1.0,(0.65+getShadowMask()*0.35),v_worldNormal.y*0.5+0.5);\n#endif\n#if defined(HAS_AO_TEXTURE) ||defined(RECEIVE_SHADOW)\nvec3 colorB=colorBurn(color,vec3(ao));color=mix(color*ao,colorB,0.5);color*=vec3(smoothstep(-2.0,-0.0,v_worldNormal.y));\n#endif\n#ifdef HAS_ALPHA_TEXTURE\nalpha-=texture2D(u_alphaTexture,v_uv).r;\n#endif\n#ifdef IS_GROUND\nvec2 patternUv=v_uv*96.0;vec3 patterns=texture2D(u_patternTexture,patternUv).rgb;patterns.r*=smoothstep(5.0,1.0,length(cameraPosition-v_worldPosition))*smoothstep(0.0,0.1,diffuse.g);vec3 noiseUvw=vec3(floor(patterns.g*255.0),floor(patternUv));noiseUvw.y-=step(patterns.b,0.75);noiseUvw.z-=step(0.25,abs(patterns.b-0.5));vec4 patternRands=hash43(noiseUvw);\n#endif\nfloat faceDirection=gl_FrontFacing ? 1.0 :-1.0;vec3 worldNormal=v_worldNormal*faceDirection;\n#ifdef IS_GROUND\nworldNormal=normalize(v_worldPosition+vec3(0.0,8.0,0.0)+patterns.r*(patternRands.xyz-0.5)*7.0);vec3 viewNormal=normalize(qrotate(u_cameraQuaternionInverse,worldNormal));\n#else\nvec3 viewNormal=normalize(v_viewNormal);\n#endif\nvec3 viewDir=normalize(v_viewPosition);vec3 viewReflectDir=reflect(viewDir,viewNormal);vec3 worldReflectDir=inverseTransformDirection(viewReflectDir,viewMatrix);vec3 envDay=pow(texture2D(u_envTextureDay,equirectUv(worldReflectDir)).rgb,vec3(2.2));vec3 envNight=pow(texture2D(u_envTextureNight,equirectUv(worldReflectDir)).rgb,vec3(2.2));vec3 env=mix(envDay,envNight,u_nigthModeActiveRatio);color*=smoothstep(-8.0,1.0,viewReflectDir.z);\n#ifdef HAS_WATER_EFFECT\ncolor=color*0.75+env*color*color;\n#endif\n#ifdef IS_GROUND\ncolor=mix(color,mix(vec3(0.024,0.702,0.318),vec3(0.008,0.933,0.416),patterns.r*patternRands.w),patterns.r*(0.25+patternRands.x*0.5));color+=max((pow(1.0-color,vec3(2.0))*smoothstep(0.5,-1.0,viewNormal.z)),patterns.r*patternRands.z*patternRands.z*0.2)*env*patterns.r*patternRands.y;\n#else\ncolor+=smoothstep(0.5,-1.0,viewNormal.z)*env;\n#endif\n#ifdef HAS_GROUND_SHADOW\nvec2 groundShadowUv=(v_worldPosition.xz*u_groundShadowWorldToUvScale)+0.5;float groundShadow=texture2D(u_groundShadowTexture,vec2(groundShadowUv.x,1.0-groundShadowUv.y)).r;vec3 shadowColor=vec3(0.369,0.565,0.396);color*=mix(shadowColor,vec3(1.0),groundShadow);\n#endif\ncolor*=mix(vec3(0.369,0.565,0.396)*0.75+0.25,vec3(1.0),min(1.0,(worldNormal.y*0.5+0.5)+min(1.0,v_worldPosition.y*5.0)));\n#ifdef HAS_OUT_OF_BOUND_EFFECT\nvec3 greyColor=vec3(dot(color,vec3(0.299,0.587,0.114)));float outBoundDelta=max(abs(v_worldPosition.x),abs(v_worldPosition.z))-u_halfTrackAreaSize;color=mix(color,mix(greyColor,vec3(1.0),smoothstep(0.02+fwidth(outBoundDelta),0.02,outBoundDelta)),step(0.0,outBoundDelta)*u_isOutBoundEffectActive);\n#endif\n#ifdef HAS_NIGHT_EFFECT\nif(u_previewRatio==0.0){color*=mix(vec3(1.0),u_nightEffectColor,max(0.0,u_nigthModeActiveRatio-0.1));}\n#endif\n#ifdef IS_LIGHTBEAM\nfloat lightSpeed=0.50;float scale=u_lightbeamScale;float noiseStrength=u_lightbeamStrength;float noiseValue=snoise(vec2(v_uv.y*scale+(u_lightbeamDirection*(u_time*lightSpeed)),v_uv.x*scale))*noiseStrength;if(u_opacity>0.0){color=u_lightbeamColor+noiseValue;alpha=u_opacity*u_nigthModeActiveRatio;}else{color=u_lightbeamColor*max(0.2,noiseValue);alpha=v_position.y*u_nigthModeActiveRatio;}\n#endif\nfloat luma=dot(color,vec3(0.299,0.587,0.114));color=mix(vec3(luma),color,1.2);gl_FragColor=vec4(pow(color,vec3(0.454545)),alpha);}"
  , white = new Color(16777215)
  , UberMaterial = function(e) {
    _inherits(i, ShaderMaterial);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        null == (e = Object.assign({
            color: null,
            opacity: 1,
            texture: null,
            aoTexture: null,
            alphaTexture: null,
            patternTexture: null,
            transparent: !1,
            hasWaterEffect: !1,
            hasGroundShadow: !1,
            hasOutOfBoundEffect: !1,
            receiveShadow: !1,
            hasNightEffect: !1,
            nightEffectColor: !1,
            nightEffectTexture: !1,
            isLightbeam: !1,
            lightbeamColor: null,
            lightbeamStrength: 1,
            lightbeamDirection: 1,
            lightbeamScale: 1,
            needsPreview: !1,
            needsBounce: !1,
            bounceMaxY: .1
        }, e)).color ? e.color = white : e.color.isColor || (e.color = new Color(e.color)),
        e.needsPreview && (e.transparent = !0),
        r = t.call(this, {
            uniforms: {
                u_color: {
                    value: e.color
                },
                u_opacity: {
                    value: e.opacity
                },
                u_texture: {
                    value: e.texture
                },
                u_aoTexture: {
                    value: e.aoTexture
                },
                u_patternTexture: {
                    value: e.patternTexture
                },
                u_alphaTexture: {
                    value: e.alphaTexture
                },
                u_envTextureDay: i.sharedUniforms.u_envTextureDay,
                u_envTextureNight: i.sharedUniforms.u_envTextureNight,
                u_cameraQuaternionInverse: properties.sharedUniforms.u_cameraQuaternionInverse,
                u_time: properties.sharedUniforms.u_time,
                u_nightEffectTexture: {
                    value: e.nightEffectTexture
                },
                u_nigthModeActiveRatio: properties.sharedUniforms.u_nigthModeActiveRatio
            },
            vertexShader: vert$1,
            fragmentShader: frag$2,
            transparent: e.transparent
        }),
        glPositionOffset.applyMaterial(_assertThisInitialized(r)),
        r.defines.HAS_TEXTURE = !!e.texture,
        r.defines.HAS_AO_TEXTURE = !!e.aoTexture,
        r.defines.HAS_ALPHA_TEXTURE = !!e.alphaTexture,
        r.defines.HAS_GROUND_SHADOW = !!e.hasGroundShadow,
        e.hasWaterEffect && (r.defines.HAS_WATER_EFFECT = r.hasWaterEffect,
        r.uniforms.u_waterTime = {
            value: 0
        },
        r.uniforms.u_waterSpeed = {
            value: 1
        },
        r.uniforms.u_waterEffectColor = {
            value: new Color("#42d7f5")
        }),
        e.hasOutOfBoundEffect && (r.defines.HAS_OUT_OF_BOUND_EFFECT = r.hasOutOfBoundEffect,
        r.uniforms.u_halfTrackAreaSize = {
            value: properties.trackAreaSize / 2
        },
        r.uniforms.u_isOutBoundEffectActive = i.sharedUniforms.u_isOutBoundEffectActive,
        r.extensions.derivatives = !0),
        e.needsPreview && (r.defines.NEEDS_PREVIEW = r.needsPreview,
        r.uniforms.u_previewRatio = {
            value: 0
        },
        r.uniforms.u_previewColor = {
            value: new Color("#ffffff")
        }),
        e.hasNightEffect && (r.defines.HAS_NIGHT_EFFECT = r.hasNightEffect,
        r.defines.HAS_NIGHT_EFFECT_TEXTURE = !!e.nightEffectTexture,
        r.uniforms.u_nightEffectColor = {
            value: e.nightEffectColor ? new Color(e.nightEffectColor) : new Color("#0009f2")
        }),
        e.isLightbeam && (r.defines.IS_LIGHTBEAM = r.isLightbeam,
        r.uniforms.u_lightbeamStrength = {
            value: e.lightbeamStrength
        },
        r.uniforms.u_lightbeamDirection = {
            value: e.lightbeamDirection
        },
        r.uniforms.u_lightbeamScale = {
            value: e.lightbeamScale
        },
        r.uniforms.u_lightbeamColor = {
            value: e.lightbeamColor ? new Color(e.lightbeamColor) : new Color("#faff00")
        }),
        e.receiveShadow && (r.defines.RECEIVE_SHADOW = !0,
        r.lights = !0,
        Object.assign(r.uniforms, UniformsUtils.merge([UniformsLib.lights])),
        Object.assign(r.uniforms, blueNoise.sharedUniforms)),
        e.needsBounce && (r.defines.NEEDS_BOUNCE = !0,
        r.uniforms.u_bounceMaxY = {
            value: e.bounceMaxY
        }),
        r
    }
    return _createClass2(i, null, [{
        key: "preload",
        value: function() {
            i.sharedUniforms.u_envTextureDay.value = properties.loader.add(settings.TEXTURE_PATH + "environment/" + settings.QUALITY_PATH + "envDay.jpg", {
                weight: 9,
                type: "texture",
                wrap: RepeatWrapping
            }).content,
            i.sharedUniforms.u_envTextureNight.value = properties.loader.add(settings.TEXTURE_PATH + "environment/" + settings.QUALITY_PATH + "envNight.jpg", {
                weight: 9,
                type: "texture",
                wrap: RepeatWrapping
            }).content
        }
    }, {
        key: "update",
        value: function(e) {
            i.sharedUniforms.u_isOutBoundEffectActive.value = math.saturate(i.sharedUniforms.u_isOutBoundEffectActive.value + (i.isOutBoundEffectActive ? 10 * e : -e))
        }
    }]),
    i
}();
_defineProperty2(UberMaterial, "sharedUniforms", {
    u_envTextureDay: {
        value: null
    },
    u_envTextureNight: {
        value: null
    },
    u_isOutBoundEffectActive: {
        value: 0
    },
    u_nigthModeActiveRatio: {
        value: 0
    }
}),
_defineProperty2(UberMaterial, "isOutBoundEffectActive", !1),
_defineProperty2(UberMaterial, "enableOutBoundEffect", (function() {
    var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
    UberMaterial.isOutBoundEffectActive = e
}
));
var vert = "#define GLSLIFY 1\nvarying vec2 v_uv;void main(){v_uv=uv;vec4 mvPosition=vec4(position,1.0);\n#ifdef USE_INSTANCING\nmvPosition=instanceMatrix*mvPosition;\n#endif\nmvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;}"
  , frag$1 = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform float u_strength;uniform vec3 u_terrainGroundColor;varying vec2 v_uv;void main(){vec3 diffuse=texture2D(u_texture,v_uv).rgb;vec3 invertedDiffuse=vec3(1.0-diffuse.r,1.0-diffuse.g,1.0-diffuse.b);vec3 shadowColor=vec3(0.0);vec3 color=vec3(mix(shadowColor,u_terrainGroundColor,1.0));gl_FragColor=vec4(color,smoothstep(0.0,1.0,invertedDiffuse.r)*u_strength);}"
  , StaticShadowMaterial = function(e) {
    _inherits(i, ShaderMaterial);
    var t = _createSuper(i);
    function i(e) {
        return _classCallCheck2(this, i),
        e = Object.assign({
            texture: null,
            strength: 1,
            terrainGroundColor: "#96f2a4"
        }, e),
        t.call(this, {
            uniforms: {
                u_texture: {
                    value: e.texture
                },
                u_strength: {
                    value: e.strength
                },
                u_terrainGroundColor: {
                    value: new Color(e.strength)
                }
            },
            vertexShader: vert,
            fragmentShader: frag$1,
            transparent: !0,
            depthWrite: !1
        })
    }
    return _createClass2(i)
}();
function clone(e) {
    var t = new Map
      , i = new Map
      , r = e.clone();
    return parallelTraverse(e, r, (function(e, r) {
        t.set(r, e),
        i.set(e, r)
    }
    )),
    r.traverse((function(e) {
        if (e.isSkinnedMesh) {
            var r = e
              , n = t.get(e)
              , a = n.skeleton.bones;
            r.skeleton = n.skeleton.clone(),
            r.bindMatrix.copy(n.bindMatrix),
            r.skeleton.bones = a.map((function(e) {
                return i.get(e)
            }
            )),
            r.bind(r.skeleton, r.bindMatrix)
        }
    }
    )),
    r
}
function parallelTraverse(e, t, i) {
    i(e, t);
    for (var r = 0; r < e.children.length; r++)
        parallelTraverse(e.children[r], t.children[r], i)
}
var Animals = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "texturePath", "".concat(settings.TEXTURE_PATH, "animals/")),
        _defineProperty2(this, "modelPath", "".concat(settings.MODEL_PATH, "animals/")),
        _defineProperty2(this, "models", {}),
        _defineProperty2(this, "diffuseTexturesDay", {}),
        _defineProperty2(this, "diffuseTexturesNight", {}),
        _defineProperty2(this, "diffuseTextureSheepDayBlack", {}),
        _defineProperty2(this, "diffuseTextureSheepNightBlack", {}),
        _defineProperty2(this, "shadowTexture", null),
        _defineProperty2(this, "shadowMaterial", new StaticShadowMaterial),
        _defineProperty2(this, "spriteUpdateCounter", 2),
        _defineProperty2(this, "walkingPaths", []),
        _defineProperty2(this, "collidableObjects", []),
        _defineProperty2(this, "detectedCollisions", []),
        _defineProperty2(this, "spriteSheetDataDay", {}),
        _defineProperty2(this, "spriteSheetDataNight", {}),
        _defineProperty2(this, "positionVector", new Vector3(0,0,0)),
        _defineProperty2(this, "rotationVector", new Vector3(0,0,0)),
        _defineProperty2(this, "scaleVector", new Vector3(properties.gltfModelScale,properties.gltfModelScale,properties.gltfModelScale))
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.animals
                }
            }),
            animalsData.forEach((function(t) {
                var i = t.name
                  , r = t.spriteSheetDay
                  , n = t.spriteSheetNight;
                properties.loader.add(t.model, {
                    weight: t.modelWeight,
                    onLoad: function(t) {
                        return e._onModelLoaded(t, i)
                    }
                }),
                e.diffuseTexturesDay[i] = properties.loader.add(t.diffuseTextureDay, {
                    weight: t.textureWeight,
                    type: "texture",
                    flipY: !1
                }).content,
                e.diffuseTexturesNight[i] = properties.loader.add(t.diffuseTextureNight, {
                    weight: t.textureWeight,
                    type: "texture",
                    flipY: !1
                }).content,
                t.diffuseTextureSheepDayBlack && (e.diffuseTextureSheepDayBlack = properties.loader.add(t.diffuseTextureSheepDayBlack, {
                    weight: t.textureWeight,
                    type: "texture",
                    flipY: !1
                }).content),
                t.diffuseTextureSheepNightBlack && (e.diffuseTextureSheepNightBlack = properties.loader.add(t.diffuseTextureSheepNightBlack, {
                    weight: t.textureWeight,
                    type: "texture",
                    flipY: !1
                }).content),
                e.shadowTexture = properties.loader.add(t.shadowTexture, {
                    weight: t.textureWeight,
                    type: "texture"
                }).content,
                properties.loader.add(r.texture, {
                    weight: r.weight,
                    type: "texture",
                    minFilter: LinearMipMapNearestFilter,
                    flipY: !0,
                    onLoad: function(i) {
                        return e._onSpriteSheetLoaded(i, t, "day")
                    }
                }).content,
                properties.loader.add(n.texture, {
                    weight: n.weight,
                    type: "texture",
                    minFilter: LinearMipMapNearestFilter,
                    flipY: !0,
                    onLoad: function(i) {
                        return e._onSpriteSheetLoaded(i, t, "night")
                    }
                }).content
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.data.forEach((function(t) {
                if (t.isWalkingGroup)
                    e._createWalkingGroup(t);
                else {
                    var i = t.name
                      , r = clone(e.models[i].model)
                      , n = e.models[i].animations;
                    r.boundingSphere = misc.getBoundingSphere(r),
                    r.userData.bboxSize = misc.getBoundingBoxSize(r),
                    e._setTransforms(r, t),
                    r.matrixAutoUpdate = !1,
                    r.updateMatrix(),
                    e.container.add(r),
                    e._setMaterial(r),
                    e._setShadow(r),
                    e._initAnimations(r, n),
                    setSpeechBubble(r, e.spriteSheetDataDay[i], "day"),
                    setSpeechBubble(r, e.spriteSheetDataNight[i], "night"),
                    e.collidableObjects.push(r),
                    r.userData.counter = Math.random()
                }
            }
            ))
        }
    }, {
        key: "_onModelLoaded",
        value: function(e, t) {
            var i = clone(e.scene || e.scenes[0]);
            i.name = t,
            this.models[t] = {
                model: i,
                animations: e.animations || []
            }
        }
    }, {
        key: "_onSpriteSheetLoaded",
        value: function(e, t, i) {
            "day" === i ? this.spriteSheetDataDay[t.name] = {
                texture: e,
                textureSize: t.spriteSheetDay.textureSize,
                spriteSize: t.spriteSheetDay.spriteSize,
                frameCount: t.spriteSheetDay.frameCount,
                fps: t.spriteSheetDay.fps,
                tilesHorizontal: t.spriteSheetDay.tilesHorizontal,
                tilesVertical: t.spriteSheetDay.tilesVertical
            } : this.spriteSheetDataNight[t.name] = {
                texture: e,
                textureSize: t.spriteSheetNight.textureSize,
                spriteSize: t.spriteSheetNight.spriteSize,
                frameCount: t.spriteSheetNight.frameCount,
                fps: t.spriteSheetNight.fps,
                tilesHorizontal: t.spriteSheetNight.tilesHorizontal,
                tilesVertical: t.spriteSheetNight.tilesVertical
            }
        }
    }, {
        key: "_initAnimations",
        value: function(e, t) {
            for (var i = new AnimationMixer(e), r = [], n = 0; n !== t.length; ++n) {
                var a = t[n]
                  , o = a.name
                  , s = i.clipAction(a);
                r[o] = s
            }
            switch (e.userData.mixer = i,
            e.userData.actions = r,
            e.name) {
            case "chicken":
                e.userData.closeUpActionName = "clicked",
                e.userData.farOffActionName = "eat",
                e.userData.nightActionName = "sit";
                break;
            case "duck":
                e.userData.closeUpActionName = "bounce",
                e.userData.farOffActionName = "idle",
                e.userData.nightActionName = "sit";
                break;
            case "rooster":
                e.userData.closeUpActionName = "clicked",
                e.userData.farOffActionName = "idle",
                e.userData.nightActionName = "sit";
                break;
            case "sheep":
                e.userData.closeUpActionName = "sit",
                e.userData.farOffActionName = "walk",
                e.userData.nightActionName = "sit",
                e.userData.walkActionName = "walk"
            }
            this._playAction(e, e.userData.farOffActionName)
        }
    }, {
        key: "_setMaterial",
        value: function(e, t) {
            var i, r = e.name;
            i = "sheep" === r ? t % 2 == 0 && 0 !== Object.keys(this.diffuseTextureSheepNightBlack).length ? new UberMaterial({
                texture: this.diffuseTexturesDay[r],
                hasNightEffect: !0,
                nightEffectTexture: this.diffuseTexturesNight[r]
            }) : new UberMaterial({
                texture: this.diffuseTextureSheepDayBlack,
                hasNightEffect: !0,
                nightEffectTexture: this.diffuseTextureSheepNightBlack
            }) : new UberMaterial({
                texture: this.diffuseTexturesDay[r],
                hasNightEffect: !0,
                nightEffectTexture: this.diffuseTexturesNight[r]
            }),
            e.traverse((function(e) {
                e.isMesh && (e.material = i,
                e.receiveShadow = !0)
            }
            ))
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = t.position ? t.position : this.positionVector
              , r = t.rotation ? t.rotation : this.rotationVector
              , n = t.scale ? t.scale : this.scaleVector.multiplyScalar(1.1);
            e.position.set(i.x, i.z, -i.y).multiplyScalar(properties.gltfModelScale),
            e.rotation.set(r.x, r.z, r.y),
            e.scale.set(n.x, n.y, n.z).multiplyScalar(properties.gltfModelScale),
            e.updateMatrixWorld(!0)
        }
    }, {
        key: "_setShadow",
        value: function(e) {
            var t = new PlaneGeometry(2 * e.userData.bboxSize.x,2 * e.userData.bboxSize.z)
              , i = this.shadowMaterial;
            i.uniforms.u_texture.value = this.shadowTexture,
            i.uniforms.u_strength.value = .2;
            var r = new Mesh(t,i);
            r.rotation.x = -Math.PI / 2,
            r.position.y = .01,
            r.renderOrder = 1,
            r.matrixAutoUpdate = !1,
            r.updateMatrix(),
            e.add(r)
        }
    }, {
        key: "_createWalkingGroup",
        value: function(e) {
            for (var t = e.name, i = getWalkingPathAndArea(e.walkingArea), r = i.walkingPath, n = i.walkingAreaMesh, a = 0; a < e.animalsAmount; a++) {
                var o = clone(this.models[t].model)
                  , s = this.models[t].animations;
                o.updateMatrix(),
                this.container.add(o),
                this._setMaterial(o, a),
                o.userData.bboxSize = misc.getBoundingBoxSize(o),
                this._setTransforms(o, e),
                this._setShadow(o),
                this._initAnimations(o, s),
                setSpeechBubble(o, this.spriteSheetDataDay[t], "day"),
                setSpeechBubble(o, this.spriteSheetDataNight[t], "night"),
                o.userData.walkingPath = r,
                o.userData.walkingAreaMesh = n,
                o.userData.walkingSpeed = .02,
                o.userData.counter = a / 10,
                this._playAction(o, o.userData.walkActionName)
            }
            this.collidableObjects.push(n),
            this.container.add(n)
        }
    }, {
        key: "_show",
        value: function(e) {
            var t = properties.sharedUniforms.u_nigthModeActiveRatio.value > 0 ? .25 : 1;
            "walkingAreaMesh" === e.name ? this.container.children.forEach((function(e) {
                e.userData.walkingAreaMesh && (e.visible = !0,
                e.userData.mixer.timeScale = t)
            }
            )) : (e.visible = !0,
            e.userData.mixer.timeScale = t)
        }
    }, {
        key: "_hide",
        value: function(e) {
            "walkingAreaMesh" === e.name ? this.container.children.forEach((function(e) {
                e.userData.walkingAreaMesh && (e.visible = !1,
                e.userData.mixer.timeScale = 0)
            }
            )) : (e.visible = !1,
            e.userData.mixer.timeScale = 0)
        }
    }, {
        key: "_playAction",
        value: function(e, t) {
            if (e.userData.selectedAction !== t) {
                e.userData.mixer.timeScale = properties.sharedUniforms.u_nigthModeActiveRatio.value > 0 ? .25 : 1;
                var i = e.userData.actions[t]
                  , r = e.userData.actions[e.userData.selectedAction];
                i ? (r && (r.stop(),
                r.play(),
                r.crossFadeTo(i, .35)),
                i.stop(),
                i.play(),
                i.fadeIn(.35)) : console.log("[animals] _playAction() actionName: ", t, "was not found."),
                e.userData.selectedAction = t
            }
        }
    }, {
        key: "_onAnimalCloseUp",
        value: function(e, t) {
            var i = properties.sharedUniforms.u_nigthModeActiveRatio.value > 0;
            t.userData.walkingPath || (i ? this._playAction(t, t.userData.nightActionName) : this._playAction(t, t.userData.closeUpActionName)),
            i ? (showSpeechbubble(e, t.userData.speechBubbleNight),
            hideSpeechbubble(e, t.userData.speechBubbleDay)) : (showSpeechbubble(e, t.userData.speechBubbleDay),
            hideSpeechbubble(e, t.userData.speechBubbleNight))
        }
    }, {
        key: "_onAnimalCloseOff",
        value: function(e, t) {
            var i = properties.sharedUniforms.u_nigthModeActiveRatio.value > 0;
            t.userData.walkingPath || (i ? this._playAction(t, t.userData.nightActionName) : this._playAction(t, t.userData.farOffActionName)),
            hideSpeechbubble(e, t.userData.speechBubbleDay),
            hideSpeechbubble(e, t.userData.speechBubbleNight)
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._show(i.object),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    var r = t.collidableObjects[i];
                    railway._isObjectCollidingWithTrackPiece(r, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.object.id === r.id
                    }
                    )) && (t._hide(r),
                    t.detectedCollisions.push({
                        object: r,
                        trackPiece: e
                    }))
                }, r = 0; r < this.collidableObjects.length; r++)
                    i(r)
        }
    }, {
        key: "update",
        value: function(e) {
            for (var t = 0; t < this.container.children.length; t++) {
                var i = this.container.children[t];
                i.userData.mixer && (i.userData.mixer.update(e),
                properties.sharedUniforms.u_nigthModeActiveRatio.value > 0 ? (this._playAction(i, i.userData.nightActionName),
                i.visible && i.userData.walkingPath && updateWalking(e, i)) : i.visible && i.userData.walkingPath && (this._playAction(i, i.userData.walkActionName),
                updateWalking(e, i)),
                "overview" === cameraControls$1._cameraMode && i.visible && (i.position.distanceTo(cameraControls$1._camera.position) < .3 ? this._onAnimalCloseUp(e, i) : this._onAnimalCloseOff(e, i)))
            }
        }
    }]),
    e
}()
  , animals = new Animals
  , Balloon = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "balloonMesh", null),
        _defineProperty2(this, "diffuseTextureBalloon", null),
        _defineProperty2(this, "data", null),
        _defineProperty2(this, "animalModel", null),
        _defineProperty2(this, "diffuseTextureAnimal", null),
        _defineProperty2(this, "animalAnimations", null),
        _defineProperty2(this, "animalMixer", null),
        _defineProperty2(this, "counter", .9),
        _defineProperty2(this, "axis", new Vector3),
        _defineProperty2(this, "up", new Vector3(0,0,1)),
        _defineProperty2(this, "front", new Vector3(0,1,0)),
        _defineProperty2(this, "flyPath", null),
        _defineProperty2(this, "flySpeed", .005),
        _defineProperty2(this, "flyLiftFrequency", 120),
        _defineProperty2(this, "_brownianMotion", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this
              , t = this._brownianMotion = new BrownianMotion;
            t._positionFrequency = .25,
            t._rotationFrequency = .25,
            t._positionAmplitude = .1,
            t._rotationAmplitude = 1,
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.flyPathBalloon || []
                }
            }),
            properties.loader.add(settings.MODEL_PATH + "balloon.glb", {
                weight: 27,
                onLoad: function(t) {
                    return e._onBalloonModelLoaded(t)
                }
            }),
            this.diffuseTextureBalloon = properties.loader.add(settings.TEXTURE_PATH + "balloon/" + settings.QUALITY_PATH + "balloon_diffuse_1." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 50 : 98 : properties.jpgwebp ? 21 : 39,
                type: "texture",
                flipY: !1
            }).content,
            properties.loader.add("".concat(settings.MODEL_PATH, "animals/sheep.glb"), {
                weight: 39,
                onLoad: function(t) {
                    return e._onAnimalLoaded(t)
                }
            }),
            this.diffuseTextureAnimal = properties.loader.add("".concat(settings.TEXTURE_PATH, "animals/sheep/sheep_white_diffuse_day.png"), {
                weight: 1,
                type: "texture",
                flipY: !1
            }).content
        }
    }, {
        key: "init",
        value: function() {
            this._setMaterials(),
            this._setFlyPath(),
            this._initAnimalAnimations(),
            this.balloonMesh.add(this.animalModel)
        }
    }, {
        key: "_onBalloonModelLoaded",
        value: function(e) {
            this.balloonMesh = e.scene || e.scenes[0],
            this.balloonMesh.scale.multiplyScalar(properties.gltfModelScale),
            window.balloon = this.balloonMesh,
            this.container.add(this.balloonMesh)
        }
    }, {
        key: "_onAnimalLoaded",
        value: function(e) {
            this.animalModel = clone(e.scene || e.scenes[0]),
            this.animalModel.scale.set(properties.gltfModelScale, properties.gltfModelScale, properties.gltfModelScale).multiplyScalar(1.25),
            this.animalAnimations = e.animations || []
        }
    }, {
        key: "_setMaterials",
        value: function() {
            var e = new UberMaterial({
                texture: this.diffuseTextureBalloon,
                hasNightEffect: !0
            });
            e.side = DoubleSide,
            this.balloonMesh.traverse((function(t) {
                t.isMesh && (t.material = e,
                t.castShadow = !0)
            }
            ));
            var t = new UberMaterial({
                texture: this.diffuseTextureAnimal,
                hasNightEffect: !0
            });
            this.animalModel.traverse((function(e) {
                e.isMesh && (e.material = t)
            }
            ))
        }
    }, {
        key: "_setFlyPath",
        value: function() {
            var e, t = [];
            if (this.data.forEach((function(e) {
                var i = {
                    x: e.x * properties.gltfModelScale,
                    y: e.z * properties.gltfModelScale,
                    z: -e.y * properties.gltfModelScale
                };
                t.push(i)
            }
            )),
            this.flyPath = new CatmullRomCurve3(misc.getPathVectors(t),!0),
            settings.LOOK_DEV_MODE) {
                var i = new Line((e = this.flyPath.getPoints(30),
                (new BufferGeometry).setFromPoints(e)),new LineBasicMaterial({
                    color: 16711680
                }));
                this.container.add(i)
            }
        }
    }, {
        key: "_initAnimalAnimations",
        value: function() {
            this.animalMixer = new AnimationMixer(this.animalModel);
            for (var e = [], t = 0; t !== this.animalAnimations.length; ++t) {
                var i = this.animalAnimations[t]
                  , r = i.name
                  , n = this.animalMixer.clipAction(i);
                e[r] = n
            }
            e.sit.play()
        }
    }, {
        key: "_updateBalloon",
        value: function(e) {
            var t = this.flyPath.getPoint(this.counter);
            this.balloonMesh.position.set(t.x, t.y + Math.max(.05 * Math.sin((this.counter + .01) * this.flyLiftFrequency), .1), t.z);
            var i = this.flyPath.getTangent(this.counter).normalize();
            this.axis.crossVectors(this.up, i).normalize();
            var r = Math.acos(this.up.dot(i));
            this.balloonMesh.quaternion.setFromAxisAngle(this.axis, r),
            this.axis.crossVectors(this.front, i).normalize();
            var n = Math.acos(this.front.dot(i));
            this.balloonMesh.quaternion.setFromAxisAngle(this.axis, Math.min(.1, n)),
            this._brownianMotion.update(e),
            this.balloonMesh.quaternion.multiply(this._brownianMotion._rotation),
            this.balloonMesh.position.add(this._brownianMotion._position),
            this.counter += e * this.flySpeed,
            this.counter > 1 && (this.counter = 0)
        }
    }, {
        key: "update",
        value: function(e) {
            this.flyPath && this._updateBalloon(e),
            this.animalMixer && this.animalMixer.update(e)
        }
    }]),
    e
}()
  , balloon = new Balloon
  , Clouds = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "modelPath", "".concat(settings.MODEL_PATH, "clouds/")),
        _defineProperty2(this, "models", {}),
        _defineProperty2(this, "material", null),
        _defineProperty2(this, "data", null),
        _defineProperty2(this, "amount", 0),
        _defineProperty2(this, "lookDevGuiColor", {
            nightEffectColor: "#0009f2"
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.clouds || []
                }
            }),
            properties.loader.add("".concat(this.modelPath, "cloud_a.glb"), {
                weight: 5,
                onLoad: function(t) {
                    return e._onModelLoaded(t, "cloud_a")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "cloud_b.glb"), {
                weight: 6,
                onLoad: function(t) {
                    return e._onModelLoaded(t, "cloud_b")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "cloud_c.glb"), {
                weight: 4,
                onLoad: function(t) {
                    return e._onModelLoaded(t, "cloud_c")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "cloud_d.glb"), {
                weight: 4,
                onLoad: function(t) {
                    return e._onModelLoaded(t, "cloud_d")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "cloud_e.glb"), {
                weight: 3,
                onLoad: function(t) {
                    return e._onModelLoaded(t, "cloud_e")
                }
            })
        }
    }, {
        key: "init",
        value: function(e) {
            this._setMaterial(),
            this._createClouds(),
            e && this._initLookDev(e)
        }
    }, {
        key: "_onModelLoaded",
        value: function(e, t) {
            var i = e.scene || e.scenes[0];
            i.name = t,
            this.models[t] = i
        }
    }, {
        key: "_setMaterial",
        value: function() {
            var e = this;
            for (var t in this.material = new UberMaterial({
                color: "#dddddd",
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.models)
                this.models[t].traverse((function(t) {
                    t.isMesh && (t.material = e.material)
                }
                ))
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = t.position
              , r = t.rotation
              , n = t.scale;
            e.position.set(i.x, i.z, -i.y).multiplyScalar(properties.gltfModelScale),
            e.rotation.set(r.x, r.z, r.y),
            e.scale.set(1.25 * n.x, 1.25 * n.y, 1.25 * n.z).multiplyScalar(properties.gltfModelScale),
            e.updateMatrixWorld(!0)
        }
    }, {
        key: "_createClouds",
        value: function() {
            var e = this;
            this.amount = this.data.length,
            this.data.forEach((function(t, i) {
                if (e.models[t.name]) {
                    var r = e.models[t.name].clone();
                    e._setTransforms(r, t),
                    r.userData.bboxSize = misc.getBoundingBoxSize(r),
                    r.userData.defaultPosition = (new Vector3).copy(r.position),
                    r.userData.speed = .05 + .15 * Math.random(),
                    r.userData.rotationDirection = i % 2 == 0 ? 1 : -1,
                    e.container.add(r)
                } else
                    console.log("cloudmodel not found - name: ", t.name)
            }
            ))
        }
    }, {
        key: "_moveClouds",
        value: function(e) {
            for (var t = 0; t < this.amount; t++) {
                var i = this.container.children[t];
                i.rotation.y = i.rotation.y + e * i.userData.speed * i.userData.rotationDirection,
                i.position.x = i.userData.defaultPosition.x + Math.sin(properties.time * i.userData.speed) * i.userData.bboxSize.x * properties.gltfModelScale,
                i.position.z = i.userData.defaultPosition.z + Math.cos(properties.time * i.userData.speed) * i.userData.bboxSize.z * properties.gltfModelScale
            }
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("clouds");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.material.uniforms.u_nightEffectColor.value.setStyle(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function(e) {
            this._moveClouds(e)
        }
    }]),
    e
}()
  , clouds = new Clouds
  , _frustum = new Frustum
  , _projScreenMatrix = new Matrix4
  , _sphere$3 = new Sphere;
new Vector3;
var TinyInstancedMesh = function(e) {
    _inherits(i, Mesh);
    var t = _createSuper(i);
    function i(e, r, n) {
        var a;
        _classCallCheck2(this, i),
        _defineProperty2(_assertThisInitialized(a = t.call(this, new InstancedBufferGeometry, r)), "objectList", []),
        _defineProperty2(_assertThisInitialized(a), "_sortList", []),
        _defineProperty2(_assertThisInitialized(a), "refGeometry", null),
        _defineProperty2(_assertThisInitialized(a), "instancedGeometry", null),
        _defineProperty2(_assertThisInitialized(a), "instancedAttributes", {}),
        _defineProperty2(_assertThisInitialized(a), "totalCount", 0),
        _defineProperty2(_assertThisInitialized(a), "visibleAll", !0),
        _defineProperty2(_assertThisInitialized(a), "autoId", !1),
        _defineProperty2(_assertThisInitialized(a), "depthSort", !0),
        _defineProperty2(_assertThisInitialized(a), "instanceMatrix", null),
        _defineProperty2(_assertThisInitialized(a), "instanceColor", null),
        _defineProperty2(_assertThisInitialized(a), "_updateAttribute", void 0),
        a.refGeometry = e,
        Object.assign(_assertThisInitialized(a), n);
        var o = a.objectList;
        if (o.toFixed)
            for (var s = 0; s < o.length; s++)
                o[s] = new Object3D;
        a.totalCount = o.length,
        !0 === a.depthSort && (a.depthSort = r.transparent ? 2 : 1);
        var l = a.instancedGeometry = a.geometry;
        for (var h in e.attributes)
            l.setAttribute(h, e.attributes[h]);
        e.index && l.setIndex(e.index),
        e.boundingBox || e.computeBoundingBox(),
        e.boundingSphere || e.computeBoundingSphere();
        for (var c = 0; c < o.length; c++) {
            var p = a.objectList[c];
            p.parent && p.parent.remove(p),
            a.autoId && (p.userData.instanceId = c)
        }
        return a.instancedGeometry.setAttribute("instanceMatrix", new InstancedBufferAttribute(new Float32Array(16 * a.totalCount),16)),
        a.instancedGeometry.attributes.instanceMatrix.setUsage(DynamicDrawUsage),
        a.instanceMatrix = a.instancedGeometry.attributes.instanceMatrix,
        a.isInstancedMesh = !0,
        a.frustumCulled = !1,
        a
    }
    return _createClass2(i, [{
        key: "setSphere",
        value: function(e, t) {
            return e.copy(this.refGeometry.boundingSphere),
            e.applyMatrix4(this.objectList[t].matrixWorld),
            e
        }
    }, {
        key: "setBbox",
        value: function(e, t) {
            return e.copy(this.refGeometry.boundingBox),
            e.applyMatrix4(this.objectList[t].matrixWorld),
            e
        }
    }, {
        key: "updateMatrix",
        value: function() {
            _get(_getPrototypeOf(i.prototype), "updateMatrix", this).call(this);
            for (var e = 0; e < this.objectList.length; e++)
                this.objectList[e].updateMatrix()
        }
    }, {
        key: "updateMatrixWorld",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "updateMatrixWorld", this).call(this, e);
            for (var t = 0; t < this.objectList.length; t++) {
                var r = this.objectList[t];
                r.matrixWorld.multiplyMatrices(this.matrixWorld, r.matrix)
            }
        }
    }, {
        key: "sortNearToFar",
        value: function(e, t) {
            return e[1] - t[1]
        }
    }, {
        key: "sortFarToNear",
        value: function(e, t) {
            return t[1] - e[1]
        }
    }, {
        key: "update",
        value: function(e) {
            if (this.visible = !1,
            this.visibleAll) {
                var t = 0
                  , i = this._sortList;
                i.length = 0;
                var r = this.instancedGeometry.attributes;
                _projScreenMatrix.multiplyMatrices(e.projectionMatrix, e.matrixWorldInverse),
                _frustum.setFromProjectionMatrix(_projScreenMatrix);
                for (var n = 0; n < this.objectList.length; n++) {
                    var a = this.objectList[n];
                    if (a.visible && (this.setSphere(_sphere$3, n),
                    _frustum.intersectsSphere(_sphere$3))) {
                        for (var o in a.matrix.toArray(r.instanceMatrix.array, 16 * t),
                        this.instancedAttributes) {
                            var s = this.instancedAttributes[o];
                            s.itemSize > 1 ? a.userData[o].toArray(s.array, t * s.itemSize) : s.array[t] = a.userData[o]
                        }
                        this.depthSort ? (_sphere$3.center.applyMatrix4(e.matrixWorldInverse),
                        i.push([n, -_sphere$3.center.z - _sphere$3.radius])) : i.push([n]),
                        t++
                    }
                }
                if (this.visible = t > 0,
                this.visible) {
                    this.depthSort && i.sort(1 === this.depthSort ? this.sortNearToFar : this.sortFarToNear);
                    for (var l = 0; l < i.length; l++) {
                        var h = this.objectList[i[l][0]];
                        for (var c in h.matrix.toArray(r.instanceMatrix.array, 16 * l),
                        this.instancedAttributes) {
                            var p = this.instancedAttributes[c];
                            p.itemSize > 1 ? h.userData[c].toArray(p.array, l * p.itemSize) : p.array[l] = h.userData[c]
                        }
                    }
                    for (var u in r.instanceMatrix.needsUpdate = !0,
                    this.instancedAttributes)
                        this.instancedAttributes[u].needsUpdate = !0;
                    this.count = t,
                    this.instanceCount = t
                }
            }
        }
    }]),
    i
}()
  , _sphere$2 = new Sphere
  , Flowers = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.mesh = null,
        this.shadowMesh = null,
        this.model = null,
        this.diffuseTexture = null,
        this.shadowTexture = null,
        this.shadowMaterial = new StaticShadowMaterial,
        this.data = null,
        this.detectedCollisions = [],
        this.lookDevGuiColor = {
            nightEffectColor: "#0009f2"
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.flowers || []
                }
            }),
            properties.loader.add("".concat(settings.MODEL_PATH, "flower.glb"), {
                weight: 11,
                onLoad: function(t) {
                    e.model = t.scene || t.scenes[0]
                }
            }),
            this.diffuseTexture = properties.loader.add(settings.TEXTURE_PATH + "flower/" + settings.QUALITY_PATH + "flower_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 20 : 36 : properties.jpgwebp ? 9 : 14,
                type: "texture",
                flipY: !1
            }).content,
            this.shadowTexture = properties.loader.add(settings.TEXTURE_PATH + "flower/" + settings.QUALITY_PATH + "flower_shadow." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 6 : properties.jpgwebp ? 1 : 3,
                type: "texture"
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            var t = []
              , i = [];
            this.data.forEach((function(e) {
                var r = new Object3D
                  , n = e.position;
                e.rotation;
                var a = e.scale;
                r.position.set(n.x, n.z, -n.y).multiplyScalar(properties.gltfModelScale),
                r.scale.set(a.x, a.y, a.z).multiplyScalar(properties.gltfModelScale),
                r.updateMatrix(),
                t.push(r);
                var o = new Object3D;
                o.rotation.x = -Math.PI / 2,
                o.position.y = .005,
                o.updateMatrix(),
                o.matrix.premultiply(r.matrix).decompose(o.position, o.quaternion, o.scale),
                i.push(o)
            }
            ));
            var r = this.model.children[0].geometry;
            r.computeBoundingSphere(),
            this.mesh = new TinyInstancedMesh(r,new UberMaterial({
                texture: this.diffuseTexture,
                needsBounce: !0,
                bounceMaxY: r.boundingBox.max.y,
                hasNightEffect: !0,
                nightEffectColor: new Color(this.lookDevGuiColor.nightEffectColor)
            }),{
                objectList: t
            }),
            this.container.add(this.mesh),
            this.shadowMesh = new TinyInstancedMesh(new PlaneGeometry(.685294,.685294),new StaticShadowMaterial({
                texture: this.shadowTexture,
                strength: .175
            }),{
                objectList: i
            }),
            this.shadowMesh.renderOrder = 1,
            this.container.add(this.shadowMesh),
            e && this._initLookDev(e)
        }
    }, {
        key: "_showObjectByIndex",
        value: function(e) {
            this.mesh.objectList[e].visible = !0,
            this.shadowMesh.objectList[e].visible = !0
        }
    }, {
        key: "_hideObjectByInex",
        value: function(e) {
            this.mesh.objectList[e].visible = !1,
            this.shadowMesh.objectList[e].visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._showObjectByIndex(i.index),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    t.mesh.setSphere(_sphere$2, i),
                    railway._isObjectCollidingWithTrackPiece(_sphere$2, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.index === i
                    }
                    )) && (t._hideObjectByInex(i),
                    t.detectedCollisions.push({
                        index: i,
                        trackPiece: e
                    }))
                }, r = 0; r < this.mesh.totalCount; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("flowers");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.mesh.material.uniforms.u_nightEffectColor.value.setStyle(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function() {
            this.mesh && (this.mesh.update(properties.camera),
            this.shadowMesh.update(properties.camera))
        }
    }]),
    e
}()
  , flowers = new Flowers
  , firefliesVert = "#define GLSLIFY 1\nattribute vec3 a_color;attribute float a_size;attribute float a_index;attribute float a_speed;attribute float a_movingDirection;uniform float u_time;uniform float u_blinkSpeed;varying vec3 v_color;varying vec3 v_position;void main(){vec3 transformedPosition=position;float movingRange=0.13;if(a_movingDirection==-1.0){transformedPosition.x-=sin(u_time*a_speed)*movingRange*a_movingDirection;transformedPosition.y+=max(sin(u_time*a_speed)*movingRange*a_movingDirection,0.03);transformedPosition.z-=cos(u_time*a_speed)*movingRange*a_movingDirection;}else if(a_movingDirection==1.0){transformedPosition.x+=sin(u_time*a_speed)*-movingRange;transformedPosition.y+=max(cos(u_time*a_speed)*-movingRange,0.03);transformedPosition.z+=cos(u_time*a_speed)*-movingRange;}vec4 mvPosition=modelViewMatrix*vec4(transformedPosition,1.0);gl_PointSize=(1.0/-mvPosition.z)*max(sin(a_index+u_time*u_blinkSpeed),0.5)*a_size;gl_Position=projectionMatrix*mvPosition;v_position=transformedPosition;v_color=a_color;}"
  , firefliesFrag = "#define GLSLIFY 1\nuniform vec3 u_color;uniform sampler2D u_texture;uniform float u_nigthModeActiveRatio;varying vec3 v_color;varying vec3 v_position;void main(){vec4 color=vec4(u_color*v_color,1.0);gl_FragColor=color*texture2D(u_texture,gl_PointCoord);gl_FragColor.a=u_nigthModeActiveRatio;}"
  , Fireflies = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "texture", null),
        _defineProperty2(this, "flyAreaMaterial", new MeshBasicMaterial({
            color: 16777215 * Math.random(),
            transparent: !0,
            depthWrite: !1,
            depthTest: !1,
            opacity: 0
        })),
        _defineProperty2(this, "flyAreas", []),
        _defineProperty2(this, "data", null),
        _defineProperty2(this, "detectedCollisions", []),
        _defineProperty2(this, "lookDevGuiColor", {
            nightEffectColor: "#fbff38"
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.fireflies || []
                }
            }),
            this.texture = properties.loader.add(settings.TEXTURE_PATH + "firefly.jpg", {
                weight: 1,
                type: "texture"
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            var t = this;
            this.data.forEach((function(e) {
                var i = t._createFlyArea(e);
                t.container.add(i);
                var r = t._createFirefliesWithinFlyArea(i);
                i.add(r)
            }
            )),
            e && this._initLookDev(e)
        }
    }, {
        key: "_createFlyArea",
        value: function(e) {
            var t = new BoxGeometry(1,1,1);
            t.translate(0, .5, 0),
            t.computeBoundingSphere(),
            settings.ANIMALS_DEV_MODE && (this.flyAreaMaterial.opacity = .35);
            var i = new Mesh(t,this.flyAreaMaterial);
            return i.userData.bboxSize = misc.getBoundingBoxSize(i),
            this._setTransforms(i, e),
            i.boundingSphere = misc.getBoundingSphere(i),
            i.matrixAutoUpdate = !1,
            i.updateMatrix(),
            i
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = t.position
              , r = t.scale;
            e.position.set(i.x, i.z, -i.y).multiplyScalar(properties.gltfModelScale),
            e.scale.set(r.x, r.z, r.y).multiplyScalar(properties.gltfModelScale)
        }
    }, {
        key: "_createFirefliesWithinFlyArea",
        value: function(e) {
            for (var t = e.userData.bboxSize, i = 4 + Math.floor(10 * Math.random()), r = new Float32Array(3 * i), n = new Float32Array(3 * i), a = new Float32Array(i), o = new Float32Array(i), s = new Float32Array(i), l = new Float32Array(i), h = new Vector3, c = new Color, p = 0; p < i; p++)
                h.x = Math.random() * t.x - t.x / 2,
                h.y = Math.random() * t.y - t.y + t.y,
                h.z = Math.random() * t.z - t.z / 2,
                h.toArray(r, 3 * p),
                c.set("#fbff38"),
                c.toArray(n, 3 * p),
                a[p] = p,
                o[p] = 5,
                s[p] = .75 + Math.random(),
                l[p] = p % 2 == 0 ? -1 : 1;
            var u = new BufferGeometry;
            u.setAttribute("position", new BufferAttribute(r,3)),
            u.setAttribute("a_color", new BufferAttribute(n,3)),
            u.setAttribute("a_index", new BufferAttribute(a,1)),
            u.setAttribute("a_size", new BufferAttribute(o,1)),
            u.setAttribute("a_speed", new BufferAttribute(s,1)),
            u.setAttribute("a_movingDirection", new BufferAttribute(l,1));
            var d = new ShaderMaterial({
                uniforms: {
                    u_time: {
                        value: 0
                    },
                    u_color: {
                        value: new Color(16777215)
                    },
                    u_texture: {
                        value: this.texture
                    },
                    u_blinkSpeed: {
                        value: 5
                    },
                    u_nigthModeActiveRatio: {
                        value: 0
                    }
                },
                vertexShader: firefliesVert,
                fragmentShader: firefliesFrag,
                blending: AdditiveBlending,
                depthWrite: !1,
                transparent: !0
            })
              , f = new Points(u,d);
            return f.renderOrder = 1,
            f.matrixAutoUpdate = !1,
            f.updateMatrix(),
            f
        }
    }, {
        key: "_show",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !0
        }
    }, {
        key: "_hide",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._show(i.object),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    var r = t.container.children[i];
                    railway._isObjectCollidingWithTrackPiece(r.boundingSphere, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.object.id === r.id
                    }
                    )) && (t._hide(r),
                    t.detectedCollisions.push({
                        object: r,
                        trackPiece: e
                    }))
                }, r = 0; r < this.container.children.length; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("firelfies");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.container.children.forEach((function(t) {
                    t.children[0].material.uniforms.u_color.value.setStyle(e)
                }
                ))
            }
            )).name("color"),
            i.open()
        }
    }, {
        key: "update",
        value: function(e) {
            properties.sharedUniforms.u_nigthModeActiveRatio.value > 0 ? (this.container.visible = !0,
            this.container.children.forEach((function(t) {
                t.children[0].material.uniforms.u_time.value += e,
                t.children[0].material.uniforms.u_nigthModeActiveRatio.value = properties.sharedUniforms.u_nigthModeActiveRatio.value
            }
            ))) : this.container.visible = !1
        }
    }]),
    e
}()
  , fireflies = new Fireflies
  , _sphere$1 = new Sphere
  , Grass = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.mesh = null,
        this.shadowMesh = null,
        this.model = null,
        this.diffuseTexture = null,
        this.shadowTexture = null,
        this.shadowMaterial = new StaticShadowMaterial,
        this.data = null,
        this.detectedCollisions = [],
        this.lookDevGuiColor = {
            nightEffectColor: "#0009f2"
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.grass || []
                }
            }),
            properties.loader.add("".concat(settings.MODEL_PATH, "grass.glb"), {
                weight: 6,
                onLoad: function(t) {
                    e.model = t.scene || t.scenes[0]
                }
            }),
            this.diffuseTexture = properties.loader.add(settings.TEXTURE_PATH + "grass/" + settings.QUALITY_PATH + "grass_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 11 : 22 : properties.jpgwebp ? 4 : 8,
                type: "texture",
                flipY: !1
            }).content,
            this.shadowTexture = properties.loader.add(settings.TEXTURE_PATH + "grass/" + settings.QUALITY_PATH + "grass_shadow." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 7 : properties.jpgwebp ? 1 : 3,
                type: "texture"
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            var t = []
              , i = [];
            this.data.forEach((function(e) {
                var r = new Object3D
                  , n = e.position;
                e.rotation;
                var a = e.scale;
                r.position.set(n.x, n.z, -n.y).multiplyScalar(properties.gltfModelScale),
                r.scale.set(a.x, a.y, a.z).multiplyScalar(properties.gltfModelScale),
                r.updateMatrix(),
                t.push(r);
                var o = new Object3D;
                o.rotation.x = -Math.PI / 2,
                o.position.y = .005,
                o.updateMatrix(),
                o.matrix.premultiply(r.matrix).decompose(o.position, o.quaternion, o.scale),
                i.push(o)
            }
            ));
            var r = this.model.children[0].geometry;
            r.computeBoundingSphere(),
            this.mesh = new TinyInstancedMesh(r,new UberMaterial({
                texture: this.diffuseTexture,
                needsBounce: !0,
                bounceMaxY: r.boundingBox.max.y,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),{
                objectList: t
            }),
            this.container.add(this.mesh),
            this.shadowMesh = new TinyInstancedMesh(new PlaneGeometry(1.59128,1.59128),new StaticShadowMaterial({
                texture: this.shadowTexture,
                strength: .15
            }),{
                objectList: i
            }),
            this.shadowMesh.renderOrder = 1,
            this.container.add(this.shadowMesh),
            e && this._initLookDev(e)
        }
    }, {
        key: "_showObjectByIndex",
        value: function(e) {
            this.mesh.objectList[e].visible = !0,
            this.shadowMesh.objectList[e].visible = !0
        }
    }, {
        key: "_hideObjectByInex",
        value: function(e) {
            this.mesh.objectList[e].visible = !1,
            this.shadowMesh.objectList[e].visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._showObjectByIndex(i.index),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    t.mesh.setSphere(_sphere$1, i),
                    railway._isObjectCollidingWithTrackPiece(_sphere$1, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.index === i
                    }
                    )) && (t._hideObjectByInex(i),
                    t.detectedCollisions.push({
                        index: i,
                        trackPiece: e
                    }))
                }, r = 0; r < this.mesh.totalCount; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("grass");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.mesh.material.uniforms.u_nightEffectColor.value = new Color(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function(e) {
            this.mesh && (this.mesh.update(properties.camera),
            this.shadowMesh.update(properties.camera))
        }
    }]),
    e
}()
  , grass = new Grass
  , texturePath = "".concat(settings.TEXTURE_PATH, "grassStraws/")
  , qualityPath$1 = "".concat(settings.QUALITY_PATH)
  , grassStrawsData = [{
    name: "strawA",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_01.png"),
    weight: properties.isHiresSetting ? 8 : 3
}, {
    name: "strawB",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_02.png"),
    weight: properties.isHiresSetting ? 8 : 3
}, {
    name: "strawC",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_03.png"),
    weight: properties.isHiresSetting ? 8 : 3
}, {
    name: "strawD",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_04.png"),
    weight: properties.isHiresSetting ? 7 : 3
}, {
    name: "strawE",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_05.png"),
    weight: properties.isHiresSetting ? 5 : 2
}, {
    name: "strawF",
    diffuseTexture: "".concat(texturePath).concat(qualityPath$1, "grass_06.png"),
    weight: properties.isHiresSetting ? 4 : 2
}]
  , GrassStraws = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.instancedMeshes = [],
        this.materials = {},
        this.diffuseTextures = {},
        this.instanceCount = 384,
        this.radialSpreadSize = 20
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            grassStrawsData.forEach((function(t) {
                e.diffuseTextures[t.name] = properties.loader.add(t.diffuseTexture, {
                    weight: t.weight,
                    minFilter: LinearMipMapNearestFilter,
                    type: "texture"
                }).content,
                e.materials[t.name] = new UberMaterial({
                    texture: e.diffuseTextures[t.name],
                    transparent: !0,
                    hasNightEffect: !0,
                    nightEffectColor: "#232eff"
                }),
                e.materials[t.name].side = DoubleSide,
                e.materials.depthWrite = !1
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            for (var e in this.materials)
                this._createInstance(e)
        }
    }, {
        key: "_createInstance",
        value: function(e) {
            var t = new PlaneGeometry(.01,.01);
            t.translate(0, .005, 0);
            var i = new InstancedBufferGeometry;
            t.index && i.setIndex(t.index);
            for (var r = new Matrix4, n = new InstancedMesh(t,this.materials[e],this.instanceCount), a = 0; a < this.instanceCount; a++)
                this._setTransforms(r, a),
                n.name = e,
                n.setMatrixAt(a, r),
                n.renderOrder = 1;
            this.instancedMeshes.push(n),
            this.container.add(n)
        }
    }, {
        key: "getPoint",
        value: function() {
            var e, t, i, r;
            do {
                e = (t = Math.random() * this.radialSpreadSize - this.radialSpreadSize / 2) * t + (i = Math.random() * this.radialSpreadSize - this.radialSpreadSize / 2) * i + (r = Math.random() * this.radialSpreadSize - this.radialSpreadSize / 2) * r
            } while (e > this.radialSpreadSize / 2);
            return {
                x: t,
                z: r
            }
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = new Vector3
              , r = new Euler
              , n = new Quaternion
              , a = new Vector3
              , o = this.getPoint();
            i.set(o.x, 0, o.z),
            r.set(0, t / 10, 0),
            n.setFromEuler(r),
            a.set(1, 1, 1),
            e.compose(i, n, a)
        }
    }]),
    e
}()
  , grassStraws = new GrassStraws
  , Mountains = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "texturePath", "".concat(settings.TEXTURE_PATH, "mountains/")),
        _defineProperty2(this, "modelPath", "".concat(settings.MODEL_PATH, "mountains/")),
        _defineProperty2(this, "models", {}),
        _defineProperty2(this, "material", null),
        _defineProperty2(this, "diffuseTextures", {}),
        _defineProperty2(this, "shadowTexture", null),
        _defineProperty2(this, "shadowMaterial", new StaticShadowMaterial),
        _defineProperty2(this, "data", null),
        _defineProperty2(this, "detectedCollisions", []),
        _defineProperty2(this, "lookDevGuiColor", {
            nightEffectColor: "#0009f2"
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e, t = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(e) {
                    t.data = e.mountains || []
                }
            }),
            properties.loader.add("".concat(this.modelPath, "mountain_a.glb"), {
                weight: 10,
                onLoad: function(e) {
                    t._onModelLoaded(e, "mountain_a")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "mountain_b.glb"), {
                weight: 5,
                onLoad: function(e) {
                    t._onModelLoaded(e, "mountain_b")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "mountain_c.glb"), {
                weight: 4,
                onLoad: function(e) {
                    t._onModelLoaded(e, "mountain_c")
                }
            }),
            this.diffuseTextures.mountain_a = properties.loader.add("".concat(this.texturePath, "mountain_a/").concat(settings.QUALITY_PATH, "/mountain_a_diffuse.") + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 17 : 26 : properties.jpgwebp ? 6 : 9,
                type: "texture",
                flipY: !1
            }).content,
            this.diffuseTextures.mountain_b = properties.loader.add("".concat(this.texturePath, "mountain_b/").concat(settings.QUALITY_PATH, "/mountain_b_diffuse.") + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 7 : 15 : properties.jpgwebp ? 3 : 6,
                type: "texture",
                flipY: !1
            }).content,
            this.diffuseTextures.mountain_c = properties.loader.add("".concat(this.texturePath, "mountain_c/").concat(settings.QUALITY_PATH, "/mountain_c_diffuse.") + properties.jpgwebp, (e = {
                weight: properties.isHiresSetting ? 13 : 5
            },
            _defineProperty2(e, "weight", properties.isHiresSetting ? properties.jpgwebp ? 7 : 15 : properties.jpgwebp ? 3 : 6),
            _defineProperty2(e, "type", "texture"),
            _defineProperty2(e, "flipY", !1),
            e)).content,
            this.shadowTexture = properties.loader.add("".concat(this.texturePath, "radialgradient.") + properties.jpgwebp, {
                weight: 1,
                type: "texture",
                flipY: !1
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            this._setMaterial(),
            this._createMountains(),
            e && this._initLookDev(e)
        }
    }, {
        key: "_onModelLoaded",
        value: function(e, t) {
            var i = e.scene || e.scenes[0];
            i.name = t,
            this.models[t] = i
        }
    }, {
        key: "_setMaterial",
        value: function() {
            var e = this;
            for (var t in this.models) {
                var i = this.models[t];
                this.material = new UberMaterial({
                    texture: this.diffuseTextures[i.name],
                    hasNightEffect: !0,
                    nightEffectColor: this.lookDevGuiColor.nightEffectColor
                }),
                i.traverse((function(t) {
                    t.isMesh && (t.geometry.attributes.uv2 = t.geometry.attributes.uv,
                    t.material = e.material,
                    t.receiveShadow = !0)
                }
                ))
            }
        }
    }, {
        key: "_createMountains",
        value: function() {
            var e = this;
            this.data.forEach((function(t) {
                var i = e.models[t.name].clone();
                e._setTransforms(i, t),
                i.matrixAutoUpdate = !1,
                i.updateMatrix(),
                e.container.add(i),
                i.boundingSphere = misc.getBoundingSphere(i),
                i.userData.bboxSize = misc.getBoundingBoxSize(i),
                e._setShadow(i)
            }
            ))
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = t.position
              , r = t.rotation
              , n = t.scale;
            e.position.set(i.x, i.z, -i.y).multiplyScalar(properties.gltfModelScale),
            e.rotation.set(r.x, r.z, r.y),
            e.scale.set(n.x, n.y, n.z).multiplyScalar(properties.gltfModelScale),
            e.updateMatrixWorld(!0)
        }
    }, {
        key: "_setShadow",
        value: function(e) {
            var t = new PlaneGeometry(.97 * e.userData.bboxSize.x / e.scale.x,.97 * e.userData.bboxSize.x / e.scale.y)
              , i = this.shadowMaterial;
            i.uniforms.u_texture.value = this.shadowTexture,
            i.uniforms.u_strength.value = .2;
            var r = new Mesh(t,i);
            r.rotation.x = -Math.PI / 2,
            r.position.y = .005,
            r.renderOrder = 1,
            r.matrixAutoUpdate = !1,
            r.updateMatrix(),
            e.add(r)
        }
    }, {
        key: "_show",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !0
        }
    }, {
        key: "_hide",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._show(i.object),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    var r = t.container.children[i];
                    railway._isObjectCollidingWithTrackPiece(r.boundingSphere, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.object.id === r.id
                    }
                    )) && (t._hide(r),
                    t.detectedCollisions.push({
                        object: r,
                        trackPiece: e
                    }))
                }, r = 0; r < this.container.children.length; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("mountains");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.material.uniforms.u_nightEffectColor.value.setStyle(e)
            }
            )).name("night color"),
            i.open()
        }
    }]),
    e
}()
  , mountains = new Mountains
  , PlaneAndUfo = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "containerPlaneParts", new Object3D),
        _defineProperty2(this, "diffuseTexturePlane", null),
        _defineProperty2(this, "baseMesh", null),
        _defineProperty2(this, "fanMesh", null),
        _defineProperty2(this, "materialPlane", null),
        _defineProperty2(this, "containerUfo", new Object3D),
        _defineProperty2(this, "ufoMesh", null),
        _defineProperty2(this, "diffuseTextureUfo", null),
        _defineProperty2(this, "ufoLightbeamMesh", null),
        _defineProperty2(this, "data", null),
        _defineProperty2(this, "animalModel", null),
        _defineProperty2(this, "diffuseTextureAnimal", null),
        _defineProperty2(this, "animalAnimations", null),
        _defineProperty2(this, "animalMixer", null),
        _defineProperty2(this, "counter", .605),
        _defineProperty2(this, "tangent", new Vector3),
        _defineProperty2(this, "front", new Vector3(0,1,0)),
        _defineProperty2(this, "axis", new Vector3),
        _defineProperty2(this, "up", new Vector3(0,0,-1)),
        _defineProperty2(this, "flyPath", null),
        _defineProperty2(this, "flySpeed", .01)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this
              , t = this._brownianMotion = new BrownianMotion;
            t._positionFrequency = .25,
            t._rotationFrequency = .25,
            t._positionAmplitude = .1,
            t._rotationAmplitude = 1,
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.flyPathPlane || []
                }
            }),
            this.diffuseTexturePlane = properties.loader.add(settings.TEXTURE_PATH + "plane/" + settings.QUALITY_PATH + "plane_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 17 : 30 : properties.jpgwebp ? 9 : 14,
                type: "texture"
            }).content,
            this.diffuseTextureUfo = properties.loader.add(settings.TEXTURE_PATH + "ufo/" + settings.QUALITY_PATH + "ufo_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 10 : 15 : properties.jpgwebp ? 5 : 6,
                type: "texture",
                flipY: !1
            }).content,
            properties.loader.add(settings.MODEL_PATH + "plane/PLANE_BASE.buf", {
                weight: 23,
                onLoad: function(t) {
                    e._onPlaneModelPartLoaded("base", t)
                }
            }),
            properties.loader.add(settings.MODEL_PATH + "plane/PLANE_FAN.buf", {
                weight: 20,
                onLoad: function(t) {
                    e._onPlaneModelPartLoaded("fan", t)
                }
            }),
            properties.loader.add("".concat(settings.MODEL_PATH, "animals/rooster.glb"), {
                weight: 39,
                onLoad: function(t) {
                    return e._onAnimalLoaded(t)
                }
            }),
            this.diffuseTextureAnimal = properties.loader.add("".concat(settings.TEXTURE_PATH, "animals/rooster/rooster_diffuse_day.png"), {
                weight: 1,
                type: "texture",
                flipY: !1
            }).content,
            properties.loader.add(settings.MODEL_PATH + "ufo.glb", {
                weight: 29,
                onLoad: function(t) {
                    return e._onUfoModelLoaded(t)
                }
            })
        }
    }, {
        key: "init",
        value: function() {
            var e = soundAudio.items.propeller;
            e.onInitialized.add((function() {}
            )),
            this.containerPlaneParts.add(e.container),
            e.play(),
            this._setFlyPath(),
            this._initUfoLightbeam(),
            this._setAnimalMaterial(),
            this._initAnimalAnimations(),
            this.containerPlaneParts.add(this.animalModel),
            this.container.add(this.containerPlaneParts),
            this.container.add(this.containerUfo)
        }
    }, {
        key: "_onPlaneModelPartLoaded",
        value: function(e, t) {
            this.materialPlane = this.materialPlane || new UberMaterial({
                texture: this.diffuseTexturePlane
            }),
            this.materialPlane.side = DoubleSide;
            var i = new Mesh(t,this.materialPlane);
            i.position.set(0, 0, .05),
            this.containerPlaneParts.add(i),
            i.castShadow = !0,
            "base" == e ? this.baseMesh = i : this.fanMesh = i
        }
    }, {
        key: "_onUfoModelLoaded",
        value: function(e) {
            this.ufoMesh = e.scene || e.scenes[0],
            this.ufoMesh.scale.multiplyScalar(properties.gltfModelScale);
            var t = new UberMaterial({
                texture: this.diffuseTextureUfo
            });
            t.side = DoubleSide,
            this.ufoMesh.traverse((function(e) {
                e.isMesh && (e.material = t,
                e.castShadow = !0)
            }
            )),
            this.containerUfo.add(this.ufoMesh)
        }
    }, {
        key: "_onAnimalLoaded",
        value: function(e) {
            this.animalModel = clone(e.scene || e.scenes[0]),
            this.animalModel.position.set(0, .015, -.035),
            this.animalModel.scale.set(properties.gltfModelScale, properties.gltfModelScale, properties.gltfModelScale).multiplyScalar(.2),
            this.animalAnimations = e.animations || []
        }
    }, {
        key: "_setAnimalMaterial",
        value: function() {
            var e = new UberMaterial({
                texture: this.diffuseTextureAnimal
            });
            this.animalModel.traverse((function(t) {
                t.isMesh && (t.material = e)
            }
            ))
        }
    }, {
        key: "_setFlyPath",
        value: function() {
            var e, t = [];
            if (this.data.forEach((function(e) {
                var i = {
                    x: e.x * properties.gltfModelScale,
                    y: e.z * properties.gltfModelScale,
                    z: -e.y * properties.gltfModelScale
                };
                t.push(i)
            }
            )),
            this.flyPath = new CatmullRomCurve3(misc.getPathVectors(t),!0),
            settings.LOOK_DEV_MODE) {
                var i = new Line((e = this.flyPath.getPoints(30),
                (new BufferGeometry).setFromPoints(e)),new LineBasicMaterial({
                    color: "#FAA134"
                }));
                this.container.add(i)
            }
        }
    }, {
        key: "_initAnimalAnimations",
        value: function() {
            this.animalMixer = new AnimationMixer(this.animalModel);
            for (var e = [], t = 0; t !== this.animalAnimations.length; ++t) {
                var i = this.animalAnimations[t]
                  , r = i.name
                  , n = this.animalMixer.clipAction(i);
                e[r] = n
            }
            e.clicked.play()
        }
    }, {
        key: "_initUfoLightbeam",
        value: function() {
            var e = new UberMaterial({
                isLightbeam: !0,
                lightbeamColor: "#ff00ff",
                lightbeamStrength: 5,
                lightbeamDirection: -1,
                lightbeamScale: .25,
                hasNightEffect: !0,
                opacity: 0
            });
            e.depthWrite = !1,
            e.transparent = !0,
            e.blending = AdditiveBlending;
            var t = new CylinderGeometry(.25,.5,2,16,16,!1);
            this.ufoLightbeamMesh = new Mesh(t,e),
            this.ufoLightbeamMesh.position.set(0, -1.2, 0),
            this.ufoMesh.add(this.ufoLightbeamMesh)
        }
    }, {
        key: "_updateFlyPath",
        value: function(e) {
            var t = this.flyPath.getPoint(this.counter);
            this.containerPlaneParts.position.copy(t),
            this.containerUfo.position.copy(t),
            this.tangent = this.flyPath.getTangent(this.counter).normalize(),
            this.axis.crossVectors(this.up, this.tangent).normalize();
            var i = Math.acos(this.up.dot(this.tangent));
            this.containerPlaneParts.quaternion.setFromAxisAngle(this.axis, i),
            this.containerUfo.quaternion.setFromAxisAngle(this.axis, i),
            this.axis.crossVectors(this.front, this.tangent).normalize();
            var r = Math.acos(this.front.dot(this.tangent));
            this.containerUfo.quaternion.setFromAxisAngle(this.axis, Math.min(.1, r)),
            this._brownianMotion.update(e),
            this.containerUfo.quaternion.multiply(this._brownianMotion._rotation),
            this.containerUfo.position.add(this._brownianMotion._position),
            this.fanMesh.rotation.z -= 15 * e,
            this.ufoLightbeamMesh.rotation.y -= 15 * e,
            this.counter -= e * this.flySpeed,
            this.counter < 0 && (this.counter = 1)
        }
    }, {
        key: "update",
        value: function(e) {
            this.flyPath && this._updateFlyPath(e),
            properties.sharedUniforms.u_nigthModeActiveRatio.value < 1 && this.animalMixer && this.animalMixer.update(e),
            this.baseMesh && this.fanMesh && this.animalModel && this.ufoMesh && (this.ufoMesh.scale.set(0 + ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value) * properties.gltfModelScale, 0 + ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value) * properties.gltfModelScale, 0 + ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value) * properties.gltfModelScale),
            this.baseMesh.scale.set(1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value), 1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value), 1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value)),
            this.fanMesh.scale.set(1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value), 1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value), 1 - ease.backOut(properties.sharedUniforms.u_nigthModeActiveRatio.value)),
            this.animalModel.scale.set(.02 - properties.sharedUniforms.u_nigthModeActiveRatio.value * properties.gltfModelScale / 5, .02 - properties.sharedUniforms.u_nigthModeActiveRatio.value * properties.gltfModelScale / 5, .02 - properties.sharedUniforms.u_nigthModeActiveRatio.value * properties.gltfModelScale / 5))
        }
    }]),
    e
}()
  , planeAndUfo = new PlaneAndUfo
  , Rocks = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.modelPath = "".concat(settings.MODEL_PATH, "rocks/"),
        this.models = {},
        this.rockAMaterial = null,
        this.rockBMaterial = null,
        this.diffuseTextureRockA = null,
        this.diffuseTextureRockB = null,
        this.shadowTextureRockA = null,
        this.shadowTextureRockB = null,
        this.shadowMaterialRockA = new StaticShadowMaterial,
        this.shadowMaterialRockB = new StaticShadowMaterial,
        this.data = null,
        this.detectedCollisions = [],
        this.lookDevGuiColor = {
            nightEffectColor: "#0009f2"
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e, t = this;
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(e) {
                    t.data = e.rocks || []
                }
            }),
            properties.loader.add("".concat(this.modelPath, "rock_a.glb"), {
                weight: 3,
                onLoad: function(e) {
                    return t._onModelLoaded(e, "rock_a")
                }
            }),
            properties.loader.add("".concat(this.modelPath, "rock_b.glb"), {
                weight: 4,
                onLoad: function(e) {
                    return t._onModelLoaded(e, "rock_b")
                }
            }),
            this.diffuseTextureRockA = properties.loader.add("".concat(settings.TEXTURE_PATH, "rocks/rock_a/").concat(settings.QUALITY_PATH, "rock_a_diffuse.") + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 5 : 8 : properties.jpgwebp ? 2 : 8,
                type: "texture",
                flipY: !1
            }).content,
            this.diffuseTextureRockB = properties.loader.add("".concat(settings.TEXTURE_PATH, "rocks/rock_b/").concat(settings.QUALITY_PATH, "rock_b_diffuse.") + properties.jpgwebp, (e = {
                weight: properties.isHiresSetting ? 9 : 4
            },
            _defineProperty2(e, "weight", properties.isHiresSetting ? properties.jpgwebp ? 4 : 7 : properties.jpgwebp ? 2 : 3),
            _defineProperty2(e, "type", "texture"),
            _defineProperty2(e, "flipY", !1),
            e)).content,
            this.shadowTextureRockA = properties.loader.add("".concat(settings.TEXTURE_PATH, "rocks/rock_a/").concat(settings.QUALITY_PATH, "rock_a_shadow.") + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 5 : properties.jpgwebp ? 1 : 2,
                type: "texture"
            }).content,
            this.shadowTextureRockB = properties.loader.add("".concat(settings.TEXTURE_PATH, "rocks/rock_b/").concat(settings.QUALITY_PATH, "rock_b_shadow.") + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 6 : properties.jpgwebp ? 1 : 3,
                type: "texture"
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            this._setMaterial(),
            this._createRocks(),
            e && this._initLookDev(e)
        }
    }, {
        key: "_onModelLoaded",
        value: function(e, t) {
            var i = e.scene || e.scenes[0];
            i.name = t,
            this.models[t] = i
        }
    }, {
        key: "_setMaterial",
        value: function() {
            var e = this;
            for (var t in this.rockAMaterial = new UberMaterial({
                texture: this.diffuseTextureRockA,
                receiveShadow: !0,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.rockBMaterial = new UberMaterial({
                texture: this.diffuseTextureRockB,
                receiveShadow: !0,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.models)
                this.models[t].traverse((function(t) {
                    t.isMesh && ("rock_a" === t.name ? t.material = e.rockAMaterial : "rock_b" === t.name ? t.material = e.rockBMaterial : console.log("[rocks] _setMaterial() - rock name error: ", t.name))
                }
                ))
        }
    }, {
        key: "_createRocks",
        value: function() {
            var e = this;
            this.data.forEach((function(t) {
                if (e.models[t.name]) {
                    var i = e.models[t.name].clone();
                    e._setTransforms(i, t),
                    i.matrixAutoUpdate = !1,
                    i.updateMatrix(),
                    e.container.add(i),
                    i.boundingSphere = misc.getBoundingSphere(i),
                    e._setShadow(i)
                } else
                    console.log("rockModel not founbd - name: ", t.name)
            }
            ))
        }
    }, {
        key: "_setTransforms",
        value: function(e, t) {
            var i = t.position
              , r = t.rotation
              , n = t.scale;
            e.position.set(i.x, i.z, -i.y).multiplyScalar(properties.gltfModelScale),
            e.rotation.set(r.x, r.z, r.y),
            e.scale.set(n.x, n.y, n.z).multiplyScalar(properties.gltfModelScale),
            e.updateMatrixWorld(!0)
        }
    }, {
        key: "_setShadow",
        value: function(e) {
            var t = "rock_a" === e.name ? 1.38467 : .785203
              , i = new PlaneGeometry(t,t)
              , r = "rock_a" === e.name ? this.shadowMaterialRockA : this.shadowMaterialRockB;
            r.uniforms.u_texture.value = "rock_a" === e.name ? this.shadowTextureRockA : this.shadowTextureRockB,
            r.uniforms.u_strength.value = .3;
            var n = new Mesh(i,r);
            n.rotation.x = -Math.PI / 2,
            n.position.y = .005,
            n.renderOrder = 1,
            n.matrixAutoUpdate = !1,
            n.updateMatrix(),
            e.add(n)
        }
    }, {
        key: "_show",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !0
        }
    }, {
        key: "_hide",
        value: function(e) {
            this.container.getObjectById(e.id).visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._show(i.object),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    var r = t.container.children[i];
                    railway._isObjectCollidingWithTrackPiece(r.boundingSphere, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.object.id === r.id
                    }
                    )) && (t._hide(r),
                    t.detectedCollisions.push({
                        object: r,
                        trackPiece: e
                    }))
                }, r = 0; r < this.container.children.length; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("rocks");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.rockAMaterial.uniforms.u_nightEffectColor.value.setStyle(e),
                t.rockBMaterial.uniforms.u_nightEffectColor.value.setStyle(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function() {
            this.mesh && (this.mesh.update(properties.camera),
            this.shadowMesh.update(properties.camera))
        }
    }]),
    e
}()
  , rocks = new Rocks
  , skyDomeVert = "#define GLSLIFY 1\nvarying vec2 v_uv;varying vec3 v_worldPosition;void main(){v_uv=uv;vec4 worldPosition=modelMatrix*vec4(position,1.0);v_worldPosition=worldPosition.xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"
  , skyDomeFrag = "#define GLSLIFY 1\nuniform vec3 u_topColor;uniform vec3 u_bottomColor;uniform float u_nigthModeActiveRatio;uniform vec3 u_nightEffectColorTop;uniform vec3 u_nightEffectColorBottom;uniform float u_offset;uniform float u_exponent;varying vec2 v_uv;varying vec3 v_worldPosition;void main(){float offset=normalize(v_worldPosition+u_offset).y;vec3 topColor=mix(u_topColor,u_nightEffectColorTop,max(0.0,u_nigthModeActiveRatio));vec3 bottomColor=mix(u_bottomColor,u_nightEffectColorBottom,max(0.0,u_nigthModeActiveRatio));vec4 color=vec4(mix(bottomColor,topColor,max(pow(max(offset,0.0),u_exponent),0.0)),1.0);float luma=dot(color.rgb,vec3(0.299,0.587,0.114));color.rgb=mix(vec3(luma),color.rgb,1.2);gl_FragColor=vec4(color.rgb,1.0);}"
  , skyStarsVert = "#define GLSLIFY 1\nattribute vec3 a_color;attribute float a_size;attribute float a_index;attribute float a_blinkSpeed;uniform float u_time;uniform float u_nigthModeActiveRatio;varying vec3 v_color;void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);gl_PointSize=a_size+(a_size*0.5)*sin(a_index+u_time*a_blinkSpeed);gl_Position=projectionMatrix*mvPosition;v_color=a_color;}"
  , skyStarsFrag = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform float u_nigthModeActiveRatio;varying vec3 v_color;void main(){vec3 color=texture2D(u_texture,gl_PointCoord).rgb*v_color;gl_FragColor=vec4(color,u_nigthModeActiveRatio);}"
  , skyTrailsVert = "#define GLSLIFY 1\n#define PI 3.1415926538\nattribute float r;attribute float a_instanceId;attribute vec3 a_instancePosition;attribute vec4 a_instanceOrient;attribute vec3 a_color;uniform vec3 u_spinAxis;uniform float u_radius;uniform float u_nigthModeActiveRatio;varying vec3 v_color;vec4 quatFromAxis(vec3 axis,float angle){float half_angle=angle*0.5;return vec4(axis*sin(half_angle),cos(half_angle));}vec3 qrotate(vec4 q,vec3 v){return v+2.0*cross(q.xyz,cross(q.xyz,v)+q.w*v);}vec4 hash41(float p){vec4 p4=fract(vec4(p)*vec4(.1031,.1030,.0973,.1099));p4+=dot(p4,p4.wzxy+33.33);return fract((p4.xxyz+p4.yzzw)*p4.zywx);}void main(){vec4 instanceRands=hash41(a_instanceId);vec3 pos=position;pos/=u_radius;pos+=a_instancePosition;float spinRatio=clamp(instanceRands.x*0.25+u_nigthModeActiveRatio*(1.0+instanceRands.y*0.25),0.0,1.0);float spinAngle=mix(pow(1.0-spinRatio,0.85),pow(1.0-spinRatio,1.25),1.0-r)*PI;vec4 q=quatFromAxis(u_spinAxis,spinAngle);pos.y+=5.0;pos=qrotate(q,pos);pos.y-=5.0;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.0);v_color=a_color;}"
  , skyTrailsFrag = "#define GLSLIFY 1\nuniform float u_nigthModeActiveRatio;varying vec3 v_color;void main(){gl_FragColor=vec4(v_color,u_nigthModeActiveRatio*0.5);}"
  , Sky = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "dome", null),
        _defineProperty2(this, "domeSize", 30),
        _defineProperty2(this, "stars", null),
        _defineProperty2(this, "starsTexture", null),
        _defineProperty2(this, "trails", null),
        _defineProperty2(this, "trailsRefGeometry", null),
        _defineProperty2(this, "colors", {
            day: {
                top: "#0071ff",
                bottom: "#CADEFF"
            },
            night: {
                top: "#6388ff",
                bottom: "#03193D"
            }
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.starsTexture = properties.loader.add(settings.TEXTURE_PATH + "star.jpg", {
                weight: 1,
                type: "texture"
            }).content,
            properties.loader.add(settings.MODEL_PATH + "star_tube.buf", {
                weight: 1,
                onLoad: function(t) {
                    e._createStarsAndTrails(t)
                }
            }),
            this._createDome()
        }
    }, {
        key: "init",
        value: function(e) {
            var t = this;
            if (e) {
                var i = e.addFolder("sky");
                i.addColor(this.colors.night, "top").onChange((function(e) {
                    t.dome.material.material.uniforms.u_nightEffectColorTop.value = new Color(e)
                }
                )).name("night col top"),
                i.addColor(this.colors.night, "bottom").onChange((function(e) {
                    t.dome.material.material.uniforms.u_nightEffectColorBottom.value = new Color(e)
                }
                )).name("night col bot"),
                i.add(this.dome.material.uniforms.u_exponent, "value", -5, 5, 1e-4).onChange((function(e) {
                    t.dome.material.uniforms.u_exponent.value = e
                }
                )).name("exponent"),
                i.add(this.dome.material.uniforms.u_offset, "value", -.3, 1, 1e-4).onChange((function(e) {
                    t.dome.material.uniforms.u_offset.value = e
                }
                )).name("offset"),
                i.open()
            }
        }
    }, {
        key: "_createDome",
        value: function() {
            var e = new SphereGeometry(this.domeSize,16,16)
              , t = new ShaderMaterial({
                uniforms: {
                    u_topColor: {
                        value: new Color(this.colors.day.top)
                    },
                    u_bottomColor: {
                        value: new Color(this.colors.day.bottom)
                    },
                    u_nightEffectColorTop: {
                        value: new Color(this.colors.night.top)
                    },
                    u_nightEffectColorBottom: {
                        value: new Color(this.colors.night.bottom)
                    },
                    u_offset: {
                        value: -.0614
                    },
                    u_exponent: {
                        value: 1.1733
                    },
                    u_nigthModeActiveRatio: {
                        value: 0
                    }
                },
                vertexShader: skyDomeVert,
                fragmentShader: fboHelper.precisionPrefix + skyDomeFrag,
                side: BackSide,
                fog: !1
            });
            this.dome = new Mesh(e,t),
            this.dome.frustumCulled = !1,
            this.dome.matrixAutoUpdate = !1,
            this.dome.updateMatrix(),
            this.container.add(this.dome)
        }
    }, {
        key: "_createStarsAndTrails",
        value: function(e) {
            var t = this.domeSize / 2
              , i = 1e3
              , r = new Float32Array(3e3)
              , n = new Float32Array(3e3)
              , a = new Float32Array(i)
              , o = new Float32Array(i)
              , s = new Float32Array(i)
              , l = new Vector3
              , h = new Color
              , c = new InstancedBufferGeometry;
            for (var p in e.attributes)
                c.setAttribute(p, e.attributes[p]);
            e.index && c.setIndex(e.getIndex()),
            c.setAttribute("a_instanceId", new InstancedBufferAttribute(a,1));
            for (var u = new Float32Array(3e3), d = new Float32Array(4e3), f = new Vector3(0,0,1).normalize(), m = new Quaternion, g = new Vector3, v = new Vector3, y = new Vector3, _ = new Vector3, b = new Vector3, x = new Vector3, w = new Matrix3, S = new Matrix4, T = 0; T < i; T++) {
                var k = MathUtils$1.randFloatSpread(Math.PI)
                  , E = MathUtils$1.randFloatSpread(Math.PI);
                l.x = t * Math.sin(k) * Math.cos(E),
                l.y = t * Math.cos(k),
                l.z = t * Math.sin(k) * Math.sin(E),
                l.toArray(r, 3 * T),
                h.set(16777215 * Math.random()),
                h.toArray(n, 3 * T),
                a[T] = T,
                o[T] = 10,
                s[T] = 4 + 2 * Math.random(),
                y.x = 1 * l.x,
                y.y = 1 * l.y,
                y.z = 1 * l.z,
                m.setFromAxisAngle(f, -.001),
                g.copy(y).applyQuaternion(m),
                m.setFromAxisAngle(f, .001),
                v.copy(y).applyQuaternion(m),
                x.copy(v).sub(g).normalize(),
                _.copy(y).normalize(),
                b.crossVectors(x, _).normalize(),
                w.set(_.x, _.y, _.z, b.x, b.y, b.z, x.x, x.y, x.z),
                S.makeRotationAxis(w),
                m.setFromRotationMatrix(S),
                y.toArray(u, 3 * T),
                m.toArray(d, 4 * T)
            }
            var M = new BufferGeometry;
            M.setAttribute("position", new BufferAttribute(r,3)),
            M.setAttribute("a_color", new BufferAttribute(n,3)),
            M.setAttribute("a_index", new BufferAttribute(a,1)),
            M.setAttribute("a_size", new BufferAttribute(o,1)),
            M.setAttribute("a_blinkSpeed", new BufferAttribute(s,1));
            var P = new ShaderMaterial({
                uniforms: {
                    u_time: {
                        value: 0
                    },
                    u_texture: {
                        value: this.starsTexture
                    },
                    u_nigthModeActiveRatio: {
                        value: 0
                    }
                },
                vertexShader: skyStarsVert,
                fragmentShader: skyStarsFrag,
                blending: AdditiveBlending,
                transparent: !0,
                depthWrite: !1
            });
            this.stars = new Points(M,P),
            this.stars.matrixAutoUpdate = !1,
            this.stars.updateMatrix(),
            this.container.add(this.stars),
            c.setAttribute("a_instancePosition", new InstancedBufferAttribute(u,3)),
            c.setAttribute("a_instanceOrient", new InstancedBufferAttribute(d,4)),
            c.setAttribute("a_color", new InstancedBufferAttribute(n,3));
            var C = new ShaderMaterial({
                uniforms: {
                    u_radius: {
                        value: 20
                    },
                    u_spinAxis: {
                        value: f
                    },
                    u_nigthModeActiveRatio: {
                        value: 0
                    }
                },
                vertexShader: skyTrailsVert,
                fragmentShader: skyTrailsFrag,
                blending: AdditiveBlending,
                transparent: !0,
                depthWrite: !1
            });
            this.trails = new InstancedMesh(c,C,i),
            this.trails.matrixAutoUpdate = !1,
            this.trails.updateMatrix(),
            this.container.add(this.trails)
        }
    }, {
        key: "update",
        value: function() {
            if (this.stars && this.trails) {
                var e = properties.sharedUniforms.u_nigthModeActiveRatio.value;
                this.dome.material.uniforms.u_nigthModeActiveRatio.value = this.stars.material.uniforms.u_nigthModeActiveRatio.value = this.trails.material.uniforms.u_nigthModeActiveRatio.value = e,
                this.trails.visible = e > 0 && e < .99,
                this.stars.material.uniforms.u_time.value = properties.time,
                this.stars.visible = e > .99
            }
        }
    }]),
    e
}()
  , sky = new Sky
  , Lightning = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.directionalLight = new DirectionalLight(16777215,0)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.directionalLight.position.set(0, 1.1, 0),
            this.directionalLight.castShadow = !0,
            this.directionalLight.shadow.camera.near = 0,
            this.directionalLight.shadow.camera.far = 1.11,
            this.directionalLight.shadow.camera.right = 1.1 * properties.trackAreaSize,
            this.directionalLight.shadow.camera.left = 1.1 * -properties.trackAreaSize,
            this.directionalLight.shadow.camera.top = properties.trackAreaSize,
            this.directionalLight.shadow.camera.bottom = -properties.trackAreaSize,
            this.directionalLight.shadow.mapSize.width = 1024,
            this.directionalLight.shadow.mapSize.height = 1024,
            this.directionalLight.shadow.bias = 5e-5
        }
    }, {
        key: "init",
        value: function() {
            this.container.add(this.directionalLight)
        }
    }]),
    e
}()
  , lightning = new Lightning
  , blur9VaryingVertexShader = "#define GLSLIFY 1\nattribute vec3 position;uniform vec2 u_delta;varying vec2 v_uv[9];void main(){vec2 uv=position.xy*0.5+0.5;v_uv[0]=uv;vec2 delta=u_delta;v_uv[1]=uv-delta;v_uv[2]=uv+delta;delta+=u_delta;v_uv[3]=uv-delta;v_uv[4]=uv+delta;delta+=u_delta;v_uv[5]=uv-delta;v_uv[6]=uv+delta;delta+=u_delta;v_uv[7]=uv-delta;v_uv[8]=uv+delta;gl_Position=vec4(position,1.0);}"
  , blur9VaryingFragmentShader = "#define GLSLIFY 1\nuniform sampler2D u_texture;varying vec2 v_uv[9];void main(){vec4 color=texture2D(u_texture,v_uv[0])*0.1633;color+=texture2D(u_texture,v_uv[1])*0.1531;color+=texture2D(u_texture,v_uv[2])*0.1531;color+=texture2D(u_texture,v_uv[3])*0.12245;color+=texture2D(u_texture,v_uv[4])*0.12245;color+=texture2D(u_texture,v_uv[5])*0.0918;color+=texture2D(u_texture,v_uv[6])*0.0918;color+=texture2D(u_texture,v_uv[7])*0.051;color+=texture2D(u_texture,v_uv[8])*0.051;gl_FragColor=color;}"
  , blur9FragmentShader = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform vec2 u_delta;varying vec2 v_uv;void main(){vec4 color=texture2D(u_texture,v_uv)*0.1633;vec2 delta=u_delta;color+=texture2D(u_texture,v_uv-delta)*0.1531;color+=texture2D(u_texture,v_uv+delta)*0.1531;delta+=u_delta;color+=texture2D(u_texture,v_uv-delta)*0.12245;color+=texture2D(u_texture,v_uv+delta)*0.12245;delta+=u_delta;color+=texture2D(u_texture,v_uv-delta)*0.0918;color+=texture2D(u_texture,v_uv+delta)*0.0918;delta+=u_delta;color+=texture2D(u_texture,v_uv-delta)*0.051;color+=texture2D(u_texture,v_uv+delta)*0.051;gl_FragColor=color;}"
  , Blur = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "material", null),
        _defineProperty2(this, "renderTarget", null)
    }
    return _createClass2(e, [{
        key: "getBlur9Material",
        value: function() {
            var e = fboHelper.MAX_VARYING_VECTORS > 8;
            return this.blur9Material || (this.blur9Material = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_delta: {
                        value: new Vector2
                    }
                },
                vertexShader: e ? fboHelper.precisionPrefix + blur9VaryingVertexShader : fboHelper.vertexShader,
                fragmentShader: fboHelper.precisionPrefix + (e ? blur9VaryingFragmentShader : blur9FragmentShader),
                blending: NoBlending
            })),
            this.blur9Material
        }
    }, {
        key: "blur",
        value: function(e, t, i, r, n, a) {
            var o = Math.ceil(i.width * t) || 0
              , s = Math.ceil(i.height * t) || 0;
            this.material || (this.material = this.getBlur9Material()),
            r || (this.renderTarget = this.renderTarget || fboHelper.createRenderTarget(1, 1),
            r = this.renderTarget),
            r.setSize(o, s),
            n ? a || n.setSize(i.width, i.height) : n = i,
            this.material.uniforms.u_texture.value = i.texture || i,
            this.material.uniforms.u_delta.value.set(e / o * .25, 0),
            fboHelper.render(this.material, r),
            this.material.uniforms.u_texture.value = r.texture || r,
            this.material.uniforms.u_delta.value.set(0, e / s * .25),
            fboHelper.render(this.material, n)
        }
    }]),
    e
}()
  , blur = new Blur
  , frag = "#define GLSLIFY 1\nuniform sampler2D u_texture;varying vec2 v_uv;void main(){float a=texture2D(u_texture,v_uv).a;gl_FragColor=vec4(a>0.9999 ? 1.0 :(1.0-a));}"
  , GroundShadow = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "_prevFrameIndex", -1),
        _defineProperty2(this, "_renderTarget", void 0),
        _defineProperty2(this, "_material", void 0),
        _defineProperty2(this, "sharedUniforms", {
            u_groundShadowTexture: {
                value: null
            },
            u_groundShadowWorldToUvScale: {
                value: new Vector2
            }
        })
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this._renderTarget = fboHelper.createRenderTarget(lightning.directionalLight.shadow.mapSize.width / 2, lightning.directionalLight.shadow.mapSize.height / 2, !0),
            this.sharedUniforms.u_groundShadowTexture.value = this._renderTarget.texture,
            this.sharedUniforms.u_groundShadowWorldToUvScale.value.set(1 / (lightning.directionalLight.shadow.camera.right - lightning.directionalLight.shadow.camera.left), 1 / (lightning.directionalLight.shadow.camera.top - lightning.directionalLight.shadow.camera.bottom)),
            this._material = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    }
                },
                vertexShader: fboHelper.vertexShader,
                fragmentShader: fboHelper.precisionPrefix + frag
            })
        }
    }, {
        key: "apply",
        value: function(e) {
            var t = e.material;
            Object.assign(t.uniforms, this.sharedUniforms),
            t.defines.NEEDS_GROUND_SHADOW = !0;
            var i = e.onBeforeRender;
            e.onBeforeRender = this._onBeforeRender.bind(this, e, i)
        }
    }, {
        key: "_onBeforeRender",
        value: function(e, t, i, r, n, a, o, s) {
            if (t.call(e, i, r, n, a, o, s),
            properties.camera === n && this._prevFrameIndex !== properties.frameIndex) {
                this._material.uniforms.u_texture.value = lightning.directionalLight.shadow.map.texture,
                this._prevFrameIndex = properties.frameIndex;
                var l = i.getRenderTarget();
                fboHelper.render(this._material, this._renderTarget),
                blur.blur(2, 1, this._renderTarget),
                i.setRenderTarget(l)
            }
        }
    }]),
    e
}()
  , groundShadow = new GroundShadow
  , Terrain = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "mesh", null),
        _defineProperty2(this, "sceneMesh", null),
        _defineProperty2(this, "waterMesh", null),
        _defineProperty2(this, "diffuseTextureGround", null),
        _defineProperty2(this, "alphaTextureGround", null),
        _defineProperty2(this, "diffuseTextureScene", null),
        _defineProperty2(this, "patternTexture", null),
        _defineProperty2(this, "materialGround", null),
        _defineProperty2(this, "materialScene", null),
        _defineProperty2(this, "materialWater", null),
        _defineProperty2(this, "lookDevGuiColor", {
            nightEffectColor: "#0009f2"
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.MODEL_PATH + "terrain.glb", {
                weight: 818,
                onLoad: function(t) {
                    return e._onModelLoaded(t)
                }
            }),
            this.diffuseTextureGround = properties.loader.add(settings.TEXTURE_PATH + "terrain/" + settings.QUALITY_PATH + "terrainGround_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 41 : 157 : properties.jpgwebp ? 28 : 57,
                type: "texture",
                flipY: !1
            }).content,
            this.diffuseTextureScene = properties.loader.add(settings.TEXTURE_PATH + "terrain/" + settings.QUALITY_PATH + "terrainScene_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 598 : 831 : properties.jpgwebp ? 258 : 320,
                type: "texture",
                flipY: !1
            }).content,
            this.alphaTextureGround = properties.loader.add(settings.TEXTURE_PATH + "terrain/" + settings.QUALITY_PATH + "terrainGround_alpha." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 7 : 23 : properties.jpgwebp ? 1 : 3,
                type: "texture",
                flipY: !1
            }).content,
            this.patternTexture = properties.loader.add(settings.TEXTURE_PATH + "terrain/" + settings.QUALITY_PATH + "pattern.png", {
                weight: properties.isHiresSetting ? 45 : 23,
                type: "texture",
                flipY: !1,
                minFilter: LinearMipMapLinearFilter,
                wrap: RepeatWrapping
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            this._setMaterials(),
            e && this._initLookDev(e)
        }
    }, {
        key: "_onModelLoaded",
        value: function(e) {
            this.mesh = e.scene || e.scenes[0],
            this.mesh.scale.multiplyScalar(properties.gltfModelScale),
            this.container.add(this.mesh)
        }
    }, {
        key: "_setMaterials",
        value: function() {
            var e = this;
            this.materialGround = new UberMaterial({
                texture: this.diffuseTextureGround,
                alphaTexture: this.alphaTextureGround,
                patternTexture: this.patternTexture,
                transparent: !0,
                hasGroundShadow: !0,
                hasOutOfBoundEffect: !0,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.materialGround.defines.IS_GROUND = !0,
            this.materialScene = new UberMaterial({
                texture: this.diffuseTextureScene,
                hasGroundShadow: !0,
                hasOutOfBoundEffect: !0,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.materialWater = new UberMaterial({
                texture: this.diffuseTextureScene,
                hasWaterEffect: !0,
                hasOutOfBoundEffect: !0,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),
            this.mesh.traverse((function(t) {
                t.isMesh && ("ground" === t.name ? (t.material = e.materialGround,
                groundShadow.apply(t)) : "scene" === t.name ? (t.material = e.materialScene,
                groundShadow.apply(t),
                e.sceneMesh = t) : "water" === t.name ? (t.material = e.materialWater,
                e.waterMesh = t) : console.log("[terrain] _setMaterials() - error with name of child:", t.name))
            }
            ))
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("terrain");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.materialGround.uniforms.u_nightEffectColor.value = new Color(e),
                t.materialScene.uniforms.u_nightEffectColor.value = new Color(e),
                t.materialWater.uniforms.u_nightEffectColor.value = new Color(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function(e) {
            this.waterMesh && (this.waterMesh.material.uniforms.u_waterTime.value += e)
        }
    }]),
    e
}()
  , terrain = new Terrain
  , _sphere = new Sphere
  , Trees = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.mesh = null,
        this.shadowMesh = null,
        this.model = null,
        this.diffuseTexture = null,
        this.shadowTexture = null,
        this.shadowMaterial = null,
        this.data = null,
        this.detectedCollisions = [],
        this.lookDevGuiColor = {
            nightEffectColor: "#0009f2"
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this
              , t = "".concat(settings.TEXTURE_PATH, "tree/").concat(settings.QUALITY_PATH);
            properties.loader.add(settings.DATA_PATH + "landscapeData.json", {
                weight: 6,
                type: "json",
                onLoad: function(t) {
                    e.data = t.trees || []
                }
            }),
            properties.loader.add("".concat(settings.MODEL_PATH, "tree.glb"), {
                weight: 3,
                onLoad: function(t) {
                    e.model = t.scene || t.scenes[0]
                }
            }),
            this.diffuseTexture = properties.loader.add(t + "tree_diffuse." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 8 : 18 : properties.jpgwebp ? 3 : 6,
                type: "texture",
                flipY: !1
            }).content,
            this.shadowTexture = properties.loader.add(t + "tree_shadow." + properties.jpgwebp, {
                weight: properties.isHiresSetting ? properties.jpgwebp ? 1 : 5 : properties.jpgwebp ? 1 : 2,
                type: "texture"
            }).content
        }
    }, {
        key: "init",
        value: function(e) {
            var t = []
              , i = [];
            this.data.forEach((function(e) {
                var r = new Object3D
                  , n = e.position;
                e.rotation;
                var a = e.scale;
                r.position.set(n.x, n.z, -n.y).multiplyScalar(properties.gltfModelScale),
                r.scale.set(a.x, a.y, a.z).multiplyScalar(properties.gltfModelScale),
                r.updateMatrix(),
                t.push(r);
                var o = new Object3D;
                o.rotation.x = -Math.PI / 2,
                o.position.y = .005,
                o.updateMatrix(),
                o.matrix.premultiply(r.matrix).decompose(o.position, o.quaternion, o.scale),
                i.push(o)
            }
            ));
            var r = this.model.children[0].geometry;
            r.computeBoundingSphere(),
            this.mesh = new TinyInstancedMesh(r,new UberMaterial({
                texture: this.diffuseTexture,
                needsBounce: !0,
                bounceMaxY: r.boundingBox.max.y,
                hasNightEffect: !0,
                nightEffectColor: this.lookDevGuiColor.nightEffectColor
            }),{
                objectList: t
            }),
            this.container.add(this.mesh),
            this.shadowMesh = new TinyInstancedMesh(new PlaneGeometry(1.59128,1.59128),new StaticShadowMaterial({
                texture: this.shadowTexture,
                strength: .125
            }),{
                objectList: i
            }),
            this.shadowMesh.renderOrder = 1,
            this.container.add(this.shadowMesh),
            e && this._initLookDev(e)
        }
    }, {
        key: "_showObjectByIndex",
        value: function(e) {
            this.mesh.objectList[e].visible = !0,
            this.shadowMesh.objectList[e].visible = !0
        }
    }, {
        key: "_hideObjectByInex",
        value: function(e) {
            this.mesh.objectList[e].visible = !1,
            this.shadowMesh.objectList[e].visible = !1
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            for (var t = this.detectedCollisions.length; t--; ) {
                var i = this.detectedCollisions[t];
                i.trackPiece.container.id === e.container.id && (this._showObjectByIndex(i.index),
                this.detectedCollisions.splice(t, 1))
            }
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            var t = this;
            if ("station" !== e.type)
                for (var i = function(i) {
                    t.mesh.setSphere(_sphere, i),
                    railway._isObjectCollidingWithTrackPiece(_sphere, e) && void 0 === t.detectedCollisions.find((function(e) {
                        return e.index === i
                    }
                    )) && (t._hideObjectByInex(i),
                    t.detectedCollisions.push({
                        index: i,
                        trackPiece: e
                    }))
                }, r = 0; r < this.mesh.totalCount; r++)
                    i(r)
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = this
              , i = e.addFolder("trees");
            i.addColor(this.lookDevGuiColor, "nightEffectColor").onChange((function(e) {
                t.mesh.material.uniforms.u_nightEffectColor.value = new Color(e)
            }
            )).name("night color"),
            i.open()
        }
    }, {
        key: "update",
        value: function() {
            this.mesh && (this.mesh.update(properties.camera),
            this.shadowMesh.update(properties.camera))
        }
    }]),
    e
}()
  , trees = new Trees
  , WaterfallSplashes = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "splash1", void 0),
        _defineProperty2(this, "splash2", void 0),
        _defineProperty2(this, "THRESHOLDS", [0, 1080, 2200, 3309, 4434, 5519, 6584, 7699, 8819])
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            properties.loader.add(settings.MODEL_PATH + "waterfall/WATERFALL_SPLASHES.buf", {
                weight: 100,
                onLoad: function(t) {
                    e._onModelLoaded(t)
                }
            })
        }
    }, {
        key: "_onModelLoaded",
        value: function(e) {
            var t, i = new UberMaterial({
                color: new Color("#fefefe")
            });
            (t = this.splash1 = new Mesh(e,i)).position.set(-16.3, 0, -19).multiplyScalar(.1),
            t.rotation.y = Math.PI / 180 * 42.2695,
            t.scale.set(.1, .12, .1),
            this.container.add(t);
            var r = new BufferGeometry;
            r.copy(e),
            (t = this.splash2 = new Mesh(r,i)).position.set(12.8, 0, -20.5708).multiplyScalar(.1),
            t.rotation.y = Math.PI / 180 * -42.5015,
            t.scale.set(.1, .1, .1),
            this.container.add(t)
        }
    }, {
        key: "init",
        value: function() {}
    }, {
        key: "update",
        value: function(e) {
            var t, i;
            this.splash1 && (t = this.splash1,
            i = Math.floor(6 * properties.time) % (this.THRESHOLDS.length - 1),
            t.geometry.setDrawRange(3 * this.THRESHOLDS[i], 3 * (this.THRESHOLDS[i + 1] - this.THRESHOLDS[i])),
            t = this.splash2,
            i = Math.floor(6 * properties.time + 4) % (this.THRESHOLDS.length - 1),
            t.geometry.setDrawRange(3 * this.THRESHOLDS[i], 3 * (this.THRESHOLDS[i + 1] - this.THRESHOLDS[i])))
        }
    }]),
    e
}()
  , waterfallSplashes = new WaterfallSplashes
  , Landscape = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "envData", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            animals.preInit(),
            this.container.add(animals.container),
            balloon.preInit(),
            this.container.add(balloon.container),
            clouds.preInit(),
            this.container.add(clouds.container),
            flowers.preInit(),
            this.container.add(flowers.container),
            fireflies.preInit(),
            this.container.add(fireflies.container),
            grass.preInit(),
            this.container.add(grass.container),
            grassStraws.preInit(),
            this.container.add(grassStraws.container),
            mountains.preInit(),
            this.container.add(mountains.container),
            planeAndUfo.preInit(),
            this.container.add(planeAndUfo.container),
            rocks.preInit(),
            this.container.add(rocks.container),
            sky.preInit(),
            this.container.add(sky.container),
            terrain.preInit(),
            this.container.add(terrain.container),
            trees.preInit(),
            this.container.add(trees.container),
            waterfallSplashes.preInit(),
            this.container.add(waterfallSplashes.container)
        }
    }, {
        key: "init",
        value: function(e) {
            animals.init(),
            balloon.init(),
            clouds.init(e),
            flowers.init(e),
            fireflies.init(e),
            grass.init(e),
            grassStraws.init(),
            mountains.init(e),
            planeAndUfo.init(),
            rocks.init(e),
            sky.init(e),
            terrain.init(e),
            trees.init(e),
            waterfallSplashes.init()
        }
    }, {
        key: "testCollisionAgainstAllTrackPieces",
        value: function() {
            var e = this;
            railway.trackSequence.forEach((function(t) {
                e._onTrackPieceAdded(t)
            }
            ))
        }
    }, {
        key: "_onTrackPieceRemoved",
        value: function(e) {
            animals._onTrackPieceRemoved(e),
            flowers._onTrackPieceRemoved(e),
            fireflies._onTrackPieceRemoved(e),
            grass._onTrackPieceRemoved(e),
            mountains._onTrackPieceRemoved(e),
            rocks._onTrackPieceRemoved(e),
            trees._onTrackPieceRemoved(e)
        }
    }, {
        key: "_onTrackPieceAdded",
        value: function(e) {
            animals._onTrackPieceAdded(e),
            flowers._onTrackPieceAdded(e),
            fireflies._onTrackPieceAdded(e),
            grass._onTrackPieceAdded(e),
            mountains._onTrackPieceAdded(e),
            rocks._onTrackPieceAdded(e),
            trees._onTrackPieceAdded(e)
        }
    }, {
        key: "update",
        value: function(e) {
            animals.update(e),
            balloon.update(e),
            clouds.update(e),
            flowers.update(),
            fireflies.update(e),
            grass.update(e),
            planeAndUfo.update(e),
            rocks.update(),
            sky.update(),
            terrain.update(e),
            trees.update(),
            waterfallSplashes.update(e)
        }
    }]),
    e
}()
  , landscape = new Landscape
  , trainModelPath = "".concat(settings.MODEL_PATH, "train/")
  , trainTexturePath = "".concat(settings.TEXTURE_PATH, "train/")
  , qualityPath = "".concat(settings.QUALITY_PATH)
  , trainData = [{
    isCab: !0,
    model: {
        src: "".concat(trainModelPath, "cab.buf"),
        weight: 91
    },
    textures: [{
        type: "diffuse",
        src: "".concat(trainTexturePath, "cab/").concat(qualityPath, "cab_diffuse.") + properties.jpgwebp,
        weight: properties.isHiresSetting ? properties.jpgwebp ? 37 : 70 : properties.jpgwebp ? 14 : 25
    }],
    distanceFromRearWheelToFrontWheel: .062
}, {
    model: {
        src: "".concat(trainModelPath, "carriageWithLog.buf"),
        weight: 53
    },
    textures: [{
        type: "diffuse",
        src: "".concat(trainTexturePath, "carriageWithLog/").concat(qualityPath, "carriageWithLog_diffuse.") + properties.jpgwebp,
        weight: properties.isHiresSetting ? properties.jpgwebp ? 48 : 98 : properties.jpgwebp ? 19 : 36
    }],
    distanceFromRearWheelToFrontWheel: .057
}, {
    model: {
        src: "".concat(trainModelPath, "carriageWithLog.buf"),
        weight: 53
    },
    textures: [{
        type: "diffuse",
        src: "".concat(trainTexturePath, "carriageWithLog/").concat(qualityPath, "carriageWithLog_diffuse.") + properties.jpgwebp,
        weight: properties.isHiresSetting ? properties.jpgwebp ? 48 : 98 : properties.jpgwebp ? 19 : 36
    }],
    distanceFromRearWheelToFrontWheel: .057
}]
  , Connector = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "mesh", new Mesh)
    }
    return _createClass2(e, [{
        key: "init",
        value: function(e) {
            var t = e.getSize(new Vector3)
              , i = new BoxGeometry(.0025,.0025,.025)
              , r = new UberMaterial({
                color: new Color("#6b4f41"),
                hasNightEffect: !0
            });
            r.transparent = !0,
            this.mesh = new Mesh(i,r),
            this.mesh.name = "connector",
            this.mesh.position.y = t.y / 2,
            this.mesh.position.z = t.z - .0075,
            this.mesh.receiveShadow = !0,
            this.mesh.castShadow = !0,
            this.container.add(this.mesh)
        }
    }]),
    e
}()
  , NightMode = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.isTransitioning = !1,
        this.isActivated = null,
        this.activeRatio = 0,
        this.activeMode = null,
        this.transitionStartTime = null,
        this.transitionSpeedSeconds = 0,
        this.cricketAudio = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {}
    }, {
        key: "init",
        value: function() {
            this.isActivated = "N" === urlManager.dayCode,
            this.activeRatio = this.isActivated ? 1 : 0,
            this.activeMode = urlManager.dayCode
        }
    }, {
        key: "_toggleNightMode",
        value: function() {
            this.isTransitioning || "N" === this.activeMode || (urlManager.setDayCode("N"),
            this.activeMode = "N",
            this.isActivated = !0,
            this._startTransition(),
            document.body.classList.add("night-time"),
            this.cricketAudio = soundAudio.items.cricket,
            this.cricketAudio.play())
        }
    }, {
        key: "_toggleDayMode",
        value: function() {
            this.isTransitioning || "D" === this.activeMode || (urlManager.setDayCode("D"),
            this.activeMode = "D",
            this.isActivated = !1,
            this._startTransition(),
            document.body.classList.remove("night-time"))
        }
    }, {
        key: "_startTransition",
        value: function() {
            this.isTransitioning = !0,
            this.transitionSpeedSeconds = 1,
            this.transitionStartTime = properties.time
        }
    }, {
        key: "update",
        value: function(e) {
            this.isTransitioning && (this.activeRatio = math.saturate(this.activeRatio + (!0 === this.isActivated ? 1 : -1) * (e / this.transitionSpeedSeconds)),
            this.cricketAudio && (this.cricketAudio.volume = this.activeRatio),
            this.transitionRatio = (properties.time - this.transitionStartTime) / this.transitionSpeedSeconds,
            this.activeRatio >= 1 ? (this.activeRatio = 1,
            this.isTransitioning = !1) : this.activeRatio <= 0 && (this.activeRatio = 0,
            this.isTransitioning = !1),
            properties.vignetteTo = Math.max(1.4, 1.6 - this.activeRatio),
            properties.sharedUniforms.u_nigthModeActiveRatio.value = this.activeRatio)
        }
    }]),
    e
}()
  , nightMode = new NightMode
  , Headlight = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "meshLightbeam", null),
        _defineProperty2(this, "meshLightbulb", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {}
    }, {
        key: "init",
        value: function() {
            var e = new UberMaterial({
                isLightbeam: !0,
                lightbeamScale: .125,
                hasNightEffect: !0,
                opacity: 0
            });
            e.side = DoubleSide,
            e.depthWrite = !1,
            e.transparent = !0,
            e.blending = AdditiveBlending;
            var t = new ConeGeometry(.25,1.25,16,16,!0);
            t.translate(0, .625, 0),
            this.meshLightbeam = new Mesh(t,e),
            this.meshLightbeam.scale.set(.05, .05, .05),
            this.meshLightbeam.rotation.x = -Math.PI / 2,
            this.meshLightbeam.position.set(0, .03, .1),
            this.meshLightbeam.renderOrder = 1,
            window.meshLightbeam = this.meshLightbeam;
            var i = new UberMaterial({
                isLightbeam: !0,
                hasNightEffect: !0,
                lightBeamStrength: 1,
                lightbeamScale: .125
            });
            i.side = DoubleSide,
            i.depthWrite = !1,
            i.transparent = !0,
            i.blending = AdditiveBlending;
            var r = new SphereGeometry(.0028,12,12);
            this.meshLightbulb = new Mesh(r,i),
            this.meshLightbulb.position.set(0, .03, .057),
            this.meshLightbulb.renderOrder = 2,
            window.meshLightbulb = this.meshLightbulb,
            this.container.add(this.meshLightbeam),
            this.container.add(this.meshLightbulb)
        }
    }, {
        key: "update",
        value: function() {
            this.container.visible = nightMode.activeRatio > 0
        }
    }]),
    e
}()
  , headlight = new Headlight
  , _v1$4 = new Vector3
  , _v2$4 = new Vector3
  , Car = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "DEBUG", !1),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "_brownianMotion", new BrownianMotion),
        _defineProperty2(this, "trackFrontPosition", new Vector3),
        _defineProperty2(this, "trackRearPosition", new Vector3),
        _defineProperty2(this, "frontPosition", new Vector3),
        _defineProperty2(this, "rearPosition", new Vector3),
        _defineProperty2(this, "boundingBox", null),
        _defineProperty2(this, "boundingBoxSize", null),
        _defineProperty2(this, "mesh", new Mesh),
        _defineProperty2(this, "textures", {}),
        _defineProperty2(this, "externalData", {}),
        _defineProperty2(this, "dimensions", {}),
        _defineProperty2(this, "scale", 1),
        _defineProperty2(this, "speed", 0),
        _defineProperty2(this, "animate", {
            state: !1,
            time: 0,
            duration: 1,
            delay: 0
        }),
        _defineProperty2(this, "config", {
            distanceFromRearWheelToFrontWheel: 0
        }),
        _defineProperty2(this, "connector", null),
        _defineProperty2(this, "visibility", 1)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            var t = this;
            Object.assign(this.config, e),
            properties.loader.add(e.model.src, {
                weight: e.model.weight,
                onLoad: function(e) {
                    return t._onModelLoaded(e)
                }
            }),
            e.textures.forEach((function(e) {
                t.textures[e.type] = properties.loader.add(e.src, {
                    weight: e.weight,
                    type: "texture",
                    wrap: RepeatWrapping
                }).content
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            this.config.isCab ? (headlight.init(),
            this.mesh.add(headlight.container)) : (this.connector = new Connector,
            this.connector.init(this.boundingBox),
            this.mesh.add(this.connector.container))
        }
    }, {
        key: "_onModelLoaded",
        value: function(e) {
            var t = new UberMaterial({
                texture: this.textures.diffuse,
                hasNightEffect: !0
            });
            t.transparent = !0,
            t.side = DoubleSide,
            this.mesh = new Mesh(e,t),
            this._computeDimensions(),
            this.DEBUG && (this.debugCar = new Mesh(new BoxGeometry(1,1,this.dimensions.distanceFromRearWheelToFrontWheel),new MeshNormalMaterial({
                transparent: !0,
                wireframe: !0,
                opacity: .5,
                fog: !1
            })),
            this.container.add(this.debugCar)),
            this.mesh.scale.setScalar(this.scale),
            this.mesh.castShadow = !0,
            this.mesh.receiveShadow = !0,
            this.container.add(this.mesh)
        }
    }, {
        key: "_computeDimensions",
        value: function() {
            var e = this.mesh.geometry;
            e.computeBoundingBox(),
            this.boundingBox = e.boundingBox,
            this.boundingBoxSize = this.boundingBox.getSize(_v1$4);
            var t = Math.abs(this.boundingBox.min.z)
              , i = this.boundingBoxSize.z
              , r = i - t - this.config.distanceFromRearWheelToFrontWheel;
            Object.assign(this.dimensions, {
                distanceFromRearWheelToBack: t * this.scale,
                distanceFromFrontWheelToFront: r * this.scale,
                distanceFromRearWheelToFrontWheel: this.config.distanceFromRearWheelToFrontWheel * this.scale,
                totalLength: i * this.scale
            })
        }
    }, {
        key: "animateIn",
        value: function(e) {
            this.animate.delay = e,
            this.animate.time -= this.animate.delay,
            this.animate.state = !0
        }
    }, {
        key: "animateRaf",
        value: function(e) {
            if (headlight.update(),
            this.animate.state) {
                this.animate.time += 2 * e,
                this.mesh.position.y = math.lerp(.015, 0, ease.bounceOut(this.animate.time));
                var t = math.lerp(0, 1, ease.cubicIn(this.animate.time));
                this.mesh.visible = t > .05,
                this.mesh.material.uniforms.u_opacity.value = t,
                this.connector && (this.connector.mesh.material.uniforms.u_opacity.value = t),
                this.animate.time >= this.animate.duration && (this.animate.state = !1,
                this.animate.time = 0)
            }
        }
    }, {
        key: "update",
        value: function(e, t, i, r, n) {
            this.trackRearPosition.copy(t),
            this.trackFrontPosition.copy(i),
            _v2$4.set(0, 1, 0).applyQuaternion(r),
            this.container.up.set(0, 1, 0).applyQuaternion(n).lerp(_v2$4, .5).normalize(),
            _v2$4.copy(this.container.up).multiplyScalar(.027),
            this.rearPosition.copy(t).add(_v2$4),
            this.frontPosition.copy(i).add(_v2$4),
            this.container.position.copy(this.trackRearPosition),
            this.container.lookAt(this.trackFrontPosition),
            this._brownianMotion.positionAmplitude = 5e-5 * this.speed,
            this._brownianMotion.rotationAmplitude = .055 * this.speed,
            this._brownianMotion.positionFrequency = 25 * this.speed,
            this._brownianMotion.rotationFrequency = 25 * this.speed,
            this._brownianMotion.update(e),
            this.container.updateMatrix(),
            this.container.matrix.multiply(this._brownianMotion.matrix),
            this.container.matrix.decompose(this.container.position, this.container.quaternion, this.container.scale)
        }
    }]),
    e
}()
  , Train = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "cars", []),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "reverse", !1),
        _defineProperty2(this, "progress", 0),
        _defineProperty2(this, "trainMovingAudioItem", null),
        _defineProperty2(this, "reachedEndOfTrack", !1),
        _defineProperty2(this, "speed", {
            value: 0,
            target: .25,
            lerpTo: 0,
            lerpFrom: 0,
            duration: 1,
            startTime: 0,
            multiplier: 1
        })
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e, t, i) {
            var r = this;
            this.getPositionFn = e,
            this.getTrackProgress = t,
            this.getTotalDistanceFn = i;
            for (var n = 0; n < trainData.length; n++) {
                var a = trainData[n]
                  , o = new Car;
                o.preInit(a),
                this.cars.push(o),
                this.container.add(o.container)
            }
            this.cars.reverse(),
            this.trainMovingAudioItem = soundAudio.items["train-moving"],
            this.trainMovingAudioItem.onInitialized.add((function() {
                var e = r.trainMovingAudioItem.audioObject;
                e.loopStart = .048,
                e.loopEnd = 5.552,
                e.setDistanceModel("exponential")
            }
            )),
            this._setupEventListeners()
        }
    }, {
        key: "init",
        value: function() {
            for (var e = 0, t = 0; t < trainData.length; t++) {
                var i = this.cars[t];
                i.externalData.progress = e + i.dimensions.distanceFromRearWheelToBack,
                i.externalData.initialProgress = i.externalData.progress,
                e += t !== trainData - 1 ? i.dimensions.totalLength + .01 * i.scale : i.dimensions.totalLength,
                i.externalData.rearPositionCache = new Vector3,
                i.externalData.frontPositionCache = new Vector3,
                i.externalData.rearQuaternionCache = new Quaternion,
                i.externalData.frontQuaternionCache = new Quaternion,
                i.speed = this.speed.value,
                i.init()
            }
            this._getCabCar().mesh.add(this.trainMovingAudioItem.container),
            this.totalTrainLength = e,
            this.isInitialized = !0
        }
    }, {
        key: "_getCabCar",
        value: function() {
            return this.cars[this.cars.length - 1]
        }
    }, {
        key: "_getTrailingCar",
        value: function() {
            return this.cars[0]
        }
    }, {
        key: "_setupEventListeners",
        value: function() {
            var e = this;
            window.addEventListener("keyup", (function(t) {
                " " === t.key && (0 === e.speed.value ? (e._start(),
                player.play()) : (e._stop(),
                player.pause())),
                "r" === t.key ? e.reverse = !e.reverse : "ArrowLeft" !== t.key && "ArrowRight" !== t.key || (e.speed.multiplier = math.clamp(e.speed.multiplier + .25, 1, 12))
            }
            ))
        }
    }, {
        key: "cachePotentialCarPositions",
        value: function(e, t) {
            var i = this.getTrackProgress(t)
              , r = this.getTrackProgress(t + e.dimensions.distanceFromRearWheelToFrontWheel)
              , n = this.getPositionFn(i);
            if (!n)
                return !1;
            e.externalData.rearPositionCache.copy(n),
            e.externalData.rearQuaternionCache.copy(n.quaternion);
            var a = this.getPositionFn(r);
            return !!a && (e.externalData.frontPositionCache.copy(a),
            e.externalData.frontQuaternionCache.copy(a.quaternion),
            e.externalData.progressCache = i,
            !0)
        }
    }, {
        key: "setTrainToStartOrEnd",
        value: function() {
            var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]
              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
              , i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2]
              , r = new Array(this.cars.length).fill(!1);
            if (e)
                for (var n = this.cars.length - 1; n >= 0; n--) {
                    var a = this.cars[n]
                      , o = this.getTotalDistanceFn() - this.totalTrainLength + a.externalData.initialProgress + this._getCabCar().dimensions.distanceFromFrontWheelToFront + .006 - t;
                    r[n] = this.cachePotentialCarPositions(a, o)
                }
            else
                for (var s = 0; s < this.cars.length; s++) {
                    var l = this.cars[s];
                    i && l.animateIn(s / 10);
                    var h = l.externalData.initialProgress - this.cars[0].dimensions.distanceFromRearWheelToBack + t;
                    r[s] = this.cachePotentialCarPositions(l, h)
                }
            var c = r.every((function(e) {
                return e
            }
            ));
            c ? (this._updateProgress(0, !0),
            this._stop(!0)) : properties.isInDevMode && console.warn("Critical error, this should never happen.")
        }
    }, {
        key: "_syncSpeed",
        value: function() {
            var e = this;
            this.cars.forEach((function(t) {
                t.speed = e.speed.value
            }
            ))
        }
    }, {
        key: "_stop",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0];
            e ? (this.speed.value = 0,
            this.speed.lerpTo = 0,
            this.speed.lerpFrom = 0) : (this.speed.lerpFrom = this.speed.value,
            this.speed.lerpTo = 0,
            this.speed.startTime = properties.time)
        }
    }, {
        key: "_start",
        value: function() {
            this.speed.lerpFrom = this.speed.value,
            this.speed.lerpTo = this.speed.target,
            this.speed.startTime = properties.time,
            this.reachedEndOfTrack = !1
        }
    }, {
        key: "_computeProgress",
        value: function() {
            var e = this._getTrailingCar()
              , t = this.getTotalDistanceFn() - this.totalTrainLength;
            this.progress = e.externalData.progress / t
        }
    }, {
        key: "_updateProgress",
        value: function(e, t) {
            var i = this
              , r = Math.min((properties.time - this.speed.startTime) / this.speed.duration, 1);
            this.speed.value = math.lerp(this.speed.lerpFrom, this.speed.lerpTo, ease.quadInOut(r)) * this.speed.multiplier,
            this.speed.multiplier = math.clamp(this.speed.multiplier - 2 * e, 1, 12),
            (t || 0 !== this.speed.value) && (this.cars.forEach((function(t, r) {
                t.update(e, t.externalData.rearPositionCache, t.externalData.frontPositionCache, t.externalData.rearQuaternionCache, t.externalData.frontQuaternionCache),
                t.externalData.progress = t.externalData.progressCache,
                t.speed = i.speed.value,
                2 === r && properties.trainPosition.copy(t.externalData.frontPositionCache)
            }
            )),
            this._computeProgress())
        }
    }, {
        key: "_updateSound",
        value: function() {
            if (this.trainMovingAudioItem.hasInitialized) {
                var e = this.trainMovingAudioItem.audioObject;
                e.setPlaybackRate(this.speed.value + .5),
                this.speed.value < 1e-4 && this.speed.value > -1e-4 ? e.isPlaying && e.stop() : e.isPlaying || e.play()
            }
        }
    }, {
        key: "update",
        value: function(e) {
            var t = this
              , i = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]
              , r = this.cars.every((function(i) {
                var r = i.externalData.progress + t.speed.value * e * (t.reverse ? -1 : 1);
                return t.cachePotentialCarPositions(i, r)
            }
            ));
            r ? this._updateProgress(e, i) : (this.reachedEndOfTrack = !0,
            this.setTrainToStartOrEnd(!this.reverse),
            player.onTrainReachedEndOfTrack()),
            this._updateSound(),
            this.container.visible = !("firstPerson" === cameraControls$1._cameraMode && cameraControls$1._lerpRatio > .8),
            this.cars.forEach((function(t) {
                return t.animateRaf(e)
            }
            ))
        }
    }]),
    e
}()
  , train = new Train
  , SpriteAnimationPlayer = function() {
    function e(t) {
        var i = t.jsonSheets
          , r = t.spriteSheets
          , n = t.imgContainer;
        t.fps,
        _classCallCheck2(this, e),
        this.jsonSheets = i,
        this.spriteSheets = r,
        this.isHitting = !1,
        this.isPlaying = !1,
        this.playPause = {
            active: {
                json: this.jsonSheets[0],
                sprite: this.spriteSheets[0]
            },
            deactive: {
                json: this.jsonSheets[1],
                sprite: this.spriteSheets[1]
            }
        },
        this.pausePlay = {
            active: {
                json: this.jsonSheets[2],
                sprite: this.spriteSheets[2]
            },
            deactive: {
                json: this.jsonSheets[3],
                sprite: this.spriteSheets[3]
            }
        },
        this.imgContainer = n,
        this.canvas = null,
        this.ctx = null,
        this.bcr = null,
        this.currentJson = null,
        this.currentSprite = null,
        this.currentFrame = 0,
        this.offsetX = 0,
        this.offsetY = 0,
        this.previousFrame = 0,
        this.time = 0,
        this.fps = 60,
        this.isAnimating = !1
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this.totalSprites = 0,
            this.currentJson = this.playPause.active.json,
            this.currentSprite = this.playPause.active.sprite,
            this.totalSprites = this.currentJson.frames.length
        }
    }, {
        key: "createCanvas",
        value: function(e) {
            this.bcr = e.getBoundingClientRect(),
            this.canvas = document.createElement("canvas"),
            this.ctx = this.canvas.getContext("2d"),
            e.style.opacity = 0,
            this.canvas.style.position = "absolute",
            this.canvas.style.width = this.bcr.width + "px",
            this.canvas.style.height = this.bcr.height + "px";
            var t = this.currentJson.frames[0].spriteSourceSize;
            this.canvas.width = t.w,
            this.canvas.height = t.h,
            e.parentNode.appendChild(this.canvas),
            this.createEvents(),
            this.currentFrame = this.totalSprites,
            this.drawSprite()
        }
    }, {
        key: "createEvents",
        value: function() {
            this.imgContainer.addEventListener("pointerenter", this.onPointerOverCanvas)
        }
    }, {
        key: "drawSprite",
        value: function() {
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            var e = this.currentJson.frames[this.currentFrame % this.totalSprites];
            this.ctx.drawImage(this.currentSprite, e.frame.x, e.frame.y, e.frame.w, e.frame.h, e.spriteSourceSize.x, e.spriteSourceSize.y, e.spriteSourceSize.w, e.spriteSourceSize.h)
        }
    }, {
        key: "resetTrain",
        value: function() {
            (this.isHitting || this.isPlaying) && (this.isHitting ? (this.isHitting = !1,
            this.time = 0,
            this.currentJson = this.pausePlay.deactive.json,
            this.currentSprite = this.pausePlay.deactive.sprite,
            this.isAnimating = !0) : (this.time = 0,
            this.currentJson = this.playPause.deactive.json,
            this.currentSprite = this.playPause.deactive.sprite,
            this.isAnimating = !0))
        }
    }, {
        key: "updateSprite",
        value: function(e) {
            if (this.isAnimating && (this.previousFrame = this.currentFrame,
            this.time += e,
            this.currentFrame = Math.floor(this.time * this.fps),
            this.currentFrame !== this.previousFrame && this.drawSprite(),
            this.currentFrame >= this.totalSprites - 1))
                return this.reset()
        }
    }, {
        key: "pause",
        value: function() {
            this.isHitting || (this.time = 0,
            this.isPlaying = !1,
            this.currentJson = this.playPause.deactive.json,
            this.currentSprite = this.playPause.deactive.sprite,
            this.isAnimating = !0)
        }
    }, {
        key: "play",
        value: function() {
            this.isHitting || (this.isPlaying = !0,
            this.time = 0,
            this.currentJson = this.playPause.active.json,
            this.currentSprite = this.playPause.active.sprite,
            this.isAnimating = !0)
        }
    }, {
        key: "trainHitEnd",
        value: function() {
            this.isHitting || (this.isHitting = !0,
            this.isPlaying = !1,
            this.time = 0,
            this.currentJson = this.pausePlay.active.json,
            this.currentSprite = this.pausePlay.active.sprite,
            this.isAnimating = !0)
        }
    }, {
        key: "reset",
        value: function() {
            this.isPlaying = !1,
            this.isAnimating = !1,
            this.currentFrame = this.totalSprites,
            this.time = 0
        }
    }]),
    e
}()
  , Player = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elResetBtn = null,
        this.elResetBtnImgActive = null,
        this.elResetBtnImgDeactive = null,
        this.isPlaying = !1,
        this.isReseted = !0,
        this.iconSpriteSheets = [],
        this.iconJsonSheets = [],
        this.playBtnSpriteAnimation = null,
        this.trainReachedEndOfTrack = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("component--player"),
            this.elPlayPauseBtn = document.getElementById("player-playPause-btn"),
            this.elPlayPauseBtnImg = this.elPlayPauseBtn.querySelector("img"),
            this.elResetBtn = document.getElementById("player-reset-btn"),
            this.elResetBtnImgActive = this.elResetBtn.querySelectorAll("img")[0],
            this.elResetBtnImgDeactive = this.elResetBtn.querySelectorAll("img")[1],
            ["player/play-pause/playPauseActive", "player/play-pause/playPauseDeactive", "player/pause-play/pausePlayActive", "player/pause-play/pausePlayDeactive"].forEach((function(t, i) {
                properties.loader.add("".concat(settings.IMAGE_PATH + t, ".json"), {
                    weight: 10,
                    onLoad: function(t) {
                        e.iconJsonSheets[i] = t
                    }
                }),
                e.iconSpriteSheets[i] = properties.loader.add("".concat(settings.IMAGE_PATH + t, ".png"), {
                    weight: 100,
                    type: "image",
                    flipY: !1
                }).content
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elPlayPauseBtn.addEventListener("pointerdown", (function() {
                return e.onPlayPauseBtnClick({
                    audio: !0
                })
            }
            )),
            this.elResetBtn.addEventListener("pointerdown", (function(t) {
                return e.onResetBtnClick(t)
            }
            )),
            window.addEventListener("pointerup", (function(t) {
                return e.onResetBtnUp(t)
            }
            )),
            window.addEventListener("pointerup", (function(t) {
                return e.onPlayBtnUp(t)
            }
            )),
            this.playBtnSpriteAnimation = new SpriteAnimationPlayer({
                jsonSheets: this.iconJsonSheets,
                spriteSheets: this.iconSpriteSheets,
                imgContainer: this.elPlayPauseBtn
            }),
            this.playBtnSpriteAnimation.init()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.playBtnSpriteAnimation.createCanvas(this.elPlayPauseBtnImg),
            this.elContainer.classList.add("animated")
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "onResetBtnClick",
        value: function() {
            this.isReseted || (this.playBtnSpriteAnimation.trainHitEnd(),
            this.disableResetBtn(),
            this.elResetBtn.classList.add("pressed"),
            this.enablePlayBtn(),
            train.setTrainToStartOrEnd(!1, .08, !0),
            this.trainReachedEndOfTrack = !1)
        }
    }, {
        key: "onPlayPauseBtnClick",
        value: function(e) {
            var t = e.audio
              , i = e.automatic;
            this.playBtnSpriteAnimation.reset(),
            i || this.elPlayPauseBtn.classList.add("pressed"),
            this.isPlaying ? this.pause() : this.trainReachedEndOfTrack || (this.play(),
            t && soundAudio.playSound("train-start"))
        }
    }, {
        key: "onPlayBtnUp",
        value: function() {
            this.elPlayPauseBtn.classList.remove("pressed")
        }
    }, {
        key: "onResetBtnUp",
        value: function() {
            this.elResetBtn.classList.remove("pressed")
        }
    }, {
        key: "pause",
        value: function() {
            train._stop(),
            this.isPlaying = !1,
            this.playBtnSpriteAnimation.pause()
        }
    }, {
        key: "play",
        value: function() {
            this.isReseted && this.enableResetBtn(),
            train._start(),
            this.isPlaying = !0,
            this.playBtnSpriteAnimation.play()
        }
    }, {
        key: "enablePlayBtn",
        value: function() {
            this.isPlaying = !1,
            this.playBtnSpriteAnimation.play(),
            this.playBtnSpriteAnimation.resetTrain()
        }
    }, {
        key: "enableResetBtn",
        value: function() {
            this.isReseted = !1,
            this.elResetBtn.classList.remove("wiggle-animation-reset"),
            this.elResetBtn.offsetWidth,
            this.elResetBtn.classList.add("wiggle-animation-play")
        }
    }, {
        key: "disableResetBtn",
        value: function() {
            this.isReseted = !0,
            this.isPlaying = !1,
            this.elResetBtn.classList.remove("wiggle-animation-play"),
            this.elResetBtn.offsetWidth,
            this.elResetBtn.classList.add("wiggle-animation-reset")
        }
    }, {
        key: "onTrackPieceAdded",
        value: function() {
            this.playBtnSpriteAnimation && !0 === this.trainReachedEndOfTrack && (this.trainReachedEndOfTrack = !1,
            this.playBtnSpriteAnimation.resetTrain(),
            this.pause())
        }
    }, {
        key: "onTrainReachedEndOfTrack",
        value: function() {
            this.trainReachedEndOfTrack = !0,
            this.isPlaying = !1,
            this.playBtnSpriteAnimation.trainHitEnd()
        }
    }, {
        key: "update",
        value: function(e) {
            this.playBtnSpriteAnimation && this.playBtnSpriteAnimation.updateSprite(e)
        }
    }]),
    e
}()
  , player = new Player
  , TrackColors = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.activePaletteId = null,
        this.palettes = {},
        this.colorAmountPerPalette = null,
        this.lookDev = {
            color: "#ff00ff"
        }
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--trackColors"),
            this._setupColorPalettes()
        }
    }, {
        key: "init",
        value: function(e) {
            this.changeColors(urlManager.colorPaletteCode),
            e && this._initLookDev(e)
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active")
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "_setupColorPalettes",
        value: function() {
            for (var e = 0; e < trackData.colorPalettes[0].childrens.length; e++) {
                for (var t = trackData.colorPalettes[0].childrens[e].colors, i = [], r = 0; r < t.length; r++) {
                    var n = t[r];
                    i.push(new Color(n))
                }
                this.palettes[e] = i
            }
            this.colorAmountPerPalette = this.palettes[0].length
        }
    }, {
        key: "changeColors",
        value: function(e) {
            this.activePaletteId !== e && (this.activePaletteId = e,
            urlManager.setColorPaletteCode(e))
        }
    }, {
        key: "_initLookDev",
        value: function(e) {
            var t = e.addFolder("trackColors");
            t.addColor(this.lookDev, "color").onChange((function(e) {
                railway.trackSequence.forEach((function(t, i) {
                    i % 4 == 1 && t.material.uniforms.u_color.value.setStyle(e)
                }
                ))
            }
            )).name("a"),
            t.addColor(this.lookDev, "color").onChange((function(e) {
                railway.trackSequence.forEach((function(t, i) {
                    i % 4 == 2 && t.material.uniforms.u_color.value.setStyle(e)
                }
                ))
            }
            )).name("b"),
            t.addColor(this.lookDev, "color").onChange((function(e) {
                railway.trackSequence.forEach((function(t, i) {
                    i % 4 == 3 && t.material.uniforms.u_color.value.setStyle(e)
                }
                ))
            }
            )).name("c"),
            t.addColor(this.lookDev, "color").onChange((function(e) {
                railway.trackSequence.forEach((function(t, i) {
                    i % 4 == 0 && t.material.uniforms.u_color.value.setStyle(e)
                }
                ))
            }
            )).name("d"),
            t.open()
        }
    }, {
        key: "update",
        value: function() {
            var e = this;
            railway.trackSequence.forEach((function(t, i) {
                t.material.uniforms.u_color.value = e.palettes[e.activePaletteId][i % e.colorAmountPerPalette]
            }
            ))
        }
    }]),
    e
}()
  , trackColors = new TrackColors
  , TrackButtons = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elTrackBtns = [],
        this.elUndoTrackBtn = null,
        this.elDeleteTrackBtn = null,
        this.elAnimatedTrackBtns = [],
        this.elTrackMenu = null,
        this.btnPressed = !1,
        this.prevColorPaletteId = null,
        this.prevEle = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            var t = this;
            this.elTrackMenu = e,
            this.elContainer = document.getElementById("component--trackEditor"),
            this.elUndoTrackBtn = document.getElementById("trackEditor-undo-btn"),
            this.elDeleteTrackBtn = document.getElementById("trackEditor-deleteTrack-btn"),
            trackData.colorPalettes.forEach((function(e) {
                if (e.childrens) {
                    var i = t._createBtnWithChildrens(e);
                    t.elTrackMenu.prepend(i)
                }
            }
            )),
            trackData.trackPieces.reverse(),
            trackData.trackPieces.forEach((function(e) {
                if ("station" !== e.type)
                    if (e.childrens) {
                        var i = t._createBtnWithChildrens(e);
                        t.elTrackMenu.prepend(i)
                    } else {
                        var r = t._createBtn(e);
                        t.elTrackMenu.prepend(r)
                    }
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            [this.elTrackBtns, this.elUndoTrackBtn, this.elDeleteTrackBtn].forEach((function(t) {
                t.length ? t.forEach((function(t) {
                    e._addEvents(t)
                }
                )) : e._addEvents(t)
            }
            )),
            document.addEventListener("pointerdown", (function(t) {
                return e.onDocumentClick(t)
            }
            )),
            this.elContainer.addEventListener("pointerover", (function(t) {
                "touch" === t.pointerType && (t.target.classList.contains("trackEditor-btn") ? e.elContainer.style.pointerEvents = "auto" : e.elContainer.style.pointerEvents = "none")
            }
            )),
            this._handleOnColorPaletteBtnClick(trackColors.activePaletteId)
        }
    }, {
        key: "_addEvents",
        value: function(e) {
            var t = this;
            e.addEventListener("pointerover", (function(e) {
                return t.onPointerOver(e)
            }
            )),
            e.addEventListener("pointerout", (function(e) {
                return t.onPointerOut(e)
            }
            )),
            e.addEventListener("pointerdown", (function(e) {
                return t.onPointerDown(e)
            }
            )),
            e.addEventListener("pointerup", (function(e) {
                return t.onPointerUp(e)
            }
            ))
        }
    }, {
        key: "_createBtnWithChildrens",
        value: function(e) {
            var t = document.createElement("div");
            t.classList.add("trackEditor-btn-wrapper", "hide-scrollbar");
            var i = document.createElement("div");
            i.classList.add("trackEditor-btn-child-wrapper", "hide-scrollbar");
            var r = e.type.includes("colorPalettes");
            r ? i.setAttribute("color-palete-type", e.type) : i.setAttribute("track-piece-type", e.type),
            i.dataset.mouseHover = !0;
            for (var n = 0; n < e.childrens.length; n++) {
                var a = e.childrens[n]
                  , o = e.childrens[n].size
                  , s = document.createElement("div");
                o && s.setAttribute("length", o),
                "special" === e.type ? s.setAttribute("track-piece-type", "".concat(e.childrens[n].type)) : r ? s.setAttribute("color-palette-type", "".concat(e.type, "_").concat(n)) : s.setAttribute("track-piece-type", "".concat(e.type, "_").concat(n)),
                s.classList.add("trackEditor-btn", "trackEditor-btn-child-length"),
                s.style.zIndex = e.childrens.length - n,
                s.style.transitionDelay = "".concat(n / 20, "s"),
                s.style.setProperty("--translate-y", "".concat(window.innerWidth >= 812 ? 75 * (n + 1) : 61 * (n + 1), "px")),
                this._addEvents(s);
                var l = document.createElement("div");
                l.classList.add("trackEditor-btn-child-container");
                var h = this._createBtnImg(a);
                !1 !== a.wiggle && (h.dataset.wiggle = !0),
                l.append(h);
                var c = this._createBtnImgDisabled(e, a);
                l.append(c);
                var p = this._createBtnImgDisabled(e, a, !0);
                if (l.append(p),
                o) {
                    var u = this._createBtnTrackSizeInfo(o);
                    l.append(u)
                }
                var d = document.createElement("div");
                d.classList.add("trackEditor-btn-child-background"),
                s.append(l),
                s.append(d),
                i.append(s)
            }
            var f = this._createBtn(e);
            return f.setAttribute("has-children", ""),
            t.append(f),
            t.prepend(i),
            t
        }
    }, {
        key: "_createBtnImg",
        value: function(e) {
            var t = document.createElement("img");
            return !1 !== e.wiggle && (t.dataset.wiggle = !0),
            t.src = e.btnImg,
            t.alt = e.type,
            t.classList.add("trackEditor-btn-img", e.type.includes("colorPalette") ? "colorPalette" : null),
            t
        }
    }, {
        key: "_createBtnImgDisabled",
        value: function(e, t, i) {
            var r = document.createElement("img")
              , n = t || e;
            return n.btnImgDisabled && (r.src = i ? n.btnImgDisabled.split(".")[0] + "-night.png" : n.btnImgDisabled,
            r.alt = n.type,
            r.classList.add(i ? "trackEditor-btn-img-disabled-night" : "trackEditor-btn-img-disabled")),
            r
        }
    }, {
        key: "_createBtnIndicator",
        value: function() {
            var e = document.createElement("span");
            return e.classList.add("trackEditor-btn-indicator"),
            e
        }
    }, {
        key: "_createBtnTrackSizeInfo",
        value: function(e) {
            var t = document.createElement("p");
            return t.innerText = e.toUpperCase(),
            t.classList.add("trackEditor-btn-size-info"),
            t
        }
    }, {
        key: "_createBtn",
        value: function(e) {
            var t = document.createElement("button")
              , i = document.createElement("div")
              , r = document.createElement("div")
              , n = document.createElement("div");
            t.setAttribute("track-type", e.type),
            t.classList.add("trackEditor-btn"),
            t.dataset.mouseHover = "true",
            i.classList.add("trackEditor-btn-container"),
            r.classList.add("trackEditor-btn-background"),
            n.classList.add("trackEditor-btn-wrapper");
            var a = this._createBtnImg(e);
            if ("colorPalettes" === e.type && a.classList.add("colorPalettes"),
            i.append(a),
            e.btnImgDisabled) {
                var o = this._createBtnImgDisabled(e);
                i.append(o);
                var s = this._createBtnImgDisabled(e, null, !0);
                i.append(s)
            }
            var l = this._createBtnIndicator();
            return i.append(l),
            t.append(r),
            t.append(i),
            this.elTrackBtns.push(t),
            t
        }
    }, {
        key: "animeIn",
        value: function() {
            this.elContainer.classList.add("animated"),
            this.elTrackBtns.forEach((function(e) {
                e.style.pointerEvents = "auto"
            }
            ))
        }
    }, {
        key: "animeOut",
        value: function() {
            this.elContainer.classList.remove("animated"),
            this.elTrackBtns.forEach((function(e) {
                e.style.pointerEvents = "none"
            }
            ))
        }
    }, {
        key: "hideTrackBtnFolder",
        value: function() {
            var e = document.querySelector(".trackEditor-btn-wrapper.active ");
            e && e.classList.remove("active")
        }
    }, {
        key: "_highlightActiveColorPaletteEle",
        value: function(e) {
            for (var t = document.querySelectorAll(".trackEditor-btn-img.colorPalette")[e], i = document.querySelectorAll(".trackEditor-btn-img.colorPalette"), r = 0; r < i.length; r++)
                i[r].classList.remove("isActive");
            t.classList.add("isActive")
        }
    }, {
        key: "_setActiveColorPaletteBtnImg",
        value: function(e) {
            var t = document.querySelector('[track-type="colorPalettes"]').querySelector(".trackEditor-btn-container img");
            t.src = trackData.colorPalettes[0].childrens[e].btnImg,
            t.classList.remove("wiggle-animation"),
            t.offsetWidth,
            t.classList.add("wiggle-animation")
        }
    }, {
        key: "_handleOnColorPaletteBtnClick",
        value: function(e) {
            var t = e.target ? e.target.getAttribute("color-palette-type").split("_")[1] : e;
            this._highlightActiveColorPaletteEle(t),
            this._setActiveColorPaletteBtnImg(t),
            trackColors.changeColors(t),
            this.prevColorPaletteId = t
        }
    }, {
        key: "_handleOnTrackBtnClick",
        value: function(e) {
            var t = e.target
              , i = t.previousSibling;
            t.hasAttribute("has-children") && setTimeout((function() {
                t.classList.contains("trackEditor-btn-disabled") || (t.classList.add("active"),
                i.classList.add("active"))
            }
            ), 0),
            this._addTrackPiece(e)
        }
    }, {
        key: "onPointerDown",
        value: function(e) {
            var t = e.target
              , i = t.hasAttribute("has-children")
              , r = e.target.querySelector(".trackEditor-btn-container");
            r && r.classList.add("pressed");
            var n = e.target.querySelector(".trackEditor-btn-child-container");
            n && n.classList.add("pressed");
            var a = "trackEditor-undo-btn" === t.id;
            this.prevEle === t || n || a || (this.prevEle = t,
            this.hideTrackBtnFolder()),
            i && (t.parentNode.classList.contains("active") ? t.parentNode.classList.remove("active") : t.parentNode.classList.add("active")),
            e.target.classList.contains("trackEditor-btn-disabled") ? soundAudio.playSound("placeblock-disabled") : soundAudio.playPlaceBlock(),
            properties.interactedWithTrackBtn = !0
        }
    }, {
        key: "onPointerUp",
        value: function(e) {
            var t = e.target
              , i = t.hasAttribute("track-piece-type")
              , r = t.hasAttribute("isDeleteTrack")
              , n = t.hasAttribute("isUndoTrackPiece")
              , a = t.hasAttribute("color-palette-type");
            t.classList.contains("trackEditor-btn-child") ? t.classList.remove("pressed") : t.querySelector(".trackEditor-btn-container") ? t.querySelector(".trackEditor-btn-container").classList.remove("pressed") : t.querySelector(".trackEditor-btn-child-container") && t.querySelector(".trackEditor-btn-child-container").classList.remove("pressed"),
            i ? (this._handleOnTrackBtnClick(e),
            this._previewTrackPiece(e)) : a ? this._handleOnColorPaletteBtnClick(e) : n ? (railway._removeLastAddedTrackPiece(),
            railway._previewLastAddedTrackPiece()) : r && confirmDelete.show()
        }
    }, {
        key: "onPointerOver",
        value: function(e) {
            var t = e.target
              , i = t.hasAttribute("track-piece-type")
              , r = t.hasAttribute("isUndoTrackPiece")
              , n = t.hasAttribute("track-type") ? t.getAttribute("track-type").includes("colorPalettes") : t.hasAttribute("color-palette-type")
              , a = n && t.hasAttribute("color-palette-type") ? t.getAttribute("color-palette-type") : 0
              , o = a && t.querySelector("img").classList.contains("isActive")
              , s = a ? t.getAttribute("color-palette-type").split("_")[1] : null;
            soundAudio.playRollover();
            var l = t.querySelector("img");
            !l.dataset.wiggle || t.classList.contains("trackEditor-btn-disabled") || o || (l.classList.remove("wiggle-animation"),
            l.offsetWidth,
            l.classList.add("wiggle-animation")),
            i && "touch" !== e.pointerType ? this._previewTrackPiece(e) : r ? railway._previewLastAddedTrackPiece() : a && !o && s && trackColors.changeColors(s),
            n || UberMaterial.enableOutBoundEffect(!0)
        }
    }, {
        key: "onPointerOut",
        value: function(e) {
            var t = e.target
              , i = t.hasAttribute("track-piece-type")
              , r = t.hasAttribute("track-type") ? t.getAttribute("track-type").includes("colorPalettes") : t.hasAttribute("color-palette-type");
            UberMaterial.enableOutBoundEffect(!1),
            t.classList.contains("trackEditor-btn-child") ? t.classList.remove("pressed") : t.querySelector(".trackEditor-btn-container") && t.querySelector(".trackEditor-btn-container").classList.remove("pressed"),
            i ? railway._cancelPreviewTrackPiece() : r ? trackColors.changeColors(this.prevColorPaletteId) : railway._cancelPreviewLastAddedTrackPiece()
        }
    }, {
        key: "onDocumentClick",
        value: function(e) {
            var t = e.target;
            t.classList.contains("trackEditor-btn") || t.classList.contains("trackEditor-btn-child") || t.classList.contains("trackEditor-btn-child-length") || this.hideTrackBtnFolder()
        }
    }, {
        key: "_previewTrackPiece",
        value: function(e) {
            var t = this.identifyFullTrackTypeName(e);
            railway._previewTrackPiece(t)
        }
    }, {
        key: "identifyFullTrackTypeName",
        value: function(e) {
            return e.target.getAttribute("track-piece-type")
        }
    }, {
        key: "getToBeDisabledTrackBtns",
        value: function(e) {
            var t, i = [];
            return e.forEach((function(e) {
                if (e.includes("_")) {
                    var r = e;
                    if (t !== e) {
                        var n = document.querySelector("div[track-piece-type='" + r + "']");
                        i.push(n),
                        t = r
                    }
                } else if (!e.includes("_")) {
                    var a = document.querySelector("button[track-type='" + e + "']");
                    i.push(a)
                }
            }
            )),
            i
        }
    }, {
        key: "_disableTrackBtnsByNotAllowedAddableTrackPieceTypes",
        value: function(e) {
            var t = this.getToBeDisabledTrackBtns(e);
            document.querySelectorAll(".trackEditor-btn").forEach((function(e) {
                e.classList.contains("trackEditor-btn-disabled") && e.classList.remove("trackEditor-btn-disabled")
            }
            )),
            t.forEach((function(e) {
                e.classList.add("trackEditor-btn-disabled")
            }
            ))
        }
    }, {
        key: "_disableBtn",
        value: function(e) {
            e.classList.add("trackEditor-btn-disabled"),
            e.previousSibling && e.previousSibling.classList.remove("active"),
            e.parentNode.querySelector(".trackEditor-btn.active") && e.parentNode.querySelector(".trackEditor-btn.active").classList.remove("active"),
            e.querySelector(".trackEditor-btn-container").classList.remove("pressed")
        }
    }, {
        key: "_addTrackPiece",
        value: function(e) {
            var t = this.identifyFullTrackTypeName(e);
            railway._previewTrackPiece(t),
            railway._commitPreviewTrack()
        }
    }, {
        key: "resize",
        value: function(e, t) {
            for (var i = document.querySelectorAll(".trackEditor-btn-child-wrapper"), r = 0; r < i.length; r++)
                for (var n = i[r].childNodes, a = 0; a < n.length; a++)
                    for (var o = 0; o < n.length; o++)
                        n[o].style.setProperty("--translate-y", "".concat(e >= 812 ? 75 * (o + 1) : 61 * (o + 1), "px"))
        }
    }]),
    e
}()
  , trackButtons = new TrackButtons
  , _v1$3 = new Vector3
  , _v2$3 = new Vector3;
new Vector3;
var _q1$1 = new Quaternion
  , _m4 = new Matrix4;
new OBB;
var LiftBlock = function(e) {
    _inherits(i, Object3D);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "liftMesh", void 0),
        _defineProperty2(_assertThisInitialized(e), "liftTopMesh", void 0),
        _defineProperty2(_assertThisInitialized(e), "liftBottomMesh", void 0),
        _defineProperty2(_assertThisInitialized(e), "obb", void 0),
        _defineProperty2(_assertThisInitialized(e), "centerMaterial", void 0),
        _defineProperty2(_assertThisInitialized(e), "material", void 0),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e, t) {
            var r;
            e._getLastPosition(this.position, !0),
            this.material = new UberMaterial((_defineProperty2(r = {
                color: e.material.uniforms.u_color.value,
                needsPreview: !0,
                receiveShadow: !0
            }, "needsPreview", !0),
            _defineProperty2(r, "hasNightEffect", !0),
            r)),
            this.liftMesh = new Mesh(i.lifterPipesGeometry,this.material),
            Object.assign(this.material.uniforms, {
                u_previewRatio: e.trackMesh.material.uniforms.u_previewRatio,
                u_previewColor: e.trackMesh.material.uniforms.u_previewColor
            }),
            this.add(this.liftMesh),
            this.liftMesh.scale.y = t * i.LEVEL_HEIGHT,
            this.liftMesh.receiveShadow = !0,
            e.container.matrixWorld.decompose(_v1$3, _q1$1, _v2$3),
            this.position.y -= i.LEVEL_HEIGHT * t + TrackPiece.THICKNESS,
            this.quaternion.setFromAxisAngle(_v1$3.set(0, 1, 0), e.angle),
            this.track = this,
            this.show = this.show.bind(this),
            this.hide = this.hide.bind(this),
            this.togglePreviewAppearance = this.togglePreviewAppearance.bind(this),
            e.container.add(this),
            e.container.updateMatrixWorld(!0);
            var n = this.obb = new OBB;
            this.matrix.decompose(n.center, _q1$1, _v1$3),
            _m4.makeRotationFromQuaternion(_q1$1),
            n.rotation.setFromMatrix4(_m4),
            n.halfSize.x = i.lifterPipesGeometry.boundingBox.max.x,
            n.halfSize.y = t / 2 * i.LEVEL_HEIGHT,
            n.halfSize.z = i.lifterPipesGeometry.boundingBox.max.z,
            n.center.y += t / 2 * i.LEVEL_HEIGHT
        }
    }, {
        key: "show",
        value: function() {
            this.visible = !0
        }
    }, {
        key: "hide",
        value: function() {
            this.visible = !1
        }
    }, {
        key: "remove",
        value: function() {
            this.parent && this.parent.remove(this)
        }
    }, {
        key: "togglePreviewAppearance",
        value: function(e) {}
    }], [{
        key: "preInit",
        value: function() {
            properties.loader.add(settings.MODEL_PATH + "tracks/LIFTER_PIPES.buf", {
                weight: 1,
                onLoad: function(e) {
                    i.lifterPipesGeometry = e,
                    e.computeBoundingBox()
                }
            })
        }
    }]),
    i
}();
_defineProperty2(LiftBlock, "LEVEL_HEIGHT", .07),
_defineProperty2(LiftBlock, "liftGeometryList", []),
_defineProperty2(LiftBlock, "liftTopGeometry", void 0),
_defineProperty2(LiftBlock, "liftBottomGeometry", void 0),
_defineProperty2(LiftBlock, "lifterPipesGeometry", void 0),
_defineProperty2(LiftBlock, "aoTexture", void 0);
var _v1$2 = new Vector3
  , _v2$2 = new Vector3
  , _v3 = new Vector3
  , _q1 = new Quaternion
  , _q2 = new Quaternion;
_v3.quaternion = _q1;
var _qCorr = (new Quaternion).setFromAxisAngle(new Vector3(0,1,0), Math.PI)
  , _m1 = new Matrix4
  , _planeGeometry = new PlaneGeometry(1,1).rotateX(-Math.PI / 2).rotateY(Math.PI)
  , _shadowMaterials = {}
  , TrackPiece = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "PROGRESS_DEBUG", !1),
        _defineProperty2(this, "SPLINE_DEBUG", !1),
        _defineProperty2(this, "OBB_DEBUG", !1),
        _defineProperty2(this, "LIFT_BLOCK_DEBUG", !1),
        _defineProperty2(this, "type", null),
        _defineProperty2(this, "angle", 0),
        _defineProperty2(this, "heightDelta", 0),
        _defineProperty2(this, "trackGeometry", null),
        _defineProperty2(this, "splineGeometry", null),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "boundingSphere", new Sphere),
        _defineProperty2(this, "trackMesh", null),
        _defineProperty2(this, "splineMesh", null),
        _defineProperty2(this, "textures", {}),
        _defineProperty2(this, "externalData", {}),
        _defineProperty2(this, "distance", 0),
        _defineProperty2(this, "offset", new Vector3),
        _defineProperty2(this, "obbMeshes", []),
        _defineProperty2(this, "liftBlock", null),
        _defineProperty2(this, "config", {})
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            var t = this;
            Object.assign(this.config, e),
            this._setup(this.config),
            e.models.forEach((function(e) {
                properties.loader.add(e.src, {
                    weight: e.weight,
                    onLoad: function(i) {
                        return t._onModelLoad(e.type, i)
                    }
                })
            }
            )),
            e.textures.forEach((function(e) {
                t.textures[e.type] = properties.loader.add(e.src, {
                    weight: e.weight,
                    type: "texture"
                }).content
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            this._syncObbMeshes()
        }
    }, {
        key: "_clone",
        value: function() {
            var t = new e;
            t._setup(this.config),
            t.trackGeometry = this.trackGeometry,
            t.splineGeometry = this.splineGeometry;
            var i = "station" === this.config.type
              , r = new UberMaterial({
                texture: i ? this.textures.diffuseDay : this.textures.diffuse,
                aoTexture: this.textures.ao,
                needsPreview: !0,
                receiveShadow: !this.config.skipShadowCasting,
                hasNightEffect: !0,
                nightEffectColor: i ? "#ffffff" : null,
                nightEffectTexture: !!i && this.textures.diffuseNight
            });
            if ((i || "special_0" === this.config.type || "special_1" === this.config.type) && (r.uniforms.u_texture.value.minFilter = LinearMipMapLinearFilter,
            r.uniforms.u_texture.value.generateMipmaps = !0,
            r.uniforms.u_texture.value.anisotropy = properties.renderer.capabilities.getMaxAnisotropy()),
            t.material = r,
            t.distance = this.distance,
            t.offset.copy(this.offset),
            t._setupSpline(),
            t._setupTrack(),
            t._computeObbMeshesFromSplineData(),
            t._syncObbMeshes(),
            this.config.shadowSize) {
                var n = _shadowMaterials[this.config.type] = _shadowMaterials[this.config.type] || new StaticShadowMaterial({
                    texture: this.textures.shadow,
                    strength: "station" === this.config.type ? .3 : .5
                })
                  , a = new Mesh(_planeGeometry,n);
                a.scale.fromArray(this.config.shadowSize),
                a.position.fromArray(this.config.shadowOffset),
                a.renderOrder = .5,
                t.trackMesh.add(a)
            }
            return t
        }
    }, {
        key: "_setup",
        value: function(e) {
            this.config = e,
            this.type = this.config.type,
            this.code = this.config.code,
            this.angle = this.config.angle,
            this.heightDelta = this.config.heightDelta,
            this.levelPermitFn = this.config.levelPermitFn
        }
    }, {
        key: "_onModelLoad",
        value: function(e, t) {
            "track" === e ? (this.trackGeometry = t,
            this._setupTrack()) : "spline" === e ? (this.splineGeometry = t,
            this._computePropertiesFromSplineData(),
            this._setupSpline(),
            this._computeObbMeshesFromSplineData(),
            this._syncObbMeshes()) : console.log("_onModelLoad() model type not found:", e)
        }
    }, {
        key: "_togglePreviewAppearance",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            e ? (this.trackMesh.material.uniforms.u_previewRatio.value = 1,
            this.trackMesh.material.uniforms.u_previewColor.value.setHex(t ? 65280 : 16711680)) : this.trackMesh.material.uniforms.u_previewRatio.value = 0,
            this.liftBlock && this.liftBlock.togglePreviewAppearance(e, t)
        }
    }, {
        key: "_dispose",
        value: function() {
            this.trackMesh.geometry.dispose(),
            this.trackMesh.material.dispose()
        }
    }, {
        key: "_setSplineGeometry",
        value: function(e) {
            this.splineGeometry = e,
            this._computePropertiesFromSplineData(),
            this._setupSpline(),
            this._computeObbMeshesFromSplineData(),
            this._syncObbMeshes()
        }
    }, {
        key: "_setupTrack",
        value: function() {
            this.trackMesh = new Mesh(this.trackGeometry,this.material),
            this.trackMesh.castShadow = !this.config.skipShadowCasting,
            this.trackMesh.receiveShadow = !this.config.skipShadowReceiving,
            this.trackMesh.userData = this,
            this.container.add(this.trackMesh)
        }
    }, {
        key: "_setupSpline",
        value: function() {
            this.SPLINE_DEBUG && (this.splineMesh = new Points(this.splineGeometry,e.splineMaterial),
            this.container.add(this.splineMesh),
            this.splineMesh.renderOrder = 5)
        }
    }, {
        key: "_getPositionAtProgress",
        value: function(e) {
            this.PROGRESS_DEBUG && console.log("seeking at ".concat(e));
            for (var t = this.splineGeometry.attributes.position, i = this.splineGeometry.attributes.orient.array, r = t.count, n = t.itemSize, a = t.array, o = 0, s = 0, l = 1; l < r; l += 1) {
                s = l * n;
                var h = _v1$2.set(a[s - 3], a[s - 2], a[s - 1])
                  , c = _v2$2.set(a[s + 0], a[s + 1], a[s + 2])
                  , p = h.distanceTo(c);
                if (e >= o && e <= p + o) {
                    var u = (e - o) / p;
                    this.PROGRESS_DEBUG && console.log("Match found in indices: ".concat(l - 1, ",").concat(l, "."), {
                        lerpProgress: u,
                        progress: e,
                        totalDistance: o
                    });
                    var d = _v3.lerpVectors(h, c, u)
                      , f = s / 3 * 4;
                    return _q1.fromArray(i, f - 4),
                    _q2.fromArray(i, f),
                    _q1.slerp(_q2, u).normalize(),
                    _q2.setFromRotationMatrix(this.container.matrixWorld),
                    _q1.premultiply(_q2),
                    _q1.multiply(_qCorr),
                    d.applyMatrix4(this.container.matrixWorld),
                    d
                }
                o += p
            }
            return !1
        }
    }, {
        key: "_getLastPosition",
        value: function(e, t) {
            var i = this.splineGeometry.attributes.position
              , r = i.count
              , n = i.itemSize
              , a = i.array
              , o = (r - 1) * n
              , s = e.set(a[o + 0], a[o + 1], a[o + 2]);
            return t || s.applyMatrix4(this.trackMesh.matrixWorld),
            s
        }
    }, {
        key: "_getFirstPosition",
        value: function(e, t) {
            var i = this.splineGeometry.attributes.position
              , r = (i.count,
            i.itemSize)
              , n = i.array
              , a = 0 * r
              , o = e.set(n[a + 0], n[a + 1], n[a + 2]);
            return t || o.applyMatrix4(this.trackMesh.matrixWorld),
            o
        }
    }, {
        key: "_computePropertiesFromSplineData",
        value: function() {
            for (var e = this.splineGeometry.attributes.position, t = e.count, i = e.itemSize, r = e.array, n = 0, a = 0, o = 1; o < t; o += 1) {
                a = o * i;
                var s = _v1$2.set(r[a - 3], r[a - 2], r[a - 1])
                  , l = _v2$2.set(r[a + 0], r[a + 1], r[a + 2]);
                n += s.distanceTo(l)
            }
            this.distance = n;
            var h = i * (t - 1)
              , c = _v1$2.set(r[0], r[1], r[2])
              , p = _v2$2.set(r[h], r[h + 1], r[h + 2]);
            this.offset.copy(p.sub(c))
        }
    }, {
        key: "_computeObbMeshesFromSplineData",
        value: function() {
            for (var e = this.splineGeometry.attributes, t = e.center, i = e.halfSize, r = e.orient, n = t.count, a = t.itemSize, o = this.boundingSphere, s = 0; s < n; s++) {
                var l = s * a
                  , h = s * r.itemSize
                  , c = void 0;
                this.OBB_DEBUG ? (c = new Mesh(new BoxGeometry(1,1,1),new MeshBasicMaterial({
                    color: 16711680,
                    transparent: !0,
                    opacity: .75,
                    depthWrite: !1
                }))).renderOrder = 1001 : c = new Object3D,
                c.visible = this.OBB_DEBUG,
                this.container.add(c),
                c.position.fromArray(t.array, l),
                c.quaternion.fromArray(r.array, h),
                c.scale.fromArray(i.array, l).multiplyScalar(2),
                _m1.makeRotationFromQuaternion(c.quaternion);
                var p = c.obb = new OBB;
                p.center.copy(c.position),
                p.rotation.setFromMatrix4(_m1),
                p.halfSize.copy(c.scale).divideScalar(2);
                for (var u = 0; u < 8; u++)
                    _v1$2.set(1 & u ? .5 : -.5, 2 & u ? .5 : -.5, 4 & u ? .5 : -.5).multiply(c.scale).applyQuaternion(c.quaternion).add(c.position),
                    0 == s && 0 == u ? (o.center.copy(_v1$2),
                    o.radius = 0) : o.expandByPoint(_v1$2);
                this.obbMeshes.push(c),
                this.container.updateMatrixWorld(!0)
            }
            if (this.OBB_DEBUG) {
                var d = new Mesh(new SphereGeometry(1,32,24),new MeshBasicMaterial({
                    color: 65280,
                    transparent: !0,
                    opacity: .5,
                    depthWrite: !1
                }));
                d.renderOrder = 1e3,
                d.scale.setScalar(o.radius),
                d.position.copy(o.center),
                this.container.add(d)
            }
        }
    }, {
        key: "_syncObbMeshes",
        value: function() {
            this.container.updateMatrixWorld()
        }
    }, {
        key: "_addLiftBlock",
        value: function(e) {
            return this.liftBlock ? void 0 : (this.LIFT_BLOCK_DEBUG && console.log("Adding lift block to track ".concat(this.type)),
            this.liftBlock = new LiftBlock,
            this.liftBlock.init(this, e),
            this.liftBlock)
        }
    }, {
        key: "_showLiftBlock",
        value: function() {
            this.liftBlock && this.liftBlock.show()
        }
    }, {
        key: "_hideLiftBlock",
        value: function() {
            this.liftBlock && (this.LIFT_BLOCK_DEBUG && console.log("hiding lift block"),
            this.liftBlock.hide())
        }
    }, {
        key: "_removeLiftBlock",
        value: function() {
            this.LIFT_BLOCK_DEBUG && console.log("removing lift block"),
            this.liftBlock && (this.liftBlock.remove(),
            this.liftBlock = null)
        }
    }]),
    e
}();
_defineProperty2(TrackPiece, "THICKNESS", .009),
_defineProperty2(TrackPiece, "splineMaterial", new PointsMaterial({
    color: "#ff0000",
    size: .01,
    depthTest: !1
})),
_defineProperty2(TrackPiece, "obbMaterial", new MeshBasicMaterial({
    color: "#00ff00",
    wireframe: !0,
    transparent: !0,
    opacity: .5
}));
var Track = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "pieces", new Map),
        _defineProperty2(this, "trackBounds", new Box3),
        _defineProperty2(this, "trackBoundaryIsVisible", !1)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            LiftBlock.preInit(),
            trackData.trackPieces.forEach((function(t) {
                if (t.childrens)
                    t.childrens.forEach((function(t) {
                        var i = new TrackPiece;
                        i.preInit(t),
                        e.pieces.set(t.type, i)
                    }
                    ));
                else {
                    var i = new TrackPiece;
                    i.preInit(t),
                    e.pieces.set(t.type, i)
                }
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            this.initTrackBoundary()
        }
    }, {
        key: "initTrackBoundary",
        value: function() {
            if (this.trackBounds.min.set(-properties.trackAreaSize / 2, -.01, -properties.trackAreaSize / 2),
            this.trackBounds.max.set(properties.trackAreaSize / 2, properties.trackAreaHeight, properties.trackAreaSize / 2),
            this.trackBoundaryIsVisible) {
                var e = this.trackBounds.max.z - this.trackBounds.min.z
                  , t = this.trackBounds.max.x - this.trackBounds.min.x
                  , i = this.trackBounds.max.y - this.trackBounds.min.y
                  , r = new BoxGeometry(t,i + .01,e);
                r.translate(0, i / 2, 0);
                var n = new MeshBasicMaterial({
                    color: 65280,
                    side: BackSide,
                    transparent: !0,
                    opacity: .5,
                    depthWrite: !1,
                    fog: !1
                })
                  , a = new Mesh(r,n);
                properties.scene.add(a)
            }
        }
    }]),
    e
}()
  , track = new Track
  , _v1$1 = new Vector3
  , _v2$1 = new Vector3
  , _sphere1 = new Sphere
  , _sphere2 = new Sphere
  , _obb1 = new OBB
  , _obb2 = new OBB;
new Matrix4;
var Railway = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "PROGRESS_DEBUG", !1),
        _defineProperty2(this, "isInitialized", !1),
        _defineProperty2(this, "container", new Object3D),
        _defineProperty2(this, "trackContainer", new Object3D),
        _defineProperty2(this, "firstTrackPiece", null),
        _defineProperty2(this, "lastTrackPiece", null),
        _defineProperty2(this, "trackSequence", []),
        _defineProperty2(this, "totalDistance", 0),
        _defineProperty2(this, "totalOffset", new Vector3),
        _defineProperty2(this, "totalRotation", 0),
        _defineProperty2(this, "trainProgress", 0),
        _defineProperty2(this, "previewTrackData", {
            piece: null,
            problem: "",
            reset: function() {
                this.piece = null,
                this.problem = ""
            }
        }),
        _defineProperty2(this, "currTrackHeightLevel", 0),
        _defineProperty2(this, "initialColorPalette", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.initialColorPalette = settings.DEFAULT_COLOR_PALETTE,
            this.totalOffset.fromArray(trackData.defaultTrackOffset),
            track.preInit(),
            train.preInit((function(t) {
                return e._getPositionAtProgress(t)
            }
            ), (function(t) {
                return e._loopProgress(t)
            }
            ), (function() {
                return e.totalDistance
            }
            )),
            this.container.add(train.container),
            this.trackContainer.rotateY(Math.PI / 2),
            this.container.add(this.trackContainer),
            this.trackContainer.updateMatrixWorld(),
            this.container.updateMatrixWorld()
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            track.init(),
            this._addAndCommitTrack("station");
            var t = urlManager.getDecodedTrackData()
              , i = t.length;
            t.forEach((function(t, r) {
                e._addAndCommitTrack(t, r != i - 1)
            }
            )),
            train.init(),
            train.setTrainToStartOrEnd(!1, .08),
            this.isInitialized = !0,
            urlManager.setTrackCodeParam(this.trackSequence)
        }
    }, {
        key: "_getPositionAtProgress",
        value: function(e) {
            var t = this
              , i = this.trackSequence.find((function(i, r) {
                var n = i.externalData.startDistance
                  , a = n + i.distance;
                null == n && properties.isInDevMode && console.warn("Expected startDistance");
                var o = e >= n && e <= a;
                return o && t.PROGRESS_DEBUG && console.log("Found match at this.trackSequence[".concat(r, "]")),
                o
            }
            ));
            if (i) {
                var r = e - i.externalData.startDistance;
                return i._getPositionAtProgress(r)
            }
            return !1
        }
    }, {
        key: "_previewLastAddedTrackPiece",
        value: function() {
            this.trackSequence.length <= 1 || this.trackSequence[this.trackSequence.length - 1]._togglePreviewAppearance(!0)
        }
    }, {
        key: "_cancelPreviewLastAddedTrackPiece",
        value: function() {
            this.trackSequence.length <= 1 || this.trackSequence[this.trackSequence.length - 1]._togglePreviewAppearance(!1)
        }
    }, {
        key: "_removeAllTrackPieces",
        value: function() {
            var e = this;
            this.trackSequence.forEach((function(t) {
                e._removeLastAddedTrackPiece()
            }
            )),
            this.trackSequence.length > 1 && this._removeAllTrackPieces(),
            player.onResetBtnClick()
        }
    }, {
        key: "_removeLastAddedTrackPiece",
        value: function() {
            if (!(this.trackSequence.length <= 1)) {
                var e = this.trackSequence.pop();
                e == this.lastTrackPiece && (this.lastTrackPiece = null),
                this.totalDistance -= e.distance,
                this.totalRotation -= e.angle,
                this.totalOffset.sub(e.externalData.offset),
                this.currTrackHeightLevel -= e.heightDelta,
                this._unhideLiftBlocksIfNeeded(e),
                this._cancelTrackPiece(e),
                this._cancelPreviewTrackPiece(),
                this._updateTrain(0, !0),
                this.isInitialized && urlManager.setTrackCodeParam(this.trackSequence),
                landscape._onTrackPieceRemoved(e);
                var t = this._getNotAllowedAddableTrackPieceTypes();
                trackButtons._disableTrackBtnsByNotAllowedAddableTrackPieceTypes(t)
            }
        }
    }, {
        key: "_previewTrackPiece",
        value: function(e) {
            if (null == this.previewTrackData.piece) {
                var t = this._addTrackPiece(e);
                if (!t)
                    return;
                this.previewTrackData.problem = this._checkTrackPieceForProblem(t),
                t._togglePreviewAppearance(!0, !this.previewTrackData.problem),
                this.previewTrackData.piece = t
            } else {
                if (this.previewTrackData.piece.type === e)
                    return;
                this._cancelPreviewTrackPiece(),
                this._previewTrackPiece(e)
            }
        }
    }, {
        key: "_cancelPreviewTrackPiece",
        value: function() {
            this.previewTrackData.piece && this._cancelTrackPiece(this.previewTrackData.piece),
            this.previewTrackData.reset()
        }
    }, {
        key: "_commitPreviewTrack",
        value: function() {
            null != this.previewTrackData.piece && (this.previewTrackData.problem ? properties.isInDevMode && console.warn("Not adding track piece because ".concat(this.previewTrackData.problem)) : (this.previewTrackData.piece._togglePreviewAppearance(!1),
            this._commitTrackPiece(this.previewTrackData.piece),
            this.previewTrackData.reset()))
        }
    }, {
        key: "_addTrackPiece",
        value: function(e) {
            var t = e
              , i = track.pieces.get(t);
            if (i) {
                if (null != this.lastTrackPiece)
                    return !1;
                var r = i._clone();
                return r.container.position.add(this.totalOffset),
                r.container.rotateY(this.totalRotation),
                this.trackContainer.add(r.container),
                r.init(),
                this.trackContainer.updateMatrixWorld(!0),
                this._addLiftBlockIfApplicable(r),
                r
            }
            properties.isInDevMode && console.warn("Track type not found!" + t)
        }
    }, {
        key: "_addAndCommitTrack",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            if (e) {
                var i = this._addTrackPiece(e);
                if (i) {
                    var r = this._checkTrackPieceForProblem(i);
                    return r ? (properties.isInDevMode && console.warn("Not adding track piece because ".concat(r)),
                    this._cancelTrackPiece(i)) : this._commitTrackPiece(i, t),
                    i
                }
            }
        }
    }, {
        key: "_checkTrackPieceForProblem",
        value: function(e) {
            var t = this._checkForCollisionsBetweenTrackPieces(e);
            return t || (this._checkIfTrackPieceIsOutOfBounds(e) || (e.levelPermitFn(this.currTrackHeightLevel) ? "" : "track piece is not permitted at height level ".concat(this.currTrackHeightLevel)))
        }
    }, {
        key: "_checkIfTrackPieceIsOutOfBounds",
        value: function(e) {
            _v1$1.copy(e.offset),
            _v1$1.applyAxisAngle(_v2$1.set(0, 1, 0), this.totalRotation);
            var t = _v2$1.addVectors(this.totalOffset, _v1$1);
            return track.trackBounds.containsPoint(t) ? "" : "track piece is out of bounds"
        }
    }, {
        key: "_cancelTrackPiece",
        value: function(e) {
            this.trackContainer.remove(e.container),
            e._dispose()
        }
    }, {
        key: "_commitTrackPiece",
        value: function(e, t) {
            if (_v1$1.copy(e.offset),
            _v1$1.applyAxisAngle(_v2$1.set(0, 1, 0), this.totalRotation),
            e.externalData.offset = _v1$1.clone(),
            e.externalData.isTrack = !0,
            e.externalData.startDistance = this.totalDistance,
            this.trackSequence.push(e),
            this.totalOffset.add(_v1$1),
            this.totalRotation += e.angle,
            this.totalDistance += e.distance,
            this.currTrackHeightLevel += e.heightDelta,
            this._hideExistingCollidingLiftBlocks(e),
            properties.hasInitialized ? e.material.uniforms.u_color.value = trackColors.palettes[trackColors.activePaletteId][(this.trackSequence.length - 1) % trackColors.colorAmountPerPalette] : e.material.uniforms.u_color.value = this.initialColorPalette[(this.trackSequence.length - 1) % this.initialColorPalette.length],
            1 === this.trackSequence.length)
                this.firstTrackPiece = e;
            else {
                var i = this.firstTrackPiece._getFirstPosition(_v1$1)
                  , r = e._getLastPosition(_v2$1);
                i.distanceTo(r) < .001 && (this.lastTrackPiece = e,
                properties.hasInitialized && soundAudio.items.completed.play(),
                properties.isInDevMode && console.info("%cConnected track in a loop!", "background: #222; color: #bada55"))
            }
            landscape._onTrackPieceAdded(e),
            player.onTrackPieceAdded(),
            t || this.triggerNotAllowedPiecesFunc(),
            this.isInitialized && urlManager.setTrackCodeParam(this.trackSequence)
        }
    }, {
        key: "triggerNotAllowedPiecesFunc",
        value: function() {
            var e = this._getNotAllowedAddableTrackPieceTypes();
            trackButtons._disableTrackBtnsByNotAllowedAddableTrackPieceTypes(e)
        }
    }, {
        key: "_isObjectCollidingWithAllTrackPieces",
        value: function(e) {
            for (var t = 0; t < this.trackSequence.length; t++) {
                var i = this.trackSequence[t];
                if (this._isObjectCollidingWithTrackPiece(e, i))
                    return !0
            }
            return !1
        }
    }, {
        key: "_isObjectCollidingWithTrackPiece",
        value: function(e, t) {
            if (e.expandByPoint && e.center ? _sphere1.copy(e) : _sphere1.copy(e.boundingSphere).applyMatrix4(e.matrixWorld),
            _sphere2.copy(t.boundingSphere).applyMatrix4(t.container.matrixWorld),
            _sphere1.intersectsSphere(_sphere2)) {
                var i, r = _createForOfIteratorHelper(t.obbMeshes);
                try {
                    for (r.s(); !(i = r.n()).done; ) {
                        var n = i.value;
                        if (_obb1.copy(n.obb),
                        math.obbApplyMatrix4(_obb1, n.parent.matrixWorld),
                        _obb1.intersectsSphere(_sphere1))
                            return !0
                    }
                } catch (a) {
                    r.e(a)
                } finally {
                    r.f()
                }
            }
            return !(!t.liftBlock || (_obb1.copy(t.liftBlock.obb),
            math.obbApplyMatrix4(_obb1, t.container.matrixWorld),
            !_obb1.intersectsSphere(_sphere1)))
        }
    }, {
        key: "_checkForCollisionsBetweenTrackPieces",
        value: function(e) {
            var t = [];
            _sphere1.copy(e.boundingSphere).applyMatrix4(e.container.matrixWorld);
            var i, r = _createForOfIteratorHelper(this.trackSequence);
            try {
                for (r.s(); !(i = r.n()).done; ) {
                    var n = i.value;
                    _sphere2.copy(n.boundingSphere).applyMatrix4(n.container.matrixWorld),
                    _sphere1.intersectsSphere(_sphere2) && t.push(n)
                }
            } catch (f) {
                r.e(f)
            } finally {
                r.f()
            }
            var a, o = _createForOfIteratorHelper(e.obbMeshes);
            try {
                for (o.s(); !(a = o.n()).done; ) {
                    var s = a.value;
                    _obb1.copy(s.obb),
                    math.obbApplyMatrix4(_obb1, s.parent.matrixWorld);
                    var l, h = _createForOfIteratorHelper(t);
                    try {
                        for (h.s(); !(l = h.n()).done; ) {
                            var c = l.value;
                            if (_sphere1.copy(c.boundingSphere).applyMatrix4(c.container.matrixWorld),
                            _obb1.intersectsSphere(_sphere1)) {
                                var p, u = _createForOfIteratorHelper(c.obbMeshes);
                                try {
                                    for (u.s(); !(p = u.n()).done; ) {
                                        var d = p.value;
                                        if (_obb2.copy(d.obb),
                                        math.obbApplyMatrix4(_obb2, d.parent.matrixWorld),
                                        _obb1.intersectsOBB(_obb2))
                                            return "new ".concat(e.type, " Track would intersect with existing track of type (").concat(c.type, ").")
                                    }
                                } catch (f) {
                                    u.e(f)
                                } finally {
                                    u.f()
                                }
                            }
                        }
                    } catch (f) {
                        h.e(f)
                    } finally {
                        h.f()
                    }
                }
            } catch (f) {
                o.e(f)
            } finally {
                o.f()
            }
        }
    }, {
        key: "_addLiftBlockIfApplicable",
        value: function(e) {
            var t = this.currTrackHeightLevel + e.heightDelta;
            if (t > 0) {
                var i = e._addLiftBlock(t);
                _obb1.copy(i.obb),
                math.obbApplyMatrix4(_obb1, e.container.matrixWorld);
                var r, n = _createForOfIteratorHelper(this.trackSequence);
                try {
                    for (n.s(); !(r = n.n()).done; ) {
                        var a = r.value;
                        if (_sphere1.copy(a.boundingSphere).applyMatrix4(a.container.matrixWorld),
                        _obb1.intersectsSphere(_sphere1)) {
                            var o, s = _createForOfIteratorHelper(a.obbMeshes);
                            try {
                                for (s.s(); !(o = s.n()).done; ) {
                                    var l = o.value;
                                    _obb2.copy(l.obb),
                                    math.obbApplyMatrix4(_obb2, l.parent.matrixWorld),
                                    _obb1.intersectsOBB(_obb2) && e._removeLiftBlock()
                                }
                            } catch (h) {
                                s.e(h)
                            } finally {
                                s.f()
                            }
                        }
                    }
                } catch (h) {
                    n.e(h)
                } finally {
                    n.f()
                }
            }
        }
    }, {
        key: "_hideExistingCollidingLiftBlocks",
        value: function(e) {
            properties.scene.updateMatrixWorld(!0);
            var t, i = _createForOfIteratorHelper(e.obbMeshes);
            try {
                for (i.s(); !(t = i.n()).done; ) {
                    var r = t.value;
                    _obb1.copy(r.obb),
                    math.obbApplyMatrix4(_obb1, r.parent.matrixWorld);
                    var n, a = _createForOfIteratorHelper(this.trackSequence);
                    try {
                        for (a.s(); !(n = a.n()).done; ) {
                            var o = n.value;
                            o.liftBlock && (_obb2.copy(o.liftBlock.obb),
                            math.obbApplyMatrix4(_obb2, o.container.matrixWorld),
                            _obb1.intersectsOBB(_obb2) && o._hideLiftBlock())
                        }
                    } catch (s) {
                        a.e(s)
                    } finally {
                        a.f()
                    }
                }
            } catch (s) {
                i.e(s)
            } finally {
                i.f()
            }
        }
    }, {
        key: "_unhideLiftBlocksIfNeeded",
        value: function(e) {
            var t, i = [], r = _createForOfIteratorHelper(this.trackSequence);
            try {
                for (r.s(); !(t = r.n()).done; ) {
                    var n = t.value;
                    if (n.liftBlock) {
                        _obb1.copy(n.liftBlock.obb),
                        math.obbApplyMatrix4(_obb1, n.container.matrixWorld);
                        var a, o = _createForOfIteratorHelper(e.obbMeshes);
                        try {
                            for (o.s(); !(a = o.n()).done; ) {
                                var s = a.value;
                                _obb2.copy(s.obb),
                                math.obbApplyMatrix4(_obb2, s.matrixWorld),
                                _obb1.intersectsOBB(_obb2) && i.push(n.liftBlock)
                            }
                        } catch (u) {
                            o.e(u)
                        } finally {
                            o.f()
                        }
                    }
                }
            } catch (u) {
                r.e(u)
            } finally {
                r.f()
            }
            for (var l = 0, h = i; l < h.length; l++) {
                var c = h[l]
                  , p = this.trackSequence.filter((function(t) {
                    return t !== e
                }
                ));
                _obb1.copy(c.obb),
                math.obbApplyMatrix4(_obb1, c.parent.matrixWorld),
                p.some((function(e) {
                    var t, i = _createForOfIteratorHelper(e.obbMeshes);
                    try {
                        for (i.s(); !(t = i.n()).done; ) {
                            var r = t.value;
                            return _obb2.copy(r.obb),
                            math.obbApplyMatrix4(_obb2, r.matrixWorld),
                            _obb1.intersectsOBB(_obb2)
                        }
                    } catch (u) {
                        i.e(u)
                    } finally {
                        i.f()
                    }
                }
                )) || c.show()
            }
        }
    }, {
        key: "_getNotAllowedAddableTrackPieceTypes",
        value: function() {
            var e = this
              , t = [];
            return track.pieces.forEach((function(i) {
                var r = i.type;
                if ("station" !== r) {
                    var n = track.pieces.get(r);
                    if (n) {
                        var a = n._clone();
                        if (a.container.position.add(e.totalOffset),
                        a.container.rotateY(e.totalRotation),
                        e.trackContainer.add(a.container),
                        a.init(),
                        e.trackContainer.updateMatrixWorld(!0),
                        e._addLiftBlockIfApplicable(a),
                        !a)
                            return;
                        e._checkTrackPieceForProblem(a) && (t.push(r),
                        e._cancelTrackPiece(a)),
                        e._cancelTrackPiece(a)
                    } else
                        properties.isInDevMode && console.warn("Track type not found: " + r)
                }
            }
            )),
            t
        }
    }, {
        key: "_getCabCar",
        value: function() {
            return train._getCabCar()
        }
    }, {
        key: "_loopProgress",
        value: function(e) {
            return null != this.lastTrackPiece ? math.mod(e, this.totalDistance) : e
        }
    }, {
        key: "_updateTrain",
        value: function(e, t) {
            train.update(e, t)
        }
    }, {
        key: "update",
        value: function(e) {
            this._updateTrain(e)
        }
    }]),
    e
}()
  , railway = new Railway
  , ConfirmDelete = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elCloseBtn = null,
        this.elYesBtn = null,
        this.elNoBtn = null,
        this.opened = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--confirmDelete"),
            this.elComponent = this.elContainer.querySelector(".component--content"),
            this.elCloseBtn = document.getElementById("confirmDelete-close-btn"),
            this.elYesBtn = document.getElementById("confirmDelete-yes-btn"),
            this.elNoBtn = document.getElementById("confirmDelete-no-btn")
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            )),
            this.elCloseBtn.addEventListener("pointerdown", (function() {
                return e.onNoBtnClick()
            }
            )),
            this.elYesBtn.addEventListener("pointerdown", (function() {
                return e.onYesBtnClick()
            }
            )),
            this.elNoBtn.addEventListener("pointerdown", (function() {
                return e.onNoBtnClick()
            }
            ))
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            this.opened && e.target === this.elComponent && this.hide()
        }
    }, {
        key: "show",
        value: function() {
            var e = this;
            this.elContainer.classList.add("is-active"),
            setTimeout((function() {
                e.elComponent.classList.add("animate"),
                e.elContainer.classList.add("animate")
            }
            ), 0),
            this.opened = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elComponent.classList.remove("animate"),
            this.elContainer.classList.remove("animate"),
            setTimeout((function() {
                e.elContainer.classList.remove("is-active")
            }
            ), 300),
            this.opened = !1
        }
    }, {
        key: "onYesBtnClick",
        value: function() {
            railway._removeAllTrackPieces(),
            this.hide(),
            soundAudio.playSound("delete-all")
        }
    }, {
        key: "onNoBtnClick",
        value: function() {
            this.hide()
        }
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "update",
        value: function(e) {}
    }]),
    e
}()
  , confirmDelete = new ConfirmDelete
  , SpriteAnimationVolume = function() {
    function e(t) {
        var i = t.jsonSheets
          , r = t.spriteSheets
          , n = t.imgContainer
          , a = t.preventClickDelay;
        _classCallCheck2(this, e),
        this.jsonSheets = i,
        this.spriteSheets = r,
        this.state = null,
        this.stateFinished = !0,
        this.offHover = {
            json: this.jsonSheets[0],
            sprite: this.spriteSheets[0]
        },
        this.onHover = {
            json: this.jsonSheets[1],
            sprite: this.spriteSheets[1]
        },
        this.onToOff = {
            json: this.jsonSheets[2],
            sprite: this.spriteSheets[2]
        },
        this.offToOn = {
            json: this.jsonSheets[3],
            sprite: this.spriteSheets[3]
        },
        this.imgContainer = n,
        this.canvas = null,
        this.image = null,
        this.ctx = null,
        this.bcr = null,
        this.currentJson = null,
        this.currentSprite = null,
        this.currentFrame = 0,
        this.offsetX = 0,
        this.offsetY = 0,
        this.previousFrame = 0,
        this.time = 0,
        this.fps = 60,
        this.isAnimating = !1,
        this.lastClick = 0,
        this.mouseBeenOut = !1,
        this.lastHoverFrame = 0,
        this.speed = 1,
        this.preventClickDelay = a,
        this.onPointerOverCanvas = this.onPointerOverCanvas.bind(this),
        this.onClick = this.onClick.bind(this)
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this.totalSprites = 0,
            this.currentJson = this.onHover.json,
            this.currentSprite = this.onHover.sprite,
            this.totalSprites = this.currentJson.frames.length,
            this.state = "onHover"
        }
    }, {
        key: "createCanvas",
        value: function(e) {
            this.image = e,
            this.bcr = e.getBoundingClientRect(),
            this.canvas = document.createElement("canvas"),
            this.ctx = this.canvas.getContext("2d"),
            this.canvas.style.position = "absolute",
            this.canvas.style.width = this.bcr.width + "px",
            this.canvas.style.height = this.bcr.height + "px";
            var t = this.currentJson.frames[0].spriteSourceSize;
            this.canvas.width = t.w,
            this.canvas.height = t.h,
            e.parentNode.appendChild(this.canvas),
            this.createEvents(),
            this.currentFrame = this.totalSprites,
            this.drawSprite()
        }
    }, {
        key: "createEvents",
        value: function() {
            var e = this;
            this.imgContainer.addEventListener("pointerenter", (function() {
                return e.onPointerOverCanvas()
            }
            )),
            this.imgContainer.addEventListener("pointerleave", (function() {
                return e.onPointerOutCanvas()
            }
            ))
        }
    }, {
        key: "onPointerOverCanvas",
        value: function() {
            this.image.parentNode.classList.add("hide"),
            "onHover" !== this.state && "offHover" !== this.state || this.reset(),
            this.isAnimating = !0
        }
    }, {
        key: "onPointerOutCanvas",
        value: function() {
            this.stateFinished && this.image.parentNode.classList.remove("hide"),
            this.mouseBeenOut = !0
        }
    }, {
        key: "onClick",
        value: function(e) {
            var t = this.preventClickDelay ? this.preventClickDelay : 2e3;
            Date.now() - this.lastClick > t && (this.switchOnToOff(),
            this.stateFinished = !1,
            this.isAnimating = !0,
            this.mouseBeenOut = !1,
            "onToOff" === this.state ? this.image.parentNode.classList.add("off") : this.image.parentNode.classList.remove("off"),
            e(),
            this.lastClick = Date.now())
        }
    }, {
        key: "drawSprite",
        value: function() {
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            var e = this.currentJson.frames[this.currentFrame % this.totalSprites];
            this.ctx.drawImage(this.currentSprite, e.frame.x, e.frame.y, e.frame.w, e.frame.h, e.spriteSourceSize.x, e.spriteSourceSize.y, e.spriteSourceSize.w, e.spriteSourceSize.h)
        }
    }, {
        key: "updateSprite",
        value: function(e) {
            if ("onToOff" === this.state && !0 === this.stateFinished && this.switchOffHover(),
            "offToOn" === this.state && !0 === this.stateFinished)
                return this.switchOnHover(),
                void (this.speed = 1);
            if (this.isAnimating) {
                if (this.previousFrame = this.currentFrame,
                this.time += e,
                this.currentFrame = Math.floor(this.time * this.fps * this.speed),
                this.currentFrame >= this.totalSprites)
                    return this.stateFinished = !0,
                    this.mouseBeenOut && this.image.parentNode.classList.remove("hide"),
                    this.reset();
                this.currentFrame !== this.previousFrame && this.drawSprite()
            }
        }
    }, {
        key: "switchOffHover",
        value: function() {
            this.currentJson = this.offHover.json,
            this.currentSprite = this.offHover.sprite,
            this.reset(),
            this.state = "offHover"
        }
    }, {
        key: "switchOnHover",
        value: function() {
            this.currentJson = this.onHover.json,
            this.currentSprite = this.onHover.sprite,
            this.reset(),
            this.state = "onHover"
        }
    }, {
        key: "switchOnToOff",
        value: function() {
            "offHover" === this.state || "onToOff" === this.state ? (this.currentJson = this.offToOn.json,
            this.currentSprite = this.offToOn.sprite,
            this.state = "offToOn") : (this.currentJson = this.onToOff.json,
            this.currentSprite = this.onToOff.sprite,
            this.state = "onToOff"),
            this.reset()
        }
    }, {
        key: "reset",
        value: function() {
            this.isAnimating = !1,
            this.totalSprites = this.currentJson.frames.length,
            this.speed = 1,
            this.currentFrame = 0,
            this.time = 0
        }
    }]),
    e
}()
  , spriteHandler = function() {
    function e(t) {
        var i = t.btn
          , r = t.preventClickDelay;
        _classCallCheck2(this, e),
        this.btn = i,
        this.preventClickDelay = r,
        this.jsonSheets = [],
        this.spriteSheets = [],
        this.spriteAnimation = null,
        this.imgContainer = null,
        this.hoverElement = null
    }
    return _createClass2(e, [{
        key: "load",
        value: function(e) {
            var t = this;
            Array.isArray(e) ? e.forEach((function(e, i) {
                properties.loader.add(settings.IMAGE_PATH + e + ".json", {
                    weight: 100,
                    onLoad: function(e) {
                        t.jsonSheets[i] = e
                    }
                }),
                t.spriteSheets[i] = properties.loader.add(settings.IMAGE_PATH + e + ".png", {
                    weight: 100,
                    type: "image",
                    flipY: !1
                }).content
            }
            )) : (properties.loader.add(settings.IMAGE_PATH + e + ".json", {
                weight: 100,
                onLoad: function(e) {
                    t.jsonSheets[0] = e
                }
            }),
            this.spriteSheets[0] = properties.loader.add(settings.IMAGE_PATH + e + ".png", {
                weight: 100,
                type: "image",
                flipY: !1
            }).content)
        }
    }, {
        key: "init",
        value: function(e) {
            var t = e.volume
              , i = e.hover
              , r = e.hoverOut;
            if ("string" != typeof this.btn)
                this.imgContainer = this.btn.querySelector("img");
            else {
                var n = document.querySelector(this.btn);
                this.imgContainer = n.querySelector("img")
            }
            this.spriteAnimation = t ? new SpriteAnimationVolume({
                jsonSheets: this.jsonSheets,
                spriteSheets: this.spriteSheets,
                imgContainer: this.imgContainer,
                preventClickDelay: this.preventClickDelay
            }) : new SpriteAnimation({
                jsonSheets: this.jsonSheets,
                spriteSheets: this.spriteSheets,
                imgContainer: this.imgContainer,
                hover: i,
                hoverOut: r,
                hoverElement: this.imgContainer.closest(".trackEditor-btn")
            }),
            this.spriteAnimation.init()
        }
    }, {
        key: "show",
        value: function() {
            this.spriteAnimation.createCanvas(this.imgContainer)
        }
    }, {
        key: "update",
        value: function(e) {
            this.spriteAnimation && this.spriteAnimation.updateSprite(e)
        }
    }]),
    e
}();
function _classCallCheck(e, t) {
    if (!(e instanceof t))
        throw new TypeError("Cannot call a class as a function")
}
function _defineProperties(e, t) {
    for (var i = 0; i < t.length; i++) {
        var r = t[i];
        r.enumerable = r.enumerable || !1,
        r.configurable = !0,
        "value"in r && (r.writable = !0),
        Object.defineProperty(e, r.key, r)
    }
}
function _createClass(e, t, i) {
    return t && _defineProperties(e.prototype, t),
    i && _defineProperties(e, i),
    e
}
function extend(e, t) {
    return Object.getOwnPropertyNames(Object(e)).reduce((function(i, r) {
        var n = Object.getOwnPropertyDescriptor(Object(e), r)
          , a = Object.getOwnPropertyDescriptor(Object(t), r);
        return Object.defineProperty(i, r, a || n)
    }
    ), {})
}
function parseSettings(e) {
    var t = extend(e);
    return (t.types || t.split) && (t.types = t.types || t.split),
    (t.absolute || t.position) && (t.absolute = t.absolute || /absolute/.test(e.position)),
    t
}
function isObject(e) {
    return null !== e && "object" === _typeof2(e)
}
function isLength(e) {
    return "number" == typeof e && e > -1 && e % 1 == 0
}
function isArrayLike(e) {
    return isObject(e) && isLength(e.length)
}
function toArray(e) {
    return Array.isArray(e) ? e : null == e ? [] : isArrayLike(e) ? Array.prototype.slice.call(e) : [e]
}
function isNode(e) {
    return isObject(e) && /^(1|3|11)$/.test(e.nodeType)
}
function isString(e) {
    return "string" == typeof e
}
function flatten(e) {
    return toArray(e).reduce((function(e, t) {
        return e.concat(toArray(t))
    }
    ), [])
}
function getTargetElements(e) {
    var t = e;
    return isString(e) && (t = /^(#[a-z]\w+)$/.test(e.trim()) ? document.getElementById(e.trim().slice(1)) : document.querySelectorAll(e)),
    flatten(t).filter(isNode)
}
function Data(e, t, i) {
    var r = {}
      , n = null;
    return isObject(e) && (n = e[Data.expando] || (e[Data.expando] = ++Data.uid),
    r = Data.cache[n] || (Data.cache[n] = {})),
    void 0 === i ? void 0 === t ? r : r[t] : void 0 !== t ? (r[t] = i,
    i) : void 0
}
function RemoveData(e) {
    var t = e && e[Data.expando];
    t && (delete e[t],
    delete Data.cache[t])
}
function forEach(e, t) {
    for (var i = toArray(e), r = i.length, n = 0; n < r; n++)
        t(i[n], n, i)
}
function toWords(e) {
    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : " ";
    return (e = e ? String(e) : "").split(t)
}
Data.expando = "splitType".concat(1 * new Date),
Data.cache = {},
Data.uid = 0;
var rsAstralRange = "\\ud800-\\udfff"
  , rsComboMarksRange = "\\u0300-\\u036f\\ufe20-\\ufe23"
  , rsComboSymbolsRange = "\\u20d0-\\u20f0"
  , rsVarRange = "\\ufe0e\\ufe0f"
  , rsAstral = "[".concat(rsAstralRange, "]")
  , rsCombo = "[".concat(rsComboMarksRange).concat(rsComboSymbolsRange, "]")
  , rsFitz = "\\ud83c[\\udffb-\\udfff]"
  , rsModifier = "(?:".concat(rsCombo, "|").concat(rsFitz, ")")
  , rsNonAstral = "[^".concat(rsAstralRange, "]")
  , rsRegional = "(?:\\ud83c[\\udde6-\\uddff]){2}"
  , rsSurrPair = "[\\ud800-\\udbff][\\udc00-\\udfff]"
  , rsZWJ = "\\u200d"
  , reOptMod = "".concat(rsModifier, "?")
  , rsOptVar = "[".concat(rsVarRange, "]?")
  , rsOptJoin = "(?:" + rsZWJ + "(?:" + [rsNonAstral, rsRegional, rsSurrPair].join("|") + ")" + rsOptVar + reOptMod + ")*"
  , rsSeq = rsOptVar + reOptMod + rsOptJoin
  , rsSymbol = "(?:".concat(["".concat(rsNonAstral).concat(rsCombo, "?"), rsCombo, rsRegional, rsSurrPair, rsAstral].join("|"), "\n)")
  , reUnicode = RegExp("".concat(rsFitz, "(?=").concat(rsFitz, ")|").concat(rsSymbol).concat(rsSeq), "g")
  , unicodeRange = [rsZWJ, rsAstralRange, rsComboMarksRange, rsComboSymbolsRange, rsVarRange]
  , reHasUnicode = RegExp("[".concat(unicodeRange.join(""), "]"));
function asciiToArray(e) {
    return e.split("")
}
function hasUnicode(e) {
    return reHasUnicode.test(e)
}
function unicodeToArray(e) {
    return e.match(reUnicode) || []
}
function stringToArray(e) {
    return hasUnicode(e) ? unicodeToArray(e) : asciiToArray(e)
}
function toString(e) {
    return null == e ? "" : String(e)
}
function toChars(e) {
    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "";
    return (e = toString(e)) && isString(e) && !t && hasUnicode(e) ? stringToArray(e) : e.split(t)
}
function createElement(e, t) {
    var i = document.createElement(e);
    return t ? (Object.keys(t).forEach((function(e) {
        var r = t[e];
        null !== r && ("textContent" === e || "innerHTML" === e ? i[e] = r : "children" === e ? forEach(r, (function(e) {
            isNode(e) && i.appendChild(e)
        }
        )) : i.setAttribute(e, String(r).trim()))
    }
    )),
    i) : i
}
function parseTypes(e) {
    var t = isString(e) || Array.isArray(e) ? String(e) : "";
    return {
        lines: /line/i.test(t),
        words: /word/i.test(t),
        chars: /(char)|(character)/i.test(t)
    }
}
function getTextContent(e, t) {
    var i = e.textContent;
    if (t) {
        var r = e.innerHTML
          , n = document.createElement("div");
        n.innerHTML = r.replace(/<br\s*\/?>/g, " ".concat(t, " ")),
        i = n.textContent
    }
    return i.replace(/\s+/g, " ").trim()
}
var defaults = {
    splitClass: "",
    lineClass: "line",
    wordClass: "word",
    charClass: "char",
    types: "lines, words, chars",
    absolute: !1,
    tagName: "div"
}
  , createFragment = function() {
    return document.createDocumentFragment()
}
  , createTextNode = function(e) {
    return document.createTextNode(e)
};
function splitSingleElement(e, t) {
    var i, r, n = parseTypes((t = extend(defaults, t)).types), a = t.tagName, o = "B".concat(1 * new Date, "R"), s = "absolute" === t.position || t.absolute, l = [], h = [];
    if (r = n.lines ? createElement("div") : createFragment(),
    i = toWords(getTextContent(e, o)).reduce((function(e, i, s, l) {
        var c, p;
        return i === o ? (r.appendChild(createElement("br")),
        e) : (n.chars && (p = toChars(i).map((function(e) {
            return createElement(a, {
                class: "".concat(t.splitClass, " ").concat(t.charClass),
                style: "display: inline-block;",
                textContent: e
            })
        }
        )),
        h = h.concat(p)),
        n.words || n.lines ? (c = createElement(a, {
            class: "".concat(t.wordClass, " ").concat(t.splitClass),
            style: "display: inline-block; position: ".concat(n.words ? "relative" : "static"),
            children: n.chars ? p : null,
            textContent: n.chars ? null : i
        }),
        r.appendChild(c)) : forEach(p, (function(e) {
            r.appendChild(e)
        }
        )),
        s !== l.length - 1 && r.appendChild(createTextNode(" ")),
        n.words ? e.concat(c) : e)
    }
    ), []),
    e.innerHTML = "",
    e.appendChild(r),
    !s && !n.lines)
        return {
            chars: h,
            words: i,
            lines: []
        };
    var c, p, u, d, f, m = [], g = [], v = Data(e, "nodes", e.getElementsByTagName(a)), y = e.parentElement, _ = e.nextElementSibling, b = window.getComputedStyle(e).textAlign;
    return s && (d = {
        left: r.offsetLeft,
        top: r.offsetTop,
        width: r.offsetWidth
    },
    u = e.offsetWidth,
    p = e.offsetHeight,
    Data(e).cssWidth = e.style.width,
    Data(e).cssHeight = e.style.height),
    forEach(v, (function(e) {
        if (e !== r) {
            var t, i = e.parentElement === r;
            n.lines && i && ((t = Data(e, "top", e.offsetTop)) !== f && (f = t,
            m.push(g = [])),
            g.push(e)),
            s && (Data(e).top = t || e.offsetTop,
            Data(e).left = e.offsetLeft,
            Data(e).width = e.offsetWidth,
            Data(e).height = c || (c = e.offsetHeight))
        }
    }
    )),
    y && y.removeChild(e),
    n.lines && (r = createFragment(),
    l = m.map((function(e) {
        var i = createElement(a, {
            class: "".concat(t.splitClass, " ").concat(t.lineClass),
            style: "display: block; text-align: ".concat(b, "; width: 100%;")
        });
        return r.appendChild(i),
        s && (Data(i).type = "line",
        Data(i).top = Data(e[0]).top,
        Data(i).height = c),
        forEach(e, (function(e, t, r) {
            n.words ? i.appendChild(e) : n.chars ? forEach(e.children, (function(e) {
                i.appendChild(e)
            }
            )) : i.appendChild(createTextNode(e.textContent)),
            t !== r.length - 1 && i.appendChild(createTextNode(" "))
        }
        )),
        i
    }
    )),
    e.replaceChild(r, e.firstChild)),
    s && (e.style.width = "".concat(e.style.width || u, "px"),
    e.style.height = "".concat(p, "px"),
    forEach(v, (function(e) {
        var t = "line" === Data(e).type
          , i = !t && "line" === Data(e.parentElement).type;
        e.style.top = "".concat(i ? 0 : Data(e).top, "px"),
        e.style.left = "".concat(t ? d.left : Data(e).left - (i ? d.left : 0), "px"),
        e.style.height = "".concat(Data(e).height, "px"),
        e.style.width = "".concat(t ? d.width : Data(e).width, "px"),
        e.style.position = "absolute"
    }
    ))),
    y && (_ ? y.insertBefore(e, _) : y.appendChild(e)),
    {
        lines: l,
        words: n.words ? i : [],
        chars: h
    }
}
var _defaults = extend(defaults, {}), SplitType = function() {
    function e(t, i) {
        _classCallCheck(this, e),
        this.isSplit = !1,
        this.settings = extend(_defaults, parseSettings(i)),
        this.elements = getTargetElements(t) || [],
        this.elements.length && (this.originals = this.elements.map((function(e) {
            return Data(e, "html", Data(e).html || e.innerHTML)
        }
        )),
        this.settings.types && this.split())
    }
    return _createClass(e, null, [{
        key: "defaults",
        get: function() {
            return _defaults
        },
        set: function(e) {
            _defaults = extend(_defaults, parseSettings(e))
        }
    }]),
    _createClass(e, [{
        key: "split",
        value: function(e) {
            var t = this;
            this.revert(),
            this.lines = [],
            this.words = [],
            this.chars = [];
            var i = [window.pageXOffset, window.pageYOffset];
            void 0 !== e && (this.settings = extend(this.settings, parseSettings(e))),
            this.elements.forEach((function(e) {
                var i = splitSingleElement(e, t.settings)
                  , r = i.lines
                  , n = i.words
                  , a = i.chars;
                t.lines = t.lines.concat(r),
                t.words = t.words.concat(n),
                t.chars = t.chars.concat(a),
                Data(e).isSplit = !0
            }
            )),
            this.isSplit = !0,
            window.scrollTo(i[0], i[1]),
            this.elements.forEach((function(e) {
                toArray(Data(e).nodes || []).forEach(RemoveData)
            }
            ))
        }
    }, {
        key: "revert",
        value: function() {
            var e = this;
            this.isSplit && (this.lines = null,
            this.words = null,
            this.chars = null),
            this.elements.forEach((function(t) {
                Data(t).isSplit && Data(t).html && (t.innerHTML = Data(t).html,
                t.style.height = Data(t).cssHeight || "",
                t.style.width = Data(t).cssWidth || "",
                e.isSplit = !1)
            }
            ))
        }
    }]),
    e
}(), DOMUtils = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "textSplited", void 0),
        _defineProperty2(this, "colors", void 0)
    }
    return _createClass2(e, [{
        key: "textSplit",
        value: function(e, t, i, r) {
            var n = this;
            this.textSplited = new SplitType(e,{
                types: t,
                tagName: "span"
            }),
            this.colors = ["#FBD75A", "#76E0A7", "#E26CC1", "#F86F66", "#FABE66"];
            var a = function(e, r, n) {
                var a = document.createElement("span");
                a.classList.add("".concat(n, "-content")),
                "words, chars" !== t && "chars, words" !== t && (a.style.transform = "translate3d(0, 110%, 0)"),
                a.style.display = "inline-block",
                _toConsumableArray(e.childNodes).forEach((function(e, t) {
                    a.appendChild(e)
                }
                )),
                e.appendChild(a),
                i && (e.style.overflow = "hidden")
            }
              , o = function(e, t, i) {
                for (var r = 0; r < e.length; r++)
                    a(e[r], 0, i)
            };
            return this.textSplited.lineContents = [],
            this.textSplited.wordContents = [],
            this.textSplited.charContents = [],
            o(this.textSplited.lines, this.textSplited.lineContents, "line"),
            o(this.textSplited.words, this.textSplited.wordContents, "word"),
            o(this.textSplited.chars, this.textSplited.charContents, "char"),
            "lines" === t ? this.textSplited.lines.forEach((function(e, t) {
                var i = t / 10;
                e.querySelector("span").style.setProperty("--delay", "".concat(r ? r + i : i, "s"))
            }
            )) : this.textSplited.chars.forEach((function(e, t) {
                var i = t / 60
                  , a = e.querySelector("span");
                a.style.setProperty("--delay", "".concat(r ? r + i : i, "s")),
                a.style.transform = "translate3d(0, 20px, 0) scale(0)",
                e.style.setProperty("--hover-rotate", "".concat(t % 2 == 1 ? 5 : -5, "deg")),
                e.style.setProperty("--hover-color", n.colors[t % n.colors.length])
            }
            )),
            this.textSplited
        }
    }, {
        key: "onResize",
        value: function() {
            this.textSplited.revert()
        }
    }]),
    e
}(), DOMUtils$1 = new DOMUtils, _populated = !1, _ie, _firefox, _opera, _webkit, _chrome, _ie_real_version, _osx, _windows, _linux, _android, _win64, _iphone, _ipad, _native, _mobile;
function _populate() {
    if (!_populated) {
        _populated = !0;
        var e = navigator.userAgent
          , t = /(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e)
          , i = /(Mac OS X)|(Windows)|(Linux)/.exec(e);
        if (_iphone = /\b(iPhone|iP[ao]d)/.exec(e),
        _ipad = /\b(iP[ao]d)/.exec(e),
        _android = /Android/i.exec(e),
        _native = /FBAN\/\w+;/i.exec(e),
        _mobile = /Mobile/i.exec(e),
        _win64 = !!/Win64/.exec(e),
        t) {
            (_ie = t[1] ? parseFloat(t[1]) : t[5] ? parseFloat(t[5]) : NaN) && document && document.documentMode && (_ie = document.documentMode);
            var r = /(?:Trident\/(\d+.\d+))/.exec(e);
            _ie_real_version = r ? parseFloat(r[1]) + 4 : _ie,
            _firefox = t[2] ? parseFloat(t[2]) : NaN,
            _opera = t[3] ? parseFloat(t[3]) : NaN,
            (_webkit = t[4] ? parseFloat(t[4]) : NaN) ? (t = /(?:Chrome\/(\d+\.\d+))/.exec(e),
            _chrome = t && t[1] ? parseFloat(t[1]) : NaN) : _chrome = NaN
        } else
            _ie = _firefox = _opera = _chrome = _webkit = NaN;
        if (i) {
            if (i[1]) {
                var n = /(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);
                _osx = !n || parseFloat(n[1].replace("_", "."))
            } else
                _osx = !1;
            _windows = !!i[2],
            _linux = !!i[3]
        } else
            _osx = _windows = _linux = !1
    }
}
var UserAgent_DEPRECATED$1 = {
    ie: function() {
        return _populate() || _ie
    },
    ieCompatibilityMode: function() {
        return _populate() || _ie_real_version > _ie
    },
    ie64: function() {
        return UserAgent_DEPRECATED$1.ie() && _win64
    },
    firefox: function() {
        return _populate() || _firefox
    },
    opera: function() {
        return _populate() || _opera
    },
    webkit: function() {
        return _populate() || _webkit
    },
    safari: function() {
        return UserAgent_DEPRECATED$1.webkit()
    },
    chrome: function() {
        return _populate() || _chrome
    },
    windows: function() {
        return _populate() || _windows
    },
    osx: function() {
        return _populate() || _osx
    },
    linux: function() {
        return _populate() || _linux
    },
    iphone: function() {
        return _populate() || _iphone
    },
    mobile: function() {
        return _populate() || _iphone || _ipad || _android || _mobile
    },
    nativeApp: function() {
        return _populate() || _native
    },
    android: function() {
        return _populate() || _android
    },
    ipad: function() {
        return _populate() || _ipad
    }
}, UserAgent_DEPRECATED_1 = UserAgent_DEPRECATED$1, canUseDOM = !("undefined" == typeof window || !window.document || !window.document.createElement), ExecutionEnvironment$1 = {
    canUseDOM,
    canUseWorkers: "undefined" != typeof Worker,
    canUseEventListeners: canUseDOM && !(!window.addEventListener && !window.attachEvent),
    canUseViewport: canUseDOM && !!window.screen,
    isInWorker: !canUseDOM
}, ExecutionEnvironment_1 = ExecutionEnvironment$1, ExecutionEnvironment = ExecutionEnvironment_1, useHasFeature;
function isEventSupported$1(e, t) {
    if (!ExecutionEnvironment.canUseDOM || t && !("addEventListener"in document))
        return !1;
    var i = "on" + e
      , r = i in document;
    if (!r) {
        var n = document.createElement("div");
        n.setAttribute(i, "return;"),
        r = "function" == typeof n[i]
    }
    return !r && useHasFeature && "wheel" === e && (r = document.implementation.hasFeature("Events.wheel", "3.0")),
    r
}
ExecutionEnvironment.canUseDOM && (useHasFeature = document.implementation && document.implementation.hasFeature && !0 !== document.implementation.hasFeature("", ""));
var isEventSupported_1 = isEventSupported$1
  , UserAgent_DEPRECATED = UserAgent_DEPRECATED_1
  , isEventSupported = isEventSupported_1
  , PIXEL_STEP = 10
  , LINE_HEIGHT = 40
  , PAGE_HEIGHT = 800;
function normalizeWheel$1(e) {
    var t = 0
      , i = 0
      , r = 0
      , n = 0;
    return "detail"in e && (i = e.detail),
    "wheelDelta"in e && (i = -e.wheelDelta / 120),
    "wheelDeltaY"in e && (i = -e.wheelDeltaY / 120),
    "wheelDeltaX"in e && (t = -e.wheelDeltaX / 120),
    "axis"in e && e.axis === e.HORIZONTAL_AXIS && (t = i,
    i = 0),
    r = t * PIXEL_STEP,
    n = i * PIXEL_STEP,
    "deltaY"in e && (n = e.deltaY),
    "deltaX"in e && (r = e.deltaX),
    (r || n) && e.deltaMode && (1 == e.deltaMode ? (r *= LINE_HEIGHT,
    n *= LINE_HEIGHT) : (r *= PAGE_HEIGHT,
    n *= PAGE_HEIGHT)),
    r && !t && (t = r < 1 ? -1 : 1),
    n && !i && (i = n < 1 ? -1 : 1),
    {
        spinX: t,
        spinY: i,
        pixelX: r,
        pixelY: n
    }
}
normalizeWheel$1.getEventType = function() {
    return UserAgent_DEPRECATED.firefox() ? "DOMMouseScroll" : isEventSupported("wheel") ? "wheel" : "mousewheel"
}
;
var normalizeWheel_1 = normalizeWheel$1
  , normalizeWheel = normalizeWheel_1
  , lottie$1 = {
    exports: {}
};
(function(module, exports) {
    var factory2;
    "undefined" != typeof navigator && (factory2 = function() {
        var svgNS = "http://www.w3.org/2000/svg"
          , locationHref = ""
          , _useWebWorker = !1
          , initialDefaultFrame = -999999
          , setWebWorker = function(e) {
            _useWebWorker = !!e
        }
          , getWebWorker = function() {
            return _useWebWorker
        }
          , setLocationHref = function(e) {
            locationHref = e
        }
          , getLocationHref = function() {
            return locationHref
        };
        function createTag(e) {
            return document.createElement(e)
        }
        function extendPrototype(e, t) {
            var i, r, n = e.length;
            for (i = 0; i < n; i += 1)
                for (var a in r = e[i].prototype)
                    Object.prototype.hasOwnProperty.call(r, a) && (t.prototype[a] = r[a])
        }
        function getDescriptor(e, t) {
            return Object.getOwnPropertyDescriptor(e, t)
        }
        function createProxyFunction(e) {
            function t() {}
            return t.prototype = e,
            t
        }
        var audioControllerFactory = function() {
            function e(e) {
                this.audios = [],
                this.audioFactory = e,
                this._volume = 1,
                this._isMuted = !1
            }
            return e.prototype = {
                addAudio: function(e) {
                    this.audios.push(e)
                },
                pause: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].pause()
                },
                resume: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].resume()
                },
                setRate: function(e) {
                    var t, i = this.audios.length;
                    for (t = 0; t < i; t += 1)
                        this.audios[t].setRate(e)
                },
                createAudio: function(e) {
                    return this.audioFactory ? this.audioFactory(e) : window.Howl ? new window.Howl({
                        src: [e]
                    }) : {
                        isPlaying: !1,
                        play: function() {
                            this.isPlaying = !0
                        },
                        seek: function() {
                            this.isPlaying = !1
                        },
                        playing: function() {},
                        rate: function() {},
                        setVolume: function() {}
                    }
                },
                setAudioFactory: function(e) {
                    this.audioFactory = e
                },
                setVolume: function(e) {
                    this._volume = e,
                    this._updateVolume()
                },
                mute: function() {
                    this._isMuted = !0,
                    this._updateVolume()
                },
                unmute: function() {
                    this._isMuted = !1,
                    this._updateVolume()
                },
                getVolume: function() {
                    return this._volume
                },
                _updateVolume: function() {
                    var e, t = this.audios.length;
                    for (e = 0; e < t; e += 1)
                        this.audios[e].volume(this._volume * (this._isMuted ? 0 : 1))
                }
            },
            function() {
                return new e
            }
        }()
          , createTypedArray = function() {
            function e(e, t) {
                var i, r = 0, n = [];
                switch (e) {
                case "int16":
                case "uint8c":
                    i = 1;
                    break;
                default:
                    i = 1.1
                }
                for (r = 0; r < t; r += 1)
                    n.push(i);
                return n
            }
            return "function" == typeof Uint8ClampedArray && "function" == typeof Float32Array ? function(t, i) {
                return "float32" === t ? new Float32Array(i) : "int16" === t ? new Int16Array(i) : "uint8c" === t ? new Uint8ClampedArray(i) : e(t, i)
            }
            : e
        }();
        function createSizedArray(e) {
            return Array.apply(null, {
                length: e
            })
        }
        function _typeof$6(e) {
            return (_typeof$6 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        var subframeEnabled = !0
          , expressionsPlugin = null
          , idPrefix$1 = ""
          , isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent)
          , bmPow = Math.pow
          , bmSqrt = Math.sqrt
          , bmFloor = Math.floor
          , bmMax = Math.max
          , bmMin = Math.min
          , BMMath = {};
        !function() {
            var e, t = ["abs", "acos", "acosh", "asin", "asinh", "atan", "atanh", "atan2", "ceil", "cbrt", "expm1", "clz32", "cos", "cosh", "exp", "floor", "fround", "hypot", "imul", "log", "log1p", "log2", "log10", "max", "min", "pow", "random", "round", "sign", "sin", "sinh", "sqrt", "tan", "tanh", "trunc", "E", "LN10", "LN2", "LOG10E", "LOG2E", "PI", "SQRT1_2", "SQRT2"], i = t.length;
            for (e = 0; e < i; e += 1)
                BMMath[t[e]] = Math[t[e]]
        }(),
        BMMath.random = Math.random,
        BMMath.abs = function(e) {
            if ("object" === _typeof$6(e) && e.length) {
                var t, i = createSizedArray(e.length), r = e.length;
                for (t = 0; t < r; t += 1)
                    i[t] = Math.abs(e[t]);
                return i
            }
            return Math.abs(e)
        }
        ;
        var defaultCurveSegments = 150
          , degToRads = Math.PI / 180
          , roundCorner = .5519;
        function styleDiv(e) {
            e.style.position = "absolute",
            e.style.top = 0,
            e.style.left = 0,
            e.style.display = "block",
            e.style.transformOrigin = "0 0",
            e.style.webkitTransformOrigin = "0 0",
            e.style.backfaceVisibility = "visible",
            e.style.webkitBackfaceVisibility = "visible",
            e.style.transformStyle = "preserve-3d",
            e.style.webkitTransformStyle = "preserve-3d",
            e.style.mozTransformStyle = "preserve-3d"
        }
        function BMEnterFrameEvent(e, t, i, r) {
            this.type = e,
            this.currentTime = t,
            this.totalTime = i,
            this.direction = r < 0 ? -1 : 1
        }
        function BMCompleteEvent(e, t) {
            this.type = e,
            this.direction = t < 0 ? -1 : 1
        }
        function BMCompleteLoopEvent(e, t, i, r) {
            this.type = e,
            this.currentLoop = i,
            this.totalLoops = t,
            this.direction = r < 0 ? -1 : 1
        }
        function BMSegmentStartEvent(e, t, i) {
            this.type = e,
            this.firstFrame = t,
            this.totalFrames = i
        }
        function BMDestroyEvent(e, t) {
            this.type = e,
            this.target = t
        }
        function BMRenderFrameErrorEvent(e, t) {
            this.type = "renderFrameError",
            this.nativeError = e,
            this.currentTime = t
        }
        function BMConfigErrorEvent(e) {
            this.type = "configError",
            this.nativeError = e
        }
        var createElementID = (_count2 = 0,
        function() {
            return idPrefix$1 + "__lottie_element_" + (_count2 += 1)
        }
        ), _count2;
        function HSVtoRGB(e, t, i) {
            var r, n, a, o, s, l, h, c;
            switch (l = i * (1 - t),
            h = i * (1 - (s = 6 * e - (o = Math.floor(6 * e))) * t),
            c = i * (1 - (1 - s) * t),
            o % 6) {
            case 0:
                r = i,
                n = c,
                a = l;
                break;
            case 1:
                r = h,
                n = i,
                a = l;
                break;
            case 2:
                r = l,
                n = i,
                a = c;
                break;
            case 3:
                r = l,
                n = h,
                a = i;
                break;
            case 4:
                r = c,
                n = l,
                a = i;
                break;
            case 5:
                r = i,
                n = l,
                a = h
            }
            return [r, n, a]
        }
        function RGBtoHSV(e, t, i) {
            var r, n = Math.max(e, t, i), a = Math.min(e, t, i), o = n - a, s = 0 === n ? 0 : o / n, l = n / 255;
            switch (n) {
            case a:
                r = 0;
                break;
            case e:
                r = t - i + o * (t < i ? 6 : 0),
                r /= 6 * o;
                break;
            case t:
                r = i - e + 2 * o,
                r /= 6 * o;
                break;
            case i:
                r = e - t + 4 * o,
                r /= 6 * o
            }
            return [r, s, l]
        }
        function addSaturationToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[1] += t,
            i[1] > 1 ? i[1] = 1 : i[1] <= 0 && (i[1] = 0),
            HSVtoRGB(i[0], i[1], i[2])
        }
        function addBrightnessToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[2] += t,
            i[2] > 1 ? i[2] = 1 : i[2] < 0 && (i[2] = 0),
            HSVtoRGB(i[0], i[1], i[2])
        }
        function addHueToRGB(e, t) {
            var i = RGBtoHSV(255 * e[0], 255 * e[1], 255 * e[2]);
            return i[0] += t / 360,
            i[0] > 1 ? i[0] -= 1 : i[0] < 0 && (i[0] += 1),
            HSVtoRGB(i[0], i[1], i[2])
        }
        var rgbToHex = function() {
            var e, t, i = [];
            for (e = 0; e < 256; e += 1)
                t = e.toString(16),
                i[e] = 1 === t.length ? "0" + t : t;
            return function(e, t, r) {
                return e < 0 && (e = 0),
                t < 0 && (t = 0),
                r < 0 && (r = 0),
                "#" + i[e] + i[t] + i[r]
            }
        }()
          , setSubframeEnabled = function(e) {
            subframeEnabled = !!e
        }
          , getSubframeEnabled = function() {
            return subframeEnabled
        }
          , setExpressionsPlugin = function(e) {
            expressionsPlugin = e
        }
          , getExpressionsPlugin = function() {
            return expressionsPlugin
        }
          , setDefaultCurveSegments = function(e) {
            defaultCurveSegments = e
        }
          , getDefaultCurveSegments = function() {
            return defaultCurveSegments
        }
          , setIdPrefix = function(e) {
            idPrefix$1 = e
        };
        function createNS(e) {
            return document.createElementNS(svgNS, e)
        }
        function _typeof$5(e) {
            return (_typeof$5 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        var dataManager = function() {
            var e, t, i = 1, r = [], n = {
                onmessage: function() {},
                postMessage: function(t) {
                    e({
                        data: t
                    })
                }
            }, a = {
                postMessage: function(e) {
                    n.onmessage({
                        data: e
                    })
                }
            };
            function o() {
                t || ((t = function(t) {
                    if (window.Worker && window.Blob && getWebWorker()) {
                        var i = new Blob(["var _workerSelf = self; self.onmessage = ", t.toString()],{
                            type: "text/javascript"
                        })
                          , r = URL.createObjectURL(i);
                        return new Worker(r)
                    }
                    return e = t,
                    n
                }((function(e) {
                    if (a.dataManager || (a.dataManager = function() {
                        function e(n, a) {
                            var o, s, l, h, c, p, u, d = n.length;
                            for (s = 0; s < d; s += 1)
                                if ("ks"in (o = n[s]) && !o.completed) {
                                    if (o.completed = !0,
                                    o.tt && (n[s - 1].td = o.tt),
                                    o.hasMask) {
                                        var f = o.masksProperties;
                                        for (h = f.length,
                                        l = 0; l < h; l += 1)
                                            if (f[l].pt.k.i)
                                                r(f[l].pt.k);
                                            else
                                                for (p = f[l].pt.k.length,
                                                c = 0; c < p; c += 1)
                                                    f[l].pt.k[c].s && r(f[l].pt.k[c].s[0]),
                                                    f[l].pt.k[c].e && r(f[l].pt.k[c].e[0])
                                    }
                                    0 === o.ty ? (o.layers = t(o.refId, a),
                                    e(o.layers, a)) : 4 === o.ty ? i(o.shapes) : 5 === o.ty && (0 === (u = o).t.a.length && u.t.p)
                                }
                        }
                        function t(e, t) {
                            var i = function(e, t) {
                                for (var i = 0, r = t.length; i < r; ) {
                                    if (t[i].id === e)
                                        return t[i];
                                    i += 1
                                }
                                return null
                            }(e, t);
                            return i ? i.layers.__used ? JSON.parse(JSON.stringify(i.layers)) : (i.layers.__used = !0,
                            i.layers) : null
                        }
                        function i(e) {
                            var t, n, a;
                            for (t = e.length - 1; t >= 0; t -= 1)
                                if ("sh" === e[t].ty)
                                    if (e[t].ks.k.i)
                                        r(e[t].ks.k);
                                    else
                                        for (a = e[t].ks.k.length,
                                        n = 0; n < a; n += 1)
                                            e[t].ks.k[n].s && r(e[t].ks.k[n].s[0]),
                                            e[t].ks.k[n].e && r(e[t].ks.k[n].e[0]);
                                else
                                    "gr" === e[t].ty && i(e[t].it)
                        }
                        function r(e) {
                            var t, i = e.i.length;
                            for (t = 0; t < i; t += 1)
                                e.i[t][0] += e.v[t][0],
                                e.i[t][1] += e.v[t][1],
                                e.o[t][0] += e.v[t][0],
                                e.o[t][1] += e.v[t][1]
                        }
                        function n(e, t) {
                            var i = t ? t.split(".") : [100, 100, 100];
                            return e[0] > i[0] || !(i[0] > e[0]) && (e[1] > i[1] || !(i[1] > e[1]) && (e[2] > i[2] || !(i[2] > e[2]) && null))
                        }
                        var a, o = function() {
                            var e = [4, 4, 14];
                            function t(e) {
                                var t, i, r, n = e.length;
                                for (t = 0; t < n; t += 1)
                                    5 === e[t].ty && (void 0,
                                    r = (i = e[t]).t.d,
                                    i.t.d = {
                                        k: [{
                                            s: r,
                                            t: 0
                                        }]
                                    })
                            }
                            return function(i) {
                                if (n(e, i.v) && (t(i.layers),
                                i.assets)) {
                                    var r, a = i.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        i.assets[r].layers && t(i.assets[r].layers)
                                }
                            }
                        }(), s = (a = [4, 7, 99],
                        function(e) {
                            if (e.chars && !n(a, e.v)) {
                                var t, r = e.chars.length;
                                for (t = 0; t < r; t += 1) {
                                    var o = e.chars[t];
                                    o.data && o.data.shapes && (i(o.data.shapes),
                                    o.data.ip = 0,
                                    o.data.op = 99999,
                                    o.data.st = 0,
                                    o.data.sr = 1,
                                    o.data.ks = {
                                        p: {
                                            k: [0, 0],
                                            a: 0
                                        },
                                        s: {
                                            k: [100, 100],
                                            a: 0
                                        },
                                        a: {
                                            k: [0, 0],
                                            a: 0
                                        },
                                        r: {
                                            k: 0,
                                            a: 0
                                        },
                                        o: {
                                            k: 100,
                                            a: 0
                                        }
                                    },
                                    e.chars[t].t || (o.data.shapes.push({
                                        ty: "no"
                                    }),
                                    o.data.shapes[0].it.push({
                                        p: {
                                            k: [0, 0],
                                            a: 0
                                        },
                                        s: {
                                            k: [100, 100],
                                            a: 0
                                        },
                                        a: {
                                            k: [0, 0],
                                            a: 0
                                        },
                                        r: {
                                            k: 0,
                                            a: 0
                                        },
                                        o: {
                                            k: 100,
                                            a: 0
                                        },
                                        sk: {
                                            k: 0,
                                            a: 0
                                        },
                                        sa: {
                                            k: 0,
                                            a: 0
                                        },
                                        ty: "tr"
                                    })))
                                }
                            }
                        }
                        ), l = function() {
                            var e = [5, 7, 15];
                            function t(e) {
                                var t, i, r = e.length;
                                for (t = 0; t < r; t += 1)
                                    5 === e[t].ty && (i = void 0,
                                    "number" == typeof (i = e[t].t.p).a && (i.a = {
                                        a: 0,
                                        k: i.a
                                    }),
                                    "number" == typeof i.p && (i.p = {
                                        a: 0,
                                        k: i.p
                                    }),
                                    "number" == typeof i.r && (i.r = {
                                        a: 0,
                                        k: i.r
                                    }))
                            }
                            return function(i) {
                                if (n(e, i.v) && (t(i.layers),
                                i.assets)) {
                                    var r, a = i.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        i.assets[r].layers && t(i.assets[r].layers)
                                }
                            }
                        }(), h = function() {
                            var e = [4, 1, 9];
                            function t(e) {
                                var i, r, n, a = e.length;
                                for (i = 0; i < a; i += 1)
                                    if ("gr" === e[i].ty)
                                        t(e[i].it);
                                    else if ("fl" === e[i].ty || "st" === e[i].ty)
                                        if (e[i].c.k && e[i].c.k[0].i)
                                            for (n = e[i].c.k.length,
                                            r = 0; r < n; r += 1)
                                                e[i].c.k[r].s && (e[i].c.k[r].s[0] /= 255,
                                                e[i].c.k[r].s[1] /= 255,
                                                e[i].c.k[r].s[2] /= 255,
                                                e[i].c.k[r].s[3] /= 255),
                                                e[i].c.k[r].e && (e[i].c.k[r].e[0] /= 255,
                                                e[i].c.k[r].e[1] /= 255,
                                                e[i].c.k[r].e[2] /= 255,
                                                e[i].c.k[r].e[3] /= 255);
                                        else
                                            e[i].c.k[0] /= 255,
                                            e[i].c.k[1] /= 255,
                                            e[i].c.k[2] /= 255,
                                            e[i].c.k[3] /= 255
                            }
                            function i(e) {
                                var i, r = e.length;
                                for (i = 0; i < r; i += 1)
                                    4 === e[i].ty && t(e[i].shapes)
                            }
                            return function(t) {
                                if (n(e, t.v) && (i(t.layers),
                                t.assets)) {
                                    var r, a = t.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        t.assets[r].layers && i(t.assets[r].layers)
                                }
                            }
                        }(), c = function() {
                            var e = [4, 4, 18];
                            function t(e) {
                                var i, r, n;
                                for (i = e.length - 1; i >= 0; i -= 1)
                                    if ("sh" === e[i].ty)
                                        if (e[i].ks.k.i)
                                            e[i].ks.k.c = e[i].closed;
                                        else
                                            for (n = e[i].ks.k.length,
                                            r = 0; r < n; r += 1)
                                                e[i].ks.k[r].s && (e[i].ks.k[r].s[0].c = e[i].closed),
                                                e[i].ks.k[r].e && (e[i].ks.k[r].e[0].c = e[i].closed);
                                    else
                                        "gr" === e[i].ty && t(e[i].it)
                            }
                            function i(e) {
                                var i, r, n, a, o, s, l = e.length;
                                for (r = 0; r < l; r += 1) {
                                    if ((i = e[r]).hasMask) {
                                        var h = i.masksProperties;
                                        for (a = h.length,
                                        n = 0; n < a; n += 1)
                                            if (h[n].pt.k.i)
                                                h[n].pt.k.c = h[n].cl;
                                            else
                                                for (s = h[n].pt.k.length,
                                                o = 0; o < s; o += 1)
                                                    h[n].pt.k[o].s && (h[n].pt.k[o].s[0].c = h[n].cl),
                                                    h[n].pt.k[o].e && (h[n].pt.k[o].e[0].c = h[n].cl)
                                    }
                                    4 === i.ty && t(i.shapes)
                                }
                            }
                            return function(t) {
                                if (n(e, t.v) && (i(t.layers),
                                t.assets)) {
                                    var r, a = t.assets.length;
                                    for (r = 0; r < a; r += 1)
                                        t.assets[r].layers && i(t.assets[r].layers)
                                }
                            }
                        }();
                        var p = {
                            completeData: function(i) {
                                i.__complete || (h(i),
                                o(i),
                                s(i),
                                l(i),
                                c(i),
                                e(i.layers, i.assets),
                                function(i, r) {
                                    if (i) {
                                        var n = 0
                                          , a = i.length;
                                        for (n = 0; n < a; n += 1)
                                            1 === i[n].t && (i[n].data.layers = t(i[n].data.refId, r),
                                            e(i[n].data.layers, r))
                                    }
                                }(i.chars, i.assets),
                                i.__complete = !0)
                            }
                        };
                        return p.checkColors = h,
                        p.checkChars = s,
                        p.checkPathProperties = l,
                        p.checkShapes = c,
                        p.completeLayers = e,
                        p
                    }()),
                    a.assetLoader || (a.assetLoader = function() {
                        function e(e) {
                            var t = e.getResponseHeader("content-type");
                            return t && "json" === e.responseType && -1 !== t.indexOf("json") || e.response && "object" === _typeof$5(e.response) ? e.response : e.response && "string" == typeof e.response ? JSON.parse(e.response) : e.responseText ? JSON.parse(e.responseText) : null
                        }
                        return {
                            load: function(t, i, r, n) {
                                var a, o = new XMLHttpRequest;
                                try {
                                    o.responseType = "json"
                                } catch (s) {}
                                o.onreadystatechange = function() {
                                    if (4 === o.readyState)
                                        if (200 === o.status)
                                            a = e(o),
                                            r(a);
                                        else
                                            try {
                                                a = e(o),
                                                r(a)
                                            } catch (s) {
                                                n && n(s)
                                            }
                                }
                                ;
                                try {
                                    o.open("GET", t, !0)
                                } catch (l) {
                                    o.open("GET", i + "/" + t, !0)
                                }
                                o.send()
                            }
                        }
                    }()),
                    "loadAnimation" === e.data.type)
                        a.assetLoader.load(e.data.path, e.data.fullPath, (function(t) {
                            a.dataManager.completeData(t),
                            a.postMessage({
                                id: e.data.id,
                                payload: t,
                                status: "success"
                            })
                        }
                        ), (function() {
                            a.postMessage({
                                id: e.data.id,
                                status: "error"
                            })
                        }
                        ));
                    else if ("complete" === e.data.type) {
                        var t = e.data.animation;
                        a.dataManager.completeData(t),
                        a.postMessage({
                            id: e.data.id,
                            payload: t,
                            status: "success"
                        })
                    } else
                        "loadData" === e.data.type && a.assetLoader.load(e.data.path, e.data.fullPath, (function(t) {
                            a.postMessage({
                                id: e.data.id,
                                payload: t,
                                status: "success"
                            })
                        }
                        ), (function() {
                            a.postMessage({
                                id: e.data.id,
                                status: "error"
                            })
                        }
                        ))
                }
                ))).onmessage = function(e) {
                    var t = e.data
                      , i = t.id
                      , n = r[i];
                    r[i] = null,
                    "success" === t.status ? n.onComplete(t.payload) : n.onError && n.onError()
                }
                )
            }
            function s(e, t) {
                var n = "processId_" + (i += 1);
                return r[n] = {
                    onComplete: e,
                    onError: t
                },
                n
            }
            return {
                loadAnimation: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "loadAnimation",
                        path: e,
                        fullPath: window.location.origin + window.location.pathname,
                        id: n
                    })
                },
                loadData: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "loadData",
                        path: e,
                        fullPath: window.location.origin + window.location.pathname,
                        id: n
                    })
                },
                completeAnimation: function(e, i, r) {
                    o();
                    var n = s(i, r);
                    t.postMessage({
                        type: "complete",
                        animation: e,
                        id: n
                    })
                }
            }
        }()
          , ImagePreloader = function() {
            var e = function() {
                var e = createTag("canvas");
                e.width = 1,
                e.height = 1;
                var t = e.getContext("2d");
                return t.fillStyle = "rgba(0,0,0,0)",
                t.fillRect(0, 0, 1, 1),
                e
            }();
            function t() {
                this.loadedAssets += 1,
                this.loadedAssets === this.totalImages && this.loadedFootagesCount === this.totalFootages && this.imagesLoadedCb && this.imagesLoadedCb(null)
            }
            function i() {
                this.loadedFootagesCount += 1,
                this.loadedAssets === this.totalImages && this.loadedFootagesCount === this.totalFootages && this.imagesLoadedCb && this.imagesLoadedCb(null)
            }
            function r(e, t, i) {
                var r = "";
                if (e.e)
                    r = e.p;
                else if (t) {
                    var n = e.p;
                    -1 !== n.indexOf("images/") && (n = n.split("/")[1]),
                    r = t + n
                } else
                    r = i,
                    r += e.u ? e.u : "",
                    r += e.p;
                return r
            }
            function n(e) {
                var t = 0
                  , i = setInterval(function() {
                    (e.getBBox().width || t > 500) && (this._imageLoaded(),
                    clearInterval(i)),
                    t += 1
                }
                .bind(this), 50)
            }
            function a(e) {
                var t = {
                    assetData: e
                }
                  , i = r(e, this.assetsPath, this.path);
                return dataManager.loadData(i, function(e) {
                    t.img = e,
                    this._footageLoaded()
                }
                .bind(this), function() {
                    t.img = {},
                    this._footageLoaded()
                }
                .bind(this)),
                t
            }
            function o() {
                this._imageLoaded = t.bind(this),
                this._footageLoaded = i.bind(this),
                this.testImageLoaded = n.bind(this),
                this.createFootageData = a.bind(this),
                this.assetsPath = "",
                this.path = "",
                this.totalImages = 0,
                this.totalFootages = 0,
                this.loadedAssets = 0,
                this.loadedFootagesCount = 0,
                this.imagesLoadedCb = null,
                this.images = []
            }
            return o.prototype = {
                loadAssets: function(e, t) {
                    var i;
                    this.imagesLoadedCb = t;
                    var r = e.length;
                    for (i = 0; i < r; i += 1)
                        e[i].layers || (e[i].t && "seq" !== e[i].t ? 3 === e[i].t && (this.totalFootages += 1,
                        this.images.push(this.createFootageData(e[i]))) : (this.totalImages += 1,
                        this.images.push(this._createImageData(e[i]))))
                },
                setAssetsPath: function(e) {
                    this.assetsPath = e || ""
                },
                setPath: function(e) {
                    this.path = e || ""
                },
                loadedImages: function() {
                    return this.totalImages === this.loadedAssets
                },
                loadedFootages: function() {
                    return this.totalFootages === this.loadedFootagesCount
                },
                destroy: function() {
                    this.imagesLoadedCb = null,
                    this.images.length = 0
                },
                getAsset: function(e) {
                    for (var t = 0, i = this.images.length; t < i; ) {
                        if (this.images[t].assetData === e)
                            return this.images[t].img;
                        t += 1
                    }
                    return null
                },
                createImgData: function(t) {
                    var i = r(t, this.assetsPath, this.path)
                      , n = createTag("img");
                    n.crossOrigin = "anonymous",
                    n.addEventListener("load", this._imageLoaded, !1),
                    n.addEventListener("error", function() {
                        a.img = e,
                        this._imageLoaded()
                    }
                    .bind(this), !1),
                    n.src = i;
                    var a = {
                        img: n,
                        assetData: t
                    };
                    return a
                },
                createImageData: function(t) {
                    var i = r(t, this.assetsPath, this.path)
                      , n = createNS("image");
                    isSafari ? this.testImageLoaded(n) : n.addEventListener("load", this._imageLoaded, !1),
                    n.addEventListener("error", function() {
                        a.img = e,
                        this._imageLoaded()
                    }
                    .bind(this), !1),
                    n.setAttributeNS("http://www.w3.org/1999/xlink", "href", i),
                    this._elementHelper.append ? this._elementHelper.append(n) : this._elementHelper.appendChild(n);
                    var a = {
                        img: n,
                        assetData: t
                    };
                    return a
                },
                imageLoaded: t,
                footageLoaded: i,
                setCacheType: function(e, t) {
                    "svg" === e ? (this._elementHelper = t,
                    this._createImageData = this.createImageData.bind(this)) : this._createImageData = this.createImgData.bind(this)
                }
            },
            o
        }();
        function BaseEvent() {}
        BaseEvent.prototype = {
            triggerEvent: function(e, t) {
                if (this._cbs[e])
                    for (var i = this._cbs[e], r = 0; r < i.length; r += 1)
                        i[r](t)
            },
            addEventListener: function(e, t) {
                return this._cbs[e] || (this._cbs[e] = []),
                this._cbs[e].push(t),
                function() {
                    this.removeEventListener(e, t)
                }
                .bind(this)
            },
            removeEventListener: function(e, t) {
                if (t) {
                    if (this._cbs[e]) {
                        for (var i = 0, r = this._cbs[e].length; i < r; )
                            this._cbs[e][i] === t && (this._cbs[e].splice(i, 1),
                            i -= 1,
                            r -= 1),
                            i += 1;
                        this._cbs[e].length || (this._cbs[e] = null)
                    }
                } else
                    this._cbs[e] = null
            }
        };
        var markerParser = function() {
            function e(e) {
                for (var t, i = e.split("\r\n"), r = {}, n = 0, a = 0; a < i.length; a += 1)
                    2 === (t = i[a].split(":")).length && (r[t[0]] = t[1].trim(),
                    n += 1);
                if (0 === n)
                    throw new Error;
                return r
            }
            return function(t) {
                for (var i = [], r = 0; r < t.length; r += 1) {
                    var n = t[r]
                      , a = {
                        time: n.tm,
                        duration: n.dr
                    };
                    try {
                        a.payload = JSON.parse(t[r].cm)
                    } catch (o) {
                        try {
                            a.payload = e(t[r].cm)
                        } catch (s) {
                            a.payload = {
                                name: t[r].cm
                            }
                        }
                    }
                    i.push(a)
                }
                return i
            }
        }()
          , ProjectInterface = function() {
            function e(e) {
                this.compositions.push(e)
            }
            return function() {
                function t(e) {
                    for (var t = 0, i = this.compositions.length; t < i; ) {
                        if (this.compositions[t].data && this.compositions[t].data.nm === e)
                            return this.compositions[t].prepareFrame && this.compositions[t].data.xt && this.compositions[t].prepareFrame(this.currentFrame),
                            this.compositions[t].compInterface;
                        t += 1
                    }
                    return null
                }
                return t.compositions = [],
                t.currentFrame = 0,
                t.registerComposition = e,
                t
            }
        }()
          , renderers = {}
          , registerRenderer = function(e, t) {
            renderers[e] = t
        };
        function getRenderer(e) {
            return renderers[e]
        }
        function _typeof$4(e) {
            return (_typeof$4 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        var AnimationItem = function() {
            this._cbs = [],
            this.name = "",
            this.path = "",
            this.isLoaded = !1,
            this.currentFrame = 0,
            this.currentRawFrame = 0,
            this.firstFrame = 0,
            this.totalFrames = 0,
            this.frameRate = 0,
            this.frameMult = 0,
            this.playSpeed = 1,
            this.playDirection = 1,
            this.playCount = 0,
            this.animationData = {},
            this.assets = [],
            this.isPaused = !0,
            this.autoplay = !1,
            this.loop = !0,
            this.renderer = null,
            this.animationID = createElementID(),
            this.assetsPath = "",
            this.timeCompleted = 0,
            this.segmentPos = 0,
            this.isSubframeEnabled = getSubframeEnabled(),
            this.segments = [],
            this._idle = !0,
            this._completedLoop = !1,
            this.projectInterface = ProjectInterface(),
            this.imagePreloader = new ImagePreloader,
            this.audioController = audioControllerFactory(),
            this.markers = [],
            this.configAnimation = this.configAnimation.bind(this),
            this.onSetupError = this.onSetupError.bind(this),
            this.onSegmentComplete = this.onSegmentComplete.bind(this),
            this.drawnFrameEvent = new BMEnterFrameEvent("drawnFrame",0,0,0)
        };
        extendPrototype([BaseEvent], AnimationItem),
        AnimationItem.prototype.setParams = function(e) {
            (e.wrapper || e.container) && (this.wrapper = e.wrapper || e.container);
            var t = "svg";
            e.animType ? t = e.animType : e.renderer && (t = e.renderer);
            var i = getRenderer(t);
            this.renderer = new i(this,e.rendererSettings),
            this.imagePreloader.setCacheType(t, this.renderer.globalData.defs),
            this.renderer.setProjectInterface(this.projectInterface),
            this.animType = t,
            "" === e.loop || null === e.loop || void 0 === e.loop || !0 === e.loop ? this.loop = !0 : !1 === e.loop ? this.loop = !1 : this.loop = parseInt(e.loop, 10),
            this.autoplay = !("autoplay"in e) || e.autoplay,
            this.name = e.name ? e.name : "",
            this.autoloadSegments = !Object.prototype.hasOwnProperty.call(e, "autoloadSegments") || e.autoloadSegments,
            this.assetsPath = e.assetsPath,
            this.initialSegment = e.initialSegment,
            e.audioFactory && this.audioController.setAudioFactory(e.audioFactory),
            e.animationData ? this.setupAnimation(e.animationData) : e.path && (-1 !== e.path.lastIndexOf("\\") ? this.path = e.path.substr(0, e.path.lastIndexOf("\\") + 1) : this.path = e.path.substr(0, e.path.lastIndexOf("/") + 1),
            this.fileName = e.path.substr(e.path.lastIndexOf("/") + 1),
            this.fileName = this.fileName.substr(0, this.fileName.lastIndexOf(".json")),
            dataManager.loadAnimation(e.path, this.configAnimation, this.onSetupError))
        }
        ,
        AnimationItem.prototype.onSetupError = function() {
            this.trigger("data_failed")
        }
        ,
        AnimationItem.prototype.setupAnimation = function(e) {
            dataManager.completeAnimation(e, this.configAnimation)
        }
        ,
        AnimationItem.prototype.setData = function(e, t) {
            t && "object" !== _typeof$4(t) && (t = JSON.parse(t));
            var i = {
                wrapper: e,
                animationData: t
            }
              , r = e.attributes;
            i.path = r.getNamedItem("data-animation-path") ? r.getNamedItem("data-animation-path").value : r.getNamedItem("data-bm-path") ? r.getNamedItem("data-bm-path").value : r.getNamedItem("bm-path") ? r.getNamedItem("bm-path").value : "",
            i.animType = r.getNamedItem("data-anim-type") ? r.getNamedItem("data-anim-type").value : r.getNamedItem("data-bm-type") ? r.getNamedItem("data-bm-type").value : r.getNamedItem("bm-type") ? r.getNamedItem("bm-type").value : r.getNamedItem("data-bm-renderer") ? r.getNamedItem("data-bm-renderer").value : r.getNamedItem("bm-renderer") ? r.getNamedItem("bm-renderer").value : "canvas";
            var n = r.getNamedItem("data-anim-loop") ? r.getNamedItem("data-anim-loop").value : r.getNamedItem("data-bm-loop") ? r.getNamedItem("data-bm-loop").value : r.getNamedItem("bm-loop") ? r.getNamedItem("bm-loop").value : "";
            "false" === n ? i.loop = !1 : "true" === n ? i.loop = !0 : "" !== n && (i.loop = parseInt(n, 10));
            var a = r.getNamedItem("data-anim-autoplay") ? r.getNamedItem("data-anim-autoplay").value : r.getNamedItem("data-bm-autoplay") ? r.getNamedItem("data-bm-autoplay").value : !r.getNamedItem("bm-autoplay") || r.getNamedItem("bm-autoplay").value;
            i.autoplay = "false" !== a,
            i.name = r.getNamedItem("data-name") ? r.getNamedItem("data-name").value : r.getNamedItem("data-bm-name") ? r.getNamedItem("data-bm-name").value : r.getNamedItem("bm-name") ? r.getNamedItem("bm-name").value : "",
            "false" === (r.getNamedItem("data-anim-prerender") ? r.getNamedItem("data-anim-prerender").value : r.getNamedItem("data-bm-prerender") ? r.getNamedItem("data-bm-prerender").value : r.getNamedItem("bm-prerender") ? r.getNamedItem("bm-prerender").value : "") && (i.prerender = !1),
            this.setParams(i)
        }
        ,
        AnimationItem.prototype.includeLayers = function(e) {
            e.op > this.animationData.op && (this.animationData.op = e.op,
            this.totalFrames = Math.floor(e.op - this.animationData.ip));
            var t, i, r = this.animationData.layers, n = r.length, a = e.layers, o = a.length;
            for (i = 0; i < o; i += 1)
                for (t = 0; t < n; ) {
                    if (r[t].id === a[i].id) {
                        r[t] = a[i];
                        break
                    }
                    t += 1
                }
            if ((e.chars || e.fonts) && (this.renderer.globalData.fontManager.addChars(e.chars),
            this.renderer.globalData.fontManager.addFonts(e.fonts, this.renderer.globalData.defs)),
            e.assets)
                for (n = e.assets.length,
                t = 0; t < n; t += 1)
                    this.animationData.assets.push(e.assets[t]);
            this.animationData.__complete = !1,
            dataManager.completeAnimation(this.animationData, this.onSegmentComplete)
        }
        ,
        AnimationItem.prototype.onSegmentComplete = function(e) {
            this.animationData = e;
            var t = getExpressionsPlugin();
            t && t.initExpressions(this),
            this.loadNextSegment()
        }
        ,
        AnimationItem.prototype.loadNextSegment = function() {
            var e = this.animationData.segments;
            if (!e || 0 === e.length || !this.autoloadSegments)
                return this.trigger("data_ready"),
                void (this.timeCompleted = this.totalFrames);
            var t = e.shift();
            this.timeCompleted = t.time * this.frameRate;
            var i = this.path + this.fileName + "_" + this.segmentPos + ".json";
            this.segmentPos += 1,
            dataManager.loadData(i, this.includeLayers.bind(this), function() {
                this.trigger("data_failed")
            }
            .bind(this))
        }
        ,
        AnimationItem.prototype.loadSegments = function() {
            this.animationData.segments || (this.timeCompleted = this.totalFrames),
            this.loadNextSegment()
        }
        ,
        AnimationItem.prototype.imagesLoaded = function() {
            this.trigger("loaded_images"),
            this.checkLoaded()
        }
        ,
        AnimationItem.prototype.preloadImages = function() {
            this.imagePreloader.setAssetsPath(this.assetsPath),
            this.imagePreloader.setPath(this.path),
            this.imagePreloader.loadAssets(this.animationData.assets, this.imagesLoaded.bind(this))
        }
        ,
        AnimationItem.prototype.configAnimation = function(e) {
            if (this.renderer)
                try {
                    this.animationData = e,
                    this.initialSegment ? (this.totalFrames = Math.floor(this.initialSegment[1] - this.initialSegment[0]),
                    this.firstFrame = Math.round(this.initialSegment[0])) : (this.totalFrames = Math.floor(this.animationData.op - this.animationData.ip),
                    this.firstFrame = Math.round(this.animationData.ip)),
                    this.renderer.configAnimation(e),
                    e.assets || (e.assets = []),
                    this.assets = this.animationData.assets,
                    this.frameRate = this.animationData.fr,
                    this.frameMult = this.animationData.fr / 1e3,
                    this.renderer.searchExtraCompositions(e.assets),
                    this.markers = markerParser(e.markers || []),
                    this.trigger("config_ready"),
                    this.preloadImages(),
                    this.loadSegments(),
                    this.updaFrameModifier(),
                    this.waitForFontsLoaded(),
                    this.isPaused && this.audioController.pause()
                } catch (t) {
                    this.triggerConfigError(t)
                }
        }
        ,
        AnimationItem.prototype.waitForFontsLoaded = function() {
            this.renderer && (this.renderer.globalData.fontManager.isLoaded ? this.checkLoaded() : setTimeout(this.waitForFontsLoaded.bind(this), 20))
        }
        ,
        AnimationItem.prototype.checkLoaded = function() {
            if (!this.isLoaded && this.renderer.globalData.fontManager.isLoaded && (this.imagePreloader.loadedImages() || "canvas" !== this.renderer.rendererType) && this.imagePreloader.loadedFootages()) {
                this.isLoaded = !0;
                var e = getExpressionsPlugin();
                e && e.initExpressions(this),
                this.renderer.initItems(),
                setTimeout(function() {
                    this.trigger("DOMLoaded")
                }
                .bind(this), 0),
                this.gotoFrame(),
                this.autoplay && this.play()
            }
        }
        ,
        AnimationItem.prototype.resize = function() {
            this.renderer.updateContainerSize()
        }
        ,
        AnimationItem.prototype.setSubframe = function(e) {
            this.isSubframeEnabled = !!e
        }
        ,
        AnimationItem.prototype.gotoFrame = function() {
            this.currentFrame = this.isSubframeEnabled ? this.currentRawFrame : ~~this.currentRawFrame,
            this.timeCompleted !== this.totalFrames && this.currentFrame > this.timeCompleted && (this.currentFrame = this.timeCompleted),
            this.trigger("enterFrame"),
            this.renderFrame(),
            this.trigger("drawnFrame")
        }
        ,
        AnimationItem.prototype.renderFrame = function() {
            if (!1 !== this.isLoaded && this.renderer)
                try {
                    this.renderer.renderFrame(this.currentFrame + this.firstFrame)
                } catch (e) {
                    this.triggerRenderFrameError(e)
                }
        }
        ,
        AnimationItem.prototype.play = function(e) {
            e && this.name !== e || !0 === this.isPaused && (this.isPaused = !1,
            this.trigger("_pause"),
            this.audioController.resume(),
            this._idle && (this._idle = !1,
            this.trigger("_active")))
        }
        ,
        AnimationItem.prototype.pause = function(e) {
            e && this.name !== e || !1 === this.isPaused && (this.isPaused = !0,
            this.trigger("_play"),
            this._idle = !0,
            this.trigger("_idle"),
            this.audioController.pause())
        }
        ,
        AnimationItem.prototype.togglePause = function(e) {
            e && this.name !== e || (!0 === this.isPaused ? this.play() : this.pause())
        }
        ,
        AnimationItem.prototype.stop = function(e) {
            e && this.name !== e || (this.pause(),
            this.playCount = 0,
            this._completedLoop = !1,
            this.setCurrentRawFrameValue(0))
        }
        ,
        AnimationItem.prototype.getMarkerData = function(e) {
            for (var t, i = 0; i < this.markers.length; i += 1)
                if ((t = this.markers[i]).payload && t.payload.name === e)
                    return t;
            return null
        }
        ,
        AnimationItem.prototype.goToAndStop = function(e, t, i) {
            if (!i || this.name === i) {
                var r = Number(e);
                if (isNaN(r)) {
                    var n = this.getMarkerData(e);
                    n && this.goToAndStop(n.time, !0)
                } else
                    t ? this.setCurrentRawFrameValue(e) : this.setCurrentRawFrameValue(e * this.frameModifier);
                this.pause()
            }
        }
        ,
        AnimationItem.prototype.goToAndPlay = function(e, t, i) {
            if (!i || this.name === i) {
                var r = Number(e);
                if (isNaN(r)) {
                    var n = this.getMarkerData(e);
                    n && (n.duration ? this.playSegments([n.time, n.time + n.duration], !0) : this.goToAndStop(n.time, !0))
                } else
                    this.goToAndStop(r, t, i);
                this.play()
            }
        }
        ,
        AnimationItem.prototype.advanceTime = function(e) {
            if (!0 !== this.isPaused && !1 !== this.isLoaded) {
                var t = this.currentRawFrame + e * this.frameModifier
                  , i = !1;
                t >= this.totalFrames - 1 && this.frameModifier > 0 ? this.loop && this.playCount !== this.loop ? t >= this.totalFrames ? (this.playCount += 1,
                this.checkSegments(t % this.totalFrames) || (this.setCurrentRawFrameValue(t % this.totalFrames),
                this._completedLoop = !0,
                this.trigger("loopComplete"))) : this.setCurrentRawFrameValue(t) : this.checkSegments(t > this.totalFrames ? t % this.totalFrames : 0) || (i = !0,
                t = this.totalFrames - 1) : t < 0 ? this.checkSegments(t % this.totalFrames) || (!this.loop || this.playCount-- <= 0 && !0 !== this.loop ? (i = !0,
                t = 0) : (this.setCurrentRawFrameValue(this.totalFrames + t % this.totalFrames),
                this._completedLoop ? this.trigger("loopComplete") : this._completedLoop = !0)) : this.setCurrentRawFrameValue(t),
                i && (this.setCurrentRawFrameValue(t),
                this.pause(),
                this.trigger("complete"))
            }
        }
        ,
        AnimationItem.prototype.adjustSegment = function(e, t) {
            this.playCount = 0,
            e[1] < e[0] ? (this.frameModifier > 0 && (this.playSpeed < 0 ? this.setSpeed(-this.playSpeed) : this.setDirection(-1)),
            this.totalFrames = e[0] - e[1],
            this.timeCompleted = this.totalFrames,
            this.firstFrame = e[1],
            this.setCurrentRawFrameValue(this.totalFrames - .001 - t)) : e[1] > e[0] && (this.frameModifier < 0 && (this.playSpeed < 0 ? this.setSpeed(-this.playSpeed) : this.setDirection(1)),
            this.totalFrames = e[1] - e[0],
            this.timeCompleted = this.totalFrames,
            this.firstFrame = e[0],
            this.setCurrentRawFrameValue(.001 + t)),
            this.trigger("segmentStart")
        }
        ,
        AnimationItem.prototype.setSegment = function(e, t) {
            var i = -1;
            this.isPaused && (this.currentRawFrame + this.firstFrame < e ? i = e : this.currentRawFrame + this.firstFrame > t && (i = t - e)),
            this.firstFrame = e,
            this.totalFrames = t - e,
            this.timeCompleted = this.totalFrames,
            -1 !== i && this.goToAndStop(i, !0)
        }
        ,
        AnimationItem.prototype.playSegments = function(e, t) {
            if (t && (this.segments.length = 0),
            "object" === _typeof$4(e[0])) {
                var i, r = e.length;
                for (i = 0; i < r; i += 1)
                    this.segments.push(e[i])
            } else
                this.segments.push(e);
            this.segments.length && t && this.adjustSegment(this.segments.shift(), 0),
            this.isPaused && this.play()
        }
        ,
        AnimationItem.prototype.resetSegments = function(e) {
            this.segments.length = 0,
            this.segments.push([this.animationData.ip, this.animationData.op]),
            e && this.checkSegments(0)
        }
        ,
        AnimationItem.prototype.checkSegments = function(e) {
            return !!this.segments.length && (this.adjustSegment(this.segments.shift(), e),
            !0)
        }
        ,
        AnimationItem.prototype.destroy = function(e) {
            e && this.name !== e || !this.renderer || (this.renderer.destroy(),
            this.imagePreloader.destroy(),
            this.trigger("destroy"),
            this._cbs = null,
            this.onEnterFrame = null,
            this.onLoopComplete = null,
            this.onComplete = null,
            this.onSegmentStart = null,
            this.onDestroy = null,
            this.renderer = null,
            this.renderer = null,
            this.imagePreloader = null,
            this.projectInterface = null)
        }
        ,
        AnimationItem.prototype.setCurrentRawFrameValue = function(e) {
            this.currentRawFrame = e,
            this.gotoFrame()
        }
        ,
        AnimationItem.prototype.setSpeed = function(e) {
            this.playSpeed = e,
            this.updaFrameModifier()
        }
        ,
        AnimationItem.prototype.setDirection = function(e) {
            this.playDirection = e < 0 ? -1 : 1,
            this.updaFrameModifier()
        }
        ,
        AnimationItem.prototype.setVolume = function(e, t) {
            t && this.name !== t || this.audioController.setVolume(e)
        }
        ,
        AnimationItem.prototype.getVolume = function() {
            return this.audioController.getVolume()
        }
        ,
        AnimationItem.prototype.mute = function(e) {
            e && this.name !== e || this.audioController.mute()
        }
        ,
        AnimationItem.prototype.unmute = function(e) {
            e && this.name !== e || this.audioController.unmute()
        }
        ,
        AnimationItem.prototype.updaFrameModifier = function() {
            this.frameModifier = this.frameMult * this.playSpeed * this.playDirection,
            this.audioController.setRate(this.playSpeed * this.playDirection)
        }
        ,
        AnimationItem.prototype.getPath = function() {
            return this.path
        }
        ,
        AnimationItem.prototype.getAssetsPath = function(e) {
            var t = "";
            if (e.e)
                t = e.p;
            else if (this.assetsPath) {
                var i = e.p;
                -1 !== i.indexOf("images/") && (i = i.split("/")[1]),
                t = this.assetsPath + i
            } else
                t = this.path,
                t += e.u ? e.u : "",
                t += e.p;
            return t
        }
        ,
        AnimationItem.prototype.getAssetData = function(e) {
            for (var t = 0, i = this.assets.length; t < i; ) {
                if (e === this.assets[t].id)
                    return this.assets[t];
                t += 1
            }
            return null
        }
        ,
        AnimationItem.prototype.hide = function() {
            this.renderer.hide()
        }
        ,
        AnimationItem.prototype.show = function() {
            this.renderer.show()
        }
        ,
        AnimationItem.prototype.getDuration = function(e) {
            return e ? this.totalFrames : this.totalFrames / this.frameRate
        }
        ,
        AnimationItem.prototype.updateDocumentData = function(e, t, i) {
            try {
                this.renderer.getElementByPath(e).updateDocumentData(t, i)
            } catch (r) {}
        }
        ,
        AnimationItem.prototype.trigger = function(e) {
            if (this._cbs && this._cbs[e])
                switch (e) {
                case "enterFrame":
                    this.triggerEvent(e, new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));
                    break;
                case "drawnFrame":
                    this.drawnFrameEvent.currentTime = this.currentFrame,
                    this.drawnFrameEvent.totalTime = this.totalFrames,
                    this.drawnFrameEvent.direction = this.frameModifier,
                    this.triggerEvent(e, this.drawnFrameEvent);
                    break;
                case "loopComplete":
                    this.triggerEvent(e, new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));
                    break;
                case "complete":
                    this.triggerEvent(e, new BMCompleteEvent(e,this.frameMult));
                    break;
                case "segmentStart":
                    this.triggerEvent(e, new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));
                    break;
                case "destroy":
                    this.triggerEvent(e, new BMDestroyEvent(e,this));
                    break;
                default:
                    this.triggerEvent(e)
                }
            "enterFrame" === e && this.onEnterFrame && this.onEnterFrame.call(this, new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),
            "loopComplete" === e && this.onLoopComplete && this.onLoopComplete.call(this, new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),
            "complete" === e && this.onComplete && this.onComplete.call(this, new BMCompleteEvent(e,this.frameMult)),
            "segmentStart" === e && this.onSegmentStart && this.onSegmentStart.call(this, new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),
            "destroy" === e && this.onDestroy && this.onDestroy.call(this, new BMDestroyEvent(e,this))
        }
        ,
        AnimationItem.prototype.triggerRenderFrameError = function(e) {
            var t = new BMRenderFrameErrorEvent(e,this.currentFrame);
            this.triggerEvent("error", t),
            this.onError && this.onError.call(this, t)
        }
        ,
        AnimationItem.prototype.triggerConfigError = function(e) {
            var t = new BMConfigErrorEvent(e,this.currentFrame);
            this.triggerEvent("error", t),
            this.onError && this.onError.call(this, t)
        }
        ;
        var animationManager = function() {
            var e = {}
              , t = []
              , i = 0
              , r = 0
              , n = 0
              , a = !0
              , o = !1;
            function s(e) {
                for (var i = 0, n = e.target; i < r; )
                    t[i].animation === n && (t.splice(i, 1),
                    i -= 1,
                    r -= 1,
                    n.isPaused || c()),
                    i += 1
            }
            function l(e, i) {
                if (!e)
                    return null;
                for (var n = 0; n < r; ) {
                    if (t[n].elem === e && null !== t[n].elem)
                        return t[n].animation;
                    n += 1
                }
                var a = new AnimationItem;
                return p(a, e),
                a.setData(e, i),
                a
            }
            function h() {
                n += 1,
                f()
            }
            function c() {
                n -= 1
            }
            function p(e, i) {
                e.addEventListener("destroy", s),
                e.addEventListener("_active", h),
                e.addEventListener("_idle", c),
                t.push({
                    elem: i,
                    animation: e
                }),
                r += 1
            }
            function u(e) {
                var s, l = e - i;
                for (s = 0; s < r; s += 1)
                    t[s].animation.advanceTime(l);
                i = e,
                n && !o ? window.requestAnimationFrame(u) : a = !0
            }
            function d(e) {
                i = e,
                window.requestAnimationFrame(u)
            }
            function f() {
                !o && n && a && (window.requestAnimationFrame(d),
                a = !1)
            }
            return e.registerAnimation = l,
            e.loadAnimation = function(e) {
                var t = new AnimationItem;
                return p(t, null),
                t.setParams(e),
                t
            }
            ,
            e.setSpeed = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setSpeed(e, i)
            }
            ,
            e.setDirection = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setDirection(e, i)
            }
            ,
            e.play = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.play(e)
            }
            ,
            e.pause = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.pause(e)
            }
            ,
            e.stop = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.stop(e)
            }
            ,
            e.togglePause = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.togglePause(e)
            }
            ,
            e.searchAnimations = function(e, t, i) {
                var r, n = [].concat([].slice.call(document.getElementsByClassName("lottie")), [].slice.call(document.getElementsByClassName("bodymovin"))), a = n.length;
                for (r = 0; r < a; r += 1)
                    i && n[r].setAttribute("data-bm-type", i),
                    l(n[r], e);
                if (t && 0 === a) {
                    i || (i = "svg");
                    var o = document.getElementsByTagName("body")[0];
                    o.innerText = "";
                    var s = createTag("div");
                    s.style.width = "100%",
                    s.style.height = "100%",
                    s.setAttribute("data-bm-type", i),
                    o.appendChild(s),
                    l(s, e)
                }
            }
            ,
            e.resize = function() {
                var e;
                for (e = 0; e < r; e += 1)
                    t[e].animation.resize()
            }
            ,
            e.goToAndStop = function(e, i, n) {
                var a;
                for (a = 0; a < r; a += 1)
                    t[a].animation.goToAndStop(e, i, n)
            }
            ,
            e.destroy = function(e) {
                var i;
                for (i = r - 1; i >= 0; i -= 1)
                    t[i].animation.destroy(e)
            }
            ,
            e.freeze = function() {
                o = !0
            }
            ,
            e.unfreeze = function() {
                o = !1,
                f()
            }
            ,
            e.setVolume = function(e, i) {
                var n;
                for (n = 0; n < r; n += 1)
                    t[n].animation.setVolume(e, i)
            }
            ,
            e.mute = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.mute(e)
            }
            ,
            e.unmute = function(e) {
                var i;
                for (i = 0; i < r; i += 1)
                    t[i].animation.unmute(e)
            }
            ,
            e.getRegisteredAnimations = function() {
                var e, i = t.length, r = [];
                for (e = 0; e < i; e += 1)
                    r.push(t[e].animation);
                return r
            }
            ,
            e
        }()
          , BezierFactory = function() {
            var e = {
                getBezierEasing: function(e, i, r, n, a) {
                    var o = a || ("bez_" + e + "_" + i + "_" + r + "_" + n).replace(/\./g, "p");
                    if (t[o])
                        return t[o];
                    var s = new h([e, i, r, n]);
                    return t[o] = s,
                    s
                }
            }
              , t = {}
              , i = .1
              , r = "function" == typeof Float32Array;
            function n(e, t) {
                return 1 - 3 * t + 3 * e
            }
            function a(e, t) {
                return 3 * t - 6 * e
            }
            function o(e) {
                return 3 * e
            }
            function s(e, t, i) {
                return ((n(t, i) * e + a(t, i)) * e + o(t)) * e
            }
            function l(e, t, i) {
                return 3 * n(t, i) * e * e + 2 * a(t, i) * e + o(t)
            }
            function h(e) {
                this._p = e,
                this._mSampleValues = r ? new Float32Array(11) : new Array(11),
                this._precomputed = !1,
                this.get = this.get.bind(this)
            }
            return h.prototype = {
                get: function(e) {
                    var t = this._p[0]
                      , i = this._p[1]
                      , r = this._p[2]
                      , n = this._p[3];
                    return this._precomputed || this._precompute(),
                    t === i && r === n ? e : 0 === e ? 0 : 1 === e ? 1 : s(this._getTForX(e), i, n)
                },
                _precompute: function() {
                    var e = this._p[0]
                      , t = this._p[1]
                      , i = this._p[2]
                      , r = this._p[3];
                    this._precomputed = !0,
                    e === t && i === r || this._calcSampleValues()
                },
                _calcSampleValues: function() {
                    for (var e = this._p[0], t = this._p[2], r = 0; r < 11; ++r)
                        this._mSampleValues[r] = s(r * i, e, t)
                },
                _getTForX: function(e) {
                    for (var t = this._p[0], r = this._p[2], n = this._mSampleValues, a = 0, o = 1; 10 !== o && n[o] <= e; ++o)
                        a += i;
                    var h = a + (e - n[--o]) / (n[o + 1] - n[o]) * i
                      , c = l(h, t, r);
                    return c >= .001 ? function(e, t, i, r) {
                        for (var n = 0; n < 4; ++n) {
                            var a = l(t, i, r);
                            if (0 === a)
                                return t;
                            t -= (s(t, i, r) - e) / a
                        }
                        return t
                    }(e, h, t, r) : 0 === c ? h : function(e, t, i, r, n) {
                        var a, o, l = 0;
                        do {
                            (a = s(o = t + (i - t) / 2, r, n) - e) > 0 ? i = o : t = o
                        } while (Math.abs(a) > 1e-7 && ++l < 10);
                        return o
                    }(e, a, a + i, t, r)
                }
            },
            e
        }()
          , pooling = {
            double: function(e) {
                return e.concat(createSizedArray(e.length))
            }
        }
          , poolFactory = function(e, t, i) {
            var r = 0
              , n = e
              , a = createSizedArray(n);
            return {
                newElement: function() {
                    return r ? a[r -= 1] : t()
                },
                release: function(e) {
                    r === n && (a = pooling.double(a),
                    n *= 2),
                    i && i(e),
                    a[r] = e,
                    r += 1
                }
            }
        }
          , bezierLengthPool = poolFactory(8, (function() {
            return {
                addedLength: 0,
                percents: createTypedArray("float32", getDefaultCurveSegments()),
                lengths: createTypedArray("float32", getDefaultCurveSegments())
            }
        }
        ))
          , segmentsLengthPool = poolFactory(8, (function() {
            return {
                lengths: [],
                totalLength: 0
            }
        }
        ), (function(e) {
            var t, i = e.lengths.length;
            for (t = 0; t < i; t += 1)
                bezierLengthPool.release(e.lengths[t]);
            e.lengths.length = 0
        }
        ));
        function bezFunction() {
            var e = Math;
            function t(e, t, i, r, n, a) {
                var o = e * r + t * n + i * a - n * r - a * e - i * t;
                return o > -.001 && o < .001
            }
            var i = function(e, t, i, r) {
                var n, a, o, s, l, h, c = getDefaultCurveSegments(), p = 0, u = [], d = [], f = bezierLengthPool.newElement();
                for (o = i.length,
                n = 0; n < c; n += 1) {
                    for (l = n / (c - 1),
                    h = 0,
                    a = 0; a < o; a += 1)
                        s = bmPow(1 - l, 3) * e[a] + 3 * bmPow(1 - l, 2) * l * i[a] + 3 * (1 - l) * bmPow(l, 2) * r[a] + bmPow(l, 3) * t[a],
                        u[a] = s,
                        null !== d[a] && (h += bmPow(u[a] - d[a], 2)),
                        d[a] = u[a];
                    h && (p += h = bmSqrt(h)),
                    f.percents[n] = l,
                    f.lengths[n] = p
                }
                return f.addedLength = p,
                f
            };
            function r(e) {
                this.segmentLength = 0,
                this.points = new Array(e)
            }
            function n(e, t) {
                this.partialLength = e,
                this.point = t
            }
            var a, o = (a = {},
            function(e, i, o, s) {
                var l = (e[0] + "_" + e[1] + "_" + i[0] + "_" + i[1] + "_" + o[0] + "_" + o[1] + "_" + s[0] + "_" + s[1]).replace(/\./g, "p");
                if (!a[l]) {
                    var h, c, p, u, d, f, m, g = getDefaultCurveSegments(), v = 0, y = null;
                    2 === e.length && (e[0] !== i[0] || e[1] !== i[1]) && t(e[0], e[1], i[0], i[1], e[0] + o[0], e[1] + o[1]) && t(e[0], e[1], i[0], i[1], i[0] + s[0], i[1] + s[1]) && (g = 2);
                    var _ = new r(g);
                    for (p = o.length,
                    h = 0; h < g; h += 1) {
                        for (m = createSizedArray(p),
                        d = h / (g - 1),
                        f = 0,
                        c = 0; c < p; c += 1)
                            u = bmPow(1 - d, 3) * e[c] + 3 * bmPow(1 - d, 2) * d * (e[c] + o[c]) + 3 * (1 - d) * bmPow(d, 2) * (i[c] + s[c]) + bmPow(d, 3) * i[c],
                            m[c] = u,
                            null !== y && (f += bmPow(m[c] - y[c], 2));
                        v += f = bmSqrt(f),
                        _.points[h] = new n(f,m),
                        y = m
                    }
                    _.segmentLength = v,
                    a[l] = _
                }
                return a[l]
            }
            );
            function s(e, t) {
                var i = t.percents
                  , r = t.lengths
                  , n = i.length
                  , a = bmFloor((n - 1) * e)
                  , o = e * t.addedLength
                  , s = 0;
                if (a === n - 1 || 0 === a || o === r[a])
                    return i[a];
                for (var l = r[a] > o ? -1 : 1, h = !0; h; )
                    if (r[a] <= o && r[a + 1] > o ? (s = (o - r[a]) / (r[a + 1] - r[a]),
                    h = !1) : a += l,
                    a < 0 || a >= n - 1) {
                        if (a === n - 1)
                            return i[a];
                        h = !1
                    }
                return i[a] + (i[a + 1] - i[a]) * s
            }
            var l = createTypedArray("float32", 8);
            return {
                getSegmentsLength: function(e) {
                    var t, r = segmentsLengthPool.newElement(), n = e.c, a = e.v, o = e.o, s = e.i, l = e._length, h = r.lengths, c = 0;
                    for (t = 0; t < l - 1; t += 1)
                        h[t] = i(a[t], a[t + 1], o[t], s[t + 1]),
                        c += h[t].addedLength;
                    return n && l && (h[t] = i(a[t], a[0], o[t], s[0]),
                    c += h[t].addedLength),
                    r.totalLength = c,
                    r
                },
                getNewSegment: function(t, i, r, n, a, o, h) {
                    a < 0 ? a = 0 : a > 1 && (a = 1);
                    var c, p = s(a, h), u = s(o = o > 1 ? 1 : o, h), d = t.length, f = 1 - p, m = 1 - u, g = f * f * f, v = p * f * f * 3, y = p * p * f * 3, _ = p * p * p, b = f * f * m, x = p * f * m + f * p * m + f * f * u, w = p * p * m + f * p * u + p * f * u, S = p * p * u, T = f * m * m, k = p * m * m + f * u * m + f * m * u, E = p * u * m + f * u * u + p * m * u, M = p * u * u, P = m * m * m, C = u * m * m + m * u * m + m * m * u, A = u * u * m + m * u * u + u * m * u, L = u * u * u;
                    for (c = 0; c < d; c += 1)
                        l[4 * c] = e.round(1e3 * (g * t[c] + v * r[c] + y * n[c] + _ * i[c])) / 1e3,
                        l[4 * c + 1] = e.round(1e3 * (b * t[c] + x * r[c] + w * n[c] + S * i[c])) / 1e3,
                        l[4 * c + 2] = e.round(1e3 * (T * t[c] + k * r[c] + E * n[c] + M * i[c])) / 1e3,
                        l[4 * c + 3] = e.round(1e3 * (P * t[c] + C * r[c] + A * n[c] + L * i[c])) / 1e3;
                    return l
                },
                getPointInSegment: function(t, i, r, n, a, o) {
                    var l = s(a, o)
                      , h = 1 - l;
                    return [e.round(1e3 * (h * h * h * t[0] + (l * h * h + h * l * h + h * h * l) * r[0] + (l * l * h + h * l * l + l * h * l) * n[0] + l * l * l * i[0])) / 1e3, e.round(1e3 * (h * h * h * t[1] + (l * h * h + h * l * h + h * h * l) * r[1] + (l * l * h + h * l * l + l * h * l) * n[1] + l * l * l * i[1])) / 1e3]
                },
                buildBezierData: o,
                pointOnLine2D: t,
                pointOnLine3D: function(i, r, n, a, o, s, l, h, c) {
                    if (0 === n && 0 === s && 0 === c)
                        return t(i, r, a, o, l, h);
                    var p, u = e.sqrt(e.pow(a - i, 2) + e.pow(o - r, 2) + e.pow(s - n, 2)), d = e.sqrt(e.pow(l - i, 2) + e.pow(h - r, 2) + e.pow(c - n, 2)), f = e.sqrt(e.pow(l - a, 2) + e.pow(h - o, 2) + e.pow(c - s, 2));
                    return (p = u > d ? u > f ? u - d - f : f - d - u : f > d ? f - d - u : d - u - f) > -1e-4 && p < 1e-4
                }
            }
        }
        var bez = bezFunction()
          , PropertyFactory = function() {
            var e = initialDefaultFrame
              , t = Math.abs;
            function i(e, t) {
                var i, n = this.offsetTime;
                "multidimensional" === this.propType && (i = createTypedArray("float32", this.pv.length));
                for (var a, o, s, l, h, c, p, u, d, f = t.lastIndex, m = f, g = this.keyframes.length - 1, v = !0; v; ) {
                    if (a = this.keyframes[m],
                    o = this.keyframes[m + 1],
                    m === g - 1 && e >= o.t - n) {
                        a.h && (a = o),
                        f = 0;
                        break
                    }
                    if (o.t - n > e) {
                        f = m;
                        break
                    }
                    m < g - 1 ? m += 1 : (f = 0,
                    v = !1)
                }
                s = this.keyframesMetadata[m] || {};
                var y, _, b, x, w, S, T, k, E, M, P = o.t - n, C = a.t - n;
                if (a.to) {
                    s.bezierData || (s.bezierData = bez.buildBezierData(a.s, o.s || a.e, a.to, a.ti));
                    var A = s.bezierData;
                    if (e >= P || e < C) {
                        var L = e >= P ? A.points.length - 1 : 0;
                        for (h = A.points[L].point.length,
                        l = 0; l < h; l += 1)
                            i[l] = A.points[L].point[l]
                    } else {
                        s.__fnct ? d = s.__fnct : (d = BezierFactory.getBezierEasing(a.o.x, a.o.y, a.i.x, a.i.y, a.n).get,
                        s.__fnct = d),
                        c = d((e - C) / (P - C));
                        var D, I = A.segmentLength * c, R = t.lastFrame < e && t._lastKeyframeIndex === m ? t._lastAddedLength : 0;
                        for (u = t.lastFrame < e && t._lastKeyframeIndex === m ? t._lastPoint : 0,
                        v = !0,
                        p = A.points.length; v; ) {
                            if (R += A.points[u].partialLength,
                            0 === I || 0 === c || u === A.points.length - 1) {
                                for (h = A.points[u].point.length,
                                l = 0; l < h; l += 1)
                                    i[l] = A.points[u].point[l];
                                break
                            }
                            if (I >= R && I < R + A.points[u + 1].partialLength) {
                                for (D = (I - R) / A.points[u + 1].partialLength,
                                h = A.points[u].point.length,
                                l = 0; l < h; l += 1)
                                    i[l] = A.points[u].point[l] + (A.points[u + 1].point[l] - A.points[u].point[l]) * D;
                                break
                            }
                            u < p - 1 ? u += 1 : v = !1
                        }
                        t._lastPoint = u,
                        t._lastAddedLength = R - A.points[u].partialLength,
                        t._lastKeyframeIndex = m
                    }
                } else {
                    var F, B, O, N, V;
                    if (g = a.s.length,
                    y = o.s || a.e,
                    this.sh && 1 !== a.h)
                        if (e >= P)
                            i[0] = y[0],
                            i[1] = y[1],
                            i[2] = y[2];
                        else if (e <= C)
                            i[0] = a.s[0],
                            i[1] = a.s[1],
                            i[2] = a.s[2];
                        else {
                            _ = i,
                            b = function(e, t, i) {
                                var r, n, a, o, s, l = [], h = e[0], c = e[1], p = e[2], u = e[3], d = t[0], f = t[1], m = t[2], g = t[3];
                                return (n = h * d + c * f + p * m + u * g) < 0 && (n = -n,
                                d = -d,
                                f = -f,
                                m = -m,
                                g = -g),
                                1 - n > 1e-6 ? (r = Math.acos(n),
                                a = Math.sin(r),
                                o = Math.sin((1 - i) * r) / a,
                                s = Math.sin(i * r) / a) : (o = 1 - i,
                                s = i),
                                l[0] = o * h + s * d,
                                l[1] = o * c + s * f,
                                l[2] = o * p + s * m,
                                l[3] = o * u + s * g,
                                l
                            }(r(a.s), r(y), (e - C) / (P - C)),
                            x = b[0],
                            w = b[1],
                            S = b[2],
                            T = b[3],
                            k = Math.atan2(2 * w * T - 2 * x * S, 1 - 2 * w * w - 2 * S * S),
                            E = Math.asin(2 * x * w + 2 * S * T),
                            M = Math.atan2(2 * x * T - 2 * w * S, 1 - 2 * x * x - 2 * S * S),
                            _[0] = k / degToRads,
                            _[1] = E / degToRads,
                            _[2] = M / degToRads
                        }
                    else
                        for (m = 0; m < g; m += 1)
                            1 !== a.h && (e >= P ? c = 1 : e < C ? c = 0 : (a.o.x.constructor === Array ? (s.__fnct || (s.__fnct = []),
                            s.__fnct[m] ? d = s.__fnct[m] : (F = void 0 === a.o.x[m] ? a.o.x[0] : a.o.x[m],
                            B = void 0 === a.o.y[m] ? a.o.y[0] : a.o.y[m],
                            O = void 0 === a.i.x[m] ? a.i.x[0] : a.i.x[m],
                            N = void 0 === a.i.y[m] ? a.i.y[0] : a.i.y[m],
                            d = BezierFactory.getBezierEasing(F, B, O, N).get,
                            s.__fnct[m] = d)) : s.__fnct ? d = s.__fnct : (F = a.o.x,
                            B = a.o.y,
                            O = a.i.x,
                            N = a.i.y,
                            d = BezierFactory.getBezierEasing(F, B, O, N).get,
                            a.keyframeMetadata = d),
                            c = d((e - C) / (P - C)))),
                            y = o.s || a.e,
                            V = 1 === a.h ? a.s[m] : a.s[m] + (y[m] - a.s[m]) * c,
                            "multidimensional" === this.propType ? i[m] = V : i = V
                }
                return t.lastIndex = f,
                i
            }
            function r(e) {
                var t = e[0] * degToRads
                  , i = e[1] * degToRads
                  , r = e[2] * degToRads
                  , n = Math.cos(t / 2)
                  , a = Math.cos(i / 2)
                  , o = Math.cos(r / 2)
                  , s = Math.sin(t / 2)
                  , l = Math.sin(i / 2)
                  , h = Math.sin(r / 2);
                return [s * l * o + n * a * h, s * a * o + n * l * h, n * l * o - s * a * h, n * a * o - s * l * h]
            }
            function n() {
                var t = this.comp.renderedFrame - this.offsetTime
                  , i = this.keyframes[0].t - this.offsetTime
                  , r = this.keyframes[this.keyframes.length - 1].t - this.offsetTime;
                if (!(t === this._caching.lastFrame || this._caching.lastFrame !== e && (this._caching.lastFrame >= r && t >= r || this._caching.lastFrame < i && t < i))) {
                    this._caching.lastFrame >= t && (this._caching._lastKeyframeIndex = -1,
                    this._caching.lastIndex = 0);
                    var n = this.interpolateValue(t, this._caching);
                    this.pv = n
                }
                return this._caching.lastFrame = t,
                this.pv
            }
            function a(e) {
                var i;
                if ("unidimensional" === this.propType)
                    i = e * this.mult,
                    t(this.v - i) > 1e-5 && (this.v = i,
                    this._mdf = !0);
                else
                    for (var r = 0, n = this.v.length; r < n; )
                        i = e[r] * this.mult,
                        t(this.v[r] - i) > 1e-5 && (this.v[r] = i,
                        this._mdf = !0),
                        r += 1
            }
            function o() {
                if (this.elem.globalData.frameId !== this.frameId && this.effectsSequence.length)
                    if (this.lock)
                        this.setVValue(this.pv);
                    else {
                        var e;
                        this.lock = !0,
                        this._mdf = this._isFirstFrame;
                        var t = this.effectsSequence.length
                          , i = this.kf ? this.pv : this.data.k;
                        for (e = 0; e < t; e += 1)
                            i = this.effectsSequence[e](i);
                        this.setVValue(i),
                        this._isFirstFrame = !1,
                        this.lock = !1,
                        this.frameId = this.elem.globalData.frameId
                    }
            }
            function s(e) {
                this.effectsSequence.push(e),
                this.container.addDynamicProperty(this)
            }
            function l(e, t, i, r) {
                this.propType = "unidimensional",
                this.mult = i || 1,
                this.data = t,
                this.v = i ? t.k * i : t.k,
                this.pv = t.k,
                this._mdf = !1,
                this.elem = e,
                this.container = r,
                this.comp = e.comp,
                this.k = !1,
                this.kf = !1,
                this.vel = 0,
                this.effectsSequence = [],
                this._isFirstFrame = !0,
                this.getValue = o,
                this.setVValue = a,
                this.addEffect = s
            }
            function h(e, t, i, r) {
                var n;
                this.propType = "multidimensional",
                this.mult = i || 1,
                this.data = t,
                this._mdf = !1,
                this.elem = e,
                this.container = r,
                this.comp = e.comp,
                this.k = !1,
                this.kf = !1,
                this.frameId = -1;
                var l = t.k.length;
                for (this.v = createTypedArray("float32", l),
                this.pv = createTypedArray("float32", l),
                this.vel = createTypedArray("float32", l),
                n = 0; n < l; n += 1)
                    this.v[n] = t.k[n] * this.mult,
                    this.pv[n] = t.k[n];
                this._isFirstFrame = !0,
                this.effectsSequence = [],
                this.getValue = o,
                this.setVValue = a,
                this.addEffect = s
            }
            function c(t, r, l, h) {
                this.propType = "unidimensional",
                this.keyframes = r.k,
                this.keyframesMetadata = [],
                this.offsetTime = t.data.st,
                this.frameId = -1,
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0,
                    value: 0,
                    _lastKeyframeIndex: -1
                },
                this.k = !0,
                this.kf = !0,
                this.data = r,
                this.mult = l || 1,
                this.elem = t,
                this.container = h,
                this.comp = t.comp,
                this.v = e,
                this.pv = e,
                this._isFirstFrame = !0,
                this.getValue = o,
                this.setVValue = a,
                this.interpolateValue = i,
                this.effectsSequence = [n.bind(this)],
                this.addEffect = s
            }
            function p(t, r, l, h) {
                var c;
                this.propType = "multidimensional";
                var p, u, d, f, m = r.k.length;
                for (c = 0; c < m - 1; c += 1)
                    r.k[c].to && r.k[c].s && r.k[c + 1] && r.k[c + 1].s && (p = r.k[c].s,
                    u = r.k[c + 1].s,
                    d = r.k[c].to,
                    f = r.k[c].ti,
                    (2 === p.length && (p[0] !== u[0] || p[1] !== u[1]) && bez.pointOnLine2D(p[0], p[1], u[0], u[1], p[0] + d[0], p[1] + d[1]) && bez.pointOnLine2D(p[0], p[1], u[0], u[1], u[0] + f[0], u[1] + f[1]) || 3 === p.length && (p[0] !== u[0] || p[1] !== u[1] || p[2] !== u[2]) && bez.pointOnLine3D(p[0], p[1], p[2], u[0], u[1], u[2], p[0] + d[0], p[1] + d[1], p[2] + d[2]) && bez.pointOnLine3D(p[0], p[1], p[2], u[0], u[1], u[2], u[0] + f[0], u[1] + f[1], u[2] + f[2])) && (r.k[c].to = null,
                    r.k[c].ti = null),
                    p[0] === u[0] && p[1] === u[1] && 0 === d[0] && 0 === d[1] && 0 === f[0] && 0 === f[1] && (2 === p.length || p[2] === u[2] && 0 === d[2] && 0 === f[2]) && (r.k[c].to = null,
                    r.k[c].ti = null));
                this.effectsSequence = [n.bind(this)],
                this.data = r,
                this.keyframes = r.k,
                this.keyframesMetadata = [],
                this.offsetTime = t.data.st,
                this.k = !0,
                this.kf = !0,
                this._isFirstFrame = !0,
                this.mult = l || 1,
                this.elem = t,
                this.container = h,
                this.comp = t.comp,
                this.getValue = o,
                this.setVValue = a,
                this.interpolateValue = i,
                this.frameId = -1;
                var g = r.k[0].s.length;
                for (this.v = createTypedArray("float32", g),
                this.pv = createTypedArray("float32", g),
                c = 0; c < g; c += 1)
                    this.v[c] = e,
                    this.pv[c] = e;
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0,
                    value: createTypedArray("float32", g)
                },
                this.addEffect = s
            }
            return {
                getProp: function(e, t, i, r, n) {
                    var a;
                    if (t.k.length)
                        if ("number" == typeof t.k[0])
                            a = new h(e,t,r,n);
                        else
                            switch (i) {
                            case 0:
                                a = new c(e,t,r,n);
                                break;
                            case 1:
                                a = new p(e,t,r,n)
                            }
                    else
                        a = new l(e,t,r,n);
                    return a.effectsSequence.length && n.addDynamicProperty(a),
                    a
                }
            }
        }();
        function DynamicPropertyContainer() {}
        DynamicPropertyContainer.prototype = {
            addDynamicProperty: function(e) {
                -1 === this.dynamicProperties.indexOf(e) && (this.dynamicProperties.push(e),
                this.container.addDynamicProperty(this),
                this._isAnimated = !0)
            },
            iterateDynamicProperties: function() {
                var e;
                this._mdf = !1;
                var t = this.dynamicProperties.length;
                for (e = 0; e < t; e += 1)
                    this.dynamicProperties[e].getValue(),
                    this.dynamicProperties[e]._mdf && (this._mdf = !0)
            },
            initDynamicPropertyContainer: function(e) {
                this.container = e,
                this.dynamicProperties = [],
                this._mdf = !1,
                this._isAnimated = !1
            }
        };
        var pointPool = poolFactory(8, (function() {
            return createTypedArray("float32", 2)
        }
        ));
        function ShapePath() {
            this.c = !1,
            this._length = 0,
            this._maxLength = 8,
            this.v = createSizedArray(this._maxLength),
            this.o = createSizedArray(this._maxLength),
            this.i = createSizedArray(this._maxLength)
        }
        ShapePath.prototype.setPathData = function(e, t) {
            this.c = e,
            this.setLength(t);
            for (var i = 0; i < t; )
                this.v[i] = pointPool.newElement(),
                this.o[i] = pointPool.newElement(),
                this.i[i] = pointPool.newElement(),
                i += 1
        }
        ,
        ShapePath.prototype.setLength = function(e) {
            for (; this._maxLength < e; )
                this.doubleArrayLength();
            this._length = e
        }
        ,
        ShapePath.prototype.doubleArrayLength = function() {
            this.v = this.v.concat(createSizedArray(this._maxLength)),
            this.i = this.i.concat(createSizedArray(this._maxLength)),
            this.o = this.o.concat(createSizedArray(this._maxLength)),
            this._maxLength *= 2
        }
        ,
        ShapePath.prototype.setXYAt = function(e, t, i, r, n) {
            var a;
            switch (this._length = Math.max(this._length, r + 1),
            this._length >= this._maxLength && this.doubleArrayLength(),
            i) {
            case "v":
                a = this.v;
                break;
            case "i":
                a = this.i;
                break;
            case "o":
                a = this.o;
                break;
            default:
                a = []
            }
            (!a[r] || a[r] && !n) && (a[r] = pointPool.newElement()),
            a[r][0] = e,
            a[r][1] = t
        }
        ,
        ShapePath.prototype.setTripleAt = function(e, t, i, r, n, a, o, s) {
            this.setXYAt(e, t, "v", o, s),
            this.setXYAt(i, r, "o", o, s),
            this.setXYAt(n, a, "i", o, s)
        }
        ,
        ShapePath.prototype.reverse = function() {
            var e = new ShapePath;
            e.setPathData(this.c, this._length);
            var t = this.v
              , i = this.o
              , r = this.i
              , n = 0;
            this.c && (e.setTripleAt(t[0][0], t[0][1], r[0][0], r[0][1], i[0][0], i[0][1], 0, !1),
            n = 1);
            var a, o = this._length - 1, s = this._length;
            for (a = n; a < s; a += 1)
                e.setTripleAt(t[o][0], t[o][1], r[o][0], r[o][1], i[o][0], i[o][1], a, !1),
                o -= 1;
            return e
        }
        ;
        var shapePool = (factory2 = poolFactory(4, (function() {
            return new ShapePath
        }
        ), (function(e) {
            var t, i = e._length;
            for (t = 0; t < i; t += 1)
                pointPool.release(e.v[t]),
                pointPool.release(e.i[t]),
                pointPool.release(e.o[t]),
                e.v[t] = null,
                e.i[t] = null,
                e.o[t] = null;
            e._length = 0,
            e.c = !1
        }
        )),
        factory2.clone = function(e) {
            var t, i = factory2.newElement(), r = void 0 === e._length ? e.v.length : e._length;
            for (i.setLength(r),
            i.c = e.c,
            t = 0; t < r; t += 1)
                i.setTripleAt(e.v[t][0], e.v[t][1], e.o[t][0], e.o[t][1], e.i[t][0], e.i[t][1], t);
            return i
        }
        ,
        factory2), factory2;
        function ShapeCollection() {
            this._length = 0,
            this._maxLength = 4,
            this.shapes = createSizedArray(this._maxLength)
        }
        ShapeCollection.prototype.addShape = function(e) {
            this._length === this._maxLength && (this.shapes = this.shapes.concat(createSizedArray(this._maxLength)),
            this._maxLength *= 2),
            this.shapes[this._length] = e,
            this._length += 1
        }
        ,
        ShapeCollection.prototype.releaseShapes = function() {
            var e;
            for (e = 0; e < this._length; e += 1)
                shapePool.release(this.shapes[e]);
            this._length = 0
        }
        ;
        var shapeCollectionPool = (ob2 = {
            newShapeCollection: function() {
                return _length ? pool[_length -= 1] : new ShapeCollection
            },
            release: function(e) {
                var t, i = e._length;
                for (t = 0; t < i; t += 1)
                    shapePool.release(e.shapes[t]);
                e._length = 0,
                _length === _maxLength && (pool = pooling.double(pool),
                _maxLength *= 2),
                pool[_length] = e,
                _length += 1
            }
        },
        _length = 0,
        _maxLength = 4,
        pool = createSizedArray(_maxLength),
        ob2), ob2, _length, _maxLength, pool, ShapePropertyFactory = function() {
            var e = -999999;
            function t(e, t, i) {
                var r, n, a, o, s, l, h, c, p, u = i.lastIndex, d = this.keyframes;
                if (e < d[0].t - this.offsetTime)
                    r = d[0].s[0],
                    a = !0,
                    u = 0;
                else if (e >= d[d.length - 1].t - this.offsetTime)
                    r = d[d.length - 1].s ? d[d.length - 1].s[0] : d[d.length - 2].e[0],
                    a = !0;
                else {
                    for (var f, m, g, v = u, y = d.length - 1, _ = !0; _ && (f = d[v],
                    !((m = d[v + 1]).t - this.offsetTime > e)); )
                        v < y - 1 ? v += 1 : _ = !1;
                    if (g = this.keyframesMetadata[v] || {},
                    u = v,
                    !(a = 1 === f.h)) {
                        if (e >= m.t - this.offsetTime)
                            c = 1;
                        else if (e < f.t - this.offsetTime)
                            c = 0;
                        else {
                            var b;
                            g.__fnct ? b = g.__fnct : (b = BezierFactory.getBezierEasing(f.o.x, f.o.y, f.i.x, f.i.y).get,
                            g.__fnct = b),
                            c = b((e - (f.t - this.offsetTime)) / (m.t - this.offsetTime - (f.t - this.offsetTime)))
                        }
                        n = m.s ? m.s[0] : f.e[0]
                    }
                    r = f.s[0]
                }
                for (l = t._length,
                h = r.i[0].length,
                i.lastIndex = u,
                o = 0; o < l; o += 1)
                    for (s = 0; s < h; s += 1)
                        p = a ? r.i[o][s] : r.i[o][s] + (n.i[o][s] - r.i[o][s]) * c,
                        t.i[o][s] = p,
                        p = a ? r.o[o][s] : r.o[o][s] + (n.o[o][s] - r.o[o][s]) * c,
                        t.o[o][s] = p,
                        p = a ? r.v[o][s] : r.v[o][s] + (n.v[o][s] - r.v[o][s]) * c,
                        t.v[o][s] = p
            }
            function i() {
                var t = this.comp.renderedFrame - this.offsetTime
                  , i = this.keyframes[0].t - this.offsetTime
                  , r = this.keyframes[this.keyframes.length - 1].t - this.offsetTime
                  , n = this._caching.lastFrame;
                return n !== e && (n < i && t < i || n > r && t > r) || (this._caching.lastIndex = n < t ? this._caching.lastIndex : 0,
                this.interpolateShape(t, this.pv, this._caching)),
                this._caching.lastFrame = t,
                this.pv
            }
            function r() {
                this.paths = this.localShapeCollection
            }
            function n(e) {
                (function(e, t) {
                    if (e._length !== t._length || e.c !== t.c)
                        return !1;
                    var i, r = e._length;
                    for (i = 0; i < r; i += 1)
                        if (e.v[i][0] !== t.v[i][0] || e.v[i][1] !== t.v[i][1] || e.o[i][0] !== t.o[i][0] || e.o[i][1] !== t.o[i][1] || e.i[i][0] !== t.i[i][0] || e.i[i][1] !== t.i[i][1])
                            return !1;
                    return !0
                }
                )(this.v, e) || (this.v = shapePool.clone(e),
                this.localShapeCollection.releaseShapes(),
                this.localShapeCollection.addShape(this.v),
                this._mdf = !0,
                this.paths = this.localShapeCollection)
            }
            function a() {
                if (this.elem.globalData.frameId !== this.frameId)
                    if (this.effectsSequence.length)
                        if (this.lock)
                            this.setVValue(this.pv);
                        else {
                            var e, t;
                            this.lock = !0,
                            this._mdf = !1,
                            e = this.kf ? this.pv : this.data.ks ? this.data.ks.k : this.data.pt.k;
                            var i = this.effectsSequence.length;
                            for (t = 0; t < i; t += 1)
                                e = this.effectsSequence[t](e);
                            this.setVValue(e),
                            this.lock = !1,
                            this.frameId = this.elem.globalData.frameId
                        }
                    else
                        this._mdf = !1
            }
            function o(e, t, i) {
                this.propType = "shape",
                this.comp = e.comp,
                this.container = e,
                this.elem = e,
                this.data = t,
                this.k = !1,
                this.kf = !1,
                this._mdf = !1;
                var n = 3 === i ? t.pt.k : t.ks.k;
                this.v = shapePool.clone(n),
                this.pv = shapePool.clone(this.v),
                this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                this.paths = this.localShapeCollection,
                this.paths.addShape(this.v),
                this.reset = r,
                this.effectsSequence = []
            }
            function s(e) {
                this.effectsSequence.push(e),
                this.container.addDynamicProperty(this)
            }
            function l(t, n, a) {
                this.propType = "shape",
                this.comp = t.comp,
                this.elem = t,
                this.container = t,
                this.offsetTime = t.data.st,
                this.keyframes = 3 === a ? n.pt.k : n.ks.k,
                this.keyframesMetadata = [],
                this.k = !0,
                this.kf = !0;
                var o = this.keyframes[0].s[0].i.length;
                this.v = shapePool.newElement(),
                this.v.setPathData(this.keyframes[0].s[0].c, o),
                this.pv = shapePool.clone(this.v),
                this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                this.paths = this.localShapeCollection,
                this.paths.addShape(this.v),
                this.lastFrame = e,
                this.reset = r,
                this._caching = {
                    lastFrame: e,
                    lastIndex: 0
                },
                this.effectsSequence = [i.bind(this)]
            }
            o.prototype.interpolateShape = t,
            o.prototype.getValue = a,
            o.prototype.setVValue = n,
            o.prototype.addEffect = s,
            l.prototype.getValue = a,
            l.prototype.interpolateShape = t,
            l.prototype.setVValue = n,
            l.prototype.addEffect = s;
            var h = function() {
                var e = roundCorner;
                function t(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.setPathData(!0, 4),
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.paths = this.localShapeCollection,
                    this.localShapeCollection.addShape(this.v),
                    this.d = t.d,
                    this.elem = e,
                    this.comp = e.comp,
                    this.frameId = -1,
                    this.initDynamicPropertyContainer(e),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.s = PropertyFactory.getProp(e, t.s, 1, 0, this),
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertEllToPath())
                }
                return t.prototype = {
                    reset: r,
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertEllToPath())
                    },
                    convertEllToPath: function() {
                        var t = this.p.v[0]
                          , i = this.p.v[1]
                          , r = this.s.v[0] / 2
                          , n = this.s.v[1] / 2
                          , a = 3 !== this.d
                          , o = this.v;
                        o.v[0][0] = t,
                        o.v[0][1] = i - n,
                        o.v[1][0] = a ? t + r : t - r,
                        o.v[1][1] = i,
                        o.v[2][0] = t,
                        o.v[2][1] = i + n,
                        o.v[3][0] = a ? t - r : t + r,
                        o.v[3][1] = i,
                        o.i[0][0] = a ? t - r * e : t + r * e,
                        o.i[0][1] = i - n,
                        o.i[1][0] = a ? t + r : t - r,
                        o.i[1][1] = i - n * e,
                        o.i[2][0] = a ? t + r * e : t - r * e,
                        o.i[2][1] = i + n,
                        o.i[3][0] = a ? t - r : t + r,
                        o.i[3][1] = i + n * e,
                        o.o[0][0] = a ? t + r * e : t - r * e,
                        o.o[0][1] = i - n,
                        o.o[1][0] = a ? t + r : t - r,
                        o.o[1][1] = i + n * e,
                        o.o[2][0] = a ? t - r * e : t + r * e,
                        o.o[2][1] = i + n,
                        o.o[3][0] = a ? t - r : t + r,
                        o.o[3][1] = i - n * e
                    }
                },
                extendPrototype([DynamicPropertyContainer], t),
                t
            }()
              , c = function() {
                function e(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.setPathData(!0, 0),
                    this.elem = e,
                    this.comp = e.comp,
                    this.data = t,
                    this.frameId = -1,
                    this.d = t.d,
                    this.initDynamicPropertyContainer(e),
                    1 === t.sy ? (this.ir = PropertyFactory.getProp(e, t.ir, 0, 0, this),
                    this.is = PropertyFactory.getProp(e, t.is, 0, .01, this),
                    this.convertToPath = this.convertStarToPath) : this.convertToPath = this.convertPolygonToPath,
                    this.pt = PropertyFactory.getProp(e, t.pt, 0, 0, this),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.r = PropertyFactory.getProp(e, t.r, 0, degToRads, this),
                    this.or = PropertyFactory.getProp(e, t.or, 0, 0, this),
                    this.os = PropertyFactory.getProp(e, t.os, 0, .01, this),
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.localShapeCollection.addShape(this.v),
                    this.paths = this.localShapeCollection,
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertToPath())
                }
                return e.prototype = {
                    reset: r,
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertToPath())
                    },
                    convertStarToPath: function() {
                        var e, t, i, r, n = 2 * Math.floor(this.pt.v), a = 2 * Math.PI / n, o = !0, s = this.or.v, l = this.ir.v, h = this.os.v, c = this.is.v, p = 2 * Math.PI * s / (2 * n), u = 2 * Math.PI * l / (2 * n), d = -Math.PI / 2;
                        d += this.r.v;
                        var f = 3 === this.data.d ? -1 : 1;
                        for (this.v._length = 0,
                        e = 0; e < n; e += 1) {
                            i = o ? h : c,
                            r = o ? p : u;
                            var m = (t = o ? s : l) * Math.cos(d)
                              , g = t * Math.sin(d)
                              , v = 0 === m && 0 === g ? 0 : g / Math.sqrt(m * m + g * g)
                              , y = 0 === m && 0 === g ? 0 : -m / Math.sqrt(m * m + g * g);
                            m += +this.p.v[0],
                            g += +this.p.v[1],
                            this.v.setTripleAt(m, g, m - v * r * i * f, g - y * r * i * f, m + v * r * i * f, g + y * r * i * f, e, !0),
                            o = !o,
                            d += a * f
                        }
                    },
                    convertPolygonToPath: function() {
                        var e, t = Math.floor(this.pt.v), i = 2 * Math.PI / t, r = this.or.v, n = this.os.v, a = 2 * Math.PI * r / (4 * t), o = .5 * -Math.PI, s = 3 === this.data.d ? -1 : 1;
                        for (o += this.r.v,
                        this.v._length = 0,
                        e = 0; e < t; e += 1) {
                            var l = r * Math.cos(o)
                              , h = r * Math.sin(o)
                              , c = 0 === l && 0 === h ? 0 : h / Math.sqrt(l * l + h * h)
                              , p = 0 === l && 0 === h ? 0 : -l / Math.sqrt(l * l + h * h);
                            l += +this.p.v[0],
                            h += +this.p.v[1],
                            this.v.setTripleAt(l, h, l - c * a * n * s, h - p * a * n * s, l + c * a * n * s, h + p * a * n * s, e, !0),
                            o += i * s
                        }
                        this.paths.length = 0,
                        this.paths[0] = this.v
                    }
                },
                extendPrototype([DynamicPropertyContainer], e),
                e
            }()
              , p = function() {
                function e(e, t) {
                    this.v = shapePool.newElement(),
                    this.v.c = !0,
                    this.localShapeCollection = shapeCollectionPool.newShapeCollection(),
                    this.localShapeCollection.addShape(this.v),
                    this.paths = this.localShapeCollection,
                    this.elem = e,
                    this.comp = e.comp,
                    this.frameId = -1,
                    this.d = t.d,
                    this.initDynamicPropertyContainer(e),
                    this.p = PropertyFactory.getProp(e, t.p, 1, 0, this),
                    this.s = PropertyFactory.getProp(e, t.s, 1, 0, this),
                    this.r = PropertyFactory.getProp(e, t.r, 0, 0, this),
                    this.dynamicProperties.length ? this.k = !0 : (this.k = !1,
                    this.convertRectToPath())
                }
                return e.prototype = {
                    convertRectToPath: function() {
                        var e = this.p.v[0]
                          , t = this.p.v[1]
                          , i = this.s.v[0] / 2
                          , r = this.s.v[1] / 2
                          , n = bmMin(i, r, this.r.v)
                          , a = n * (1 - roundCorner);
                        this.v._length = 0,
                        2 === this.d || 1 === this.d ? (this.v.setTripleAt(e + i, t - r + n, e + i, t - r + n, e + i, t - r + a, 0, !0),
                        this.v.setTripleAt(e + i, t + r - n, e + i, t + r - a, e + i, t + r - n, 1, !0),
                        0 !== n ? (this.v.setTripleAt(e + i - n, t + r, e + i - n, t + r, e + i - a, t + r, 2, !0),
                        this.v.setTripleAt(e - i + n, t + r, e - i + a, t + r, e - i + n, t + r, 3, !0),
                        this.v.setTripleAt(e - i, t + r - n, e - i, t + r - n, e - i, t + r - a, 4, !0),
                        this.v.setTripleAt(e - i, t - r + n, e - i, t - r + a, e - i, t - r + n, 5, !0),
                        this.v.setTripleAt(e - i + n, t - r, e - i + n, t - r, e - i + a, t - r, 6, !0),
                        this.v.setTripleAt(e + i - n, t - r, e + i - a, t - r, e + i - n, t - r, 7, !0)) : (this.v.setTripleAt(e - i, t + r, e - i + a, t + r, e - i, t + r, 2),
                        this.v.setTripleAt(e - i, t - r, e - i, t - r + a, e - i, t - r, 3))) : (this.v.setTripleAt(e + i, t - r + n, e + i, t - r + a, e + i, t - r + n, 0, !0),
                        0 !== n ? (this.v.setTripleAt(e + i - n, t - r, e + i - n, t - r, e + i - a, t - r, 1, !0),
                        this.v.setTripleAt(e - i + n, t - r, e - i + a, t - r, e - i + n, t - r, 2, !0),
                        this.v.setTripleAt(e - i, t - r + n, e - i, t - r + n, e - i, t - r + a, 3, !0),
                        this.v.setTripleAt(e - i, t + r - n, e - i, t + r - a, e - i, t + r - n, 4, !0),
                        this.v.setTripleAt(e - i + n, t + r, e - i + n, t + r, e - i + a, t + r, 5, !0),
                        this.v.setTripleAt(e + i - n, t + r, e + i - a, t + r, e + i - n, t + r, 6, !0),
                        this.v.setTripleAt(e + i, t + r - n, e + i, t + r - n, e + i, t + r - a, 7, !0)) : (this.v.setTripleAt(e - i, t - r, e - i + a, t - r, e - i, t - r, 1, !0),
                        this.v.setTripleAt(e - i, t + r, e - i, t + r - a, e - i, t + r, 2, !0),
                        this.v.setTripleAt(e + i, t + r, e + i - a, t + r, e + i, t + r, 3, !0)))
                    },
                    getValue: function() {
                        this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
                        this.iterateDynamicProperties(),
                        this._mdf && this.convertRectToPath())
                    },
                    reset: r
                },
                extendPrototype([DynamicPropertyContainer], e),
                e
            }();
            return {
                getShapeProp: function(e, t, i) {
                    var r;
                    return 3 === i || 4 === i ? r = (3 === i ? t.pt : t.ks).k.length ? new l(e,t,i) : new o(e,t,i) : 5 === i ? r = new p(e,t) : 6 === i ? r = new h(e,t) : 7 === i && (r = new c(e,t)),
                    r.k && e.addDynamicProperty(r),
                    r
                },
                getConstructorFunction: function() {
                    return o
                },
                getKeyframedConstructorFunction: function() {
                    return l
                }
            }
        }(), Matrix = function() {
            var e = Math.cos
              , t = Math.sin
              , i = Math.tan
              , r = Math.round;
            function n() {
                return this.props[0] = 1,
                this.props[1] = 0,
                this.props[2] = 0,
                this.props[3] = 0,
                this.props[4] = 0,
                this.props[5] = 1,
                this.props[6] = 0,
                this.props[7] = 0,
                this.props[8] = 0,
                this.props[9] = 0,
                this.props[10] = 1,
                this.props[11] = 0,
                this.props[12] = 0,
                this.props[13] = 0,
                this.props[14] = 0,
                this.props[15] = 1,
                this
            }
            function a(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, -n, 0, 0, n, r, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function o(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(1, 0, 0, 0, 0, r, -n, 0, 0, n, r, 0, 0, 0, 0, 1)
            }
            function s(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, 0, n, 0, 0, 1, 0, 0, -n, 0, r, 0, 0, 0, 0, 1)
            }
            function l(i) {
                if (0 === i)
                    return this;
                var r = e(i)
                  , n = t(i);
                return this._t(r, -n, 0, 0, n, r, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function h(e, t) {
                return this._t(1, t, e, 1, 0, 0)
            }
            function c(e, t) {
                return this.shear(i(e), i(t))
            }
            function p(r, n) {
                var a = e(n)
                  , o = t(n);
                return this._t(a, o, 0, 0, -o, a, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)._t(1, 0, 0, 0, i(r), 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)._t(a, -o, 0, 0, o, a, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }
            function u(e, t, i) {
                return i || 0 === i || (i = 1),
                1 === e && 1 === t && 1 === i ? this : this._t(e, 0, 0, 0, 0, t, 0, 0, 0, 0, i, 0, 0, 0, 0, 1)
            }
            function d(e, t, i, r, n, a, o, s, l, h, c, p, u, d, f, m) {
                return this.props[0] = e,
                this.props[1] = t,
                this.props[2] = i,
                this.props[3] = r,
                this.props[4] = n,
                this.props[5] = a,
                this.props[6] = o,
                this.props[7] = s,
                this.props[8] = l,
                this.props[9] = h,
                this.props[10] = c,
                this.props[11] = p,
                this.props[12] = u,
                this.props[13] = d,
                this.props[14] = f,
                this.props[15] = m,
                this
            }
            function f(e, t, i) {
                return i = i || 0,
                0 !== e || 0 !== t || 0 !== i ? this._t(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, e, t, i, 1) : this
            }
            function m(e, t, i, r, n, a, o, s, l, h, c, p, u, d, f, m) {
                var g = this.props;
                if (1 === e && 0 === t && 0 === i && 0 === r && 0 === n && 1 === a && 0 === o && 0 === s && 0 === l && 0 === h && 1 === c && 0 === p)
                    return g[12] = g[12] * e + g[15] * u,
                    g[13] = g[13] * a + g[15] * d,
                    g[14] = g[14] * c + g[15] * f,
                    g[15] *= m,
                    this._identityCalculated = !1,
                    this;
                var v = g[0]
                  , y = g[1]
                  , _ = g[2]
                  , b = g[3]
                  , x = g[4]
                  , w = g[5]
                  , S = g[6]
                  , T = g[7]
                  , k = g[8]
                  , E = g[9]
                  , M = g[10]
                  , P = g[11]
                  , C = g[12]
                  , A = g[13]
                  , L = g[14]
                  , D = g[15];
                return g[0] = v * e + y * n + _ * l + b * u,
                g[1] = v * t + y * a + _ * h + b * d,
                g[2] = v * i + y * o + _ * c + b * f,
                g[3] = v * r + y * s + _ * p + b * m,
                g[4] = x * e + w * n + S * l + T * u,
                g[5] = x * t + w * a + S * h + T * d,
                g[6] = x * i + w * o + S * c + T * f,
                g[7] = x * r + w * s + S * p + T * m,
                g[8] = k * e + E * n + M * l + P * u,
                g[9] = k * t + E * a + M * h + P * d,
                g[10] = k * i + E * o + M * c + P * f,
                g[11] = k * r + E * s + M * p + P * m,
                g[12] = C * e + A * n + L * l + D * u,
                g[13] = C * t + A * a + L * h + D * d,
                g[14] = C * i + A * o + L * c + D * f,
                g[15] = C * r + A * s + L * p + D * m,
                this._identityCalculated = !1,
                this
            }
            function g() {
                return this._identityCalculated || (this._identity = !(1 !== this.props[0] || 0 !== this.props[1] || 0 !== this.props[2] || 0 !== this.props[3] || 0 !== this.props[4] || 1 !== this.props[5] || 0 !== this.props[6] || 0 !== this.props[7] || 0 !== this.props[8] || 0 !== this.props[9] || 1 !== this.props[10] || 0 !== this.props[11] || 0 !== this.props[12] || 0 !== this.props[13] || 0 !== this.props[14] || 1 !== this.props[15]),
                this._identityCalculated = !0),
                this._identity
            }
            function v(e) {
                for (var t = 0; t < 16; ) {
                    if (e.props[t] !== this.props[t])
                        return !1;
                    t += 1
                }
                return !0
            }
            function y(e) {
                var t;
                for (t = 0; t < 16; t += 1)
                    e.props[t] = this.props[t];
                return e
            }
            function _(e) {
                var t;
                for (t = 0; t < 16; t += 1)
                    this.props[t] = e[t]
            }
            function b(e, t, i) {
                return {
                    x: e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12],
                    y: e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13],
                    z: e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]
                }
            }
            function x(e, t, i) {
                return e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12]
            }
            function w(e, t, i) {
                return e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13]
            }
            function S(e, t, i) {
                return e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]
            }
            function T() {
                var e = this.props[0] * this.props[5] - this.props[1] * this.props[4]
                  , t = this.props[5] / e
                  , i = -this.props[1] / e
                  , r = -this.props[4] / e
                  , n = this.props[0] / e
                  , a = (this.props[4] * this.props[13] - this.props[5] * this.props[12]) / e
                  , o = -(this.props[0] * this.props[13] - this.props[1] * this.props[12]) / e
                  , s = new Matrix;
                return s.props[0] = t,
                s.props[1] = i,
                s.props[4] = r,
                s.props[5] = n,
                s.props[12] = a,
                s.props[13] = o,
                s
            }
            function k(e) {
                return this.getInverseMatrix().applyToPointArray(e[0], e[1], e[2] || 0)
            }
            function E(e) {
                var t, i = e.length, r = [];
                for (t = 0; t < i; t += 1)
                    r[t] = k(e[t]);
                return r
            }
            function M(e, t, i) {
                var r = createTypedArray("float32", 6);
                if (this.isIdentity())
                    r[0] = e[0],
                    r[1] = e[1],
                    r[2] = t[0],
                    r[3] = t[1],
                    r[4] = i[0],
                    r[5] = i[1];
                else {
                    var n = this.props[0]
                      , a = this.props[1]
                      , o = this.props[4]
                      , s = this.props[5]
                      , l = this.props[12]
                      , h = this.props[13];
                    r[0] = e[0] * n + e[1] * o + l,
                    r[1] = e[0] * a + e[1] * s + h,
                    r[2] = t[0] * n + t[1] * o + l,
                    r[3] = t[0] * a + t[1] * s + h,
                    r[4] = i[0] * n + i[1] * o + l,
                    r[5] = i[0] * a + i[1] * s + h
                }
                return r
            }
            function P(e, t, i) {
                return this.isIdentity() ? [e, t, i] : [e * this.props[0] + t * this.props[4] + i * this.props[8] + this.props[12], e * this.props[1] + t * this.props[5] + i * this.props[9] + this.props[13], e * this.props[2] + t * this.props[6] + i * this.props[10] + this.props[14]]
            }
            function C(e, t) {
                if (this.isIdentity())
                    return e + "," + t;
                var i = this.props;
                return Math.round(100 * (e * i[0] + t * i[4] + i[12])) / 100 + "," + Math.round(100 * (e * i[1] + t * i[5] + i[13])) / 100
            }
            function A() {
                for (var e = 0, t = this.props, i = "matrix3d("; e < 16; )
                    i += r(1e4 * t[e]) / 1e4,
                    i += 15 === e ? ")" : ",",
                    e += 1;
                return i
            }
            function L(e) {
                return e < 1e-6 && e > 0 || e > -1e-6 && e < 0 ? r(1e4 * e) / 1e4 : e
            }
            function D() {
                var e = this.props;
                return "matrix(" + L(e[0]) + "," + L(e[1]) + "," + L(e[4]) + "," + L(e[5]) + "," + L(e[12]) + "," + L(e[13]) + ")"
            }
            return function() {
                this.reset = n,
                this.rotate = a,
                this.rotateX = o,
                this.rotateY = s,
                this.rotateZ = l,
                this.skew = c,
                this.skewFromAxis = p,
                this.shear = h,
                this.scale = u,
                this.setTransform = d,
                this.translate = f,
                this.transform = m,
                this.applyToPoint = b,
                this.applyToX = x,
                this.applyToY = w,
                this.applyToZ = S,
                this.applyToPointArray = P,
                this.applyToTriplePoints = M,
                this.applyToPointStringified = C,
                this.toCSS = A,
                this.to2dCSS = D,
                this.clone = y,
                this.cloneFromProps = _,
                this.equals = v,
                this.inversePoints = E,
                this.inversePoint = k,
                this.getInverseMatrix = T,
                this._t = this.transform,
                this.isIdentity = g,
                this._identity = !0,
                this._identityCalculated = !1,
                this.props = createTypedArray("float32", 16),
                this.reset()
            }
        }();
        function _typeof$3(e) {
            return (_typeof$3 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        var lottie = {};
        function setLocation(e) {
            setLocationHref(e)
        }
        function searchAnimations() {
            animationManager.searchAnimations()
        }
        function setSubframeRendering(e) {
            setSubframeEnabled(e)
        }
        function setPrefix(e) {
            setIdPrefix(e)
        }
        function loadAnimation(e) {
            return animationManager.loadAnimation(e)
        }
        function setQuality(e) {
            if ("string" == typeof e)
                switch (e) {
                case "high":
                    setDefaultCurveSegments(200);
                    break;
                default:
                case "medium":
                    setDefaultCurveSegments(50);
                    break;
                case "low":
                    setDefaultCurveSegments(10)
                }
            else
                !isNaN(e) && e > 1 && setDefaultCurveSegments(e)
        }
        function inBrowser() {
            return "undefined" != typeof navigator
        }
        function installPlugin(e, t) {
            "expressions" === e && setExpressionsPlugin(t)
        }
        function getFactory(e) {
            switch (e) {
            case "propertyFactory":
                return PropertyFactory;
            case "shapePropertyFactory":
                return ShapePropertyFactory;
            case "matrix":
                return Matrix;
            default:
                return null
            }
        }
        function checkReady() {
            "complete" === document.readyState && (clearInterval(readyStateCheckInterval),
            searchAnimations())
        }
        function getQueryVariable(e) {
            for (var t = queryString.split("&"), i = 0; i < t.length; i += 1) {
                var r = t[i].split("=");
                if (decodeURIComponent(r[0]) == e)
                    return decodeURIComponent(r[1])
            }
            return null
        }
        lottie.play = animationManager.play,
        lottie.pause = animationManager.pause,
        lottie.setLocationHref = setLocation,
        lottie.togglePause = animationManager.togglePause,
        lottie.setSpeed = animationManager.setSpeed,
        lottie.setDirection = animationManager.setDirection,
        lottie.stop = animationManager.stop,
        lottie.searchAnimations = searchAnimations,
        lottie.registerAnimation = animationManager.registerAnimation,
        lottie.loadAnimation = loadAnimation,
        lottie.setSubframeRendering = setSubframeRendering,
        lottie.resize = animationManager.resize,
        lottie.goToAndStop = animationManager.goToAndStop,
        lottie.destroy = animationManager.destroy,
        lottie.setQuality = setQuality,
        lottie.inBrowser = inBrowser,
        lottie.installPlugin = installPlugin,
        lottie.freeze = animationManager.freeze,
        lottie.unfreeze = animationManager.unfreeze,
        lottie.setVolume = animationManager.setVolume,
        lottie.mute = animationManager.mute,
        lottie.unmute = animationManager.unmute,
        lottie.getRegisteredAnimations = animationManager.getRegisteredAnimations,
        lottie.useWebWorker = setWebWorker,
        lottie.setIDPrefix = setPrefix,
        lottie.__getFactory = getFactory,
        lottie.version = "5.9.4";
        var queryString = ""
          , scripts = document.getElementsByTagName("script")
          , index = scripts.length - 1
          , myScript = scripts[index] || {
            src: ""
        };
        queryString = myScript.src ? myScript.src.replace(/^[^\?]+\??/, "") : "",
        getQueryVariable("renderer");
        var readyStateCheckInterval = setInterval(checkReady, 100);
        try {
            "object" !== _typeof$3(exports) && (window.bodymovin = lottie)
        } catch (err) {}
        var ShapeModifiers = function() {
            var e = {}
              , t = {};
            return e.registerModifier = function(e, i) {
                t[e] || (t[e] = i)
            }
            ,
            e.getModifier = function(e, i, r) {
                return new t[e](i,r)
            }
            ,
            e
        }();
        function ShapeModifier() {}
        function TrimModifier() {}
        function PuckerAndBloatModifier() {}
        ShapeModifier.prototype.initModifierProperties = function() {}
        ,
        ShapeModifier.prototype.addShapeToModifier = function() {}
        ,
        ShapeModifier.prototype.addShape = function(e) {
            if (!this.closed) {
                e.sh.container.addDynamicProperty(e.sh);
                var t = {
                    shape: e.sh,
                    data: e,
                    localShapeCollection: shapeCollectionPool.newShapeCollection()
                };
                this.shapes.push(t),
                this.addShapeToModifier(t),
                this._isAnimated && e.setAsAnimated()
            }
        }
        ,
        ShapeModifier.prototype.init = function(e, t) {
            this.shapes = [],
            this.elem = e,
            this.initDynamicPropertyContainer(e),
            this.initModifierProperties(e, t),
            this.frameId = initialDefaultFrame,
            this.closed = !1,
            this.k = !1,
            this.dynamicProperties.length ? this.k = !0 : this.getValue(!0)
        }
        ,
        ShapeModifier.prototype.processKeys = function() {
            this.elem.globalData.frameId !== this.frameId && (this.frameId = this.elem.globalData.frameId,
            this.iterateDynamicProperties())
        }
        ,
        extendPrototype([DynamicPropertyContainer], ShapeModifier),
        extendPrototype([ShapeModifier], TrimModifier),
        TrimModifier.prototype.initModifierProperties = function(e, t) {
            this.s = PropertyFactory.getProp(e, t.s, 0, .01, this),
            this.e = PropertyFactory.getProp(e, t.e, 0, .01, this),
            this.o = PropertyFactory.getProp(e, t.o, 0, 0, this),
            this.sValue = 0,
            this.eValue = 0,
            this.getValue = this.processKeys,
            this.m = t.m,
            this._isAnimated = !!this.s.effectsSequence.length || !!this.e.effectsSequence.length || !!this.o.effectsSequence.length
        }
        ,
        TrimModifier.prototype.addShapeToModifier = function(e) {
            e.pathsData = []
        }
        ,
        TrimModifier.prototype.calculateShapeEdges = function(e, t, i, r, n) {
            var a = [];
            t <= 1 ? a.push({
                s: e,
                e: t
            }) : e >= 1 ? a.push({
                s: e - 1,
                e: t - 1
            }) : (a.push({
                s: e,
                e: 1
            }),
            a.push({
                s: 0,
                e: t - 1
            }));
            var o, s, l = [], h = a.length;
            for (o = 0; o < h; o += 1) {
                var c, p;
                (s = a[o]).e * n < r || s.s * n > r + i || (c = s.s * n <= r ? 0 : (s.s * n - r) / i,
                p = s.e * n >= r + i ? 1 : (s.e * n - r) / i,
                l.push([c, p]))
            }
            return l.length || l.push([0, 0]),
            l
        }
        ,
        TrimModifier.prototype.releasePathsData = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                segmentsLengthPool.release(e[t]);
            return e.length = 0,
            e
        }
        ,
        TrimModifier.prototype.processShapes = function(e) {
            var t, i, r, n;
            if (this._mdf || e) {
                var a = this.o.v % 360 / 360;
                if (a < 0 && (a += 1),
                (t = this.s.v > 1 ? 1 + a : this.s.v < 0 ? 0 + a : this.s.v + a) > (i = this.e.v > 1 ? 1 + a : this.e.v < 0 ? 0 + a : this.e.v + a)) {
                    var o = t;
                    t = i,
                    i = o
                }
                t = 1e-4 * Math.round(1e4 * t),
                i = 1e-4 * Math.round(1e4 * i),
                this.sValue = t,
                this.eValue = i
            } else
                t = this.sValue,
                i = this.eValue;
            var s, l, h, c, p, u = this.shapes.length, d = 0;
            if (i === t)
                for (n = 0; n < u; n += 1)
                    this.shapes[n].localShapeCollection.releaseShapes(),
                    this.shapes[n].shape._mdf = !0,
                    this.shapes[n].shape.paths = this.shapes[n].localShapeCollection,
                    this._mdf && (this.shapes[n].pathsData.length = 0);
            else if (1 === i && 0 === t || 0 === i && 1 === t) {
                if (this._mdf)
                    for (n = 0; n < u; n += 1)
                        this.shapes[n].pathsData.length = 0,
                        this.shapes[n].shape._mdf = !0
            } else {
                var f, m, g = [];
                for (n = 0; n < u; n += 1)
                    if ((f = this.shapes[n]).shape._mdf || this._mdf || e || 2 === this.m) {
                        if (l = (r = f.shape.paths)._length,
                        p = 0,
                        !f.shape._mdf && f.pathsData.length)
                            p = f.totalShapeLength;
                        else {
                            for (h = this.releasePathsData(f.pathsData),
                            s = 0; s < l; s += 1)
                                c = bez.getSegmentsLength(r.shapes[s]),
                                h.push(c),
                                p += c.totalLength;
                            f.totalShapeLength = p,
                            f.pathsData = h
                        }
                        d += p,
                        f.shape._mdf = !0
                    } else
                        f.shape.paths = f.localShapeCollection;
                var v, y = t, _ = i, b = 0;
                for (n = u - 1; n >= 0; n -= 1)
                    if ((f = this.shapes[n]).shape._mdf) {
                        for ((m = f.localShapeCollection).releaseShapes(),
                        2 === this.m && u > 1 ? (v = this.calculateShapeEdges(t, i, f.totalShapeLength, b, d),
                        b += f.totalShapeLength) : v = [[y, _]],
                        l = v.length,
                        s = 0; s < l; s += 1) {
                            y = v[s][0],
                            _ = v[s][1],
                            g.length = 0,
                            _ <= 1 ? g.push({
                                s: f.totalShapeLength * y,
                                e: f.totalShapeLength * _
                            }) : y >= 1 ? g.push({
                                s: f.totalShapeLength * (y - 1),
                                e: f.totalShapeLength * (_ - 1)
                            }) : (g.push({
                                s: f.totalShapeLength * y,
                                e: f.totalShapeLength
                            }),
                            g.push({
                                s: 0,
                                e: f.totalShapeLength * (_ - 1)
                            }));
                            var x = this.addShapes(f, g[0]);
                            if (g[0].s !== g[0].e) {
                                if (g.length > 1)
                                    if (f.shape.paths.shapes[f.shape.paths._length - 1].c) {
                                        var w = x.pop();
                                        this.addPaths(x, m),
                                        x = this.addShapes(f, g[1], w)
                                    } else
                                        this.addPaths(x, m),
                                        x = this.addShapes(f, g[1]);
                                this.addPaths(x, m)
                            }
                        }
                        f.shape.paths = m
                    }
            }
        }
        ,
        TrimModifier.prototype.addPaths = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                t.addShape(e[i])
        }
        ,
        TrimModifier.prototype.addSegment = function(e, t, i, r, n, a, o) {
            n.setXYAt(t[0], t[1], "o", a),
            n.setXYAt(i[0], i[1], "i", a + 1),
            o && n.setXYAt(e[0], e[1], "v", a),
            n.setXYAt(r[0], r[1], "v", a + 1)
        }
        ,
        TrimModifier.prototype.addSegmentFromArray = function(e, t, i, r) {
            t.setXYAt(e[1], e[5], "o", i),
            t.setXYAt(e[2], e[6], "i", i + 1),
            r && t.setXYAt(e[0], e[4], "v", i),
            t.setXYAt(e[3], e[7], "v", i + 1)
        }
        ,
        TrimModifier.prototype.addShapes = function(e, t, i) {
            var r, n, a, o, s, l, h, c, p = e.pathsData, u = e.shape.paths.shapes, d = e.shape.paths._length, f = 0, m = [], g = !0;
            for (i ? (s = i._length,
            c = i._length) : (i = shapePool.newElement(),
            s = 0,
            c = 0),
            m.push(i),
            r = 0; r < d; r += 1) {
                for (l = p[r].lengths,
                i.c = u[r].c,
                a = u[r].c ? l.length : l.length + 1,
                n = 1; n < a; n += 1)
                    if (f + (o = l[n - 1]).addedLength < t.s)
                        f += o.addedLength,
                        i.c = !1;
                    else {
                        if (f > t.e) {
                            i.c = !1;
                            break
                        }
                        t.s <= f && t.e >= f + o.addedLength ? (this.addSegment(u[r].v[n - 1], u[r].o[n - 1], u[r].i[n], u[r].v[n], i, s, g),
                        g = !1) : (h = bez.getNewSegment(u[r].v[n - 1], u[r].v[n], u[r].o[n - 1], u[r].i[n], (t.s - f) / o.addedLength, (t.e - f) / o.addedLength, l[n - 1]),
                        this.addSegmentFromArray(h, i, s, g),
                        g = !1,
                        i.c = !1),
                        f += o.addedLength,
                        s += 1
                    }
                if (u[r].c && l.length) {
                    if (o = l[n - 1],
                    f <= t.e) {
                        var v = l[n - 1].addedLength;
                        t.s <= f && t.e >= f + v ? (this.addSegment(u[r].v[n - 1], u[r].o[n - 1], u[r].i[0], u[r].v[0], i, s, g),
                        g = !1) : (h = bez.getNewSegment(u[r].v[n - 1], u[r].v[0], u[r].o[n - 1], u[r].i[0], (t.s - f) / v, (t.e - f) / v, l[n - 1]),
                        this.addSegmentFromArray(h, i, s, g),
                        g = !1,
                        i.c = !1)
                    } else
                        i.c = !1;
                    f += o.addedLength,
                    s += 1
                }
                if (i._length && (i.setXYAt(i.v[c][0], i.v[c][1], "i", c),
                i.setXYAt(i.v[i._length - 1][0], i.v[i._length - 1][1], "o", i._length - 1)),
                f > t.e)
                    break;
                r < d - 1 && (i = shapePool.newElement(),
                g = !0,
                m.push(i),
                s = 0)
            }
            return m
        }
        ,
        extendPrototype([ShapeModifier], PuckerAndBloatModifier),
        PuckerAndBloatModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.amount = PropertyFactory.getProp(e, t.a, 0, null, this),
            this._isAnimated = !!this.amount.effectsSequence.length
        }
        ,
        PuckerAndBloatModifier.prototype.processPath = function(e, t) {
            var i = t / 100
              , r = [0, 0]
              , n = e._length
              , a = 0;
            for (a = 0; a < n; a += 1)
                r[0] += e.v[a][0],
                r[1] += e.v[a][1];
            r[0] /= n,
            r[1] /= n;
            var o, s, l, h, c, p, u = shapePool.newElement();
            for (u.c = e.c,
            a = 0; a < n; a += 1)
                o = e.v[a][0] + (r[0] - e.v[a][0]) * i,
                s = e.v[a][1] + (r[1] - e.v[a][1]) * i,
                l = e.o[a][0] + (r[0] - e.o[a][0]) * -i,
                h = e.o[a][1] + (r[1] - e.o[a][1]) * -i,
                c = e.i[a][0] + (r[0] - e.i[a][0]) * -i,
                p = e.i[a][1] + (r[1] - e.i[a][1]) * -i,
                u.setTripleAt(o, s, l, h, c, p, a);
            return u
        }
        ,
        PuckerAndBloatModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o, s = this.shapes.length, l = this.amount.v;
            if (0 !== l)
                for (i = 0; i < s; i += 1) {
                    if (o = (a = this.shapes[i]).localShapeCollection,
                    a.shape._mdf || this._mdf || e)
                        for (o.releaseShapes(),
                        a.shape._mdf = !0,
                        t = a.shape.paths.shapes,
                        n = a.shape.paths._length,
                        r = 0; r < n; r += 1)
                            o.addShape(this.processPath(t[r], l));
                    a.shape.paths = a.localShapeCollection
                }
            this.dynamicProperties.length || (this._mdf = !1)
        }
        ;
        var TransformPropertyFactory = function() {
            var e = [0, 0];
            function t(e, t, i) {
                if (this.elem = e,
                this.frameId = -1,
                this.propType = "transform",
                this.data = t,
                this.v = new Matrix,
                this.pre = new Matrix,
                this.appliedTransformations = 0,
                this.initDynamicPropertyContainer(i || e),
                t.p && t.p.s ? (this.px = PropertyFactory.getProp(e, t.p.x, 0, 0, this),
                this.py = PropertyFactory.getProp(e, t.p.y, 0, 0, this),
                t.p.z && (this.pz = PropertyFactory.getProp(e, t.p.z, 0, 0, this))) : this.p = PropertyFactory.getProp(e, t.p || {
                    k: [0, 0, 0]
                }, 1, 0, this),
                t.rx) {
                    if (this.rx = PropertyFactory.getProp(e, t.rx, 0, degToRads, this),
                    this.ry = PropertyFactory.getProp(e, t.ry, 0, degToRads, this),
                    this.rz = PropertyFactory.getProp(e, t.rz, 0, degToRads, this),
                    t.or.k[0].ti) {
                        var r, n = t.or.k.length;
                        for (r = 0; r < n; r += 1)
                            t.or.k[r].to = null,
                            t.or.k[r].ti = null
                    }
                    this.or = PropertyFactory.getProp(e, t.or, 1, degToRads, this),
                    this.or.sh = !0
                } else
                    this.r = PropertyFactory.getProp(e, t.r || {
                        k: 0
                    }, 0, degToRads, this);
                t.sk && (this.sk = PropertyFactory.getProp(e, t.sk, 0, degToRads, this),
                this.sa = PropertyFactory.getProp(e, t.sa, 0, degToRads, this)),
                this.a = PropertyFactory.getProp(e, t.a || {
                    k: [0, 0, 0]
                }, 1, 0, this),
                this.s = PropertyFactory.getProp(e, t.s || {
                    k: [100, 100, 100]
                }, 1, .01, this),
                t.o ? this.o = PropertyFactory.getProp(e, t.o, 0, .01, e) : this.o = {
                    _mdf: !1,
                    v: 1
                },
                this._isDirty = !0,
                this.dynamicProperties.length || this.getValue(!0)
            }
            return t.prototype = {
                applyToMatrix: function(e) {
                    var t = this._mdf;
                    this.iterateDynamicProperties(),
                    this._mdf = this._mdf || t,
                    this.a && e.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                    this.s && e.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                    this.sk && e.skewFromAxis(-this.sk.v, this.sa.v),
                    this.r ? e.rotate(-this.r.v) : e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                    this.data.p.s ? this.data.p.z ? e.translate(this.px.v, this.py.v, -this.pz.v) : e.translate(this.px.v, this.py.v, 0) : e.translate(this.p.v[0], this.p.v[1], -this.p.v[2])
                },
                getValue: function(t) {
                    if (this.elem.globalData.frameId !== this.frameId) {
                        if (this._isDirty && (this.precalculateMatrix(),
                        this._isDirty = !1),
                        this.iterateDynamicProperties(),
                        this._mdf || t) {
                            var i;
                            if (this.v.cloneFromProps(this.pre.props),
                            this.appliedTransformations < 1 && this.v.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                            this.appliedTransformations < 2 && this.v.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                            this.sk && this.appliedTransformations < 3 && this.v.skewFromAxis(-this.sk.v, this.sa.v),
                            this.r && this.appliedTransformations < 4 ? this.v.rotate(-this.r.v) : !this.r && this.appliedTransformations < 4 && this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                            this.autoOriented) {
                                var r, n;
                                if (i = this.elem.globalData.frameRate,
                                this.p && this.p.keyframes && this.p.getValueAtTime)
                                    this.p._caching.lastFrame + this.p.offsetTime <= this.p.keyframes[0].t ? (r = this.p.getValueAtTime((this.p.keyframes[0].t + .01) / i, 0),
                                    n = this.p.getValueAtTime(this.p.keyframes[0].t / i, 0)) : this.p._caching.lastFrame + this.p.offsetTime >= this.p.keyframes[this.p.keyframes.length - 1].t ? (r = this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length - 1].t / i, 0),
                                    n = this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length - 1].t - .05) / i, 0)) : (r = this.p.pv,
                                    n = this.p.getValueAtTime((this.p._caching.lastFrame + this.p.offsetTime - .01) / i, this.p.offsetTime));
                                else if (this.px && this.px.keyframes && this.py.keyframes && this.px.getValueAtTime && this.py.getValueAtTime) {
                                    r = [],
                                    n = [];
                                    var a = this.px
                                      , o = this.py;
                                    a._caching.lastFrame + a.offsetTime <= a.keyframes[0].t ? (r[0] = a.getValueAtTime((a.keyframes[0].t + .01) / i, 0),
                                    r[1] = o.getValueAtTime((o.keyframes[0].t + .01) / i, 0),
                                    n[0] = a.getValueAtTime(a.keyframes[0].t / i, 0),
                                    n[1] = o.getValueAtTime(o.keyframes[0].t / i, 0)) : a._caching.lastFrame + a.offsetTime >= a.keyframes[a.keyframes.length - 1].t ? (r[0] = a.getValueAtTime(a.keyframes[a.keyframes.length - 1].t / i, 0),
                                    r[1] = o.getValueAtTime(o.keyframes[o.keyframes.length - 1].t / i, 0),
                                    n[0] = a.getValueAtTime((a.keyframes[a.keyframes.length - 1].t - .01) / i, 0),
                                    n[1] = o.getValueAtTime((o.keyframes[o.keyframes.length - 1].t - .01) / i, 0)) : (r = [a.pv, o.pv],
                                    n[0] = a.getValueAtTime((a._caching.lastFrame + a.offsetTime - .01) / i, a.offsetTime),
                                    n[1] = o.getValueAtTime((o._caching.lastFrame + o.offsetTime - .01) / i, o.offsetTime))
                                } else
                                    r = n = e;
                                this.v.rotate(-Math.atan2(r[1] - n[1], r[0] - n[0]))
                            }
                            this.data.p && this.data.p.s ? this.data.p.z ? this.v.translate(this.px.v, this.py.v, -this.pz.v) : this.v.translate(this.px.v, this.py.v, 0) : this.v.translate(this.p.v[0], this.p.v[1], -this.p.v[2])
                        }
                        this.frameId = this.elem.globalData.frameId
                    }
                },
                precalculateMatrix: function() {
                    if (!this.a.k && (this.pre.translate(-this.a.v[0], -this.a.v[1], this.a.v[2]),
                    this.appliedTransformations = 1,
                    !this.s.effectsSequence.length)) {
                        if (this.pre.scale(this.s.v[0], this.s.v[1], this.s.v[2]),
                        this.appliedTransformations = 2,
                        this.sk) {
                            if (this.sk.effectsSequence.length || this.sa.effectsSequence.length)
                                return;
                            this.pre.skewFromAxis(-this.sk.v, this.sa.v),
                            this.appliedTransformations = 3
                        }
                        this.r ? this.r.effectsSequence.length || (this.pre.rotate(-this.r.v),
                        this.appliedTransformations = 4) : this.rz.effectsSequence.length || this.ry.effectsSequence.length || this.rx.effectsSequence.length || this.or.effectsSequence.length || (this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),
                        this.appliedTransformations = 4)
                    }
                },
                autoOrient: function() {}
            },
            extendPrototype([DynamicPropertyContainer], t),
            t.prototype.addDynamicProperty = function(e) {
                this._addDynamicProperty(e),
                this.elem.addDynamicProperty(e),
                this._isDirty = !0
            }
            ,
            t.prototype._addDynamicProperty = DynamicPropertyContainer.prototype.addDynamicProperty,
            {
                getTransformProperty: function(e, i, r) {
                    return new t(e,i,r)
                }
            }
        }();
        function RepeaterModifier() {}
        function RoundCornersModifier() {}
        function getFontProperties(e) {
            for (var t = e.fStyle ? e.fStyle.split(" ") : [], i = "normal", r = "normal", n = t.length, a = 0; a < n; a += 1)
                switch (t[a].toLowerCase()) {
                case "italic":
                    r = "italic";
                    break;
                case "bold":
                    i = "700";
                    break;
                case "black":
                    i = "900";
                    break;
                case "medium":
                    i = "500";
                    break;
                case "regular":
                case "normal":
                    i = "400";
                    break;
                case "light":
                case "thin":
                    i = "200"
                }
            return {
                style: r,
                weight: e.fWeight || i
            }
        }
        extendPrototype([ShapeModifier], RepeaterModifier),
        RepeaterModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.c = PropertyFactory.getProp(e, t.c, 0, null, this),
            this.o = PropertyFactory.getProp(e, t.o, 0, null, this),
            this.tr = TransformPropertyFactory.getTransformProperty(e, t.tr, this),
            this.so = PropertyFactory.getProp(e, t.tr.so, 0, .01, this),
            this.eo = PropertyFactory.getProp(e, t.tr.eo, 0, .01, this),
            this.data = t,
            this.dynamicProperties.length || this.getValue(!0),
            this._isAnimated = !!this.dynamicProperties.length,
            this.pMatrix = new Matrix,
            this.rMatrix = new Matrix,
            this.sMatrix = new Matrix,
            this.tMatrix = new Matrix,
            this.matrix = new Matrix
        }
        ,
        RepeaterModifier.prototype.applyTransforms = function(e, t, i, r, n, a) {
            var o = a ? -1 : 1
              , s = r.s.v[0] + (1 - r.s.v[0]) * (1 - n)
              , l = r.s.v[1] + (1 - r.s.v[1]) * (1 - n);
            e.translate(r.p.v[0] * o * n, r.p.v[1] * o * n, r.p.v[2]),
            t.translate(-r.a.v[0], -r.a.v[1], r.a.v[2]),
            t.rotate(-r.r.v * o * n),
            t.translate(r.a.v[0], r.a.v[1], r.a.v[2]),
            i.translate(-r.a.v[0], -r.a.v[1], r.a.v[2]),
            i.scale(a ? 1 / s : s, a ? 1 / l : l),
            i.translate(r.a.v[0], r.a.v[1], r.a.v[2])
        }
        ,
        RepeaterModifier.prototype.init = function(e, t, i, r) {
            for (this.elem = e,
            this.arr = t,
            this.pos = i,
            this.elemsData = r,
            this._currentCopies = 0,
            this._elements = [],
            this._groups = [],
            this.frameId = -1,
            this.initDynamicPropertyContainer(e),
            this.initModifierProperties(e, t[i]); i > 0; )
                i -= 1,
                this._elements.unshift(t[i]);
            this.dynamicProperties.length ? this.k = !0 : this.getValue(!0)
        }
        ,
        RepeaterModifier.prototype.resetElements = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t]._processed = !1,
                "gr" === e[t].ty && this.resetElements(e[t].it)
        }
        ,
        RepeaterModifier.prototype.cloneElements = function(e) {
            var t = JSON.parse(JSON.stringify(e));
            return this.resetElements(t),
            t
        }
        ,
        RepeaterModifier.prototype.changeGroupRender = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                e[i]._render = t,
                "gr" === e[i].ty && this.changeGroupRender(e[i].it, t)
        }
        ,
        RepeaterModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o = !1;
            if (this._mdf || e) {
                var s, l = Math.ceil(this.c.v);
                if (this._groups.length < l) {
                    for (; this._groups.length < l; ) {
                        var h = {
                            it: this.cloneElements(this._elements),
                            ty: "gr"
                        };
                        h.it.push({
                            a: {
                                a: 0,
                                ix: 1,
                                k: [0, 0]
                            },
                            nm: "Transform",
                            o: {
                                a: 0,
                                ix: 7,
                                k: 100
                            },
                            p: {
                                a: 0,
                                ix: 2,
                                k: [0, 0]
                            },
                            r: {
                                a: 1,
                                ix: 6,
                                k: [{
                                    s: 0,
                                    e: 0,
                                    t: 0
                                }, {
                                    s: 0,
                                    e: 0,
                                    t: 1
                                }]
                            },
                            s: {
                                a: 0,
                                ix: 3,
                                k: [100, 100]
                            },
                            sa: {
                                a: 0,
                                ix: 5,
                                k: 0
                            },
                            sk: {
                                a: 0,
                                ix: 4,
                                k: 0
                            },
                            ty: "tr"
                        }),
                        this.arr.splice(0, 0, h),
                        this._groups.splice(0, 0, h),
                        this._currentCopies += 1
                    }
                    this.elem.reloadShapes(),
                    o = !0
                }
                for (a = 0,
                r = 0; r <= this._groups.length - 1; r += 1) {
                    if (s = a < l,
                    this._groups[r]._render = s,
                    this.changeGroupRender(this._groups[r].it, s),
                    !s) {
                        var c = this.elemsData[r].it
                          , p = c[c.length - 1];
                        0 !== p.transform.op.v ? (p.transform.op._mdf = !0,
                        p.transform.op.v = 0) : p.transform.op._mdf = !1
                    }
                    a += 1
                }
                this._currentCopies = l;
                var u = this.o.v
                  , d = u % 1
                  , f = u > 0 ? Math.floor(u) : Math.ceil(u)
                  , m = this.pMatrix.props
                  , g = this.rMatrix.props
                  , v = this.sMatrix.props;
                this.pMatrix.reset(),
                this.rMatrix.reset(),
                this.sMatrix.reset(),
                this.tMatrix.reset(),
                this.matrix.reset();
                var y, _, b = 0;
                if (u > 0) {
                    for (; b < f; )
                        this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !1),
                        b += 1;
                    d && (this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, d, !1),
                    b += d)
                } else if (u < 0) {
                    for (; b > f; )
                        this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !0),
                        b -= 1;
                    d && (this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, -d, !0),
                    b -= d)
                }
                for (r = 1 === this.data.m ? 0 : this._currentCopies - 1,
                n = 1 === this.data.m ? 1 : -1,
                a = this._currentCopies; a; ) {
                    if (_ = (i = (t = this.elemsData[r].it)[t.length - 1].transform.mProps.v.props).length,
                    t[t.length - 1].transform.mProps._mdf = !0,
                    t[t.length - 1].transform.op._mdf = !0,
                    t[t.length - 1].transform.op.v = 1 === this._currentCopies ? this.so.v : this.so.v + (this.eo.v - this.so.v) * (r / (this._currentCopies - 1)),
                    0 !== b) {
                        for ((0 !== r && 1 === n || r !== this._currentCopies - 1 && -1 === n) && this.applyTransforms(this.pMatrix, this.rMatrix, this.sMatrix, this.tr, 1, !1),
                        this.matrix.transform(g[0], g[1], g[2], g[3], g[4], g[5], g[6], g[7], g[8], g[9], g[10], g[11], g[12], g[13], g[14], g[15]),
                        this.matrix.transform(v[0], v[1], v[2], v[3], v[4], v[5], v[6], v[7], v[8], v[9], v[10], v[11], v[12], v[13], v[14], v[15]),
                        this.matrix.transform(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]),
                        y = 0; y < _; y += 1)
                            i[y] = this.matrix.props[y];
                        this.matrix.reset()
                    } else
                        for (this.matrix.reset(),
                        y = 0; y < _; y += 1)
                            i[y] = this.matrix.props[y];
                    b += 1,
                    a -= 1,
                    r += n
                }
            } else
                for (a = this._currentCopies,
                r = 0,
                n = 1; a; )
                    i = (t = this.elemsData[r].it)[t.length - 1].transform.mProps.v.props,
                    t[t.length - 1].transform.mProps._mdf = !1,
                    t[t.length - 1].transform.op._mdf = !1,
                    a -= 1,
                    r += n;
            return o
        }
        ,
        RepeaterModifier.prototype.addShape = function() {}
        ,
        extendPrototype([ShapeModifier], RoundCornersModifier),
        RoundCornersModifier.prototype.initModifierProperties = function(e, t) {
            this.getValue = this.processKeys,
            this.rd = PropertyFactory.getProp(e, t.r, 0, null, this),
            this._isAnimated = !!this.rd.effectsSequence.length
        }
        ,
        RoundCornersModifier.prototype.processPath = function(e, t) {
            var i, r = shapePool.newElement();
            r.c = e.c;
            var n, a, o, s, l, h, c, p, u, d, f, m, g = e._length, v = 0;
            for (i = 0; i < g; i += 1)
                n = e.v[i],
                o = e.o[i],
                a = e.i[i],
                n[0] === o[0] && n[1] === o[1] && n[0] === a[0] && n[1] === a[1] ? 0 !== i && i !== g - 1 || e.c ? (s = 0 === i ? e.v[g - 1] : e.v[i - 1],
                h = (l = Math.sqrt(Math.pow(n[0] - s[0], 2) + Math.pow(n[1] - s[1], 2))) ? Math.min(l / 2, t) / l : 0,
                c = f = n[0] + (s[0] - n[0]) * h,
                p = m = n[1] - (n[1] - s[1]) * h,
                u = c - (c - n[0]) * roundCorner,
                d = p - (p - n[1]) * roundCorner,
                r.setTripleAt(c, p, u, d, f, m, v),
                v += 1,
                s = i === g - 1 ? e.v[0] : e.v[i + 1],
                h = (l = Math.sqrt(Math.pow(n[0] - s[0], 2) + Math.pow(n[1] - s[1], 2))) ? Math.min(l / 2, t) / l : 0,
                c = u = n[0] + (s[0] - n[0]) * h,
                p = d = n[1] + (s[1] - n[1]) * h,
                f = c - (c - n[0]) * roundCorner,
                m = p - (p - n[1]) * roundCorner,
                r.setTripleAt(c, p, u, d, f, m, v),
                v += 1) : (r.setTripleAt(n[0], n[1], o[0], o[1], a[0], a[1], v),
                v += 1) : (r.setTripleAt(e.v[i][0], e.v[i][1], e.o[i][0], e.o[i][1], e.i[i][0], e.i[i][1], v),
                v += 1);
            return r
        }
        ,
        RoundCornersModifier.prototype.processShapes = function(e) {
            var t, i, r, n, a, o, s = this.shapes.length, l = this.rd.v;
            if (0 !== l)
                for (i = 0; i < s; i += 1) {
                    if (o = (a = this.shapes[i]).localShapeCollection,
                    a.shape._mdf || this._mdf || e)
                        for (o.releaseShapes(),
                        a.shape._mdf = !0,
                        t = a.shape.paths.shapes,
                        n = a.shape.paths._length,
                        r = 0; r < n; r += 1)
                            o.addShape(this.processPath(t[r], l));
                    a.shape.paths = a.localShapeCollection
                }
            this.dynamicProperties.length || (this._mdf = !1)
        }
        ;
        var FontManager = function() {
            var e = {
                w: 0,
                size: 0,
                shapes: [],
                data: {
                    shapes: []
                }
            }
              , t = [];
            t = t.concat([2304, 2305, 2306, 2307, 2362, 2363, 2364, 2364, 2366, 2367, 2368, 2369, 2370, 2371, 2372, 2373, 2374, 2375, 2376, 2377, 2378, 2379, 2380, 2381, 2382, 2383, 2387, 2388, 2389, 2390, 2391, 2402, 2403]);
            var i = ["d83cdffb", "d83cdffc", "d83cdffd", "d83cdffe", "d83cdfff"]
              , r = [65039, 8205];
            function n(e, t) {
                var i = createTag("span");
                i.setAttribute("aria-hidden", !0),
                i.style.fontFamily = t;
                var r = createTag("span");
                r.innerText = "giItT1WQy@!-/#",
                i.style.position = "absolute",
                i.style.left = "-10000px",
                i.style.top = "-10000px",
                i.style.fontSize = "300px",
                i.style.fontVariant = "normal",
                i.style.fontStyle = "normal",
                i.style.fontWeight = "normal",
                i.style.letterSpacing = "0",
                i.appendChild(r),
                document.body.appendChild(i);
                var n = r.offsetWidth;
                return r.style.fontFamily = function(e) {
                    var t, i = e.split(","), r = i.length, n = [];
                    for (t = 0; t < r; t += 1)
                        "sans-serif" !== i[t] && "monospace" !== i[t] && n.push(i[t]);
                    return n.join(",")
                }(e) + ", " + t,
                {
                    node: r,
                    w: n,
                    parent: i
                }
            }
            function a(e, t) {
                var i, r = document.body && t ? "svg" : "canvas", n = getFontProperties(e);
                if ("svg" === r) {
                    var a = createNS("text");
                    a.style.fontSize = "100px",
                    a.setAttribute("font-family", e.fFamily),
                    a.setAttribute("font-style", n.style),
                    a.setAttribute("font-weight", n.weight),
                    a.textContent = "1",
                    e.fClass ? (a.style.fontFamily = "inherit",
                    a.setAttribute("class", e.fClass)) : a.style.fontFamily = e.fFamily,
                    t.appendChild(a),
                    i = a
                } else {
                    var o = new OffscreenCanvas(500,500).getContext("2d");
                    o.font = n.style + " " + n.weight + " 100px " + e.fFamily,
                    i = o
                }
                return {
                    measureText: function(e) {
                        return "svg" === r ? (i.textContent = e,
                        i.getComputedTextLength()) : i.measureText(e).width
                    }
                }
            }
            var o = function() {
                this.fonts = [],
                this.chars = null,
                this.typekitLoaded = 0,
                this.isLoaded = !1,
                this._warned = !1,
                this.initTime = Date.now(),
                this.setIsLoadedBinded = this.setIsLoaded.bind(this),
                this.checkLoadedFontsBinded = this.checkLoadedFonts.bind(this)
            };
            return o.isModifier = function(e, t) {
                var r = e.toString(16) + t.toString(16);
                return -1 !== i.indexOf(r)
            }
            ,
            o.isZeroWidthJoiner = function(e, t) {
                return t ? e === r[0] && t === r[1] : e === r[1]
            }
            ,
            o.isCombinedCharacter = function(e) {
                return -1 !== t.indexOf(e)
            }
            ,
            o.prototype = {
                addChars: function(e) {
                    if (e) {
                        var t;
                        this.chars || (this.chars = []);
                        var i, r, n = e.length, a = this.chars.length;
                        for (t = 0; t < n; t += 1) {
                            for (i = 0,
                            r = !1; i < a; )
                                this.chars[i].style === e[t].style && this.chars[i].fFamily === e[t].fFamily && this.chars[i].ch === e[t].ch && (r = !0),
                                i += 1;
                            r || (this.chars.push(e[t]),
                            a += 1)
                        }
                    }
                },
                addFonts: function(e, t) {
                    if (e) {
                        if (this.chars)
                            return this.isLoaded = !0,
                            void (this.fonts = e.list);
                        if (!document.body)
                            return this.isLoaded = !0,
                            e.list.forEach((function(e) {
                                e.helper = a(e),
                                e.cache = {}
                            }
                            )),
                            void (this.fonts = e.list);
                        var i, r = e.list, o = r.length, s = o;
                        for (i = 0; i < o; i += 1) {
                            var l, h, c = !0;
                            if (r[i].loaded = !1,
                            r[i].monoCase = n(r[i].fFamily, "monospace"),
                            r[i].sansCase = n(r[i].fFamily, "sans-serif"),
                            r[i].fPath) {
                                if ("p" === r[i].fOrigin || 3 === r[i].origin) {
                                    if ((l = document.querySelectorAll('style[f-forigin="p"][f-family="' + r[i].fFamily + '"], style[f-origin="3"][f-family="' + r[i].fFamily + '"]')).length > 0 && (c = !1),
                                    c) {
                                        var p = createTag("style");
                                        p.setAttribute("f-forigin", r[i].fOrigin),
                                        p.setAttribute("f-origin", r[i].origin),
                                        p.setAttribute("f-family", r[i].fFamily),
                                        p.type = "text/css",
                                        p.innerText = "@font-face {font-family: " + r[i].fFamily + "; font-style: normal; src: url('" + r[i].fPath + "');}",
                                        t.appendChild(p)
                                    }
                                } else if ("g" === r[i].fOrigin || 1 === r[i].origin) {
                                    for (l = document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),
                                    h = 0; h < l.length; h += 1)
                                        -1 !== l[h].href.indexOf(r[i].fPath) && (c = !1);
                                    if (c) {
                                        var u = createTag("link");
                                        u.setAttribute("f-forigin", r[i].fOrigin),
                                        u.setAttribute("f-origin", r[i].origin),
                                        u.type = "text/css",
                                        u.rel = "stylesheet",
                                        u.href = r[i].fPath,
                                        document.body.appendChild(u)
                                    }
                                } else if ("t" === r[i].fOrigin || 2 === r[i].origin) {
                                    for (l = document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),
                                    h = 0; h < l.length; h += 1)
                                        r[i].fPath === l[h].src && (c = !1);
                                    if (c) {
                                        var d = createTag("link");
                                        d.setAttribute("f-forigin", r[i].fOrigin),
                                        d.setAttribute("f-origin", r[i].origin),
                                        d.setAttribute("rel", "stylesheet"),
                                        d.setAttribute("href", r[i].fPath),
                                        t.appendChild(d)
                                    }
                                }
                            } else
                                r[i].loaded = !0,
                                s -= 1;
                            r[i].helper = a(r[i], t),
                            r[i].cache = {},
                            this.fonts.push(r[i])
                        }
                        0 === s ? this.isLoaded = !0 : setTimeout(this.checkLoadedFonts.bind(this), 100)
                    } else
                        this.isLoaded = !0
                },
                getCharData: function(t, i, r) {
                    for (var n = 0, a = this.chars.length; n < a; ) {
                        if (this.chars[n].ch === t && this.chars[n].style === i && this.chars[n].fFamily === r)
                            return this.chars[n];
                        n += 1
                    }
                    return ("string" == typeof t && 13 !== t.charCodeAt(0) || !t) && console && console.warn && !this._warned && (this._warned = !0,
                    console.warn("Missing character from exported characters list: ", t, i, r)),
                    e
                },
                getFontByName: function(e) {
                    for (var t = 0, i = this.fonts.length; t < i; ) {
                        if (this.fonts[t].fName === e)
                            return this.fonts[t];
                        t += 1
                    }
                    return this.fonts[0]
                },
                measureText: function(e, t, i) {
                    var r = this.getFontByName(t)
                      , n = e.charCodeAt(0);
                    if (!r.cache[n + 1]) {
                        var a = r.helper;
                        if (" " === e) {
                            var o = a.measureText("|" + e + "|")
                              , s = a.measureText("||");
                            r.cache[n + 1] = (o - s) / 100
                        } else
                            r.cache[n + 1] = a.measureText(e) / 100
                    }
                    return r.cache[n + 1] * i
                },
                checkLoadedFonts: function() {
                    var e, t, i, r = this.fonts.length, n = r;
                    for (e = 0; e < r; e += 1)
                        this.fonts[e].loaded ? n -= 1 : "n" === this.fonts[e].fOrigin || 0 === this.fonts[e].origin ? this.fonts[e].loaded = !0 : (t = this.fonts[e].monoCase.node,
                        i = this.fonts[e].monoCase.w,
                        t.offsetWidth !== i ? (n -= 1,
                        this.fonts[e].loaded = !0) : (t = this.fonts[e].sansCase.node,
                        i = this.fonts[e].sansCase.w,
                        t.offsetWidth !== i && (n -= 1,
                        this.fonts[e].loaded = !0)),
                        this.fonts[e].loaded && (this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),
                        this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));
                    0 !== n && Date.now() - this.initTime < 5e3 ? setTimeout(this.checkLoadedFontsBinded, 20) : setTimeout(this.setIsLoadedBinded, 10)
                },
                setIsLoaded: function() {
                    this.isLoaded = !0
                }
            },
            o
        }();
        function RenderableElement() {}
        RenderableElement.prototype = {
            initRenderable: function() {
                this.isInRange = !1,
                this.hidden = !1,
                this.isTransparent = !1,
                this.renderableComponents = []
            },
            addRenderableComponent: function(e) {
                -1 === this.renderableComponents.indexOf(e) && this.renderableComponents.push(e)
            },
            removeRenderableComponent: function(e) {
                -1 !== this.renderableComponents.indexOf(e) && this.renderableComponents.splice(this.renderableComponents.indexOf(e), 1)
            },
            prepareRenderableFrame: function(e) {
                this.checkLayerLimits(e)
            },
            checkTransparency: function() {
                this.finalTransform.mProp.o.v <= 0 ? !this.isTransparent && this.globalData.renderConfig.hideOnTransparent && (this.isTransparent = !0,
                this.hide()) : this.isTransparent && (this.isTransparent = !1,
                this.show())
            },
            checkLayerLimits: function(e) {
                this.data.ip - this.data.st <= e && this.data.op - this.data.st > e ? !0 !== this.isInRange && (this.globalData._mdf = !0,
                this._mdf = !0,
                this.isInRange = !0,
                this.show()) : !1 !== this.isInRange && (this.globalData._mdf = !0,
                this.isInRange = !1,
                this.hide())
            },
            renderRenderable: function() {
                var e, t = this.renderableComponents.length;
                for (e = 0; e < t; e += 1)
                    this.renderableComponents[e].renderFrame(this._isFirstFrame)
            },
            sourceRectAtTime: function() {
                return {
                    top: 0,
                    left: 0,
                    width: 100,
                    height: 100
                }
            },
            getLayerSize: function() {
                return 5 === this.data.ty ? {
                    w: this.data.textData.width,
                    h: this.data.textData.height
                } : {
                    w: this.data.width,
                    h: this.data.height
                }
            }
        };
        var MaskManagerInterface = function() {
            function e(e, t) {
                this._mask = e,
                this._data = t
            }
            return Object.defineProperty(e.prototype, "maskPath", {
                get: function() {
                    return this._mask.prop.k && this._mask.prop.getValue(),
                    this._mask.prop
                }
            }),
            Object.defineProperty(e.prototype, "maskOpacity", {
                get: function() {
                    return this._mask.op.k && this._mask.op.getValue(),
                    100 * this._mask.op.v
                }
            }),
            function(t) {
                var i, r = createSizedArray(t.viewData.length), n = t.viewData.length;
                for (i = 0; i < n; i += 1)
                    r[i] = new e(t.viewData[i],t.masksProperties[i]);
                return function(e) {
                    for (i = 0; i < n; ) {
                        if (t.masksProperties[i].nm === e)
                            return r[i];
                        i += 1
                    }
                    return null
                }
            }
        }(), ExpressionPropertyInterface = function() {
            var e = {
                pv: 0,
                v: 0,
                mult: 1
            }
              , t = {
                pv: [0, 0, 0],
                v: [0, 0, 0],
                mult: 1
            };
            function i(e, t, i) {
                Object.defineProperty(e, "velocity", {
                    get: function() {
                        return t.getVelocityAtTime(t.comp.currentFrame)
                    }
                }),
                e.numKeys = t.keyframes ? t.keyframes.length : 0,
                e.key = function(r) {
                    if (!e.numKeys)
                        return 0;
                    var n;
                    n = "s"in t.keyframes[r - 1] ? t.keyframes[r - 1].s : "e"in t.keyframes[r - 2] ? t.keyframes[r - 2].e : t.keyframes[r - 2].s;
                    var a = "unidimensional" === i ? new Number(n) : Object.assign({}, n);
                    return a.time = t.keyframes[r - 1].t / t.elem.comp.globalData.frameRate,
                    a.value = "unidimensional" === i ? n[0] : n,
                    a
                }
                ,
                e.valueAtTime = t.getValueAtTime,
                e.speedAtTime = t.getSpeedAtTime,
                e.velocityAtTime = t.getVelocityAtTime,
                e.propertyGroup = t.propertyGroup
            }
            function r() {
                return e
            }
            return function(n) {
                return n ? "unidimensional" === n.propType ? function(t) {
                    t && "pv"in t || (t = e);
                    var r = 1 / t.mult
                      , n = t.pv * r
                      , a = new Number(n);
                    return a.value = n,
                    i(a, t, "unidimensional"),
                    function() {
                        return t.k && t.getValue(),
                        n = t.v * r,
                        a.value !== n && ((a = new Number(n)).value = n,
                        i(a, t, "unidimensional")),
                        a
                    }
                }(n) : function(e) {
                    e && "pv"in e || (e = t);
                    var r = 1 / e.mult
                      , n = e.data && e.data.l || e.pv.length
                      , a = createTypedArray("float32", n)
                      , o = createTypedArray("float32", n);
                    return a.value = o,
                    i(a, e, "multidimensional"),
                    function() {
                        e.k && e.getValue();
                        for (var t = 0; t < n; t += 1)
                            o[t] = e.v[t] * r,
                            a[t] = o[t];
                        return a
                    }
                }(n) : r
            }
        }(), TransformExpressionInterface = function(e) {
            function t(e) {
                switch (e) {
                case "scale":
                case "Scale":
                case "ADBE Scale":
                case 6:
                    return t.scale;
                case "rotation":
                case "Rotation":
                case "ADBE Rotation":
                case "ADBE Rotate Z":
                case 10:
                    return t.rotation;
                case "ADBE Rotate X":
                    return t.xRotation;
                case "ADBE Rotate Y":
                    return t.yRotation;
                case "position":
                case "Position":
                case "ADBE Position":
                case 2:
                    return t.position;
                case "ADBE Position_0":
                    return t.xPosition;
                case "ADBE Position_1":
                    return t.yPosition;
                case "ADBE Position_2":
                    return t.zPosition;
                case "anchorPoint":
                case "AnchorPoint":
                case "Anchor Point":
                case "ADBE AnchorPoint":
                case 1:
                    return t.anchorPoint;
                case "opacity":
                case "Opacity":
                case 11:
                    return t.opacity;
                default:
                    return null
                }
            }
            var i, r, n, a;
            return Object.defineProperty(t, "rotation", {
                get: ExpressionPropertyInterface(e.r || e.rz)
            }),
            Object.defineProperty(t, "zRotation", {
                get: ExpressionPropertyInterface(e.rz || e.r)
            }),
            Object.defineProperty(t, "xRotation", {
                get: ExpressionPropertyInterface(e.rx)
            }),
            Object.defineProperty(t, "yRotation", {
                get: ExpressionPropertyInterface(e.ry)
            }),
            Object.defineProperty(t, "scale", {
                get: ExpressionPropertyInterface(e.s)
            }),
            e.p ? a = ExpressionPropertyInterface(e.p) : (i = ExpressionPropertyInterface(e.px),
            r = ExpressionPropertyInterface(e.py),
            e.pz && (n = ExpressionPropertyInterface(e.pz))),
            Object.defineProperty(t, "position", {
                get: function() {
                    return e.p ? a() : [i(), r(), n ? n() : 0]
                }
            }),
            Object.defineProperty(t, "xPosition", {
                get: ExpressionPropertyInterface(e.px)
            }),
            Object.defineProperty(t, "yPosition", {
                get: ExpressionPropertyInterface(e.py)
            }),
            Object.defineProperty(t, "zPosition", {
                get: ExpressionPropertyInterface(e.pz)
            }),
            Object.defineProperty(t, "anchorPoint", {
                get: ExpressionPropertyInterface(e.a)
            }),
            Object.defineProperty(t, "opacity", {
                get: ExpressionPropertyInterface(e.o)
            }),
            Object.defineProperty(t, "skew", {
                get: ExpressionPropertyInterface(e.sk)
            }),
            Object.defineProperty(t, "skewAxis", {
                get: ExpressionPropertyInterface(e.sa)
            }),
            Object.defineProperty(t, "orientation", {
                get: ExpressionPropertyInterface(e.or)
            }),
            t
        }, LayerExpressionInterface = function() {
            function e(e) {
                var t = new Matrix;
                return void 0 !== e ? this._elem.finalTransform.mProp.getValueAtTime(e).clone(t) : this._elem.finalTransform.mProp.applyToMatrix(t),
                t
            }
            function t(e, t) {
                var i = this.getMatrix(t);
                return i.props[12] = 0,
                i.props[13] = 0,
                i.props[14] = 0,
                this.applyPoint(i, e)
            }
            function i(e, t) {
                var i = this.getMatrix(t);
                return this.applyPoint(i, e)
            }
            function r(e, t) {
                var i = this.getMatrix(t);
                return i.props[12] = 0,
                i.props[13] = 0,
                i.props[14] = 0,
                this.invertPoint(i, e)
            }
            function n(e, t) {
                var i = this.getMatrix(t);
                return this.invertPoint(i, e)
            }
            function a(e, t) {
                if (this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e)
                }
                return e.applyToPointArray(t[0], t[1], t[2] || 0)
            }
            function o(e, t) {
                if (this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e)
                }
                return e.inversePoint(t)
            }
            function s(e) {
                var t = new Matrix;
                if (t.reset(),
                this._elem.finalTransform.mProp.applyToMatrix(t),
                this._elem.hierarchy && this._elem.hierarchy.length) {
                    var i, r = this._elem.hierarchy.length;
                    for (i = 0; i < r; i += 1)
                        this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(t);
                    return t.inversePoint(e)
                }
                return t.inversePoint(e)
            }
            function l() {
                return [1, 1, 1, 1]
            }
            return function(h) {
                var c;
                function p(e) {
                    switch (e) {
                    case "ADBE Root Vectors Group":
                    case "Contents":
                    case 2:
                        return p.shapeInterface;
                    case 1:
                    case 6:
                    case "Transform":
                    case "transform":
                    case "ADBE Transform Group":
                        return c;
                    case 4:
                    case "ADBE Effect Parade":
                    case "effects":
                    case "Effects":
                        return p.effect;
                    case "ADBE Text Properties":
                        return p.textInterface;
                    default:
                        return null
                    }
                }
                p.getMatrix = e,
                p.invertPoint = o,
                p.applyPoint = a,
                p.toWorld = i,
                p.toWorldVec = t,
                p.fromWorld = n,
                p.fromWorldVec = r,
                p.toComp = i,
                p.fromComp = s,
                p.sampleImage = l,
                p.sourceRectAtTime = h.sourceRectAtTime.bind(h),
                p._elem = h;
                var u = getDescriptor(c = TransformExpressionInterface(h.finalTransform.mProp), "anchorPoint");
                return Object.defineProperties(p, {
                    hasParent: {
                        get: function() {
                            return h.hierarchy.length
                        }
                    },
                    parent: {
                        get: function() {
                            return h.hierarchy[0].layerInterface
                        }
                    },
                    rotation: getDescriptor(c, "rotation"),
                    scale: getDescriptor(c, "scale"),
                    position: getDescriptor(c, "position"),
                    opacity: getDescriptor(c, "opacity"),
                    anchorPoint: u,
                    anchor_point: u,
                    transform: {
                        get: function() {
                            return c
                        }
                    },
                    active: {
                        get: function() {
                            return h.isInRange
                        }
                    }
                }),
                p.startTime = h.data.st,
                p.index = h.data.ind,
                p.source = h.data.refId,
                p.height = 0 === h.data.ty ? h.data.h : 100,
                p.width = 0 === h.data.ty ? h.data.w : 100,
                p.inPoint = h.data.ip / h.comp.globalData.frameRate,
                p.outPoint = h.data.op / h.comp.globalData.frameRate,
                p._name = h.data.nm,
                p.registerMaskInterface = function(e) {
                    p.mask = new MaskManagerInterface(e,h)
                }
                ,
                p.registerEffectsInterface = function(e) {
                    p.effect = e
                }
                ,
                p
            }
        }(), propertyGroupFactory = function(e, t) {
            return function(i) {
                return (i = void 0 === i ? 1 : i) <= 0 ? e : t(i - 1)
            }
        }, PropertyInterface = function(e, t) {
            var i = {
                _name: e
            };
            return function(e) {
                return (e = void 0 === e ? 1 : e) <= 0 ? i : t(e - 1)
            }
        }, EffectsExpressionInterface = function() {
            function e(i, r, n, a) {
                function o(e) {
                    for (var t = i.ef, r = 0, n = t.length; r < n; ) {
                        if (e === t[r].nm || e === t[r].mn || e === t[r].ix)
                            return 5 === t[r].ty ? h[r] : h[r]();
                        r += 1
                    }
                    throw new Error
                }
                var s, l = propertyGroupFactory(o, n), h = [], c = i.ef.length;
                for (s = 0; s < c; s += 1)
                    5 === i.ef[s].ty ? h.push(e(i.ef[s], r.effectElements[s], r.effectElements[s].propertyGroup, a)) : h.push(t(r.effectElements[s], i.ef[s].ty, a, l));
                return "ADBE Color Control" === i.mn && Object.defineProperty(o, "color", {
                    get: function() {
                        return h[0]()
                    }
                }),
                Object.defineProperties(o, {
                    numProperties: {
                        get: function() {
                            return i.np
                        }
                    },
                    _name: {
                        value: i.nm
                    },
                    propertyGroup: {
                        value: l
                    }
                }),
                o.enabled = 0 !== i.en,
                o.active = o.enabled,
                o
            }
            function t(e, t, i, r) {
                var n = ExpressionPropertyInterface(e.p);
                return e.p.setGroupProperty && e.p.setGroupProperty(PropertyInterface("", r)),
                function() {
                    return 10 === t ? i.comp.compInterface(e.p.v) : n()
                }
            }
            return {
                createEffectsInterface: function(t, i) {
                    if (t.effectsManager) {
                        var r, n = [], a = t.data.ef, o = t.effectsManager.effectElements.length;
                        for (r = 0; r < o; r += 1)
                            n.push(e(a[r], t.effectsManager.effectElements[r], i, t));
                        var s = t.data.ef || []
                          , l = function(e) {
                            for (r = 0,
                            o = s.length; r < o; ) {
                                if (e === s[r].nm || e === s[r].mn || e === s[r].ix)
                                    return n[r];
                                r += 1
                            }
                            return null
                        };
                        return Object.defineProperty(l, "numProperties", {
                            get: function() {
                                return s.length
                            }
                        }),
                        l
                    }
                    return null
                }
            }
        }(), CompExpressionInterface = function(e) {
            function t(t) {
                for (var i = 0, r = e.layers.length; i < r; ) {
                    if (e.layers[i].nm === t || e.layers[i].ind === t)
                        return e.elements[i].layerInterface;
                    i += 1
                }
                return null
            }
            return Object.defineProperty(t, "_name", {
                value: e.data.nm
            }),
            t.layer = t,
            t.pixelAspect = 1,
            t.height = e.data.h || e.globalData.compSize.h,
            t.width = e.data.w || e.globalData.compSize.w,
            t.pixelAspect = 1,
            t.frameDuration = 1 / e.globalData.frameRate,
            t.displayStartTime = 0,
            t.numLayers = e.layers.length,
            t
        }, ShapePathInterface = function(e, t, i) {
            var r = t.sh;
            function n(e) {
                return "Shape" === e || "shape" === e || "Path" === e || "path" === e || "ADBE Vector Shape" === e || 2 === e ? n.path : null
            }
            var a = propertyGroupFactory(n, i);
            return r.setGroupProperty(PropertyInterface("Path", a)),
            Object.defineProperties(n, {
                path: {
                    get: function() {
                        return r.k && r.getValue(),
                        r
                    }
                },
                shape: {
                    get: function() {
                        return r.k && r.getValue(),
                        r
                    }
                },
                _name: {
                    value: e.nm
                },
                ix: {
                    value: e.ix
                },
                propertyIndex: {
                    value: e.ix
                },
                mn: {
                    value: e.mn
                },
                propertyGroup: {
                    value: i
                }
            }),
            n
        }, ShapeExpressionInterface = function() {
            function e(e, o, u) {
                var d, f = [], m = e ? e.length : 0;
                for (d = 0; d < m; d += 1)
                    "gr" === e[d].ty ? f.push(t(e[d], o[d], u)) : "fl" === e[d].ty ? f.push(i(e[d], o[d], u)) : "st" === e[d].ty ? f.push(n(e[d], o[d], u)) : "tm" === e[d].ty ? f.push(a(e[d], o[d], u)) : "tr" === e[d].ty || ("el" === e[d].ty ? f.push(s(e[d], o[d], u)) : "sr" === e[d].ty ? f.push(l(e[d], o[d], u)) : "sh" === e[d].ty ? f.push(ShapePathInterface(e[d], o[d], u)) : "rc" === e[d].ty ? f.push(h(e[d], o[d], u)) : "rd" === e[d].ty ? f.push(c(e[d], o[d], u)) : "rp" === e[d].ty ? f.push(p(e[d], o[d], u)) : "gf" === e[d].ty ? f.push(r(e[d], o[d], u)) : f.push((e[d],
                    o[d],
                    function() {
                        return null
                    }
                    )));
                return f
            }
            function t(t, i, r) {
                var n = function(e) {
                    switch (e) {
                    case "ADBE Vectors Group":
                    case "Contents":
                    case 2:
                        return n.content;
                    default:
                        return n.transform
                    }
                };
                n.propertyGroup = propertyGroupFactory(n, r);
                var a = function(t, i, r) {
                    var n, a = function(e) {
                        for (var t = 0, i = n.length; t < i; ) {
                            if (n[t]._name === e || n[t].mn === e || n[t].propertyIndex === e || n[t].ix === e || n[t].ind === e)
                                return n[t];
                            t += 1
                        }
                        return "number" == typeof e ? n[e - 1] : null
                    };
                    a.propertyGroup = propertyGroupFactory(a, r),
                    n = e(t.it, i.it, a.propertyGroup),
                    a.numProperties = n.length;
                    var s = o(t.it[t.it.length - 1], i.it[i.it.length - 1], a.propertyGroup);
                    return a.transform = s,
                    a.propertyIndex = t.cix,
                    a._name = t.nm,
                    a
                }(t, i, n.propertyGroup)
                  , s = o(t.it[t.it.length - 1], i.it[i.it.length - 1], n.propertyGroup);
                return n.content = a,
                n.transform = s,
                Object.defineProperty(n, "_name", {
                    get: function() {
                        return t.nm
                    }
                }),
                n.numProperties = t.np,
                n.propertyIndex = t.ix,
                n.nm = t.nm,
                n.mn = t.mn,
                n
            }
            function i(e, t, i) {
                function r(e) {
                    return "Color" === e || "color" === e ? r.color : "Opacity" === e || "opacity" === e ? r.opacity : null
                }
                return Object.defineProperties(r, {
                    color: {
                        get: ExpressionPropertyInterface(t.c)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.c.setGroupProperty(PropertyInterface("Color", i)),
                t.o.setGroupProperty(PropertyInterface("Opacity", i)),
                r
            }
            function r(e, t, i) {
                function r(e) {
                    return "Start Point" === e || "start point" === e ? r.startPoint : "End Point" === e || "end point" === e ? r.endPoint : "Opacity" === e || "opacity" === e ? r.opacity : null
                }
                return Object.defineProperties(r, {
                    startPoint: {
                        get: ExpressionPropertyInterface(t.s)
                    },
                    endPoint: {
                        get: ExpressionPropertyInterface(t.e)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    type: {
                        get: function() {
                            return "a"
                        }
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.s.setGroupProperty(PropertyInterface("Start Point", i)),
                t.e.setGroupProperty(PropertyInterface("End Point", i)),
                t.o.setGroupProperty(PropertyInterface("Opacity", i)),
                r
            }
            function n(e, t, i) {
                var r, n, a = propertyGroupFactory(h, i), o = propertyGroupFactory(l, a), s = e.d ? e.d.length : 0, l = {};
                for (r = 0; r < s; r += 1)
                    n = r,
                    Object.defineProperty(l, e.d[n].nm, {
                        get: ExpressionPropertyInterface(t.d.dataProps[n].p)
                    }),
                    t.d.dataProps[r].p.setGroupProperty(o);
                function h(e) {
                    return "Color" === e || "color" === e ? h.color : "Opacity" === e || "opacity" === e ? h.opacity : "Stroke Width" === e || "stroke width" === e ? h.strokeWidth : null
                }
                return Object.defineProperties(h, {
                    color: {
                        get: ExpressionPropertyInterface(t.c)
                    },
                    opacity: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    strokeWidth: {
                        get: ExpressionPropertyInterface(t.w)
                    },
                    dash: {
                        get: function() {
                            return l
                        }
                    },
                    _name: {
                        value: e.nm
                    },
                    mn: {
                        value: e.mn
                    }
                }),
                t.c.setGroupProperty(PropertyInterface("Color", a)),
                t.o.setGroupProperty(PropertyInterface("Opacity", a)),
                t.w.setGroupProperty(PropertyInterface("Stroke Width", a)),
                h
            }
            function a(e, t, i) {
                function r(t) {
                    return t === e.e.ix || "End" === t || "end" === t ? r.end : t === e.s.ix ? r.start : t === e.o.ix ? r.offset : null
                }
                var n = propertyGroupFactory(r, i);
                return r.propertyIndex = e.ix,
                t.s.setGroupProperty(PropertyInterface("Start", n)),
                t.e.setGroupProperty(PropertyInterface("End", n)),
                t.o.setGroupProperty(PropertyInterface("Offset", n)),
                r.propertyIndex = e.ix,
                r.propertyGroup = i,
                Object.defineProperties(r, {
                    start: {
                        get: ExpressionPropertyInterface(t.s)
                    },
                    end: {
                        get: ExpressionPropertyInterface(t.e)
                    },
                    offset: {
                        get: ExpressionPropertyInterface(t.o)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function o(e, t, i) {
                function r(t) {
                    return e.a.ix === t || "Anchor Point" === t ? r.anchorPoint : e.o.ix === t || "Opacity" === t ? r.opacity : e.p.ix === t || "Position" === t ? r.position : e.r.ix === t || "Rotation" === t || "ADBE Vector Rotation" === t ? r.rotation : e.s.ix === t || "Scale" === t ? r.scale : e.sk && e.sk.ix === t || "Skew" === t ? r.skew : e.sa && e.sa.ix === t || "Skew Axis" === t ? r.skewAxis : null
                }
                var n = propertyGroupFactory(r, i);
                return t.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity", n)),
                t.transform.mProps.p.setGroupProperty(PropertyInterface("Position", n)),
                t.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point", n)),
                t.transform.mProps.s.setGroupProperty(PropertyInterface("Scale", n)),
                t.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation", n)),
                t.transform.mProps.sk && (t.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew", n)),
                t.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle", n))),
                t.transform.op.setGroupProperty(PropertyInterface("Opacity", n)),
                Object.defineProperties(r, {
                    opacity: {
                        get: ExpressionPropertyInterface(t.transform.mProps.o)
                    },
                    position: {
                        get: ExpressionPropertyInterface(t.transform.mProps.p)
                    },
                    anchorPoint: {
                        get: ExpressionPropertyInterface(t.transform.mProps.a)
                    },
                    scale: {
                        get: ExpressionPropertyInterface(t.transform.mProps.s)
                    },
                    rotation: {
                        get: ExpressionPropertyInterface(t.transform.mProps.r)
                    },
                    skew: {
                        get: ExpressionPropertyInterface(t.transform.mProps.sk)
                    },
                    skewAxis: {
                        get: ExpressionPropertyInterface(t.transform.mProps.sa)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.ty = "tr",
                r.mn = e.mn,
                r.propertyGroup = i,
                r
            }
            function s(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.s.ix === t ? r.size : null
                }
                var n = propertyGroupFactory(r, i);
                r.propertyIndex = e.ix;
                var a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return a.s.setGroupProperty(PropertyInterface("Size", n)),
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                Object.defineProperties(r, {
                    size: {
                        get: ExpressionPropertyInterface(a.s)
                    },
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function l(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.r.ix === t ? r.rotation : e.pt.ix === t ? r.points : e.or.ix === t || "ADBE Vector Star Outer Radius" === t ? r.outerRadius : e.os.ix === t ? r.outerRoundness : !e.ir || e.ir.ix !== t && "ADBE Vector Star Inner Radius" !== t ? e.is && e.is.ix === t ? r.innerRoundness : null : r.innerRadius
                }
                var n = propertyGroupFactory(r, i)
                  , a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return r.propertyIndex = e.ix,
                a.or.setGroupProperty(PropertyInterface("Outer Radius", n)),
                a.os.setGroupProperty(PropertyInterface("Outer Roundness", n)),
                a.pt.setGroupProperty(PropertyInterface("Points", n)),
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                a.r.setGroupProperty(PropertyInterface("Rotation", n)),
                e.ir && (a.ir.setGroupProperty(PropertyInterface("Inner Radius", n)),
                a.is.setGroupProperty(PropertyInterface("Inner Roundness", n))),
                Object.defineProperties(r, {
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    rotation: {
                        get: ExpressionPropertyInterface(a.r)
                    },
                    points: {
                        get: ExpressionPropertyInterface(a.pt)
                    },
                    outerRadius: {
                        get: ExpressionPropertyInterface(a.or)
                    },
                    outerRoundness: {
                        get: ExpressionPropertyInterface(a.os)
                    },
                    innerRadius: {
                        get: ExpressionPropertyInterface(a.ir)
                    },
                    innerRoundness: {
                        get: ExpressionPropertyInterface(a.is)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function h(e, t, i) {
                function r(t) {
                    return e.p.ix === t ? r.position : e.r.ix === t ? r.roundness : e.s.ix === t || "Size" === t || "ADBE Vector Rect Size" === t ? r.size : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = "tm" === t.sh.ty ? t.sh.prop : t.sh;
                return r.propertyIndex = e.ix,
                a.p.setGroupProperty(PropertyInterface("Position", n)),
                a.s.setGroupProperty(PropertyInterface("Size", n)),
                a.r.setGroupProperty(PropertyInterface("Rotation", n)),
                Object.defineProperties(r, {
                    position: {
                        get: ExpressionPropertyInterface(a.p)
                    },
                    roundness: {
                        get: ExpressionPropertyInterface(a.r)
                    },
                    size: {
                        get: ExpressionPropertyInterface(a.s)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function c(e, t, i) {
                function r(t) {
                    return e.r.ix === t || "Round Corners 1" === t ? r.radius : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = t;
                return r.propertyIndex = e.ix,
                a.rd.setGroupProperty(PropertyInterface("Radius", n)),
                Object.defineProperties(r, {
                    radius: {
                        get: ExpressionPropertyInterface(a.rd)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            function p(e, t, i) {
                function r(t) {
                    return e.c.ix === t || "Copies" === t ? r.copies : e.o.ix === t || "Offset" === t ? r.offset : null
                }
                var n = propertyGroupFactory(r, i)
                  , a = t;
                return r.propertyIndex = e.ix,
                a.c.setGroupProperty(PropertyInterface("Copies", n)),
                a.o.setGroupProperty(PropertyInterface("Offset", n)),
                Object.defineProperties(r, {
                    copies: {
                        get: ExpressionPropertyInterface(a.c)
                    },
                    offset: {
                        get: ExpressionPropertyInterface(a.o)
                    },
                    _name: {
                        value: e.nm
                    }
                }),
                r.mn = e.mn,
                r
            }
            return function(t, i, r) {
                var n;
                function a(e) {
                    if ("number" == typeof e)
                        return 0 === (e = void 0 === e ? 1 : e) ? r : n[e - 1];
                    for (var t = 0, i = n.length; t < i; ) {
                        if (n[t]._name === e)
                            return n[t];
                        t += 1
                    }
                    return null
                }
                return a.propertyGroup = propertyGroupFactory(a, (function() {
                    return r
                }
                )),
                n = e(t, i, a.propertyGroup),
                a.numProperties = n.length,
                a._name = "Contents",
                a
            }
        }(), TextExpressionInterface = function(e) {
            var t, i;
            function r(e) {
                return "ADBE Text Document" === e ? r.sourceText : null
            }
            return Object.defineProperty(r, "sourceText", {
                get: function() {
                    e.textProperty.getValue();
                    var r = e.textProperty.currentData.t;
                    return r !== t && (e.textProperty.currentData.t = t,
                    (i = new String(r)).value = r || new String(r)),
                    i
                }
            }),
            r
        }, getBlendMode = (blendModeEnums2 = {
            0: "source-over",
            1: "multiply",
            2: "screen",
            3: "overlay",
            4: "darken",
            5: "lighten",
            6: "color-dodge",
            7: "color-burn",
            8: "hard-light",
            9: "soft-light",
            10: "difference",
            11: "exclusion",
            12: "hue",
            13: "saturation",
            14: "color",
            15: "luminosity"
        },
        function(e) {
            return blendModeEnums2[e] || ""
        }
        ), blendModeEnums2;
        function SliderEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function AngleEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function ColorEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 1, 0, i)
        }
        function PointEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 1, 0, i)
        }
        function LayerIndexEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function MaskIndexEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function CheckboxEffect(e, t, i) {
            this.p = PropertyFactory.getProp(t, e.v, 0, 0, i)
        }
        function NoValueEffect() {
            this.p = {}
        }
        function EffectsManager(e, t) {
            var i, r = e.ef || [];
            this.effectElements = [];
            var n, a = r.length;
            for (i = 0; i < a; i += 1)
                n = new GroupEffect(r[i],t),
                this.effectElements.push(n)
        }
        function GroupEffect(e, t) {
            this.init(e, t)
        }
        function BaseElement() {}
        function FrameElement() {}
        function _typeof$2(e) {
            return (_typeof$2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        extendPrototype([DynamicPropertyContainer], GroupEffect),
        GroupEffect.prototype.getValue = GroupEffect.prototype.iterateDynamicProperties,
        GroupEffect.prototype.init = function(e, t) {
            var i;
            this.data = e,
            this.effectElements = [],
            this.initDynamicPropertyContainer(t);
            var r, n = this.data.ef.length, a = this.data.ef;
            for (i = 0; i < n; i += 1) {
                switch (r = null,
                a[i].ty) {
                case 0:
                    r = new SliderEffect(a[i],t,this);
                    break;
                case 1:
                    r = new AngleEffect(a[i],t,this);
                    break;
                case 2:
                    r = new ColorEffect(a[i],t,this);
                    break;
                case 3:
                    r = new PointEffect(a[i],t,this);
                    break;
                case 4:
                case 7:
                    r = new CheckboxEffect(a[i],t,this);
                    break;
                case 10:
                    r = new LayerIndexEffect(a[i],t,this);
                    break;
                case 11:
                    r = new MaskIndexEffect(a[i],t,this);
                    break;
                case 5:
                    r = new EffectsManager(a[i],t);
                    break;
                default:
                    r = new NoValueEffect(a[i])
                }
                r && this.effectElements.push(r)
            }
        }
        ,
        BaseElement.prototype = {
            checkMasks: function() {
                if (!this.data.hasMask)
                    return !1;
                for (var e = 0, t = this.data.masksProperties.length; e < t; ) {
                    if ("n" !== this.data.masksProperties[e].mode && !1 !== this.data.masksProperties[e].cl)
                        return !0;
                    e += 1
                }
                return !1
            },
            initExpressions: function() {
                this.layerInterface = LayerExpressionInterface(this),
                this.data.hasMask && this.maskManager && this.layerInterface.registerMaskInterface(this.maskManager);
                var e = EffectsExpressionInterface.createEffectsInterface(this, this.layerInterface);
                this.layerInterface.registerEffectsInterface(e),
                0 === this.data.ty || this.data.xt ? this.compInterface = CompExpressionInterface(this) : 4 === this.data.ty ? (this.layerInterface.shapeInterface = ShapeExpressionInterface(this.shapesData, this.itemsData, this.layerInterface),
                this.layerInterface.content = this.layerInterface.shapeInterface) : 5 === this.data.ty && (this.layerInterface.textInterface = TextExpressionInterface(this),
                this.layerInterface.text = this.layerInterface.textInterface)
            },
            setBlendMode: function() {
                var e = getBlendMode(this.data.bm);
                (this.baseElement || this.layerElement).style["mix-blend-mode"] = e
            },
            initBaseData: function(e, t, i) {
                this.globalData = t,
                this.comp = i,
                this.data = e,
                this.layerId = createElementID(),
                this.data.sr || (this.data.sr = 1),
                this.effectsManager = new EffectsManager(this.data,this,this.dynamicProperties)
            },
            getType: function() {
                return this.type
            },
            sourceRectAtTime: function() {}
        },
        FrameElement.prototype = {
            initFrame: function() {
                this._isFirstFrame = !1,
                this.dynamicProperties = [],
                this._mdf = !1
            },
            prepareProperties: function(e, t) {
                var i, r = this.dynamicProperties.length;
                for (i = 0; i < r; i += 1)
                    (t || this._isParent && "transform" === this.dynamicProperties[i].propType) && (this.dynamicProperties[i].getValue(),
                    this.dynamicProperties[i]._mdf && (this.globalData._mdf = !0,
                    this._mdf = !0))
            },
            addDynamicProperty: function(e) {
                -1 === this.dynamicProperties.indexOf(e) && this.dynamicProperties.push(e)
            }
        };
        var FootageInterface = (dataInterfaceFactory2 = function(e) {
            function t(e) {
                return "Outline" === e ? t.outlineInterface() : null
            }
            return t._name = "Outline",
            t.outlineInterface = function(e) {
                var t = ""
                  , i = e.getFootageData();
                function r(e) {
                    if (i[e])
                        return t = e,
                        "object" === _typeof$2(i = i[e]) ? r : i;
                    var n = e.indexOf(t);
                    if (-1 !== n) {
                        var a = parseInt(e.substr(n + t.length), 10);
                        return "object" === _typeof$2(i = i[a]) ? r : i
                    }
                    return ""
                }
                return function() {
                    return t = "",
                    i = e.getFootageData(),
                    r
                }
            }(e),
            t
        }
        ,
        function(e) {
            function t(e) {
                return "Data" === e ? t.dataInterface : null
            }
            return t._name = "Data",
            t.dataInterface = dataInterfaceFactory2(e),
            t
        }
        ), dataInterfaceFactory2;
        function FootageElement(e, t, i) {
            this.initFrame(),
            this.initRenderable(),
            this.assetData = t.getAssetData(e.refId),
            this.footageData = t.imageLoader.getAsset(this.assetData),
            this.initBaseData(e, t, i)
        }
        function AudioElement(e, t, i) {
            this.initFrame(),
            this.initRenderable(),
            this.assetData = t.getAssetData(e.refId),
            this.initBaseData(e, t, i),
            this._isPlaying = !1,
            this._canPlay = !1;
            var r = this.globalData.getAssetsPath(this.assetData);
            this.audio = this.globalData.audioController.createAudio(r),
            this._currentTime = 0,
            this.globalData.audioController.addAudio(this),
            this._volumeMultiplier = 1,
            this._volume = 1,
            this._previousVolume = null,
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            },
            this.lv = PropertyFactory.getProp(this, e.au && e.au.lv ? e.au.lv : {
                k: [100]
            }, 1, .01, this)
        }
        function BaseRenderer() {}
        function TransformElement() {}
        function MaskElement(e, t, i) {
            this.data = e,
            this.element = t,
            this.globalData = i,
            this.storedData = [],
            this.masksProperties = this.data.masksProperties || [],
            this.maskElement = null;
            var r, n, a = this.globalData.defs, o = this.masksProperties ? this.masksProperties.length : 0;
            this.viewData = createSizedArray(o),
            this.solidPath = "";
            var s, l, h, c, p, u, d = this.masksProperties, f = 0, m = [], g = createElementID(), v = "clipPath", y = "clip-path";
            for (r = 0; r < o; r += 1)
                if (("a" !== d[r].mode && "n" !== d[r].mode || d[r].inv || 100 !== d[r].o.k || d[r].o.x) && (v = "mask",
                y = "mask"),
                "s" !== d[r].mode && "i" !== d[r].mode || 0 !== f ? h = null : ((h = createNS("rect")).setAttribute("fill", "#ffffff"),
                h.setAttribute("width", this.element.comp.data.w || 0),
                h.setAttribute("height", this.element.comp.data.h || 0),
                m.push(h)),
                n = createNS("path"),
                "n" === d[r].mode)
                    this.viewData[r] = {
                        op: PropertyFactory.getProp(this.element, d[r].o, 0, .01, this.element),
                        prop: ShapePropertyFactory.getShapeProp(this.element, d[r], 3),
                        elem: n,
                        lastPath: ""
                    },
                    a.appendChild(n);
                else {
                    var _;
                    if (f += 1,
                    n.setAttribute("fill", "s" === d[r].mode ? "#000000" : "#ffffff"),
                    n.setAttribute("clip-rule", "nonzero"),
                    0 !== d[r].x.k ? (v = "mask",
                    y = "mask",
                    u = PropertyFactory.getProp(this.element, d[r].x, 0, null, this.element),
                    _ = createElementID(),
                    (c = createNS("filter")).setAttribute("id", _),
                    (p = createNS("feMorphology")).setAttribute("operator", "erode"),
                    p.setAttribute("in", "SourceGraphic"),
                    p.setAttribute("radius", "0"),
                    c.appendChild(p),
                    a.appendChild(c),
                    n.setAttribute("stroke", "s" === d[r].mode ? "#000000" : "#ffffff")) : (p = null,
                    u = null),
                    this.storedData[r] = {
                        elem: n,
                        x: u,
                        expan: p,
                        lastPath: "",
                        lastOperator: "",
                        filterId: _,
                        lastRadius: 0
                    },
                    "i" === d[r].mode) {
                        l = m.length;
                        var b = createNS("g");
                        for (s = 0; s < l; s += 1)
                            b.appendChild(m[s]);
                        var x = createNS("mask");
                        x.setAttribute("mask-type", "alpha"),
                        x.setAttribute("id", g + "_" + f),
                        x.appendChild(n),
                        a.appendChild(x),
                        b.setAttribute("mask", "url(" + getLocationHref() + "#" + g + "_" + f + ")"),
                        m.length = 0,
                        m.push(b)
                    } else
                        m.push(n);
                    d[r].inv && !this.solidPath && (this.solidPath = this.createLayerSolidPath()),
                    this.viewData[r] = {
                        elem: n,
                        lastPath: "",
                        op: PropertyFactory.getProp(this.element, d[r].o, 0, .01, this.element),
                        prop: ShapePropertyFactory.getShapeProp(this.element, d[r], 3),
                        invRect: h
                    },
                    this.viewData[r].prop.k || this.drawPath(d[r], this.viewData[r].prop.v, this.viewData[r])
                }
            for (this.maskElement = createNS(v),
            o = m.length,
            r = 0; r < o; r += 1)
                this.maskElement.appendChild(m[r]);
            f > 0 && (this.maskElement.setAttribute("id", g),
            this.element.maskedElement.setAttribute(y, "url(" + getLocationHref() + "#" + g + ")"),
            a.appendChild(this.maskElement)),
            this.viewData.length && this.element.addRenderableComponent(this)
        }
        FootageElement.prototype.prepareFrame = function() {}
        ,
        extendPrototype([RenderableElement, BaseElement, FrameElement], FootageElement),
        FootageElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        FootageElement.prototype.renderFrame = function() {}
        ,
        FootageElement.prototype.destroy = function() {}
        ,
        FootageElement.prototype.initExpressions = function() {
            this.layerInterface = FootageInterface(this)
        }
        ,
        FootageElement.prototype.getFootageData = function() {
            return this.footageData
        }
        ,
        AudioElement.prototype.prepareFrame = function(e) {
            if (this.prepareRenderableFrame(e, !0),
            this.prepareProperties(e, !0),
            this.tm._placeholder)
                this._currentTime = e / this.data.sr;
            else {
                var t = this.tm.v;
                this._currentTime = t
            }
            this._volume = this.lv.v[0];
            var i = this._volume * this._volumeMultiplier;
            this._previousVolume !== i && (this._previousVolume = i,
            this.audio.volume(i))
        }
        ,
        extendPrototype([RenderableElement, BaseElement, FrameElement], AudioElement),
        AudioElement.prototype.renderFrame = function() {
            this.isInRange && this._canPlay && (this._isPlaying ? (!this.audio.playing() || Math.abs(this._currentTime / this.globalData.frameRate - this.audio.seek()) > .1) && this.audio.seek(this._currentTime / this.globalData.frameRate) : (this.audio.play(),
            this.audio.seek(this._currentTime / this.globalData.frameRate),
            this._isPlaying = !0))
        }
        ,
        AudioElement.prototype.show = function() {}
        ,
        AudioElement.prototype.hide = function() {
            this.audio.pause(),
            this._isPlaying = !1
        }
        ,
        AudioElement.prototype.pause = function() {
            this.audio.pause(),
            this._isPlaying = !1,
            this._canPlay = !1
        }
        ,
        AudioElement.prototype.resume = function() {
            this._canPlay = !0
        }
        ,
        AudioElement.prototype.setRate = function(e) {
            this.audio.rate(e)
        }
        ,
        AudioElement.prototype.volume = function(e) {
            this._volumeMultiplier = e,
            this._previousVolume = e * this._volume,
            this.audio.volume(this._previousVolume)
        }
        ,
        AudioElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        AudioElement.prototype.destroy = function() {}
        ,
        AudioElement.prototype.sourceRectAtTime = function() {}
        ,
        AudioElement.prototype.initExpressions = function() {}
        ,
        BaseRenderer.prototype.checkLayers = function(e) {
            var t, i, r = this.layers.length;
            for (this.completeLayers = !0,
            t = r - 1; t >= 0; t -= 1)
                this.elements[t] || (i = this.layers[t]).ip - i.st <= e - this.layers[t].st && i.op - i.st > e - this.layers[t].st && this.buildItem(t),
                this.completeLayers = !!this.elements[t] && this.completeLayers;
            this.checkPendingElements()
        }
        ,
        BaseRenderer.prototype.createItem = function(e) {
            switch (e.ty) {
            case 2:
                return this.createImage(e);
            case 0:
                return this.createComp(e);
            case 1:
                return this.createSolid(e);
            case 3:
            default:
                return this.createNull(e);
            case 4:
                return this.createShape(e);
            case 5:
                return this.createText(e);
            case 6:
                return this.createAudio(e);
            case 13:
                return this.createCamera(e);
            case 15:
                return this.createFootage(e)
            }
        }
        ,
        BaseRenderer.prototype.createCamera = function() {
            throw new Error("You're using a 3d camera. Try the html renderer.")
        }
        ,
        BaseRenderer.prototype.createAudio = function(e) {
            return new AudioElement(e,this.globalData,this)
        }
        ,
        BaseRenderer.prototype.createFootage = function(e) {
            return new FootageElement(e,this.globalData,this)
        }
        ,
        BaseRenderer.prototype.buildAllItems = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                this.buildItem(e);
            this.checkPendingElements()
        }
        ,
        BaseRenderer.prototype.includeLayers = function(e) {
            var t;
            this.completeLayers = !1;
            var i, r = e.length, n = this.layers.length;
            for (t = 0; t < r; t += 1)
                for (i = 0; i < n; ) {
                    if (this.layers[i].id === e[t].id) {
                        this.layers[i] = e[t];
                        break
                    }
                    i += 1
                }
        }
        ,
        BaseRenderer.prototype.setProjectInterface = function(e) {
            this.globalData.projectInterface = e
        }
        ,
        BaseRenderer.prototype.initItems = function() {
            this.globalData.progressiveLoad || this.buildAllItems()
        }
        ,
        BaseRenderer.prototype.buildElementParenting = function(e, t, i) {
            for (var r = this.elements, n = this.layers, a = 0, o = n.length; a < o; )
                n[a].ind == t && (r[a] && !0 !== r[a] ? (i.push(r[a]),
                r[a].setAsParent(),
                void 0 !== n[a].parent ? this.buildElementParenting(e, n[a].parent, i) : e.setHierarchy(i)) : (this.buildItem(a),
                this.addPendingElement(e))),
                a += 1
        }
        ,
        BaseRenderer.prototype.addPendingElement = function(e) {
            this.pendingElements.push(e)
        }
        ,
        BaseRenderer.prototype.searchExtraCompositions = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                if (e[t].xt) {
                    var r = this.createComp(e[t]);
                    r.initExpressions(),
                    this.globalData.projectInterface.registerComposition(r)
                }
        }
        ,
        BaseRenderer.prototype.getElementByPath = function(e) {
            var t, i = e.shift();
            if ("number" == typeof i)
                t = this.elements[i];
            else {
                var r, n = this.elements.length;
                for (r = 0; r < n; r += 1)
                    if (this.elements[r].data.nm === i) {
                        t = this.elements[r];
                        break
                    }
            }
            return 0 === e.length ? t : t.getElementByPath(e)
        }
        ,
        BaseRenderer.prototype.setupGlobalData = function(e, t) {
            this.globalData.fontManager = new FontManager,
            this.globalData.fontManager.addChars(e.chars),
            this.globalData.fontManager.addFonts(e.fonts, t),
            this.globalData.getAssetData = this.animationItem.getAssetData.bind(this.animationItem),
            this.globalData.getAssetsPath = this.animationItem.getAssetsPath.bind(this.animationItem),
            this.globalData.imageLoader = this.animationItem.imagePreloader,
            this.globalData.audioController = this.animationItem.audioController,
            this.globalData.frameId = 0,
            this.globalData.frameRate = e.fr,
            this.globalData.nm = e.nm,
            this.globalData.compSize = {
                w: e.w,
                h: e.h
            }
        }
        ,
        TransformElement.prototype = {
            initTransform: function() {
                this.finalTransform = {
                    mProp: this.data.ks ? TransformPropertyFactory.getTransformProperty(this, this.data.ks, this) : {
                        o: 0
                    },
                    _matMdf: !1,
                    _opMdf: !1,
                    mat: new Matrix
                },
                this.data.ao && (this.finalTransform.mProp.autoOriented = !0),
                this.data.ty
            },
            renderTransform: function() {
                if (this.finalTransform._opMdf = this.finalTransform.mProp.o._mdf || this._isFirstFrame,
                this.finalTransform._matMdf = this.finalTransform.mProp._mdf || this._isFirstFrame,
                this.hierarchy) {
                    var e, t = this.finalTransform.mat, i = 0, r = this.hierarchy.length;
                    if (!this.finalTransform._matMdf)
                        for (; i < r; ) {
                            if (this.hierarchy[i].finalTransform.mProp._mdf) {
                                this.finalTransform._matMdf = !0;
                                break
                            }
                            i += 1
                        }
                    if (this.finalTransform._matMdf)
                        for (e = this.finalTransform.mProp.v.props,
                        t.cloneFromProps(e),
                        i = 0; i < r; i += 1)
                            e = this.hierarchy[i].finalTransform.mProp.v.props,
                            t.transform(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11], e[12], e[13], e[14], e[15])
                }
            },
            globalToLocal: function(e) {
                var t = [];
                t.push(this.finalTransform);
                for (var i, r = !0, n = this.comp; r; )
                    n.finalTransform ? (n.data.hasMask && t.splice(0, 0, n.finalTransform),
                    n = n.comp) : r = !1;
                var a, o = t.length;
                for (i = 0; i < o; i += 1)
                    a = t[i].mat.applyToPointArray(0, 0, 0),
                    e = [e[0] - a[0], e[1] - a[1], 0];
                return e
            },
            mHelper: new Matrix
        },
        MaskElement.prototype.getMaskProperty = function(e) {
            return this.viewData[e].prop
        }
        ,
        MaskElement.prototype.renderFrame = function(e) {
            var t, i = this.element.finalTransform.mat, r = this.masksProperties.length;
            for (t = 0; t < r; t += 1)
                if ((this.viewData[t].prop._mdf || e) && this.drawPath(this.masksProperties[t], this.viewData[t].prop.v, this.viewData[t]),
                (this.viewData[t].op._mdf || e) && this.viewData[t].elem.setAttribute("fill-opacity", this.viewData[t].op.v),
                "n" !== this.masksProperties[t].mode && (this.viewData[t].invRect && (this.element.finalTransform.mProp._mdf || e) && this.viewData[t].invRect.setAttribute("transform", i.getInverseMatrix().to2dCSS()),
                this.storedData[t].x && (this.storedData[t].x._mdf || e))) {
                    var n = this.storedData[t].expan;
                    this.storedData[t].x.v < 0 ? ("erode" !== this.storedData[t].lastOperator && (this.storedData[t].lastOperator = "erode",
                    this.storedData[t].elem.setAttribute("filter", "url(" + getLocationHref() + "#" + this.storedData[t].filterId + ")")),
                    n.setAttribute("radius", -this.storedData[t].x.v)) : ("dilate" !== this.storedData[t].lastOperator && (this.storedData[t].lastOperator = "dilate",
                    this.storedData[t].elem.setAttribute("filter", null)),
                    this.storedData[t].elem.setAttribute("stroke-width", 2 * this.storedData[t].x.v))
                }
        }
        ,
        MaskElement.prototype.getMaskelement = function() {
            return this.maskElement
        }
        ,
        MaskElement.prototype.createLayerSolidPath = function() {
            var e = "M0,0 ";
            return e += " h" + this.globalData.compSize.w,
            e += " v" + this.globalData.compSize.h,
            (e += " h-" + this.globalData.compSize.w) + " v-" + this.globalData.compSize.h + " "
        }
        ,
        MaskElement.prototype.drawPath = function(e, t, i) {
            var r, n, a = " M" + t.v[0][0] + "," + t.v[0][1];
            for (n = t._length,
            r = 1; r < n; r += 1)
                a += " C" + t.o[r - 1][0] + "," + t.o[r - 1][1] + " " + t.i[r][0] + "," + t.i[r][1] + " " + t.v[r][0] + "," + t.v[r][1];
            if (t.c && n > 1 && (a += " C" + t.o[r - 1][0] + "," + t.o[r - 1][1] + " " + t.i[0][0] + "," + t.i[0][1] + " " + t.v[0][0] + "," + t.v[0][1]),
            i.lastPath !== a) {
                var o = "";
                i.elem && (t.c && (o = e.inv ? this.solidPath + a : a),
                i.elem.setAttribute("d", o)),
                i.lastPath = a
            }
        }
        ,
        MaskElement.prototype.destroy = function() {
            this.element = null,
            this.globalData = null,
            this.maskElement = null,
            this.data = null,
            this.masksProperties = null
        }
        ;
        var filtersFactory = {
            createFilter: function(e, t) {
                var i = createNS("filter");
                return i.setAttribute("id", e),
                !0 !== t && (i.setAttribute("filterUnits", "objectBoundingBox"),
                i.setAttribute("x", "0%"),
                i.setAttribute("y", "0%"),
                i.setAttribute("width", "100%"),
                i.setAttribute("height", "100%")),
                i
            },
            createAlphaToLuminanceFilter: function() {
                var e = createNS("feColorMatrix");
                return e.setAttribute("type", "matrix"),
                e.setAttribute("color-interpolation-filters", "sRGB"),
                e.setAttribute("values", "0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),
                e
            }
        }
          , featureSupport = function() {
            var e = {
                maskType: !0
            };
            return (/MSIE 10/i.test(navigator.userAgent) || /MSIE 9/i.test(navigator.userAgent) || /rv:11.0/i.test(navigator.userAgent) || /Edge\/\d./i.test(navigator.userAgent)) && (e.maskType = !1),
            e
        }()
          , registeredEffects = {}
          , idPrefix = "filter_result_";
        function SVGEffects(e) {
            var t, i, r = "SourceGraphic", n = e.data.ef ? e.data.ef.length : 0, a = createElementID(), o = filtersFactory.createFilter(a, !0), s = 0;
            for (this.filters = [],
            t = 0; t < n; t += 1) {
                i = null;
                var l = e.data.ef[t].ty;
                registeredEffects[l] && (i = new (0,
                registeredEffects[l].effect)(o,e.effectsManager.effectElements[t],e,idPrefix + s,r),
                r = idPrefix + s,
                registeredEffects[l].countsAsEffect && (s += 1)),
                i && this.filters.push(i)
            }
            s && (e.globalData.defs.appendChild(o),
            e.layerElement.setAttribute("filter", "url(" + getLocationHref() + "#" + a + ")")),
            this.filters.length && e.addRenderableComponent(this)
        }
        function registerEffect(e, t, i) {
            registeredEffects[e] = {
                effect: t,
                countsAsEffect: i
            }
        }
        function SVGBaseElement() {}
        function HierarchyElement() {}
        function RenderableDOMElement() {}
        function IImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.initElement(e, t, i),
            this.sourceRect = {
                top: 0,
                left: 0,
                width: this.assetData.w,
                height: this.assetData.h
            }
        }
        function ProcessedElement(e, t) {
            this.elem = e,
            this.pos = t
        }
        function IShapeElement() {}
        SVGEffects.prototype.renderFrame = function(e) {
            var t, i = this.filters.length;
            for (t = 0; t < i; t += 1)
                this.filters[t].renderFrame(e)
        }
        ,
        SVGBaseElement.prototype = {
            initRendererElement: function() {
                this.layerElement = createNS("g")
            },
            createContainerElements: function() {
                this.matteElement = createNS("g"),
                this.transformedElement = this.layerElement,
                this.maskedElement = this.layerElement,
                this._sizeChanged = !1;
                var e, t, i, r = null;
                if (this.data.td) {
                    if (3 == this.data.td || 1 == this.data.td) {
                        var n = createNS("mask");
                        n.setAttribute("id", this.layerId),
                        n.setAttribute("mask-type", 3 == this.data.td ? "luminance" : "alpha"),
                        n.appendChild(this.layerElement),
                        r = n,
                        this.globalData.defs.appendChild(n),
                        featureSupport.maskType || 1 != this.data.td || (n.setAttribute("mask-type", "luminance"),
                        e = createElementID(),
                        t = filtersFactory.createFilter(e),
                        this.globalData.defs.appendChild(t),
                        t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),
                        (i = createNS("g")).appendChild(this.layerElement),
                        r = i,
                        n.appendChild(i),
                        i.setAttribute("filter", "url(" + getLocationHref() + "#" + e + ")"))
                    } else if (2 == this.data.td) {
                        var a = createNS("mask");
                        a.setAttribute("id", this.layerId),
                        a.setAttribute("mask-type", "alpha");
                        var o = createNS("g");
                        a.appendChild(o),
                        e = createElementID(),
                        t = filtersFactory.createFilter(e);
                        var s = createNS("feComponentTransfer");
                        s.setAttribute("in", "SourceGraphic"),
                        t.appendChild(s);
                        var l = createNS("feFuncA");
                        l.setAttribute("type", "table"),
                        l.setAttribute("tableValues", "1.0 0.0"),
                        s.appendChild(l),
                        this.globalData.defs.appendChild(t);
                        var h = createNS("rect");
                        h.setAttribute("width", this.comp.data.w),
                        h.setAttribute("height", this.comp.data.h),
                        h.setAttribute("x", "0"),
                        h.setAttribute("y", "0"),
                        h.setAttribute("fill", "#ffffff"),
                        h.setAttribute("opacity", "0"),
                        o.setAttribute("filter", "url(" + getLocationHref() + "#" + e + ")"),
                        o.appendChild(h),
                        o.appendChild(this.layerElement),
                        r = o,
                        featureSupport.maskType || (a.setAttribute("mask-type", "luminance"),
                        t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),
                        i = createNS("g"),
                        o.appendChild(h),
                        i.appendChild(this.layerElement),
                        r = i,
                        o.appendChild(i)),
                        this.globalData.defs.appendChild(a)
                    }
                } else
                    this.data.tt ? (this.matteElement.appendChild(this.layerElement),
                    r = this.matteElement,
                    this.baseElement = this.matteElement) : this.baseElement = this.layerElement;
                if (this.data.ln && this.layerElement.setAttribute("id", this.data.ln),
                this.data.cl && this.layerElement.setAttribute("class", this.data.cl),
                0 === this.data.ty && !this.data.hd) {
                    var c = createNS("clipPath")
                      , p = createNS("path");
                    p.setAttribute("d", "M0,0 L" + this.data.w + ",0 L" + this.data.w + "," + this.data.h + " L0," + this.data.h + "z");
                    var u = createElementID();
                    if (c.setAttribute("id", u),
                    c.appendChild(p),
                    this.globalData.defs.appendChild(c),
                    this.checkMasks()) {
                        var d = createNS("g");
                        d.setAttribute("clip-path", "url(" + getLocationHref() + "#" + u + ")"),
                        d.appendChild(this.layerElement),
                        this.transformedElement = d,
                        r ? r.appendChild(this.transformedElement) : this.baseElement = this.transformedElement
                    } else
                        this.layerElement.setAttribute("clip-path", "url(" + getLocationHref() + "#" + u + ")")
                }
                0 !== this.data.bm && this.setBlendMode()
            },
            renderElement: function() {
                this.finalTransform._matMdf && this.transformedElement.setAttribute("transform", this.finalTransform.mat.to2dCSS()),
                this.finalTransform._opMdf && this.transformedElement.setAttribute("opacity", this.finalTransform.mProp.o.v)
            },
            destroyBaseElement: function() {
                this.layerElement = null,
                this.matteElement = null,
                this.maskManager.destroy()
            },
            getBaseElement: function() {
                return this.data.hd ? null : this.baseElement
            },
            createRenderableComponents: function() {
                this.maskManager = new MaskElement(this.data,this,this.globalData),
                this.renderableEffectsManager = new SVGEffects(this)
            },
            setMatte: function(e) {
                this.matteElement && this.matteElement.setAttribute("mask", "url(" + getLocationHref() + "#" + e + ")")
            }
        },
        HierarchyElement.prototype = {
            initHierarchy: function() {
                this.hierarchy = [],
                this._isParent = !1,
                this.checkParenting()
            },
            setHierarchy: function(e) {
                this.hierarchy = e
            },
            setAsParent: function() {
                this._isParent = !0
            },
            checkParenting: function() {
                void 0 !== this.data.parent && this.comp.buildElementParenting(this, this.data.parent, [])
            }
        },
        extendPrototype([RenderableElement, createProxyFunction({
            initElement: function(e, t, i) {
                this.initFrame(),
                this.initBaseData(e, t, i),
                this.initTransform(e, t, i),
                this.initHierarchy(),
                this.initRenderable(),
                this.initRendererElement(),
                this.createContainerElements(),
                this.createRenderableComponents(),
                this.createContent(),
                this.hide()
            },
            hide: function() {
                this.hidden || this.isInRange && !this.isTransparent || ((this.baseElement || this.layerElement).style.display = "none",
                this.hidden = !0)
            },
            show: function() {
                this.isInRange && !this.isTransparent && (this.data.hd || ((this.baseElement || this.layerElement).style.display = "block"),
                this.hidden = !1,
                this._isFirstFrame = !0)
            },
            renderFrame: function() {
                this.data.hd || this.hidden || (this.renderTransform(),
                this.renderRenderable(),
                this.renderElement(),
                this.renderInnerContent(),
                this._isFirstFrame && (this._isFirstFrame = !1))
            },
            renderInnerContent: function() {},
            prepareFrame: function(e) {
                this._mdf = !1,
                this.prepareRenderableFrame(e),
                this.prepareProperties(e, this.isInRange),
                this.checkTransparency()
            },
            destroy: function() {
                this.innerElem = null,
                this.destroyBaseElement()
            }
        })], RenderableDOMElement),
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, HierarchyElement, FrameElement, RenderableDOMElement], IImageElement),
        IImageElement.prototype.createContent = function() {
            var e = this.globalData.getAssetsPath(this.assetData);
            this.innerElem = createNS("image"),
            this.innerElem.setAttribute("width", this.assetData.w + "px"),
            this.innerElem.setAttribute("height", this.assetData.h + "px"),
            this.innerElem.setAttribute("preserveAspectRatio", this.assetData.pr || this.globalData.renderConfig.imagePreserveAspectRatio),
            this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink", "href", e),
            this.layerElement.appendChild(this.innerElem)
        }
        ,
        IImageElement.prototype.sourceRectAtTime = function() {
            return this.sourceRect
        }
        ,
        IShapeElement.prototype = {
            addShapeToModifiers: function(e) {
                var t, i = this.shapeModifiers.length;
                for (t = 0; t < i; t += 1)
                    this.shapeModifiers[t].addShape(e)
            },
            isShapeInAnimatedModifiers: function(e) {
                for (var t = this.shapeModifiers.length; 0 < t; )
                    if (this.shapeModifiers[0].isAnimatedWithShape(e))
                        return !0;
                return !1
            },
            renderModifiers: function() {
                if (this.shapeModifiers.length) {
                    var e, t = this.shapes.length;
                    for (e = 0; e < t; e += 1)
                        this.shapes[e].sh.reset();
                    for (e = (t = this.shapeModifiers.length) - 1; e >= 0 && !this.shapeModifiers[e].processShapes(this._isFirstFrame); e -= 1)
                        ;
                }
            },
            searchProcessedElement: function(e) {
                for (var t = this.processedElements, i = 0, r = t.length; i < r; ) {
                    if (t[i].elem === e)
                        return t[i].pos;
                    i += 1
                }
                return 0
            },
            addProcessedElement: function(e, t) {
                for (var i = this.processedElements, r = i.length; r; )
                    if (i[r -= 1].elem === e)
                        return void (i[r].pos = t);
                i.push(new ProcessedElement(e,t))
            },
            prepareFrame: function(e) {
                this.prepareRenderableFrame(e),
                this.prepareProperties(e, this.isInRange)
            }
        };
        var lineCapEnum = {
            1: "butt",
            2: "round",
            3: "square"
        }
          , lineJoinEnum = {
            1: "miter",
            2: "round",
            3: "bevel"
        };
        function SVGShapeData(e, t, i) {
            this.caches = [],
            this.styles = [],
            this.transformers = e,
            this.lStr = "",
            this.sh = i,
            this.lvl = t,
            this._isAnimated = !!i.k;
            for (var r = 0, n = e.length; r < n; ) {
                if (e[r].mProps.dynamicProperties.length) {
                    this._isAnimated = !0;
                    break
                }
                r += 1
            }
        }
        function SVGStyleData(e, t) {
            this.data = e,
            this.type = e.ty,
            this.d = "",
            this.lvl = t,
            this._mdf = !1,
            this.closed = !0 === e.hd,
            this.pElem = createNS("path"),
            this.msElem = null
        }
        function DashProperty(e, t, i, r) {
            var n;
            this.elem = e,
            this.frameId = -1,
            this.dataProps = createSizedArray(t.length),
            this.renderer = i,
            this.k = !1,
            this.dashStr = "",
            this.dashArray = createTypedArray("float32", t.length ? t.length - 1 : 0),
            this.dashoffset = createTypedArray("float32", 1),
            this.initDynamicPropertyContainer(r);
            var a, o = t.length || 0;
            for (n = 0; n < o; n += 1)
                a = PropertyFactory.getProp(e, t[n].v, 0, 0, this),
                this.k = a.k || this.k,
                this.dataProps[n] = {
                    n: t[n].n,
                    p: a
                };
            this.k || this.getValue(!0),
            this._isAnimated = this.k
        }
        function SVGStrokeStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.w = PropertyFactory.getProp(e, t.w, 0, null, this),
            this.d = new DashProperty(e,t.d || {},"svg",this),
            this.c = PropertyFactory.getProp(e, t.c, 1, 255, this),
            this.style = i,
            this._isAnimated = !!this._isAnimated
        }
        function SVGFillStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.c = PropertyFactory.getProp(e, t.c, 1, 255, this),
            this.style = i
        }
        function SVGNoStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.style = i
        }
        function GradientProperty(e, t, i) {
            this.data = t,
            this.c = createTypedArray("uint8c", 4 * t.p);
            var r = t.k.k[0].s ? t.k.k[0].s.length - 4 * t.p : t.k.k.length - 4 * t.p;
            this.o = createTypedArray("float32", r),
            this._cmdf = !1,
            this._omdf = !1,
            this._collapsable = this.checkCollapsable(),
            this._hasOpacity = r,
            this.initDynamicPropertyContainer(i),
            this.prop = PropertyFactory.getProp(e, t.k, 1, null, this),
            this.k = this.prop.k,
            this.getValue(!0)
        }
        function SVGGradientFillStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.initGradientData(e, t, i)
        }
        function SVGGradientStrokeStyleData(e, t, i) {
            this.initDynamicPropertyContainer(e),
            this.getValue = this.iterateDynamicProperties,
            this.w = PropertyFactory.getProp(e, t.w, 0, null, this),
            this.d = new DashProperty(e,t.d || {},"svg",this),
            this.initGradientData(e, t, i),
            this._isAnimated = !!this._isAnimated
        }
        function ShapeGroupData() {
            this.it = [],
            this.prevViewData = [],
            this.gr = createNS("g")
        }
        function SVGTransformData(e, t, i) {
            this.transform = {
                mProps: e,
                op: t,
                container: i
            },
            this.elements = [],
            this._isAnimated = this.transform.mProps.dynamicProperties.length || this.transform.op.effectsSequence.length
        }
        SVGShapeData.prototype.setAsAnimated = function() {
            this._isAnimated = !0
        }
        ,
        SVGStyleData.prototype.reset = function() {
            this.d = "",
            this._mdf = !1
        }
        ,
        DashProperty.prototype.getValue = function(e) {
            if ((this.elem.globalData.frameId !== this.frameId || e) && (this.frameId = this.elem.globalData.frameId,
            this.iterateDynamicProperties(),
            this._mdf = this._mdf || e,
            this._mdf)) {
                var t = 0
                  , i = this.dataProps.length;
                for ("svg" === this.renderer && (this.dashStr = ""),
                t = 0; t < i; t += 1)
                    "o" !== this.dataProps[t].n ? "svg" === this.renderer ? this.dashStr += " " + this.dataProps[t].p.v : this.dashArray[t] = this.dataProps[t].p.v : this.dashoffset[0] = this.dataProps[t].p.v
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], DashProperty),
        extendPrototype([DynamicPropertyContainer], SVGStrokeStyleData),
        extendPrototype([DynamicPropertyContainer], SVGFillStyleData),
        extendPrototype([DynamicPropertyContainer], SVGNoStyleData),
        GradientProperty.prototype.comparePoints = function(e, t) {
            for (var i = 0, r = this.o.length / 2; i < r; ) {
                if (Math.abs(e[4 * i] - e[4 * t + 2 * i]) > .01)
                    return !1;
                i += 1
            }
            return !0
        }
        ,
        GradientProperty.prototype.checkCollapsable = function() {
            if (this.o.length / 2 != this.c.length / 4)
                return !1;
            if (this.data.k.k[0].s)
                for (var e = 0, t = this.data.k.k.length; e < t; ) {
                    if (!this.comparePoints(this.data.k.k[e].s, this.data.p))
                        return !1;
                    e += 1
                }
            else if (!this.comparePoints(this.data.k.k, this.data.p))
                return !1;
            return !0
        }
        ,
        GradientProperty.prototype.getValue = function(e) {
            if (this.prop.getValue(),
            this._mdf = !1,
            this._cmdf = !1,
            this._omdf = !1,
            this.prop._mdf || e) {
                var t, i, r, n = 4 * this.data.p;
                for (t = 0; t < n; t += 1)
                    i = t % 4 == 0 ? 100 : 255,
                    r = Math.round(this.prop.v[t] * i),
                    this.c[t] !== r && (this.c[t] = r,
                    this._cmdf = !e);
                if (this.o.length)
                    for (n = this.prop.v.length,
                    t = 4 * this.data.p; t < n; t += 1)
                        i = t % 2 == 0 ? 100 : 1,
                        r = t % 2 == 0 ? Math.round(100 * this.prop.v[t]) : this.prop.v[t],
                        this.o[t - 4 * this.data.p] !== r && (this.o[t - 4 * this.data.p] = r,
                        this._omdf = !e);
                this._mdf = !e
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], GradientProperty),
        SVGGradientFillStyleData.prototype.initGradientData = function(e, t, i) {
            this.o = PropertyFactory.getProp(e, t.o, 0, .01, this),
            this.s = PropertyFactory.getProp(e, t.s, 1, null, this),
            this.e = PropertyFactory.getProp(e, t.e, 1, null, this),
            this.h = PropertyFactory.getProp(e, t.h || {
                k: 0
            }, 0, .01, this),
            this.a = PropertyFactory.getProp(e, t.a || {
                k: 0
            }, 0, degToRads, this),
            this.g = new GradientProperty(e,t.g,this),
            this.style = i,
            this.stops = [],
            this.setGradientData(i.pElem, t),
            this.setGradientOpacity(t, i),
            this._isAnimated = !!this._isAnimated
        }
        ,
        SVGGradientFillStyleData.prototype.setGradientData = function(e, t) {
            var i = createElementID()
              , r = createNS(1 === t.t ? "linearGradient" : "radialGradient");
            r.setAttribute("id", i),
            r.setAttribute("spreadMethod", "pad"),
            r.setAttribute("gradientUnits", "userSpaceOnUse");
            var n, a, o, s = [];
            for (o = 4 * t.g.p,
            a = 0; a < o; a += 4)
                n = createNS("stop"),
                r.appendChild(n),
                s.push(n);
            e.setAttribute("gf" === t.ty ? "fill" : "stroke", "url(" + getLocationHref() + "#" + i + ")"),
            this.gf = r,
            this.cst = s
        }
        ,
        SVGGradientFillStyleData.prototype.setGradientOpacity = function(e, t) {
            if (this.g._hasOpacity && !this.g._collapsable) {
                var i, r, n, a = createNS("mask"), o = createNS("path");
                a.appendChild(o);
                var s = createElementID()
                  , l = createElementID();
                a.setAttribute("id", l);
                var h = createNS(1 === e.t ? "linearGradient" : "radialGradient");
                h.setAttribute("id", s),
                h.setAttribute("spreadMethod", "pad"),
                h.setAttribute("gradientUnits", "userSpaceOnUse"),
                n = e.g.k.k[0].s ? e.g.k.k[0].s.length : e.g.k.k.length;
                var c = this.stops;
                for (r = 4 * e.g.p; r < n; r += 2)
                    (i = createNS("stop")).setAttribute("stop-color", "rgb(255,255,255)"),
                    h.appendChild(i),
                    c.push(i);
                o.setAttribute("gf" === e.ty ? "fill" : "stroke", "url(" + getLocationHref() + "#" + s + ")"),
                "gs" === e.ty && (o.setAttribute("stroke-linecap", lineCapEnum[e.lc || 2]),
                o.setAttribute("stroke-linejoin", lineJoinEnum[e.lj || 2]),
                1 === e.lj && o.setAttribute("stroke-miterlimit", e.ml)),
                this.of = h,
                this.ms = a,
                this.ost = c,
                this.maskId = l,
                t.msElem = o
            }
        }
        ,
        extendPrototype([DynamicPropertyContainer], SVGGradientFillStyleData),
        extendPrototype([SVGGradientFillStyleData, DynamicPropertyContainer], SVGGradientStrokeStyleData);
        var buildShapeString = function(e, t, i, r) {
            if (0 === t)
                return "";
            var n, a = e.o, o = e.i, s = e.v, l = " M" + r.applyToPointStringified(s[0][0], s[0][1]);
            for (n = 1; n < t; n += 1)
                l += " C" + r.applyToPointStringified(a[n - 1][0], a[n - 1][1]) + " " + r.applyToPointStringified(o[n][0], o[n][1]) + " " + r.applyToPointStringified(s[n][0], s[n][1]);
            return i && t && (l += " C" + r.applyToPointStringified(a[n - 1][0], a[n - 1][1]) + " " + r.applyToPointStringified(o[0][0], o[0][1]) + " " + r.applyToPointStringified(s[0][0], s[0][1]),
            l += "z"),
            l
        }
          , SVGElementsRenderer = function() {
            var e = new Matrix
              , t = new Matrix;
            function i(e, t, i) {
                (i || t.transform.op._mdf) && t.transform.container.setAttribute("opacity", t.transform.op.v),
                (i || t.transform.mProps._mdf) && t.transform.container.setAttribute("transform", t.transform.mProps.v.to2dCSS())
            }
            function r() {}
            function n(i, r, n) {
                var a, o, s, l, h, c, p, u, d, f, m, g = r.styles.length, v = r.lvl;
                for (c = 0; c < g; c += 1) {
                    if (l = r.sh._mdf || n,
                    r.styles[c].lvl < v) {
                        for (u = t.reset(),
                        f = v - r.styles[c].lvl,
                        m = r.transformers.length - 1; !l && f > 0; )
                            l = r.transformers[m].mProps._mdf || l,
                            f -= 1,
                            m -= 1;
                        if (l)
                            for (f = v - r.styles[c].lvl,
                            m = r.transformers.length - 1; f > 0; )
                                d = r.transformers[m].mProps.v.props,
                                u.transform(d[0], d[1], d[2], d[3], d[4], d[5], d[6], d[7], d[8], d[9], d[10], d[11], d[12], d[13], d[14], d[15]),
                                f -= 1,
                                m -= 1
                    } else
                        u = e;
                    if (o = (p = r.sh.paths)._length,
                    l) {
                        for (s = "",
                        a = 0; a < o; a += 1)
                            (h = p.shapes[a]) && h._length && (s += buildShapeString(h, h._length, h.c, u));
                        r.caches[c] = s
                    } else
                        s = r.caches[c];
                    r.styles[c].d += !0 === i.hd ? "" : s,
                    r.styles[c]._mdf = l || r.styles[c]._mdf
                }
            }
            function a(e, t, i) {
                var r = t.style;
                (t.c._mdf || i) && r.pElem.setAttribute("fill", "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
                (t.o._mdf || i) && r.pElem.setAttribute("fill-opacity", t.o.v)
            }
            function o(e, t, i) {
                s(e, t, i),
                l(0, t, i)
            }
            function s(e, t, i) {
                var r, n, a, o, s, l = t.gf, h = t.g._hasOpacity, c = t.s.v, p = t.e.v;
                if (t.o._mdf || i) {
                    var u = "gf" === e.ty ? "fill-opacity" : "stroke-opacity";
                    t.style.pElem.setAttribute(u, t.o.v)
                }
                if (t.s._mdf || i) {
                    var d = 1 === e.t ? "x1" : "cx"
                      , f = "x1" === d ? "y1" : "cy";
                    l.setAttribute(d, c[0]),
                    l.setAttribute(f, c[1]),
                    h && !t.g._collapsable && (t.of.setAttribute(d, c[0]),
                    t.of.setAttribute(f, c[1]))
                }
                if (t.g._cmdf || i) {
                    r = t.cst;
                    var m = t.g.c;
                    for (a = r.length,
                    n = 0; n < a; n += 1)
                        (o = r[n]).setAttribute("offset", m[4 * n] + "%"),
                        o.setAttribute("stop-color", "rgb(" + m[4 * n + 1] + "," + m[4 * n + 2] + "," + m[4 * n + 3] + ")")
                }
                if (h && (t.g._omdf || i)) {
                    var g = t.g.o;
                    for (a = (r = t.g._collapsable ? t.cst : t.ost).length,
                    n = 0; n < a; n += 1)
                        o = r[n],
                        t.g._collapsable || o.setAttribute("offset", g[2 * n] + "%"),
                        o.setAttribute("stop-opacity", g[2 * n + 1])
                }
                if (1 === e.t)
                    (t.e._mdf || i) && (l.setAttribute("x2", p[0]),
                    l.setAttribute("y2", p[1]),
                    h && !t.g._collapsable && (t.of.setAttribute("x2", p[0]),
                    t.of.setAttribute("y2", p[1])));
                else if ((t.s._mdf || t.e._mdf || i) && (s = Math.sqrt(Math.pow(c[0] - p[0], 2) + Math.pow(c[1] - p[1], 2)),
                l.setAttribute("r", s),
                h && !t.g._collapsable && t.of.setAttribute("r", s)),
                t.e._mdf || t.h._mdf || t.a._mdf || i) {
                    s || (s = Math.sqrt(Math.pow(c[0] - p[0], 2) + Math.pow(c[1] - p[1], 2)));
                    var v = Math.atan2(p[1] - c[1], p[0] - c[0])
                      , y = t.h.v;
                    y >= 1 ? y = .99 : y <= -1 && (y = -.99);
                    var _ = s * y
                      , b = Math.cos(v + t.a.v) * _ + c[0]
                      , x = Math.sin(v + t.a.v) * _ + c[1];
                    l.setAttribute("fx", b),
                    l.setAttribute("fy", x),
                    h && !t.g._collapsable && (t.of.setAttribute("fx", b),
                    t.of.setAttribute("fy", x))
                }
            }
            function l(e, t, i) {
                var r = t.style
                  , n = t.d;
                n && (n._mdf || i) && n.dashStr && (r.pElem.setAttribute("stroke-dasharray", n.dashStr),
                r.pElem.setAttribute("stroke-dashoffset", n.dashoffset[0])),
                t.c && (t.c._mdf || i) && r.pElem.setAttribute("stroke", "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
                (t.o._mdf || i) && r.pElem.setAttribute("stroke-opacity", t.o.v),
                (t.w._mdf || i) && (r.pElem.setAttribute("stroke-width", t.w.v),
                r.msElem && r.msElem.setAttribute("stroke-width", t.w.v))
            }
            return {
                createRenderFunction: function(e) {
                    switch (e.ty) {
                    case "fl":
                        return a;
                    case "gf":
                        return s;
                    case "gs":
                        return o;
                    case "st":
                        return l;
                    case "sh":
                    case "el":
                    case "rc":
                    case "sr":
                        return n;
                    case "tr":
                        return i;
                    case "no":
                        return r;
                    default:
                        return null
                    }
                }
            }
        }();
        function SVGShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.shapeModifiers = [],
            this.itemsData = [],
            this.processedElements = [],
            this.animatedContents = [],
            this.initElement(e, t, i),
            this.prevViewData = []
        }
        function LetterProps(e, t, i, r, n, a) {
            this.o = e,
            this.sw = t,
            this.sc = i,
            this.fc = r,
            this.m = n,
            this.p = a,
            this._mdf = {
                o: !0,
                sw: !!t,
                sc: !!i,
                fc: !!r,
                m: !0,
                p: !0
            }
        }
        function TextProperty(e, t) {
            this._frameId = initialDefaultFrame,
            this.pv = "",
            this.v = "",
            this.kf = !1,
            this._isFirstFrame = !0,
            this._mdf = !1,
            this.data = t,
            this.elem = e,
            this.comp = this.elem.comp,
            this.keysIndex = 0,
            this.canResize = !1,
            this.minimumFontSize = 1,
            this.effectsSequence = [],
            this.currentData = {
                ascent: 0,
                boxWidth: this.defaultBoxWidth,
                f: "",
                fStyle: "",
                fWeight: "",
                fc: "",
                j: "",
                justifyOffset: "",
                l: [],
                lh: 0,
                lineWidths: [],
                ls: "",
                of: "",
                s: "",
                sc: "",
                sw: 0,
                t: 0,
                tr: 0,
                sz: 0,
                ps: null,
                fillColorAnim: !1,
                strokeColorAnim: !1,
                strokeWidthAnim: !1,
                yOffset: 0,
                finalSize: 0,
                finalText: [],
                finalLineHeight: 0,
                __complete: !1
            },
            this.copyData(this.currentData, this.data.d.k[0].s),
            this.searchProperty() || this.completeTextData(this.currentData)
        }
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, IShapeElement, HierarchyElement, FrameElement, RenderableDOMElement], SVGShapeElement),
        SVGShapeElement.prototype.initSecondaryElement = function() {}
        ,
        SVGShapeElement.prototype.identityMatrix = new Matrix,
        SVGShapeElement.prototype.buildExpressionInterface = function() {}
        ,
        SVGShapeElement.prototype.createContent = function() {
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.layerElement, 0, [], !0),
            this.filterUniqueShapes()
        }
        ,
        SVGShapeElement.prototype.filterUniqueShapes = function() {
            var e, t, i, r, n = this.shapes.length, a = this.stylesList.length, o = [], s = !1;
            for (i = 0; i < a; i += 1) {
                for (r = this.stylesList[i],
                s = !1,
                o.length = 0,
                e = 0; e < n; e += 1)
                    -1 !== (t = this.shapes[e]).styles.indexOf(r) && (o.push(t),
                    s = t._isAnimated || s);
                o.length > 1 && s && this.setShapesAsAnimated(o)
            }
        }
        ,
        SVGShapeElement.prototype.setShapesAsAnimated = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t].setAsAnimated()
        }
        ,
        SVGShapeElement.prototype.createStyleElement = function(e, t) {
            var i, r = new SVGStyleData(e,t), n = r.pElem;
            return "st" === e.ty ? i = new SVGStrokeStyleData(this,e,r) : "fl" === e.ty ? i = new SVGFillStyleData(this,e,r) : "gf" === e.ty || "gs" === e.ty ? (i = new ("gf" === e.ty ? SVGGradientFillStyleData : SVGGradientStrokeStyleData)(this,e,r),
            this.globalData.defs.appendChild(i.gf),
            i.maskId && (this.globalData.defs.appendChild(i.ms),
            this.globalData.defs.appendChild(i.of),
            n.setAttribute("mask", "url(" + getLocationHref() + "#" + i.maskId + ")"))) : "no" === e.ty && (i = new SVGNoStyleData(this,e,r)),
            "st" !== e.ty && "gs" !== e.ty || (n.setAttribute("stroke-linecap", lineCapEnum[e.lc || 2]),
            n.setAttribute("stroke-linejoin", lineJoinEnum[e.lj || 2]),
            n.setAttribute("fill-opacity", "0"),
            1 === e.lj && n.setAttribute("stroke-miterlimit", e.ml)),
            2 === e.r && n.setAttribute("fill-rule", "evenodd"),
            e.ln && n.setAttribute("id", e.ln),
            e.cl && n.setAttribute("class", e.cl),
            e.bm && (n.style["mix-blend-mode"] = getBlendMode(e.bm)),
            this.stylesList.push(r),
            this.addToAnimatedContents(e, i),
            i
        }
        ,
        SVGShapeElement.prototype.createGroupElement = function(e) {
            var t = new ShapeGroupData;
            return e.ln && t.gr.setAttribute("id", e.ln),
            e.cl && t.gr.setAttribute("class", e.cl),
            e.bm && (t.gr.style["mix-blend-mode"] = getBlendMode(e.bm)),
            t
        }
        ,
        SVGShapeElement.prototype.createTransformElement = function(e, t) {
            var i = TransformPropertyFactory.getTransformProperty(this, e, this)
              , r = new SVGTransformData(i,i.o,t);
            return this.addToAnimatedContents(e, r),
            r
        }
        ,
        SVGShapeElement.prototype.createShapeElement = function(e, t, i) {
            var r = 4;
            "rc" === e.ty ? r = 5 : "el" === e.ty ? r = 6 : "sr" === e.ty && (r = 7);
            var n = new SVGShapeData(t,i,ShapePropertyFactory.getShapeProp(this, e, r, this));
            return this.shapes.push(n),
            this.addShapeToModifiers(n),
            this.addToAnimatedContents(e, n),
            n
        }
        ,
        SVGShapeElement.prototype.addToAnimatedContents = function(e, t) {
            for (var i = 0, r = this.animatedContents.length; i < r; ) {
                if (this.animatedContents[i].element === t)
                    return;
                i += 1
            }
            this.animatedContents.push({
                fn: SVGElementsRenderer.createRenderFunction(e),
                element: t,
                data: e
            })
        }
        ,
        SVGShapeElement.prototype.setElementStyles = function(e) {
            var t, i = e.styles, r = this.stylesList.length;
            for (t = 0; t < r; t += 1)
                this.stylesList[t].closed || i.push(this.stylesList[t])
        }
        ,
        SVGShapeElement.prototype.reloadShapes = function() {
            var e;
            this._isFirstFrame = !0;
            var t = this.itemsData.length;
            for (e = 0; e < t; e += 1)
                this.prevViewData[e] = this.itemsData[e];
            for (this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.layerElement, 0, [], !0),
            this.filterUniqueShapes(),
            t = this.dynamicProperties.length,
            e = 0; e < t; e += 1)
                this.dynamicProperties[e].getValue();
            this.renderModifiers()
        }
        ,
        SVGShapeElement.prototype.searchShapes = function(e, t, i, r, n, a, o) {
            var s, l, h, c, p, u, d = [].concat(a), f = e.length - 1, m = [], g = [];
            for (s = f; s >= 0; s -= 1) {
                if ((u = this.searchProcessedElement(e[s])) ? t[s] = i[u - 1] : e[s]._render = o,
                "fl" === e[s].ty || "st" === e[s].ty || "gf" === e[s].ty || "gs" === e[s].ty || "no" === e[s].ty)
                    u ? t[s].style.closed = !1 : t[s] = this.createStyleElement(e[s], n),
                    e[s]._render && t[s].style.pElem.parentNode !== r && r.appendChild(t[s].style.pElem),
                    m.push(t[s].style);
                else if ("gr" === e[s].ty) {
                    if (u)
                        for (h = t[s].it.length,
                        l = 0; l < h; l += 1)
                            t[s].prevViewData[l] = t[s].it[l];
                    else
                        t[s] = this.createGroupElement(e[s]);
                    this.searchShapes(e[s].it, t[s].it, t[s].prevViewData, t[s].gr, n + 1, d, o),
                    e[s]._render && t[s].gr.parentNode !== r && r.appendChild(t[s].gr)
                } else
                    "tr" === e[s].ty ? (u || (t[s] = this.createTransformElement(e[s], r)),
                    c = t[s].transform,
                    d.push(c)) : "sh" === e[s].ty || "rc" === e[s].ty || "el" === e[s].ty || "sr" === e[s].ty ? (u || (t[s] = this.createShapeElement(e[s], d, n)),
                    this.setElementStyles(t[s])) : "tm" === e[s].ty || "rd" === e[s].ty || "ms" === e[s].ty || "pb" === e[s].ty ? (u ? (p = t[s]).closed = !1 : ((p = ShapeModifiers.getModifier(e[s].ty)).init(this, e[s]),
                    t[s] = p,
                    this.shapeModifiers.push(p)),
                    g.push(p)) : "rp" === e[s].ty && (u ? (p = t[s]).closed = !0 : (p = ShapeModifiers.getModifier(e[s].ty),
                    t[s] = p,
                    p.init(this, e, s, t),
                    this.shapeModifiers.push(p),
                    o = !1),
                    g.push(p));
                this.addProcessedElement(e[s], s + 1)
            }
            for (f = m.length,
            s = 0; s < f; s += 1)
                m[s].closed = !0;
            for (f = g.length,
            s = 0; s < f; s += 1)
                g[s].closed = !0
        }
        ,
        SVGShapeElement.prototype.renderInnerContent = function() {
            var e;
            this.renderModifiers();
            var t = this.stylesList.length;
            for (e = 0; e < t; e += 1)
                this.stylesList[e].reset();
            for (this.renderShape(),
            e = 0; e < t; e += 1)
                (this.stylesList[e]._mdf || this._isFirstFrame) && (this.stylesList[e].msElem && (this.stylesList[e].msElem.setAttribute("d", this.stylesList[e].d),
                this.stylesList[e].d = "M0 0" + this.stylesList[e].d),
                this.stylesList[e].pElem.setAttribute("d", this.stylesList[e].d || "M0 0"))
        }
        ,
        SVGShapeElement.prototype.renderShape = function() {
            var e, t, i = this.animatedContents.length;
            for (e = 0; e < i; e += 1)
                t = this.animatedContents[e],
                (this._isFirstFrame || t.element._isAnimated) && !0 !== t.data && t.fn(t.data, t.element, this._isFirstFrame)
        }
        ,
        SVGShapeElement.prototype.destroy = function() {
            this.destroyBaseElement(),
            this.shapesData = null,
            this.itemsData = null
        }
        ,
        LetterProps.prototype.update = function(e, t, i, r, n, a) {
            this._mdf.o = !1,
            this._mdf.sw = !1,
            this._mdf.sc = !1,
            this._mdf.fc = !1,
            this._mdf.m = !1,
            this._mdf.p = !1;
            var o = !1;
            return this.o !== e && (this.o = e,
            this._mdf.o = !0,
            o = !0),
            this.sw !== t && (this.sw = t,
            this._mdf.sw = !0,
            o = !0),
            this.sc !== i && (this.sc = i,
            this._mdf.sc = !0,
            o = !0),
            this.fc !== r && (this.fc = r,
            this._mdf.fc = !0,
            o = !0),
            this.m !== n && (this.m = n,
            this._mdf.m = !0,
            o = !0),
            !a.length || this.p[0] === a[0] && this.p[1] === a[1] && this.p[4] === a[4] && this.p[5] === a[5] && this.p[12] === a[12] && this.p[13] === a[13] || (this.p = a,
            this._mdf.p = !0,
            o = !0),
            o
        }
        ,
        TextProperty.prototype.defaultBoxWidth = [0, 0],
        TextProperty.prototype.copyData = function(e, t) {
            for (var i in t)
                Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]);
            return e
        }
        ,
        TextProperty.prototype.setCurrentData = function(e) {
            e.__complete || this.completeTextData(e),
            this.currentData = e,
            this.currentData.boxWidth = this.currentData.boxWidth || this.defaultBoxWidth,
            this._mdf = !0
        }
        ,
        TextProperty.prototype.searchProperty = function() {
            return this.searchKeyframes()
        }
        ,
        TextProperty.prototype.searchKeyframes = function() {
            return this.kf = this.data.d.k.length > 1,
            this.kf && this.addEffect(this.getKeyframeValue.bind(this)),
            this.kf
        }
        ,
        TextProperty.prototype.addEffect = function(e) {
            this.effectsSequence.push(e),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.getValue = function(e) {
            if (this.elem.globalData.frameId !== this.frameId && this.effectsSequence.length || e) {
                this.currentData.t = this.data.d.k[this.keysIndex].s.t;
                var t = this.currentData
                  , i = this.keysIndex;
                if (this.lock)
                    this.setCurrentData(this.currentData);
                else {
                    var r;
                    this.lock = !0,
                    this._mdf = !1;
                    var n = this.effectsSequence.length
                      , a = e || this.data.d.k[this.keysIndex].s;
                    for (r = 0; r < n; r += 1)
                        a = i !== this.keysIndex ? this.effectsSequence[r](a, a.t) : this.effectsSequence[r](this.currentData, a.t);
                    t !== a && this.setCurrentData(a),
                    this.v = this.currentData,
                    this.pv = this.v,
                    this.lock = !1,
                    this.frameId = this.elem.globalData.frameId
                }
            }
        }
        ,
        TextProperty.prototype.getKeyframeValue = function() {
            for (var e = this.data.d.k, t = this.elem.comp.renderedFrame, i = 0, r = e.length; i <= r - 1 && !(i === r - 1 || e[i + 1].t > t); )
                i += 1;
            return this.keysIndex !== i && (this.keysIndex = i),
            this.data.d.k[this.keysIndex].s
        }
        ,
        TextProperty.prototype.buildFinalText = function(e) {
            for (var t, i, r = [], n = 0, a = e.length, o = !1; n < a; )
                t = e.charCodeAt(n),
                FontManager.isCombinedCharacter(t) ? r[r.length - 1] += e.charAt(n) : t >= 55296 && t <= 56319 ? (i = e.charCodeAt(n + 1)) >= 56320 && i <= 57343 ? (o || FontManager.isModifier(t, i) ? (r[r.length - 1] += e.substr(n, 2),
                o = !1) : r.push(e.substr(n, 2)),
                n += 1) : r.push(e.charAt(n)) : t > 56319 ? (i = e.charCodeAt(n + 1),
                FontManager.isZeroWidthJoiner(t, i) ? (o = !0,
                r[r.length - 1] += e.substr(n, 2),
                n += 1) : r.push(e.charAt(n))) : FontManager.isZeroWidthJoiner(t) ? (r[r.length - 1] += e.charAt(n),
                o = !0) : r.push(e.charAt(n)),
                n += 1;
            return r
        }
        ,
        TextProperty.prototype.completeTextData = function(e) {
            e.__complete = !0;
            var t, i, r, n, a, o, s, l = this.elem.globalData.fontManager, h = this.data, c = [], p = 0, u = h.m.g, d = 0, f = 0, m = 0, g = [], v = 0, y = 0, _ = l.getFontByName(e.f), b = 0, x = getFontProperties(_);
            e.fWeight = x.weight,
            e.fStyle = x.style,
            e.finalSize = e.s,
            e.finalText = this.buildFinalText(e.t),
            i = e.finalText.length,
            e.finalLineHeight = e.lh;
            var w, S = e.tr / 1e3 * e.finalSize;
            if (e.sz)
                for (var T, k, E = !0, M = e.sz[0], P = e.sz[1]; E; ) {
                    T = 0,
                    v = 0,
                    i = (k = this.buildFinalText(e.t)).length,
                    S = e.tr / 1e3 * e.finalSize;
                    var C = -1;
                    for (t = 0; t < i; t += 1)
                        w = k[t].charCodeAt(0),
                        r = !1,
                        " " === k[t] ? C = t : 13 !== w && 3 !== w || (v = 0,
                        r = !0,
                        T += e.finalLineHeight || 1.2 * e.finalSize),
                        l.chars ? (s = l.getCharData(k[t], _.fStyle, _.fFamily),
                        b = r ? 0 : s.w * e.finalSize / 100) : b = l.measureText(k[t], e.f, e.finalSize),
                        v + b > M && " " !== k[t] ? (-1 === C ? i += 1 : t = C,
                        T += e.finalLineHeight || 1.2 * e.finalSize,
                        k.splice(t, C === t ? 1 : 0, "\r"),
                        C = -1,
                        v = 0) : (v += b,
                        v += S);
                    T += _.ascent * e.finalSize / 100,
                    this.canResize && e.finalSize > this.minimumFontSize && P < T ? (e.finalSize -= 1,
                    e.finalLineHeight = e.finalSize * e.lh / e.s) : (e.finalText = k,
                    i = e.finalText.length,
                    E = !1)
                }
            v = -S,
            b = 0;
            var A, L = 0;
            for (t = 0; t < i; t += 1)
                if (r = !1,
                13 === (w = (A = e.finalText[t]).charCodeAt(0)) || 3 === w ? (L = 0,
                g.push(v),
                y = v > y ? v : y,
                v = -2 * S,
                n = "",
                r = !0,
                m += 1) : n = A,
                l.chars ? (s = l.getCharData(A, _.fStyle, l.getFontByName(e.f).fFamily),
                b = r ? 0 : s.w * e.finalSize / 100) : b = l.measureText(n, e.f, e.finalSize),
                " " === A ? L += b + S : (v += b + S + L,
                L = 0),
                c.push({
                    l: b,
                    an: b,
                    add: d,
                    n: r,
                    anIndexes: [],
                    val: n,
                    line: m,
                    animatorJustifyOffset: 0
                }),
                2 == u) {
                    if (d += b,
                    "" === n || " " === n || t === i - 1) {
                        for ("" !== n && " " !== n || (d -= b); f <= t; )
                            c[f].an = d,
                            c[f].ind = p,
                            c[f].extra = b,
                            f += 1;
                        p += 1,
                        d = 0
                    }
                } else if (3 == u) {
                    if (d += b,
                    "" === n || t === i - 1) {
                        for ("" === n && (d -= b); f <= t; )
                            c[f].an = d,
                            c[f].ind = p,
                            c[f].extra = b,
                            f += 1;
                        d = 0,
                        p += 1
                    }
                } else
                    c[p].ind = p,
                    c[p].extra = 0,
                    p += 1;
            if (e.l = c,
            y = v > y ? v : y,
            g.push(v),
            e.sz)
                e.boxWidth = e.sz[0],
                e.justifyOffset = 0;
            else
                switch (e.boxWidth = y,
                e.j) {
                case 1:
                    e.justifyOffset = -e.boxWidth;
                    break;
                case 2:
                    e.justifyOffset = -e.boxWidth / 2;
                    break;
                default:
                    e.justifyOffset = 0
                }
            e.lineWidths = g;
            var D, I, R, F, B = h.a;
            o = B.length;
            var O = [];
            for (a = 0; a < o; a += 1) {
                for ((D = B[a]).a.sc && (e.strokeColorAnim = !0),
                D.a.sw && (e.strokeWidthAnim = !0),
                (D.a.fc || D.a.fh || D.a.fs || D.a.fb) && (e.fillColorAnim = !0),
                F = 0,
                R = D.s.b,
                t = 0; t < i; t += 1)
                    (I = c[t]).anIndexes[a] = F,
                    (1 == R && "" !== I.val || 2 == R && "" !== I.val && " " !== I.val || 3 == R && (I.n || " " == I.val || t == i - 1) || 4 == R && (I.n || t == i - 1)) && (1 === D.s.rn && O.push(F),
                    F += 1);
                h.a[a].s.totalChars = F;
                var N, V = -1;
                if (1 === D.s.rn)
                    for (t = 0; t < i; t += 1)
                        V != (I = c[t]).anIndexes[a] && (V = I.anIndexes[a],
                        N = O.splice(Math.floor(Math.random() * O.length), 1)[0]),
                        I.anIndexes[a] = N
            }
            e.yOffset = e.finalLineHeight || 1.2 * e.finalSize,
            e.ls = e.ls || 0,
            e.ascent = _.ascent * e.finalSize / 100
        }
        ,
        TextProperty.prototype.updateDocumentData = function(e, t) {
            t = void 0 === t ? this.keysIndex : t;
            var i = this.copyData({}, this.data.d.k[t].s);
            i = this.copyData(i, e),
            this.data.d.k[t].s = i,
            this.recalculate(t),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.recalculate = function(e) {
            var t = this.data.d.k[e].s;
            t.__complete = !1,
            this.keysIndex = 0,
            this._isFirstFrame = !0,
            this.getValue(t)
        }
        ,
        TextProperty.prototype.canResizeFont = function(e) {
            this.canResize = e,
            this.recalculate(this.keysIndex),
            this.elem.addDynamicProperty(this)
        }
        ,
        TextProperty.prototype.setMinimumFontSize = function(e) {
            this.minimumFontSize = Math.floor(e) || 1,
            this.recalculate(this.keysIndex),
            this.elem.addDynamicProperty(this)
        }
        ;
        var TextSelectorProp = function() {
            var e = Math.max
              , t = Math.min
              , i = Math.floor;
            function r(e, t) {
                this._currentTextLength = -1,
                this.k = !1,
                this.data = t,
                this.elem = e,
                this.comp = e.comp,
                this.finalS = 0,
                this.finalE = 0,
                this.initDynamicPropertyContainer(e),
                this.s = PropertyFactory.getProp(e, t.s || {
                    k: 0
                }, 0, 0, this),
                this.e = "e"in t ? PropertyFactory.getProp(e, t.e, 0, 0, this) : {
                    v: 100
                },
                this.o = PropertyFactory.getProp(e, t.o || {
                    k: 0
                }, 0, 0, this),
                this.xe = PropertyFactory.getProp(e, t.xe || {
                    k: 0
                }, 0, 0, this),
                this.ne = PropertyFactory.getProp(e, t.ne || {
                    k: 0
                }, 0, 0, this),
                this.sm = PropertyFactory.getProp(e, t.sm || {
                    k: 100
                }, 0, 0, this),
                this.a = PropertyFactory.getProp(e, t.a, 0, .01, this),
                this.dynamicProperties.length || this.getValue()
            }
            return r.prototype = {
                getMult: function(r) {
                    this._currentTextLength !== this.elem.textProperty.currentData.l.length && this.getValue();
                    var n = 0
                      , a = 0
                      , o = 1
                      , s = 1;
                    this.ne.v > 0 ? n = this.ne.v / 100 : a = -this.ne.v / 100,
                    this.xe.v > 0 ? o = 1 - this.xe.v / 100 : s = 1 + this.xe.v / 100;
                    var l = BezierFactory.getBezierEasing(n, a, o, s).get
                      , h = 0
                      , c = this.finalS
                      , p = this.finalE
                      , u = this.data.sh;
                    if (2 === u)
                        h = l(h = p === c ? r >= p ? 1 : 0 : e(0, t(.5 / (p - c) + (r - c) / (p - c), 1)));
                    else if (3 === u)
                        h = l(h = p === c ? r >= p ? 0 : 1 : 1 - e(0, t(.5 / (p - c) + (r - c) / (p - c), 1)));
                    else if (4 === u)
                        p === c ? h = 0 : (h = e(0, t(.5 / (p - c) + (r - c) / (p - c), 1))) < .5 ? h *= 2 : h = 1 - 2 * (h - .5),
                        h = l(h);
                    else if (5 === u) {
                        if (p === c)
                            h = 0;
                        else {
                            var d = p - c
                              , f = -d / 2 + (r = t(e(0, r + .5 - c), p - c))
                              , m = d / 2;
                            h = Math.sqrt(1 - f * f / (m * m))
                        }
                        h = l(h)
                    } else
                        6 === u ? (p === c ? h = 0 : (r = t(e(0, r + .5 - c), p - c),
                        h = (1 + Math.cos(Math.PI + 2 * Math.PI * r / (p - c))) / 2),
                        h = l(h)) : (r >= i(c) && (h = e(0, t(r - c < 0 ? t(p, 1) - (c - r) : p - r, 1))),
                        h = l(h));
                    if (100 !== this.sm.v) {
                        var g = .01 * this.sm.v;
                        0 === g && (g = 1e-8);
                        var v = .5 - .5 * g;
                        h < v ? h = 0 : (h = (h - v) / g) > 1 && (h = 1)
                    }
                    return h * this.a.v
                },
                getValue: function(e) {
                    this.iterateDynamicProperties(),
                    this._mdf = e || this._mdf,
                    this._currentTextLength = this.elem.textProperty.currentData.l.length || 0,
                    e && 2 === this.data.r && (this.e.v = this._currentTextLength);
                    var t = 2 === this.data.r ? 1 : 100 / this.data.totalChars
                      , i = this.o.v / t
                      , r = this.s.v / t + i
                      , n = this.e.v / t + i;
                    if (r > n) {
                        var a = r;
                        r = n,
                        n = a
                    }
                    this.finalS = r,
                    this.finalE = n
                }
            },
            extendPrototype([DynamicPropertyContainer], r),
            {
                getTextSelectorProp: function(e, t, i) {
                    return new r(e,t)
                }
            }
        }();
        function TextAnimatorDataProperty(e, t, i) {
            var r = {
                propType: !1
            }
              , n = PropertyFactory.getProp
              , a = t.a;
            this.a = {
                r: a.r ? n(e, a.r, 0, degToRads, i) : r,
                rx: a.rx ? n(e, a.rx, 0, degToRads, i) : r,
                ry: a.ry ? n(e, a.ry, 0, degToRads, i) : r,
                sk: a.sk ? n(e, a.sk, 0, degToRads, i) : r,
                sa: a.sa ? n(e, a.sa, 0, degToRads, i) : r,
                s: a.s ? n(e, a.s, 1, .01, i) : r,
                a: a.a ? n(e, a.a, 1, 0, i) : r,
                o: a.o ? n(e, a.o, 0, .01, i) : r,
                p: a.p ? n(e, a.p, 1, 0, i) : r,
                sw: a.sw ? n(e, a.sw, 0, 0, i) : r,
                sc: a.sc ? n(e, a.sc, 1, 0, i) : r,
                fc: a.fc ? n(e, a.fc, 1, 0, i) : r,
                fh: a.fh ? n(e, a.fh, 0, 0, i) : r,
                fs: a.fs ? n(e, a.fs, 0, .01, i) : r,
                fb: a.fb ? n(e, a.fb, 0, .01, i) : r,
                t: a.t ? n(e, a.t, 0, 0, i) : r
            },
            this.s = TextSelectorProp.getTextSelectorProp(e, t.s, i),
            this.s.t = t.s.t
        }
        function TextAnimatorProperty(e, t, i) {
            this._isFirstFrame = !0,
            this._hasMaskedPath = !1,
            this._frameId = -1,
            this._textData = e,
            this._renderType = t,
            this._elem = i,
            this._animatorsData = createSizedArray(this._textData.a.length),
            this._pathData = {},
            this._moreOptions = {
                alignment: {}
            },
            this.renderedLetters = [],
            this.lettersChangedFlag = !1,
            this.initDynamicPropertyContainer(i)
        }
        function ITextElement() {}
        TextAnimatorProperty.prototype.searchProperties = function() {
            var e, t, i = this._textData.a.length, r = PropertyFactory.getProp;
            for (e = 0; e < i; e += 1)
                t = this._textData.a[e],
                this._animatorsData[e] = new TextAnimatorDataProperty(this._elem,t,this);
            this._textData.p && "m"in this._textData.p ? (this._pathData = {
                a: r(this._elem, this._textData.p.a, 0, 0, this),
                f: r(this._elem, this._textData.p.f, 0, 0, this),
                l: r(this._elem, this._textData.p.l, 0, 0, this),
                r: r(this._elem, this._textData.p.r, 0, 0, this),
                p: r(this._elem, this._textData.p.p, 0, 0, this),
                m: this._elem.maskManager.getMaskProperty(this._textData.p.m)
            },
            this._hasMaskedPath = !0) : this._hasMaskedPath = !1,
            this._moreOptions.alignment = r(this._elem, this._textData.m.a, 1, 0, this)
        }
        ,
        TextAnimatorProperty.prototype.getMeasures = function(e, t) {
            if (this.lettersChangedFlag = t,
            this._mdf || this._isFirstFrame || t || this._hasMaskedPath && this._pathData.m._mdf) {
                this._isFirstFrame = !1;
                var i, r, n, a, o, s, l, h, c, p, u, d, f, m, g, v, y, _, b, x = this._moreOptions.alignment.v, w = this._animatorsData, S = this._textData, T = this.mHelper, k = this._renderType, E = this.renderedLetters.length, M = e.l;
                if (this._hasMaskedPath) {
                    if (b = this._pathData.m,
                    !this._pathData.n || this._pathData._mdf) {
                        var P, C = b.v;
                        for (this._pathData.r.v && (C = C.reverse()),
                        o = {
                            tLength: 0,
                            segments: []
                        },
                        a = C._length - 1,
                        v = 0,
                        n = 0; n < a; n += 1)
                            P = bez.buildBezierData(C.v[n], C.v[n + 1], [C.o[n][0] - C.v[n][0], C.o[n][1] - C.v[n][1]], [C.i[n + 1][0] - C.v[n + 1][0], C.i[n + 1][1] - C.v[n + 1][1]]),
                            o.tLength += P.segmentLength,
                            o.segments.push(P),
                            v += P.segmentLength;
                        n = a,
                        b.v.c && (P = bez.buildBezierData(C.v[n], C.v[0], [C.o[n][0] - C.v[n][0], C.o[n][1] - C.v[n][1]], [C.i[0][0] - C.v[0][0], C.i[0][1] - C.v[0][1]]),
                        o.tLength += P.segmentLength,
                        o.segments.push(P),
                        v += P.segmentLength),
                        this._pathData.pi = o
                    }
                    if (o = this._pathData.pi,
                    s = this._pathData.f.v,
                    u = 0,
                    p = 1,
                    h = 0,
                    c = !0,
                    m = o.segments,
                    s < 0 && b.v.c)
                        for (o.tLength < Math.abs(s) && (s = -Math.abs(s) % o.tLength),
                        p = (f = m[u = m.length - 1].points).length - 1; s < 0; )
                            s += f[p].partialLength,
                            (p -= 1) < 0 && (p = (f = m[u -= 1].points).length - 1);
                    d = (f = m[u].points)[p - 1],
                    g = (l = f[p]).partialLength
                }
                a = M.length,
                i = 0,
                r = 0;
                var A, L, D, I, R, F = 1.2 * e.finalSize * .714, B = !0;
                D = w.length;
                var O, N, V, z, G, H, U, W, j, $, q, X, Y = -1, K = s, Z = u, J = p, Q = -1, ee = "", te = this.defaultPropsArray;
                if (2 === e.j || 1 === e.j) {
                    var ie = 0
                      , re = 0
                      , ne = 2 === e.j ? -.5 : -1
                      , ae = 0
                      , oe = !0;
                    for (n = 0; n < a; n += 1)
                        if (M[n].n) {
                            for (ie && (ie += re); ae < n; )
                                M[ae].animatorJustifyOffset = ie,
                                ae += 1;
                            ie = 0,
                            oe = !0
                        } else {
                            for (L = 0; L < D; L += 1)
                                (A = w[L].a).t.propType && (oe && 2 === e.j && (re += A.t.v * ne),
                                (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? ie += A.t.v * R[0] * ne : ie += A.t.v * R * ne);
                            oe = !1
                        }
                    for (ie && (ie += re); ae < n; )
                        M[ae].animatorJustifyOffset = ie,
                        ae += 1
                }
                for (n = 0; n < a; n += 1) {
                    if (T.reset(),
                    z = 1,
                    M[n].n)
                        i = 0,
                        r += e.yOffset,
                        r += B ? 1 : 0,
                        s = K,
                        B = !1,
                        this._hasMaskedPath && (p = J,
                        d = (f = m[u = Z].points)[p - 1],
                        g = (l = f[p]).partialLength,
                        h = 0),
                        ee = "",
                        q = "",
                        j = "",
                        X = "",
                        te = this.defaultPropsArray;
                    else {
                        if (this._hasMaskedPath) {
                            if (Q !== M[n].line) {
                                switch (e.j) {
                                case 1:
                                    s += v - e.lineWidths[M[n].line];
                                    break;
                                case 2:
                                    s += (v - e.lineWidths[M[n].line]) / 2
                                }
                                Q = M[n].line
                            }
                            Y !== M[n].ind && (M[Y] && (s += M[Y].extra),
                            s += M[n].an / 2,
                            Y = M[n].ind),
                            s += x[0] * M[n].an * .005;
                            var se = 0;
                            for (L = 0; L < D; L += 1)
                                (A = w[L].a).p.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? se += A.p.v[0] * R[0] : se += A.p.v[0] * R),
                                A.a.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? se += A.a.v[0] * R[0] : se += A.a.v[0] * R);
                            for (c = !0,
                            this._pathData.a.v && (s = .5 * M[0].an + (v - this._pathData.f.v - .5 * M[0].an - .5 * M[M.length - 1].an) * Y / (a - 1),
                            s += this._pathData.f.v); c; )
                                h + g >= s + se || !f ? (y = (s + se - h) / l.partialLength,
                                N = d.point[0] + (l.point[0] - d.point[0]) * y,
                                V = d.point[1] + (l.point[1] - d.point[1]) * y,
                                T.translate(-x[0] * M[n].an * .005, -x[1] * F * .01),
                                c = !1) : f && (h += l.partialLength,
                                (p += 1) >= f.length && (p = 0,
                                m[u += 1] ? f = m[u].points : b.v.c ? (p = 0,
                                f = m[u = 0].points) : (h -= l.partialLength,
                                f = null)),
                                f && (d = l,
                                g = (l = f[p]).partialLength));
                            O = M[n].an / 2 - M[n].add,
                            T.translate(-O, 0, 0)
                        } else
                            O = M[n].an / 2 - M[n].add,
                            T.translate(-O, 0, 0),
                            T.translate(-x[0] * M[n].an * .005, -x[1] * F * .01, 0);
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).t.propType && (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            0 === i && 0 === e.j || (this._hasMaskedPath ? R.length ? s += A.t.v * R[0] : s += A.t.v * R : R.length ? i += A.t.v * R[0] : i += A.t.v * R));
                        for (e.strokeWidthAnim && (H = e.sw || 0),
                        e.strokeColorAnim && (G = e.sc ? [e.sc[0], e.sc[1], e.sc[2]] : [0, 0, 0]),
                        e.fillColorAnim && e.fc && (U = [e.fc[0], e.fc[1], e.fc[2]]),
                        L = 0; L < D; L += 1)
                            (A = w[L].a).a.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? T.translate(-A.a.v[0] * R[0], -A.a.v[1] * R[1], A.a.v[2] * R[2]) : T.translate(-A.a.v[0] * R, -A.a.v[1] * R, A.a.v[2] * R));
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).s.propType && ((R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars)).length ? T.scale(1 + (A.s.v[0] - 1) * R[0], 1 + (A.s.v[1] - 1) * R[1], 1) : T.scale(1 + (A.s.v[0] - 1) * R, 1 + (A.s.v[1] - 1) * R, 1));
                        for (L = 0; L < D; L += 1) {
                            if (A = w[L].a,
                            R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            A.sk.propType && (R.length ? T.skewFromAxis(-A.sk.v * R[0], A.sa.v * R[1]) : T.skewFromAxis(-A.sk.v * R, A.sa.v * R)),
                            A.r.propType && (R.length ? T.rotateZ(-A.r.v * R[2]) : T.rotateZ(-A.r.v * R)),
                            A.ry.propType && (R.length ? T.rotateY(A.ry.v * R[1]) : T.rotateY(A.ry.v * R)),
                            A.rx.propType && (R.length ? T.rotateX(A.rx.v * R[0]) : T.rotateX(A.rx.v * R)),
                            A.o.propType && (R.length ? z += (A.o.v * R[0] - z) * R[0] : z += (A.o.v * R - z) * R),
                            e.strokeWidthAnim && A.sw.propType && (R.length ? H += A.sw.v * R[0] : H += A.sw.v * R),
                            e.strokeColorAnim && A.sc.propType)
                                for (W = 0; W < 3; W += 1)
                                    R.length ? G[W] += (A.sc.v[W] - G[W]) * R[0] : G[W] += (A.sc.v[W] - G[W]) * R;
                            if (e.fillColorAnim && e.fc) {
                                if (A.fc.propType)
                                    for (W = 0; W < 3; W += 1)
                                        R.length ? U[W] += (A.fc.v[W] - U[W]) * R[0] : U[W] += (A.fc.v[W] - U[W]) * R;
                                A.fh.propType && (U = R.length ? addHueToRGB(U, A.fh.v * R[0]) : addHueToRGB(U, A.fh.v * R)),
                                A.fs.propType && (U = R.length ? addSaturationToRGB(U, A.fs.v * R[0]) : addSaturationToRGB(U, A.fs.v * R)),
                                A.fb.propType && (U = R.length ? addBrightnessToRGB(U, A.fb.v * R[0]) : addBrightnessToRGB(U, A.fb.v * R))
                            }
                        }
                        for (L = 0; L < D; L += 1)
                            (A = w[L].a).p.propType && (R = w[L].s.getMult(M[n].anIndexes[L], S.a[L].s.totalChars),
                            this._hasMaskedPath ? R.length ? T.translate(0, A.p.v[1] * R[0], -A.p.v[2] * R[1]) : T.translate(0, A.p.v[1] * R, -A.p.v[2] * R) : R.length ? T.translate(A.p.v[0] * R[0], A.p.v[1] * R[1], -A.p.v[2] * R[2]) : T.translate(A.p.v[0] * R, A.p.v[1] * R, -A.p.v[2] * R));
                        if (e.strokeWidthAnim && (j = H < 0 ? 0 : H),
                        e.strokeColorAnim && ($ = "rgb(" + Math.round(255 * G[0]) + "," + Math.round(255 * G[1]) + "," + Math.round(255 * G[2]) + ")"),
                        e.fillColorAnim && e.fc && (q = "rgb(" + Math.round(255 * U[0]) + "," + Math.round(255 * U[1]) + "," + Math.round(255 * U[2]) + ")"),
                        this._hasMaskedPath) {
                            if (T.translate(0, -e.ls),
                            T.translate(0, x[1] * F * .01 + r, 0),
                            this._pathData.p.v) {
                                _ = (l.point[1] - d.point[1]) / (l.point[0] - d.point[0]);
                                var le = 180 * Math.atan(_) / Math.PI;
                                l.point[0] < d.point[0] && (le += 180),
                                T.rotate(-le * Math.PI / 180)
                            }
                            T.translate(N, V, 0),
                            s -= x[0] * M[n].an * .005,
                            M[n + 1] && Y !== M[n + 1].ind && (s += M[n].an / 2,
                            s += .001 * e.tr * e.finalSize)
                        } else {
                            switch (T.translate(i, r, 0),
                            e.ps && T.translate(e.ps[0], e.ps[1] + e.ascent, 0),
                            e.j) {
                            case 1:
                                T.translate(M[n].animatorJustifyOffset + e.justifyOffset + (e.boxWidth - e.lineWidths[M[n].line]), 0, 0);
                                break;
                            case 2:
                                T.translate(M[n].animatorJustifyOffset + e.justifyOffset + (e.boxWidth - e.lineWidths[M[n].line]) / 2, 0, 0)
                            }
                            T.translate(0, -e.ls),
                            T.translate(O, 0, 0),
                            T.translate(x[0] * M[n].an * .005, x[1] * F * .01, 0),
                            i += M[n].l + .001 * e.tr * e.finalSize
                        }
                        "html" === k ? ee = T.toCSS() : "svg" === k ? ee = T.to2dCSS() : te = [T.props[0], T.props[1], T.props[2], T.props[3], T.props[4], T.props[5], T.props[6], T.props[7], T.props[8], T.props[9], T.props[10], T.props[11], T.props[12], T.props[13], T.props[14], T.props[15]],
                        X = z
                    }
                    E <= n ? (I = new LetterProps(X,j,$,q,ee,te),
                    this.renderedLetters.push(I),
                    E += 1,
                    this.lettersChangedFlag = !0) : (I = this.renderedLetters[n],
                    this.lettersChangedFlag = I.update(X, j, $, q, ee, te) || this.lettersChangedFlag)
                }
            }
        }
        ,
        TextAnimatorProperty.prototype.getValue = function() {
            this._elem.globalData.frameId !== this._frameId && (this._frameId = this._elem.globalData.frameId,
            this.iterateDynamicProperties())
        }
        ,
        TextAnimatorProperty.prototype.mHelper = new Matrix,
        TextAnimatorProperty.prototype.defaultPropsArray = [],
        extendPrototype([DynamicPropertyContainer], TextAnimatorProperty),
        ITextElement.prototype.initElement = function(e, t, i) {
            this.lettersChangedFlag = !0,
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.textProperty = new TextProperty(this,e.t,this.dynamicProperties),
            this.textAnimator = new TextAnimatorProperty(e.t,this.renderType,this),
            this.initTransform(e, t, i),
            this.initHierarchy(),
            this.initRenderable(),
            this.initRendererElement(),
            this.createContainerElements(),
            this.createRenderableComponents(),
            this.createContent(),
            this.hide(),
            this.textAnimator.searchProperties(this.dynamicProperties)
        }
        ,
        ITextElement.prototype.prepareFrame = function(e) {
            this._mdf = !1,
            this.prepareRenderableFrame(e),
            this.prepareProperties(e, this.isInRange),
            (this.textProperty._mdf || this.textProperty._isFirstFrame) && (this.buildNewText(),
            this.textProperty._isFirstFrame = !1,
            this.textProperty._mdf = !1)
        }
        ,
        ITextElement.prototype.createPathShape = function(e, t) {
            var i, r, n = t.length, a = "";
            for (i = 0; i < n; i += 1)
                "sh" === t[i].ty && (r = t[i].ks.k,
                a += buildShapeString(r, r.i.length, !0, e));
            return a
        }
        ,
        ITextElement.prototype.updateDocumentData = function(e, t) {
            this.textProperty.updateDocumentData(e, t)
        }
        ,
        ITextElement.prototype.canResizeFont = function(e) {
            this.textProperty.canResizeFont(e)
        }
        ,
        ITextElement.prototype.setMinimumFontSize = function(e) {
            this.textProperty.setMinimumFontSize(e)
        }
        ,
        ITextElement.prototype.applyTextPropertiesToMatrix = function(e, t, i, r, n) {
            switch (e.ps && t.translate(e.ps[0], e.ps[1] + e.ascent, 0),
            t.translate(0, -e.ls, 0),
            e.j) {
            case 1:
                t.translate(e.justifyOffset + (e.boxWidth - e.lineWidths[i]), 0, 0);
                break;
            case 2:
                t.translate(e.justifyOffset + (e.boxWidth - e.lineWidths[i]) / 2, 0, 0)
            }
            t.translate(r, n, 0)
        }
        ,
        ITextElement.prototype.buildColor = function(e) {
            return "rgb(" + Math.round(255 * e[0]) + "," + Math.round(255 * e[1]) + "," + Math.round(255 * e[2]) + ")"
        }
        ,
        ITextElement.prototype.emptyProp = new LetterProps,
        ITextElement.prototype.destroy = function() {}
        ;
        var emptyShapeData = {
            shapes: []
        };
        function SVGTextLottieElement(e, t, i) {
            this.textSpans = [],
            this.renderType = "svg",
            this.initElement(e, t, i)
        }
        function ISolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function NullElement(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initFrame(),
            this.initTransform(e, t, i),
            this.initHierarchy()
        }
        function SVGRendererBase() {}
        function ICompElement() {}
        function SVGCompElement(e, t, i) {
            this.layers = e.layers,
            this.supports3d = !0,
            this.completeLayers = !1,
            this.pendingElements = [],
            this.elements = this.layers ? createSizedArray(this.layers.length) : [],
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function SVGRenderer(e, t) {
            this.animationItem = e,
            this.layers = null,
            this.renderedFrame = -1,
            this.svgElement = createNS("svg");
            var i = "";
            if (t && t.title) {
                var r = createNS("title")
                  , n = createElementID();
                r.setAttribute("id", n),
                r.textContent = t.title,
                this.svgElement.appendChild(r),
                i += n
            }
            if (t && t.description) {
                var a = createNS("desc")
                  , o = createElementID();
                a.setAttribute("id", o),
                a.textContent = t.description,
                this.svgElement.appendChild(a),
                i += " " + o
            }
            i && this.svgElement.setAttribute("aria-labelledby", i);
            var s = createNS("defs");
            this.svgElement.appendChild(s);
            var l = createNS("g");
            this.svgElement.appendChild(l),
            this.layerElement = l,
            this.renderConfig = {
                preserveAspectRatio: t && t.preserveAspectRatio || "xMidYMid meet",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                contentVisibility: t && t.contentVisibility || "visible",
                progressiveLoad: t && t.progressiveLoad || !1,
                hideOnTransparent: !(t && !1 === t.hideOnTransparent),
                viewBoxOnly: t && t.viewBoxOnly || !1,
                viewBoxSize: t && t.viewBoxSize || !1,
                className: t && t.className || "",
                id: t && t.id || "",
                focusable: t && t.focusable,
                filterSize: {
                    width: t && t.filterSize && t.filterSize.width || "100%",
                    height: t && t.filterSize && t.filterSize.height || "100%",
                    x: t && t.filterSize && t.filterSize.x || "0%",
                    y: t && t.filterSize && t.filterSize.y || "0%"
                },
                width: t && t.width,
                height: t && t.height
            },
            this.globalData = {
                _mdf: !1,
                frameNum: -1,
                defs: s,
                renderConfig: this.renderConfig
            },
            this.elements = [],
            this.pendingElements = [],
            this.destroyed = !1,
            this.rendererType = "svg"
        }
        function CVContextData() {
            var e;
            for (this.saved = [],
            this.cArrPos = 0,
            this.cTr = new Matrix,
            this.cO = 1,
            this.savedOp = createTypedArray("float32", 15),
            e = 0; e < 15; e += 1)
                this.saved[e] = createTypedArray("float32", 16);
            this._length = 15
        }
        function ShapeTransformManager() {
            this.sequences = {},
            this.sequenceList = [],
            this.transform_key_count = 0
        }
        function CVEffects() {}
        function CVMaskElement(e, t) {
            var i;
            this.data = e,
            this.element = t,
            this.masksProperties = this.data.masksProperties || [],
            this.viewData = createSizedArray(this.masksProperties.length);
            var r = this.masksProperties.length
              , n = !1;
            for (i = 0; i < r; i += 1)
                "n" !== this.masksProperties[i].mode && (n = !0),
                this.viewData[i] = ShapePropertyFactory.getShapeProp(this.element, this.masksProperties[i], 3);
            this.hasMasks = n,
            n && this.element.addRenderableComponent(this)
        }
        function CVBaseElement() {}
        function CVShapeData(e, t, i, r) {
            this.styledShapes = [],
            this.tr = [0, 0, 0, 0, 0, 0];
            var n, a = 4;
            "rc" === t.ty ? a = 5 : "el" === t.ty ? a = 6 : "sr" === t.ty && (a = 7),
            this.sh = ShapePropertyFactory.getShapeProp(e, t, a, e);
            var o, s = i.length;
            for (n = 0; n < s; n += 1)
                i[n].closed || (o = {
                    transforms: r.addTransformSequence(i[n].transforms),
                    trNodes: []
                },
                this.styledShapes.push(o),
                i[n].elements.push(o))
        }
        function CVShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.itemsData = [],
            this.prevViewData = [],
            this.shapeModifiers = [],
            this.processedElements = [],
            this.transformsManager = new ShapeTransformManager,
            this.initElement(e, t, i)
        }
        function CVTextElement(e, t, i) {
            this.textSpans = [],
            this.yOffset = 0,
            this.fillColorAnim = !1,
            this.strokeColorAnim = !1,
            this.strokeWidthAnim = !1,
            this.stroke = !1,
            this.fill = !1,
            this.justifyOffset = 0,
            this.currentRender = null,
            this.renderType = "canvas",
            this.values = {
                fill: "rgba(0,0,0,0)",
                stroke: "rgba(0,0,0,0)",
                sWidth: 0,
                fValue: ""
            },
            this.initElement(e, t, i)
        }
        function CVImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.img = t.imageLoader.getAsset(this.assetData),
            this.initElement(e, t, i)
        }
        function CVSolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function CanvasRendererBase(e, t) {
            this.animationItem = e,
            this.renderConfig = {
                clearCanvas: !t || void 0 === t.clearCanvas || t.clearCanvas,
                context: t && t.context || null,
                progressiveLoad: t && t.progressiveLoad || !1,
                preserveAspectRatio: t && t.preserveAspectRatio || "xMidYMid meet",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                contentVisibility: t && t.contentVisibility || "visible",
                className: t && t.className || "",
                id: t && t.id || ""
            },
            this.renderConfig.dpr = t && t.dpr || 1,
            this.animationItem.wrapper && (this.renderConfig.dpr = t && t.dpr || window.devicePixelRatio || 1),
            this.renderedFrame = -1,
            this.globalData = {
                frameNum: -1,
                _mdf: !1,
                renderConfig: this.renderConfig,
                currentGlobalAlpha: -1
            },
            this.contextData = new CVContextData,
            this.elements = [],
            this.pendingElements = [],
            this.transformMat = new Matrix,
            this.completeLayers = !1,
            this.rendererType = "canvas"
        }
        function CVCompElement(e, t, i) {
            this.completeLayers = !1,
            this.layers = e.layers,
            this.pendingElements = [],
            this.elements = createSizedArray(this.layers.length),
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function CanvasRenderer(e, t) {
            this.animationItem = e,
            this.renderConfig = {
                clearCanvas: !t || void 0 === t.clearCanvas || t.clearCanvas,
                context: t && t.context || null,
                progressiveLoad: t && t.progressiveLoad || !1,
                preserveAspectRatio: t && t.preserveAspectRatio || "xMidYMid meet",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                contentVisibility: t && t.contentVisibility || "visible",
                className: t && t.className || "",
                id: t && t.id || ""
            },
            this.renderConfig.dpr = t && t.dpr || 1,
            this.animationItem.wrapper && (this.renderConfig.dpr = t && t.dpr || window.devicePixelRatio || 1),
            this.renderedFrame = -1,
            this.globalData = {
                frameNum: -1,
                _mdf: !1,
                renderConfig: this.renderConfig,
                currentGlobalAlpha: -1
            },
            this.contextData = new CVContextData,
            this.elements = [],
            this.pendingElements = [],
            this.transformMat = new Matrix,
            this.completeLayers = !1,
            this.rendererType = "canvas"
        }
        function HBaseElement() {}
        function HSolidElement(e, t, i) {
            this.initElement(e, t, i)
        }
        function HShapeElement(e, t, i) {
            this.shapes = [],
            this.shapesData = e.shapes,
            this.stylesList = [],
            this.shapeModifiers = [],
            this.itemsData = [],
            this.processedElements = [],
            this.animatedContents = [],
            this.shapesContainer = createNS("g"),
            this.initElement(e, t, i),
            this.prevViewData = [],
            this.currentBBox = {
                x: 999999,
                y: -999999,
                h: 0,
                w: 0
            }
        }
        function HTextElement(e, t, i) {
            this.textSpans = [],
            this.textPaths = [],
            this.currentBBox = {
                x: 999999,
                y: -999999,
                h: 0,
                w: 0
            },
            this.renderType = "svg",
            this.isMasked = !1,
            this.initElement(e, t, i)
        }
        function HCameraElement(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initHierarchy();
            var r = PropertyFactory.getProp;
            if (this.pe = r(this, e.pe, 0, 0, this),
            e.ks.p.s ? (this.px = r(this, e.ks.p.x, 1, 0, this),
            this.py = r(this, e.ks.p.y, 1, 0, this),
            this.pz = r(this, e.ks.p.z, 1, 0, this)) : this.p = r(this, e.ks.p, 1, 0, this),
            e.ks.a && (this.a = r(this, e.ks.a, 1, 0, this)),
            e.ks.or.k.length && e.ks.or.k[0].to) {
                var n, a = e.ks.or.k.length;
                for (n = 0; n < a; n += 1)
                    e.ks.or.k[n].to = null,
                    e.ks.or.k[n].ti = null
            }
            this.or = r(this, e.ks.or, 1, degToRads, this),
            this.or.sh = !0,
            this.rx = r(this, e.ks.rx, 0, degToRads, this),
            this.ry = r(this, e.ks.ry, 0, degToRads, this),
            this.rz = r(this, e.ks.rz, 0, degToRads, this),
            this.mat = new Matrix,
            this._prevMat = new Matrix,
            this._isFirstFrame = !0,
            this.finalTransform = {
                mProp: this
            }
        }
        function HImageElement(e, t, i) {
            this.assetData = t.getAssetData(e.refId),
            this.initElement(e, t, i)
        }
        function HybridRendererBase(e, t) {
            this.animationItem = e,
            this.layers = null,
            this.renderedFrame = -1,
            this.renderConfig = {
                className: t && t.className || "",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                hideOnTransparent: !(t && !1 === t.hideOnTransparent),
                filterSize: {
                    width: t && t.filterSize && t.filterSize.width || "400%",
                    height: t && t.filterSize && t.filterSize.height || "400%",
                    x: t && t.filterSize && t.filterSize.x || "-100%",
                    y: t && t.filterSize && t.filterSize.y || "-100%"
                }
            },
            this.globalData = {
                _mdf: !1,
                frameNum: -1,
                renderConfig: this.renderConfig
            },
            this.pendingElements = [],
            this.elements = [],
            this.threeDElements = [],
            this.destroyed = !1,
            this.camera = null,
            this.supports3d = !0,
            this.rendererType = "html"
        }
        function HCompElement(e, t, i) {
            this.layers = e.layers,
            this.supports3d = !e.hasMask,
            this.completeLayers = !1,
            this.pendingElements = [],
            this.elements = this.layers ? createSizedArray(this.layers.length) : [],
            this.initElement(e, t, i),
            this.tm = e.tm ? PropertyFactory.getProp(this, e.tm, 0, t.frameRate, this) : {
                _placeholder: !0
            }
        }
        function HybridRenderer(e, t) {
            this.animationItem = e,
            this.layers = null,
            this.renderedFrame = -1,
            this.renderConfig = {
                className: t && t.className || "",
                imagePreserveAspectRatio: t && t.imagePreserveAspectRatio || "xMidYMid slice",
                hideOnTransparent: !(t && !1 === t.hideOnTransparent),
                filterSize: {
                    width: t && t.filterSize && t.filterSize.width || "400%",
                    height: t && t.filterSize && t.filterSize.height || "400%",
                    x: t && t.filterSize && t.filterSize.x || "-100%",
                    y: t && t.filterSize && t.filterSize.y || "-100%"
                }
            },
            this.globalData = {
                _mdf: !1,
                frameNum: -1,
                renderConfig: this.renderConfig
            },
            this.pendingElements = [],
            this.elements = [],
            this.threeDElements = [],
            this.destroyed = !1,
            this.camera = null,
            this.supports3d = !0,
            this.rendererType = "html"
        }
        extendPrototype([BaseElement, TransformElement, SVGBaseElement, HierarchyElement, FrameElement, RenderableDOMElement, ITextElement], SVGTextLottieElement),
        SVGTextLottieElement.prototype.createContent = function() {
            this.data.singleShape && !this.globalData.fontManager.chars && (this.textContainer = createNS("text"))
        }
        ,
        SVGTextLottieElement.prototype.buildTextContents = function(e) {
            for (var t = 0, i = e.length, r = [], n = ""; t < i; )
                e[t] === String.fromCharCode(13) || e[t] === String.fromCharCode(3) ? (r.push(n),
                n = "") : n += e[t],
                t += 1;
            return r.push(n),
            r
        }
        ,
        SVGTextLottieElement.prototype.buildShapeData = function(e, t) {
            if (e.shapes && e.shapes.length) {
                var i = e.shapes[0];
                if (i.it) {
                    var r = i.it[i.it.length - 1];
                    r.s && (r.s.k[0] = t,
                    r.s.k[1] = t)
                }
            }
            return e
        }
        ,
        SVGTextLottieElement.prototype.buildNewText = function() {
            var e, t;
            this.addDynamicProperty(this);
            var i = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(i ? i.l.length : 0),
            i.fc ? this.layerElement.setAttribute("fill", this.buildColor(i.fc)) : this.layerElement.setAttribute("fill", "rgba(0,0,0,0)"),
            i.sc && (this.layerElement.setAttribute("stroke", this.buildColor(i.sc)),
            this.layerElement.setAttribute("stroke-width", i.sw)),
            this.layerElement.setAttribute("font-size", i.finalSize);
            var r = this.globalData.fontManager.getFontByName(i.f);
            if (r.fClass)
                this.layerElement.setAttribute("class", r.fClass);
            else {
                this.layerElement.setAttribute("font-family", r.fFamily);
                var n = i.fWeight
                  , a = i.fStyle;
                this.layerElement.setAttribute("font-style", a),
                this.layerElement.setAttribute("font-weight", n)
            }
            this.layerElement.setAttribute("aria-label", i.t);
            var o, s = i.l || [], l = !!this.globalData.fontManager.chars;
            t = s.length;
            var h = this.mHelper
              , c = this.data.singleShape
              , p = 0
              , u = 0
              , d = !0
              , f = .001 * i.tr * i.finalSize;
            if (!c || l || i.sz) {
                var m, g = this.textSpans.length;
                for (e = 0; e < t; e += 1) {
                    if (this.textSpans[e] || (this.textSpans[e] = {
                        span: null,
                        childSpan: null,
                        glyph: null
                    }),
                    !l || !c || 0 === e) {
                        if (o = g > e ? this.textSpans[e].span : createNS(l ? "g" : "text"),
                        g <= e) {
                            if (o.setAttribute("stroke-linecap", "butt"),
                            o.setAttribute("stroke-linejoin", "round"),
                            o.setAttribute("stroke-miterlimit", "4"),
                            this.textSpans[e].span = o,
                            l) {
                                var v = createNS("g");
                                o.appendChild(v),
                                this.textSpans[e].childSpan = v
                            }
                            this.textSpans[e].span = o,
                            this.layerElement.appendChild(o)
                        }
                        o.style.display = "inherit"
                    }
                    if (h.reset(),
                    c && (s[e].n && (p = -f,
                    u += i.yOffset,
                    u += d ? 1 : 0,
                    d = !1),
                    this.applyTextPropertiesToMatrix(i, h, s[e].line, p, u),
                    p += s[e].l || 0,
                    p += f),
                    l) {
                        var y;
                        if (1 === (m = this.globalData.fontManager.getCharData(i.finalText[e], r.fStyle, this.globalData.fontManager.getFontByName(i.f).fFamily)).t)
                            y = new SVGCompElement(m.data,this.globalData,this);
                        else {
                            var _ = emptyShapeData;
                            m.data && m.data.shapes && (_ = this.buildShapeData(m.data, i.finalSize)),
                            y = new SVGShapeElement(_,this.globalData,this)
                        }
                        if (this.textSpans[e].glyph) {
                            var b = this.textSpans[e].glyph;
                            this.textSpans[e].childSpan.removeChild(b.layerElement),
                            b.destroy()
                        }
                        this.textSpans[e].glyph = y,
                        y._debug = !0,
                        y.prepareFrame(0),
                        y.renderFrame(),
                        this.textSpans[e].childSpan.appendChild(y.layerElement),
                        1 === m.t && this.textSpans[e].childSpan.setAttribute("transform", "scale(" + i.finalSize / 100 + "," + i.finalSize / 100 + ")")
                    } else
                        c && o.setAttribute("transform", "translate(" + h.props[12] + "," + h.props[13] + ")"),
                        o.textContent = s[e].val,
                        o.setAttributeNS("http://www.w3.org/XML/1998/namespace", "xml:space", "preserve")
                }
                c && o && o.setAttribute("d", "")
            } else {
                var x = this.textContainer
                  , w = "start";
                switch (i.j) {
                case 1:
                    w = "end";
                    break;
                case 2:
                    w = "middle";
                    break;
                default:
                    w = "start"
                }
                x.setAttribute("text-anchor", w),
                x.setAttribute("letter-spacing", f);
                var S = this.buildTextContents(i.finalText);
                for (t = S.length,
                u = i.ps ? i.ps[1] + i.ascent : 0,
                e = 0; e < t; e += 1)
                    (o = this.textSpans[e].span || createNS("tspan")).textContent = S[e],
                    o.setAttribute("x", 0),
                    o.setAttribute("y", u),
                    o.style.display = "inherit",
                    x.appendChild(o),
                    this.textSpans[e] || (this.textSpans[e] = {
                        span: null,
                        glyph: null
                    }),
                    this.textSpans[e].span = o,
                    u += i.finalLineHeight;
                this.layerElement.appendChild(x)
            }
            for (; e < this.textSpans.length; )
                this.textSpans[e].span.style.display = "none",
                e += 1;
            this._sizeChanged = !0
        }
        ,
        SVGTextLottieElement.prototype.sourceRectAtTime = function() {
            if (this.prepareFrame(this.comp.renderedFrame - this.data.st),
            this.renderInnerContent(),
            this._sizeChanged) {
                this._sizeChanged = !1;
                var e = this.layerElement.getBBox();
                this.bbox = {
                    top: e.y,
                    left: e.x,
                    width: e.width,
                    height: e.height
                }
            }
            return this.bbox
        }
        ,
        SVGTextLottieElement.prototype.getValue = function() {
            var e, t, i = this.textSpans.length;
            for (this.renderedFrame = this.comp.renderedFrame,
            e = 0; e < i; e += 1)
                (t = this.textSpans[e].glyph) && (t.prepareFrame(this.comp.renderedFrame - this.data.st),
                t._mdf && (this._mdf = !0))
        }
        ,
        SVGTextLottieElement.prototype.renderInnerContent = function() {
            if ((!this.data.singleShape || this._mdf) && (this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag),
            this.lettersChangedFlag || this.textAnimator.lettersChangedFlag)) {
                var e, t;
                this._sizeChanged = !0;
                var i, r, n, a = this.textAnimator.renderedLetters, o = this.textProperty.currentData.l;
                for (t = o.length,
                e = 0; e < t; e += 1)
                    o[e].n || (i = a[e],
                    r = this.textSpans[e].span,
                    (n = this.textSpans[e].glyph) && n.renderFrame(),
                    i._mdf.m && r.setAttribute("transform", i.m),
                    i._mdf.o && r.setAttribute("opacity", i.o),
                    i._mdf.sw && r.setAttribute("stroke-width", i.sw),
                    i._mdf.sc && r.setAttribute("stroke", i.sc),
                    i._mdf.fc && r.setAttribute("fill", i.fc))
            }
        }
        ,
        extendPrototype([IImageElement], ISolidElement),
        ISolidElement.prototype.createContent = function() {
            var e = createNS("rect");
            e.setAttribute("width", this.data.sw),
            e.setAttribute("height", this.data.sh),
            e.setAttribute("fill", this.data.sc),
            this.layerElement.appendChild(e)
        }
        ,
        NullElement.prototype.prepareFrame = function(e) {
            this.prepareProperties(e, !0)
        }
        ,
        NullElement.prototype.renderFrame = function() {}
        ,
        NullElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        NullElement.prototype.destroy = function() {}
        ,
        NullElement.prototype.sourceRectAtTime = function() {}
        ,
        NullElement.prototype.hide = function() {}
        ,
        extendPrototype([BaseElement, TransformElement, HierarchyElement, FrameElement], NullElement),
        extendPrototype([BaseRenderer], SVGRendererBase),
        SVGRendererBase.prototype.createNull = function(e) {
            return new NullElement(e,this.globalData,this)
        }
        ,
        SVGRendererBase.prototype.createShape = function(e) {
            return new SVGShapeElement(e,this.globalData,this)
        }
        ,
        SVGRendererBase.prototype.createText = function(e) {
            return new SVGTextLottieElement(e,this.globalData,this)
        }
        ,
        SVGRendererBase.prototype.createImage = function(e) {
            return new IImageElement(e,this.globalData,this)
        }
        ,
        SVGRendererBase.prototype.createSolid = function(e) {
            return new ISolidElement(e,this.globalData,this)
        }
        ,
        SVGRendererBase.prototype.configAnimation = function(e) {
            this.svgElement.setAttribute("xmlns", "http://www.w3.org/2000/svg"),
            this.renderConfig.viewBoxSize ? this.svgElement.setAttribute("viewBox", this.renderConfig.viewBoxSize) : this.svgElement.setAttribute("viewBox", "0 0 " + e.w + " " + e.h),
            this.renderConfig.viewBoxOnly || (this.svgElement.setAttribute("width", e.w),
            this.svgElement.setAttribute("height", e.h),
            this.svgElement.style.width = "100%",
            this.svgElement.style.height = "100%",
            this.svgElement.style.transform = "translate3d(0,0,0)",
            this.svgElement.style.contentVisibility = this.renderConfig.contentVisibility),
            this.renderConfig.width && this.svgElement.setAttribute("width", this.renderConfig.width),
            this.renderConfig.height && this.svgElement.setAttribute("height", this.renderConfig.height),
            this.renderConfig.className && this.svgElement.setAttribute("class", this.renderConfig.className),
            this.renderConfig.id && this.svgElement.setAttribute("id", this.renderConfig.id),
            void 0 !== this.renderConfig.focusable && this.svgElement.setAttribute("focusable", this.renderConfig.focusable),
            this.svgElement.setAttribute("preserveAspectRatio", this.renderConfig.preserveAspectRatio),
            this.animationItem.wrapper.appendChild(this.svgElement);
            var t = this.globalData.defs;
            this.setupGlobalData(e, t),
            this.globalData.progressiveLoad = this.renderConfig.progressiveLoad,
            this.data = e;
            var i = createNS("clipPath")
              , r = createNS("rect");
            r.setAttribute("width", e.w),
            r.setAttribute("height", e.h),
            r.setAttribute("x", 0),
            r.setAttribute("y", 0);
            var n = createElementID();
            i.setAttribute("id", n),
            i.appendChild(r),
            this.layerElement.setAttribute("clip-path", "url(" + getLocationHref() + "#" + n + ")"),
            t.appendChild(i),
            this.layers = e.layers,
            this.elements = createSizedArray(e.layers.length)
        }
        ,
        SVGRendererBase.prototype.destroy = function() {
            var e;
            this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            this.layerElement = null,
            this.globalData.defs = null;
            var t = this.layers ? this.layers.length : 0;
            for (e = 0; e < t; e += 1)
                this.elements[e] && this.elements[e].destroy();
            this.elements.length = 0,
            this.destroyed = !0,
            this.animationItem = null
        }
        ,
        SVGRendererBase.prototype.updateContainerSize = function() {}
        ,
        SVGRendererBase.prototype.buildItem = function(e) {
            var t = this.elements;
            if (!t[e] && 99 !== this.layers[e].ty) {
                t[e] = !0;
                var i = this.createItem(this.layers[e]);
                t[e] = i,
                getExpressionsPlugin() && (0 === this.layers[e].ty && this.globalData.projectInterface.registerComposition(i),
                i.initExpressions()),
                this.appendElementInPos(i, e),
                this.layers[e].tt && (this.elements[e - 1] && !0 !== this.elements[e - 1] ? i.setMatte(t[e - 1].layerId) : (this.buildItem(e - 1),
                this.addPendingElement(i)))
            }
        }
        ,
        SVGRendererBase.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; ) {
                var e = this.pendingElements.pop();
                if (e.checkParenting(),
                e.data.tt)
                    for (var t = 0, i = this.elements.length; t < i; ) {
                        if (this.elements[t] === e) {
                            e.setMatte(this.elements[t - 1].layerId);
                            break
                        }
                        t += 1
                    }
            }
        }
        ,
        SVGRendererBase.prototype.renderFrame = function(e) {
            if (this.renderedFrame !== e && !this.destroyed) {
                var t;
                null === e ? e = this.renderedFrame : this.renderedFrame = e,
                this.globalData.frameNum = e,
                this.globalData.frameId += 1,
                this.globalData.projectInterface.currentFrame = e,
                this.globalData._mdf = !1;
                var i = this.layers.length;
                for (this.completeLayers || this.checkLayers(e),
                t = i - 1; t >= 0; t -= 1)
                    (this.completeLayers || this.elements[t]) && this.elements[t].prepareFrame(e - this.layers[t].st);
                if (this.globalData._mdf)
                    for (t = 0; t < i; t += 1)
                        (this.completeLayers || this.elements[t]) && this.elements[t].renderFrame()
            }
        }
        ,
        SVGRendererBase.prototype.appendElementInPos = function(e, t) {
            var i = e.getBaseElement();
            if (i) {
                for (var r, n = 0; n < t; )
                    this.elements[n] && !0 !== this.elements[n] && this.elements[n].getBaseElement() && (r = this.elements[n].getBaseElement()),
                    n += 1;
                r ? this.layerElement.insertBefore(i, r) : this.layerElement.appendChild(i)
            }
        }
        ,
        SVGRendererBase.prototype.hide = function() {
            this.layerElement.style.display = "none"
        }
        ,
        SVGRendererBase.prototype.show = function() {
            this.layerElement.style.display = "block"
        }
        ,
        extendPrototype([BaseElement, TransformElement, HierarchyElement, FrameElement, RenderableDOMElement], ICompElement),
        ICompElement.prototype.initElement = function(e, t, i) {
            this.initFrame(),
            this.initBaseData(e, t, i),
            this.initTransform(e, t, i),
            this.initRenderable(),
            this.initHierarchy(),
            this.initRendererElement(),
            this.createContainerElements(),
            this.createRenderableComponents(),
            !this.data.xt && t.progressiveLoad || this.buildAllItems(),
            this.hide()
        }
        ,
        ICompElement.prototype.prepareFrame = function(e) {
            if (this._mdf = !1,
            this.prepareRenderableFrame(e),
            this.prepareProperties(e, this.isInRange),
            this.isInRange || this.data.xt) {
                if (this.tm._placeholder)
                    this.renderedFrame = e / this.data.sr;
                else {
                    var t = this.tm.v;
                    t === this.data.op && (t = this.data.op - 1),
                    this.renderedFrame = t
                }
                var i, r = this.elements.length;
                for (this.completeLayers || this.checkLayers(this.renderedFrame),
                i = r - 1; i >= 0; i -= 1)
                    (this.completeLayers || this.elements[i]) && (this.elements[i].prepareFrame(this.renderedFrame - this.layers[i].st),
                    this.elements[i]._mdf && (this._mdf = !0))
            }
        }
        ,
        ICompElement.prototype.renderInnerContent = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                (this.completeLayers || this.elements[e]) && this.elements[e].renderFrame()
        }
        ,
        ICompElement.prototype.setElements = function(e) {
            this.elements = e
        }
        ,
        ICompElement.prototype.getElements = function() {
            return this.elements
        }
        ,
        ICompElement.prototype.destroyElements = function() {
            var e, t = this.layers.length;
            for (e = 0; e < t; e += 1)
                this.elements[e] && this.elements[e].destroy()
        }
        ,
        ICompElement.prototype.destroy = function() {
            this.destroyElements(),
            this.destroyBaseElement()
        }
        ,
        extendPrototype([SVGRendererBase, ICompElement, SVGBaseElement], SVGCompElement),
        SVGCompElement.prototype.createComp = function(e) {
            return new SVGCompElement(e,this.globalData,this)
        }
        ,
        extendPrototype([SVGRendererBase], SVGRenderer),
        SVGRenderer.prototype.createComp = function(e) {
            return new SVGCompElement(e,this.globalData,this)
        }
        ,
        CVContextData.prototype.duplicate = function() {
            var e = 2 * this._length
              , t = this.savedOp;
            this.savedOp = createTypedArray("float32", e),
            this.savedOp.set(t);
            var i = 0;
            for (i = this._length; i < e; i += 1)
                this.saved[i] = createTypedArray("float32", 16);
            this._length = e
        }
        ,
        CVContextData.prototype.reset = function() {
            this.cArrPos = 0,
            this.cTr.reset(),
            this.cO = 1
        }
        ,
        ShapeTransformManager.prototype = {
            addTransformSequence: function(e) {
                var t, i = e.length, r = "_";
                for (t = 0; t < i; t += 1)
                    r += e[t].transform.key + "_";
                var n = this.sequences[r];
                return n || (n = {
                    transforms: [].concat(e),
                    finalTransform: new Matrix,
                    _mdf: !1
                },
                this.sequences[r] = n,
                this.sequenceList.push(n)),
                n
            },
            processSequence: function(e, t) {
                for (var i, r = 0, n = e.transforms.length, a = t; r < n && !t; ) {
                    if (e.transforms[r].transform.mProps._mdf) {
                        a = !0;
                        break
                    }
                    r += 1
                }
                if (a)
                    for (e.finalTransform.reset(),
                    r = n - 1; r >= 0; r -= 1)
                        i = e.transforms[r].transform.mProps.v.props,
                        e.finalTransform.transform(i[0], i[1], i[2], i[3], i[4], i[5], i[6], i[7], i[8], i[9], i[10], i[11], i[12], i[13], i[14], i[15]);
                e._mdf = a
            },
            processSequences: function(e) {
                var t, i = this.sequenceList.length;
                for (t = 0; t < i; t += 1)
                    this.processSequence(this.sequenceList[t], e)
            },
            getNewKey: function() {
                return this.transform_key_count += 1,
                "_" + this.transform_key_count
            }
        },
        CVEffects.prototype.renderFrame = function() {}
        ,
        CVMaskElement.prototype.renderFrame = function() {
            if (this.hasMasks) {
                var e, t, i, r, n = this.element.finalTransform.mat, a = this.element.canvasContext, o = this.masksProperties.length;
                for (a.beginPath(),
                e = 0; e < o; e += 1)
                    if ("n" !== this.masksProperties[e].mode) {
                        var s;
                        this.masksProperties[e].inv && (a.moveTo(0, 0),
                        a.lineTo(this.element.globalData.compSize.w, 0),
                        a.lineTo(this.element.globalData.compSize.w, this.element.globalData.compSize.h),
                        a.lineTo(0, this.element.globalData.compSize.h),
                        a.lineTo(0, 0)),
                        r = this.viewData[e].v,
                        t = n.applyToPointArray(r.v[0][0], r.v[0][1], 0),
                        a.moveTo(t[0], t[1]);
                        var l = r._length;
                        for (s = 1; s < l; s += 1)
                            i = n.applyToTriplePoints(r.o[s - 1], r.i[s], r.v[s]),
                            a.bezierCurveTo(i[0], i[1], i[2], i[3], i[4], i[5]);
                        i = n.applyToTriplePoints(r.o[s - 1], r.i[0], r.v[0]),
                        a.bezierCurveTo(i[0], i[1], i[2], i[3], i[4], i[5])
                    }
                this.element.globalData.renderer.save(!0),
                a.clip()
            }
        }
        ,
        CVMaskElement.prototype.getMaskProperty = MaskElement.prototype.getMaskProperty,
        CVMaskElement.prototype.destroy = function() {
            this.element = null
        }
        ,
        CVBaseElement.prototype = {
            createElements: function() {},
            initRendererElement: function() {},
            createContainerElements: function() {
                this.canvasContext = this.globalData.canvasContext,
                this.renderableEffectsManager = new CVEffects
            },
            createContent: function() {},
            setBlendMode: function() {
                var e = this.globalData;
                if (e.blendMode !== this.data.bm) {
                    e.blendMode = this.data.bm;
                    var t = getBlendMode(this.data.bm);
                    e.canvasContext.globalCompositeOperation = t
                }
            },
            createRenderableComponents: function() {
                this.maskManager = new CVMaskElement(this.data,this)
            },
            hideElement: function() {
                this.hidden || this.isInRange && !this.isTransparent || (this.hidden = !0)
            },
            showElement: function() {
                this.isInRange && !this.isTransparent && (this.hidden = !1,
                this._isFirstFrame = !0,
                this.maskManager._isFirstFrame = !0)
            },
            renderFrame: function() {
                if (!this.hidden && !this.data.hd) {
                    this.renderTransform(),
                    this.renderRenderable(),
                    this.setBlendMode();
                    var e = 0 === this.data.ty;
                    this.globalData.renderer.save(e),
                    this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),
                    this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),
                    this.renderInnerContent(),
                    this.globalData.renderer.restore(e),
                    this.maskManager.hasMasks && this.globalData.renderer.restore(!0),
                    this._isFirstFrame && (this._isFirstFrame = !1)
                }
            },
            destroy: function() {
                this.canvasContext = null,
                this.data = null,
                this.globalData = null,
                this.maskManager.destroy()
            },
            mHelper: new Matrix
        },
        CVBaseElement.prototype.hide = CVBaseElement.prototype.hideElement,
        CVBaseElement.prototype.show = CVBaseElement.prototype.showElement,
        CVShapeData.prototype.setAsAnimated = SVGShapeData.prototype.setAsAnimated,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, IShapeElement, HierarchyElement, FrameElement, RenderableElement], CVShapeElement),
        CVShapeElement.prototype.initElement = RenderableDOMElement.prototype.initElement,
        CVShapeElement.prototype.transformHelper = {
            opacity: 1,
            _opMdf: !1
        },
        CVShapeElement.prototype.dashResetter = [],
        CVShapeElement.prototype.createContent = function() {
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, !0, [])
        }
        ,
        CVShapeElement.prototype.createStyleElement = function(e, t) {
            var i = {
                data: e,
                type: e.ty,
                preTransforms: this.transformsManager.addTransformSequence(t),
                transforms: [],
                elements: [],
                closed: !0 === e.hd
            }
              , r = {};
            if ("fl" === e.ty || "st" === e.ty ? (r.c = PropertyFactory.getProp(this, e.c, 1, 255, this),
            r.c.k || (i.co = "rgb(" + bmFloor(r.c.v[0]) + "," + bmFloor(r.c.v[1]) + "," + bmFloor(r.c.v[2]) + ")")) : "gf" !== e.ty && "gs" !== e.ty || (r.s = PropertyFactory.getProp(this, e.s, 1, null, this),
            r.e = PropertyFactory.getProp(this, e.e, 1, null, this),
            r.h = PropertyFactory.getProp(this, e.h || {
                k: 0
            }, 0, .01, this),
            r.a = PropertyFactory.getProp(this, e.a || {
                k: 0
            }, 0, degToRads, this),
            r.g = new GradientProperty(this,e.g,this)),
            r.o = PropertyFactory.getProp(this, e.o, 0, .01, this),
            "st" === e.ty || "gs" === e.ty) {
                if (i.lc = lineCapEnum[e.lc || 2],
                i.lj = lineJoinEnum[e.lj || 2],
                1 == e.lj && (i.ml = e.ml),
                r.w = PropertyFactory.getProp(this, e.w, 0, null, this),
                r.w.k || (i.wi = r.w.v),
                e.d) {
                    var n = new DashProperty(this,e.d,"canvas",this);
                    r.d = n,
                    r.d.k || (i.da = r.d.dashArray,
                    i.do = r.d.dashoffset[0])
                }
            } else
                i.r = 2 === e.r ? "evenodd" : "nonzero";
            return this.stylesList.push(i),
            r.style = i,
            r
        }
        ,
        CVShapeElement.prototype.createGroupElement = function() {
            return {
                it: [],
                prevViewData: []
            }
        }
        ,
        CVShapeElement.prototype.createTransformElement = function(e) {
            return {
                transform: {
                    opacity: 1,
                    _opMdf: !1,
                    key: this.transformsManager.getNewKey(),
                    op: PropertyFactory.getProp(this, e.o, 0, .01, this),
                    mProps: TransformPropertyFactory.getTransformProperty(this, e, this)
                }
            }
        }
        ,
        CVShapeElement.prototype.createShapeElement = function(e) {
            var t = new CVShapeData(this,e,this.stylesList,this.transformsManager);
            return this.shapes.push(t),
            this.addShapeToModifiers(t),
            t
        }
        ,
        CVShapeElement.prototype.reloadShapes = function() {
            var e;
            this._isFirstFrame = !0;
            var t = this.itemsData.length;
            for (e = 0; e < t; e += 1)
                this.prevViewData[e] = this.itemsData[e];
            for (this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, !0, []),
            t = this.dynamicProperties.length,
            e = 0; e < t; e += 1)
                this.dynamicProperties[e].getValue();
            this.renderModifiers(),
            this.transformsManager.processSequences(this._isFirstFrame)
        }
        ,
        CVShapeElement.prototype.addTransformToStyleList = function(e) {
            var t, i = this.stylesList.length;
            for (t = 0; t < i; t += 1)
                this.stylesList[t].closed || this.stylesList[t].transforms.push(e)
        }
        ,
        CVShapeElement.prototype.removeTransformFromStyleList = function() {
            var e, t = this.stylesList.length;
            for (e = 0; e < t; e += 1)
                this.stylesList[e].closed || this.stylesList[e].transforms.pop()
        }
        ,
        CVShapeElement.prototype.closeStyles = function(e) {
            var t, i = e.length;
            for (t = 0; t < i; t += 1)
                e[t].closed = !0
        }
        ,
        CVShapeElement.prototype.searchShapes = function(e, t, i, r, n) {
            var a, o, s, l, h, c, p = e.length - 1, u = [], d = [], f = [].concat(n);
            for (a = p; a >= 0; a -= 1) {
                if ((l = this.searchProcessedElement(e[a])) ? t[a] = i[l - 1] : e[a]._shouldRender = r,
                "fl" === e[a].ty || "st" === e[a].ty || "gf" === e[a].ty || "gs" === e[a].ty)
                    l ? t[a].style.closed = !1 : t[a] = this.createStyleElement(e[a], f),
                    u.push(t[a].style);
                else if ("gr" === e[a].ty) {
                    if (l)
                        for (s = t[a].it.length,
                        o = 0; o < s; o += 1)
                            t[a].prevViewData[o] = t[a].it[o];
                    else
                        t[a] = this.createGroupElement(e[a]);
                    this.searchShapes(e[a].it, t[a].it, t[a].prevViewData, r, f)
                } else
                    "tr" === e[a].ty ? (l || (c = this.createTransformElement(e[a]),
                    t[a] = c),
                    f.push(t[a]),
                    this.addTransformToStyleList(t[a])) : "sh" === e[a].ty || "rc" === e[a].ty || "el" === e[a].ty || "sr" === e[a].ty ? l || (t[a] = this.createShapeElement(e[a])) : "tm" === e[a].ty || "rd" === e[a].ty || "pb" === e[a].ty ? (l ? (h = t[a]).closed = !1 : ((h = ShapeModifiers.getModifier(e[a].ty)).init(this, e[a]),
                    t[a] = h,
                    this.shapeModifiers.push(h)),
                    d.push(h)) : "rp" === e[a].ty && (l ? (h = t[a]).closed = !0 : (h = ShapeModifiers.getModifier(e[a].ty),
                    t[a] = h,
                    h.init(this, e, a, t),
                    this.shapeModifiers.push(h),
                    r = !1),
                    d.push(h));
                this.addProcessedElement(e[a], a + 1)
            }
            for (this.removeTransformFromStyleList(),
            this.closeStyles(u),
            p = d.length,
            a = 0; a < p; a += 1)
                d[a].closed = !0
        }
        ,
        CVShapeElement.prototype.renderInnerContent = function() {
            this.transformHelper.opacity = 1,
            this.transformHelper._opMdf = !1,
            this.renderModifiers(),
            this.transformsManager.processSequences(this._isFirstFrame),
            this.renderShape(this.transformHelper, this.shapesData, this.itemsData, !0)
        }
        ,
        CVShapeElement.prototype.renderShapeTransform = function(e, t) {
            (e._opMdf || t.op._mdf || this._isFirstFrame) && (t.opacity = e.opacity,
            t.opacity *= t.op.v,
            t._opMdf = !0)
        }
        ,
        CVShapeElement.prototype.drawLayer = function() {
            var e, t, i, r, n, a, o, s, l, h = this.stylesList.length, c = this.globalData.renderer, p = this.globalData.canvasContext;
            for (e = 0; e < h; e += 1)
                if (("st" !== (s = (l = this.stylesList[e]).type) && "gs" !== s || 0 !== l.wi) && l.data._shouldRender && 0 !== l.coOp && 0 !== this.globalData.currentGlobalAlpha) {
                    for (c.save(),
                    a = l.elements,
                    "st" === s || "gs" === s ? (p.strokeStyle = "st" === s ? l.co : l.grd,
                    p.lineWidth = l.wi,
                    p.lineCap = l.lc,
                    p.lineJoin = l.lj,
                    p.miterLimit = l.ml || 0) : p.fillStyle = "fl" === s ? l.co : l.grd,
                    c.ctxOpacity(l.coOp),
                    "st" !== s && "gs" !== s && p.beginPath(),
                    c.ctxTransform(l.preTransforms.finalTransform.props),
                    i = a.length,
                    t = 0; t < i; t += 1) {
                        for ("st" !== s && "gs" !== s || (p.beginPath(),
                        l.da && (p.setLineDash(l.da),
                        p.lineDashOffset = l.do)),
                        n = (o = a[t].trNodes).length,
                        r = 0; r < n; r += 1)
                            "m" === o[r].t ? p.moveTo(o[r].p[0], o[r].p[1]) : "c" === o[r].t ? p.bezierCurveTo(o[r].pts[0], o[r].pts[1], o[r].pts[2], o[r].pts[3], o[r].pts[4], o[r].pts[5]) : p.closePath();
                        "st" !== s && "gs" !== s || (p.stroke(),
                        l.da && p.setLineDash(this.dashResetter))
                    }
                    "st" !== s && "gs" !== s && p.fill(l.r),
                    c.restore()
                }
        }
        ,
        CVShapeElement.prototype.renderShape = function(e, t, i, r) {
            var n, a;
            for (a = e,
            n = t.length - 1; n >= 0; n -= 1)
                "tr" === t[n].ty ? (a = i[n].transform,
                this.renderShapeTransform(e, a)) : "sh" === t[n].ty || "el" === t[n].ty || "rc" === t[n].ty || "sr" === t[n].ty ? this.renderPath(t[n], i[n]) : "fl" === t[n].ty ? this.renderFill(t[n], i[n], a) : "st" === t[n].ty ? this.renderStroke(t[n], i[n], a) : "gf" === t[n].ty || "gs" === t[n].ty ? this.renderGradientFill(t[n], i[n], a) : "gr" === t[n].ty ? this.renderShape(a, t[n].it, i[n].it) : t[n].ty;
            r && this.drawLayer()
        }
        ,
        CVShapeElement.prototype.renderStyledShape = function(e, t) {
            if (this._isFirstFrame || t._mdf || e.transforms._mdf) {
                var i, r, n, a = e.trNodes, o = t.paths, s = o._length;
                a.length = 0;
                var l = e.transforms.finalTransform;
                for (n = 0; n < s; n += 1) {
                    var h = o.shapes[n];
                    if (h && h.v) {
                        for (r = h._length,
                        i = 1; i < r; i += 1)
                            1 === i && a.push({
                                t: "m",
                                p: l.applyToPointArray(h.v[0][0], h.v[0][1], 0)
                            }),
                            a.push({
                                t: "c",
                                pts: l.applyToTriplePoints(h.o[i - 1], h.i[i], h.v[i])
                            });
                        1 === r && a.push({
                            t: "m",
                            p: l.applyToPointArray(h.v[0][0], h.v[0][1], 0)
                        }),
                        h.c && r && (a.push({
                            t: "c",
                            pts: l.applyToTriplePoints(h.o[i - 1], h.i[0], h.v[0])
                        }),
                        a.push({
                            t: "z"
                        }))
                    }
                }
                e.trNodes = a
            }
        }
        ,
        CVShapeElement.prototype.renderPath = function(e, t) {
            if (!0 !== e.hd && e._shouldRender) {
                var i, r = t.styledShapes.length;
                for (i = 0; i < r; i += 1)
                    this.renderStyledShape(t.styledShapes[i], t.sh)
            }
        }
        ,
        CVShapeElement.prototype.renderFill = function(e, t, i) {
            var r = t.style;
            (t.c._mdf || this._isFirstFrame) && (r.co = "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
            (t.o._mdf || i._opMdf || this._isFirstFrame) && (r.coOp = t.o.v * i.opacity)
        }
        ,
        CVShapeElement.prototype.renderGradientFill = function(e, t, i) {
            var r, n = t.style;
            if (!n.grd || t.g._mdf || t.s._mdf || t.e._mdf || 1 !== e.t && (t.h._mdf || t.a._mdf)) {
                var a, o = this.globalData.canvasContext, s = t.s.v, l = t.e.v;
                if (1 === e.t)
                    r = o.createLinearGradient(s[0], s[1], l[0], l[1]);
                else {
                    var h = Math.sqrt(Math.pow(s[0] - l[0], 2) + Math.pow(s[1] - l[1], 2))
                      , c = Math.atan2(l[1] - s[1], l[0] - s[0])
                      , p = t.h.v;
                    p >= 1 ? p = .99 : p <= -1 && (p = -.99);
                    var u = h * p
                      , d = Math.cos(c + t.a.v) * u + s[0]
                      , f = Math.sin(c + t.a.v) * u + s[1];
                    r = o.createRadialGradient(d, f, 0, s[0], s[1], h)
                }
                var m = e.g.p
                  , g = t.g.c
                  , v = 1;
                for (a = 0; a < m; a += 1)
                    t.g._hasOpacity && t.g._collapsable && (v = t.g.o[2 * a + 1]),
                    r.addColorStop(g[4 * a] / 100, "rgba(" + g[4 * a + 1] + "," + g[4 * a + 2] + "," + g[4 * a + 3] + "," + v + ")");
                n.grd = r
            }
            n.coOp = t.o.v * i.opacity
        }
        ,
        CVShapeElement.prototype.renderStroke = function(e, t, i) {
            var r = t.style
              , n = t.d;
            n && (n._mdf || this._isFirstFrame) && (r.da = n.dashArray,
            r.do = n.dashoffset[0]),
            (t.c._mdf || this._isFirstFrame) && (r.co = "rgb(" + bmFloor(t.c.v[0]) + "," + bmFloor(t.c.v[1]) + "," + bmFloor(t.c.v[2]) + ")"),
            (t.o._mdf || i._opMdf || this._isFirstFrame) && (r.coOp = t.o.v * i.opacity),
            (t.w._mdf || this._isFirstFrame) && (r.wi = t.w.v)
        }
        ,
        CVShapeElement.prototype.destroy = function() {
            this.shapesData = null,
            this.globalData = null,
            this.canvasContext = null,
            this.stylesList.length = 0,
            this.itemsData.length = 0
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement, ITextElement], CVTextElement),
        CVTextElement.prototype.tHelper = createTag("canvas").getContext("2d"),
        CVTextElement.prototype.buildNewText = function() {
            var e = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(e.l ? e.l.length : 0);
            var t = !1;
            e.fc ? (t = !0,
            this.values.fill = this.buildColor(e.fc)) : this.values.fill = "rgba(0,0,0,0)",
            this.fill = t;
            var i = !1;
            e.sc && (i = !0,
            this.values.stroke = this.buildColor(e.sc),
            this.values.sWidth = e.sw);
            var r, n, a, o, s, l, h, c, p, u, d, f, m = this.globalData.fontManager.getFontByName(e.f), g = e.l, v = this.mHelper;
            this.stroke = i,
            this.values.fValue = e.finalSize + "px " + this.globalData.fontManager.getFontByName(e.f).fFamily,
            n = e.finalText.length;
            var y = this.data.singleShape
              , _ = .001 * e.tr * e.finalSize
              , b = 0
              , x = 0
              , w = !0
              , S = 0;
            for (r = 0; r < n; r += 1) {
                o = (a = this.globalData.fontManager.getCharData(e.finalText[r], m.fStyle, this.globalData.fontManager.getFontByName(e.f).fFamily)) && a.data || {},
                v.reset(),
                y && g[r].n && (b = -_,
                x += e.yOffset,
                x += w ? 1 : 0,
                w = !1),
                p = (h = o.shapes ? o.shapes[0].it : []).length,
                v.scale(e.finalSize / 100, e.finalSize / 100),
                y && this.applyTextPropertiesToMatrix(e, v, g[r].line, b, x),
                d = createSizedArray(p - 1);
                var T = 0;
                for (c = 0; c < p; c += 1)
                    if ("sh" === h[c].ty) {
                        for (l = h[c].ks.k.i.length,
                        u = h[c].ks.k,
                        f = [],
                        s = 1; s < l; s += 1)
                            1 === s && f.push(v.applyToX(u.v[0][0], u.v[0][1], 0), v.applyToY(u.v[0][0], u.v[0][1], 0)),
                            f.push(v.applyToX(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToY(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToX(u.i[s][0], u.i[s][1], 0), v.applyToY(u.i[s][0], u.i[s][1], 0), v.applyToX(u.v[s][0], u.v[s][1], 0), v.applyToY(u.v[s][0], u.v[s][1], 0));
                        f.push(v.applyToX(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToY(u.o[s - 1][0], u.o[s - 1][1], 0), v.applyToX(u.i[0][0], u.i[0][1], 0), v.applyToY(u.i[0][0], u.i[0][1], 0), v.applyToX(u.v[0][0], u.v[0][1], 0), v.applyToY(u.v[0][0], u.v[0][1], 0)),
                        d[T] = f,
                        T += 1
                    }
                y && (b += g[r].l,
                b += _),
                this.textSpans[S] ? this.textSpans[S].elem = d : this.textSpans[S] = {
                    elem: d
                },
                S += 1
            }
        }
        ,
        CVTextElement.prototype.renderInnerContent = function() {
            var e, t, i, r, n, a, o = this.canvasContext;
            o.font = this.values.fValue,
            o.lineCap = "butt",
            o.lineJoin = "miter",
            o.miterLimit = 4,
            this.data.singleShape || this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag);
            var s, l = this.textAnimator.renderedLetters, h = this.textProperty.currentData.l;
            t = h.length;
            var c, p, u = null, d = null, f = null;
            for (e = 0; e < t; e += 1)
                if (!h[e].n) {
                    if ((s = l[e]) && (this.globalData.renderer.save(),
                    this.globalData.renderer.ctxTransform(s.p),
                    this.globalData.renderer.ctxOpacity(s.o)),
                    this.fill) {
                        for (s && s.fc ? u !== s.fc && (u = s.fc,
                        o.fillStyle = s.fc) : u !== this.values.fill && (u = this.values.fill,
                        o.fillStyle = this.values.fill),
                        r = (c = this.textSpans[e].elem).length,
                        this.globalData.canvasContext.beginPath(),
                        i = 0; i < r; i += 1)
                            for (a = (p = c[i]).length,
                            this.globalData.canvasContext.moveTo(p[0], p[1]),
                            n = 2; n < a; n += 6)
                                this.globalData.canvasContext.bezierCurveTo(p[n], p[n + 1], p[n + 2], p[n + 3], p[n + 4], p[n + 5]);
                        this.globalData.canvasContext.closePath(),
                        this.globalData.canvasContext.fill()
                    }
                    if (this.stroke) {
                        for (s && s.sw ? f !== s.sw && (f = s.sw,
                        o.lineWidth = s.sw) : f !== this.values.sWidth && (f = this.values.sWidth,
                        o.lineWidth = this.values.sWidth),
                        s && s.sc ? d !== s.sc && (d = s.sc,
                        o.strokeStyle = s.sc) : d !== this.values.stroke && (d = this.values.stroke,
                        o.strokeStyle = this.values.stroke),
                        r = (c = this.textSpans[e].elem).length,
                        this.globalData.canvasContext.beginPath(),
                        i = 0; i < r; i += 1)
                            for (a = (p = c[i]).length,
                            this.globalData.canvasContext.moveTo(p[0], p[1]),
                            n = 2; n < a; n += 6)
                                this.globalData.canvasContext.bezierCurveTo(p[n], p[n + 1], p[n + 2], p[n + 3], p[n + 4], p[n + 5]);
                        this.globalData.canvasContext.closePath(),
                        this.globalData.canvasContext.stroke()
                    }
                    s && this.globalData.renderer.restore()
                }
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement], CVImageElement),
        CVImageElement.prototype.initElement = SVGShapeElement.prototype.initElement,
        CVImageElement.prototype.prepareFrame = IImageElement.prototype.prepareFrame,
        CVImageElement.prototype.createContent = function() {
            if (this.img.width && (this.assetData.w !== this.img.width || this.assetData.h !== this.img.height)) {
                var e = createTag("canvas");
                e.width = this.assetData.w,
                e.height = this.assetData.h;
                var t, i, r = e.getContext("2d"), n = this.img.width, a = this.img.height, o = n / a, s = this.assetData.w / this.assetData.h, l = this.assetData.pr || this.globalData.renderConfig.imagePreserveAspectRatio;
                o > s && "xMidYMid slice" === l || o < s && "xMidYMid slice" !== l ? t = (i = a) * s : i = (t = n) / s,
                r.drawImage(this.img, (n - t) / 2, (a - i) / 2, t, i, 0, 0, this.assetData.w, this.assetData.h),
                this.img = e
            }
        }
        ,
        CVImageElement.prototype.renderInnerContent = function() {
            this.canvasContext.drawImage(this.img, 0, 0)
        }
        ,
        CVImageElement.prototype.destroy = function() {
            this.img = null
        }
        ,
        extendPrototype([BaseElement, TransformElement, CVBaseElement, HierarchyElement, FrameElement, RenderableElement], CVSolidElement),
        CVSolidElement.prototype.initElement = SVGShapeElement.prototype.initElement,
        CVSolidElement.prototype.prepareFrame = IImageElement.prototype.prepareFrame,
        CVSolidElement.prototype.renderInnerContent = function() {
            var e = this.canvasContext;
            e.fillStyle = this.data.sc,
            e.fillRect(0, 0, this.data.sw, this.data.sh)
        }
        ,
        extendPrototype([BaseRenderer], CanvasRendererBase),
        CanvasRendererBase.prototype.createShape = function(e) {
            return new CVShapeElement(e,this.globalData,this)
        }
        ,
        CanvasRendererBase.prototype.createText = function(e) {
            return new CVTextElement(e,this.globalData,this)
        }
        ,
        CanvasRendererBase.prototype.createImage = function(e) {
            return new CVImageElement(e,this.globalData,this)
        }
        ,
        CanvasRendererBase.prototype.createSolid = function(e) {
            return new CVSolidElement(e,this.globalData,this)
        }
        ,
        CanvasRendererBase.prototype.createNull = SVGRenderer.prototype.createNull,
        CanvasRendererBase.prototype.ctxTransform = function(e) {
            if (1 !== e[0] || 0 !== e[1] || 0 !== e[4] || 1 !== e[5] || 0 !== e[12] || 0 !== e[13])
                if (this.renderConfig.clearCanvas) {
                    this.transformMat.cloneFromProps(e);
                    var t = this.contextData.cTr.props;
                    this.transformMat.transform(t[0], t[1], t[2], t[3], t[4], t[5], t[6], t[7], t[8], t[9], t[10], t[11], t[12], t[13], t[14], t[15]),
                    this.contextData.cTr.cloneFromProps(this.transformMat.props);
                    var i = this.contextData.cTr.props;
                    this.canvasContext.setTransform(i[0], i[1], i[4], i[5], i[12], i[13])
                } else
                    this.canvasContext.transform(e[0], e[1], e[4], e[5], e[12], e[13])
        }
        ,
        CanvasRendererBase.prototype.ctxOpacity = function(e) {
            if (!this.renderConfig.clearCanvas)
                return this.canvasContext.globalAlpha *= e < 0 ? 0 : e,
                void (this.globalData.currentGlobalAlpha = this.contextData.cO);
            this.contextData.cO *= e < 0 ? 0 : e,
            this.globalData.currentGlobalAlpha !== this.contextData.cO && (this.canvasContext.globalAlpha = this.contextData.cO,
            this.globalData.currentGlobalAlpha = this.contextData.cO)
        }
        ,
        CanvasRendererBase.prototype.reset = function() {
            this.renderConfig.clearCanvas ? this.contextData.reset() : this.canvasContext.restore()
        }
        ,
        CanvasRendererBase.prototype.save = function(e) {
            if (this.renderConfig.clearCanvas) {
                e && this.canvasContext.save();
                var t, i = this.contextData.cTr.props;
                this.contextData._length <= this.contextData.cArrPos && this.contextData.duplicate();
                var r = this.contextData.saved[this.contextData.cArrPos];
                for (t = 0; t < 16; t += 1)
                    r[t] = i[t];
                this.contextData.savedOp[this.contextData.cArrPos] = this.contextData.cO,
                this.contextData.cArrPos += 1
            } else
                this.canvasContext.save()
        }
        ,
        CanvasRendererBase.prototype.restore = function(e) {
            if (this.renderConfig.clearCanvas) {
                e && (this.canvasContext.restore(),
                this.globalData.blendMode = "source-over"),
                this.contextData.cArrPos -= 1;
                var t, i = this.contextData.saved[this.contextData.cArrPos], r = this.contextData.cTr.props;
                for (t = 0; t < 16; t += 1)
                    r[t] = i[t];
                this.canvasContext.setTransform(i[0], i[1], i[4], i[5], i[12], i[13]),
                i = this.contextData.savedOp[this.contextData.cArrPos],
                this.contextData.cO = i,
                this.globalData.currentGlobalAlpha !== i && (this.canvasContext.globalAlpha = i,
                this.globalData.currentGlobalAlpha = i)
            } else
                this.canvasContext.restore()
        }
        ,
        CanvasRendererBase.prototype.configAnimation = function(e) {
            if (this.animationItem.wrapper) {
                this.animationItem.container = createTag("canvas");
                var t = this.animationItem.container.style;
                t.width = "100%",
                t.height = "100%";
                var i = "0px 0px 0px";
                t.transformOrigin = i,
                t.mozTransformOrigin = i,
                t.webkitTransformOrigin = i,
                t["-webkit-transform"] = i,
                t.contentVisibility = this.renderConfig.contentVisibility,
                this.animationItem.wrapper.appendChild(this.animationItem.container),
                this.canvasContext = this.animationItem.container.getContext("2d"),
                this.renderConfig.className && this.animationItem.container.setAttribute("class", this.renderConfig.className),
                this.renderConfig.id && this.animationItem.container.setAttribute("id", this.renderConfig.id)
            } else
                this.canvasContext = this.renderConfig.context;
            this.data = e,
            this.layers = e.layers,
            this.transformCanvas = {
                w: e.w,
                h: e.h,
                sx: 0,
                sy: 0,
                tx: 0,
                ty: 0
            },
            this.setupGlobalData(e, document.body),
            this.globalData.canvasContext = this.canvasContext,
            this.globalData.renderer = this,
            this.globalData.isDashed = !1,
            this.globalData.progressiveLoad = this.renderConfig.progressiveLoad,
            this.globalData.transformCanvas = this.transformCanvas,
            this.elements = createSizedArray(e.layers.length),
            this.updateContainerSize()
        }
        ,
        CanvasRendererBase.prototype.updateContainerSize = function() {
            var e, t, i, r;
            if (this.reset(),
            this.animationItem.wrapper && this.animationItem.container ? (e = this.animationItem.wrapper.offsetWidth,
            t = this.animationItem.wrapper.offsetHeight,
            this.animationItem.container.setAttribute("width", e * this.renderConfig.dpr),
            this.animationItem.container.setAttribute("height", t * this.renderConfig.dpr)) : (e = this.canvasContext.canvas.width * this.renderConfig.dpr,
            t = this.canvasContext.canvas.height * this.renderConfig.dpr),
            -1 !== this.renderConfig.preserveAspectRatio.indexOf("meet") || -1 !== this.renderConfig.preserveAspectRatio.indexOf("slice")) {
                var n = this.renderConfig.preserveAspectRatio.split(" ")
                  , a = n[1] || "meet"
                  , o = n[0] || "xMidYMid"
                  , s = o.substr(0, 4)
                  , l = o.substr(4);
                i = e / t,
                (r = this.transformCanvas.w / this.transformCanvas.h) > i && "meet" === a || r < i && "slice" === a ? (this.transformCanvas.sx = e / (this.transformCanvas.w / this.renderConfig.dpr),
                this.transformCanvas.sy = e / (this.transformCanvas.w / this.renderConfig.dpr)) : (this.transformCanvas.sx = t / (this.transformCanvas.h / this.renderConfig.dpr),
                this.transformCanvas.sy = t / (this.transformCanvas.h / this.renderConfig.dpr)),
                this.transformCanvas.tx = "xMid" === s && (r < i && "meet" === a || r > i && "slice" === a) ? (e - this.transformCanvas.w * (t / this.transformCanvas.h)) / 2 * this.renderConfig.dpr : "xMax" === s && (r < i && "meet" === a || r > i && "slice" === a) ? (e - this.transformCanvas.w * (t / this.transformCanvas.h)) * this.renderConfig.dpr : 0,
                this.transformCanvas.ty = "YMid" === l && (r > i && "meet" === a || r < i && "slice" === a) ? (t - this.transformCanvas.h * (e / this.transformCanvas.w)) / 2 * this.renderConfig.dpr : "YMax" === l && (r > i && "meet" === a || r < i && "slice" === a) ? (t - this.transformCanvas.h * (e / this.transformCanvas.w)) * this.renderConfig.dpr : 0
            } else
                "none" === this.renderConfig.preserveAspectRatio ? (this.transformCanvas.sx = e / (this.transformCanvas.w / this.renderConfig.dpr),
                this.transformCanvas.sy = t / (this.transformCanvas.h / this.renderConfig.dpr),
                this.transformCanvas.tx = 0,
                this.transformCanvas.ty = 0) : (this.transformCanvas.sx = this.renderConfig.dpr,
                this.transformCanvas.sy = this.renderConfig.dpr,
                this.transformCanvas.tx = 0,
                this.transformCanvas.ty = 0);
            this.transformCanvas.props = [this.transformCanvas.sx, 0, 0, 0, 0, this.transformCanvas.sy, 0, 0, 0, 0, 1, 0, this.transformCanvas.tx, this.transformCanvas.ty, 0, 1],
            this.ctxTransform(this.transformCanvas.props),
            this.canvasContext.beginPath(),
            this.canvasContext.rect(0, 0, this.transformCanvas.w, this.transformCanvas.h),
            this.canvasContext.closePath(),
            this.canvasContext.clip(),
            this.renderFrame(this.renderedFrame, !0)
        }
        ,
        CanvasRendererBase.prototype.destroy = function() {
            var e;
            for (this.renderConfig.clearCanvas && this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            e = (this.layers ? this.layers.length : 0) - 1; e >= 0; e -= 1)
                this.elements[e] && this.elements[e].destroy();
            this.elements.length = 0,
            this.globalData.canvasContext = null,
            this.animationItem.container = null,
            this.destroyed = !0
        }
        ,
        CanvasRendererBase.prototype.renderFrame = function(e, t) {
            if ((this.renderedFrame !== e || !0 !== this.renderConfig.clearCanvas || t) && !this.destroyed && -1 !== e) {
                var i;
                this.renderedFrame = e,
                this.globalData.frameNum = e - this.animationItem._isFirstFrame,
                this.globalData.frameId += 1,
                this.globalData._mdf = !this.renderConfig.clearCanvas || t,
                this.globalData.projectInterface.currentFrame = e;
                var r = this.layers.length;
                for (this.completeLayers || this.checkLayers(e),
                i = 0; i < r; i += 1)
                    (this.completeLayers || this.elements[i]) && this.elements[i].prepareFrame(e - this.layers[i].st);
                if (this.globalData._mdf) {
                    for (!0 === this.renderConfig.clearCanvas ? this.canvasContext.clearRect(0, 0, this.transformCanvas.w, this.transformCanvas.h) : this.save(),
                    i = r - 1; i >= 0; i -= 1)
                        (this.completeLayers || this.elements[i]) && this.elements[i].renderFrame();
                    !0 !== this.renderConfig.clearCanvas && this.restore()
                }
            }
        }
        ,
        CanvasRendererBase.prototype.buildItem = function(e) {
            var t = this.elements;
            if (!t[e] && 99 !== this.layers[e].ty) {
                var i = this.createItem(this.layers[e], this, this.globalData);
                t[e] = i,
                i.initExpressions()
            }
        }
        ,
        CanvasRendererBase.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; )
                this.pendingElements.pop().checkParenting()
        }
        ,
        CanvasRendererBase.prototype.hide = function() {
            this.animationItem.container.style.display = "none"
        }
        ,
        CanvasRendererBase.prototype.show = function() {
            this.animationItem.container.style.display = "block"
        }
        ,
        extendPrototype([CanvasRendererBase, ICompElement, CVBaseElement], CVCompElement),
        CVCompElement.prototype.renderInnerContent = function() {
            var e, t = this.canvasContext;
            for (t.beginPath(),
            t.moveTo(0, 0),
            t.lineTo(this.data.w, 0),
            t.lineTo(this.data.w, this.data.h),
            t.lineTo(0, this.data.h),
            t.lineTo(0, 0),
            t.clip(),
            e = this.layers.length - 1; e >= 0; e -= 1)
                (this.completeLayers || this.elements[e]) && this.elements[e].renderFrame()
        }
        ,
        CVCompElement.prototype.destroy = function() {
            var e;
            for (e = this.layers.length - 1; e >= 0; e -= 1)
                this.elements[e] && this.elements[e].destroy();
            this.layers = null,
            this.elements = null
        }
        ,
        CVCompElement.prototype.createComp = function(e) {
            return new CVCompElement(e,this.globalData,this)
        }
        ,
        extendPrototype([CanvasRendererBase], CanvasRenderer),
        CanvasRenderer.prototype.createComp = function(e) {
            return new CVCompElement(e,this.globalData,this)
        }
        ,
        HBaseElement.prototype = {
            checkBlendMode: function() {},
            initRendererElement: function() {
                this.baseElement = createTag(this.data.tg || "div"),
                this.data.hasMask ? (this.svgElement = createNS("svg"),
                this.layerElement = createNS("g"),
                this.maskedElement = this.layerElement,
                this.svgElement.appendChild(this.layerElement),
                this.baseElement.appendChild(this.svgElement)) : this.layerElement = this.baseElement,
                styleDiv(this.baseElement)
            },
            createContainerElements: function() {
                this.renderableEffectsManager = new CVEffects,
                this.transformedElement = this.baseElement,
                this.maskedElement = this.layerElement,
                this.data.ln && this.layerElement.setAttribute("id", this.data.ln),
                this.data.cl && this.layerElement.setAttribute("class", this.data.cl),
                0 !== this.data.bm && this.setBlendMode()
            },
            renderElement: function() {
                var e = this.transformedElement ? this.transformedElement.style : {};
                if (this.finalTransform._matMdf) {
                    var t = this.finalTransform.mat.toCSS();
                    e.transform = t,
                    e.webkitTransform = t
                }
                this.finalTransform._opMdf && (e.opacity = this.finalTransform.mProp.o.v)
            },
            renderFrame: function() {
                this.data.hd || this.hidden || (this.renderTransform(),
                this.renderRenderable(),
                this.renderElement(),
                this.renderInnerContent(),
                this._isFirstFrame && (this._isFirstFrame = !1))
            },
            destroy: function() {
                this.layerElement = null,
                this.transformedElement = null,
                this.matteElement && (this.matteElement = null),
                this.maskManager && (this.maskManager.destroy(),
                this.maskManager = null)
            },
            createRenderableComponents: function() {
                this.maskManager = new MaskElement(this.data,this,this.globalData)
            },
            addEffects: function() {},
            setMatte: function() {}
        },
        HBaseElement.prototype.getBaseElement = SVGBaseElement.prototype.getBaseElement,
        HBaseElement.prototype.destroyBaseElement = HBaseElement.prototype.destroy,
        HBaseElement.prototype.buildElementParenting = BaseRenderer.prototype.buildElementParenting,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HierarchyElement, FrameElement, RenderableDOMElement], HSolidElement),
        HSolidElement.prototype.createContent = function() {
            var e;
            this.data.hasMask ? ((e = createNS("rect")).setAttribute("width", this.data.sw),
            e.setAttribute("height", this.data.sh),
            e.setAttribute("fill", this.data.sc),
            this.svgElement.setAttribute("width", this.data.sw),
            this.svgElement.setAttribute("height", this.data.sh)) : ((e = createTag("div")).style.width = this.data.sw + "px",
            e.style.height = this.data.sh + "px",
            e.style.backgroundColor = this.data.sc),
            this.layerElement.appendChild(e)
        }
        ,
        extendPrototype([BaseElement, TransformElement, HSolidElement, SVGShapeElement, HBaseElement, HierarchyElement, FrameElement, RenderableElement], HShapeElement),
        HShapeElement.prototype._renderShapeFrame = HShapeElement.prototype.renderInnerContent,
        HShapeElement.prototype.createContent = function() {
            var e;
            if (this.baseElement.style.fontSize = 0,
            this.data.hasMask)
                this.layerElement.appendChild(this.shapesContainer),
                e = this.svgElement;
            else {
                e = createNS("svg");
                var t = this.comp.data ? this.comp.data : this.globalData.compSize;
                e.setAttribute("width", t.w),
                e.setAttribute("height", t.h),
                e.appendChild(this.shapesContainer),
                this.layerElement.appendChild(e)
            }
            this.searchShapes(this.shapesData, this.itemsData, this.prevViewData, this.shapesContainer, 0, [], !0),
            this.filterUniqueShapes(),
            this.shapeCont = e
        }
        ,
        HShapeElement.prototype.getTransformedPoint = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                t = e[i].mProps.v.applyToPointArray(t[0], t[1], 0);
            return t
        }
        ,
        HShapeElement.prototype.calculateShapeBoundingBox = function(e, t) {
            var i, r, n, a, o, s = e.sh.v, l = e.transformers, h = s._length;
            if (!(h <= 1)) {
                for (i = 0; i < h - 1; i += 1)
                    r = this.getTransformedPoint(l, s.v[i]),
                    n = this.getTransformedPoint(l, s.o[i]),
                    a = this.getTransformedPoint(l, s.i[i + 1]),
                    o = this.getTransformedPoint(l, s.v[i + 1]),
                    this.checkBounds(r, n, a, o, t);
                s.c && (r = this.getTransformedPoint(l, s.v[i]),
                n = this.getTransformedPoint(l, s.o[i]),
                a = this.getTransformedPoint(l, s.i[0]),
                o = this.getTransformedPoint(l, s.v[0]),
                this.checkBounds(r, n, a, o, t))
            }
        }
        ,
        HShapeElement.prototype.checkBounds = function(e, t, i, r, n) {
            this.getBoundsOfCurve(e, t, i, r);
            var a = this.shapeBoundingBox;
            n.x = bmMin(a.left, n.x),
            n.xMax = bmMax(a.right, n.xMax),
            n.y = bmMin(a.top, n.y),
            n.yMax = bmMax(a.bottom, n.yMax)
        }
        ,
        HShapeElement.prototype.shapeBoundingBox = {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
        },
        HShapeElement.prototype.tempBoundingBox = {
            x: 0,
            xMax: 0,
            y: 0,
            yMax: 0,
            width: 0,
            height: 0
        },
        HShapeElement.prototype.getBoundsOfCurve = function(e, t, i, r) {
            for (var n, a, o, s, l, h, c, p = [[e[0], r[0]], [e[1], r[1]]], u = 0; u < 2; ++u)
                a = 6 * e[u] - 12 * t[u] + 6 * i[u],
                n = -3 * e[u] + 9 * t[u] - 9 * i[u] + 3 * r[u],
                o = 3 * t[u] - 3 * e[u],
                a |= 0,
                o |= 0,
                0 == (n |= 0) && 0 === a || (0 === n ? (s = -o / a) > 0 && s < 1 && p[u].push(this.calculateF(s, e, t, i, r, u)) : (l = a * a - 4 * o * n) >= 0 && ((h = (-a + bmSqrt(l)) / (2 * n)) > 0 && h < 1 && p[u].push(this.calculateF(h, e, t, i, r, u)),
                (c = (-a - bmSqrt(l)) / (2 * n)) > 0 && c < 1 && p[u].push(this.calculateF(c, e, t, i, r, u))));
            this.shapeBoundingBox.left = bmMin.apply(null, p[0]),
            this.shapeBoundingBox.top = bmMin.apply(null, p[1]),
            this.shapeBoundingBox.right = bmMax.apply(null, p[0]),
            this.shapeBoundingBox.bottom = bmMax.apply(null, p[1])
        }
        ,
        HShapeElement.prototype.calculateF = function(e, t, i, r, n, a) {
            return bmPow(1 - e, 3) * t[a] + 3 * bmPow(1 - e, 2) * e * i[a] + 3 * (1 - e) * bmPow(e, 2) * r[a] + bmPow(e, 3) * n[a]
        }
        ,
        HShapeElement.prototype.calculateBoundingBox = function(e, t) {
            var i, r = e.length;
            for (i = 0; i < r; i += 1)
                e[i] && e[i].sh ? this.calculateShapeBoundingBox(e[i], t) : e[i] && e[i].it && this.calculateBoundingBox(e[i].it, t)
        }
        ,
        HShapeElement.prototype.currentBoxContains = function(e) {
            return this.currentBBox.x <= e.x && this.currentBBox.y <= e.y && this.currentBBox.width + this.currentBBox.x >= e.x + e.width && this.currentBBox.height + this.currentBBox.y >= e.y + e.height
        }
        ,
        HShapeElement.prototype.renderInnerContent = function() {
            if (this._renderShapeFrame(),
            !this.hidden && (this._isFirstFrame || this._mdf)) {
                var e = this.tempBoundingBox
                  , t = 999999;
                if (e.x = t,
                e.xMax = -t,
                e.y = t,
                e.yMax = -t,
                this.calculateBoundingBox(this.itemsData, e),
                e.width = e.xMax < e.x ? 0 : e.xMax - e.x,
                e.height = e.yMax < e.y ? 0 : e.yMax - e.y,
                this.currentBoxContains(e))
                    return;
                var i = !1;
                if (this.currentBBox.w !== e.width && (this.currentBBox.w = e.width,
                this.shapeCont.setAttribute("width", e.width),
                i = !0),
                this.currentBBox.h !== e.height && (this.currentBBox.h = e.height,
                this.shapeCont.setAttribute("height", e.height),
                i = !0),
                i || this.currentBBox.x !== e.x || this.currentBBox.y !== e.y) {
                    this.currentBBox.w = e.width,
                    this.currentBBox.h = e.height,
                    this.currentBBox.x = e.x,
                    this.currentBBox.y = e.y,
                    this.shapeCont.setAttribute("viewBox", this.currentBBox.x + " " + this.currentBBox.y + " " + this.currentBBox.w + " " + this.currentBBox.h);
                    var r = this.shapeCont.style
                      , n = "translate(" + this.currentBBox.x + "px," + this.currentBBox.y + "px)";
                    r.transform = n,
                    r.webkitTransform = n
                }
            }
        }
        ,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HierarchyElement, FrameElement, RenderableDOMElement, ITextElement], HTextElement),
        HTextElement.prototype.createContent = function() {
            if (this.isMasked = this.checkMasks(),
            this.isMasked) {
                this.renderType = "svg",
                this.compW = this.comp.data.w,
                this.compH = this.comp.data.h,
                this.svgElement.setAttribute("width", this.compW),
                this.svgElement.setAttribute("height", this.compH);
                var e = createNS("g");
                this.maskedElement.appendChild(e),
                this.innerElem = e
            } else
                this.renderType = "html",
                this.innerElem = this.layerElement;
            this.checkParenting()
        }
        ,
        HTextElement.prototype.buildNewText = function() {
            var e = this.textProperty.currentData;
            this.renderedLetters = createSizedArray(e.l ? e.l.length : 0);
            var t = this.innerElem.style
              , i = e.fc ? this.buildColor(e.fc) : "rgba(0,0,0,0)";
            t.fill = i,
            t.color = i,
            e.sc && (t.stroke = this.buildColor(e.sc),
            t.strokeWidth = e.sw + "px");
            var r, n, a = this.globalData.fontManager.getFontByName(e.f);
            if (!this.globalData.fontManager.chars)
                if (t.fontSize = e.finalSize + "px",
                t.lineHeight = e.finalSize + "px",
                a.fClass)
                    this.innerElem.className = a.fClass;
                else {
                    t.fontFamily = a.fFamily;
                    var o = e.fWeight
                      , s = e.fStyle;
                    t.fontStyle = s,
                    t.fontWeight = o
                }
            var l, h, c, p = e.l;
            n = p.length;
            var u, d = this.mHelper, f = "", m = 0;
            for (r = 0; r < n; r += 1) {
                if (this.globalData.fontManager.chars ? (this.textPaths[m] ? l = this.textPaths[m] : ((l = createNS("path")).setAttribute("stroke-linecap", lineCapEnum[1]),
                l.setAttribute("stroke-linejoin", lineJoinEnum[2]),
                l.setAttribute("stroke-miterlimit", "4")),
                this.isMasked || (this.textSpans[m] ? c = (h = this.textSpans[m]).children[0] : ((h = createTag("div")).style.lineHeight = 0,
                (c = createNS("svg")).appendChild(l),
                styleDiv(h)))) : this.isMasked ? l = this.textPaths[m] ? this.textPaths[m] : createNS("text") : this.textSpans[m] ? (h = this.textSpans[m],
                l = this.textPaths[m]) : (styleDiv(h = createTag("span")),
                styleDiv(l = createTag("span")),
                h.appendChild(l)),
                this.globalData.fontManager.chars) {
                    var g, v = this.globalData.fontManager.getCharData(e.finalText[r], a.fStyle, this.globalData.fontManager.getFontByName(e.f).fFamily);
                    if (g = v ? v.data : null,
                    d.reset(),
                    g && g.shapes && g.shapes.length && (u = g.shapes[0].it,
                    d.scale(e.finalSize / 100, e.finalSize / 100),
                    f = this.createPathShape(d, u),
                    l.setAttribute("d", f)),
                    this.isMasked)
                        this.innerElem.appendChild(l);
                    else {
                        if (this.innerElem.appendChild(h),
                        g && g.shapes) {
                            document.body.appendChild(c);
                            var y = c.getBBox();
                            c.setAttribute("width", y.width + 2),
                            c.setAttribute("height", y.height + 2),
                            c.setAttribute("viewBox", y.x - 1 + " " + (y.y - 1) + " " + (y.width + 2) + " " + (y.height + 2));
                            var _ = c.style
                              , b = "translate(" + (y.x - 1) + "px," + (y.y - 1) + "px)";
                            _.transform = b,
                            _.webkitTransform = b,
                            p[r].yOffset = y.y - 1
                        } else
                            c.setAttribute("width", 1),
                            c.setAttribute("height", 1);
                        h.appendChild(c)
                    }
                } else if (l.textContent = p[r].val,
                l.setAttributeNS("http://www.w3.org/XML/1998/namespace", "xml:space", "preserve"),
                this.isMasked)
                    this.innerElem.appendChild(l);
                else {
                    this.innerElem.appendChild(h);
                    var x = l.style
                      , w = "translate3d(0," + -e.finalSize / 1.2 + "px,0)";
                    x.transform = w,
                    x.webkitTransform = w
                }
                this.isMasked ? this.textSpans[m] = l : this.textSpans[m] = h,
                this.textSpans[m].style.display = "block",
                this.textPaths[m] = l,
                m += 1
            }
            for (; m < this.textSpans.length; )
                this.textSpans[m].style.display = "none",
                m += 1
        }
        ,
        HTextElement.prototype.renderInnerContent = function() {
            var e;
            if (this.data.singleShape) {
                if (!this._isFirstFrame && !this.lettersChangedFlag)
                    return;
                if (this.isMasked && this.finalTransform._matMdf) {
                    this.svgElement.setAttribute("viewBox", -this.finalTransform.mProp.p.v[0] + " " + -this.finalTransform.mProp.p.v[1] + " " + this.compW + " " + this.compH),
                    e = this.svgElement.style;
                    var t = "translate(" + -this.finalTransform.mProp.p.v[0] + "px," + -this.finalTransform.mProp.p.v[1] + "px)";
                    e.transform = t,
                    e.webkitTransform = t
                }
            }
            if (this.textAnimator.getMeasures(this.textProperty.currentData, this.lettersChangedFlag),
            this.lettersChangedFlag || this.textAnimator.lettersChangedFlag) {
                var i, r, n, a, o, s = 0, l = this.textAnimator.renderedLetters, h = this.textProperty.currentData.l;
                for (r = h.length,
                i = 0; i < r; i += 1)
                    h[i].n ? s += 1 : (a = this.textSpans[i],
                    o = this.textPaths[i],
                    n = l[s],
                    s += 1,
                    n._mdf.m && (this.isMasked ? a.setAttribute("transform", n.m) : (a.style.webkitTransform = n.m,
                    a.style.transform = n.m)),
                    a.style.opacity = n.o,
                    n.sw && n._mdf.sw && o.setAttribute("stroke-width", n.sw),
                    n.sc && n._mdf.sc && o.setAttribute("stroke", n.sc),
                    n.fc && n._mdf.fc && (o.setAttribute("fill", n.fc),
                    o.style.color = n.fc));
                if (this.innerElem.getBBox && !this.hidden && (this._isFirstFrame || this._mdf)) {
                    var c = this.innerElem.getBBox();
                    if (this.currentBBox.w !== c.width && (this.currentBBox.w = c.width,
                    this.svgElement.setAttribute("width", c.width)),
                    this.currentBBox.h !== c.height && (this.currentBBox.h = c.height,
                    this.svgElement.setAttribute("height", c.height)),
                    this.currentBBox.w !== c.width + 2 || this.currentBBox.h !== c.height + 2 || this.currentBBox.x !== c.x - 1 || this.currentBBox.y !== c.y - 1) {
                        this.currentBBox.w = c.width + 2,
                        this.currentBBox.h = c.height + 2,
                        this.currentBBox.x = c.x - 1,
                        this.currentBBox.y = c.y - 1,
                        this.svgElement.setAttribute("viewBox", this.currentBBox.x + " " + this.currentBBox.y + " " + this.currentBBox.w + " " + this.currentBBox.h),
                        e = this.svgElement.style;
                        var p = "translate(" + this.currentBBox.x + "px," + this.currentBBox.y + "px)";
                        e.transform = p,
                        e.webkitTransform = p
                    }
                }
            }
        }
        ,
        extendPrototype([BaseElement, FrameElement, HierarchyElement], HCameraElement),
        HCameraElement.prototype.setup = function() {
            var e, t, i, r, n = this.comp.threeDElements.length;
            for (e = 0; e < n; e += 1)
                if ("3d" === (t = this.comp.threeDElements[e]).type) {
                    i = t.perspectiveElem.style,
                    r = t.container.style;
                    var a = this.pe.v + "px"
                      , o = "0px 0px 0px"
                      , s = "matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";
                    i.perspective = a,
                    i.webkitPerspective = a,
                    r.transformOrigin = o,
                    r.mozTransformOrigin = o,
                    r.webkitTransformOrigin = o,
                    i.transform = s,
                    i.webkitTransform = s
                }
        }
        ,
        HCameraElement.prototype.createElements = function() {}
        ,
        HCameraElement.prototype.hide = function() {}
        ,
        HCameraElement.prototype.renderFrame = function() {
            var e, t, i = this._isFirstFrame;
            if (this.hierarchy)
                for (t = this.hierarchy.length,
                e = 0; e < t; e += 1)
                    i = this.hierarchy[e].finalTransform.mProp._mdf || i;
            if (i || this.pe._mdf || this.p && this.p._mdf || this.px && (this.px._mdf || this.py._mdf || this.pz._mdf) || this.rx._mdf || this.ry._mdf || this.rz._mdf || this.or._mdf || this.a && this.a._mdf) {
                if (this.mat.reset(),
                this.hierarchy)
                    for (e = t = this.hierarchy.length - 1; e >= 0; e -= 1) {
                        var r = this.hierarchy[e].finalTransform.mProp;
                        this.mat.translate(-r.p.v[0], -r.p.v[1], r.p.v[2]),
                        this.mat.rotateX(-r.or.v[0]).rotateY(-r.or.v[1]).rotateZ(r.or.v[2]),
                        this.mat.rotateX(-r.rx.v).rotateY(-r.ry.v).rotateZ(r.rz.v),
                        this.mat.scale(1 / r.s.v[0], 1 / r.s.v[1], 1 / r.s.v[2]),
                        this.mat.translate(r.a.v[0], r.a.v[1], r.a.v[2])
                    }
                if (this.p ? this.mat.translate(-this.p.v[0], -this.p.v[1], this.p.v[2]) : this.mat.translate(-this.px.v, -this.py.v, this.pz.v),
                this.a) {
                    var n;
                    n = this.p ? [this.p.v[0] - this.a.v[0], this.p.v[1] - this.a.v[1], this.p.v[2] - this.a.v[2]] : [this.px.v - this.a.v[0], this.py.v - this.a.v[1], this.pz.v - this.a.v[2]];
                    var a = Math.sqrt(Math.pow(n[0], 2) + Math.pow(n[1], 2) + Math.pow(n[2], 2))
                      , o = [n[0] / a, n[1] / a, n[2] / a]
                      , s = Math.sqrt(o[2] * o[2] + o[0] * o[0])
                      , l = Math.atan2(o[1], s)
                      , h = Math.atan2(o[0], -o[2]);
                    this.mat.rotateY(h).rotateX(-l)
                }
                this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),
                this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),
                this.mat.translate(this.globalData.compSize.w / 2, this.globalData.compSize.h / 2, 0),
                this.mat.translate(0, 0, this.pe.v);
                var c = !this._prevMat.equals(this.mat);
                if ((c || this.pe._mdf) && this.comp.threeDElements) {
                    var p, u, d;
                    for (t = this.comp.threeDElements.length,
                    e = 0; e < t; e += 1)
                        if ("3d" === (p = this.comp.threeDElements[e]).type) {
                            if (c) {
                                var f = this.mat.toCSS();
                                (d = p.container.style).transform = f,
                                d.webkitTransform = f
                            }
                            this.pe._mdf && ((u = p.perspectiveElem.style).perspective = this.pe.v + "px",
                            u.webkitPerspective = this.pe.v + "px")
                        }
                    this.mat.clone(this._prevMat)
                }
            }
            this._isFirstFrame = !1
        }
        ,
        HCameraElement.prototype.prepareFrame = function(e) {
            this.prepareProperties(e, !0)
        }
        ,
        HCameraElement.prototype.destroy = function() {}
        ,
        HCameraElement.prototype.getBaseElement = function() {
            return null
        }
        ,
        extendPrototype([BaseElement, TransformElement, HBaseElement, HSolidElement, HierarchyElement, FrameElement, RenderableElement], HImageElement),
        HImageElement.prototype.createContent = function() {
            var e = this.globalData.getAssetsPath(this.assetData)
              , t = new Image;
            this.data.hasMask ? (this.imageElem = createNS("image"),
            this.imageElem.setAttribute("width", this.assetData.w + "px"),
            this.imageElem.setAttribute("height", this.assetData.h + "px"),
            this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink", "href", e),
            this.layerElement.appendChild(this.imageElem),
            this.baseElement.setAttribute("width", this.assetData.w),
            this.baseElement.setAttribute("height", this.assetData.h)) : this.layerElement.appendChild(t),
            t.crossOrigin = "anonymous",
            t.src = e,
            this.data.ln && this.baseElement.setAttribute("id", this.data.ln)
        }
        ,
        extendPrototype([BaseRenderer], HybridRendererBase),
        HybridRendererBase.prototype.buildItem = SVGRenderer.prototype.buildItem,
        HybridRendererBase.prototype.checkPendingElements = function() {
            for (; this.pendingElements.length; )
                this.pendingElements.pop().checkParenting()
        }
        ,
        HybridRendererBase.prototype.appendElementInPos = function(e, t) {
            var i = e.getBaseElement();
            if (i) {
                var r = this.layers[t];
                if (r.ddd && this.supports3d)
                    this.addTo3dContainer(i, t);
                else if (this.threeDElements)
                    this.addTo3dContainer(i, t);
                else {
                    for (var n, a, o = 0; o < t; )
                        this.elements[o] && !0 !== this.elements[o] && this.elements[o].getBaseElement && (a = this.elements[o],
                        n = (this.layers[o].ddd ? this.getThreeDContainerByPos(o) : a.getBaseElement()) || n),
                        o += 1;
                    n ? r.ddd && this.supports3d || this.layerElement.insertBefore(i, n) : r.ddd && this.supports3d || this.layerElement.appendChild(i)
                }
            }
        }
        ,
        HybridRendererBase.prototype.createShape = function(e) {
            return this.supports3d ? new HShapeElement(e,this.globalData,this) : new SVGShapeElement(e,this.globalData,this)
        }
        ,
        HybridRendererBase.prototype.createText = function(e) {
            return this.supports3d ? new HTextElement(e,this.globalData,this) : new SVGTextLottieElement(e,this.globalData,this)
        }
        ,
        HybridRendererBase.prototype.createCamera = function(e) {
            return this.camera = new HCameraElement(e,this.globalData,this),
            this.camera
        }
        ,
        HybridRendererBase.prototype.createImage = function(e) {
            return this.supports3d ? new HImageElement(e,this.globalData,this) : new IImageElement(e,this.globalData,this)
        }
        ,
        HybridRendererBase.prototype.createSolid = function(e) {
            return this.supports3d ? new HSolidElement(e,this.globalData,this) : new ISolidElement(e,this.globalData,this)
        }
        ,
        HybridRendererBase.prototype.createNull = SVGRenderer.prototype.createNull,
        HybridRendererBase.prototype.getThreeDContainerByPos = function(e) {
            for (var t = 0, i = this.threeDElements.length; t < i; ) {
                if (this.threeDElements[t].startPos <= e && this.threeDElements[t].endPos >= e)
                    return this.threeDElements[t].perspectiveElem;
                t += 1
            }
            return null
        }
        ,
        HybridRendererBase.prototype.createThreeDContainer = function(e, t) {
            var i, r, n = createTag("div");
            styleDiv(n);
            var a = createTag("div");
            if (styleDiv(a),
            "3d" === t) {
                (i = n.style).width = this.globalData.compSize.w + "px",
                i.height = this.globalData.compSize.h + "px";
                var o = "50% 50%";
                i.webkitTransformOrigin = o,
                i.mozTransformOrigin = o,
                i.transformOrigin = o;
                var s = "matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";
                (r = a.style).transform = s,
                r.webkitTransform = s
            }
            n.appendChild(a);
            var l = {
                container: a,
                perspectiveElem: n,
                startPos: e,
                endPos: e,
                type: t
            };
            return this.threeDElements.push(l),
            l
        }
        ,
        HybridRendererBase.prototype.build3dContainers = function() {
            var e, t, i = this.layers.length, r = "";
            for (e = 0; e < i; e += 1)
                this.layers[e].ddd && 3 !== this.layers[e].ty ? ("3d" !== r && (r = "3d",
                t = this.createThreeDContainer(e, "3d")),
                t.endPos = Math.max(t.endPos, e)) : ("2d" !== r && (r = "2d",
                t = this.createThreeDContainer(e, "2d")),
                t.endPos = Math.max(t.endPos, e));
            for (e = (i = this.threeDElements.length) - 1; e >= 0; e -= 1)
                this.resizerElem.appendChild(this.threeDElements[e].perspectiveElem)
        }
        ,
        HybridRendererBase.prototype.addTo3dContainer = function(e, t) {
            for (var i = 0, r = this.threeDElements.length; i < r; ) {
                if (t <= this.threeDElements[i].endPos) {
                    for (var n, a = this.threeDElements[i].startPos; a < t; )
                        this.elements[a] && this.elements[a].getBaseElement && (n = this.elements[a].getBaseElement()),
                        a += 1;
                    n ? this.threeDElements[i].container.insertBefore(e, n) : this.threeDElements[i].container.appendChild(e);
                    break
                }
                i += 1
            }
        }
        ,
        HybridRendererBase.prototype.configAnimation = function(e) {
            var t = createTag("div")
              , i = this.animationItem.wrapper
              , r = t.style;
            r.width = e.w + "px",
            r.height = e.h + "px",
            this.resizerElem = t,
            styleDiv(t),
            r.transformStyle = "flat",
            r.mozTransformStyle = "flat",
            r.webkitTransformStyle = "flat",
            this.renderConfig.className && t.setAttribute("class", this.renderConfig.className),
            i.appendChild(t),
            r.overflow = "hidden";
            var n = createNS("svg");
            n.setAttribute("width", "1"),
            n.setAttribute("height", "1"),
            styleDiv(n),
            this.resizerElem.appendChild(n);
            var a = createNS("defs");
            n.appendChild(a),
            this.data = e,
            this.setupGlobalData(e, n),
            this.globalData.defs = a,
            this.layers = e.layers,
            this.layerElement = this.resizerElem,
            this.build3dContainers(),
            this.updateContainerSize()
        }
        ,
        HybridRendererBase.prototype.destroy = function() {
            var e;
            this.animationItem.wrapper && (this.animationItem.wrapper.innerText = ""),
            this.animationItem.container = null,
            this.globalData.defs = null;
            var t = this.layers ? this.layers.length : 0;
            for (e = 0; e < t; e += 1)
                this.elements[e].destroy();
            this.elements.length = 0,
            this.destroyed = !0,
            this.animationItem = null
        }
        ,
        HybridRendererBase.prototype.updateContainerSize = function() {
            var e, t, i, r, n = this.animationItem.wrapper.offsetWidth, a = this.animationItem.wrapper.offsetHeight, o = n / a;
            this.globalData.compSize.w / this.globalData.compSize.h > o ? (e = n / this.globalData.compSize.w,
            t = n / this.globalData.compSize.w,
            i = 0,
            r = (a - this.globalData.compSize.h * (n / this.globalData.compSize.w)) / 2) : (e = a / this.globalData.compSize.h,
            t = a / this.globalData.compSize.h,
            i = (n - this.globalData.compSize.w * (a / this.globalData.compSize.h)) / 2,
            r = 0);
            var s = this.resizerElem.style;
            s.webkitTransform = "matrix3d(" + e + ",0,0,0,0," + t + ",0,0,0,0,1,0," + i + "," + r + ",0,1)",
            s.transform = s.webkitTransform
        }
        ,
        HybridRendererBase.prototype.renderFrame = SVGRenderer.prototype.renderFrame,
        HybridRendererBase.prototype.hide = function() {
            this.resizerElem.style.display = "none"
        }
        ,
        HybridRendererBase.prototype.show = function() {
            this.resizerElem.style.display = "block"
        }
        ,
        HybridRendererBase.prototype.initItems = function() {
            if (this.buildAllItems(),
            this.camera)
                this.camera.setup();
            else {
                var e, t = this.globalData.compSize.w, i = this.globalData.compSize.h, r = this.threeDElements.length;
                for (e = 0; e < r; e += 1) {
                    var n = this.threeDElements[e].perspectiveElem.style;
                    n.webkitPerspective = Math.sqrt(Math.pow(t, 2) + Math.pow(i, 2)) + "px",
                    n.perspective = n.webkitPerspective
                }
            }
        }
        ,
        HybridRendererBase.prototype.searchExtraCompositions = function(e) {
            var t, i = e.length, r = createTag("div");
            for (t = 0; t < i; t += 1)
                if (e[t].xt) {
                    var n = this.createComp(e[t], r, this.globalData.comp, null);
                    n.initExpressions(),
                    this.globalData.projectInterface.registerComposition(n)
                }
        }
        ,
        extendPrototype([HybridRendererBase, ICompElement, HBaseElement], HCompElement),
        HCompElement.prototype._createBaseContainerElements = HCompElement.prototype.createContainerElements,
        HCompElement.prototype.createContainerElements = function() {
            this._createBaseContainerElements(),
            this.data.hasMask ? (this.svgElement.setAttribute("width", this.data.w),
            this.svgElement.setAttribute("height", this.data.h),
            this.transformedElement = this.baseElement) : this.transformedElement = this.layerElement
        }
        ,
        HCompElement.prototype.addTo3dContainer = function(e, t) {
            for (var i, r = 0; r < t; )
                this.elements[r] && this.elements[r].getBaseElement && (i = this.elements[r].getBaseElement()),
                r += 1;
            i ? this.layerElement.insertBefore(e, i) : this.layerElement.appendChild(e)
        }
        ,
        HCompElement.prototype.createComp = function(e) {
            return this.supports3d ? new HCompElement(e,this.globalData,this) : new SVGCompElement(e,this.globalData,this)
        }
        ,
        extendPrototype([HybridRendererBase], HybridRenderer),
        HybridRenderer.prototype.createComp = function(e) {
            return this.supports3d ? new HCompElement(e,this.globalData,this) : new SVGCompElement(e,this.globalData,this)
        }
        ;
        var Expressions = {
            initExpressions: function(e) {
                var t = 0
                  , i = [];
                e.renderer.compInterface = CompExpressionInterface(e.renderer),
                e.renderer.globalData.projectInterface.registerComposition(e.renderer),
                e.renderer.globalData.pushExpression = function() {
                    t += 1
                }
                ,
                e.renderer.globalData.popExpression = function() {
                    0 == (t -= 1) && function() {
                        var e, t = i.length;
                        for (e = 0; e < t; e += 1)
                            i[e].release();
                        i.length = 0
                    }()
                }
                ,
                e.renderer.globalData.registerExpressionProperty = function(e) {
                    -1 === i.indexOf(e) && i.push(e)
                }
            }
        };
        function _typeof$1(e) {
            return (_typeof$1 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        function seedRandom(e, t) {
            var i = this
              , r = 256
              , n = t.pow(r, 6)
              , a = t.pow(2, 52)
              , o = 2 * a
              , s = 255;
            function l(e) {
                var t, i = e.length, n = this, a = 0, o = n.i = n.j = 0, l = n.S = [];
                for (i || (e = [i++]); a < r; )
                    l[a] = a++;
                for (a = 0; a < r; a++)
                    l[a] = l[o = s & o + e[a % i] + (t = l[a])],
                    l[o] = t;
                n.g = function(e) {
                    for (var t, i = 0, a = n.i, o = n.j, l = n.S; e--; )
                        t = l[a = s & a + 1],
                        i = i * r + l[s & (l[a] = l[o = s & o + t]) + (l[o] = t)];
                    return n.i = a,
                    n.j = o,
                    i
                }
            }
            function h(e, t) {
                return t.i = e.i,
                t.j = e.j,
                t.S = e.S.slice(),
                t
            }
            function c(e, t) {
                var i, r = [], n = _typeof$1(e);
                if (t && "object" == n)
                    for (i in e)
                        try {
                            r.push(c(e[i], t - 1))
                        } catch (a) {}
                return r.length ? r : "string" == n ? e : e + "\0"
            }
            function p(e, t) {
                for (var i, r = e + "", n = 0; n < r.length; )
                    t[s & n] = s & (i ^= 19 * t[s & n]) + r.charCodeAt(n++);
                return u(t)
            }
            function u(e) {
                return String.fromCharCode.apply(0, e)
            }
            t.seedrandom = function(s, d, f) {
                var m = []
                  , g = p(c((d = !0 === d ? {
                    entropy: !0
                } : d || {}).entropy ? [s, u(e)] : null === s ? function() {
                    try {
                        var t = new Uint8Array(r);
                        return (i.crypto || i.msCrypto).getRandomValues(t),
                        u(t)
                    } catch (o) {
                        var n = i.navigator
                          , a = n && n.plugins;
                        return [+new Date, i, a, i.screen, u(e)]
                    }
                }() : s, 3), m)
                  , v = new l(m)
                  , y = function() {
                    for (var e = v.g(6), t = n, i = 0; e < a; )
                        e = (e + i) * r,
                        t *= r,
                        i = v.g(1);
                    for (; e >= o; )
                        e /= 2,
                        t /= 2,
                        i >>>= 1;
                    return (e + i) / t
                };
                return y.int32 = function() {
                    return 0 | v.g(4)
                }
                ,
                y.quick = function() {
                    return v.g(4) / 4294967296
                }
                ,
                y.double = y,
                p(u(v.S), e),
                (d.pass || f || function(e, i, r, n) {
                    return n && (n.S && h(n, v),
                    e.state = function() {
                        return h(v, {})
                    }
                    ),
                    r ? (t.random = e,
                    i) : e
                }
                )(y, g, "global"in d ? d.global : this == t, d.state)
            }
            ,
            p(t.random(), e)
        }
        function initialize$2(e) {
            seedRandom([], e)
        }
        var propTypes = {
            SHAPE: "shape"
        };
        function _typeof(e) {
            return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
            )(e)
        }
        var ExpressionManager = function() {
            var ob = {}
              , Math = BMMath
              , window = null
              , document = null
              , XMLHttpRequest = null
              , fetch = null
              , frames = null;
            function $bm_isInstanceOfArray(e) {
                return e.constructor === Array || e.constructor === Float32Array
            }
            function isNumerable(e, t) {
                return "number" === e || "boolean" === e || "string" === e || t instanceof Number
            }
            function $bm_neg(e) {
                var t = _typeof(e);
                if ("number" === t || "boolean" === t || e instanceof Number)
                    return -e;
                if ($bm_isInstanceOfArray(e)) {
                    var i, r = e.length, n = [];
                    for (i = 0; i < r; i += 1)
                        n[i] = -e[i];
                    return n
                }
                return e.propType ? e.v : -e
            }
            initialize$2(BMMath);
            var easeInBez = BezierFactory.getBezierEasing(.333, 0, .833, .833, "easeIn").get
              , easeOutBez = BezierFactory.getBezierEasing(.167, .167, .667, 1, "easeOut").get
              , easeInOutBez = BezierFactory.getBezierEasing(.33, 0, .667, 1, "easeInOut").get;
            function sum(e, t) {
                var i = _typeof(e)
                  , r = _typeof(t);
                if ("string" === i || "string" === r)
                    return e + t;
                if (isNumerable(i, e) && isNumerable(r, t))
                    return e + t;
                if ($bm_isInstanceOfArray(e) && isNumerable(r, t))
                    return (e = e.slice(0))[0] += t,
                    e;
                if (isNumerable(i, e) && $bm_isInstanceOfArray(t))
                    return (t = t.slice(0))[0] = e + t[0],
                    t;
                if ($bm_isInstanceOfArray(e) && $bm_isInstanceOfArray(t)) {
                    for (var n = 0, a = e.length, o = t.length, s = []; n < a || n < o; )
                        ("number" == typeof e[n] || e[n]instanceof Number) && ("number" == typeof t[n] || t[n]instanceof Number) ? s[n] = e[n] + t[n] : s[n] = void 0 === t[n] ? e[n] : e[n] || t[n],
                        n += 1;
                    return s
                }
                return 0
            }
            var add = sum;
            function sub(e, t) {
                var i = _typeof(e)
                  , r = _typeof(t);
                if (isNumerable(i, e) && isNumerable(r, t))
                    return "string" === i && (e = parseInt(e, 10)),
                    "string" === r && (t = parseInt(t, 10)),
                    e - t;
                if ($bm_isInstanceOfArray(e) && isNumerable(r, t))
                    return (e = e.slice(0))[0] -= t,
                    e;
                if (isNumerable(i, e) && $bm_isInstanceOfArray(t))
                    return (t = t.slice(0))[0] = e - t[0],
                    t;
                if ($bm_isInstanceOfArray(e) && $bm_isInstanceOfArray(t)) {
                    for (var n = 0, a = e.length, o = t.length, s = []; n < a || n < o; )
                        ("number" == typeof e[n] || e[n]instanceof Number) && ("number" == typeof t[n] || t[n]instanceof Number) ? s[n] = e[n] - t[n] : s[n] = void 0 === t[n] ? e[n] : e[n] || t[n],
                        n += 1;
                    return s
                }
                return 0
            }
            function mul(e, t) {
                var i, r, n, a = _typeof(e), o = _typeof(t);
                if (isNumerable(a, e) && isNumerable(o, t))
                    return e * t;
                if ($bm_isInstanceOfArray(e) && isNumerable(o, t)) {
                    for (n = e.length,
                    i = createTypedArray("float32", n),
                    r = 0; r < n; r += 1)
                        i[r] = e[r] * t;
                    return i
                }
                if (isNumerable(a, e) && $bm_isInstanceOfArray(t)) {
                    for (n = t.length,
                    i = createTypedArray("float32", n),
                    r = 0; r < n; r += 1)
                        i[r] = e * t[r];
                    return i
                }
                return 0
            }
            function div(e, t) {
                var i, r, n, a = _typeof(e), o = _typeof(t);
                if (isNumerable(a, e) && isNumerable(o, t))
                    return e / t;
                if ($bm_isInstanceOfArray(e) && isNumerable(o, t)) {
                    for (n = e.length,
                    i = createTypedArray("float32", n),
                    r = 0; r < n; r += 1)
                        i[r] = e[r] / t;
                    return i
                }
                if (isNumerable(a, e) && $bm_isInstanceOfArray(t)) {
                    for (n = t.length,
                    i = createTypedArray("float32", n),
                    r = 0; r < n; r += 1)
                        i[r] = e / t[r];
                    return i
                }
                return 0
            }
            function mod(e, t) {
                return "string" == typeof e && (e = parseInt(e, 10)),
                "string" == typeof t && (t = parseInt(t, 10)),
                e % t
            }
            var $bm_sum = sum
              , $bm_sub = sub
              , $bm_mul = mul
              , $bm_div = div
              , $bm_mod = mod;
            function clamp(e, t, i) {
                if (t > i) {
                    var r = i;
                    i = t,
                    t = r
                }
                return Math.min(Math.max(e, t), i)
            }
            function radiansToDegrees(e) {
                return e / degToRads
            }
            var radians_to_degrees = radiansToDegrees;
            function degreesToRadians(e) {
                return e * degToRads
            }
            var degrees_to_radians = radiansToDegrees
              , helperLengthArray = [0, 0, 0, 0, 0, 0];
            function length(e, t) {
                if ("number" == typeof e || e instanceof Number)
                    return t = t || 0,
                    Math.abs(e - t);
                var i;
                t || (t = helperLengthArray);
                var r = Math.min(e.length, t.length)
                  , n = 0;
                for (i = 0; i < r; i += 1)
                    n += Math.pow(t[i] - e[i], 2);
                return Math.sqrt(n)
            }
            function normalize(e) {
                return div(e, length(e))
            }
            function rgbToHsl(e) {
                var t, i, r = e[0], n = e[1], a = e[2], o = Math.max(r, n, a), s = Math.min(r, n, a), l = (o + s) / 2;
                if (o === s)
                    t = 0,
                    i = 0;
                else {
                    var h = o - s;
                    switch (i = l > .5 ? h / (2 - o - s) : h / (o + s),
                    o) {
                    case r:
                        t = (n - a) / h + (n < a ? 6 : 0);
                        break;
                    case n:
                        t = (a - r) / h + 2;
                        break;
                    case a:
                        t = (r - n) / h + 4
                    }
                    t /= 6
                }
                return [t, i, l, e[3]]
            }
            function hue2rgb(e, t, i) {
                return i < 0 && (i += 1),
                i > 1 && (i -= 1),
                i < 1 / 6 ? e + 6 * (t - e) * i : i < .5 ? t : i < 2 / 3 ? e + (t - e) * (2 / 3 - i) * 6 : e
            }
            function hslToRgb(e) {
                var t, i, r, n = e[0], a = e[1], o = e[2];
                if (0 === a)
                    t = o,
                    r = o,
                    i = o;
                else {
                    var s = o < .5 ? o * (1 + a) : o + a - o * a
                      , l = 2 * o - s;
                    t = hue2rgb(l, s, n + 1 / 3),
                    i = hue2rgb(l, s, n),
                    r = hue2rgb(l, s, n - 1 / 3)
                }
                return [t, i, r, e[3]]
            }
            function linear(e, t, i, r, n) {
                if (void 0 !== r && void 0 !== n || (r = t,
                n = i,
                t = 0,
                i = 1),
                i < t) {
                    var a = i;
                    i = t,
                    t = a
                }
                if (e <= t)
                    return r;
                if (e >= i)
                    return n;
                var o, s = i === t ? 0 : (e - t) / (i - t);
                if (!r.length)
                    return r + (n - r) * s;
                var l = r.length
                  , h = createTypedArray("float32", l);
                for (o = 0; o < l; o += 1)
                    h[o] = r[o] + (n[o] - r[o]) * s;
                return h
            }
            function random(e, t) {
                if (void 0 === t && (void 0 === e ? (e = 0,
                t = 1) : (t = e,
                e = void 0)),
                t.length) {
                    var i, r = t.length;
                    e || (e = createTypedArray("float32", r));
                    var n = createTypedArray("float32", r)
                      , a = BMMath.random();
                    for (i = 0; i < r; i += 1)
                        n[i] = e[i] + a * (t[i] - e[i]);
                    return n
                }
                return void 0 === e && (e = 0),
                e + BMMath.random() * (t - e)
            }
            function createPath(e, t, i, r) {
                var n, a = e.length, o = shapePool.newElement();
                o.setPathData(!!r, a);
                var s, l, h = [0, 0];
                for (n = 0; n < a; n += 1)
                    s = t && t[n] ? t[n] : h,
                    l = i && i[n] ? i[n] : h,
                    o.setTripleAt(e[n][0], e[n][1], l[0] + e[n][0], l[1] + e[n][1], s[0] + e[n][0], s[1] + e[n][1], n, !0);
                return o
            }
            function initiateExpression(elem, data, property) {
                var val = data.x, needsVelocity = /velocity(?![\w\d])/.test(val), _needsRandom = -1 !== val.indexOf("random"), elemType = elem.data.ty, transform, $bm_transform, content, effect, thisProperty = property;
                thisProperty.valueAtTime = thisProperty.getValueAtTime,
                Object.defineProperty(thisProperty, "value", {
                    get: function() {
                        return thisProperty.v
                    }
                }),
                elem.comp.frameDuration = 1 / elem.comp.globalData.frameRate,
                elem.comp.displayStartTime = 0;
                var inPoint = elem.data.ip / elem.comp.globalData.frameRate, outPoint = elem.data.op / elem.comp.globalData.frameRate, width = elem.data.sw ? elem.data.sw : 0, height = elem.data.sh ? elem.data.sh : 0, name = elem.data.nm, loopIn, loop_in, loopOut, loop_out, smooth, toWorld, fromWorld, fromComp, toComp, fromCompToSurface, position, rotation, anchorPoint, scale, thisLayer, thisComp, mask, valueAtTime, velocityAtTime, scoped_bm_rt, expression_function = eval("[function _expression_function(){" + val + ";scoped_bm_rt=$bm_rt}]")[0], numKeys = property.kf ? data.k.length : 0, active = !this.data || !0 !== this.data.hd, wiggle = function(e, t) {
                    var i, r, n = this.pv.length ? this.pv.length : 1, a = createTypedArray("float32", n), o = Math.floor(5 * time);
                    for (i = 0,
                    r = 0; i < o; ) {
                        for (r = 0; r < n; r += 1)
                            a[r] += -t + 2 * t * BMMath.random();
                        i += 1
                    }
                    var s = 5 * time
                      , l = s - Math.floor(s)
                      , h = createTypedArray("float32", n);
                    if (n > 1) {
                        for (r = 0; r < n; r += 1)
                            h[r] = this.pv[r] + a[r] + (-t + 2 * t * BMMath.random()) * l;
                        return h
                    }
                    return this.pv + a[0] + (-t + 2 * t * BMMath.random()) * l
                }
                .bind(this);
                function loopInDuration(e, t) {
                    return loopIn(e, t, !0)
                }
                function loopOutDuration(e, t) {
                    return loopOut(e, t, !0)
                }
                thisProperty.loopIn && (loopIn = thisProperty.loopIn.bind(thisProperty),
                loop_in = loopIn),
                thisProperty.loopOut && (loopOut = thisProperty.loopOut.bind(thisProperty),
                loop_out = loopOut),
                thisProperty.smooth && (smooth = thisProperty.smooth.bind(thisProperty)),
                this.getValueAtTime && (valueAtTime = this.getValueAtTime.bind(this)),
                this.getVelocityAtTime && (velocityAtTime = this.getVelocityAtTime.bind(this));
                var comp = elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface), time, velocity, value, text, textIndex, textTotal, selectorValue;
                function lookAt(e, t) {
                    var i = [t[0] - e[0], t[1] - e[1], t[2] - e[2]]
                      , r = Math.atan2(i[0], Math.sqrt(i[1] * i[1] + i[2] * i[2])) / degToRads;
                    return [-Math.atan2(i[1], i[2]) / degToRads, r, 0]
                }
                function easeOut(e, t, i, r, n) {
                    return applyEase(easeOutBez, e, t, i, r, n)
                }
                function easeIn(e, t, i, r, n) {
                    return applyEase(easeInBez, e, t, i, r, n)
                }
                function ease(e, t, i, r, n) {
                    return applyEase(easeInOutBez, e, t, i, r, n)
                }
                function applyEase(e, t, i, r, n, a) {
                    void 0 === n ? (n = i,
                    a = r) : t = (t - i) / (r - i),
                    t > 1 ? t = 1 : t < 0 && (t = 0);
                    var o = e(t);
                    if ($bm_isInstanceOfArray(n)) {
                        var s, l = n.length, h = createTypedArray("float32", l);
                        for (s = 0; s < l; s += 1)
                            h[s] = (a[s] - n[s]) * o + n[s];
                        return h
                    }
                    return (a - n) * o + n
                }
                function nearestKey(e) {
                    var t, i, r, n = data.k.length;
                    if (data.k.length && "number" != typeof data.k[0])
                        if (i = -1,
                        (e *= elem.comp.globalData.frameRate) < data.k[0].t)
                            i = 1,
                            r = data.k[0].t;
                        else {
                            for (t = 0; t < n - 1; t += 1) {
                                if (e === data.k[t].t) {
                                    i = t + 1,
                                    r = data.k[t].t;
                                    break
                                }
                                if (e > data.k[t].t && e < data.k[t + 1].t) {
                                    e - data.k[t].t > data.k[t + 1].t - e ? (i = t + 2,
                                    r = data.k[t + 1].t) : (i = t + 1,
                                    r = data.k[t].t);
                                    break
                                }
                            }
                            -1 === i && (i = t + 1,
                            r = data.k[t].t)
                        }
                    else
                        i = 0,
                        r = 0;
                    var a = {};
                    return a.index = i,
                    a.time = r / elem.comp.globalData.frameRate,
                    a
                }
                function key(e) {
                    var t, i, r;
                    if (!data.k.length || "number" == typeof data.k[0])
                        throw new Error("The property has no keyframe at index " + e);
                    e -= 1,
                    t = {
                        time: data.k[e].t / elem.comp.globalData.frameRate,
                        value: []
                    };
                    var n = Object.prototype.hasOwnProperty.call(data.k[e], "s") ? data.k[e].s : data.k[e - 1].e;
                    for (r = n.length,
                    i = 0; i < r; i += 1)
                        t[i] = n[i],
                        t.value[i] = n[i];
                    return t
                }
                function framesToTime(e, t) {
                    return t || (t = elem.comp.globalData.frameRate),
                    e / t
                }
                function timeToFrames(e, t) {
                    return e || 0 === e || (e = time),
                    t || (t = elem.comp.globalData.frameRate),
                    e * t
                }
                function seedRandom(e) {
                    BMMath.seedrandom(randSeed + e)
                }
                function sourceRectAtTime() {
                    return elem.sourceRectAtTime()
                }
                function substring(e, t) {
                    return "string" == typeof value ? void 0 === t ? value.substring(e) : value.substring(e, t) : ""
                }
                function substr(e, t) {
                    return "string" == typeof value ? void 0 === t ? value.substr(e) : value.substr(e, t) : ""
                }
                function posterizeTime(e) {
                    time = 0 === e ? 0 : Math.floor(time * e) / e,
                    value = valueAtTime(time)
                }
                var index = elem.data.ind, hasParent = !(!elem.hierarchy || !elem.hierarchy.length), parent, randSeed = Math.floor(1e6 * Math.random()), globalData = elem.globalData;
                function executeExpression(e) {
                    return value = e,
                    this.frameExpressionId === elem.globalData.frameId && "textSelector" !== this.propType ? value : ("textSelector" === this.propType && (textIndex = this.textIndex,
                    textTotal = this.textTotal,
                    selectorValue = this.selectorValue),
                    thisLayer || (text = elem.layerInterface.text,
                    thisLayer = elem.layerInterface,
                    thisComp = elem.comp.compInterface,
                    toWorld = thisLayer.toWorld.bind(thisLayer),
                    fromWorld = thisLayer.fromWorld.bind(thisLayer),
                    fromComp = thisLayer.fromComp.bind(thisLayer),
                    toComp = thisLayer.toComp.bind(thisLayer),
                    mask = thisLayer.mask ? thisLayer.mask.bind(thisLayer) : null,
                    fromCompToSurface = fromComp),
                    transform || (transform = elem.layerInterface("ADBE Transform Group"),
                    $bm_transform = transform,
                    transform && (anchorPoint = transform.anchorPoint)),
                    4 !== elemType || content || (content = thisLayer("ADBE Root Vectors Group")),
                    effect || (effect = thisLayer(4)),
                    (hasParent = !(!elem.hierarchy || !elem.hierarchy.length)) && !parent && (parent = elem.hierarchy[0].layerInterface),
                    time = this.comp.renderedFrame / this.comp.globalData.frameRate,
                    _needsRandom && seedRandom(randSeed + time),
                    needsVelocity && (velocity = velocityAtTime(time)),
                    expression_function(),
                    this.frameExpressionId = elem.globalData.frameId,
                    scoped_bm_rt = scoped_bm_rt.propType === propTypes.SHAPE ? scoped_bm_rt.v : scoped_bm_rt)
                }
                return executeExpression.__preventDeadCodeRemoval = [$bm_transform, anchorPoint, time, velocity, inPoint, outPoint, width, height, name, loop_in, loop_out, smooth, toComp, fromCompToSurface, toWorld, fromWorld, mask, position, rotation, scale, thisComp, numKeys, active, wiggle, loopInDuration, loopOutDuration, comp, lookAt, easeOut, easeIn, ease, nearestKey, key, text, textIndex, textTotal, selectorValue, framesToTime, timeToFrames, sourceRectAtTime, substring, substr, posterizeTime, index, globalData],
                executeExpression
            }
            return ob.initiateExpression = initiateExpression,
            ob.__preventDeadCodeRemoval = [window, document, XMLHttpRequest, fetch, frames, $bm_neg, add, $bm_sum, $bm_sub, $bm_mul, $bm_div, $bm_mod, clamp, radians_to_degrees, degreesToRadians, degrees_to_radians, normalize, rgbToHsl, hslToRgb, linear, random, createPath],
            ob
        }()
          , expressionHelpers = {
            searchExpressions: function(e, t, i) {
                t.x && (i.k = !0,
                i.x = !0,
                i.initiateExpression = ExpressionManager.initiateExpression,
                i.effectsSequence.push(i.initiateExpression(e, t, i).bind(i)))
            },
            getSpeedAtTime: function(e) {
                var t = this.getValueAtTime(e)
                  , i = this.getValueAtTime(e + -.01)
                  , r = 0;
                if (t.length) {
                    var n;
                    for (n = 0; n < t.length; n += 1)
                        r += Math.pow(i[n] - t[n], 2);
                    r = 100 * Math.sqrt(r)
                } else
                    r = 0;
                return r
            },
            getVelocityAtTime: function(e) {
                if (void 0 !== this.vel)
                    return this.vel;
                var t, i, r = -.001, n = this.getValueAtTime(e), a = this.getValueAtTime(e + r);
                if (n.length)
                    for (t = createTypedArray("float32", n.length),
                    i = 0; i < n.length; i += 1)
                        t[i] = (a[i] - n[i]) / r;
                else
                    t = (a - n) / r;
                return t
            },
            getValueAtTime: function(e) {
                return e *= this.elem.globalData.frameRate,
                (e -= this.offsetTime) !== this._cachingAtTime.lastFrame && (this._cachingAtTime.lastIndex = this._cachingAtTime.lastFrame < e ? this._cachingAtTime.lastIndex : 0,
                this._cachingAtTime.value = this.interpolateValue(e, this._cachingAtTime),
                this._cachingAtTime.lastFrame = e),
                this._cachingAtTime.value
            },
            getStaticValueAtTime: function() {
                return this.pv
            },
            setGroupProperty: function(e) {
                this.propertyGroup = e
            }
        };
        function addPropertyDecorator() {
            function e(e, t, i) {
                if (!this.k || !this.keyframes)
                    return this.pv;
                e = e ? e.toLowerCase() : "";
                var r, n, a, o, s, l = this.comp.renderedFrame, h = this.keyframes, c = h[h.length - 1].t;
                if (l <= c)
                    return this.pv;
                if (i ? n = c - (r = t ? Math.abs(c - this.elem.comp.globalData.frameRate * t) : Math.max(0, c - this.elem.data.ip)) : ((!t || t > h.length - 1) && (t = h.length - 1),
                r = c - (n = h[h.length - 1 - t].t)),
                "pingpong" === e) {
                    if (Math.floor((l - n) / r) % 2 != 0)
                        return this.getValueAtTime((r - (l - n) % r + n) / this.comp.globalData.frameRate, 0)
                } else {
                    if ("offset" === e) {
                        var p = this.getValueAtTime(n / this.comp.globalData.frameRate, 0)
                          , u = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , d = this.getValueAtTime(((l - n) % r + n) / this.comp.globalData.frameRate, 0)
                          , f = Math.floor((l - n) / r);
                        if (this.pv.length) {
                            for (o = (s = new Array(p.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = (u[a] - p[a]) * f + d[a];
                            return s
                        }
                        return (u - p) * f + d
                    }
                    if ("continue" === e) {
                        var m = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , g = this.getValueAtTime((c - .001) / this.comp.globalData.frameRate, 0);
                        if (this.pv.length) {
                            for (o = (s = new Array(m.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = m[a] + (m[a] - g[a]) * ((l - c) / this.comp.globalData.frameRate) / 5e-4;
                            return s
                        }
                        return m + (l - c) / .001 * (m - g)
                    }
                }
                return this.getValueAtTime(((l - n) % r + n) / this.comp.globalData.frameRate, 0)
            }
            function t(e, t, i) {
                if (!this.k)
                    return this.pv;
                e = e ? e.toLowerCase() : "";
                var r, n, a, o, s, l = this.comp.renderedFrame, h = this.keyframes, c = h[0].t;
                if (l >= c)
                    return this.pv;
                if (i ? n = c + (r = t ? Math.abs(this.elem.comp.globalData.frameRate * t) : Math.max(0, this.elem.data.op - c)) : ((!t || t > h.length - 1) && (t = h.length - 1),
                r = (n = h[t].t) - c),
                "pingpong" === e) {
                    if (Math.floor((c - l) / r) % 2 == 0)
                        return this.getValueAtTime(((c - l) % r + c) / this.comp.globalData.frameRate, 0)
                } else {
                    if ("offset" === e) {
                        var p = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , u = this.getValueAtTime(n / this.comp.globalData.frameRate, 0)
                          , d = this.getValueAtTime((r - (c - l) % r + c) / this.comp.globalData.frameRate, 0)
                          , f = Math.floor((c - l) / r) + 1;
                        if (this.pv.length) {
                            for (o = (s = new Array(p.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = d[a] - (u[a] - p[a]) * f;
                            return s
                        }
                        return d - (u - p) * f
                    }
                    if ("continue" === e) {
                        var m = this.getValueAtTime(c / this.comp.globalData.frameRate, 0)
                          , g = this.getValueAtTime((c + .001) / this.comp.globalData.frameRate, 0);
                        if (this.pv.length) {
                            for (o = (s = new Array(m.length)).length,
                            a = 0; a < o; a += 1)
                                s[a] = m[a] + (m[a] - g[a]) * (c - l) / .001;
                            return s
                        }
                        return m + (m - g) * (c - l) / .001
                    }
                }
                return this.getValueAtTime((r - ((c - l) % r + c)) / this.comp.globalData.frameRate, 0)
            }
            function i(e, t) {
                if (!this.k)
                    return this.pv;
                if (e = .5 * (e || .4),
                (t = Math.floor(t || 5)) <= 1)
                    return this.pv;
                var i, r, n = this.comp.renderedFrame / this.comp.globalData.frameRate, a = n - e, o = t > 1 ? (n + e - a) / (t - 1) : 1, s = 0, l = 0;
                for (i = this.pv.length ? createTypedArray("float32", this.pv.length) : 0; s < t; ) {
                    if (r = this.getValueAtTime(a + s * o),
                    this.pv.length)
                        for (l = 0; l < this.pv.length; l += 1)
                            i[l] += r[l];
                    else
                        i += r;
                    s += 1
                }
                if (this.pv.length)
                    for (l = 0; l < this.pv.length; l += 1)
                        i[l] /= t;
                else
                    i /= t;
                return i
            }
            function r(e) {
                this._transformCachingAtTime || (this._transformCachingAtTime = {
                    v: new Matrix
                });
                var t = this._transformCachingAtTime.v;
                if (t.cloneFromProps(this.pre.props),
                this.appliedTransformations < 1) {
                    var i = this.a.getValueAtTime(e);
                    t.translate(-i[0] * this.a.mult, -i[1] * this.a.mult, i[2] * this.a.mult)
                }
                if (this.appliedTransformations < 2) {
                    var r = this.s.getValueAtTime(e);
                    t.scale(r[0] * this.s.mult, r[1] * this.s.mult, r[2] * this.s.mult)
                }
                if (this.sk && this.appliedTransformations < 3) {
                    var n = this.sk.getValueAtTime(e)
                      , a = this.sa.getValueAtTime(e);
                    t.skewFromAxis(-n * this.sk.mult, a * this.sa.mult)
                }
                if (this.r && this.appliedTransformations < 4) {
                    var o = this.r.getValueAtTime(e);
                    t.rotate(-o * this.r.mult)
                } else if (!this.r && this.appliedTransformations < 4) {
                    var s = this.rz.getValueAtTime(e)
                      , l = this.ry.getValueAtTime(e)
                      , h = this.rx.getValueAtTime(e)
                      , c = this.or.getValueAtTime(e);
                    t.rotateZ(-s * this.rz.mult).rotateY(l * this.ry.mult).rotateX(h * this.rx.mult).rotateZ(-c[2] * this.or.mult).rotateY(c[1] * this.or.mult).rotateX(c[0] * this.or.mult)
                }
                if (this.data.p && this.data.p.s) {
                    var p = this.px.getValueAtTime(e)
                      , u = this.py.getValueAtTime(e);
                    if (this.data.p.z) {
                        var d = this.pz.getValueAtTime(e);
                        t.translate(p * this.px.mult, u * this.py.mult, -d * this.pz.mult)
                    } else
                        t.translate(p * this.px.mult, u * this.py.mult, 0)
                } else {
                    var f = this.p.getValueAtTime(e);
                    t.translate(f[0] * this.p.mult, f[1] * this.p.mult, -f[2] * this.p.mult)
                }
                return t
            }
            function n() {
                return this.v.clone(new Matrix)
            }
            var a = TransformPropertyFactory.getTransformProperty;
            TransformPropertyFactory.getTransformProperty = function(e, t, i) {
                var o = a(e, t, i);
                return o.dynamicProperties.length ? o.getValueAtTime = r.bind(o) : o.getValueAtTime = n.bind(o),
                o.setGroupProperty = expressionHelpers.setGroupProperty,
                o
            }
            ;
            var o = PropertyFactory.getProp;
            PropertyFactory.getProp = function(r, n, a, s, l) {
                var h = o(r, n, a, s, l);
                h.kf ? h.getValueAtTime = expressionHelpers.getValueAtTime.bind(h) : h.getValueAtTime = expressionHelpers.getStaticValueAtTime.bind(h),
                h.setGroupProperty = expressionHelpers.setGroupProperty,
                h.loopOut = e,
                h.loopIn = t,
                h.smooth = i,
                h.getVelocityAtTime = expressionHelpers.getVelocityAtTime.bind(h),
                h.getSpeedAtTime = expressionHelpers.getSpeedAtTime.bind(h),
                h.numKeys = 1 === n.a ? n.k.length : 0,
                h.propertyIndex = n.ix;
                var c = 0;
                return 0 !== a && (c = createTypedArray("float32", 1 === n.a ? n.k[0].s.length : n.k.length)),
                h._cachingAtTime = {
                    lastFrame: initialDefaultFrame,
                    lastIndex: 0,
                    value: c
                },
                expressionHelpers.searchExpressions(r, n, h),
                h.k && l.addDynamicProperty(h),
                h
            }
            ;
            var s = ShapePropertyFactory.getConstructorFunction()
              , l = ShapePropertyFactory.getKeyframedConstructorFunction();
            function h() {}
            h.prototype = {
                vertices: function(e, t) {
                    this.k && this.getValue();
                    var i, r = this.v;
                    void 0 !== t && (r = this.getValueAtTime(t, 0));
                    var n = r._length
                      , a = r[e]
                      , o = r.v
                      , s = createSizedArray(n);
                    for (i = 0; i < n; i += 1)
                        s[i] = "i" === e || "o" === e ? [a[i][0] - o[i][0], a[i][1] - o[i][1]] : [a[i][0], a[i][1]];
                    return s
                },
                points: function(e) {
                    return this.vertices("v", e)
                },
                inTangents: function(e) {
                    return this.vertices("i", e)
                },
                outTangents: function(e) {
                    return this.vertices("o", e)
                },
                isClosed: function() {
                    return this.v.c
                },
                pointOnPath: function(e, t) {
                    var i = this.v;
                    void 0 !== t && (i = this.getValueAtTime(t, 0)),
                    this._segmentsLength || (this._segmentsLength = bez.getSegmentsLength(i));
                    for (var r, n = this._segmentsLength, a = n.lengths, o = n.totalLength * e, s = 0, l = a.length, h = 0; s < l; ) {
                        if (h + a[s].addedLength > o) {
                            var c = s
                              , p = i.c && s === l - 1 ? 0 : s + 1
                              , u = (o - h) / a[s].addedLength;
                            r = bez.getPointInSegment(i.v[c], i.v[p], i.o[c], i.i[p], u, a[s]);
                            break
                        }
                        h += a[s].addedLength,
                        s += 1
                    }
                    return r || (r = i.c ? [i.v[0][0], i.v[0][1]] : [i.v[i._length - 1][0], i.v[i._length - 1][1]]),
                    r
                },
                vectorOnPath: function(e, t, i) {
                    1 == e ? e = this.v.c : 0 == e && (e = .999);
                    var r = this.pointOnPath(e, t)
                      , n = this.pointOnPath(e + .001, t)
                      , a = n[0] - r[0]
                      , o = n[1] - r[1]
                      , s = Math.sqrt(Math.pow(a, 2) + Math.pow(o, 2));
                    return 0 === s ? [0, 0] : "tangent" === i ? [a / s, o / s] : [-o / s, a / s]
                },
                tangentOnPath: function(e, t) {
                    return this.vectorOnPath(e, t, "tangent")
                },
                normalOnPath: function(e, t) {
                    return this.vectorOnPath(e, t, "normal")
                },
                setGroupProperty: expressionHelpers.setGroupProperty,
                getValueAtTime: expressionHelpers.getStaticValueAtTime
            },
            extendPrototype([h], s),
            extendPrototype([h], l),
            l.prototype.getValueAtTime = function(e) {
                return this._cachingAtTime || (this._cachingAtTime = {
                    shapeValue: shapePool.clone(this.pv),
                    lastIndex: 0,
                    lastTime: initialDefaultFrame
                }),
                e *= this.elem.globalData.frameRate,
                (e -= this.offsetTime) !== this._cachingAtTime.lastTime && (this._cachingAtTime.lastIndex = this._cachingAtTime.lastTime < e ? this._caching.lastIndex : 0,
                this._cachingAtTime.lastTime = e,
                this.interpolateShape(e, this._cachingAtTime.shapeValue, this._cachingAtTime)),
                this._cachingAtTime.shapeValue
            }
            ,
            l.prototype.initiateExpression = ExpressionManager.initiateExpression;
            var c = ShapePropertyFactory.getShapeProp;
            ShapePropertyFactory.getShapeProp = function(e, t, i, r, n) {
                var a = c(e, t, i, r, n);
                return a.propertyIndex = t.ix,
                a.lock = !1,
                3 === i ? expressionHelpers.searchExpressions(e, t.pt, a) : 4 === i && expressionHelpers.searchExpressions(e, t.ks, a),
                a.k && e.addDynamicProperty(a),
                a
            }
        }
        function initialize$1() {
            addPropertyDecorator()
        }
        function addDecorator() {
            TextProperty.prototype.getExpressionValue = function(e, t) {
                var i = this.calculateExpression(t);
                if (e.t !== i) {
                    var r = {};
                    return this.copyData(r, e),
                    r.t = i.toString(),
                    r.__complete = !1,
                    r
                }
                return e
            }
            ,
            TextProperty.prototype.searchProperty = function() {
                var e = this.searchKeyframes()
                  , t = this.searchExpressions();
                return this.kf = e || t,
                this.kf
            }
            ,
            TextProperty.prototype.searchExpressions = function() {
                return this.data.d.x ? (this.calculateExpression = ExpressionManager.initiateExpression.bind(this)(this.elem, this.data.d, this),
                this.addEffect(this.getExpressionValue.bind(this)),
                !0) : null
            }
        }
        function initialize() {
            addDecorator()
        }
        function SVGComposableEffect() {}
        function SVGTintFilter(e, t, i, r, n) {
            this.filterManager = t;
            var a = createNS("feColorMatrix");
            a.setAttribute("type", "matrix"),
            a.setAttribute("color-interpolation-filters", "linearRGB"),
            a.setAttribute("values", "0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),
            a.setAttribute("result", r + "_tint_1"),
            e.appendChild(a),
            (a = createNS("feColorMatrix")).setAttribute("type", "matrix"),
            a.setAttribute("color-interpolation-filters", "sRGB"),
            a.setAttribute("values", "1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),
            a.setAttribute("result", r + "_tint_2"),
            e.appendChild(a),
            this.matrixFilter = a;
            var o = this.createMergeNode(r, [n, r + "_tint_1", r + "_tint_2"]);
            e.appendChild(o)
        }
        function SVGFillFilter(e, t, i, r) {
            this.filterManager = t;
            var n = createNS("feColorMatrix");
            n.setAttribute("type", "matrix"),
            n.setAttribute("color-interpolation-filters", "sRGB"),
            n.setAttribute("values", "1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),
            n.setAttribute("result", r),
            e.appendChild(n),
            this.matrixFilter = n
        }
        function SVGStrokeEffect(e, t, i) {
            this.initialized = !1,
            this.filterManager = t,
            this.elem = i,
            this.paths = []
        }
        function SVGTritoneFilter(e, t, i, r) {
            this.filterManager = t;
            var n = createNS("feColorMatrix");
            n.setAttribute("type", "matrix"),
            n.setAttribute("color-interpolation-filters", "linearRGB"),
            n.setAttribute("values", "0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),
            e.appendChild(n);
            var a = createNS("feComponentTransfer");
            a.setAttribute("color-interpolation-filters", "sRGB"),
            a.setAttribute("result", r),
            this.matrixFilter = a;
            var o = createNS("feFuncR");
            o.setAttribute("type", "table"),
            a.appendChild(o),
            this.feFuncR = o;
            var s = createNS("feFuncG");
            s.setAttribute("type", "table"),
            a.appendChild(s),
            this.feFuncG = s;
            var l = createNS("feFuncB");
            l.setAttribute("type", "table"),
            a.appendChild(l),
            this.feFuncB = l,
            e.appendChild(a)
        }
        function SVGProLevelsFilter(e, t, i, r) {
            this.filterManager = t;
            var n = this.filterManager.effectElements
              , a = createNS("feComponentTransfer");
            (n[10].p.k || 0 !== n[10].p.v || n[11].p.k || 1 !== n[11].p.v || n[12].p.k || 1 !== n[12].p.v || n[13].p.k || 0 !== n[13].p.v || n[14].p.k || 1 !== n[14].p.v) && (this.feFuncR = this.createFeFunc("feFuncR", a)),
            (n[17].p.k || 0 !== n[17].p.v || n[18].p.k || 1 !== n[18].p.v || n[19].p.k || 1 !== n[19].p.v || n[20].p.k || 0 !== n[20].p.v || n[21].p.k || 1 !== n[21].p.v) && (this.feFuncG = this.createFeFunc("feFuncG", a)),
            (n[24].p.k || 0 !== n[24].p.v || n[25].p.k || 1 !== n[25].p.v || n[26].p.k || 1 !== n[26].p.v || n[27].p.k || 0 !== n[27].p.v || n[28].p.k || 1 !== n[28].p.v) && (this.feFuncB = this.createFeFunc("feFuncB", a)),
            (n[31].p.k || 0 !== n[31].p.v || n[32].p.k || 1 !== n[32].p.v || n[33].p.k || 1 !== n[33].p.v || n[34].p.k || 0 !== n[34].p.v || n[35].p.k || 1 !== n[35].p.v) && (this.feFuncA = this.createFeFunc("feFuncA", a)),
            (this.feFuncR || this.feFuncG || this.feFuncB || this.feFuncA) && (a.setAttribute("color-interpolation-filters", "sRGB"),
            e.appendChild(a)),
            (n[3].p.k || 0 !== n[3].p.v || n[4].p.k || 1 !== n[4].p.v || n[5].p.k || 1 !== n[5].p.v || n[6].p.k || 0 !== n[6].p.v || n[7].p.k || 1 !== n[7].p.v) && ((a = createNS("feComponentTransfer")).setAttribute("color-interpolation-filters", "sRGB"),
            a.setAttribute("result", r),
            e.appendChild(a),
            this.feFuncRComposed = this.createFeFunc("feFuncR", a),
            this.feFuncGComposed = this.createFeFunc("feFuncG", a),
            this.feFuncBComposed = this.createFeFunc("feFuncB", a))
        }
        function SVGDropShadowEffect(e, t, i, r, n) {
            var a = t.container.globalData.renderConfig.filterSize;
            e.setAttribute("x", a.x),
            e.setAttribute("y", a.y),
            e.setAttribute("width", a.width),
            e.setAttribute("height", a.height),
            this.filterManager = t;
            var o = createNS("feGaussianBlur");
            o.setAttribute("in", "SourceAlpha"),
            o.setAttribute("result", r + "_drop_shadow_1"),
            o.setAttribute("stdDeviation", "0"),
            this.feGaussianBlur = o,
            e.appendChild(o);
            var s = createNS("feOffset");
            s.setAttribute("dx", "25"),
            s.setAttribute("dy", "0"),
            s.setAttribute("in", r + "_drop_shadow_1"),
            s.setAttribute("result", r + "_drop_shadow_2"),
            this.feOffset = s,
            e.appendChild(s);
            var l = createNS("feFlood");
            l.setAttribute("flood-color", "#00ff00"),
            l.setAttribute("flood-opacity", "1"),
            l.setAttribute("result", r + "_drop_shadow_3"),
            this.feFlood = l,
            e.appendChild(l);
            var h = createNS("feComposite");
            h.setAttribute("in", r + "_drop_shadow_3"),
            h.setAttribute("in2", r + "_drop_shadow_2"),
            h.setAttribute("operator", "in"),
            h.setAttribute("result", r + "_drop_shadow_4"),
            e.appendChild(h);
            var c = this.createMergeNode(r, [r + "_drop_shadow_4", n]);
            e.appendChild(c)
        }
        SVGComposableEffect.prototype = {
            createMergeNode: function(e, t) {
                var i, r, n = createNS("feMerge");
                for (n.setAttribute("result", e),
                r = 0; r < t.length; r += 1)
                    (i = createNS("feMergeNode")).setAttribute("in", t[r]),
                    n.appendChild(i),
                    n.appendChild(i);
                return n
            }
        },
        extendPrototype([SVGComposableEffect], SVGTintFilter),
        SVGTintFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = this.filterManager.effectElements[2].p.v / 100;
                this.matrixFilter.setAttribute("values", i[0] - t[0] + " 0 0 0 " + t[0] + " " + (i[1] - t[1]) + " 0 0 0 " + t[1] + " " + (i[2] - t[2]) + " 0 0 0 " + t[2] + " 0 0 0 " + r + " 0")
            }
        }
        ,
        SVGFillFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[2].p.v
                  , i = this.filterManager.effectElements[6].p.v;
                this.matrixFilter.setAttribute("values", "0 0 0 0 " + t[0] + " 0 0 0 0 " + t[1] + " 0 0 0 0 " + t[2] + " 0 0 0 " + i + " 0")
            }
        }
        ,
        SVGStrokeEffect.prototype.initialize = function() {
            var e, t, i, r, n = this.elem.layerElement.children || this.elem.layerElement.childNodes;
            for (1 === this.filterManager.effectElements[1].p.v ? (r = this.elem.maskManager.masksProperties.length,
            i = 0) : r = 1 + (i = this.filterManager.effectElements[0].p.v - 1),
            (t = createNS("g")).setAttribute("fill", "none"),
            t.setAttribute("stroke-linecap", "round"),
            t.setAttribute("stroke-dashoffset", 1); i < r; i += 1)
                e = createNS("path"),
                t.appendChild(e),
                this.paths.push({
                    p: e,
                    m: i
                });
            if (3 === this.filterManager.effectElements[10].p.v) {
                var a = createNS("mask")
                  , o = createElementID();
                a.setAttribute("id", o),
                a.setAttribute("mask-type", "alpha"),
                a.appendChild(t),
                this.elem.globalData.defs.appendChild(a);
                var s = createNS("g");
                for (s.setAttribute("mask", "url(" + getLocationHref() + "#" + o + ")"); n[0]; )
                    s.appendChild(n[0]);
                this.elem.layerElement.appendChild(s),
                this.masker = a,
                t.setAttribute("stroke", "#fff")
            } else if (1 === this.filterManager.effectElements[10].p.v || 2 === this.filterManager.effectElements[10].p.v) {
                if (2 === this.filterManager.effectElements[10].p.v)
                    for (n = this.elem.layerElement.children || this.elem.layerElement.childNodes; n.length; )
                        this.elem.layerElement.removeChild(n[0]);
                this.elem.layerElement.appendChild(t),
                this.elem.layerElement.removeAttribute("mask"),
                t.setAttribute("stroke", "#fff")
            }
            this.initialized = !0,
            this.pathMasker = t
        }
        ,
        SVGStrokeEffect.prototype.renderFrame = function(e) {
            var t;
            this.initialized || this.initialize();
            var i, r, n = this.paths.length;
            for (t = 0; t < n; t += 1)
                if (-1 !== this.paths[t].m && (i = this.elem.maskManager.viewData[this.paths[t].m],
                r = this.paths[t].p,
                (e || this.filterManager._mdf || i.prop._mdf) && r.setAttribute("d", i.lastPath),
                e || this.filterManager.effectElements[9].p._mdf || this.filterManager.effectElements[4].p._mdf || this.filterManager.effectElements[7].p._mdf || this.filterManager.effectElements[8].p._mdf || i.prop._mdf)) {
                    var a;
                    if (0 !== this.filterManager.effectElements[7].p.v || 100 !== this.filterManager.effectElements[8].p.v) {
                        var o = .01 * Math.min(this.filterManager.effectElements[7].p.v, this.filterManager.effectElements[8].p.v)
                          , s = .01 * Math.max(this.filterManager.effectElements[7].p.v, this.filterManager.effectElements[8].p.v)
                          , l = r.getTotalLength();
                        a = "0 0 0 " + l * o + " ";
                        var h, c = l * (s - o), p = 1 + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01, u = Math.floor(c / p);
                        for (h = 0; h < u; h += 1)
                            a += "1 " + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01 + " ";
                        a += "0 " + 10 * l + " 0 0"
                    } else
                        a = "1 " + 2 * this.filterManager.effectElements[4].p.v * this.filterManager.effectElements[9].p.v * .01;
                    r.setAttribute("stroke-dasharray", a)
                }
            if ((e || this.filterManager.effectElements[4].p._mdf) && this.pathMasker.setAttribute("stroke-width", 2 * this.filterManager.effectElements[4].p.v),
            (e || this.filterManager.effectElements[6].p._mdf) && this.pathMasker.setAttribute("opacity", this.filterManager.effectElements[6].p.v),
            (1 === this.filterManager.effectElements[10].p.v || 2 === this.filterManager.effectElements[10].p.v) && (e || this.filterManager.effectElements[3].p._mdf)) {
                var d = this.filterManager.effectElements[3].p.v;
                this.pathMasker.setAttribute("stroke", "rgb(" + bmFloor(255 * d[0]) + "," + bmFloor(255 * d[1]) + "," + bmFloor(255 * d[2]) + ")")
            }
        }
        ,
        SVGTritoneFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = this.filterManager.effectElements[2].p.v
                  , n = r[0] + " " + i[0] + " " + t[0]
                  , a = r[1] + " " + i[1] + " " + t[1]
                  , o = r[2] + " " + i[2] + " " + t[2];
                this.feFuncR.setAttribute("tableValues", n),
                this.feFuncG.setAttribute("tableValues", a),
                this.feFuncB.setAttribute("tableValues", o)
            }
        }
        ,
        SVGProLevelsFilter.prototype.createFeFunc = function(e, t) {
            var i = createNS(e);
            return i.setAttribute("type", "table"),
            t.appendChild(i),
            i
        }
        ,
        SVGProLevelsFilter.prototype.getTableValue = function(e, t, i, r, n) {
            for (var a, o, s = 0, l = Math.min(e, t), h = Math.max(e, t), c = Array.call(null, {
                length: 256
            }), p = 0, u = n - r, d = t - e; s <= 256; )
                o = (a = s / 256) <= l ? d < 0 ? n : r : a >= h ? d < 0 ? r : n : r + u * Math.pow((a - e) / d, 1 / i),
                c[p] = o,
                p += 1,
                s += 256 / 255;
            return c.join(" ")
        }
        ,
        SVGProLevelsFilter.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t, i = this.filterManager.effectElements;
                this.feFuncRComposed && (e || i[3].p._mdf || i[4].p._mdf || i[5].p._mdf || i[6].p._mdf || i[7].p._mdf) && (t = this.getTableValue(i[3].p.v, i[4].p.v, i[5].p.v, i[6].p.v, i[7].p.v),
                this.feFuncRComposed.setAttribute("tableValues", t),
                this.feFuncGComposed.setAttribute("tableValues", t),
                this.feFuncBComposed.setAttribute("tableValues", t)),
                this.feFuncR && (e || i[10].p._mdf || i[11].p._mdf || i[12].p._mdf || i[13].p._mdf || i[14].p._mdf) && (t = this.getTableValue(i[10].p.v, i[11].p.v, i[12].p.v, i[13].p.v, i[14].p.v),
                this.feFuncR.setAttribute("tableValues", t)),
                this.feFuncG && (e || i[17].p._mdf || i[18].p._mdf || i[19].p._mdf || i[20].p._mdf || i[21].p._mdf) && (t = this.getTableValue(i[17].p.v, i[18].p.v, i[19].p.v, i[20].p.v, i[21].p.v),
                this.feFuncG.setAttribute("tableValues", t)),
                this.feFuncB && (e || i[24].p._mdf || i[25].p._mdf || i[26].p._mdf || i[27].p._mdf || i[28].p._mdf) && (t = this.getTableValue(i[24].p.v, i[25].p.v, i[26].p.v, i[27].p.v, i[28].p.v),
                this.feFuncB.setAttribute("tableValues", t)),
                this.feFuncA && (e || i[31].p._mdf || i[32].p._mdf || i[33].p._mdf || i[34].p._mdf || i[35].p._mdf) && (t = this.getTableValue(i[31].p.v, i[32].p.v, i[33].p.v, i[34].p.v, i[35].p.v),
                this.feFuncA.setAttribute("tableValues", t))
            }
        }
        ,
        extendPrototype([SVGComposableEffect], SVGDropShadowEffect),
        SVGDropShadowEffect.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                if ((e || this.filterManager.effectElements[4].p._mdf) && this.feGaussianBlur.setAttribute("stdDeviation", this.filterManager.effectElements[4].p.v / 4),
                e || this.filterManager.effectElements[0].p._mdf) {
                    var t = this.filterManager.effectElements[0].p.v;
                    this.feFlood.setAttribute("flood-color", rgbToHex(Math.round(255 * t[0]), Math.round(255 * t[1]), Math.round(255 * t[2])))
                }
                if ((e || this.filterManager.effectElements[1].p._mdf) && this.feFlood.setAttribute("flood-opacity", this.filterManager.effectElements[1].p.v / 255),
                e || this.filterManager.effectElements[2].p._mdf || this.filterManager.effectElements[3].p._mdf) {
                    var i = this.filterManager.effectElements[3].p.v
                      , r = (this.filterManager.effectElements[2].p.v - 90) * degToRads
                      , n = i * Math.cos(r)
                      , a = i * Math.sin(r);
                    this.feOffset.setAttribute("dx", n),
                    this.feOffset.setAttribute("dy", a)
                }
            }
        }
        ;
        var _svgMatteSymbols = [];
        function SVGMatte3Effect(e, t, i) {
            this.initialized = !1,
            this.filterManager = t,
            this.filterElem = e,
            this.elem = i,
            i.matteElement = createNS("g"),
            i.matteElement.appendChild(i.layerElement),
            i.matteElement.appendChild(i.transformedElement),
            i.baseElement = i.matteElement
        }
        function SVGGaussianBlurEffect(e, t, i, r) {
            e.setAttribute("x", "-100%"),
            e.setAttribute("y", "-100%"),
            e.setAttribute("width", "300%"),
            e.setAttribute("height", "300%"),
            this.filterManager = t;
            var n = createNS("feGaussianBlur");
            n.setAttribute("result", r),
            e.appendChild(n),
            this.feGaussianBlur = n
        }
        return SVGMatte3Effect.prototype.findSymbol = function(e) {
            for (var t = 0, i = _svgMatteSymbols.length; t < i; ) {
                if (_svgMatteSymbols[t] === e)
                    return _svgMatteSymbols[t];
                t += 1
            }
            return null
        }
        ,
        SVGMatte3Effect.prototype.replaceInParent = function(e, t) {
            var i = e.layerElement.parentNode;
            if (i) {
                for (var r, n = i.children, a = 0, o = n.length; a < o && n[a] !== e.layerElement; )
                    a += 1;
                a <= o - 2 && (r = n[a + 1]);
                var s = createNS("use");
                s.setAttribute("href", "#" + t),
                r ? i.insertBefore(s, r) : i.appendChild(s)
            }
        }
        ,
        SVGMatte3Effect.prototype.setElementAsMask = function(e, t) {
            if (!this.findSymbol(t)) {
                var i = createElementID()
                  , r = createNS("mask");
                r.setAttribute("id", t.layerId),
                r.setAttribute("mask-type", "alpha"),
                _svgMatteSymbols.push(t);
                var n = e.globalData.defs;
                n.appendChild(r);
                var a = createNS("symbol");
                a.setAttribute("id", i),
                this.replaceInParent(t, i),
                a.appendChild(t.layerElement),
                n.appendChild(a);
                var o = createNS("use");
                o.setAttribute("href", "#" + i),
                r.appendChild(o),
                t.data.hd = !1,
                t.show()
            }
            e.setMatte(t.layerId)
        }
        ,
        SVGMatte3Effect.prototype.initialize = function() {
            for (var e = this.filterManager.effectElements[0].p.v, t = this.elem.comp.elements, i = 0, r = t.length; i < r; )
                t[i] && t[i].data.ind === e && this.setElementAsMask(this.elem, t[i]),
                i += 1;
            this.initialized = !0
        }
        ,
        SVGMatte3Effect.prototype.renderFrame = function() {
            this.initialized || this.initialize()
        }
        ,
        SVGGaussianBlurEffect.prototype.renderFrame = function(e) {
            if (e || this.filterManager._mdf) {
                var t = .3 * this.filterManager.effectElements[0].p.v
                  , i = this.filterManager.effectElements[1].p.v
                  , r = 3 == i ? 0 : t
                  , n = 2 == i ? 0 : t;
                this.feGaussianBlur.setAttribute("stdDeviation", r + " " + n);
                var a = 1 == this.filterManager.effectElements[2].p.v ? "wrap" : "duplicate";
                this.feGaussianBlur.setAttribute("edgeMode", a)
            }
        }
        ,
        registerRenderer("canvas", CanvasRenderer),
        registerRenderer("html", HybridRenderer),
        registerRenderer("svg", SVGRenderer),
        ShapeModifiers.registerModifier("tm", TrimModifier),
        ShapeModifiers.registerModifier("pb", PuckerAndBloatModifier),
        ShapeModifiers.registerModifier("rp", RepeaterModifier),
        ShapeModifiers.registerModifier("rd", RoundCornersModifier),
        setExpressionsPlugin(Expressions),
        initialize$1(),
        initialize(),
        registerEffect(20, SVGTintFilter, !0),
        registerEffect(21, SVGFillFilter, !0),
        registerEffect(22, SVGStrokeEffect, !1),
        registerEffect(23, SVGTritoneFilter, !0),
        registerEffect(24, SVGProLevelsFilter, !0),
        registerEffect(25, SVGDropShadowEffect, !0),
        registerEffect(28, SVGMatte3Effect, !1),
        registerEffect(29, SVGGaussianBlurEffect, !0),
        lottie
    }
    ,
    module.exports = factory2())
}
)(lottie$1, lottie$1.exports);
var lottie = lottie$1.exports
  , About = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elCloseBtn = null,
        this.elTitle = null,
        this.elSubtitle = null,
        this.elSections = null,
        this.elDecorationContainer = null,
        this.elDecorationImages = null,
        this.elToSplit = [],
        this.elToObserve = [],
        this.elSplitedElements = [],
        this.lottieAnimation = null,
        this.lottieAnimationData = null,
        this.observer = null,
        this.opened = !1,
        this.inited = !1,
        this.scroll = {
            current: 0,
            target: 0,
            lerp: .1,
            limit: 0,
            offset: 0
        },
        this.drag = {
            currentElement: null,
            previousElement: null,
            dragging: !1,
            offsetX: 0,
            offsetY: 0,
            current: {
                x: 0,
                y: 0
            },
            target: {
                x: 0,
                y: 0
            },
            direction: 1,
            rotation: 0,
            velocity: 0,
            strength: 20
        },
        this.textColors = ["#76E0A7", "#E26CC1", "#F86F66", "#FABE66"]
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("page--about"),
            this.elComponent = this.elContainer.querySelector(".page--content"),
            this.elSection = document.querySelector(".about--sections"),
            this.elCloseBtn = document.getElementById("about-close-btn"),
            this.elTitle = document.querySelector(".about--summary-title"),
            this.elSubtitle = document.querySelector(".about--section-wrapper h3"),
            this.elSections = document.querySelectorAll(".about--section"),
            this.elDecorationContainer = document.querySelectorAll(".about--decoration-img"),
            this.elDecorationImages = document.querySelectorAll(".about--decoration-img img"),
            properties.loader.add("".concat(settings.DATA_PATH, "introAnimation.json"), {
                onLoad: function(t) {
                    e.lottieAnimationData = t
                }
            }),
            this.onScreen = this.onScreen.bind(this),
            this.observer = new IntersectionObserver(this.onScreen),
            this.onWheel = this.onWheel.bind(this),
            this.onImageMove = this.onImageMove.bind(this)
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            )),
            this.elCloseBtn.addEventListener("pointerdown", (function() {
                return e.hide()
            }
            )),
            browser.isDesktop && (this.elDecorationContainer.forEach((function(t) {
                t.addEventListener("pointerdown", (function(t) {
                    return e.onImageDown(t)
                }
                )),
                t.addEventListener("pointermove", (function(t) {
                    return e.onImageMove(t)
                }
                ))
            }
            )),
            window.addEventListener("pointerup", (function() {
                return e.onImageUp()
            }
            ))),
            input.onWheeled.add(this.onWheel),
            input.onMoved.add(this.onImageMove)
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            this.opened && e.target === this.elComponent && this.hide()
        }
    }, {
        key: "onImageDown",
        value: function(e) {
            if (this.drag.previousElement = e.target.parentNode,
            this.drag.previousElement.style.transformOrigin = "".concat(e.offsetX, "px ").concat(e.offsetY, "px"),
            this.drag.previousElement != this.drag.currentElement && (this.drag.target.x = 0,
            this.drag.current.x = 0),
            this.drag.currentElement = this.drag.previousElement,
            this.drag.direction = e.offsetY > this.drag.currentElement.querySelector("img").height / 2 ? 1 : -1,
            e.target.style.transitionDelay = "0s",
            e.target.style.transitionDuration = "0.2s",
            e.target.classList.add("holded"),
            "" !== this.drag.currentElement.style.transform) {
                var t = window.getComputedStyle(this.drag.currentElement).transform.match(/matrix.*\((.+)\)/)[1].split(", ")
                  , i = Number(t[4])
                  , r = Number(t[5]);
                this.drag.offsetX = i,
                this.drag.offsetY = r
            }
            this.drag.dragging = !0
        }
    }, {
        key: "onImageUp",
        value: function() {
            this.drag.currentElement && this.drag.currentElement.querySelector("img").classList.remove("holded"),
            this.drag.offsetX = 0,
            this.drag.offsetY = 0,
            this.drag.dragging = !1
        }
    }, {
        key: "onImageMove",
        value: function(e) {
            if (e.preventDefault && e.preventDefault(),
            this.drag.dragging) {
                var t = input.mousePixelXY.x - input.downPixelXY.x
                  , i = input.mousePixelXY.y - input.downPixelXY.y;
                this.drag.target.x = this.drag.offsetX + t,
                this.drag.target.y = this.drag.offsetY + i
            }
        }
    }, {
        key: "onScreen",
        value: function(e) {
            var t = this;
            e.forEach((function(e) {
                if (e.isIntersecting) {
                    var i = []
                      , r = e.target.querySelector("h4")
                      , n = e.target.querySelector("p")
                      , a = e.target.querySelector(".about--logo-animation");
                    i.push(r, n),
                    i.forEach((function(e) {
                        if (e) {
                            var i = e.querySelectorAll(".line-content")
                              , r = t.elSplitedElements.find((function(t) {
                                return t.elements[0] === e
                            }
                            ));
                            if (r && 0 != i.length) {
                                var n = 1e3 * Number(i[i.length - 1].style.getPropertyValue("--delay").split("s")[0]) + 900;
                                setTimeout((function() {
                                    t.opened && (r.revert(),
                                    t.elContainer.querySelectorAll("a[data-mouse-hover]") && t.elContainer.querySelectorAll("a[data-mouse-hover]").forEach((function(e, i) {
                                        e.style.setProperty("--color", t.textColors[i]),
                                        mouse.addEventOnDisplayNoneElement(e)
                                    }
                                    )))
                                }
                                ), n)
                            }
                        }
                    }
                    )),
                    a && setTimeout((function() {
                        t.lottieAnimation.play()
                    }
                    ), 300),
                    e.target.classList.add("is-visible")
                }
            }
            ))
        }
    }, {
        key: "onWheel",
        value: function(e, t, i) {
            if (this.opened) {
                var r = normalizeWheel(i).pixelY;
                this.scroll.target += r,
                this.scroll.target = math.clamp(this.scroll.target, 0, this.scroll.limit)
            }
        }
    }, {
        key: "show",
        value: function() {
            var e = this;
            this.elDecorationImages.forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(1 + t / 10, "s")
            }
            )),
            this.elContainer.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elComponent.classList.add("animate"),
            this.opened = !0,
            this.splitElements(),
            this.elToObserve.push(document.querySelector(".about--logo")),
            this.elToObserve.forEach((function(t) {
                return e.observer.observe(t)
            }
            )),
            properties.pauseStage = !0;
            var t = document.getElementById("aboutLogoAnimation");
            this.lottieAnimation = lottie.loadAnimation({
                container: t,
                renderer: "svg",
                loop: !1,
                autoplay: !1,
                animationData: this.lottieAnimationData
            }),
            this.inited || this.calculateLimit(),
            this.inited = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elComponent.classList.remove("animate"),
            this.elContainer.querySelectorAll(".is-visible").forEach((function(e) {
                return e.classList.remove("is-visible")
            }
            )),
            this.opened = !1,
            properties.pauseStage = !1,
            setTimeout((function() {
                e.elContainer.classList.remove("is-active"),
                e.elToSplit = [],
                e.elToObserve = [],
                e.elSplitedElements = [],
                e.elSubtitleChars = null,
                e.elTitleChars = null,
                e.lottieAnimation.destroy()
            }
            ), 700)
        }
    }, {
        key: "resize",
        value: function(e, t) {
            this.opened || this.calculateLimit()
        }
    }, {
        key: "calculateLimit",
        value: function() {
            this.scroll.limit = this.elSection.getBoundingClientRect().bottom - properties.rawHeight - 10
        }
    }, {
        key: "splitElements",
        value: function() {
            var e = this;
            this.elSections.forEach((function(t, i) {
                e.elToSplit.push({
                    element: t.querySelector("h4"),
                    delay: 0 === i ? .7 : 1 !== i || browser.isMobile ? .3 : 1.2
                }, {
                    element: t.querySelector("p"),
                    delay: 0 === i ? .7 : 1 !== i || browser.isMobile ? .5 : 1.2
                }),
                e.elToObserve.push(t, e.elSubtitle)
            }
            )),
            this.elTitleChars = DOMUtils$1.textSplit(this.elTitle, "chars, words", !0),
            this.elSubtitleChars = DOMUtils$1.textSplit(this.elSubtitle, "chars", !0),
            this.elToSplit.forEach((function(t, i) {
                e.elSplitedElements.push(DOMUtils$1.textSplit(t.element, t.type ? t.type : "lines", !0, t.delay))
            }
            ))
        }
    }, {
        key: "update",
        value: function(e) {
            this.opened && this.scroll.limit > 0 && browser.isDesktop && (this.scroll.current < .1 && (this.scroll.current = 0),
            this.scroll.current = math.lerp(this.scroll.current, this.scroll.target, this.scroll.lerp),
            this.elSection.style.transform = "translateY(".concat(-this.scroll.current, "px)"),
            this.drag.currentElement && (this.drag.velocity = (this.drag.target.x - this.drag.current.x) / this.drag.strength,
            this.drag.rotation = math.lerp(this.drag.rotation, this.drag.velocity, .1),
            this.drag.currentElement.style.transform = "translate3d(".concat(this.drag.target.x, "px, ").concat(this.drag.target.y, "px, 0) rotate(").concat(-this.drag.rotation * this.drag.direction, "rad)"),
            this.drag.current.x = this.drag.target.x,
            this.drag.current.y = this.drag.target.y))
        }
    }]),
    e
}()
  , about = new About
  , Popup = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elCloseBtn = null,
        this.elToAnimate = [],
        this.opened = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            this.elContainer = document.getElementById("component--".concat(e)),
            this.elComponent = this.elContainer.querySelector(".component--content"),
            this.elCloseBtn = this.elContainer.querySelector("#".concat(e, "-close-btn"))
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            )),
            this.elCloseBtn.addEventListener("pointerdown", (function() {
                return e.onCloseBtnClick()
            }
            )),
            this.elToAnimate.length > 0 && this._setDelay()
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            (this.opened && e.target === this.elComponent || this.opened && e.target === this.elContainer) && this.hide()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elComponent.classList.add("animate"),
            this.elContainer.classList.add("animate"),
            this.opened = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elComponent.classList.remove("animate"),
            this.elContainer.classList.remove("animate"),
            setTimeout((function() {
                e.elContainer.classList.remove("is-active"),
                e.elCopyURLBtn && e.elCopyURLBtn.classList.remove("copied")
            }
            ), 300),
            this.opened = !1
        }
    }, {
        key: "onCloseBtnClick",
        value: function() {
            this.hide()
        }
    }, {
        key: "_setDelay",
        value: function() {
            this.elToAnimate.forEach((function(e, t) {
                return e.style.animationDelay = "".concat(.1 + t / 10, "s")
            }
            ))
        }
    }]),
    e
}()
  , TermsOfUse = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elCloseBtn = null,
        this.elListContainer = null,
        this.opened = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("page--termsOfUse"),
            this.elContent = this.elContainer.querySelector(".page--content"),
            this.elCloseBtn = document.getElementById("termsOfUse-close-btn"),
            this.elListContainer = document.querySelector(".termsOfUse-list"),
            properties.loader.add(settings.DATA_PATH + "termsOfUse.json", {
                weight: 10,
                onLoad: function(t) {
                    e._createList(t)
                }
            })
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elCloseBtn.addEventListener("pointerdown", (function() {
                return e.hide()
            }
            )),
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elContent.classList.add("animate"),
            this.opened = !0,
            properties.pauseStage = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elContent.classList.remove("animate"),
            this.elContainer.querySelectorAll(".is-visible").forEach((function(e) {
                return e.classList.remove("is-visible")
            }
            )),
            this.opened = !1,
            properties.pauseStage = !1,
            setTimeout((function() {
                e.elContainer.classList.remove("is-active")
            }
            ), 700)
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            this.opened && e.target === this.elContent && this.hide()
        }
    }, {
        key: "_createList",
        value: function(e) {
            var t = this;
            e.entries.forEach((function(e) {
                var i = document.createElement("li");
                if (i.classList.add("list-item"),
                e.bulletList || e.numberList) {
                    var r = t._crerateHeadline(e.headline);
                    i.appendChild(r);
                    var n = t._createInnerList(e);
                    i.appendChild(n)
                } else {
                    var a = t._crerateHeadline(e.headline);
                    i.appendChild(a);
                    var o = t._createCopy(e.copy);
                    i.appendChild(o)
                }
                t.elListContainer.appendChild(i)
            }
            ))
        }
    }, {
        key: "_crerateHeadline",
        value: function(e) {
            var t = document.createElement("h3");
            return t.classList.add("list-item-headline"),
            t.innerHTML = e,
            t
        }
    }, {
        key: "_createCopy",
        value: function(e) {
            var t = document.createElement("p");
            t.classList.add("list-item-copy"),
            t.innerHTML = e;
            var i = t.getElementsByTagName("a");
            if (i.length)
                for (var r = 0; r < i.length; r++)
                    i[r].setAttribute("data-mouse-hover", "");
            return t
        }
    }, {
        key: "_createInnerList",
        value: function(e) {
            var t = this
              , i = document.createElement("ul")
              , r = e.bulletList || e.numberList
              , n = e.bulletList ? "bulletStyle" : e.numberList ? "numberedStyle" : "";
            return r.forEach((function(e) {
                var r = document.createElement("li");
                r.classList.add("list-item-inner", n);
                var a = t._createCopy(e.copy);
                r.appendChild(a),
                i.appendChild(r)
            }
            )),
            i
        }
    }]),
    e
}()
  , termsOfUse = new TermsOfUse
  , PrivacyAndCookie = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elCloseBtn = null,
        this.elListContainer = null,
        this.opened = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("page--privacyAndCookie"),
            this.elContent = this.elContainer.querySelector(".page--content"),
            this.elCloseBtn = document.getElementById("privacyAndCookie-close-btn"),
            this.elListContainer = document.querySelector(".privacyAndCookie-list"),
            properties.loader.add(settings.DATA_PATH + "privacyAndCookie.json", {
                weight: 10,
                onLoad: function(t) {
                    e._createList(t)
                }
            })
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.elCloseBtn.addEventListener("pointerdown", (function() {
                return e.hide()
            }
            )),
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elContent.classList.add("animate"),
            this.opened = !0,
            properties.pauseStage = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elContent.classList.remove("animate"),
            this.elContainer.querySelectorAll(".is-visible").forEach((function(e) {
                return e.classList.remove("is-visible")
            }
            )),
            this.opened = !1,
            properties.pauseStage = !1,
            setTimeout((function() {
                e.elContainer.classList.remove("is-active")
            }
            ), 700)
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            this.opened && e.target === this.elContent && this.hide()
        }
    }, {
        key: "_createList",
        value: function(e) {
            var t = this;
            e.entries.forEach((function(e) {
                var i = document.createElement("li");
                if (i.classList.add("list-item"),
                e.bulletList || e.numberList) {
                    var r = t._crerateHeadline(e.headline);
                    i.appendChild(r);
                    var n = t._createInnerList(e);
                    i.appendChild(n)
                } else {
                    var a = t._crerateHeadline(e.headline);
                    i.appendChild(a);
                    var o = t._createCopy(e.copy);
                    i.appendChild(o)
                }
                t.elListContainer.appendChild(i)
            }
            ))
        }
    }, {
        key: "_crerateHeadline",
        value: function(e) {
            var t = document.createElement("h3");
            return t.classList.add("list-item-headline"),
            t.innerHTML = e,
            t
        }
    }, {
        key: "_createCopy",
        value: function(e) {
            var t = document.createElement("p");
            t.classList.add("list-item-copy"),
            t.innerHTML = e;
            var i = t.getElementsByTagName("a");
            if (i.length)
                for (var r = 0; r < i.length; r++)
                    i[r].setAttribute("data-mouse-hover", "");
            return t
        }
    }, {
        key: "_createInnerList",
        value: function(e) {
            var t = this
              , i = document.createElement("ul")
              , r = e.bulletList || e.numberList
              , n = e.bulletList ? "bulletStyle" : e.numberList ? "numberedStyle" : "";
            return r.forEach((function(e) {
                var r = document.createElement("li");
                r.classList.add("list-item-inner", n);
                var a = t._createCopy(e.copy);
                r.appendChild(a),
                i.appendChild(r)
            }
            )),
            i
        }
    }]),
    e
}()
  , privacyAndCookie = new PrivacyAndCookie
  , MusicAudio = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "isActive", !0),
        _defineProperty2(this, "volume", 0),
        _defineProperty2(this, "listener", null),
        _defineProperty2(this, "_boundOnBodyClick", null),
        _defineProperty2(this, "_onBodyClicked", new MinSignal),
        _defineProperty2(this, "music", null)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this._boundOnBodyClick = function() {
                return e._onBodyClick()
            }
            ,
            input.onDowned.add(this._boundOnBodyClick);
            var t = AUDIO_DATA.music[0];
            t.url = settings.AUDIO_PATH + t.url;
            var i = new AudioItem;
            i.preInit(t),
            this.music = i
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.getListener((function(t) {
                e.music.init(t)
            }
            )),
            this.music.play()
        }
    }, {
        key: "getListener",
        value: function(e) {
            this.listener ? e(this.listener) : this._onBodyClicked.add(e)
        }
    }, {
        key: "update",
        value: function(e) {
            this.listener && (this.volume = math.saturate(this.volume + (this.isActive ? 1 : -1) * e),
            this.music.setFinalVolume(this.volume))
        }
    }, {
        key: "_onBodyClick",
        value: function() {
            input.onDowned.remove(this._boundOnBodyClick),
            this.listener = new AudioListener,
            this._onBodyClicked.dispatch(this.listener)
        }
    }]),
    e
}()
  , musicAudio = new MusicAudio
  , trackButtonSpriteSheetData = [{
    path: "tracks/special/tunnel/tunnelAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}, {
    path: "tracks/special/passing/passingAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}, {
    path: "tracks/up-down/upDownAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}, {
    path: "tracks/upAndDown/up/upAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}, {
    path: "tracks/upAndDown/down/downAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}, {
    path: "tracks/bin/binAnimation",
    spriteSheetWeight: 100,
    jsonWeight: 100
}]
  , TrackEditor = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elFooterContainer = null,
        this.elContainer = null,
        this.jsonSheets = [],
        this.spriteSheets = [],
        this.imgContainer = [],
        this.spriteAnimations = []
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("component--trackEditor"),
            this.elFooterContainer = document.getElementById("component--footer"),
            this.imgContainer = ['div[track-piece-type="special_0"]', 'div[track-piece-type="special_1"]', 'button[track-type="upAndDown"]', 'div[track-piece-type="upAndDown_0"]', 'div[track-piece-type="upAndDown_1"]', document.getElementById("trackEditor-deleteTrack-btn")],
            trackButtonSpriteSheetData.forEach((function(t, i) {
                e.spriteAnimations[i] = new spriteHandler({
                    btn: e.imgContainer[i]
                }),
                e.spriteAnimations[i].load(t.path)
            }
            )),
            trackButtons.preInit(this.elContainer)
        }
    }, {
        key: "init",
        value: function() {
            this.spriteAnimations.forEach((function(e) {
                return e.init({
                    hover: !0,
                    hoverOut: !0
                })
            }
            )),
            trackButtons.init()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            trackButtons.animeIn(),
            this.spriteAnimations.forEach((function(e) {
                return e.show()
            }
            ))
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "resize",
        value: function(e, t) {
            trackButtons.resize(e, t)
        }
    }, {
        key: "update",
        value: function(e) {
            this.spriteAnimations.forEach((function(t) {
                t && t.update(e)
            }
            ))
        }
    }]),
    e
}()
  , trackEditor = new TrackEditor
  , SwitchMode = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elTrackEditor = null,
        this.elCameraMode = null,
        this.elSwitchInput = null,
        this.activeMode = "editMode",
        this.isActive = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--switch-mode"),
            this.elSwitchModeBtn = this.elContainer.querySelector("#switch-mode-btn"),
            this.elSwitchContainer = this.elContainer.querySelector(".switch-container"),
            this.elTrackEditor = document.getElementById("component--trackEditor"),
            this.elCameraMode = document.getElementById("component--cameraMode"),
            this.elSwitchInput = this.elContainer.querySelector(".switch-input")
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerup", (function(t) {
                return e.onSwitchModeBtnUp(t)
            }
            )),
            this.elSwitchModeBtn.addEventListener("pointerdown", (function() {
                return e.onSwitchBtnDown()
            }
            )),
            this.elSwitchModeBtn.addEventListener("pointerup", (function() {
                return e.onSwitchBtnUp()
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            var e = this;
            this.elContainer.classList.add("is-active"),
            this.isActive = !0,
            this.addDelayToTrackEditorButton(),
            setTimeout((function() {
                e.elContainer.classList.add("animated")
            }
            ), 0)
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active"),
            this.isActive = !1
        }
    }, {
        key: "addDelayToTrackEditorButton",
        value: function() {
            this.elTrackEditor.querySelectorAll(".trackEditor-btn-wrapper").forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(.2 + t / 30, "s")
            }
            ))
        }
    }, {
        key: "addDelayToCameraModeButton",
        value: function() {
            this.elCameraMode.querySelectorAll(".camera-btn").forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(.2 + t / 30, "s")
            }
            ))
        }
    }, {
        key: "resetDelayToTrackEditorButton",
        value: function() {
            this.elTrackEditor.querySelectorAll(".trackEditor-btn-wrapper").forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(t / 30, "s")
            }
            ))
        }
    }, {
        key: "resetDelayToTCameraModeButton",
        value: function() {
            this.elCameraMode.querySelectorAll(".camera-btn").forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(t / 30, "s")
            }
            ))
        }
    }, {
        key: "onSwitchModeBtnUp",
        value: function() {
            this.elSwitchContainer.classList.remove("pressed")
        }
    }, {
        key: "onSwitchBtnDown",
        value: function() {
            this.elSwitchContainer.classList.add("pressed")
        }
    }, {
        key: "onSwitchBtnUp",
        value: function() {
            this.elSwitchInput.checked ? (player.elContainer.classList.remove("camera-mode"),
            soundAudio.playSound("build-mode"),
            player.elPlayPauseBtn.style.transitionDelay = "0.1s",
            player.elResetBtn.style.transitionDelay = "0s",
            cameraSpin.elBtn.style.transitionDelay = "0.3s",
            cameraSpin.elContainer.classList.add("animated")) : (player.elContainer.classList.add("camera-mode"),
            soundAudio.playSound("camera-mode"),
            player.elPlayPauseBtn.style.transitionDelay = "0.1s",
            player.elResetBtn.style.transitionDelay = "0.2s",
            cameraSpin.elBtn.style.transitionDelay = "0.1s",
            cameraSpin.elContainer.classList.remove("animated"))
        }
    }, {
        key: "setMode",
        value: function(e) {
            this.activeMode !== e && (this.elTrackEditor.classList.contains("animated") ? (this.elCameraMode.classList.remove("delay"),
            this.elTrackEditor.classList.add("delay"),
            this.addDelayToCameraModeButton(),
            this.resetDelayToTrackEditorButton()) : (this.elTrackEditor.classList.remove("delay"),
            this.elCameraMode.classList.add("delay"),
            this.addDelayToTrackEditorButton(),
            this.resetDelayToTCameraModeButton()),
            "editMode" === this.activeMode ? (cameraSpin.elBtn.classList.add("hide"),
            this.activeMode = "viewerMode",
            trackButtons.hideTrackBtnFolder(),
            trackButtons.animeOut(),
            cameraMode.activateCamModeFollow(),
            cameraMode.animeIn(),
            player.isPlaying || player.onPlayPauseBtnClick({
                automatic: !0
            })) : (cameraSpin.elBtn.classList.remove("hide"),
            this.activeMode = "editMode",
            train._stop(),
            player.isPlaying && player.onPlayPauseBtnClick({
                automatic: !0
            }),
            trackButtons.animeIn(),
            cameraMode.animeOut(),
            cameraMode.activateCamModeOverview()))
        }
    }, {
        key: "update",
        value: function() {
            !cameraControls$1._isTransitioning && this.isActive && (this.elSwitchInput.checked ? this.setMode("viewerMode") : this.setMode("editMode"))
        }
    }]),
    e
}()
  , switchMode = new SwitchMode
  , ToolTips = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elBackground = null,
        this.elComponent = null,
        this.elToolTips = [],
        this.elBtn = null,
        this.elStepsIndicator = null,
        this.elSkipBtn = null,
        this.previousToolTip = null,
        this.currentToolTip = null,
        this.previousStepIndicator = null,
        this.currentStepIndicator = null,
        this.lastClick = 0,
        this.enabled = !1,
        !settings.SHOW_TOOLTIP && localStorage.getItem("skipTooltip") || (this.enabled = !0),
        this.activeToolTip = 0,
        this.biggestToolTip = 0
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("component--toolTip"),
            this.elBackground = document.getElementById("component--toolTips-background"),
            this.elComponent = this.elContainer.querySelector(".component--content"),
            this.elBtn = this.elComponent.querySelector(".btn"),
            this.elStepsIndicator = document.querySelectorAll(".toolTips-steps-indicator"),
            this.elSkipBtn = document.querySelector(".toolTips-skip"),
            document.querySelectorAll(".toolTip").forEach((function(t) {
                e.elToolTips.push({
                    element: t,
                    illustration: t.querySelector(".toolTip-illustration"),
                    title: t.querySelector(".toolTip-title"),
                    description: t.querySelector(".toolTip-description"),
                    descriptionMobile: t.querySelector(".toolTip-description-mobile")
                })
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerup", (function() {
                return e.onWindowPointerUp()
            }
            )),
            this.elBtn.addEventListener("pointerdown", (function() {
                return e.onBtnPointerDown()
            }
            )),
            this.elStepsIndicator.forEach((function(t) {
                return t.addEventListener("pointerdown", (function(t) {
                    return e.stepsContainerPointerDown(t)
                }
                ))
            }
            )),
            this.elSkipBtn.addEventListener("pointerdown", (function() {
                return e.onSkipBtnClick()
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elBackground.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elComponent.classList.add("animate"),
            this.elBackground.classList.add("animate"),
            soundAudio.playRollover(),
            this.splitElements(),
            this.changeToolTip()
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.elComponent.classList.remove("animate"),
            this.elBackground.classList.remove("animate"),
            localStorage.setItem("skipTooltip", !0),
            soundAudio.playRollover(),
            setTimeout((function() {
                e.elBackground.classList.remove("is-active"),
                e.elContainer.classList.remove("is-active"),
                e.elContainer.querySelectorAll(".active").forEach((function(e) {
                    return e.classList.remove("active")
                }
                )),
                e.elContainer.querySelectorAll(".was-active").forEach((function(e) {
                    return e.classList.remove("was-active")
                }
                )),
                e.activeToolTip = 0,
                e.biggestToolTip = 0
            }
            ), 500),
            this.removeIndexStyle()
        }
    }, {
        key: "stepsContainerPointerDown",
        value: function(e) {
            var t = Number(e.target.dataset.index);
            Date.now() - this.lastClick > 800 && t <= this.biggestToolTip && (this.previousToolTip = this.elToolTips[this.activeToolTip],
            this.previousStepIndicator = this.elStepsIndicator[this.activeToolTip],
            this.activeToolTip = t,
            this.changeToolTip())
        }
    }, {
        key: "onWindowPointerUp",
        value: function() {
            this.elBtn.classList.remove("pressed")
        }
    }, {
        key: "onBtnPointerDown",
        value: function() {
            this.elBtn.classList.add("pressed"),
            Date.now() - this.lastClick > 800 && (this.previousToolTip = this.elToolTips[this.activeToolTip],
            this.previousStepIndicator = this.elStepsIndicator[this.activeToolTip],
            this.activeToolTip < this.elToolTips.length - 1 ? (this.activeToolTip++,
            this.biggestToolTip <= this.activeToolTip && (this.biggestToolTip = this.activeToolTip),
            this.changeToolTip()) : this.hide())
        }
    }, {
        key: "splitElements",
        value: function() {
            this.elToolTips.forEach((function(e) {
                DOMUtils$1.textSplit(e.title, "words", !1).words,
                DOMUtils$1.textSplit(e.description, "lines", !1, .1).lines,
                e.descriptionMobile && DOMUtils$1.textSplit(e.descriptionMobile, "lines", !1, .1).lines
            }
            ))
        }
    }, {
        key: "changeToolTip",
        value: function() {
            var e = this;
            switch (this.currentToolTip = this.elToolTips[this.activeToolTip],
            this.currentStepIndicator = this.elStepsIndicator[this.activeToolTip],
            this.currentStepIndicator.style.pointerEvents = "auto",
            this.activeToolTip) {
            case 0:
                this.removeIndexStyle(),
                soundAudio.playRollover();
                break;
            case 1:
                this.removeIndexStyle(),
                this.addHighLight(cameraSpin),
                soundAudio.playRollover();
                break;
            case 2:
                this.removeIndexStyle(),
                this.addHighLight(trackEditor),
                soundAudio.playRollover();
                break;
            case 3:
                this.removeIndexStyle(),
                this.addHighLight(switchMode),
                soundAudio.playRollover();
                break;
            case 4:
                this.removeIndexStyle(),
                this.addHighLight(player),
                soundAudio.playRollover(),
                this.elBtn.classList.add("end")
            }
            this.previousToolTip && this.previousStepIndicator && this.previousToolTip != this.currentToolTip && (this.previousToolTip.element.classList.add("leave"),
            setTimeout((function() {
                e.previousToolTip.element.classList.remove("leave"),
                e.previousToolTip.element.classList.remove("active")
            }
            ), 800),
            this.previousStepIndicator.classList.remove("active")),
            this.currentToolTip.element.classList.add("active"),
            this.currentStepIndicator.classList.add("active"),
            this.currentStepIndicator.classList.add("was-active"),
            this.lastClick = Date.now()
        }
    }, {
        key: "addHighLight",
        value: function(e) {
            e.elContainer.classList.add("onboarding"),
            setTimeout((function() {
                e.elContainer.classList.add("animate")
            }
            ), 0)
        }
    }, {
        key: "removeIndexStyle",
        value: function() {
            cameraSpin.elContainer.classList.remove("onboarding"),
            trackEditor.elContainer.classList.remove("onboarding"),
            switchMode.elContainer.classList.remove("onboarding"),
            player.elContainer.classList.remove("onboarding"),
            cameraSpin.elContainer.classList.remove("animate"),
            trackEditor.elContainer.classList.remove("animate"),
            switchMode.elContainer.classList.remove("animate"),
            player.elContainer.classList.remove("animate"),
            this.elBtn.classList.remove("end")
        }
    }, {
        key: "onSkipBtnClick",
        value: function() {
            this.hide()
        }
    }]),
    e
}()
  , toolTips = new ToolTips
  , SettingsUI = function(e) {
    _inherits(i, Popup);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).hasAlreadyBeenOpened = !1,
        e.elBtn = null,
        e.elSwitch = null,
        e.elSwitchInput = null,
        e.elSwitchContainer = null,
        e.elAudioBtn = null,
        e.volumeSprite = null,
        e.elMusicBtn = null,
        e.musicSprite = null,
        e.elHelpBtn = null,
        e.helpSprite = null,
        e
    }
    return _createClass2(i, [{
        key: "preInit",
        value: function() {
            var e = this;
            _get(_getPrototypeOf(i.prototype), "preInit", this).call(this, "settings"),
            this.elBtn = document.getElementById("switch-day-night-btn"),
            this.elSwitch = document.querySelector(".switch-day-night"),
            this.elSwitchContainer = this.elContainer.querySelector(".switch-container"),
            this.elSwitchInput = this.elContainer.querySelector(".switch-input"),
            this.elToAnimate.push(document.querySelector(".settings-switch-day-night")),
            this.elAudioBtn = document.getElementById("settings-audio-btn"),
            this.elMusicBtn = document.getElementById("settings-music-btn"),
            this.elHelpBtn = document.getElementById("settings-help-btn"),
            document.querySelectorAll(".settings-row").forEach((function(t) {
                return e.elToAnimate.push(t)
            }
            )),
            this.volumeSprite = new spriteHandler({
                btn: this.elAudioBtn
            }),
            this.volumeSprite.load(["settings/volume/volumeOffHover", "settings/volume/volumeOnHover", "settings/volume/volumeOnToOff", "settings/volume/volumeOffToOn"]),
            this.musicSprite = new spriteHandler({
                btn: this.elMusicBtn,
                preventClickDelay: 1e3
            }),
            this.musicSprite.load(["settings/music/musicOffHover", "settings/music/musicOnHover", "settings/music/musicOnToOff", "settings/music/musicOffToOn"]),
            this.helpSprite = new spriteHandler({
                btn: this.elHelpBtn
            }),
            this.helpSprite.load("settings/help/helpAnimation"),
            this.elSwitchInput.checked = "N" === urlManager.dayCode
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            window.addEventListener("pointerup", (function(t) {
                return e.onSwitchModeBtnUp(t)
            }
            )),
            this.elSwitch.addEventListener("pointerdown", (function() {
                return e.onSwitchBtnDown()
            }
            )),
            this.elHelpBtn.addEventListener("pointerdown", (function() {
                return e.onHelpBtnDown()
            }
            )),
            this.elAudioBtn.addEventListener("pointerdown", (function() {
                return e.onAudioBtnClick()
            }
            )),
            this.elMusicBtn.addEventListener("pointerdown", (function() {
                return e.onMusicBtnClick()
            }
            )),
            this.volumeSprite.init({
                volume: !0
            }),
            this.musicSprite.init({
                volume: !0
            }),
            this.helpSprite.init({
                hover: !0,
                hoverOut: !0
            })
        }
    }, {
        key: "onSwitchModeBtnUp",
        value: function() {
            this.elSwitchContainer.classList.remove("pressed")
        }
    }, {
        key: "onSwitchBtnDown",
        value: function() {
            this.elSwitchContainer.classList.add("pressed")
        }
    }, {
        key: "onHelpBtnDown",
        value: function() {
            this.hide(),
            setTimeout((function() {
                toolTips.show()
            }
            ), 300)
        }
    }, {
        key: "show",
        value: function() {
            _get(_getPrototypeOf(i.prototype), "show", this).call(this),
            this.hasAlreadyBeenOpened || (this.volumeSprite.show(),
            this.musicSprite.show(),
            this.helpSprite.show()),
            this.hasAlreadyBeenOpened = !0
        }
    }, {
        key: "callbackAudio",
        value: function() {
            soundAudio.isActive = !soundAudio.isActive
        }
    }, {
        key: "callbackMusic",
        value: function() {
            musicAudio.isActive = !musicAudio.isActive
        }
    }, {
        key: "onAudioBtnClick",
        value: function() {
            this.volumeSprite.spriteAnimation.onClick(this.callbackAudio)
        }
    }, {
        key: "onMusicBtnClick",
        value: function() {
            this.musicSprite.spriteAnimation.onClick(this.callbackMusic)
        }
    }, {
        key: "update",
        value: function(e) {
            this.volumeSprite && this.volumeSprite.update(e),
            this.musicSprite && this.musicSprite.update(e),
            this.helpSprite && this.helpSprite.update(e),
            this.elSwitchInput.checked ? nightMode._toggleNightMode() : nightMode._toggleDayMode()
        }
    }]),
    i
}()
  , settingsUI = new SettingsUI
  , Share = function(e) {
    _inherits(i, Popup);
    var t = _createSuper(i);
    function i() {
        var e;
        return _classCallCheck2(this, i),
        (e = t.call(this)).elFbBtnLink = null,
        e.elTwBtnLink = null,
        e.elCopyURLBtn = null,
        e
    }
    return _createClass2(i, [{
        key: "preInit",
        value: function() {
            this.elFbBtnLink = document.getElementById("share-fb-btn-link"),
            this.elTwBtnLink = document.getElementById("share-tw-btn-link"),
            this.elCopyURLBtn = document.getElementById("share-copyURL-btn"),
            this.onCopyURLBtnClick = this.onCopyURLBtnClick.bind(this),
            _get(_getPrototypeOf(i.prototype), "preInit", this).call(this, "share")
        }
    }, {
        key: "init",
        value: function() {
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this.elCopyURLBtn.addEventListener("pointerdown", this.onCopyURLBtnClick)
        }
    }, {
        key: "show",
        value: function() {
            _get(_getPrototypeOf(i.prototype), "show", this).call(this),
            this._updateSocialSharingParams()
        }
    }, {
        key: "onCopyURLBtnClick",
        value: function() {
            var e = urlManager.getUrl();
            navigator.clipboard.writeText(e).then((function() {
                console.log("Copied ".concat(e, " to clipboard"))
            }
            ), (function(e) {
                console.log("`Failed to copy track URL to clipboard", e)
            }
            )),
            this.elCopyURLBtn.classList.add("copied")
        }
    }, {
        key: "_updateSocialSharingParams",
        value: function() {
            var e = urlManager.getDataParam()
              , t = "https://www.facebook.com/sharer/sharer.php?u=https://choochooworld.com/?DATA=".concat(e)
              , i = "https://twitter.com/intent/tweet?url=https://choochooworld.com/?DATA=".concat(e, "&via=choochoowld&hashtags=choochooworld&text=Check out my train set!");
            this.elFbBtnLink.href = t,
            this.elTwBtnLink.href = i
        }
    }]),
    i
}()
  , share = new Share
  , GUI = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            window.dat && (this._post(),
            this._io())
        }
    }, {
        key: "_exportSnapshot",
        value: function(e) {
            exporter.onStarted.add((function() {
                properties.isInDevMode && console.log("export started")
            }
            )),
            exporter.onUpdated.add((function(e) {
                properties.isInDevMode && console.log("export updating: " + (100 * e).toFixed(0) + "%")
            }
            )),
            exporter.onCompleted.add((function(t, i) {
                var r = document.querySelector(".snapshot-canvas");
                i.style = "position: absolute; top: 0; left: 0; z-index:1000; width: 100%; height: 100%;",
                r.appendChild(i),
                e(),
                properties.isInDevMode && console.log("export completed")
            }
            )),
            exporter.start(2400, 1600, 450, 450)
        }
    }, {
        key: "_downloadSnapshot",
        value: function() {
            exporter.downloadCanvas("snapshot", "png")
        }
    }, {
        key: "_io",
        value: function() {
            var e = this;
            (new dat.GUI).add({
                exportStart: function() {
                    return e._exportSnapshot()
                }
            }, "exportStart")
        }
    }, {
        key: "_post",
        value: function() {
            var e = new dat.GUI;
            if (properties.bloom) {
                var t = e.addFolder("bloom");
                t.add(properties, "bloomAmount", 0, 5, 1e-5),
                t.add(properties, "bloomRadius", -1, 1, 1e-5),
                t.add(properties, "bloomThreshold", 0, 1, 1e-5),
                t.add(properties, "bloomSmoothWidth", 0, 2, 1e-5),
                t.add(properties, "haloWidth", 0, 2, 1e-5),
                t.add(properties, "haloRGBShift", 0, .2, 1e-5),
                t.add(properties, "haloStrength", 0, 3, 1e-5),
                t.open()
            }
            if (properties.final) {
                var i = e.addFolder("color");
                i.add(properties, "vignetteFrom", 0, 3, 1e-5),
                i.add(properties, "vignetteTo", 0, 3, 1e-5),
                i.addColor(properties, "vignetteColorHex"),
                i.add(properties, "saturation", 0, 3, 1e-5),
                i.add(properties, "contrast", -1, 3, 1e-5),
                i.add(properties, "brightness", 0, 2, 1e-5),
                i.addColor(properties, "tintColorHex"),
                i.add(properties, "tintOpacity", 0, 1, 1e-5),
                i.open()
            }
            if (properties.bokeh) {
                var r = e.addFolder("bokeh");
                r.add(properties, "bokehFNumber", 1e-4, 1, 1e-5).listen(),
                r.add(properties, "bokehKFilmHeight", 1e-5, 90, 1e-5).listen(),
                r.open()
            }
        }
    }]),
    e
}()
  , gui = new GUI;
window.snapshot = function(e) {
    gui._exportSnapshot((function() {
        gui._downloadSnapshot()
    }
    ))
}
;
var Snapshot = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elComponent = null,
        this.elBackground = null,
        this.elDownloadBtn = null,
        this.elSnapshotCanvas = null,
        this.opened = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--snapshot"),
            this.elComponent = this.elContainer.querySelector(".component--content"),
            this.elBackground = this.elContainer.querySelector(".snapshot-background"),
            this.elSnapshotCanvas = document.getElementById("snapshotCanvas"),
            this.elDownloadBtn = document.getElementById("snapshot-download-btn")
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            window.addEventListener("pointerdown", (function(t) {
                return e.onWindowClick(t)
            }
            )),
            window.addEventListener("pointerup", (function() {
                return e.onWindowPointerUp()
            }
            )),
            this.elDownloadBtn.addEventListener("pointerdown", (function() {
                return e.onDownloadBtnClick()
            }
            ))
        }
    }, {
        key: "onDownloadBtnClick",
        value: function() {
            this.elDownloadBtn.classList.add("pressed"),
            gui._downloadSnapshot()
        }
    }, {
        key: "onWindowPointerUp",
        value: function() {
            this.elDownloadBtn.classList.remove("pressed")
        }
    }, {
        key: "onWindowClick",
        value: function(e) {
            this.opened && e.target === this.elComponent && this.hide()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elContainer.offsetWidth,
            this.elContainer.classList.add("animate"),
            gui._exportSnapshot(this._pauseStage),
            this.opened = !0
        }
    }, {
        key: "_pauseStage",
        value: function() {
            properties.pauseStage = !0
        }
    }, {
        key: "hide",
        value: function() {
            var e = this;
            this.opened && (this.elContainer.classList.add("animate-out"),
            setTimeout((function() {
                e.elContainer.classList.remove("animate-out"),
                e.elContainer.classList.remove("animate"),
                setTimeout((function() {
                    e.elContainer.classList.remove("is-active")
                }
                ), 500),
                properties.pauseStage = !1
            }
            ), 500)),
            this.opened = !1
        }
    }]),
    e
}(), snapshot = new Snapshot, Header = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elSettingsBtn = null,
        this.elSnapshotBtn = null,
        this.elAboutBtn = null,
        this.elShareBtn = null,
        this.elButtons = [],
        this.spriteAnimations = []
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            var e = this;
            this.elContainer = document.getElementById("component--header"),
            this.elSnapshotBtn = document.getElementById("header-snapshot"),
            this.elSettingsBtn = document.getElementById("header-settings-btn"),
            this.elAboutBtn = document.getElementById("header-about-btn"),
            this.elShareBtn = document.getElementById("header-share-btn"),
            this.elButtons.push(this.elSettingsBtn, this.elSnapshotBtn, this.elShareBtn, this.elAboutBtn);
            var t = ["header/settings/settingsAnimation", "header/snapshot/snapshotAnimation", "header/share/shareAnimation", "header/about/aboutAnimation"];
            this.elButtons.forEach((function(t, i) {
                e.spriteAnimations[i] = new spriteHandler({
                    btn: t
                })
            }
            )),
            this.spriteAnimations.forEach((function(e, i) {
                return e.load(t[i])
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            this.elSettingsBtn.addEventListener("pointerdown", this.onSettingsBtnClick),
            this.elSnapshotBtn.addEventListener("pointerdown", this.onSnapshotBtnClick),
            this.elAboutBtn.addEventListener("pointerdown", this.onAboutBtnClick),
            this.elShareBtn.addEventListener("pointerdown", this.onShareBtnClick),
            this.spriteAnimations.forEach((function(e) {
                return e.init({
                    hover: !0,
                    hoverOut: !0
                })
            }
            )),
            this.elButtons.forEach((function(e, t) {
                return e.style.transitionDelay = "".concat(.3 + t / 10, "s")
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.spriteAnimations.forEach((function(e) {
                return e.show()
            }
            )),
            this.elContainer.classList.add("animated")
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "onSnapshotBtnClick",
        value: function() {
            soundAudio.playSound("snapshot"),
            snapshot.show()
        }
    }, {
        key: "onGalleryBtnClick",
        value: function() {}
    }, {
        key: "onSettingsBtnClick",
        value: function() {
            settingsUI.show()
        }
    }, {
        key: "onAboutBtnClick",
        value: function() {
            about.show()
        }
    }, {
        key: "onShareBtnClick",
        value: function() {
            share.show()
        }
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "update",
        value: function(e) {
            this.spriteAnimations.forEach((function(t) {
                t && t.update(e)
            }
            ))
        }
    }]),
    e
}(), header = new Header, Home = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.lookDevGuiFolder = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("page--home"),
            cameraMode.preInit(),
            cameraSpin.preInit(),
            confirmDelete.preInit(),
            header.preInit(),
            nightMode.preInit(),
            settingsUI.preInit(),
            player.preInit(),
            share.preInit(),
            snapshot.preInit(),
            switchMode.preInit(),
            trackColors.preInit(),
            trackEditor.preInit(),
            toolTips.preInit()
        }
    }, {
        key: "init",
        value: function() {
            settings.LOOK_DEV_MODE && (this.lookDevGuiFolder = (new dat.GUI).addFolder("General"),
            this.lookDevGuiFolder.open()),
            cameraMode.init(),
            cameraSpin.init(),
            confirmDelete.init(),
            header.init(),
            nightMode.init(),
            settingsUI.init(),
            player.init(),
            share.init(),
            snapshot.init(),
            switchMode.init(),
            trackColors.init(this.lookDevGuiFolder),
            trackEditor.init(),
            toolTips.init()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.contains("is-active") || (this.elContainer.classList.add("is-active"),
            cameraSpin.show(),
            header.show(),
            player.show(),
            switchMode.show(),
            trackColors.show(),
            trackEditor.show(),
            cameraMode.show(),
            toolTips.enabled && toolTips.show())
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active")
        }
    }, {
        key: "resize",
        value: function(e, t) {
            trackEditor.resize(e, t)
        }
    }, {
        key: "update",
        value: function(e) {
            cameraMode.update(e),
            cameraSpin.update(e),
            header.update(e),
            nightMode.update(e),
            settingsUI.update(e),
            player.update(e),
            switchMode.update(),
            trackEditor.update(e),
            trackColors.update()
        }
    }]),
    e
}(), home = new Home, CameraControls = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            this.DEFAULT_CAMERA_POSITION = (new Vector3).set(0, .8, 1),
            this.DEFAULT_LOOKAT_POSITION = (new Vector3).set(0, .8, 0),
            this._brownianMotion = null,
            this._orbitControls = null,
            this._orbitCamera = null,
            this._camera = null,
            this._q = new Quaternion,
            this._e = new Euler,
            this._v1 = new Vector3,
            this._v2 = new Vector3,
            this._camera = properties.camera,
            this._camera.position.copy(this.DEFAULT_CAMERA_POSITION),
            this._brownianMotion = new BrownianMotion,
            this._orbitCamera = this._camera.clone(),
            this._orbitControls = new OrbitControls(this._orbitCamera,properties.canvas),
            this._orbitControls.screenSpacePanning = !1,
            this._orbitControls.target0.copy(this.DEFAULT_LOOKAT_POSITION),
            this._orbitControls.reset(),
            this._firstPersonCamera = this._camera.clone(),
            this._cameraTargetLerpFrom = new Vector3,
            this._cameraTargetLerpTo = new Vector3,
            this._cameraPositionLerpFrom = new Vector3,
            this._cameraPositionLerpTo = new Vector3,
            this._cameraMotionAmp = new InterpolationValue(0,0,0),
            this._cameraMotionFreq = new InterpolationValue(0,0,0),
            this._cameraMotionFov = new InterpolationValue(0,0,0),
            this._cameraFov = new InterpolationValue(this._camera.fov,this._camera.fov,this._camera.fov),
            this._cabOpacity = new InterpolationValue(1,1,1),
            this._lerpRatio = 0,
            this._transitionTimeSeconds = settings.SKIP_ANIMATION ? .25 : 2,
            this._isTransitioning = !1,
            this._firstPersonRatio = 0,
            this._cameraMode = "overview"
        }
    }, {
        key: "init",
        value: function() {
            this.cab = railway._getCabCar(),
            this.trackContainer = railway.trackContainer
        }
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "_mouseMoveCamera",
        value: function() {
            this._v1.set(0, 0, -1).applyQuaternion(this._camera.quaternion);
            var e = this._v2.copy(this._orbitControls.target).sub(this._camera.position).dot(this._v1);
            this._camera.translateZ(-1 * e),
            this._e.set(properties.cameraLookX, properties.cameraLookY, 0),
            this._q.setFromEuler(this._e),
            this._camera.quaternion.multiply(this._q),
            this._camera.translateZ(e),
            this._camera.updateMatrix()
        }
    }, {
        key: "_applyBrownianMotion",
        value: function(e) {
            var t = ease.cubicInOut(this._lerpRatio);
            this._cameraMotionFreq.lerp(t),
            this._cameraMotionAmp.lerp(t),
            this._cameraMotionFov.lerp(t),
            this._cameraFov.lerp(t),
            this._brownianMotion.positionAmplitude = this._cameraMotionAmp.value * properties.cameraShakePositionStrength,
            this._brownianMotion.positionFrequency = this._cameraMotionFreq.value * properties.cameraShakePositionSpeed,
            this._brownianMotion.rotationAmplitude = this._cameraMotionAmp.value * properties.cameraShakeRotationStrength,
            this._brownianMotion.rotationFrequency = this._cameraMotionFreq.value * properties.cameraShakeRotationSpeed,
            this._brownianMotion.update(e),
            this._camera.matrix.multiply(this._brownianMotion.matrix),
            this._cameraMotionFov.value *= this._brownianMotion._position.z,
            this._cameraFov.value += this._cameraMotionFov.value,
            this._camera.fov = this._cameraFov.value,
            this._camera.updateProjectionMatrix(),
            this._syncCamera()
        }
    }, {
        key: "_resetCamera",
        value: function() {
            this._camera.matrix.identity(),
            this._syncCamera(),
            this._camera.position.copy(this.DEFAULT_CAMERA_POSITION),
            this._camera.updateMatrix()
        }
    }, {
        key: "_applyOrbitControls",
        value: function() {
            this._orbitControls.update(),
            this._orbitCamera.updateMatrix(),
            this._syncCamera(this._orbitCamera.matrix)
        }
    }, {
        key: "_updateCameraDistance",
        value: function() {
            this._v1.set(0, 0, -1).applyQuaternion(this._camera.quaternion),
            properties.cameraDistance = this._v2.copy(this._orbitControls.target).sub(this._camera.position).dot(this._v1)
        }
    }, {
        key: "_syncCamera",
        value: function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this._camera.matrix;
            e.decompose(this._camera.position, this._camera.quaternion, this._camera.scale),
            this._camera.matrix.equals(e) || this._camera.updateMatrix()
        }
    }, {
        key: "_keepCameraAboveGround",
        value: function() {
            this._camera.position.y < .03 && (this._camera.position.y = .03)
        }
    }, {
        key: "followMode",
        value: function() {
            this._isTransitioning || "follow" === this._cameraMode || (this._cameraTargetLerpFrom = this._orbitControls.target.clone(),
            this._cameraTargetLerpTo = this.cab.frontPosition,
            "firstPerson" === this._cameraMode ? (this._cameraPositionLerpFrom = this._orbitControls.object.position.clone(),
            this._cameraPositionLerpTo = this._orbitControls.object.position.clone(),
            this._cameraPositionLerpTo.addScalar(.35)) : (this._cameraPositionLerpTo = null,
            this._cameraPositionLerpFrom = null),
            this._cameraMotionAmp.setNewTarget(2),
            this._cameraMotionFreq.setNewTarget(8),
            this._cameraMotionFov.setNewTarget(150),
            this._cameraFov.setNewTarget(40),
            this._cabOpacity.setNewTarget(1),
            this._orbitControls.enablePan = !1,
            this._orbitControls.enableRotate = !0,
            this._orbitControls.enableZoom = !0,
            this._cameraMode = "follow",
            this._transitionTimeSeconds = 1,
            this._startTransition())
        }
    }, {
        key: "overviewMode",
        value: function() {
            if (!this._isTransitioning) {
                this._cameraMotionAmp.setNewTarget(.5),
                this._cameraMotionFreq.setNewTarget(4),
                this._cameraMotionFov.setNewTarget(0),
                this._cameraFov.setNewTarget(60),
                this._cabOpacity.setNewTarget(1);
                var e = (new Box3).setFromObject(this.trackContainer).getSize(new Vector3)
                  , t = new Vector3(.03,.05,0)
                  , i = this._cameraFov.to * (Math.PI / 180)
                  , r = 2 * Math.atan(Math.tan(i / 2) * this._camera.aspect);
                e.z,
                Math.abs(e.x / 2 / Math.tan(r / 2)),
                e.z,
                Math.abs(e.y / 2 / Math.tan(i / 2));
                var n = t.clone();
                n.z += e.z + .35,
                n.y += .5 * e.y + .2,
                "overview" === this._cameraMode ? this._cameraTargetLerpFrom = this._orbitControls.target.clone() : this._cameraTargetLerpFrom = this._cameraTargetLerpTo,
                this._cameraPositionLerpFrom = this._orbitControls.object.position.clone(),
                this._cameraTargetLerpTo = t,
                this._cameraPositionLerpTo = n,
                this._orbitControls.enablePan = !0,
                this._orbitControls.enableRotate = !0,
                this._orbitControls.enableZoom = !0,
                this._orbitControls.enableDamping = !0,
                this._orbitControls.dampingFactor = .1,
                this._orbitControls.maxDistance = 1.75,
                this._orbitControls.minDistance = .35,
                this._orbitControls.maxPolarAngle = 1.58,
                this._orbitControls.minPolarAngle = 0,
                this._orbitControls.enablePanBorderCheck = !0,
                this._orbitControls.panBorderBounceFactor = .15,
                this._orbitControls.minPanBorderX = -properties.trackAreaSize,
                this._orbitControls.maxPanBorderX = properties.trackAreaSize,
                this._orbitControls.minPanBorderZ = properties.trackAreaSize,
                this._orbitControls.maxPanBorderZ = -properties.trackAreaSize,
                this._cameraMode = "overview",
                this._startTransition()
            }
        }
    }, {
        key: "firstPersonMode",
        value: function() {
            this._isTransitioning || "firstPerson" === this._cameraMode || (this._cameraTargetLerpFrom = this._orbitControls.target.clone(),
            this._cameraTargetLerpTo = this.cab.frontPosition,
            this._cameraPositionLerpFrom = this._orbitControls.object.position.clone(),
            this._cameraPositionLerpTo = this.cab.rearPosition,
            this._cameraMotionAmp.setNewTarget(.125),
            this._cameraMotionFreq.setNewTarget(2),
            this._cameraMotionFov.setNewTarget(0),
            this._cameraFov.setNewTarget(80),
            this._cabOpacity.setNewTarget(0),
            this._orbitControls.enablePan = !1,
            this._orbitControls.enableRotate = !1,
            this._orbitControls.enableZoom = !1,
            this._orbitControls.enableDamping = !1,
            this._orbitControls.minDistance = 0,
            this._cameraMode = "firstPerson",
            this._transitionTimeSeconds = 1,
            this._startTransition())
        }
    }, {
        key: "_startTransition",
        value: function() {
            this._lerpRatio = 0,
            this._isTransitioning = !0,
            this._transitionStartTime = properties.time
        }
    }, {
        key: "rotateCameraToLeftByDegrees",
        value: function(e) {
            this._orbitControls.rotateToLeftByDegrees(e * Math.PI / 180)
        }
    }, {
        key: "update",
        value: function(e) {
            if (this._resetCamera(),
            this._isTransitioning)
                this._lerpRatio = (properties.time - this._transitionStartTime) / this._transitionTimeSeconds,
                this._lerpRatio >= 1 ? (this._isTransitioning = !1,
                this._lerpRatio = 1,
                home.show()) : (this._orbitControls.target.lerpVectors(this._cameraTargetLerpFrom, this._cameraTargetLerpTo, ease.cubicInOut(this._lerpRatio)),
                null !== this._cameraPositionLerpFrom && null !== this._cameraPositionLerpTo && this._orbitControls.object.position.lerpVectors(this._cameraPositionLerpFrom, this._cameraPositionLerpTo, ease.cubicInOut(this._lerpRatio))),
                this._cabOpacity.lerp(this._lerpRatio),
                this.cab.mesh.material.uniforms.u_opacity.value = ease.quintInOut(this._cabOpacity.value),
                this.cab.mesh.visible = this.cab.mesh.material.uniforms.u_opacity.value > .05;
            else
                switch (this._cameraMode) {
                case "follow":
                    this._orbitControls.target.copy(this._cameraTargetLerpTo);
                    break;
                case "firstPerson":
                    this._orbitControls.target.copy(this._cameraTargetLerpTo),
                    this._orbitControls.object.position.copy(this._cameraPositionLerpTo)
                }
            if (this._applyOrbitControls(),
            this._firstPersonRatio = math.saturate(this._firstPersonRatio + ("firstPerson" === this._cameraMode ? e : -e) / this._transitionTimeSeconds),
            this.cab && this._firstPersonRatio > 0) {
                this._firstPersonCamera.up.copy(this.cab.container.up).normalize(),
                this._firstPersonCamera.position.copy(this.cab.rearPosition),
                this._firstPersonCamera.lookAt(this.cab.frontPosition);
                var t = ease.cubicInOut(this._firstPersonRatio);
                this._camera.position.lerp(this._firstPersonCamera.position, t),
                this._camera.quaternion.slerp(this._firstPersonCamera.quaternion, t),
                this._camera.updateMatrix()
            }
            if (this._mouseMoveCamera(),
            this._applyBrownianMotion(e),
            this._updateCameraDistance(),
            this._keepCameraAboveGround(),
            settings.CAMERA_360 && this.trackContainer) {
                var i = (new Box3).setFromObject(this.trackContainer);
                i.getCenter(this._v1),
                this._v1.y *= .5,
                i.getSize(this._v2);
                var r = properties.time * Math.PI * 2 / 10;
                this._camera.position.set(Math.cos(r), .2, Math.sin(r)),
                this._camera.lookAt(properties.scene.position),
                this._camera.position.multiplyScalar(.7 * this._v2.length()),
                this._camera.position.add(this._v1),
                this._camera.updateMatrix()
            }
            properties.sharedUniforms.u_cameraQuaternionInverse.value.copy(properties.camera.quaternion).invert()
        }
    }]),
    e
}(), InterpolationValue = function() {
    function e(t, i, r) {
        _classCallCheck2(this, e),
        this.value = t,
        this.from = i,
        this.to = r
    }
    return _createClass2(e, [{
        key: "lerp",
        value: function(e) {
            this.value = math.lerp(this.from, this.to, e)
        }
    }, {
        key: "setNewTarget",
        value: function(e) {
            this.to = e,
            this.from = this.value
        }
    }]),
    e
}(), cameraControls$1 = new CameraControls, _geom;
window.cameraControls = cameraControls$1;
var Postprocessing = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "width", 1),
        _defineProperty2(this, "height", 1),
        _defineProperty2(this, "scene", null),
        _defineProperty2(this, "camera", null),
        _defineProperty2(this, "resolution", new Vector2(0,0)),
        _defineProperty2(this, "texelSize", new Vector2(0,0)),
        _defineProperty2(this, "aspect", new Vector2(1,1)),
        _defineProperty2(this, "onBeforeSceneRendered", new MinSignal),
        _defineProperty2(this, "onAfterSceneRendered", new MinSignal),
        _defineProperty2(this, "onAfterRendered", new MinSignal),
        _defineProperty2(this, "sceneRenderTarget", null),
        _defineProperty2(this, "fromRenderTarget", null),
        _defineProperty2(this, "toRenderTarget", null),
        _defineProperty2(this, "useDepthTexture", !0),
        _defineProperty2(this, "depthTexture", null),
        _defineProperty2(this, "fromTexture", null),
        _defineProperty2(this, "toTexture", null),
        _defineProperty2(this, "sceneTexture", null),
        _defineProperty2(this, "mesh", null),
        _defineProperty2(this, "queue", []),
        _defineProperty2(this, "sharedUniforms", {}),
        _defineProperty2(this, "geom", void 0),
        _defineProperty2(this, "hasSizeChanged", !0)
    }
    return _createClass2(e, [{
        key: "init",
        value: function(e) {
            if (Object.assign(this, e),
            _geom ? this.geom = _geom : (this.geom = _geom = new BufferGeometry,
            this.geom.setAttribute("position", new BufferAttribute(new Float32Array([-1, -1, 0, 4, -1, 0, -1, 4, 0]),3)),
            this.geom.setAttribute("a_uvClamp", new BufferAttribute(new Float32Array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1]),4))),
            this.sceneRenderTarget = fboHelper.createMultisampleRenderTarget(1, 1, !0),
            this.sceneRenderTarget.depthBuffer = !0,
            this.fromRenderTarget = fboHelper.createRenderTarget(1, 1, !0),
            this.toRenderTarget = this.fromRenderTarget.clone(),
            this.useDepthTexture = !!this.useDepthTexture && fboHelper.renderer && (fboHelper.renderer.capabilities.isWebGL2 || fboHelper.renderer.extensions.get("WEBGL_depth_texture")),
            this.fromTexture = this.fromRenderTarget.texture,
            this.toTexture = this.toRenderTarget.texture,
            this.sceneTexture = this.sceneRenderTarget.texture,
            this.mesh = new Mesh,
            this.sharedUniforms = Object.assign(this.sharedUniforms, {
                u_sceneTexture: {
                    value: this.sceneRenderTarget.texture
                },
                u_sceneDepthTexture: {
                    value: null
                },
                u_cameraNear: {
                    value: 0
                },
                u_cameraFar: {
                    value: 1
                },
                u_cameraFovRad: {
                    value: 1
                },
                u_resolution: {
                    value: this.resolution
                },
                u_texelSize: {
                    value: this.texelSize
                },
                u_aspect: {
                    value: this.aspect
                }
            }),
            this.useDepthTexture && fboHelper.renderer) {
                var t = new DepthTexture(this.resolution.width,this.resolution.height);
                t.type = UnsignedShortType,
                fboHelper.renderer.capabilities.isWebGL2 && (t.type = UnsignedIntType),
                t.minFilter = NearestFilter,
                t.magFilter = NearestFilter,
                fboHelper.renderer.capabilities.isWebGL2 || (t.format = DepthStencilFormat,
                t.type = UnsignedInt248Type),
                this.sceneRenderTarget.depthTexture = t,
                this.depthTexture = this.sharedUniforms.u_sceneDepthTexture.value = t
            }
        }
    }, {
        key: "swap",
        value: function() {
            var e = this.fromRenderTarget;
            this.fromRenderTarget = this.toRenderTarget,
            this.toRenderTarget = e,
            this.fromTexture = this.fromRenderTarget.texture,
            this.toTexture = this.toRenderTarget.texture
        }
    }, {
        key: "setSize",
        value: function(e, t) {
            if (this.width !== e || this.height !== t) {
                this.hasSizeChanged = !0,
                this.width = e,
                this.height = t,
                this.resolution.set(e, t),
                this.texelSize.set(1 / e, 1 / t);
                var i = t / Math.sqrt(e * e + t * t) * 2;
                this.aspect.set(e / t * i, i),
                this.sceneRenderTarget.setSize(e, t),
                this.fromRenderTarget.setSize(e, t),
                this.toRenderTarget.setSize(e, t)
            }
        }
    }, {
        key: "dispose",
        value: function() {
            this.fromRenderTarget && this.fromRenderTarget.dispose(),
            this.toRenderTarget && this.toRenderTarget.dispose(),
            this.sceneRenderTarget && this.sceneRenderTarget.dispose()
        }
    }, {
        key: "_filterQueue",
        value: function(e) {
            return e.enabled && e.needsRender()
        }
    }, {
        key: "renderMaterial",
        value: function(e, t) {
            this.mesh.material = e,
            fboHelper.renderMesh(this.mesh, t)
        }
    }, {
        key: "render",
        value: function(e, t, i) {
            if (fboHelper.renderer) {
                this.scene = e,
                this.camera = t,
                this.mesh.geometry = this.geom;
                var r = this.queue.filter(this._filterQueue)
                  , n = this.sharedUniforms;
                if (n.u_sceneTexture.value = this.sceneRenderTarget.texture,
                n.u_cameraNear.value = t.near,
                n.u_cameraFar.value = t.far,
                n.u_cameraFovRad.value = t.fov / 180 * Math.PI,
                this.onBeforeSceneRendered.dispatch(),
                r.length) {
                    fboHelper.renderer.setRenderTarget(this.sceneRenderTarget),
                    fboHelper.renderer.render(e, t),
                    fboHelper.renderer.setRenderTarget(null),
                    fboHelper.copy(this.sceneRenderTarget.texture, this.fromRenderTarget),
                    this.onAfterSceneRendered.dispatch(this.sceneRenderTarget);
                    var a = fboHelper.getColorState();
                    fboHelper.renderer.autoClear = !1;
                    for (var o = 0, s = r.length; o < s; o++) {
                        var l = o === s - 1 && i
                          , h = r[o];
                        h.setPostprocessing(this),
                        h.render(this, l)
                    }
                    fboHelper.setColorState(a)
                } else
                    fboHelper.renderer.render(e, t),
                    this.onAfterSceneRendered.dispatch();
                this.onAfterRendered.dispatch(),
                this.hasSizeChanged = !1
            }
        }
    }]),
    e
}()
  , PostEffect = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "sharedUniforms", {}),
        _defineProperty2(this, "enabled", !0),
        _defineProperty2(this, "material", null)
    }
    return _createClass2(e, [{
        key: "init",
        value: function(e) {
            Object.assign(this, e)
        }
    }, {
        key: "createRawShaderMaterial",
        value: function(e) {
            var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
            return e = Object.assign({
                depthTest: !1,
                depthWrite: !1,
                blending: NoBlending,
                vertexShader: blitVert,
                fragmentShader: blitFrag
            }, e),
            t && (e.vertexShader = fboHelper.precisionPrefix + e.vertexShader,
            e.fragmentShader = fboHelper.precisionPrefix + e.fragmentShader),
            new RawShaderMaterial(e)
        }
    }, {
        key: "needsRender",
        value: function() {
            return !0
        }
    }, {
        key: "setPostprocessing",
        value: function(e) {}
    }, {
        key: "render",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            this.material.uniforms.u_texture && (this.material.uniforms.u_texture.value = e.fromTexture),
            fboHelper.render(this.material, t ? null : e.toRenderTarget),
            e.swap()
        }
    }]),
    e
}()
  , smaaBlendVert = "#define GLSLIFY 1\nattribute vec3 position;uniform vec2 u_texelSize;varying vec2 v_uv;varying vec4 v_offsets[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){v_offsets[0]=texcoord.xyxy+u_texelSize.xyxy*vec4(-1.0,0.0,0.0,1.0);v_offsets[1]=texcoord.xyxy+u_texelSize.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){v_uv=position.xy*0.5+0.5;SMAANeighborhoodBlendingVS(v_uv);gl_Position=vec4(position,1.0);}"
  , smaaBlendFrag = "#define GLSLIFY 1\nuniform sampler2D u_weightsTexture;uniform sampler2D u_texture;uniform vec2 u_texelSize;varying vec2 v_uv;varying vec4 v_offsets[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*u_texelSize;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(abs(C.xyz),vec3(2.2));Cop.xyz=pow(abs(Cop.xyz),vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(abs(mixed.xyz),vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(v_uv,v_offsets,u_texture,u_weightsTexture);}"
  , smaaEdgesVert = "#define GLSLIFY 1\nattribute vec3 position;uniform vec2 u_texelSize;varying vec2 v_uv;varying vec4 v_offsets[3];void SMAAEdgeDetectionVS(vec2 texcoord){v_offsets[0]=texcoord.xyxy+u_texelSize.xyxy*vec4(-1.0,0.0,0.0,1.0);v_offsets[1]=texcoord.xyxy+u_texelSize.xyxy*vec4(1.0,0.0,0.0,-1.0);v_offsets[2]=texcoord.xyxy+u_texelSize.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){v_uv=position.xy*0.5+0.5;SMAAEdgeDetectionVS(v_uv);gl_Position=vec4(position,1.0);}"
  , smaaEdgesFrag = "#define GLSLIFY 1\nuniform sampler2D u_texture;varying vec2 v_uv;varying vec4 v_offsets[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(v_uv,v_offsets,u_texture);}"
  , smaaWeightsVert = "#define GLSLIFY 1\nattribute vec3 position;uniform vec2 u_texelSize;varying vec2 v_uv;varying vec4 v_offsets[3];varying vec2 v_pixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){v_pixcoord=texcoord/u_texelSize;v_offsets[0]=texcoord.xyxy+u_texelSize.xyxy*vec4(-0.25,0.125,1.25,0.125);v_offsets[1]=texcoord.xyxy+u_texelSize.xyxy*vec4(-0.125,0.25,-0.125,-1.25);v_offsets[2]=vec4(v_offsets[0].xz,v_offsets[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*u_texelSize.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){v_uv=position.xy*0.5+0.5;SMAABlendingWeightCalculationVS(v_uv);gl_Position=vec4(position,1.0);}"
  , smaaWeightsFrag = "#define GLSLIFY 1\n#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * u_texelSize, 0.0 )\nuniform sampler2D u_edgesTexture;uniform sampler2D u_areaTexture;uniform sampler2D u_searchTexture;uniform vec2 u_texelSize;varying vec2 v_uv;varying vec4 v_offsets[3];varying vec2 v_pixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*u_texelSize;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*u_texelSize.x;texcoord.x+=u_texelSize.x;texcoord.x+=2.0*u_texelSize.x;texcoord.x-=u_texelSize.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*u_texelSize;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*u_texelSize.x;texcoord.x-=u_texelSize.x;texcoord.x-=2.0*u_texelSize.x;texcoord.x+=u_texelSize.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*u_texelSize;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*u_texelSize.y;texcoord.y-=u_texelSize.y;texcoord.y-=2.0*u_texelSize.y;texcoord.y+=u_texelSize.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*u_texelSize;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*u_texelSize.y;texcoord.y+=u_texelSize.y;texcoord.y+=2.0*u_texelSize.y;texcoord.y-=u_texelSize.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/u_texelSize.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*u_texelSize.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/u_texelSize.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*u_texelSize.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(v_uv,v_pixcoord,v_offsets,u_edgesTexture,u_areaTexture,u_searchTexture,ivec4(0.0));}"
  , Smaa = function(e) {
    _inherits(i, PostEffect);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "edgesRenderTarget", null),
        _defineProperty2(_assertThisInitialized(e), "weightsRenderTarget", null),
        _defineProperty2(_assertThisInitialized(e), "edgesMaterial", null),
        _defineProperty2(_assertThisInitialized(e), "weightsMaterial", null),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e) {
            Object.assign(this, {
                sharedUniforms: {
                    u_areaTexture: {
                        value: null
                    },
                    u_searchTexture: {
                        value: null
                    }
                }
            }, e),
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this.weightsRenderTarget = fboHelper.createRenderTarget(1, 1, !0),
            this.edgesRenderTarget = fboHelper.createRenderTarget(1, 1),
            this.edgesMaterial = new RawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_texelSize: null
                },
                vertexShader: fboHelper.precisionPrefix + smaaEdgesVert,
                fragmentShader: fboHelper.precisionPrefix + smaaEdgesFrag,
                defines: {
                    SMAA_THRESHOLD: "0.1"
                },
                blending: NoBlending,
                depthTest: !1,
                depthWrite: !1
            }),
            this.weightsMaterial = new RawShaderMaterial({
                uniforms: {
                    u_edgesTexture: {
                        value: this.edgesRenderTarget.texture
                    },
                    u_areaTexture: this.sharedUniforms.u_areaTexture,
                    u_searchTexture: this.sharedUniforms.u_searchTexture,
                    u_texelSize: null
                },
                vertexShader: fboHelper.precisionPrefix + smaaWeightsVert,
                fragmentShader: fboHelper.precisionPrefix + smaaWeightsFrag,
                defines: {
                    SMAA_MAX_SEARCH_STEPS: "8",
                    SMAA_AREATEX_MAX_DISTANCE: "16",
                    SMAA_AREATEX_PIXEL_SIZE: "( 1.0 / vec2( 160.0, 560.0 ) )",
                    SMAA_AREATEX_SUBTEX_SIZE: "( 1.0 / 7.0 )"
                },
                transparent: !0,
                blending: NoBlending,
                depthTest: !1,
                depthWrite: !1
            }),
            this.material = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_weightsTexture: {
                        value: this.weightsRenderTarget.texture
                    },
                    u_texelSize: null
                },
                vertexShader: fboHelper.precisionPrefix + smaaBlendVert,
                fragmentShader: fboHelper.precisionPrefix + smaaBlendFrag
            })
        }
    }, {
        key: "setTextures",
        value: function(e, t) {
            var i = this.sharedUniforms.u_areaTexture.value = this._createTexture(e);
            i.format = RGBFormat,
            i.minFilter = LinearFilter;
            var r = this.sharedUniforms.u_searchTexture.value = this._createTexture(t);
            r.magFilter = NearestFilter,
            r.minFilter = NearestFilter
        }
    }, {
        key: "updateTextures",
        value: function() {
            this.sharedUniforms.u_areaTexture.value.needsUpdate = !0,
            this.sharedUniforms.u_searchTexture.value.needsUpdate = !0
        }
    }, {
        key: "setPostprocessing",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "setPostprocessing", this).call(this, e);
            var t = e.width
              , r = e.height;
            this.edgesRenderTarget.setSize(t, r),
            this.weightsRenderTarget.setSize(t, r)
        }
    }, {
        key: "dispose",
        value: function() {
            this.edgesRenderTarget && this.edgesRenderTarget.dispose(),
            this.weightsRenderTarget && this.weightsRenderTarget.dispose()
        }
    }, {
        key: "needsRender",
        value: function() {
            return !this.sharedUniforms.u_areaTexture.value.needsUpdate
        }
    }, {
        key: "render",
        value: function(e, t) {
            var r = fboHelper.getColorState();
            this.sharedUniforms.u_searchTexture.value || console.warn("You need to use Smaa.setImages() to set the smaa textures manually and assign to this class.");
            var n = fboHelper.renderer;
            n && (n.autoClear = !0,
            n.setClearColor(0, 0)),
            this.edgesMaterial.uniforms.u_texelSize = this.weightsMaterial.uniforms.u_texelSize = this.material.uniforms.u_texelSize = e.sharedUniforms.u_texelSize,
            this.edgesMaterial.uniforms.u_texture.value = e.fromTexture,
            e.renderMaterial(this.edgesMaterial, this.edgesRenderTarget),
            e.renderMaterial(this.weightsMaterial, this.weightsRenderTarget),
            fboHelper.setColorState(r),
            this.material.uniforms.u_texture.value = e.fromTexture,
            _get(_getPrototypeOf(i.prototype), "render", this).call(this, e, t)
        }
    }, {
        key: "_createTexture",
        value: function(e) {
            var t = new Texture(e);
            return t.generateMipmaps = !1,
            t.flipY = !1,
            t
        }
    }]),
    i
}()
  , fragmentShader$2 = "#define GLSLIFY 1\nvarying vec2 v_uv;uniform sampler2D u_texture;uniform sampler2D u_blurTexture0;\n#if ITERATION > 1\nuniform sampler2D u_blurTexture1;\n#endif\n#if ITERATION > 2\nuniform sampler2D u_blurTexture2;\n#endif\n#if ITERATION > 3\nuniform sampler2D u_blurTexture3;\n#endif\n#if ITERATION > 4\nuniform sampler2D u_blurTexture4;\n#endif\nuniform float u_bloomWeights[ITERATION];\n#include <common>\nvec3 dithering(vec3 color){float grid_position=rand(gl_FragCoord.xy);vec3 dither_shift_RGB=vec3(0.25/255.0,-0.25/255.0,0.25/255.0);dither_shift_RGB=mix(2.0*dither_shift_RGB,-2.0*dither_shift_RGB,grid_position);return color+dither_shift_RGB;}void main(){vec4 c=texture2D(u_texture,v_uv);vec3 luma=vec3(0.299,0.587,0.114);float v=dot(c.xyz,luma);float a=1.0-v;gl_FragColor=c+(u_bloomWeights[0]*texture2D(u_blurTexture0,v_uv)\n#if ITERATION > 1\n+u_bloomWeights[1]*texture2D(u_blurTexture1,v_uv)\n#endif\n#if ITERATION > 2\n+u_bloomWeights[2]*texture2D(u_blurTexture2,v_uv)\n#endif\n#if ITERATION > 3\n+u_bloomWeights[3]*texture2D(u_blurTexture3,v_uv)\n#endif\n#if ITERATION > 4\n+u_bloomWeights[4]*texture2D(u_blurTexture4,v_uv)\n#endif\n)*a;gl_FragColor.rgb=dithering(gl_FragColor.rgb);gl_FragColor.a=1.0;}"
  , highPassFragmentShader = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform float u_luminosityThreshold;uniform float u_smoothWidth;\n#ifdef USE_HALO\nuniform vec2 u_texelSize;uniform vec2 u_aspect;uniform float u_haloWidth;uniform float u_haloRGBShift;uniform float u_haloStrength;\n#endif\nvarying vec2 v_uv;void main(){vec4 texel=texture2D(u_texture,v_uv);vec3 luma=vec3(0.299,0.587,0.114);float v=dot(texel.xyz,luma);vec4 outputColor=vec4(0.0,0.0,0.0,1.0);float alpha=smoothstep(u_luminosityThreshold,u_luminosityThreshold+u_smoothWidth,v);outputColor=mix(outputColor,texel,alpha);gl_FragColor=vec4(outputColor.rgb,1.0);\n#ifdef USE_HALO\nvec2 toCenter=(v_uv-0.5)*u_aspect;vec2 ghostUv=1.0-(toCenter+0.5);vec2 ghostVec=(vec2(0.5)-ghostUv);vec2 direction=normalize(ghostVec);vec2 haloVec=direction*u_haloWidth;float weight=length(vec2(0.5)-fract(ghostUv+haloVec));weight=pow(1.0-weight,3.0);vec3 distortion=vec3(-u_texelSize.x,0.0,u_texelSize.x)*u_haloRGBShift;vec2 uv=ghostUv+haloVec;gl_FragColor.rgb+=vec3(texture2D(u_texture,uv+direction*distortion.r).r,texture2D(u_texture,uv+direction*distortion.g).g,texture2D(u_texture,uv+direction*distortion.b).b)*u_haloStrength;\n#endif\n}"
  , blurFragmentShader = "#define GLSLIFY 1\nvarying vec2 v_uv;uniform sampler2D u_texture;uniform vec2 u_resolution;uniform vec2 u_direction;float gaussianPdf(in float x,in float sigma){return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;}void main(){vec2 invSize=1.0/u_resolution;float fSigma=float(SIGMA);float weightSum=gaussianPdf(0.0,fSigma);vec3 diffuseSum=texture2D(u_texture,v_uv).rgb*weightSum;for(int i=1;i<KERNEL_RADIUS;i++){float x=float(i);float w=gaussianPdf(x,fSigma);vec2 uvOffset=u_direction*invSize*x;vec3 sample1=texture2D(u_texture,v_uv+uvOffset).rgb;vec3 sample2=texture2D(u_texture,v_uv-uvOffset).rgb;diffuseSum+=(sample1+sample2)*w;weightSum+=2.0*w;}gl_FragColor=vec4(diffuseSum/weightSum,1.0);}"
  , Bloom = function(e) {
    _inherits(i, PostEffect);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "ITERATION", 5),
        _defineProperty2(_assertThisInitialized(e), "amount", 1),
        _defineProperty2(_assertThisInitialized(e), "radius", 0),
        _defineProperty2(_assertThisInitialized(e), "threshold", .1),
        _defineProperty2(_assertThisInitialized(e), "smoothWidth", 1),
        _defineProperty2(_assertThisInitialized(e), "haloWidth", .8),
        _defineProperty2(_assertThisInitialized(e), "haloRGBShift", .03),
        _defineProperty2(_assertThisInitialized(e), "haloStrength", .21),
        _defineProperty2(_assertThisInitialized(e), "highPassMaterial", void 0),
        _defineProperty2(_assertThisInitialized(e), "highPassRenderTarget", void 0),
        _defineProperty2(_assertThisInitialized(e), "renderTargetsHorizontal", []),
        _defineProperty2(_assertThisInitialized(e), "renderTargetsVertical", []),
        _defineProperty2(_assertThisInitialized(e), "blurMaterials", []),
        _defineProperty2(_assertThisInitialized(e), "directionX", new Vector2(1,0)),
        _defineProperty2(_assertThisInitialized(e), "directionY", new Vector2(0,1)),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e) {
            Object.assign(this, e),
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this.highPassRenderTarget = fboHelper.createRenderTarget(1, 1, !0),
            this.highPassMaterial = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_luminosityThreshold: {
                        value: 1
                    },
                    u_smoothWidth: {
                        value: 1
                    },
                    u_haloWidth: {
                        value: 1
                    },
                    u_haloRGBShift: {
                        value: 1
                    },
                    u_haloStrength: {
                        value: 1
                    },
                    u_texelSize: null,
                    u_aspect: null
                },
                fragmentShader: highPassFragmentShader
            });
            for (var t = 0; t < this.ITERATION; t++) {
                this.renderTargetsHorizontal.push(this.highPassRenderTarget.clone()),
                this.renderTargetsVertical.push(this.highPassRenderTarget.clone());
                var r = 3 + 2 * t;
                this.blurMaterials[t] = this.createRawShaderMaterial({
                    uniforms: {
                        u_texture: {
                            value: null
                        },
                        u_resolution: {
                            value: new Vector2
                        },
                        u_direction: {
                            value: null
                        }
                    },
                    fragmentShader: blurFragmentShader,
                    defines: {
                        KERNEL_RADIUS: r,
                        SIGMA: r
                    }
                })
            }
            this.material = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_bloomStrength: {
                        value: 1
                    },
                    u_bloomWeights: {
                        value: []
                    }
                },
                fragmentShader: fragmentShader$2,
                blending: NoBlending,
                defines: {
                    ITERATION: this.ITERATION
                }
            });
            for (var n = 0; n < this.ITERATION; n++)
                this.material.uniforms["u_blurTexture" + n] = {
                    value: this.renderTargetsVertical[n].texture
                }
        }
    }, {
        key: "setPostprocessing",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "setPostprocessing", this).call(this, e);
            var t = e.width
              , r = e.height
              , n = Math.ceil(t / 2)
              , a = Math.ceil(r / 2);
            this.highPassRenderTarget.setSize(n, a);
            for (var o = 0; o < this.ITERATION; o++)
                this.renderTargetsHorizontal[o].setSize(n, a),
                this.renderTargetsVertical[o].setSize(n, a),
                this.blurMaterials[o].uniforms.u_resolution.value.set(n, a),
                n = Math.ceil(n / 2),
                a = Math.ceil(a / 2)
        }
    }, {
        key: "dispose",
        value: function() {
            this.highPassRenderTarget && this.highPassRenderTarget.dispose();
            for (var e = 0; e < this.ITERATION; e++)
                this.renderTargetsHorizontal[e] && this.renderTargetsHorizontal[e].dispose(),
                this.renderTargetsVertical[e] && this.renderTargetsVertical[e].dispose()
        }
    }, {
        key: "needsRender",
        value: function() {
            return !!this.amount
        }
    }, {
        key: "render",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            this.highPassMaterial.uniforms.u_texture.value = e.fromTexture,
            this.highPassMaterial.uniforms.u_luminosityThreshold.value = this.threshold,
            this.highPassMaterial.uniforms.u_smoothWidth.value = this.smoothWidth,
            this.highPassMaterial.uniforms.u_haloWidth.value = this.haloWidth,
            this.highPassMaterial.uniforms.u_haloRGBShift.value = this.haloRGBShift * e.width,
            this.highPassMaterial.uniforms.u_haloStrength.value = this.haloStrength,
            this.highPassMaterial.uniforms.u_texelSize = e.sharedUniforms.u_texelSize,
            this.highPassMaterial.uniforms.u_aspect = e.sharedUniforms.u_aspect;
            var r = this.haloStrength > 0;
            this.highPassMaterial.defines.USE_HALO !== r && (this.highPassMaterial.defines.USE_HALO = r,
            this.highPassMaterial.needsUpdate = !0),
            e.renderMaterial(this.highPassMaterial, this.highPassRenderTarget);
            for (var n = this.highPassRenderTarget, a = 0; a < this.ITERATION; a++) {
                var o = this.blurMaterials[a];
                o.uniforms.u_texture.value = n.texture,
                o.uniforms.u_direction.value = this.directionX,
                e.renderMaterial(o, this.renderTargetsHorizontal[a]),
                o.uniforms.u_texture.value = this.renderTargetsHorizontal[a].texture,
                o.uniforms.u_direction.value = this.directionY,
                e.renderMaterial(o, this.renderTargetsVertical[a]),
                n = this.renderTargetsVertical[a]
            }
            this.material.uniforms.u_texture.value = e.fromTexture;
            for (var s = 0; s < this.ITERATION; s++) {
                var l = (this.ITERATION - s) / this.ITERATION;
                this.material.uniforms.u_bloomWeights.value[s] = this.amount * (l + (1.2 - 2 * l) * this.radius) / Math.pow(2, this.ITERATION - s - 1)
            }
            _get(_getPrototypeOf(i.prototype), "render", this).call(this, e, t)
        }
    }]),
    i
}()
  , fragmentShader$1 = "#define GLSLIFY 1\nvarying vec2 v_uv;uniform sampler2D u_texture;uniform vec3 u_bgColor;uniform float u_opacity;uniform float u_vignetteFrom;uniform float u_vignetteTo;uniform vec2 u_vignetteAspect;uniform vec3 u_vignetteColor;uniform float u_saturation;uniform float u_contrast;uniform float u_brightness;uniform vec3 u_tintColor;uniform float u_tintOpacity;uniform float u_ditherSeed;float hash13(vec3 p3){p3=fract(p3*.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}vec3 screen(vec3 cb,vec3 cs){return cb+cs-(cb*cs);}vec3 colorDodge(vec3 cb,vec3 cs){return mix(min(vec3(1.0),cb/(1.0-cs)),vec3(1.0),step(vec3(1.0),cs));}void main(){vec2 uv=v_uv;vec3 color=texture2D(u_texture,uv).rgb;float luma=dot(color,vec3(0.299,0.587,0.114));color=mix(vec3(luma),color,1.0+u_saturation);color=0.5+(1.0+u_contrast)*(color-0.5);color+=u_brightness;color=mix(color,screen(colorDodge(color,u_tintColor),u_tintColor),u_tintOpacity);float d=length((uv-0.5)*u_vignetteAspect)*2.0;color=mix(color,u_vignetteColor,smoothstep(u_vignetteFrom,u_vignetteTo,d));gl_FragColor=vec4(mix(u_bgColor,color,u_opacity)+hash13(vec3(gl_FragCoord.xy,u_ditherSeed))/255.0,1.0);}"
  , transitionFragmentShader = "#define GLSLIFY 1\nvarying vec2 v_uv;uniform sampler2D u_texture;uniform sampler2D u_cacheTexture;uniform float u_transitionRatio;uniform float u_transitionDirection;\n#include <getBlueNoise>\nfloat range(float vmin,float vmax,float value){return clamp((value-vmin)/(vmax-vmin),0.0,1.0);}void main(){vec3 bnoise=getBlueNoise(gl_FragCoord.xy);vec2 uv=v_uv;vec3 color=vec3(0.0);vec3 cacheColor=vec3(0.0);vec2 colorUv=uv;vec2 cacheColorUv=uv;float direction=u_transitionDirection;float transitionRatio=u_transitionRatio;float colorUvOffsetRatio=direction>0.0 ? 1.0-uv.x : uv.x;float cacheColorUvOffsetRatio=direction<0.0 ? 1.0-uv.x : uv.x;float colorUvOffsetDist=(colorUvOffsetRatio*colorUvOffsetRatio*0.95);float cacheColorUvOffsetDist=(cacheColorUvOffsetRatio*cacheColorUvOffsetRatio*0.95);vec2 colorUvOffset=vec2((colorUvOffsetDist+0.5)*direction,colorUvOffsetDist*(0.5-uv.y)*2.0)*(1.0-transitionRatio)/16.0;vec2 cacheColorUvOffset=vec2((cacheColorUvOffsetDist+0.5)*-direction,cacheColorUvOffsetDist*(0.5-uv.y)*2.0)*transitionRatio/16.0;colorUv+=colorUvOffset*bnoise.z;cacheColorUv+=cacheColorUvOffset*bnoise.z;for(int i=0;i<16;i++){color+=texture2D(u_texture,colorUv).rgb;cacheColor+=texture2D(u_cacheTexture,cacheColorUv).rgb;colorUv+=colorUvOffset;cacheColorUv+=cacheColorUvOffset;}color/=16.0;cacheColor/=16.0;color=mix(cacheColor,color,clamp(transitionRatio*2.0-colorUvOffsetRatio*colorUvOffsetRatio,0.0,1.0));gl_FragColor=vec4(color,1.0);}"
  , Final$1 = function(e) {
    _inherits(i, PostEffect);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "vignetteFrom", .6),
        _defineProperty2(_assertThisInitialized(e), "vignetteTo", 1.6),
        _defineProperty2(_assertThisInitialized(e), "vignetteAspect", new Vector2),
        _defineProperty2(_assertThisInitialized(e), "vignetteColor", new Color),
        _defineProperty2(_assertThisInitialized(e), "saturation", 1),
        _defineProperty2(_assertThisInitialized(e), "contrast", 0),
        _defineProperty2(_assertThisInitialized(e), "brightness", 1),
        _defineProperty2(_assertThisInitialized(e), "tintColor", new Color),
        _defineProperty2(_assertThisInitialized(e), "tintOpacity", 1),
        _defineProperty2(_assertThisInitialized(e), "bgColor", new Color),
        _defineProperty2(_assertThisInitialized(e), "opacity", 1),
        _defineProperty2(_assertThisInitialized(e), "transitionRatio", 1),
        _defineProperty2(_assertThisInitialized(e), "transitionDirection", 1),
        _defineProperty2(_assertThisInitialized(e), "cacheRenderTarget", null),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e) {
            Object.assign(this, e),
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this.material = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_vignetteFrom: {
                        value: 0
                    },
                    u_vignetteTo: {
                        value: 0
                    },
                    u_vignetteAspect: {
                        value: this.vignetteAspect
                    },
                    u_vignetteColor: {
                        value: this.vignetteColor
                    },
                    u_saturation: {
                        value: 0
                    },
                    u_contrast: {
                        value: 0
                    },
                    u_brightness: {
                        value: 0
                    },
                    u_tintColor: {
                        value: this.tintColor
                    },
                    u_tintOpacity: {
                        value: 0
                    },
                    u_bgColor: {
                        value: this.bgColor
                    },
                    u_opacity: {
                        value: 0
                    },
                    u_ditherSeed: {
                        value: 0
                    }
                },
                fragmentShader: fragmentShader$1
            }),
            this.cacheRenderTarget = fboHelper.createRenderTarget(1, 1),
            this.transitionMaterial = this.createRawShaderMaterial({
                uniforms: Object.assign({
                    u_texture: {
                        value: null
                    },
                    u_cacheTexture: {
                        value: this.cacheRenderTarget.texture
                    },
                    u_transitionDirection: {
                        value: 0
                    },
                    u_transitionRatio: {
                        value: 0
                    }
                }, blueNoise.sharedUniforms),
                fragmentShader: transitionFragmentShader
            })
        }
    }, {
        key: "startTransition",
        value: function(e) {
            var t = e.width
              , i = e.height;
            this.cacheRenderTarget.setSize(t, i),
            fboHelper.copy(e.fromRenderTarget.texture, this.cacheRenderTarget),
            e.swap(),
            this.transitionRatio = 0
        }
    }, {
        key: "render",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]
              , i = e.width
              , r = e.height
              , n = this.material.uniforms;
            n.u_vignetteFrom.value = this.vignetteFrom,
            n.u_vignetteTo.value = this.vignetteTo;
            var a = r / Math.sqrt(i * i + r * r);
            this.vignetteAspect.set(i / r * a, a),
            n.u_saturation.value = this.saturation - 1,
            n.u_contrast.value = this.contrast,
            n.u_brightness.value = this.brightness - 1,
            n.u_tintOpacity.value = this.tintOpacity,
            n.u_opacity.value = this.opacity,
            n.u_ditherSeed.value = 1e3 * Math.random();
            var o = this.transitionRatio
              , s = o < 1;
            this.material.uniforms.u_texture.value = e.fromTexture,
            e.renderMaterial(this.material, e.toRenderTarget),
            s && (e.swap(),
            this.transitionMaterial.uniforms.u_texture.value = e.fromTexture,
            this.transitionMaterial.uniforms.u_transitionDirection.value = this.transitionDirection,
            this.transitionMaterial.uniforms.u_transitionRatio.value = o,
            e.renderMaterial(this.transitionMaterial, e.toRenderTarget)),
            e.swap(),
            fboHelper.copy(e.fromTexture, t ? null : e.toRenderTarget)
        }
    }]),
    i
}()
  , bokehCocShader = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform sampler2D u_depthTexture;uniform vec2 u_texelSize;uniform float u_focusDistance;uniform float u_lensCoeff;uniform float u_maxCoC;uniform float u_rcpMaxCoC;uniform float u_cameraNear;uniform float u_cameraFar;varying vec2 v_uv;float max3(vec3 xyz){return max(xyz.x,max(xyz.y,xyz.z));}\n#ifndef USE_FLOAT\nuniform float u_hashNoise;float hash13(vec3 p3){p3=fract(p3*.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}\n#endif\nfloat getViewZ(vec2 uv){float depth=texture2D(u_depthTexture,uv).r*2.0-1.0;return 2.0*u_cameraNear*u_cameraFar/(u_cameraFar+u_cameraNear-depth*(u_cameraFar-u_cameraNear));}void main(){vec3 duv=u_texelSize.xyx*vec3(0.5,0.5,-0.5);vec3 c0=texture2D(u_texture,v_uv-duv.xy).rgb;vec3 c1=texture2D(u_texture,v_uv-duv.zy).rgb;vec3 c2=texture2D(u_texture,v_uv+duv.zy).rgb;vec3 c3=texture2D(u_texture,v_uv+duv.xy).rgb;vec2 uvAlt=v_uv;float d0=getViewZ(uvAlt-duv.xy);float d1=getViewZ(uvAlt-duv.zy);float d2=getViewZ(uvAlt+duv.zy);float d3=getViewZ(uvAlt+duv.xy);vec4 depths=vec4(d0,d1,d2,d3);float focusDistance=u_focusDistance;vec4 cocs=(depths-focusDistance)*u_lensCoeff/depths;cocs=clamp(cocs,-u_maxCoC,u_maxCoC);vec4 weights=clamp(abs(cocs)*u_rcpMaxCoC,vec4(0.0),vec4(1.0));weights.x*=1.0/(max3(c0)+1.0);weights.y*=1.0/(max3(c1)+1.0);weights.z*=1.0/(max3(c2)+1.0);weights.w*=1.0/(max3(c3)+1.0);vec3 avg=c0*weights.x+c1*weights.y+c2*weights.z+c3*weights.w;avg/=dot(weights,vec4(1.0));float coc=dot(cocs,vec4(0.25));avg*=smoothstep(0.0,u_texelSize.y*2.0,abs(coc));gl_FragColor=vec4(avg,coc);\n#ifndef USE_FLOAT\ngl_FragColor=sign(gl_FragColor)*sqrt(abs(gl_FragColor));gl_FragColor=gl_FragColor*0.5+0.5+hash13(vec3(gl_FragCoord.xy,u_hashNoise))/255.0;\n#endif\n}"
  , bokehSimShader = "#define GLSLIFY 1\n#if QUALITY == 0\nconst int kSampleCount=16;vec2 kDiskKernel[kSampleCount];void initKernel(){kDiskKernel[0]=vec2(0.0,0.0);kDiskKernel[1]=vec2(0.54545456,0.0);kDiskKernel[2]=vec2(0.16855472,0.5187581);kDiskKernel[3]=vec2(-0.44128203,0.3206101);kDiskKernel[4]=vec2(-0.44128197,-0.3206102);kDiskKernel[5]=vec2(0.1685548,-0.5187581);kDiskKernel[6]=vec2(1.0,0.0);kDiskKernel[7]=vec2(0.809017,0.58778524);kDiskKernel[8]=vec2(0.30901697,0.95105654);kDiskKernel[9]=vec2(-0.30901703,0.9510565);kDiskKernel[10]=vec2(-0.80901706,0.5877852);kDiskKernel[11]=vec2(-1.0,0.0);kDiskKernel[12]=vec2(-0.80901694,-0.58778536);kDiskKernel[13]=vec2(-0.30901664,-0.9510566);kDiskKernel[14]=vec2(0.30901712,-0.9510565);kDiskKernel[15]=vec2(0.80901694,-0.5877853);}\n#endif\n#if QUALITY == 1\nconst int kSampleCount=22;vec2 kDiskKernel[kSampleCount];void initKernel(){kDiskKernel[0]=vec2(0.0,0.0);kDiskKernel[1]=vec2(0.53333336,0.0);kDiskKernel[2]=vec2(0.3325279,0.4169768);kDiskKernel[3]=vec2(-0.11867785,0.5199616);kDiskKernel[4]=vec2(-0.48051673,0.2314047);kDiskKernel[5]=vec2(-0.48051673,-0.23140468);kDiskKernel[6]=vec2(-0.11867763,-0.51996166);kDiskKernel[7]=vec2(0.33252785,-0.4169769);kDiskKernel[8]=vec2(1.0,0.0);kDiskKernel[9]=vec2(0.90096885,0.43388376);kDiskKernel[10]=vec2(0.6234898,0.7818315);kDiskKernel[11]=vec2(0.22252098,0.9749279);kDiskKernel[12]=vec2(-0.22252095,0.9749279);kDiskKernel[13]=vec2(-0.62349,0.7818314);kDiskKernel[14]=vec2(-0.90096885,0.43388382);kDiskKernel[15]=vec2(-1.0,0.0);kDiskKernel[16]=vec2(-0.90096885,-0.43388376);kDiskKernel[17]=vec2(-0.6234896,-0.7818316);kDiskKernel[18]=vec2(-0.22252055,-0.974928);kDiskKernel[19]=vec2(0.2225215,-0.9749278);kDiskKernel[20]=vec2(0.6234897,-0.7818316);kDiskKernel[21]=vec2(0.90096885,-0.43388376);}\n#endif\n#if QUALITY == 2\nconst int kSampleCount=43;vec2 kDiskKernel[kSampleCount];void initKernel(){kDiskKernel[0]=vec2(0.0,0.0);kDiskKernel[1]=vec2(0.36363637,0.0);kDiskKernel[2]=vec2(0.22672357,0.28430238);kDiskKernel[3]=vec2(-0.08091671,0.35451925);kDiskKernel[4]=vec2(-0.32762504,0.15777594);kDiskKernel[5]=vec2(-0.32762504,-0.15777591);kDiskKernel[6]=vec2(-0.08091656,-0.35451928);kDiskKernel[7]=vec2(0.22672352,-0.2843024);kDiskKernel[8]=vec2(0.6818182,0.0);kDiskKernel[9]=vec2(0.614297,0.29582983);kDiskKernel[10]=vec2(0.42510667,0.5330669);kDiskKernel[11]=vec2(0.15171885,0.6647236);kDiskKernel[12]=vec2(-0.15171883,0.6647236);kDiskKernel[13]=vec2(-0.4251068,0.53306687);kDiskKernel[14]=vec2(-0.614297,0.29582986);kDiskKernel[15]=vec2(-0.6818182,0);kDiskKernel[16]=vec2(-0.614297,-0.29582983);kDiskKernel[17]=vec2(-0.42510656,-0.53306705);kDiskKernel[18]=vec2(-0.15171856,-0.66472363);kDiskKernel[19]=vec2(0.1517192,-0.6647235);kDiskKernel[20]=vec2(0.4251066,-0.53306705);kDiskKernel[21]=vec2(0.614297,-0.29582983);kDiskKernel[22]=vec2(1.0,0.0);kDiskKernel[23]=vec2(0.9555728,0.2947552);kDiskKernel[24]=vec2(0.82623875,0.5633201);kDiskKernel[25]=vec2(0.6234898,0.7818315);kDiskKernel[26]=vec2(0.36534098,0.93087375);kDiskKernel[27]=vec2(0.07473,0.9972038);kDiskKernel[28]=vec2(-0.22252095,0.9749279);kDiskKernel[29]=vec2(-0.50000006,0.8660254);kDiskKernel[30]=vec2(-0.73305196,0.6801727);kDiskKernel[31]=vec2(-0.90096885,0.43388382);kDiskKernel[32]=vec2(-0.98883086,0.14904208);kDiskKernel[33]=vec2(-0.9888308,-0.14904249);kDiskKernel[34]=vec2(-0.90096885,-0.43388376);kDiskKernel[35]=vec2(-0.73305184,-0.6801728);kDiskKernel[36]=vec2(-0.4999999,-0.86602545);kDiskKernel[37]=vec2(-0.222521,-0.9749279);kDiskKernel[38]=vec2(0.07473029,-0.99720377);kDiskKernel[39]=vec2(0.36534148,-0.9308736);kDiskKernel[40]=vec2(0.6234897,-0.7818316);kDiskKernel[41]=vec2(0.8262388,-0.56332);kDiskKernel[42]=vec2(0.9555729,-0.29475483);}\n#endif\n#if QUALITY == 3\nconst int kSampleCount=71;vec2 kDiskKernel[kSampleCount];void initKernel(){kDiskKernel[0]=vec2(0,0);kDiskKernel[1]=vec2(0.2758621,0.0);kDiskKernel[2]=vec2(0.1719972,0.21567768);kDiskKernel[3]=vec2(-0.061385095,0.26894566);kDiskKernel[4]=vec2(-0.24854316,0.1196921);kDiskKernel[5]=vec2(-0.24854316,-0.11969208);kDiskKernel[6]=vec2(-0.061384983,-0.2689457);kDiskKernel[7]=vec2(0.17199717,-0.21567771);kDiskKernel[8]=vec2(0.51724136,0.0);kDiskKernel[9]=vec2(0.46601835,0.22442262);kDiskKernel[10]=vec2(0.32249472,0.40439558);kDiskKernel[11]=vec2(0.11509705,0.50427306);kDiskKernel[12]=vec2(-0.11509704,0.50427306);kDiskKernel[13]=vec2(-0.3224948,0.40439552);kDiskKernel[14]=vec2(-0.46601835,0.22442265);kDiskKernel[15]=vec2(-0.51724136,0.0);kDiskKernel[16]=vec2(-0.46601835,-0.22442262);kDiskKernel[17]=vec2(-0.32249463,-0.40439564);kDiskKernel[18]=vec2(-0.11509683,-0.5042731);kDiskKernel[19]=vec2(0.11509732,-0.504273);kDiskKernel[20]=vec2(0.32249466,-0.40439564);kDiskKernel[21]=vec2(0.46601835,-0.22442262);kDiskKernel[22]=vec2(0.7586207,0.0);kDiskKernel[23]=vec2(0.7249173,0.22360738);kDiskKernel[24]=vec2(0.6268018,0.4273463);kDiskKernel[25]=vec2(0.47299224,0.59311354);kDiskKernel[26]=vec2(0.27715522,0.7061801);kDiskKernel[27]=vec2(0.056691725,0.75649947);kDiskKernel[28]=vec2(-0.168809,0.7396005);kDiskKernel[29]=vec2(-0.3793104,0.65698475);kDiskKernel[30]=vec2(-0.55610836,0.51599306);kDiskKernel[31]=vec2(-0.6834936,0.32915324);kDiskKernel[32]=vec2(-0.7501475,0.113066405);kDiskKernel[33]=vec2(-0.7501475,-0.11306671);kDiskKernel[34]=vec2(-0.6834936,-0.32915318);kDiskKernel[35]=vec2(-0.5561083,-0.5159932);kDiskKernel[36]=vec2(-0.37931028,-0.6569848);kDiskKernel[37]=vec2(-0.16880904,-0.7396005);kDiskKernel[38]=vec2(0.056691945,-0.7564994);kDiskKernel[39]=vec2(0.2771556,-0.7061799);kDiskKernel[40]=vec2(0.47299215,-0.59311366);kDiskKernel[41]=vec2(0.62680185,-0.4273462);kDiskKernel[42]=vec2(0.72491735,-0.22360711);kDiskKernel[43]=vec2(1.0,0.0);kDiskKernel[44]=vec2(0.9749279,0.22252093);kDiskKernel[45]=vec2(0.90096885,0.43388376);kDiskKernel[46]=vec2(0.7818315,0.6234898);kDiskKernel[47]=vec2(0.6234898,0.7818315);kDiskKernel[48]=vec2(0.43388364,0.9009689);kDiskKernel[49]=vec2(0.22252098,0.9749279);kDiskKernel[50]=vec2(0.0,1.0);kDiskKernel[51]=vec2(-0.22252095,0.9749279);kDiskKernel[52]=vec2(-0.43388385,0.90096885);kDiskKernel[53]=vec2(-0.62349,0.7818314);kDiskKernel[54]=vec2(-0.7818317,0.62348956);kDiskKernel[55]=vec2(-0.90096885,0.43388382);kDiskKernel[56]=vec2(-0.9749279,0.22252093);kDiskKernel[57]=vec2(-1.0,0.0);kDiskKernel[58]=vec2(-0.9749279,-0.22252087);kDiskKernel[59]=vec2(-0.90096885,-0.43388376);kDiskKernel[60]=vec2(-0.7818314,-0.6234899);kDiskKernel[61]=vec2(-0.6234896,-0.7818316);kDiskKernel[62]=vec2(-0.43388346,-0.900969);kDiskKernel[63]=vec2(-0.22252055,-0.974928);kDiskKernel[64]=vec2(0.0,-1.0);kDiskKernel[65]=vec2(0.2225215,-0.9749278);kDiskKernel[66]=vec2(0.4338835,-0.90096897);kDiskKernel[67]=vec2(0.6234897,-0.7818316);kDiskKernel[68]=vec2(0.78183144,-0.62348986);kDiskKernel[69]=vec2(0.90096885,-0.43388376);kDiskKernel[70]=vec2(0.9749279,-0.22252086);}\n#endif\nuniform sampler2D u_cocTexture;uniform vec2 u_cocTexelSize;uniform float u_rcpAspect;uniform float u_maxCoC;varying vec2 v_uv;void main(){initKernel();vec4 samp0=texture2D(u_cocTexture,v_uv);\n#ifndef USE_FLOAT\nsamp0=samp0*2.0-1.0;samp0=sign(samp0)*samp0*samp0;\n#endif\nvec4 bgAcc=vec4(0.0);vec4 fgAcc=vec4(0.0);for(int si=0;si<kSampleCount;si++){vec2 disp=kDiskKernel[si]*u_maxCoC;float dist=length(disp);vec2 duv=vec2(disp.x*u_rcpAspect,disp.y);vec4 samp=texture2D(u_cocTexture,v_uv+duv);\n#ifndef USE_FLOAT\nsamp=samp*2.0-1.0;samp=sign(samp)*samp*samp;\n#endif\nfloat bgCoC=max(min(samp0.a,samp.a),0.0);float margin=u_cocTexelSize.y*2.0;float bgWeight=clamp((bgCoC-dist+margin)/margin,0.0,1.0);float fgWeight=clamp((-samp.a-dist+margin)/margin,0.0,1.0);fgWeight*=step(u_cocTexelSize.y,-samp.a);bgAcc+=vec4(samp.rgb,1.0)*bgWeight;fgAcc+=vec4(samp.rgb,1.0)*fgWeight;}bgAcc.rgb/=bgAcc.a+step(bgAcc.a,0.0);fgAcc.rgb/=fgAcc.a+step(fgAcc.a,0.0);bgAcc.a=smoothstep(u_cocTexelSize.y,u_cocTexelSize.y*2.0,samp0.a);fgAcc.a*=3.14159265359/float(kSampleCount);vec3 rgb=vec3(0.0);rgb=mix(rgb,bgAcc.rgb,clamp(bgAcc.a,0.0,1.0));rgb=mix(rgb,fgAcc.rgb,clamp(fgAcc.a,0.0,1.0));float alpha=(1.0-clamp(bgAcc.a,0.0,1.0))*(1.0-clamp(fgAcc.a,0.0,1.0));gl_FragColor=vec4(rgb,alpha);}"
  , bokehBlurShader = "#define GLSLIFY 1\nuniform sampler2D u_bokehTexture;uniform vec2 u_bokehTexelSize;varying vec2 v_uv;void main(){vec4 duv=u_bokehTexelSize.xyxy*vec4(1.0,1.0,-1.0,0.0);vec4 acc;acc=texture2D(u_bokehTexture,v_uv-duv.xy);acc+=texture2D(u_bokehTexture,v_uv-duv.wy)*2.0;acc+=texture2D(u_bokehTexture,v_uv-duv.zy);acc+=texture2D(u_bokehTexture,v_uv+duv.zw)*2.0;acc+=texture2D(u_bokehTexture,v_uv)*4.0;acc+=texture2D(u_bokehTexture,v_uv+duv.xw)*2.0;acc+=texture2D(u_bokehTexture,v_uv+duv.zy);acc+=texture2D(u_bokehTexture,v_uv+duv.wy)*2.0;acc+=texture2D(u_bokehTexture,v_uv+duv.xy);gl_FragColor=acc*0.0625;}"
  , bokehFragmentShader = "#define GLSLIFY 1\nvarying vec2 v_uv;uniform sampler2D u_texture;uniform sampler2D u_blurTexture;uniform float u_amount;void main(){vec4 cs=texture2D(u_texture,v_uv);vec4 cb=texture2D(u_blurTexture,v_uv);vec3 rgb=cs.rgb*cb.a+cb.rgb;gl_FragColor=mix(cs,vec4(rgb,cs.a),u_amount);}"
  , Bokeh = function(e) {
    _inherits(i, PostEffect);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "amount", 1),
        _defineProperty2(_assertThisInitialized(e), "fNumber", .07),
        _defineProperty2(_assertThisInitialized(e), "focusDistance", 5),
        _defineProperty2(_assertThisInitialized(e), "useCameraFov", !1),
        _defineProperty2(_assertThisInitialized(e), "focalLength", .463),
        _defineProperty2(_assertThisInitialized(e), "kFilmHeight", 36),
        _defineProperty2(_assertThisInitialized(e), "quality", 1),
        _defineProperty2(_assertThisInitialized(e), "_prevQuality", -1),
        _defineProperty2(_assertThisInitialized(e), "useFloatTexture", !1),
        _defineProperty2(_assertThisInitialized(e), "_prevUseFloatTexture", null),
        _defineProperty2(_assertThisInitialized(e), "useAdditionalBlur", !0),
        _defineProperty2(_assertThisInitialized(e), "_halfWidth", 0),
        _defineProperty2(_assertThisInitialized(e), "_halfHeight", 0),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e) {
            Object.assign(this, {
                sharedUniforms: {
                    u_depthTexture: {
                        value: null
                    },
                    u_texelSize: {
                        value: null
                    },
                    u_focusDistance: {
                        value: 0
                    },
                    u_fNumber: {
                        value: 0
                    },
                    u_lensCoeff: {
                        value: 0
                    },
                    u_maxCoC: {
                        value: 0
                    },
                    u_rcpMaxCoC: {
                        value: 0
                    },
                    u_rcpAspect: {
                        value: 0
                    },
                    u_cameraNear: {
                        value: 0
                    },
                    u_cameraFar: {
                        value: 0
                    },
                    u_amount: {
                        value: 0
                    },
                    u_halfTexelSize: {
                        value: new Vector2
                    }
                }
            }, e),
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this.rt2 = fboHelper.createRenderTarget(1, 1, !0),
            this.rt3 = fboHelper.createRenderTarget(1, 1, !0),
            this.cocMaterial = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_hashNoise: {
                        value: 0
                    },
                    u_depthTexture: this.sharedUniforms.u_depthTexture,
                    u_texelSize: this.sharedUniforms.u_texelSize,
                    u_focusDistance: this.sharedUniforms.u_focusDistance,
                    u_lensCoeff: this.sharedUniforms.u_lensCoeff,
                    u_maxCoC: this.sharedUniforms.u_maxCoC,
                    u_rcpMaxCoC: this.sharedUniforms.u_rcpMaxCoC,
                    u_cameraNear: this.sharedUniforms.u_cameraNear,
                    u_cameraFar: this.sharedUniforms.u_cameraFar
                },
                fragmentShader: bokehCocShader
            }),
            this.simMaterial = this.createRawShaderMaterial({
                uniforms: {
                    u_cocTexture: {
                        value: null
                    },
                    u_cocTexelSize: this.sharedUniforms.u_halfTexelSize,
                    u_rcpAspect: this.sharedUniforms.u_rcpAspect,
                    u_maxCoC: this.sharedUniforms.u_maxCoC
                },
                fragmentShader: bokehSimShader
            }),
            this.blurMaterial = this.createRawShaderMaterial({
                uniforms: {
                    u_bokehTexture: {
                        value: null
                    },
                    u_bokehTexelSize: this.sharedUniforms.u_halfTexelSize
                },
                fragmentShader: bokehBlurShader
            }),
            this.material = this.createRawShaderMaterial({
                uniforms: {
                    u_texture: {
                        value: null
                    },
                    u_blurTexture: {
                        value: null
                    },
                    u_amount: this.sharedUniforms.u_amount
                },
                fragmentShader: fboHelper.precisionPrefix + bokehFragmentShader
            })
        }
    }, {
        key: "dispose",
        value: function() {
            this.rt1 && this.rt1.dispose(),
            this.rt2.dispose(),
            this.rt3.dispose()
        }
    }, {
        key: "needsRender",
        value: function() {
            return this.amount > 0
        }
    }, {
        key: "_calculateFocalLength",
        value: function(e, t) {
            return .5 * t / Math.tan(.5 * e)
        }
    }, {
        key: "_calculateMaxCoCRadius",
        value: function(e, t) {
            var i = 4 * t + 6;
            return Math.min(.05, i / e)
        }
    }, {
        key: "setPostprocessing",
        value: function(e) {
            _get(_getPrototypeOf(i.prototype), "setPostprocessing", this).call(this, e);
            var t = e.width
              , r = e.height
              , n = Math.ceil(t / 2)
              , a = Math.ceil(r / 2);
            this._halfWidth = n,
            this._halfHeight = a,
            this.rt1 && this.rt1.setSize(n, a),
            this.rt2.setSize(n, a),
            this.rt3.setSize(n, a),
            this.sharedUniforms.u_halfTexelSize.value.set(1 / n, 1 / a)
        }
    }, {
        key: "render",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]
              , r = this._prevQuality !== this.quality
              , n = this._prevUseFloatTexture !== this.useFloatTexture
              , a = this.useCameraFov ? this._calculateFocalLength(e.sharedUniforms.u_cameraFovRad.value, e.camera.getFilmHeight()) : this.focalLength
              , o = this.focusDistance
              , s = this.fNumber
              , l = a * a / (s * (o - a) * this.kFilmHeight * 2)
              , h = this._calculateMaxCoCRadius(e.height, this.quality);
            this.sharedUniforms.u_amount.value = this.amount,
            this.sharedUniforms.u_texelSize.value = e.sharedUniforms.u_texelSize.value,
            this.sharedUniforms.u_depthTexture.value = e.sharedUniforms.u_sceneDepthTexture.value,
            this.sharedUniforms.u_cameraNear.value = e.sharedUniforms.u_cameraNear.value,
            this.sharedUniforms.u_cameraFar.value = e.sharedUniforms.u_cameraFar.value,
            this.sharedUniforms.u_focusDistance.value = o,
            this.sharedUniforms.u_fNumber.value = s,
            this.sharedUniforms.u_lensCoeff.value = l,
            this.sharedUniforms.u_maxCoC.value = h,
            this.sharedUniforms.u_rcpMaxCoC.value = 1 / h,
            this.sharedUniforms.u_rcpAspect.value = e.height / e.width,
            n && (this.rt1 && this.rt1.dispose(),
            this.rt1 = fboHelper.createRenderTarget(this._halfWidth, this._halfHeight, !0, !1, this.useFloatTexture)),
            e.fromTexture.minFilter = e.fromTexture.magFilter = NearestFilter,
            n && (this.cocMaterial.defines.USE_FLOAT = this.useFloatTexture,
            this.cocMaterial.needsUpdate = !0),
            this.cocMaterial.uniforms.u_hashNoise.value = (this.cocMaterial.uniforms.u_hashNoise.value + 1.2415) % 100,
            this.cocMaterial.uniforms.u_texture.value = e.fromTexture,
            e.renderMaterial(this.cocMaterial, this.rt1),
            e.fromTexture.minFilter = e.fromTexture.magFilter = LinearFilter,
            this.simMaterial.defines.QUALITY = this.quality,
            this.simMaterial.uniforms.u_cocTexture.value = this.rt1.texture,
            r && (this.simMaterial.needsUpdate = !0),
            n && (this.simMaterial.defines.USE_FLOAT = this.useFloatTexture,
            this.simMaterial.needsUpdate = !0),
            e.renderMaterial(this.simMaterial, this.rt2),
            this.useAdditionalBlur && (this.blurMaterial.uniforms.u_bokehTexture.value = this.rt2.texture,
            e.renderMaterial(this.blurMaterial, this.rt3)),
            this.material.uniforms.u_blurTexture.value = this.useAdditionalBlur ? this.rt3.texture : this.rt2.texture,
            this._prevQuality = this.quality,
            this._prevUseFloatTexture = this.useFloatTexture,
            _get(_getPrototypeOf(i.prototype), "render", this).call(this, e, t, e.fromTexture)
        }
    }]),
    i
}()
  , fragmentShader = "#define GLSLIFY 1\nuniform sampler2D u_texture;uniform sampler2D u_depthTexture;uniform mat4 u_projectionViewInverseMatrix;uniform mat4 u_prevProjectionViewMatrix;uniform float u_amount;varying vec2 v_uv;\n#include <getBlueNoise>\nvoid main(){vec3 bnoise=getBlueNoise(gl_FragCoord.xy);float depth=texture2D(u_depthTexture,v_uv).r;vec4 ndc=vec4(v_uv.xy*2.0-1.0,depth,1.0);vec4 worldPos=u_projectionViewInverseMatrix*ndc;vec4 prevPos=u_prevProjectionViewMatrix*worldPos;prevPos/=prevPos.w;prevPos.xy=prevPos.xy*0.5+0.5;vec2 delta=prevPos.xy-v_uv;vec2 velocity=delta/9.0*u_amount*dot(delta,delta)*50.0;vec2 uv=v_uv+bnoise.xy*velocity;vec4 color=vec4(0.0);float weightSum=0.0;float weight=1.0;float weightFalloff=1.0;for(int i=0;i<9;i++){color+=texture2D(u_texture,uv)*weight;uv+=velocity;weightSum+=weight;weight*=weightFalloff;}gl_FragColor=color/weightSum;}"
  , Final = function(e) {
    _inherits(i, PostEffect);
    var t = _createSuper(i);
    function i() {
        var e;
        _classCallCheck2(this, i);
        for (var r = arguments.length, n = new Array(r), a = 0; a < r; a++)
            n[a] = arguments[a];
        return _defineProperty2(_assertThisInitialized(e = t.call.apply(t, [this].concat(n))), "needsSync", !0),
        _defineProperty2(_assertThisInitialized(e), "amount", 1),
        _defineProperty2(_assertThisInitialized(e), "_position", null),
        _defineProperty2(_assertThisInitialized(e), "_quaternion", null),
        _defineProperty2(_assertThisInitialized(e), "_scale", null),
        _defineProperty2(_assertThisInitialized(e), "_v1", null),
        _defineProperty2(_assertThisInitialized(e), "_q", null),
        _defineProperty2(_assertThisInitialized(e), "_v2", null),
        _defineProperty2(_assertThisInitialized(e), "projectionMatrix", null),
        _defineProperty2(_assertThisInitialized(e), "prevProjectionMatrix", null),
        _defineProperty2(_assertThisInitialized(e), "projectionViewMatrix", null),
        _defineProperty2(_assertThisInitialized(e), "prevProjectionViewMatrix", null),
        _defineProperty2(_assertThisInitialized(e), "projectionViewInverseMatrix", null),
        e
    }
    return _createClass2(i, [{
        key: "init",
        value: function(e) {
            Object.assign(this, e),
            _get(_getPrototypeOf(i.prototype), "init", this).call(this),
            this._position = new Vector3,
            this._quaternion = new Quaternion,
            this._scale = new Vector3(1,1,1),
            this._v1 = new Vector3,
            this._q = new Quaternion,
            this._v2 = new Vector3,
            this.projectionViewMatrix = new Matrix4,
            this.prevProjectionViewMatrix = new Matrix4,
            this.projectionViewInverseMatrix = new Matrix4,
            this.material = this.createRawShaderMaterial({
                uniforms: Object.assign({
                    u_texture: {
                        value: null
                    },
                    u_depthTexture: {
                        value: null
                    },
                    u_amount: {
                        value: 1
                    },
                    u_projectionViewInverseMatrix: {
                        value: this.projectionViewInverseMatrix
                    },
                    u_prevProjectionViewMatrix: {
                        value: this.prevProjectionViewMatrix
                    }
                }, blueNoise.sharedUniforms),
                fragmentShader
            })
        }
    }, {
        key: "needsRender",
        value: function(e) {
            var t = this.amount > 0;
            return this.needsSync = !t,
            t
        }
    }, {
        key: "syncCamera",
        value: function(e) {
            this.needsSync = !0,
            e && (e.matrixWorldInverse.decompose(this._position, this._quaternion, this._scale),
            this.projectionViewMatrix.multiplyMatrices(e.projectionMatrix, e.matrixWorldInverse),
            this.projectionViewInverseMatrix.copy(this.projectionViewMatrix).invert()),
            this.prevProjectionViewMatrix.copy(this.projectionViewMatrix)
        }
    }, {
        key: "render",
        value: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]
              , r = e.camera;
            this.material.uniforms.u_depthTexture = e.sharedUniforms.u_sceneDepthTexture,
            this.material.uniforms.u_amount.value = this.amount,
            this.needsSync || e.hasSizeChanged ? (this.syncCamera(r),
            this.needsSync = !1) : this.prevProjectionViewMatrix.copy(this.projectionViewMatrix),
            this.projectionViewMatrix.multiplyMatrices(r.projectionMatrix, r.matrixWorldInverse),
            this.projectionViewInverseMatrix.copy(this.projectionViewMatrix).invert(),
            _get(_getPrototypeOf(i.prototype), "render", this).call(this, e, t)
        }
    }]),
    i
}()
  , TextureHelper = function() {
    function e() {
        _classCallCheck2(this, e),
        _defineProperty2(this, "blackTexture", void 0),
        _defineProperty2(this, "whiteTexture", void 0),
        _defineProperty2(this, "transparentTexture", void 0)
    }
    return _createClass2(e, [{
        key: "init",
        value: function() {
            this.blackTexture = this._createPixelTexture([0, 0, 0, 1]),
            this.whiteTexture = this._createPixelTexture([1, 1, 1, 1]),
            this.transparentTexture = this._createPixelTexture([0, 0, 0, 0])
        }
    }, {
        key: "_createPixelTexture",
        value: function(e) {
            var t = new DataTexture(new Uint8Array(e),256,256);
            return t.format = RGBAFormat,
            t
        }
    }]),
    e
}()
  , textureHelper = new TextureHelper
  , XHRItem = properties.loader.ITEM_CLASSES.xhr
  , BufItem = function(e) {
    _inherits(i, XHRItem);
    var t = _createSuper(i);
    function i(e, r) {
        return _classCallCheck2(this, i),
        t.call(this, e, _objectSpread(_objectSpread({}, r), {}, {
            responseType: "arraybuffer"
        }))
    }
    return _createClass2(i, [{
        key: "retrieve",
        value: function() {
            return !1
        }
    }, {
        key: "_onLoad",
        value: function() {
            if (!this.content) {
                for (var e = this.xmlhttp.response, t = new Uint32Array(e,0,1)[0], r = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(e,4,t))), n = r.vertexCount, a = r.indexCount, o = 4 + t, s = new BufferGeometry, l = r.attributes, h = 0, c = l.length; h < c; h++) {
                    var p = l[h]
                      , u = p.id
                      , d = "indices" === u ? a : n
                      , f = p.componentSize
                      , m = window[p.storageType]
                      , g = new m(e,o,d * f)
                      , v = m.BYTES_PER_ELEMENT
                      , y = void 0;
                    if (p.needsPack) {
                        var _ = p.packedComponents
                          , b = _.length
                          , x = 1 << 8 * v
                          , w = 0 === p.storageType.indexOf("Int") ? .5 * x : 0
                          , S = 1 / x;
                        y = new Float32Array(d * f);
                        for (var T = 0, k = 0; T < d; T++)
                            for (var E = 0; E < b; E++) {
                                var M = _[E];
                                y[k] = (g[k] + w) * S * M.delta + M.from,
                                k++
                            }
                    } else
                        y = g;
                    "indices" === u ? s.setIndex(new BufferAttribute(y,1)) : s.setAttribute(u, new BufferAttribute(y,f)),
                    o += d * f * v
                }
                this.content = s
            }
            this.xmlhttp = void 0,
            _get(_getPrototypeOf(i.prototype), "_onLoad", this).call(this, this)
        }
    }]),
    i
}();
BufItem.type = "buf",
BufItem.extensions = ["buf"],
BufItem.responseType = "arraybuffer";
var GLTFLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).dracoLoader = null,
        r.ktx2Loader = null,
        r.meshoptDecoder = null,
        r.pluginCallbacks = [],
        r.register((function(e) {
            return new GLTFMaterialsClearcoatExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFTextureBasisUExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFTextureWebPExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFMaterialsTransmissionExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFMaterialsVolumeExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFMaterialsIorExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFMaterialsSpecularExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFLightsExtension(e)
        }
        )),
        r.register((function(e) {
            return new GLTFMeshoptCompression(e)
        }
        )),
        r
    }
    return _createClass2(i, [{
        key: "load",
        value: function(e, t, i, r) {
            var n, a = this;
            n = "" !== this.resourcePath ? this.resourcePath : "" !== this.path ? this.path : LoaderUtils.extractUrlBase(e),
            this.manager.itemStart(e);
            var o = function(t) {
                r ? r(t) : console.error(t),
                a.manager.itemError(e),
                a.manager.itemEnd(e)
            }
              , s = new FileLoader(this.manager);
            s.setPath(this.path),
            s.setResponseType("arraybuffer"),
            s.setRequestHeader(this.requestHeader),
            s.setWithCredentials(this.withCredentials),
            s.load(e, (function(i) {
                try {
                    a.parse(i, n, (function(i) {
                        t(i),
                        a.manager.itemEnd(e)
                    }
                    ), o)
                } catch (r) {
                    o(r)
                }
            }
            ), i, o)
        }
    }, {
        key: "setDRACOLoader",
        value: function(e) {
            return this.dracoLoader = e,
            this
        }
    }, {
        key: "setDDSLoader",
        value: function() {
            throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')
        }
    }, {
        key: "setKTX2Loader",
        value: function(e) {
            return this.ktx2Loader = e,
            this
        }
    }, {
        key: "setMeshoptDecoder",
        value: function(e) {
            return this.meshoptDecoder = e,
            this
        }
    }, {
        key: "register",
        value: function(e) {
            return -1 === this.pluginCallbacks.indexOf(e) && this.pluginCallbacks.push(e),
            this
        }
    }, {
        key: "unregister",
        value: function(e) {
            return -1 !== this.pluginCallbacks.indexOf(e) && this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e), 1),
            this
        }
    }, {
        key: "parse",
        value: function(e, t, i, r) {
            var n, a = {}, o = {};
            if ("string" == typeof e)
                n = e;
            else if (LoaderUtils.decodeText(new Uint8Array(e,0,4)) === BINARY_EXTENSION_HEADER_MAGIC) {
                try {
                    a[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(e)
                } catch (f) {
                    return void (r && r(f))
                }
                n = a[EXTENSIONS.KHR_BINARY_GLTF].content
            } else
                n = LoaderUtils.decodeText(new Uint8Array(e));
            var s = JSON.parse(n);
            if (void 0 === s.asset || s.asset.version[0] < 2)
                r && r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));
            else {
                var l = new GLTFParser(s,{
                    path: t || this.resourcePath || "",
                    crossOrigin: this.crossOrigin,
                    requestHeader: this.requestHeader,
                    manager: this.manager,
                    ktx2Loader: this.ktx2Loader,
                    meshoptDecoder: this.meshoptDecoder
                });
                l.fileLoader.setRequestHeader(this.requestHeader);
                for (var h = 0; h < this.pluginCallbacks.length; h++) {
                    var c = this.pluginCallbacks[h](l);
                    o[c.name] = c,
                    a[c.name] = !0
                }
                if (s.extensionsUsed)
                    for (var p = 0; p < s.extensionsUsed.length; ++p) {
                        var u = s.extensionsUsed[p]
                          , d = s.extensionsRequired || [];
                        switch (u) {
                        case EXTENSIONS.KHR_MATERIALS_UNLIT:
                            a[u] = new GLTFMaterialsUnlitExtension;
                            break;
                        case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:
                            a[u] = new GLTFMaterialsPbrSpecularGlossinessExtension;
                            break;
                        case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:
                            a[u] = new GLTFDracoMeshCompressionExtension(s,this.dracoLoader);
                            break;
                        case EXTENSIONS.KHR_TEXTURE_TRANSFORM:
                            a[u] = new GLTFTextureTransformExtension;
                            break;
                        case EXTENSIONS.KHR_MESH_QUANTIZATION:
                            a[u] = new GLTFMeshQuantizationExtension;
                            break;
                        default:
                            d.indexOf(u) >= 0 && void 0 === o[u] && console.warn('THREE.GLTFLoader: Unknown extension "' + u + '".')
                        }
                    }
                l.setExtensions(a),
                l.setPlugins(o),
                l.parse(i, r)
            }
        }
    }]),
    i
}();
function GLTFRegistry() {
    var e = {};
    return {
        get: function(t) {
            return e[t]
        },
        add: function(t, i) {
            e[t] = i
        },
        remove: function(t) {
            delete e[t]
        },
        removeAll: function() {
            e = {}
        }
    }
}
var EXTENSIONS = {
    KHR_BINARY_GLTF: "KHR_binary_glTF",
    KHR_DRACO_MESH_COMPRESSION: "KHR_draco_mesh_compression",
    KHR_LIGHTS_PUNCTUAL: "KHR_lights_punctual",
    KHR_MATERIALS_CLEARCOAT: "KHR_materials_clearcoat",
    KHR_MATERIALS_IOR: "KHR_materials_ior",
    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: "KHR_materials_pbrSpecularGlossiness",
    KHR_MATERIALS_SPECULAR: "KHR_materials_specular",
    KHR_MATERIALS_TRANSMISSION: "KHR_materials_transmission",
    KHR_MATERIALS_UNLIT: "KHR_materials_unlit",
    KHR_MATERIALS_VOLUME: "KHR_materials_volume",
    KHR_TEXTURE_BASISU: "KHR_texture_basisu",
    KHR_TEXTURE_TRANSFORM: "KHR_texture_transform",
    KHR_MESH_QUANTIZATION: "KHR_mesh_quantization",
    EXT_TEXTURE_WEBP: "EXT_texture_webp",
    EXT_MESHOPT_COMPRESSION: "EXT_meshopt_compression"
}
  , GLTFLightsExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL,
        this.cache = {
            refs: {},
            uses: {}
        }
    }
    return _createClass2(e, [{
        key: "_markDefs",
        value: function() {
            for (var e = this.parser, t = this.parser.json.nodes || [], i = 0, r = t.length; i < r; i++) {
                var n = t[i];
                n.extensions && n.extensions[this.name] && void 0 !== n.extensions[this.name].light && e._addNodeRef(this.cache, n.extensions[this.name].light)
            }
        }
    }, {
        key: "_loadLight",
        value: function(e) {
            var t = this.parser
              , i = "light:" + e
              , r = t.cache.get(i);
            if (r)
                return r;
            var n, a = t.json, o = ((a.extensions && a.extensions[this.name] || {}).lights || [])[e], s = new Color(16777215);
            void 0 !== o.color && s.fromArray(o.color);
            var l = void 0 !== o.range ? o.range : 0;
            switch (o.type) {
            case "directional":
                (n = new DirectionalLight(s)).target.position.set(0, 0, -1),
                n.add(n.target);
                break;
            case "point":
                (n = new PointLight(s)).distance = l;
                break;
            case "spot":
                (n = new SpotLight(s)).distance = l,
                o.spot = o.spot || {},
                o.spot.innerConeAngle = void 0 !== o.spot.innerConeAngle ? o.spot.innerConeAngle : 0,
                o.spot.outerConeAngle = void 0 !== o.spot.outerConeAngle ? o.spot.outerConeAngle : Math.PI / 4,
                n.angle = o.spot.outerConeAngle,
                n.penumbra = 1 - o.spot.innerConeAngle / o.spot.outerConeAngle,
                n.target.position.set(0, 0, -1),
                n.add(n.target);
                break;
            default:
                throw new Error("THREE.GLTFLoader: Unexpected light type: " + o.type)
            }
            return n.position.set(0, 0, 0),
            n.decay = 2,
            void 0 !== o.intensity && (n.intensity = o.intensity),
            n.name = t.createUniqueName(o.name || "light_" + e),
            r = Promise.resolve(n),
            t.cache.add(i, r),
            r
        }
    }, {
        key: "createNodeAttachment",
        value: function(e) {
            var t = this
              , i = this.parser
              , r = i.json.nodes[e]
              , n = (r.extensions && r.extensions[this.name] || {}).light;
            return void 0 === n ? null : this._loadLight(n).then((function(e) {
                return i._getNodeRef(t.cache, n, e)
            }
            ))
        }
    }]),
    e
}()
  , GLTFMaterialsUnlitExtension = function() {
    function e() {
        _classCallCheck2(this, e),
        this.name = EXTENSIONS.KHR_MATERIALS_UNLIT
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function() {
            return MeshBasicMaterial
        }
    }, {
        key: "extendParams",
        value: function(e, t, i) {
            var r = [];
            e.color = new Color(1,1,1),
            e.opacity = 1;
            var n = t.pbrMetallicRoughness;
            if (n) {
                if (Array.isArray(n.baseColorFactor)) {
                    var a = n.baseColorFactor;
                    e.color.fromArray(a),
                    e.opacity = a[3]
                }
                void 0 !== n.baseColorTexture && r.push(i.assignTexture(e, "map", n.baseColorTexture))
            }
            return Promise.all(r)
        }
    }]),
    e
}()
  , GLTFMaterialsClearcoatExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function(e) {
            var t = this.parser.json.materials[e];
            return t.extensions && t.extensions[this.name] ? MeshPhysicalMaterial : null
        }
    }, {
        key: "extendMaterialParams",
        value: function(e, t) {
            var i = this.parser
              , r = i.json.materials[e];
            if (!r.extensions || !r.extensions[this.name])
                return Promise.resolve();
            var n = []
              , a = r.extensions[this.name];
            if (void 0 !== a.clearcoatFactor && (t.clearcoat = a.clearcoatFactor),
            void 0 !== a.clearcoatTexture && n.push(i.assignTexture(t, "clearcoatMap", a.clearcoatTexture)),
            void 0 !== a.clearcoatRoughnessFactor && (t.clearcoatRoughness = a.clearcoatRoughnessFactor),
            void 0 !== a.clearcoatRoughnessTexture && n.push(i.assignTexture(t, "clearcoatRoughnessMap", a.clearcoatRoughnessTexture)),
            void 0 !== a.clearcoatNormalTexture && (n.push(i.assignTexture(t, "clearcoatNormalMap", a.clearcoatNormalTexture)),
            void 0 !== a.clearcoatNormalTexture.scale)) {
                var o = a.clearcoatNormalTexture.scale;
                t.clearcoatNormalScale = new Vector2(o,o)
            }
            return Promise.all(n)
        }
    }]),
    e
}()
  , GLTFMaterialsTransmissionExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function(e) {
            var t = this.parser.json.materials[e];
            return t.extensions && t.extensions[this.name] ? MeshPhysicalMaterial : null
        }
    }, {
        key: "extendMaterialParams",
        value: function(e, t) {
            var i = this.parser
              , r = i.json.materials[e];
            if (!r.extensions || !r.extensions[this.name])
                return Promise.resolve();
            var n = []
              , a = r.extensions[this.name];
            return void 0 !== a.transmissionFactor && (t.transmission = a.transmissionFactor),
            void 0 !== a.transmissionTexture && n.push(i.assignTexture(t, "transmissionMap", a.transmissionTexture)),
            Promise.all(n)
        }
    }]),
    e
}()
  , GLTFMaterialsVolumeExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_MATERIALS_VOLUME
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function(e) {
            var t = this.parser.json.materials[e];
            return t.extensions && t.extensions[this.name] ? MeshPhysicalMaterial : null
        }
    }, {
        key: "extendMaterialParams",
        value: function(e, t) {
            var i = this.parser
              , r = i.json.materials[e];
            if (!r.extensions || !r.extensions[this.name])
                return Promise.resolve();
            var n = []
              , a = r.extensions[this.name];
            t.thickness = void 0 !== a.thicknessFactor ? a.thicknessFactor : 0,
            void 0 !== a.thicknessTexture && n.push(i.assignTexture(t, "thicknessMap", a.thicknessTexture)),
            t.attenuationDistance = a.attenuationDistance || 0;
            var o = a.attenuationColor || [1, 1, 1];
            return t.attenuationTint = new Color(o[0],o[1],o[2]),
            Promise.all(n)
        }
    }]),
    e
}()
  , GLTFMaterialsIorExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_MATERIALS_IOR
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function(e) {
            var t = this.parser.json.materials[e];
            return t.extensions && t.extensions[this.name] ? MeshPhysicalMaterial : null
        }
    }, {
        key: "extendMaterialParams",
        value: function(e, t) {
            var i = this.parser.json.materials[e];
            if (!i.extensions || !i.extensions[this.name])
                return Promise.resolve();
            var r = i.extensions[this.name];
            return t.ior = void 0 !== r.ior ? r.ior : 1.5,
            Promise.resolve()
        }
    }]),
    e
}()
  , GLTFMaterialsSpecularExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_MATERIALS_SPECULAR
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function(e) {
            var t = this.parser.json.materials[e];
            return t.extensions && t.extensions[this.name] ? MeshPhysicalMaterial : null
        }
    }, {
        key: "extendMaterialParams",
        value: function(e, t) {
            var i = this.parser
              , r = i.json.materials[e];
            if (!r.extensions || !r.extensions[this.name])
                return Promise.resolve();
            var n = []
              , a = r.extensions[this.name];
            t.specularIntensity = void 0 !== a.specularFactor ? a.specularFactor : 1,
            void 0 !== a.specularTexture && n.push(i.assignTexture(t, "specularIntensityMap", a.specularTexture));
            var o = a.specularColorFactor || [1, 1, 1];
            return t.specularTint = new Color(o[0],o[1],o[2]),
            void 0 !== a.specularColorTexture && n.push(i.assignTexture(t, "specularTintMap", a.specularColorTexture).then((function(e) {
                e.encoding = sRGBEncoding
            }
            ))),
            Promise.all(n)
        }
    }]),
    e
}()
  , GLTFTextureBasisUExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.KHR_TEXTURE_BASISU
    }
    return _createClass2(e, [{
        key: "loadTexture",
        value: function(e) {
            var t = this.parser
              , i = t.json
              , r = i.textures[e];
            if (!r.extensions || !r.extensions[this.name])
                return null;
            var n = r.extensions[this.name]
              , a = i.images[n.source]
              , o = t.options.ktx2Loader;
            if (!o) {
                if (i.extensionsRequired && i.extensionsRequired.indexOf(this.name) >= 0)
                    throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");
                return null
            }
            return t.loadTextureImage(e, a, o)
        }
    }]),
    e
}()
  , GLTFTextureWebPExtension = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.parser = t,
        this.name = EXTENSIONS.EXT_TEXTURE_WEBP,
        this.isSupported = null
    }
    return _createClass2(e, [{
        key: "loadTexture",
        value: function(e) {
            var t = this.name
              , i = this.parser
              , r = i.json
              , n = r.textures[e];
            if (!n.extensions || !n.extensions[t])
                return null;
            var a = n.extensions[t]
              , o = r.images[a.source]
              , s = i.textureLoader;
            if (o.uri) {
                var l = i.options.manager.getHandler(o.uri);
                null !== l && (s = l)
            }
            return this.detectSupport().then((function(n) {
                if (n)
                    return i.loadTextureImage(e, o, s);
                if (r.extensionsRequired && r.extensionsRequired.indexOf(t) >= 0)
                    throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");
                return i.loadTexture(e)
            }
            ))
        }
    }, {
        key: "detectSupport",
        value: function() {
            return this.isSupported || (this.isSupported = new Promise((function(e) {
                var t = new Image;
                t.src = "data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",
                t.onload = t.onerror = function() {
                    e(1 === t.height)
                }
            }
            ))),
            this.isSupported
        }
    }]),
    e
}()
  , GLTFMeshoptCompression = function() {
    function e(t) {
        _classCallCheck2(this, e),
        this.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION,
        this.parser = t
    }
    return _createClass2(e, [{
        key: "loadBufferView",
        value: function(e) {
            var t = this.parser.json
              , i = t.bufferViews[e];
            if (i.extensions && i.extensions[this.name]) {
                var r = i.extensions[this.name]
                  , n = this.parser.getDependency("buffer", r.buffer)
                  , a = this.parser.options.meshoptDecoder;
                if (!a || !a.supported) {
                    if (t.extensionsRequired && t.extensionsRequired.indexOf(this.name) >= 0)
                        throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");
                    return null
                }
                return Promise.all([n, a.ready]).then((function(e) {
                    var t = r.byteOffset || 0
                      , i = r.byteLength || 0
                      , n = r.count
                      , o = r.byteStride
                      , s = new ArrayBuffer(n * o)
                      , l = new Uint8Array(e[0],t,i);
                    return a.decodeGltfBuffer(new Uint8Array(s), n, o, l, r.mode, r.filter),
                    s
                }
                ))
            }
            return null
        }
    }]),
    e
}()
  , BINARY_EXTENSION_HEADER_MAGIC = "glTF"
  , BINARY_EXTENSION_HEADER_LENGTH = 12
  , BINARY_EXTENSION_CHUNK_TYPES = {
    JSON: 1313821514,
    BIN: 5130562
}
  , GLTFBinaryExtension = _createClass2((function e(t) {
    _classCallCheck2(this, e),
    this.name = EXTENSIONS.KHR_BINARY_GLTF,
    this.content = null,
    this.body = null;
    var i = new DataView(t,0,BINARY_EXTENSION_HEADER_LENGTH);
    if (this.header = {
        magic: LoaderUtils.decodeText(new Uint8Array(t.slice(0, 4))),
        version: i.getUint32(4, !0),
        length: i.getUint32(8, !0)
    },
    this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC)
        throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");
    if (this.header.version < 2)
        throw new Error("THREE.GLTFLoader: Legacy binary file detected.");
    for (var r = this.header.length - BINARY_EXTENSION_HEADER_LENGTH, n = new DataView(t,BINARY_EXTENSION_HEADER_LENGTH), a = 0; a < r; ) {
        var o = n.getUint32(a, !0);
        a += 4;
        var s = n.getUint32(a, !0);
        if (a += 4,
        s === BINARY_EXTENSION_CHUNK_TYPES.JSON) {
            var l = new Uint8Array(t,BINARY_EXTENSION_HEADER_LENGTH + a,o);
            this.content = LoaderUtils.decodeText(l)
        } else if (s === BINARY_EXTENSION_CHUNK_TYPES.BIN) {
            var h = BINARY_EXTENSION_HEADER_LENGTH + a;
            this.body = t.slice(h, h + o)
        }
        a += o
    }
    if (null === this.content)
        throw new Error("THREE.GLTFLoader: JSON content not found.")
}
))
  , GLTFDracoMeshCompressionExtension = function() {
    function e(t, i) {
        if (_classCallCheck2(this, e),
        !i)
            throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");
        this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,
        this.json = t,
        this.dracoLoader = i,
        this.dracoLoader.preload()
    }
    return _createClass2(e, [{
        key: "decodePrimitive",
        value: function(e, t) {
            var i = this.json
              , r = this.dracoLoader
              , n = e.extensions[this.name].bufferView
              , a = e.extensions[this.name].attributes
              , o = {}
              , s = {}
              , l = {};
            for (var h in a) {
                var c = ATTRIBUTES[h] || h.toLowerCase();
                o[c] = a[h]
            }
            for (var p in e.attributes) {
                var u = ATTRIBUTES[p] || p.toLowerCase();
                if (void 0 !== a[p]) {
                    var d = i.accessors[e.attributes[p]]
                      , f = WEBGL_COMPONENT_TYPES[d.componentType];
                    l[u] = f,
                    s[u] = !0 === d.normalized
                }
            }
            return t.getDependency("bufferView", n).then((function(e) {
                return new Promise((function(t) {
                    r.decodeDracoFile(e, (function(e) {
                        for (var i in e.attributes) {
                            var r = e.attributes[i]
                              , n = s[i];
                            void 0 !== n && (r.normalized = n)
                        }
                        t(e)
                    }
                    ), o, l)
                }
                ))
            }
            ))
        }
    }]),
    e
}()
  , GLTFTextureTransformExtension = function() {
    function e() {
        _classCallCheck2(this, e),
        this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM
    }
    return _createClass2(e, [{
        key: "extendTexture",
        value: function(e, t) {
            return void 0 !== t.texCoord && console.warn('THREE.GLTFLoader: Custom UV sets in "' + this.name + '" extension not yet supported.'),
            void 0 === t.offset && void 0 === t.rotation && void 0 === t.scale || (e = e.clone(),
            void 0 !== t.offset && e.offset.fromArray(t.offset),
            void 0 !== t.rotation && (e.rotation = t.rotation),
            void 0 !== t.scale && e.repeat.fromArray(t.scale),
            e.needsUpdate = !0),
            e
        }
    }]),
    e
}()
  , GLTFMeshStandardSGMaterial = function(e) {
    _inherits(i, MeshStandardMaterial);
    var t = _createSuper(i);
    function i(e) {
        var r;
        _classCallCheck2(this, i),
        (r = t.call(this)).isGLTFSpecularGlossinessMaterial = !0;
        var n = ["#ifdef USE_SPECULARMAP", "\tuniform sampler2D specularMap;", "#endif"].join("\n")
          , a = ["#ifdef USE_GLOSSINESSMAP", "\tuniform sampler2D glossinessMap;", "#endif"].join("\n")
          , o = ["vec3 specularFactor = specular;", "#ifdef USE_SPECULARMAP", "\tvec4 texelSpecular = texture2D( specularMap, vUv );", "\ttexelSpecular = sRGBToLinear( texelSpecular );", "\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture", "\tspecularFactor *= texelSpecular.rgb;", "#endif"].join("\n")
          , s = ["float glossinessFactor = glossiness;", "#ifdef USE_GLOSSINESSMAP", "\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );", "\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture", "\tglossinessFactor *= texelGlossiness.a;", "#endif"].join("\n")
          , l = ["PhysicalMaterial material;", "material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );", "vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );", "float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );", "material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.", "material.roughness += geometryRoughness;", "material.roughness = min( material.roughness, 1.0 );", "material.specularColor = specularFactor;"].join("\n")
          , h = {
            specular: {
                value: (new Color).setHex(16777215)
            },
            glossiness: {
                value: 1
            },
            specularMap: {
                value: null
            },
            glossinessMap: {
                value: null
            }
        };
        return r._extraUniforms = h,
        r.onBeforeCompile = function(e) {
            for (var t in h)
                e.uniforms[t] = h[t];
            e.fragmentShader = e.fragmentShader.replace("uniform float roughness;", "uniform vec3 specular;").replace("uniform float metalness;", "uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>", n).replace("#include <metalnessmap_pars_fragment>", a).replace("#include <roughnessmap_fragment>", o).replace("#include <metalnessmap_fragment>", s).replace("#include <lights_physical_fragment>", l)
        }
        ,
        Object.defineProperties(_assertThisInitialized(r), {
            specular: {
                get: function() {
                    return h.specular.value
                },
                set: function(e) {
                    h.specular.value = e
                }
            },
            specularMap: {
                get: function() {
                    return h.specularMap.value
                },
                set: function(e) {
                    h.specularMap.value = e,
                    e ? this.defines.USE_SPECULARMAP = "" : delete this.defines.USE_SPECULARMAP
                }
            },
            glossiness: {
                get: function() {
                    return h.glossiness.value
                },
                set: function(e) {
                    h.glossiness.value = e
                }
            },
            glossinessMap: {
                get: function() {
                    return h.glossinessMap.value
                },
                set: function(e) {
                    h.glossinessMap.value = e,
                    e ? (this.defines.USE_GLOSSINESSMAP = "",
                    this.defines.USE_UV = "") : (delete this.defines.USE_GLOSSINESSMAP,
                    delete this.defines.USE_UV)
                }
            }
        }),
        delete r.metalness,
        delete r.roughness,
        delete r.metalnessMap,
        delete r.roughnessMap,
        r.setValues(e),
        r
    }
    return _createClass2(i, [{
        key: "copy",
        value: function(e) {
            return _get(_getPrototypeOf(i.prototype), "copy", this).call(this, e),
            this.specularMap = e.specularMap,
            this.specular.copy(e.specular),
            this.glossinessMap = e.glossinessMap,
            this.glossiness = e.glossiness,
            delete this.metalness,
            delete this.roughness,
            delete this.metalnessMap,
            delete this.roughnessMap,
            this
        }
    }]),
    i
}()
  , GLTFMaterialsPbrSpecularGlossinessExtension = function() {
    function e() {
        _classCallCheck2(this, e),
        this.name = EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,
        this.specularGlossinessParams = ["color", "map", "lightMap", "lightMapIntensity", "aoMap", "aoMapIntensity", "emissive", "emissiveIntensity", "emissiveMap", "bumpMap", "bumpScale", "normalMap", "normalMapType", "displacementMap", "displacementScale", "displacementBias", "specularMap", "specular", "glossinessMap", "glossiness", "alphaMap", "envMap", "envMapIntensity", "refractionRatio"]
    }
    return _createClass2(e, [{
        key: "getMaterialType",
        value: function() {
            return GLTFMeshStandardSGMaterial
        }
    }, {
        key: "extendParams",
        value: function(e, t, i) {
            var r = t.extensions[this.name];
            e.color = new Color(1,1,1),
            e.opacity = 1;
            var n = [];
            if (Array.isArray(r.diffuseFactor)) {
                var a = r.diffuseFactor;
                e.color.fromArray(a),
                e.opacity = a[3]
            }
            if (void 0 !== r.diffuseTexture && n.push(i.assignTexture(e, "map", r.diffuseTexture)),
            e.emissive = new Color(0,0,0),
            e.glossiness = void 0 !== r.glossinessFactor ? r.glossinessFactor : 1,
            e.specular = new Color(1,1,1),
            Array.isArray(r.specularFactor) && e.specular.fromArray(r.specularFactor),
            void 0 !== r.specularGlossinessTexture) {
                var o = r.specularGlossinessTexture;
                n.push(i.assignTexture(e, "glossinessMap", o)),
                n.push(i.assignTexture(e, "specularMap", o))
            }
            return Promise.all(n)
        }
    }, {
        key: "createMaterial",
        value: function(e) {
            var t = new GLTFMeshStandardSGMaterial(e);
            return t.fog = !0,
            t.color = e.color,
            t.map = void 0 === e.map ? null : e.map,
            t.lightMap = null,
            t.lightMapIntensity = 1,
            t.aoMap = void 0 === e.aoMap ? null : e.aoMap,
            t.aoMapIntensity = 1,
            t.emissive = e.emissive,
            t.emissiveIntensity = 1,
            t.emissiveMap = void 0 === e.emissiveMap ? null : e.emissiveMap,
            t.bumpMap = void 0 === e.bumpMap ? null : e.bumpMap,
            t.bumpScale = 1,
            t.normalMap = void 0 === e.normalMap ? null : e.normalMap,
            t.normalMapType = TangentSpaceNormalMap,
            e.normalScale && (t.normalScale = e.normalScale),
            t.displacementMap = null,
            t.displacementScale = 1,
            t.displacementBias = 0,
            t.specularMap = void 0 === e.specularMap ? null : e.specularMap,
            t.specular = e.specular,
            t.glossinessMap = void 0 === e.glossinessMap ? null : e.glossinessMap,
            t.glossiness = e.glossiness,
            t.alphaMap = null,
            t.envMap = void 0 === e.envMap ? null : e.envMap,
            t.envMapIntensity = 1,
            t.refractionRatio = .98,
            t
        }
    }]),
    e
}()
  , GLTFMeshQuantizationExtension = _createClass2((function e() {
    _classCallCheck2(this, e),
    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION
}
))
  , GLTFCubicSplineInterpolant = function(e) {
    _inherits(i, Interpolant);
    var t = _createSuper(i);
    function i(e, r, n, a) {
        return _classCallCheck2(this, i),
        t.call(this, e, r, n, a)
    }
    return _createClass2(i, [{
        key: "copySampleValue_",
        value: function(e) {
            for (var t = this.resultBuffer, i = this.sampleValues, r = this.valueSize, n = e * r * 3 + r, a = 0; a !== r; a++)
                t[a] = i[n + a];
            return t
        }
    }]),
    i
}();
GLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_,
GLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_,
GLTFCubicSplineInterpolant.prototype.interpolate_ = function(e, t, i, r) {
    for (var n = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = 2 * o, l = 3 * o, h = r - t, c = (i - t) / h, p = c * c, u = p * c, d = e * l, f = d - l, m = -2 * u + 3 * p, g = u - p, v = 1 - m, y = g - p + c, _ = 0; _ !== o; _++) {
        var b = a[f + _ + o]
          , x = a[f + _ + s] * h
          , w = a[d + _ + o]
          , S = a[d + _] * h;
        n[_] = v * b + y * x + m * w + g * S
    }
    return n
}
;
var _q = new Quaternion
  , GLTFCubicSplineQuaternionInterpolant = function(e) {
    _inherits(i, GLTFCubicSplineInterpolant);
    var t = _createSuper(i);
    function i() {
        return _classCallCheck2(this, i),
        t.apply(this, arguments)
    }
    return _createClass2(i, [{
        key: "interpolate_",
        value: function(e, t, r, n) {
            var a = _get(_getPrototypeOf(i.prototype), "interpolate_", this).call(this, e, t, r, n);
            return _q.fromArray(a).normalize().toArray(a),
            a
        }
    }]),
    i
}()
  , WEBGL_CONSTANTS = {
    FLOAT: 5126,
    FLOAT_MAT3: 35675,
    FLOAT_MAT4: 35676,
    FLOAT_VEC2: 35664,
    FLOAT_VEC3: 35665,
    FLOAT_VEC4: 35666,
    LINEAR: 9729,
    REPEAT: 10497,
    SAMPLER_2D: 35678,
    POINTS: 0,
    LINES: 1,
    LINE_LOOP: 2,
    LINE_STRIP: 3,
    TRIANGLES: 4,
    TRIANGLE_STRIP: 5,
    TRIANGLE_FAN: 6,
    UNSIGNED_BYTE: 5121,
    UNSIGNED_SHORT: 5123
}
  , WEBGL_COMPONENT_TYPES = {
    5120: Int8Array,
    5121: Uint8Array,
    5122: Int16Array,
    5123: Uint16Array,
    5125: Uint32Array,
    5126: Float32Array
}
  , WEBGL_FILTERS = {
    9728: NearestFilter,
    9729: LinearFilter,
    9984: NearestMipmapNearestFilter,
    9985: LinearMipmapNearestFilter,
    9986: NearestMipmapLinearFilter,
    9987: LinearMipmapLinearFilter
}
  , WEBGL_WRAPPINGS = {
    33071: ClampToEdgeWrapping,
    33648: MirroredRepeatWrapping,
    10497: RepeatWrapping
}
  , WEBGL_TYPE_SIZES = {
    SCALAR: 1,
    VEC2: 2,
    VEC3: 3,
    VEC4: 4,
    MAT2: 4,
    MAT3: 9,
    MAT4: 16
}
  , ATTRIBUTES = {
    POSITION: "position",
    NORMAL: "normal",
    TANGENT: "tangent",
    TEXCOORD_0: "uv",
    TEXCOORD_1: "uv2",
    COLOR_0: "color",
    WEIGHTS_0: "skinWeight",
    JOINTS_0: "skinIndex"
}
  , PATH_PROPERTIES = {
    scale: "scale",
    translation: "position",
    rotation: "quaternion",
    weights: "morphTargetInfluences"
}
  , INTERPOLATION = {
    CUBICSPLINE: void 0,
    LINEAR: InterpolateLinear,
    STEP: InterpolateDiscrete
}
  , ALPHA_MODES = {
    OPAQUE: "OPAQUE",
    MASK: "MASK",
    BLEND: "BLEND"
};
function resolveURL(e, t) {
    return "string" != typeof e || "" === e ? "" : (/^https?:\/\//i.test(t) && /^\//.test(e) && (t = t.replace(/(^https?:\/\/[^\/]+).*/i, "$1")),
    /^(https?:)?\/\//i.test(e) || /^data:.*,.*$/i.test(e) || /^blob:.*$/i.test(e) ? e : t + e)
}
function createDefaultMaterial(e) {
    return void 0 === e.DefaultMaterial && (e.DefaultMaterial = new MeshStandardMaterial({
        color: 16777215,
        emissive: 0,
        metalness: 1,
        roughness: 1,
        transparent: !1,
        depthTest: !0,
        side: FrontSide
    })),
    e.DefaultMaterial
}
function addUnknownExtensionsToUserData(e, t, i) {
    for (var r in i.extensions)
        void 0 === e[r] && (t.userData.gltfExtensions = t.userData.gltfExtensions || {},
        t.userData.gltfExtensions[r] = i.extensions[r])
}
function assignExtrasToUserData(e, t) {
    void 0 !== t.extras && ("object" === _typeof2(t.extras) ? Object.assign(e.userData, t.extras) : console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, " + t.extras))
}
function addMorphTargets(e, t, i) {
    for (var r = !1, n = !1, a = 0, o = t.length; a < o; a++) {
        var s = t[a];
        if (void 0 !== s.POSITION && (r = !0),
        void 0 !== s.NORMAL && (n = !0),
        r && n)
            break
    }
    if (!r && !n)
        return Promise.resolve(e);
    for (var l = [], h = [], c = 0, p = t.length; c < p; c++) {
        var u = t[c];
        if (r) {
            var d = void 0 !== u.POSITION ? i.getDependency("accessor", u.POSITION) : e.attributes.position;
            l.push(d)
        }
        if (n) {
            var f = void 0 !== u.NORMAL ? i.getDependency("accessor", u.NORMAL) : e.attributes.normal;
            h.push(f)
        }
    }
    return Promise.all([Promise.all(l), Promise.all(h)]).then((function(t) {
        var i = t[0]
          , a = t[1];
        return r && (e.morphAttributes.position = i),
        n && (e.morphAttributes.normal = a),
        e.morphTargetsRelative = !0,
        e
    }
    ))
}
function updateMorphTargets(e, t) {
    if (e.updateMorphTargets(),
    void 0 !== t.weights)
        for (var i = 0, r = t.weights.length; i < r; i++)
            e.morphTargetInfluences[i] = t.weights[i];
    if (t.extras && Array.isArray(t.extras.targetNames)) {
        var n = t.extras.targetNames;
        if (e.morphTargetInfluences.length === n.length) {
            e.morphTargetDictionary = {};
            for (var a = 0, o = n.length; a < o; a++)
                e.morphTargetDictionary[n[a]] = a
        } else
            console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")
    }
}
function createPrimitiveKey(e) {
    var t = e.extensions && e.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];
    return t ? "draco:" + t.bufferView + ":" + t.indices + ":" + createAttributesKey(t.attributes) : e.indices + ":" + createAttributesKey(e.attributes) + ":" + e.mode
}
function createAttributesKey(e) {
    for (var t = "", i = Object.keys(e).sort(), r = 0, n = i.length; r < n; r++)
        t += i[r] + ":" + e[i[r]] + ";";
    return t
}
function getNormalizedComponentScale(e) {
    switch (e) {
    case Int8Array:
        return 1 / 127;
    case Uint8Array:
        return 1 / 255;
    case Int16Array:
        return 1 / 32767;
    case Uint16Array:
        return 1 / 65535;
    default:
        throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")
    }
}
var GLTFParser = function() {
    function e() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
        _classCallCheck2(this, e),
        this.json = t,
        this.extensions = {},
        this.plugins = {},
        this.options = i,
        this.cache = new GLTFRegistry,
        this.associations = new Map,
        this.primitiveCache = {},
        this.meshCache = {
            refs: {},
            uses: {}
        },
        this.cameraCache = {
            refs: {},
            uses: {}
        },
        this.lightCache = {
            refs: {},
            uses: {}
        },
        this.textureCache = {},
        this.nodeNamesUsed = {},
        "undefined" != typeof createImageBitmap && !1 === /Firefox/.test(navigator.userAgent) ? this.textureLoader = new ImageBitmapLoader(this.options.manager) : this.textureLoader = new TextureLoader(this.options.manager),
        this.textureLoader.setCrossOrigin(this.options.crossOrigin),
        this.textureLoader.setRequestHeader(this.options.requestHeader),
        this.fileLoader = new FileLoader(this.options.manager),
        this.fileLoader.setResponseType("arraybuffer"),
        "use-credentials" === this.options.crossOrigin && this.fileLoader.setWithCredentials(!0)
    }
    return _createClass2(e, [{
        key: "setExtensions",
        value: function(e) {
            this.extensions = e
        }
    }, {
        key: "setPlugins",
        value: function(e) {
            this.plugins = e
        }
    }, {
        key: "parse",
        value: function(e, t) {
            var i = this
              , r = this.json
              , n = this.extensions;
            this.cache.removeAll(),
            this._invokeAll((function(e) {
                return e._markDefs && e._markDefs()
            }
            )),
            Promise.all(this._invokeAll((function(e) {
                return e.beforeRoot && e.beforeRoot()
            }
            ))).then((function() {
                return Promise.all([i.getDependencies("scene"), i.getDependencies("animation"), i.getDependencies("camera")])
            }
            )).then((function(t) {
                var a = {
                    scene: t[0][r.scene || 0],
                    scenes: t[0],
                    animations: t[1],
                    cameras: t[2],
                    asset: r.asset,
                    parser: i,
                    userData: {}
                };
                addUnknownExtensionsToUserData(n, a, r),
                assignExtrasToUserData(a, r),
                Promise.all(i._invokeAll((function(e) {
                    return e.afterRoot && e.afterRoot(a)
                }
                ))).then((function() {
                    e(a)
                }
                ))
            }
            )).catch(t)
        }
    }, {
        key: "_markDefs",
        value: function() {
            for (var e = this.json.nodes || [], t = this.json.skins || [], i = this.json.meshes || [], r = 0, n = t.length; r < n; r++)
                for (var a = t[r].joints, o = 0, s = a.length; o < s; o++)
                    e[a[o]].isBone = !0;
            for (var l = 0, h = e.length; l < h; l++) {
                var c = e[l];
                void 0 !== c.mesh && (this._addNodeRef(this.meshCache, c.mesh),
                void 0 !== c.skin && (i[c.mesh].isSkinnedMesh = !0)),
                void 0 !== c.camera && this._addNodeRef(this.cameraCache, c.camera)
            }
        }
    }, {
        key: "_addNodeRef",
        value: function(e, t) {
            void 0 !== t && (void 0 === e.refs[t] && (e.refs[t] = e.uses[t] = 0),
            e.refs[t]++)
        }
    }, {
        key: "_getNodeRef",
        value: function(e, t, i) {
            var r = this;
            if (e.refs[t] <= 1)
                return i;
            var n = i.clone();
            return function e(t, i) {
                var n = r.associations.get(t);
                null != n && r.associations.set(i, n);
                var a, o = _createForOfIteratorHelper(t.children.entries());
                try {
                    for (o.s(); !(a = o.n()).done; ) {
                        var s = _slicedToArray(a.value, 2)
                          , l = s[0];
                        e(s[1], i.children[l])
                    }
                } catch (h) {
                    o.e(h)
                } finally {
                    o.f()
                }
            }(i, n),
            n.name += "_instance_" + e.uses[t]++,
            n
        }
    }, {
        key: "_invokeOne",
        value: function(e) {
            var t = Object.values(this.plugins);
            t.push(this);
            for (var i = 0; i < t.length; i++) {
                var r = e(t[i]);
                if (r)
                    return r
            }
            return null
        }
    }, {
        key: "_invokeAll",
        value: function(e) {
            var t = Object.values(this.plugins);
            t.unshift(this);
            for (var i = [], r = 0; r < t.length; r++) {
                var n = e(t[r]);
                n && i.push(n)
            }
            return i
        }
    }, {
        key: "getDependency",
        value: function(e, t) {
            var i = e + ":" + t
              , r = this.cache.get(i);
            if (!r) {
                switch (e) {
                case "scene":
                    r = this.loadScene(t);
                    break;
                case "node":
                    r = this.loadNode(t);
                    break;
                case "mesh":
                    r = this._invokeOne((function(e) {
                        return e.loadMesh && e.loadMesh(t)
                    }
                    ));
                    break;
                case "accessor":
                    r = this.loadAccessor(t);
                    break;
                case "bufferView":
                    r = this._invokeOne((function(e) {
                        return e.loadBufferView && e.loadBufferView(t)
                    }
                    ));
                    break;
                case "buffer":
                    r = this.loadBuffer(t);
                    break;
                case "material":
                    r = this._invokeOne((function(e) {
                        return e.loadMaterial && e.loadMaterial(t)
                    }
                    ));
                    break;
                case "texture":
                    r = this._invokeOne((function(e) {
                        return e.loadTexture && e.loadTexture(t)
                    }
                    ));
                    break;
                case "skin":
                    r = this.loadSkin(t);
                    break;
                case "animation":
                    r = this.loadAnimation(t);
                    break;
                case "camera":
                    r = this.loadCamera(t);
                    break;
                default:
                    throw new Error("Unknown type: " + e)
                }
                this.cache.add(i, r)
            }
            return r
        }
    }, {
        key: "getDependencies",
        value: function(e) {
            var t = this.cache.get(e);
            if (!t) {
                var i = this
                  , r = this.json[e + ("mesh" === e ? "es" : "s")] || [];
                t = Promise.all(r.map((function(t, r) {
                    return i.getDependency(e, r)
                }
                ))),
                this.cache.add(e, t)
            }
            return t
        }
    }, {
        key: "loadBuffer",
        value: function(e) {
            var t = this.json.buffers[e]
              , i = this.fileLoader;
            if (t.type && "arraybuffer" !== t.type)
                throw new Error("THREE.GLTFLoader: " + t.type + " buffer type is not supported.");
            if (void 0 === t.uri && 0 === e)
                return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);
            var r = this.options;
            return new Promise((function(e, n) {
                i.load(resolveURL(t.uri, r.path), e, void 0, (function() {
                    n(new Error('THREE.GLTFLoader: Failed to load buffer "' + t.uri + '".'))
                }
                ))
            }
            ))
        }
    }, {
        key: "loadBufferView",
        value: function(e) {
            var t = this.json.bufferViews[e];
            return this.getDependency("buffer", t.buffer).then((function(e) {
                var i = t.byteLength || 0
                  , r = t.byteOffset || 0;
                return e.slice(r, r + i)
            }
            ))
        }
    }, {
        key: "loadAccessor",
        value: function(e) {
            var t = this
              , i = this.json
              , r = this.json.accessors[e];
            if (void 0 === r.bufferView && void 0 === r.sparse)
                return Promise.resolve(null);
            var n = [];
            return void 0 !== r.bufferView ? n.push(this.getDependency("bufferView", r.bufferView)) : n.push(null),
            void 0 !== r.sparse && (n.push(this.getDependency("bufferView", r.sparse.indices.bufferView)),
            n.push(this.getDependency("bufferView", r.sparse.values.bufferView))),
            Promise.all(n).then((function(e) {
                var n, a, o = e[0], s = WEBGL_TYPE_SIZES[r.type], l = WEBGL_COMPONENT_TYPES[r.componentType], h = l.BYTES_PER_ELEMENT, c = h * s, p = r.byteOffset || 0, u = void 0 !== r.bufferView ? i.bufferViews[r.bufferView].byteStride : void 0, d = !0 === r.normalized;
                if (u && u !== c) {
                    var f = Math.floor(p / u)
                      , m = "InterleavedBuffer:" + r.bufferView + ":" + r.componentType + ":" + f + ":" + r.count
                      , g = t.cache.get(m);
                    g || (n = new l(o,f * u,r.count * u / h),
                    g = new InterleavedBuffer(n,u / h),
                    t.cache.add(m, g)),
                    a = new InterleavedBufferAttribute(g,s,p % u / h,d)
                } else
                    n = null === o ? new l(r.count * s) : new l(o,p,r.count * s),
                    a = new BufferAttribute(n,s,d);
                if (void 0 !== r.sparse) {
                    var v = WEBGL_TYPE_SIZES.SCALAR
                      , y = WEBGL_COMPONENT_TYPES[r.sparse.indices.componentType]
                      , _ = r.sparse.indices.byteOffset || 0
                      , b = r.sparse.values.byteOffset || 0
                      , x = new y(e[1],_,r.sparse.count * v)
                      , w = new l(e[2],b,r.sparse.count * s);
                    null !== o && (a = new BufferAttribute(a.array.slice(),a.itemSize,a.normalized));
                    for (var S = 0, T = x.length; S < T; S++) {
                        var k = x[S];
                        if (a.setX(k, w[S * s]),
                        s >= 2 && a.setY(k, w[S * s + 1]),
                        s >= 3 && a.setZ(k, w[S * s + 2]),
                        s >= 4 && a.setW(k, w[S * s + 3]),
                        s >= 5)
                            throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")
                    }
                }
                return a
            }
            ))
        }
    }, {
        key: "loadTexture",
        value: function(e) {
            var t = this.json
              , i = this.options
              , r = t.textures[e]
              , n = t.images[r.source]
              , a = this.textureLoader;
            if (n.uri) {
                var o = i.manager.getHandler(n.uri);
                null !== o && (a = o)
            }
            return this.loadTextureImage(e, n, a)
        }
    }, {
        key: "loadTextureImage",
        value: function(e, t, i) {
            var r = this
              , n = this.json
              , a = this.options
              , o = n.textures[e]
              , s = (t.uri || t.bufferView) + ":" + o.sampler;
            if (this.textureCache[s])
                return this.textureCache[s];
            var l = self.URL || self.webkitURL
              , h = t.uri || ""
              , c = !1;
            if (void 0 !== t.bufferView)
                h = r.getDependency("bufferView", t.bufferView).then((function(e) {
                    c = !0;
                    var i = new Blob([e],{
                        type: t.mimeType
                    });
                    return h = l.createObjectURL(i)
                }
                ));
            else if (void 0 === t.uri)
                throw new Error("THREE.GLTFLoader: Image " + e + " is missing URI and bufferView");
            var p = Promise.resolve(h).then((function(e) {
                return new Promise((function(t, r) {
                    var n = t;
                    !0 === i.isImageBitmapLoader && (n = function(e) {
                        var i = new Texture(e);
                        i.needsUpdate = !0,
                        t(i)
                    }
                    ),
                    i.load(resolveURL(e, a.path), n, void 0, r)
                }
                ))
            }
            )).then((function(t) {
                !0 === c && l.revokeObjectURL(h),
                t.flipY = !1,
                o.name && (t.name = o.name);
                var i = (n.samplers || {})[o.sampler] || {};
                return t.magFilter = WEBGL_FILTERS[i.magFilter] || LinearFilter,
                t.minFilter = WEBGL_FILTERS[i.minFilter] || LinearMipmapLinearFilter,
                t.wrapS = WEBGL_WRAPPINGS[i.wrapS] || RepeatWrapping,
                t.wrapT = WEBGL_WRAPPINGS[i.wrapT] || RepeatWrapping,
                r.associations.set(t, {
                    textures: e
                }),
                t
            }
            )).catch((function() {
                return console.error("THREE.GLTFLoader: Couldn't load texture", h),
                null
            }
            ));
            return this.textureCache[s] = p,
            p
        }
    }, {
        key: "assignTexture",
        value: function(e, t, i) {
            var r = this;
            return this.getDependency("texture", i.index).then((function(n) {
                if (void 0 === i.texCoord || 0 == i.texCoord || "aoMap" === t && 1 == i.texCoord || console.warn("THREE.GLTFLoader: Custom UV set " + i.texCoord + " for texture " + t + " not yet supported."),
                r.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {
                    var a = void 0 !== i.extensions ? i.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM] : void 0;
                    if (a) {
                        var o = r.associations.get(n);
                        n = r.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(n, a),
                        r.associations.set(n, o)
                    }
                }
                return e[t] = n,
                n
            }
            ))
        }
    }, {
        key: "assignFinalMaterial",
        value: function(e) {
            var t = e.geometry
              , i = e.material
              , r = void 0 === t.attributes.tangent
              , n = void 0 !== t.attributes.color
              , a = void 0 === t.attributes.normal;
            if (e.isPoints) {
                var o = "PointsMaterial:" + i.uuid
                  , s = this.cache.get(o);
                s || (s = new PointsMaterial,
                Material.prototype.copy.call(s, i),
                s.color.copy(i.color),
                s.map = i.map,
                s.sizeAttenuation = !1,
                this.cache.add(o, s)),
                i = s
            } else if (e.isLine) {
                var l = "LineBasicMaterial:" + i.uuid
                  , h = this.cache.get(l);
                h || (h = new LineBasicMaterial,
                Material.prototype.copy.call(h, i),
                h.color.copy(i.color),
                this.cache.add(l, h)),
                i = h
            }
            if (r || n || a) {
                var c = "ClonedMaterial:" + i.uuid + ":";
                i.isGLTFSpecularGlossinessMaterial && (c += "specular-glossiness:"),
                r && (c += "derivative-tangents:"),
                n && (c += "vertex-colors:"),
                a && (c += "flat-shading:");
                var p = this.cache.get(c);
                p || (p = i.clone(),
                n && (p.vertexColors = !0),
                a && (p.flatShading = !0),
                r && (p.normalScale && (p.normalScale.y *= -1),
                p.clearcoatNormalScale && (p.clearcoatNormalScale.y *= -1)),
                this.cache.add(c, p),
                this.associations.set(p, this.associations.get(i))),
                i = p
            }
            i.aoMap && void 0 === t.attributes.uv2 && void 0 !== t.attributes.uv && t.setAttribute("uv2", t.attributes.uv),
            e.material = i
        }
    }, {
        key: "getMaterialType",
        value: function() {
            return MeshStandardMaterial
        }
    }, {
        key: "loadMaterial",
        value: function(e) {
            var t, i = this, r = this.json, n = this.extensions, a = r.materials[e], o = {}, s = a.extensions || {}, l = [];
            if (s[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {
                var h = n[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];
                t = h.getMaterialType(),
                l.push(h.extendParams(o, a, i))
            } else if (s[EXTENSIONS.KHR_MATERIALS_UNLIT]) {
                var c = n[EXTENSIONS.KHR_MATERIALS_UNLIT];
                t = c.getMaterialType(),
                l.push(c.extendParams(o, a, i))
            } else {
                var p = a.pbrMetallicRoughness || {};
                if (o.color = new Color(1,1,1),
                o.opacity = 1,
                Array.isArray(p.baseColorFactor)) {
                    var u = p.baseColorFactor;
                    o.color.fromArray(u),
                    o.opacity = u[3]
                }
                void 0 !== p.baseColorTexture && l.push(i.assignTexture(o, "map", p.baseColorTexture)),
                o.metalness = void 0 !== p.metallicFactor ? p.metallicFactor : 1,
                o.roughness = void 0 !== p.roughnessFactor ? p.roughnessFactor : 1,
                void 0 !== p.metallicRoughnessTexture && (l.push(i.assignTexture(o, "metalnessMap", p.metallicRoughnessTexture)),
                l.push(i.assignTexture(o, "roughnessMap", p.metallicRoughnessTexture))),
                t = this._invokeOne((function(t) {
                    return t.getMaterialType && t.getMaterialType(e)
                }
                )),
                l.push(Promise.all(this._invokeAll((function(t) {
                    return t.extendMaterialParams && t.extendMaterialParams(e, o)
                }
                ))))
            }
            !0 === a.doubleSided && (o.side = DoubleSide);
            var d = a.alphaMode || ALPHA_MODES.OPAQUE;
            if (d === ALPHA_MODES.BLEND ? (o.transparent = !0,
            o.depthWrite = !1) : (o.format = RGBFormat,
            o.transparent = !1,
            d === ALPHA_MODES.MASK && (o.alphaTest = void 0 !== a.alphaCutoff ? a.alphaCutoff : .5)),
            void 0 !== a.normalTexture && t !== MeshBasicMaterial && (l.push(i.assignTexture(o, "normalMap", a.normalTexture)),
            o.normalScale = new Vector2(1,1),
            void 0 !== a.normalTexture.scale)) {
                var f = a.normalTexture.scale;
                o.normalScale.set(f, f)
            }
            return void 0 !== a.occlusionTexture && t !== MeshBasicMaterial && (l.push(i.assignTexture(o, "aoMap", a.occlusionTexture)),
            void 0 !== a.occlusionTexture.strength && (o.aoMapIntensity = a.occlusionTexture.strength)),
            void 0 !== a.emissiveFactor && t !== MeshBasicMaterial && (o.emissive = (new Color).fromArray(a.emissiveFactor)),
            void 0 !== a.emissiveTexture && t !== MeshBasicMaterial && l.push(i.assignTexture(o, "emissiveMap", a.emissiveTexture)),
            Promise.all(l).then((function() {
                var r;
                return r = t === GLTFMeshStandardSGMaterial ? n[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o) : new t(o),
                a.name && (r.name = a.name),
                r.map && (r.map.encoding = sRGBEncoding),
                r.emissiveMap && (r.emissiveMap.encoding = sRGBEncoding),
                assignExtrasToUserData(r, a),
                i.associations.set(r, {
                    materials: e
                }),
                a.extensions && addUnknownExtensionsToUserData(n, r, a),
                r
            }
            ))
        }
    }, {
        key: "createUniqueName",
        value: function(e) {
            for (var t = PropertyBinding.sanitizeNodeName(e || ""), i = t, r = 1; this.nodeNamesUsed[i]; ++r)
                i = t + "_" + r;
            return this.nodeNamesUsed[i] = !0,
            i
        }
    }, {
        key: "loadGeometries",
        value: function(e) {
            var t = this
              , i = this.extensions
              , r = this.primitiveCache;
            function n(e) {
                return i[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e, t).then((function(i) {
                    return addPrimitiveAttributes(i, e, t)
                }
                ))
            }
            for (var a = [], o = 0, s = e.length; o < s; o++) {
                var l = e[o]
                  , h = createPrimitiveKey(l)
                  , c = r[h];
                if (c)
                    a.push(c.promise);
                else {
                    var p;
                    p = l.extensions && l.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION] ? n(l) : addPrimitiveAttributes(new BufferGeometry, l, t),
                    r[h] = {
                        primitive: l,
                        promise: p
                    },
                    a.push(p)
                }
            }
            return Promise.all(a)
        }
    }, {
        key: "loadMesh",
        value: function(e) {
            for (var t = this, i = this.json, r = this.extensions, n = i.meshes[e], a = n.primitives, o = [], s = 0, l = a.length; s < l; s++) {
                var h = void 0 === a[s].material ? createDefaultMaterial(this.cache) : this.getDependency("material", a[s].material);
                o.push(h)
            }
            return o.push(t.loadGeometries(a)),
            Promise.all(o).then((function(i) {
                for (var o = i.slice(0, i.length - 1), s = i[i.length - 1], l = [], h = 0, c = s.length; h < c; h++) {
                    var p = s[h]
                      , u = a[h]
                      , d = void 0
                      , f = o[h];
                    if (u.mode === WEBGL_CONSTANTS.TRIANGLES || u.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP || u.mode === WEBGL_CONSTANTS.TRIANGLE_FAN || void 0 === u.mode)
                        !0 !== (d = !0 === n.isSkinnedMesh ? new SkinnedMesh(p,f) : new Mesh(p,f)).isSkinnedMesh || d.geometry.attributes.skinWeight.normalized || d.normalizeSkinWeights(),
                        u.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ? d.geometry = toTrianglesDrawMode(d.geometry, TriangleStripDrawMode) : u.mode === WEBGL_CONSTANTS.TRIANGLE_FAN && (d.geometry = toTrianglesDrawMode(d.geometry, TriangleFanDrawMode));
                    else if (u.mode === WEBGL_CONSTANTS.LINES)
                        d = new LineSegments(p,f);
                    else if (u.mode === WEBGL_CONSTANTS.LINE_STRIP)
                        d = new Line(p,f);
                    else if (u.mode === WEBGL_CONSTANTS.LINE_LOOP)
                        d = new LineLoop(p,f);
                    else {
                        if (u.mode !== WEBGL_CONSTANTS.POINTS)
                            throw new Error("THREE.GLTFLoader: Primitive mode unsupported: " + u.mode);
                        d = new Points(p,f)
                    }
                    Object.keys(d.geometry.morphAttributes).length > 0 && updateMorphTargets(d, n),
                    d.name = t.createUniqueName(n.name || "mesh_" + e),
                    assignExtrasToUserData(d, n),
                    u.extensions && addUnknownExtensionsToUserData(r, d, u),
                    t.assignFinalMaterial(d),
                    l.push(d)
                }
                for (var m = 0, g = l.length; m < g; m++)
                    t.associations.set(l[m], {
                        meshes: e,
                        primitives: m
                    });
                if (1 === l.length)
                    return l[0];
                var v = new Group;
                t.associations.set(v, {
                    meshes: e
                });
                for (var y = 0, _ = l.length; y < _; y++)
                    v.add(l[y]);
                return v
            }
            ))
        }
    }, {
        key: "loadCamera",
        value: function(e) {
            var t, i = this.json.cameras[e], r = i[i.type];
            if (r)
                return "perspective" === i.type ? t = new PerspectiveCamera(MathUtils$1.radToDeg(r.yfov),r.aspectRatio || 1,r.znear || 1,r.zfar || 2e6) : "orthographic" === i.type && (t = new OrthographicCamera(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),
                i.name && (t.name = this.createUniqueName(i.name)),
                assignExtrasToUserData(t, i),
                Promise.resolve(t);
            console.warn("THREE.GLTFLoader: Missing camera parameters.")
        }
    }, {
        key: "loadSkin",
        value: function(e) {
            var t = this.json.skins[e]
              , i = {
                joints: t.joints
            };
            return void 0 === t.inverseBindMatrices ? Promise.resolve(i) : this.getDependency("accessor", t.inverseBindMatrices).then((function(e) {
                return i.inverseBindMatrices = e,
                i
            }
            ))
        }
    }, {
        key: "loadAnimation",
        value: function(e) {
            for (var t = this.json.animations[e], i = [], r = [], n = [], a = [], o = [], s = 0, l = t.channels.length; s < l; s++) {
                var h = t.channels[s]
                  , c = t.samplers[h.sampler]
                  , p = h.target
                  , u = void 0 !== p.node ? p.node : p.id
                  , d = void 0 !== t.parameters ? t.parameters[c.input] : c.input
                  , f = void 0 !== t.parameters ? t.parameters[c.output] : c.output;
                i.push(this.getDependency("node", u)),
                r.push(this.getDependency("accessor", d)),
                n.push(this.getDependency("accessor", f)),
                a.push(c),
                o.push(p)
            }
            return Promise.all([Promise.all(i), Promise.all(r), Promise.all(n), Promise.all(a), Promise.all(o)]).then((function(i) {
                for (var r = i[0], n = i[1], a = i[2], o = i[3], s = i[4], l = [], h = function(e, t) {
                    var i = r[e]
                      , h = n[e]
                      , c = a[e]
                      , p = o[e]
                      , u = s[e];
                    if (void 0 === i)
                        return "continue";
                    i.updateMatrix(),
                    i.matrixAutoUpdate = !0;
                    var d = void 0;
                    switch (PATH_PROPERTIES[u.path]) {
                    case PATH_PROPERTIES.weights:
                        d = NumberKeyframeTrack;
                        break;
                    case PATH_PROPERTIES.rotation:
                        d = QuaternionKeyframeTrack;
                        break;
                    case PATH_PROPERTIES.position:
                    case PATH_PROPERTIES.scale:
                    default:
                        d = VectorKeyframeTrack
                    }
                    var f = i.name ? i.name : i.uuid
                      , m = void 0 !== p.interpolation ? INTERPOLATION[p.interpolation] : InterpolateLinear
                      , g = [];
                    PATH_PROPERTIES[u.path] === PATH_PROPERTIES.weights ? i.traverse((function(e) {
                        !0 === e.isMesh && e.morphTargetInfluences && g.push(e.name ? e.name : e.uuid)
                    }
                    )) : g.push(f);
                    var v = c.array;
                    if (c.normalized) {
                        for (var y = getNormalizedComponentScale(v.constructor), _ = new Float32Array(v.length), b = 0, x = v.length; b < x; b++)
                            _[b] = v[b] * y;
                        v = _
                    }
                    for (var w = 0, S = g.length; w < S; w++) {
                        var T = new d(g[w] + "." + PATH_PROPERTIES[u.path],h.array,v,m);
                        "CUBICSPLINE" === p.interpolation && (T.createInterpolant = function(e) {
                            return new (this instanceof QuaternionKeyframeTrack ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant)(this.times,this.values,this.getValueSize() / 3,e)
                        }
                        ,
                        T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = !0),
                        l.push(T)
                    }
                }, c = 0, p = r.length; c < p; c++)
                    h(c);
                var u = t.name ? t.name : "animation_" + e;
                return new AnimationClip(u,void 0,l)
            }
            ))
        }
    }, {
        key: "createNodeMesh",
        value: function(e) {
            var t = this.json
              , i = this
              , r = t.nodes[e];
            return void 0 === r.mesh ? null : i.getDependency("mesh", r.mesh).then((function(e) {
                var t = i._getNodeRef(i.meshCache, r.mesh, e);
                return void 0 !== r.weights && t.traverse((function(e) {
                    if (e.isMesh)
                        for (var t = 0, i = r.weights.length; t < i; t++)
                            e.morphTargetInfluences[t] = r.weights[t]
                }
                )),
                t
            }
            ))
        }
    }, {
        key: "loadNode",
        value: function(e) {
            var t, i, r = this.json, n = this.extensions, a = this, o = r.nodes[e], s = o.name ? a.createUniqueName(o.name) : "";
            return (t = [],
            i = a._invokeOne((function(t) {
                return t.createNodeMesh && t.createNodeMesh(e)
            }
            )),
            i && t.push(i),
            void 0 !== o.camera && t.push(a.getDependency("camera", o.camera).then((function(e) {
                return a._getNodeRef(a.cameraCache, o.camera, e)
            }
            ))),
            a._invokeAll((function(t) {
                return t.createNodeAttachment && t.createNodeAttachment(e)
            }
            )).forEach((function(e) {
                t.push(e)
            }
            )),
            Promise.all(t)).then((function(t) {
                var i;
                if ((i = !0 === o.isBone ? new Bone : t.length > 1 ? new Group : 1 === t.length ? t[0] : new Object3D) !== t[0])
                    for (var r = 0, l = t.length; r < l; r++)
                        i.add(t[r]);
                if (o.name && (i.userData.name = o.name,
                i.name = s),
                assignExtrasToUserData(i, o),
                o.extensions && addUnknownExtensionsToUserData(n, i, o),
                void 0 !== o.matrix) {
                    var h = new Matrix4;
                    h.fromArray(o.matrix),
                    i.applyMatrix4(h)
                } else
                    void 0 !== o.translation && i.position.fromArray(o.translation),
                    void 0 !== o.rotation && i.quaternion.fromArray(o.rotation),
                    void 0 !== o.scale && i.scale.fromArray(o.scale);
                return a.associations.has(i) || a.associations.set(i, {}),
                a.associations.get(i).nodes = e,
                i
            }
            ))
        }
    }, {
        key: "loadScene",
        value: function(e) {
            var t = this.json
              , i = this.extensions
              , r = this.json.scenes[e]
              , n = this
              , a = new Group;
            r.name && (a.name = n.createUniqueName(r.name)),
            assignExtrasToUserData(a, r),
            r.extensions && addUnknownExtensionsToUserData(i, a, r);
            for (var o = r.nodes || [], s = [], l = 0, h = o.length; l < h; l++)
                s.push(buildNodeHierarchy(o[l], a, t, n));
            return Promise.all(s).then((function() {
                return n.associations = function(e) {
                    var t, i = new Map, r = _createForOfIteratorHelper(n.associations);
                    try {
                        for (r.s(); !(t = r.n()).done; ) {
                            var a = _slicedToArray(t.value, 2)
                              , o = a[0]
                              , s = a[1];
                            (o instanceof Material || o instanceof Texture) && i.set(o, s)
                        }
                    } catch (l) {
                        r.e(l)
                    } finally {
                        r.f()
                    }
                    return e.traverse((function(e) {
                        var t = n.associations.get(e);
                        null != t && i.set(e, t)
                    }
                    )),
                    i
                }(a),
                a
            }
            ))
        }
    }]),
    e
}();
function buildNodeHierarchy(e, t, i, r) {
    var n = i.nodes[e];
    return r.getDependency("node", e).then((function(e) {
        return void 0 === n.skin ? e : r.getDependency("skin", n.skin).then((function(e) {
            for (var i = [], n = 0, a = (t = e).joints.length; n < a; n++)
                i.push(r.getDependency("node", t.joints[n]));
            return Promise.all(i)
        }
        )).then((function(i) {
            return e.traverse((function(e) {
                if (e.isMesh) {
                    for (var r = [], n = [], a = 0, o = i.length; a < o; a++) {
                        var s = i[a];
                        if (s) {
                            r.push(s);
                            var l = new Matrix4;
                            void 0 !== t.inverseBindMatrices && l.fromArray(t.inverseBindMatrices.array, 16 * a),
                            n.push(l)
                        } else
                            console.warn('THREE.GLTFLoader: Joint "%s" could not be found.', t.joints[a])
                    }
                    e.bind(new Skeleton(r,n), e.matrixWorld)
                }
            }
            )),
            e
        }
        ));
        var t
    }
    )).then((function(e) {
        t.add(e);
        var a = [];
        if (n.children)
            for (var o = n.children, s = 0, l = o.length; s < l; s++) {
                var h = o[s];
                a.push(buildNodeHierarchy(h, e, i, r))
            }
        return Promise.all(a)
    }
    ))
}
function computeBounds(e, t, i) {
    var r = t.attributes
      , n = new Box3;
    if (void 0 !== r.POSITION) {
        var a = i.json.accessors[r.POSITION]
          , o = a.min
          , s = a.max;
        if (void 0 !== o && void 0 !== s) {
            if (n.set(new Vector3(o[0],o[1],o[2]), new Vector3(s[0],s[1],s[2])),
            a.normalized) {
                var l = getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[a.componentType]);
                n.min.multiplyScalar(l),
                n.max.multiplyScalar(l)
            }
            var h = t.targets;
            if (void 0 !== h) {
                for (var c = new Vector3, p = new Vector3, u = 0, d = h.length; u < d; u++) {
                    var f = h[u];
                    if (void 0 !== f.POSITION) {
                        var m = i.json.accessors[f.POSITION]
                          , g = m.min
                          , v = m.max;
                        if (void 0 !== g && void 0 !== v) {
                            if (p.setX(Math.max(Math.abs(g[0]), Math.abs(v[0]))),
                            p.setY(Math.max(Math.abs(g[1]), Math.abs(v[1]))),
                            p.setZ(Math.max(Math.abs(g[2]), Math.abs(v[2]))),
                            m.normalized) {
                                var y = getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[m.componentType]);
                                p.multiplyScalar(y)
                            }
                            c.max(p)
                        } else
                            console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")
                    }
                }
                n.expandByVector(c)
            }
            e.boundingBox = n;
            var _ = new Sphere;
            n.getCenter(_.center),
            _.radius = n.min.distanceTo(n.max) / 2,
            e.boundingSphere = _
        } else
            console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")
    }
}
function addPrimitiveAttributes(e, t, i) {
    var r = t.attributes
      , n = [];
    function a(t, r) {
        return i.getDependency("accessor", t).then((function(t) {
            e.setAttribute(r, t)
        }
        ))
    }
    for (var o in r) {
        var s = ATTRIBUTES[o] || o.toLowerCase();
        s in e.attributes || n.push(a(r[o], s))
    }
    if (void 0 !== t.indices && !e.index) {
        var l = i.getDependency("accessor", t.indices).then((function(t) {
            e.setIndex(t)
        }
        ));
        n.push(l)
    }
    return assignExtrasToUserData(e, t),
    computeBounds(e, t, i),
    Promise.all(n).then((function() {
        return void 0 !== t.targets ? addMorphTargets(e, t.targets, i) : e
    }
    ))
}
function toTrianglesDrawMode(e, t) {
    var i = e.getIndex();
    if (null === i) {
        var r = []
          , n = e.getAttribute("position");
        if (void 0 === n)
            return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),
            e;
        for (var a = 0; a < n.count; a++)
            r.push(a);
        e.setIndex(r),
        i = e.getIndex()
    }
    var o = i.count - 2
      , s = [];
    if (t === TriangleFanDrawMode)
        for (var l = 1; l <= o; l++)
            s.push(i.getX(0)),
            s.push(i.getX(l)),
            s.push(i.getX(l + 1));
    else
        for (var h = 0; h < o; h++)
            h % 2 == 0 ? (s.push(i.getX(h)),
            s.push(i.getX(h + 1)),
            s.push(i.getX(h + 2))) : (s.push(i.getX(h + 2)),
            s.push(i.getX(h + 1)),
            s.push(i.getX(h)));
    s.length / 3 !== o && console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");
    var c = e.clone();
    return c.setIndex(s),
    c
}
var _taskCache = new WeakMap
  , DRACOLoader = function(e) {
    _inherits(i, Loader);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).decoderPath = "",
        r.decoderConfig = {},
        r.decoderBinary = null,
        r.decoderPending = null,
        r.workerLimit = 4,
        r.workerPool = [],
        r.workerNextTaskID = 1,
        r.workerSourceURL = "",
        r.defaultAttributeIDs = {
            position: "POSITION",
            normal: "NORMAL",
            color: "COLOR",
            uv: "TEX_COORD"
        },
        r.defaultAttributeTypes = {
            position: "Float32Array",
            normal: "Float32Array",
            color: "Float32Array",
            uv: "Float32Array"
        },
        r
    }
    return _createClass2(i, [{
        key: "setDecoderPath",
        value: function(e) {
            return this.decoderPath = e,
            this
        }
    }, {
        key: "setDecoderConfig",
        value: function(e) {
            return this.decoderConfig = e,
            this
        }
    }, {
        key: "setWorkerLimit",
        value: function(e) {
            return this.workerLimit = e,
            this
        }
    }, {
        key: "load",
        value: function(e, t, i, r) {
            var n = this
              , a = new FileLoader(this.manager);
            a.setPath(this.path),
            a.setResponseType("arraybuffer"),
            a.setRequestHeader(this.requestHeader),
            a.setWithCredentials(this.withCredentials),
            a.load(e, (function(e) {
                var i = {
                    attributeIDs: n.defaultAttributeIDs,
                    attributeTypes: n.defaultAttributeTypes,
                    useUniqueIDs: !1
                };
                n.decodeGeometry(e, i).then(t).catch(r)
            }
            ), i, r)
        }
    }, {
        key: "decodeDracoFile",
        value: function(e, t, i, r) {
            var n = {
                attributeIDs: i || this.defaultAttributeIDs,
                attributeTypes: r || this.defaultAttributeTypes,
                useUniqueIDs: !!i
            };
            this.decodeGeometry(e, n).then(t)
        }
    }, {
        key: "decodeGeometry",
        value: function(e, t) {
            var i = this;
            for (var r in t.attributeTypes) {
                var n = t.attributeTypes[r];
                void 0 !== n.BYTES_PER_ELEMENT && (t.attributeTypes[r] = n.name)
            }
            var a, o = JSON.stringify(t);
            if (_taskCache.has(e)) {
                var s = _taskCache.get(e);
                if (s.key === o)
                    return s.promise;
                if (0 === e.byteLength)
                    throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")
            }
            var l = this.workerNextTaskID++
              , h = e.byteLength
              , c = this._getWorker(l, h).then((function(i) {
                return a = i,
                new Promise((function(i, r) {
                    a._callbacks[l] = {
                        resolve: i,
                        reject: r
                    },
                    a.postMessage({
                        type: "decode",
                        id: l,
                        taskConfig: t,
                        buffer: e
                    }, [e])
                }
                ))
            }
            )).then((function(e) {
                return i._createGeometry(e.geometry)
            }
            ));
            return c.catch((function() {
                return !0
            }
            )).then((function() {
                a && l && i._releaseTask(a, l)
            }
            )),
            _taskCache.set(e, {
                key: o,
                promise: c
            }),
            c
        }
    }, {
        key: "_createGeometry",
        value: function(e) {
            var t = new BufferGeometry;
            e.index && t.setIndex(new BufferAttribute(e.index.array,1));
            for (var i = 0; i < e.attributes.length; i++) {
                var r = e.attributes[i]
                  , n = r.name
                  , a = r.array
                  , o = r.itemSize;
                t.setAttribute(n, new BufferAttribute(a,o))
            }
            return t
        }
    }, {
        key: "_loadLibrary",
        value: function(e, t) {
            var i = new FileLoader(this.manager);
            return i.setPath(this.decoderPath),
            i.setResponseType(t),
            i.setWithCredentials(this.withCredentials),
            new Promise((function(t, r) {
                i.load(e, t, void 0, r)
            }
            ))
        }
    }, {
        key: "preload",
        value: function() {
            return this._initDecoder(),
            this
        }
    }, {
        key: "_initDecoder",
        value: function() {
            var e = this;
            if (this.decoderPending)
                return this.decoderPending;
            var t = "object" !== ("undefined" == typeof WebAssembly ? "undefined" : _typeof2(WebAssembly)) || "js" === this.decoderConfig.type
              , i = [];
            return t ? i.push(this._loadLibrary("draco_decoder.js", "text")) : (i.push(this._loadLibrary("draco_wasm_wrapper.js", "text")),
            i.push(this._loadLibrary("draco_decoder.wasm", "arraybuffer"))),
            this.decoderPending = Promise.all(i).then((function(i) {
                var r = i[0];
                t || (e.decoderConfig.wasmBinary = i[1]);
                var n = DRACOWorker.toString()
                  , a = ["/* draco decoder */", r, "", "/* worker */", n.substring(n.indexOf("{") + 1, n.lastIndexOf("}"))].join("\n");
                e.workerSourceURL = URL.createObjectURL(new Blob([a]))
            }
            )),
            this.decoderPending
        }
    }, {
        key: "_getWorker",
        value: function(e, t) {
            var i = this;
            return this._initDecoder().then((function() {
                if (i.workerPool.length < i.workerLimit) {
                    var r = new Worker(i.workerSourceURL);
                    r._callbacks = {},
                    r._taskCosts = {},
                    r._taskLoad = 0,
                    r.postMessage({
                        type: "init",
                        decoderConfig: i.decoderConfig
                    }),
                    r.onmessage = function(e) {
                        var t = e.data;
                        switch (t.type) {
                        case "decode":
                            r._callbacks[t.id].resolve(t);
                            break;
                        case "error":
                            r._callbacks[t.id].reject(t);
                            break;
                        default:
                            console.error('THREE.DRACOLoader: Unexpected message, "' + t.type + '"')
                        }
                    }
                    ,
                    i.workerPool.push(r)
                } else
                    i.workerPool.sort((function(e, t) {
                        return e._taskLoad > t._taskLoad ? -1 : 1
                    }
                    ));
                var n = i.workerPool[i.workerPool.length - 1];
                return n._taskCosts[e] = t,
                n._taskLoad += t,
                n
            }
            ))
        }
    }, {
        key: "_releaseTask",
        value: function(e, t) {
            e._taskLoad -= e._taskCosts[t],
            delete e._callbacks[t],
            delete e._taskCosts[t]
        }
    }, {
        key: "debug",
        value: function() {
            console.log("Task load: ", this.workerPool.map((function(e) {
                return e._taskLoad
            }
            )))
        }
    }, {
        key: "dispose",
        value: function() {
            for (var e = 0; e < this.workerPool.length; ++e)
                this.workerPool[e].terminate();
            return this.workerPool.length = 0,
            this
        }
    }]),
    i
}();
function DRACOWorker() {
    var e, t;
    function i(e, t, i, r, n, a) {
        var o = a.num_components()
          , s = i.num_points() * o
          , l = s * n.BYTES_PER_ELEMENT
          , h = function(e, t) {
            switch (t) {
            case Float32Array:
                return e.DT_FLOAT32;
            case Int8Array:
                return e.DT_INT8;
            case Int16Array:
                return e.DT_INT16;
            case Int32Array:
                return e.DT_INT32;
            case Uint8Array:
                return e.DT_UINT8;
            case Uint16Array:
                return e.DT_UINT16;
            case Uint32Array:
                return e.DT_UINT32
            }
        }(e, n)
          , c = e._malloc(l);
        t.GetAttributeDataArrayForAllPoints(i, a, h, l, c);
        var p = new n(e.HEAPF32.buffer,c,s).slice();
        return e._free(c),
        {
            name: r,
            array: p,
            itemSize: o
        }
    }
    onmessage = function(r) {
        var n = r.data;
        switch (n.type) {
        case "init":
            e = n.decoderConfig,
            t = new Promise((function(t) {
                e.onModuleLoaded = function(e) {
                    t({
                        draco: e
                    })
                }
                ,
                DracoDecoderModule(e)
            }
            ));
            break;
        case "decode":
            var a = n.buffer
              , o = n.taskConfig;
            t.then((function(e) {
                var t = e.draco
                  , r = new t.Decoder
                  , s = new t.DecoderBuffer;
                s.Init(new Int8Array(a), a.byteLength);
                try {
                    var l = function(e, t, r, n) {
                        var a, o, s = n.attributeIDs, l = n.attributeTypes, h = t.GetEncodedGeometryType(r);
                        if (h === e.TRIANGULAR_MESH)
                            a = new e.Mesh,
                            o = t.DecodeBufferToMesh(r, a);
                        else {
                            if (h !== e.POINT_CLOUD)
                                throw new Error("THREE.DRACOLoader: Unexpected geometry type.");
                            a = new e.PointCloud,
                            o = t.DecodeBufferToPointCloud(r, a)
                        }
                        if (!o.ok() || 0 === a.ptr)
                            throw new Error("THREE.DRACOLoader: Decoding failed: " + o.error_msg());
                        var c = {
                            index: null,
                            attributes: []
                        };
                        for (var p in s) {
                            var u = self[l[p]]
                              , d = void 0
                              , f = void 0;
                            if (n.useUniqueIDs)
                                f = s[p],
                                d = t.GetAttributeByUniqueId(a, f);
                            else {
                                if (-1 === (f = t.GetAttributeId(a, e[s[p]])))
                                    continue;
                                d = t.GetAttribute(a, f)
                            }
                            c.attributes.push(i(e, t, a, p, u, d))
                        }
                        return h === e.TRIANGULAR_MESH && (c.index = function(e, t, i) {
                            var r = 3 * i.num_faces()
                              , n = 4 * r
                              , a = e._malloc(n);
                            t.GetTrianglesUInt32Array(i, n, a);
                            var o = new Uint32Array(e.HEAPF32.buffer,a,r).slice();
                            return e._free(a),
                            {
                                array: o,
                                itemSize: 1
                            }
                        }(e, t, a)),
                        e.destroy(a),
                        c
                    }(t, r, s, o)
                      , h = l.attributes.map((function(e) {
                        return e.array.buffer
                    }
                    ));
                    l.index && h.push(l.index.array.buffer),
                    self.postMessage({
                        type: "decode",
                        id: n.id,
                        geometry: l
                    }, h)
                } catch (c) {
                    console.error(c),
                    self.postMessage({
                        type: "error",
                        id: n.id,
                        error: c.message
                    })
                } finally {
                    t.destroy(s),
                    t.destroy(r)
                }
            }
            ))
        }
    }
}
var AnyItem$2 = properties.loader.ITEM_CLASSES.any
  , GLTFItem = function(e) {
    _inherits(i, AnyItem$2);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        _defineProperty2(_assertThisInitialized(n = t.call(this, e, _objectSpread(_objectSpread({}, r), {}, {
            responseType: "type"
        }))), "_useDraco", !0),
        n.GLTFLoader = new GLTFLoader,
        !0 === n._useDraco && (n.DRACOLoader = new DRACOLoader),
        n
    }
    return _createClass2(i, [{
        key: "retrieve",
        value: function() {
            return !1
        }
    }, {
        key: "_onLoad",
        value: function(e) {
            this.content = e,
            _get(_getPrototypeOf(i.prototype), "_onLoad", this).call(this, this)
        }
    }, {
        key: "loadFunc",
        value: function() {
            !0 === this._useDraco && (this.DRACOLoader.setDecoderPath(settings.DRACO_PATH),
            this.GLTFLoader.setDRACOLoader(this.DRACOLoader)),
            this.GLTFLoader.load(this.url, this._onLoad.bind(this), this._onGLTFLoading.bind(this))
        }
    }, {
        key: "_onGLTFLoading",
        value: function(e) {
            this.hasLoading && this.loadingSignal.dispatch(e.loaded / e.total)
        }
    }]),
    i
}();
GLTFItem.type = "gltf",
GLTFItem.extensions = ["glb", "gltf"];
var RGBELoader = function(e) {
    _inherits(i, DataTextureLoader);
    var t = _createSuper(i);
    function i(e) {
        var r;
        return _classCallCheck2(this, i),
        (r = t.call(this, e)).type = HalfFloatType,
        r
    }
    return _createClass2(i, [{
        key: "parse",
        value: function(e) {
            var t = function(e, t) {
                switch (e) {
                case 1:
                    console.error("THREE.RGBELoader Read Error: " + (t || ""));
                    break;
                case 2:
                    console.error("THREE.RGBELoader Write Error: " + (t || ""));
                    break;
                case 3:
                    console.error("THREE.RGBELoader Bad File Format: " + (t || ""));
                    break;
                default:
                    console.error("THREE.RGBELoader: Error: " + (t || ""))
                }
                return -1
            }
              , i = function(e, t, i) {
                t = t || 1024;
                for (var r = e.pos, n = -1, a = 0, o = "", s = String.fromCharCode.apply(null, new Uint16Array(e.subarray(r, r + 128))); 0 > (n = s.indexOf("\n")) && a < t && r < e.byteLength; )
                    o += s,
                    a += s.length,
                    r += 128,
                    s += String.fromCharCode.apply(null, new Uint16Array(e.subarray(r, r + 128)));
                return -1 < n && (!1 !== i && (e.pos += a + n + 1),
                o + s.slice(0, n))
            }
              , r = function(e, t, i, r) {
                var n = e[t + 3]
                  , a = Math.pow(2, n - 128) / 255;
                i[r + 0] = DataUtils.toHalfFloat(Math.min(e[t + 0] * a, 65504)),
                i[r + 1] = DataUtils.toHalfFloat(Math.min(e[t + 1] * a, 65504)),
                i[r + 2] = DataUtils.toHalfFloat(Math.min(e[t + 2] * a, 65504))
            }
              , n = new Uint8Array(e);
            n.pos = 0;
            var a, o, s, l, h, c, p = function(e) {
                var r, n, a = /^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/, o = /^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/, s = /^\s*FORMAT=(\S+)\s*$/, l = /^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/, h = {
                    valid: 0,
                    string: "",
                    comments: "",
                    programtype: "RGBE",
                    format: "",
                    gamma: 1,
                    exposure: 1,
                    width: 0,
                    height: 0
                };
                if (e.pos >= e.byteLength || !(r = i(e)))
                    return t(1, "no header found");
                if (!(n = r.match(/^#\?(\S+)/)))
                    return t(3, "bad initial token");
                for (h.valid |= 1,
                h.programtype = n[1],
                h.string += r + "\n"; !1 !== (r = i(e)); )
                    if (h.string += r + "\n",
                    "#" !== r.charAt(0)) {
                        if ((n = r.match(a)) && (h.gamma = parseFloat(n[1], 10)),
                        (n = r.match(o)) && (h.exposure = parseFloat(n[1], 10)),
                        (n = r.match(s)) && (h.valid |= 2,
                        h.format = n[1]),
                        (n = r.match(l)) && (h.valid |= 4,
                        h.height = parseInt(n[1], 10),
                        h.width = parseInt(n[2], 10)),
                        2 & h.valid && 4 & h.valid)
                            break
                    } else
                        h.comments += r + "\n";
                return 2 & h.valid ? 4 & h.valid ? h : t(3, "missing image size specifier") : t(3, "missing format specifier")
            }(n);
            if (-1 !== p) {
                var u = p.width
                  , d = p.height
                  , f = function(e, i, r) {
                    var n = i;
                    if (n < 8 || n > 32767 || 2 !== e[0] || 2 !== e[1] || 128 & e[2])
                        return new Uint8Array(e);
                    if (n !== (e[2] << 8 | e[3]))
                        return t(3, "wrong scanline width");
                    var a = new Uint8Array(4 * i * r);
                    if (!a.length)
                        return t(4, "unable to allocate buffer space");
                    for (var o = 0, s = 0, l = 4 * n, h = new Uint8Array(4), c = new Uint8Array(l), p = r; p > 0 && s < e.byteLength; ) {
                        if (s + 4 > e.byteLength)
                            return t(1);
                        if (h[0] = e[s++],
                        h[1] = e[s++],
                        h[2] = e[s++],
                        h[3] = e[s++],
                        2 != h[0] || 2 != h[1] || (h[2] << 8 | h[3]) != n)
                            return t(3, "bad rgbe scanline format");
                        for (var u = 0, d = void 0; u < l && s < e.byteLength; ) {
                            var f = (d = e[s++]) > 128;
                            if (f && (d -= 128),
                            0 === d || u + d > l)
                                return t(3, "bad scanline data");
                            if (f)
                                for (var m = e[s++], g = 0; g < d; g++)
                                    c[u++] = m;
                            else
                                c.set(e.subarray(s, s + d), u),
                                u += d,
                                s += d
                        }
                        for (var v = n, y = 0; y < v; y++) {
                            var _ = 0;
                            a[o] = c[y + _],
                            _ += n,
                            a[o + 1] = c[y + _],
                            _ += n,
                            a[o + 2] = c[y + _],
                            _ += n,
                            a[o + 3] = c[y + _],
                            o += 4
                        }
                        p--
                    }
                    return a
                }(n.subarray(n.pos), u, d);
                if (-1 !== f) {
                    var m, g, v, y;
                    switch (this.type) {
                    case UnsignedByteType:
                        m = f,
                        g = RGBEFormat,
                        v = UnsignedByteType;
                        break;
                    case FloatType:
                        y = f.length / 4;
                        for (var _ = new Float32Array(3 * y), b = 0; b < y; b++)
                            s = _,
                            l = 3 * b,
                            void 0,
                            void 0,
                            h = (a = f)[3 + (o = 4 * b)],
                            c = Math.pow(2, h - 128) / 255,
                            s[l + 0] = a[o + 0] * c,
                            s[l + 1] = a[o + 1] * c,
                            s[l + 2] = a[o + 2] * c;
                        m = _,
                        g = RGBFormat,
                        v = FloatType;
                        break;
                    case HalfFloatType:
                        y = f.length / 4;
                        for (var x = new Uint16Array(3 * y), w = 0; w < y; w++)
                            r(f, 4 * w, x, 3 * w);
                        m = x,
                        g = RGBFormat,
                        v = HalfFloatType;
                        break;
                    default:
                        console.error("THREE.RGBELoader: unsupported type: ", this.type)
                    }
                    return {
                        width: u,
                        height: d,
                        data: m,
                        header: p.string,
                        gamma: p.gamma,
                        exposure: p.exposure,
                        format: g,
                        type: v
                    }
                }
            }
            return null
        }
    }, {
        key: "setDataType",
        value: function(e) {
            return this.type = e,
            this
        }
    }, {
        key: "load",
        value: function(e, t, r, n) {
            return _get(_getPrototypeOf(i.prototype), "load", this).call(this, e, (function(e, i) {
                switch (e.type) {
                case UnsignedByteType:
                    e.encoding = RGBEEncoding,
                    e.minFilter = NearestFilter,
                    e.magFilter = NearestFilter,
                    e.generateMipmaps = !1,
                    e.flipY = !0;
                    break;
                case FloatType:
                case HalfFloatType:
                    e.encoding = LinearEncoding,
                    e.minFilter = LinearFilter,
                    e.magFilter = LinearFilter,
                    e.generateMipmaps = !1,
                    e.flipY = !0
                }
                t && t(e, i)
            }
            ), r, n)
        }
    }]),
    i
}()
  , AnyItem$1 = properties.loader.ITEM_CLASSES.any
  , RGBEItem = function(e) {
    _inherits(i, AnyItem$1);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        (n = t.call(this, e, _objectSpread(_objectSpread({}, r), {}, {
            responseType: "type"
        }))).RGBELoader = new RGBELoader,
        n
    }
    return _createClass2(i, [{
        key: "retrieve",
        value: function() {
            return !1
        }
    }, {
        key: "_onLoad",
        value: function(e) {
            this.content = e,
            _get(_getPrototypeOf(i.prototype), "_onLoad", this).call(this, this)
        }
    }, {
        key: "loadFunc",
        value: function() {
            this.RGBELoader.load(this.url, this._onLoad.bind(this), this._onRGBELoading.bind(this))
        }
    }, {
        key: "_onRGBELoading",
        value: function(e) {
            this.hasLoading && this.loadingSignal.dispatch(e.loaded / e.total)
        }
    }]),
    i
}();
RGBEItem.type = "hdr",
RGBEItem.extensions = [];
var ImageItem = properties.loader.ITEM_CLASSES.image
  , TextureItem = function(e) {
    _inherits(i, ImageItem);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        _classCallCheck2(this, i);
        var a = r.content || new Texture(new Image);
        switch (r.content = a.image,
        a.minFilter = r.minFilter || LinearFilter,
        a.minFilter) {
        case NearestMipMapNearestFilter:
        case NearestMipMapLinearFilter:
        case LinearMipMapNearestFilter:
        case LinearMipMapLinearFilter:
            a.generateMipmaps = !0,
            a.anisotropy = r.anisotropy || properties.renderer.capabilities.getMaxAnisotropy();
            break;
        default:
            a.generateMipmaps = !1
        }
        return a.flipY = void 0 === r.flipY || r.flipY,
        r.wrap ? a.wrapS = a.wrapT = r.wrap : (r.wrapS && (a.wrapS = r.wrapS),
        r.wrapT && (a.wrapT = r.wrapT)),
        (n = t.call(this, e, r)).content = a,
        n
    }
    return _createClass2(i, [{
        key: "retrieve",
        value: function() {
            return !1
        }
    }, {
        key: "load",
        value: function() {
            this.isStartLoaded = !0;
            var e = this.content.image;
            e.onload = this.boundOnLoad,
            e.src = this.url
        }
    }, {
        key: "_onLoad",
        value: function() {
            delete this.content.image.onload,
            this.width = this.content.image.width,
            this.height = this.content.image.height,
            this.content.needsUpdate = !0,
            this.onPost ? this.onPost.call(this, this.content, this.onPostLoadingSignal) : this._onLoadComplete()
        }
    }]),
    i
}();
TextureItem.type = "texture",
TextureItem.extensions = [];
var AnyItem = properties.loader.ITEM_CLASSES.any
  , ThreeLoaderItem = function(e) {
    _inherits(i, AnyItem);
    var t = _createSuper(i);
    function i(e, r) {
        var n;
        return _classCallCheck2(this, i),
        r.loadFunc = function() {}
        ,
        r.hasLoading = void 0 === r.hasLoading || r.hasLoading,
        n = t.call(this, e, r),
        !r.loader && console && (console.error || console.log)("loader is required."),
        n.loadFunc = n._loadFunc.bind(_assertThisInitialized(n)),
        n
    }
    return _createClass2(i, [{
        key: "_loadFunc",
        value: function(e, t, i) {
            this.loader.load(e, this._onLoaderLoad.bind(this, t), this._onLoaderLoading.bind(this, i))
        }
    }, {
        key: "_onLoaderLoad",
        value: function(e, t) {
            this.content = t,
            e(t)
        }
    }, {
        key: "_onLoaderLoading",
        value: function(e, t) {
            e.dispatch(t.loaded / t.total)
        }
    }]),
    i
}();
ThreeLoaderItem.type = "three-loader",
ThreeLoaderItem.extensions = [];
var Support = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "prePreInit",
        value: function() {
            this.checkSupport(),
            browser.isMobile && !browser.isTablet && this.watchMobileOrientation()
        }
    }, {
        key: "checkSupport",
        value: function() {
            properties._isSupportedDevice = !0,
            properties._isSupportedBrowser = (browser.isChrome || browser.isSafari || browser.isEdge || browser.isFirefox || browser.isOpera) && !browser.isIE,
            properties._isSupportedWebGL = this.checkSupportWebGL(),
            properties._isSupportedWebXR = !0,
            properties._isSupported = properties._isSupportedDevice && properties._isSupportedBrowser && properties._isSupportedWebGL,
            settings.LOG && (console.group("[checkSupport]"),
            console.log("isSupportedDevice", properties._isSupportedDevice),
            console.log("isSupportedBrowser", properties._isSupportedBrowser),
            console.log("isSupportedWebGL", properties._isSupportedWebGL),
            console.log("isSupportedWebXR", properties._isSupportedWebXR),
            console.log("isSupported", properties._isSupported),
            console.groupEnd())
        }
    }, {
        key: "checkSupportWebGL",
        value: function() {
            if (!(properties.canvas instanceof HTMLCanvasElement))
                return !1;
            if (settings.USE_WEBGL2 && window.WebGL2RenderingContext)
                try {
                    return properties.gl = properties.canvas.getContext("webgl2", properties.webglOpts),
                    settings.RENDER_TARGET_FLOAT_TYPE = FloatType,
                    settings.DATA_FLOAT_TYPE = FloatType,
                    !0
                } catch (t) {
                    return console.error(t),
                    !1
                }
            if (settings.USE_WEBGL2 = !1,
            window.WebGLRenderingContext)
                try {
                    var e = properties.gl = properties.canvas.getContext("webgl", properties.webglOpts) || properties.canvas.getContext("experimental-webgl", properties.webglOpts);
                    return (e.getExtension("OES_texture_float") || e.getExtension("OES_texture_half_float")) && e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS) ? (settings.RENDER_TARGET_FLOAT_TYPE = browser.isIOS || !e.getExtension("OES_texture_float") ? HalfFloatType : FloatType,
                    settings.DATA_FLOAT_TYPE = FloatType,
                    !0) : (settings.USE_FLOAT_PACKING = !0,
                    settings.RENDER_TARGET_FLOAT_TYPE = settings.DATA_FLOAT_TYPE = UnsignedByteType,
                    !1)
                } catch (t) {
                    return console.error(t),
                    !1
                }
            return !1
        }
    }, {
        key: "checkSupportWebXR",
        value: function() {
            return new Promise((function(e, t) {
                (navigator.xr || "xr"in navigator) && navigator.xr.isSessionSupported ? navigator.xr.isSessionSupported("immersive-vr").then((function(t) {
                    e(t)
                }
                )) : !1 === window.isSecureContext ? (console.log("[support] checkSupportWebXR(): WEBXR NEEDS HTTPS"),
                e(!1)) : (console.log("[support] checkSupportWebXR(): WEBXR NOT AVAILABLE"),
                e(!1))
            }
            ))
        }
    }, {
        key: "watchMobileOrientation",
        value: function() {
            var e = this
              , t = window.matchMedia("(orientation: portrait)")
              , i = function(t) {
                var i = t.matches ? "portrait" : "landscape";
                "portrait" === i ? properties._isSupportedMobileOrientation = !0 : "landscape" === i && (properties._isSupportedMobileOrientation = !1),
                properties._isSupported && !properties._isSupportedMobileOrientation ? e._addNotSupported("orientation") : e._removeNotSupported("orientation")
            };
            i(t),
            t.addEventListener("change", (function(e) {
                i(e)
            }
            ))
        }
    }, {
        key: "notSupported",
        value: function() {
            properties._isSupportedDevice ? properties._isSupportedBrowser ? properties._isSupportedWebGL || this._addNotSupported("webgl") : this._addNotSupported("browser") : this._addNotSupported("device")
        }
    }, {
        key: "_removeNotSupported",
        value: function(e) {
            properties._isSupported && document.documentElement.classList.remove("not-supported"),
            e && document.documentElement.classList.remove("not-supported--".concat(e))
        }
    }, {
        key: "_addNotSupported",
        value: function(e) {
            console.error("NOT SUPPORTED: ".concat(e.toUpperCase())),
            document.documentElement.classList.add("not-supported"),
            e && document.documentElement.classList.add("not-supported--".concat(e));
            var t = ["#FBD75A", "#76E0A7", "#E26CC1", "#F86F66", "#FABE66"]
              , i = document.getElementById("ns-".concat(e)).querySelector("h3");
            DOMUtils$1.textSplit(i, "chars", !0).chars.forEach((function(e, i) {
                var r = e.querySelector("span");
                r.style.transform = "translate3d(0, 20px, 0) scale(0)",
                r.style.setProperty("--delay", "".concat(.8 + i / 50, "s")),
                e.style.setProperty("--hover-color", t[i % t.length]),
                e.style.setProperty("--hover-rotate", "".concat(i % 2 == 1 ? 10 : -10, "deg"))
            }
            ))
        }
    }]),
    e
}()
  , support = new Support
  , Preloader = function() {
    function e() {
        _classCallCheck2(this, e),
        this.callBack = null,
        this.percent = 0,
        this.targetPercent = 0,
        this.elPreloaderBar = null,
        this.elContainerContent = null,
        this.elPreloaderBarLoader = null,
        this.elPreloaderStart = null,
        this.elPreloaderStartBtn = null,
        this.elPreloaderImg = null,
        this.elPreloaderClouds = null,
        this.elIntroAnimation = null,
        this.elPreloaderLottie = null,
        this.lottieAnimation = null,
        this.finishedWidth = 0,
        this.updateSprite = !0,
        this.jsonSheets = [],
        this.spriteSheets = []
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            var t = this;
            this.elContainer = document.getElementById("page--preloader"),
            this.elContainerContent = this.elContainer.querySelector(".page--content"),
            this.elPreloaderBar = document.getElementById("preloader-bar"),
            this.elPreloaderBarLoader = document.getElementById("preloader-bar--loader"),
            this.elPreloaderBarBackground = document.getElementById("preloader-bar--background"),
            this.elPreloaderStart = document.getElementById("preloader-start"),
            this.elPreloaderStartBtn = document.getElementById("preloader-start--btn"),
            this.elPreloaderImg = document.getElementById("preloader-logo"),
            this.elPreloaderClouds = document.getElementById("preloader-clouds"),
            this.elPreloaderStartBtn.addEventListener("pointerdown", (function() {
                return t.onStartBtnClick()
            }
            )),
            this.elIntroAnimation = document.getElementById("introAnimation"),
            this.elPreloaderLottie = document.querySelector(".preloader-lottie"),
            this.callBack = e,
            this._createClouds(),
            settings.SKIP_ANIMATION && (properties.isPreloaderAnimationFinished = !0),
            properties.loader.start((function(e) {
                t.targetPercent = e
            }
            )),
            this.show()
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.finishedWidth = this.elPreloaderBarBackground.getBoundingClientRect().width - 6;
            var e = document.querySelector(".preloader-lottie");
            this.lottieAnimation = lottie.loadAnimation({
                container: e,
                renderer: "svg",
                loop: !1,
                autoplay: !1,
                path: "./assets/data/introAnimation.json"
            }),
            this.lottieAnimation.play(),
            setTimeout((function() {
                properties.isPreloaderAnimationFinished = !0
            }
            ), 3e3)
        }
    }, {
        key: "hide",
        value: function() {
            this.elContainer.classList.remove("is-active"),
            this.lottieAnimation.destroy()
        }
    }, {
        key: "setOrientation",
        value: function() {
            var e = window.innerWidth > window.innerHeight ? "landscape" : "portrait";
            this.elPreloaderClouds.classList.remove("landscape"),
            this.elPreloaderClouds.classList.remove("portrait"),
            this.elPreloaderClouds.classList.add(e)
        }
    }, {
        key: "resize",
        value: function() {
            this.setOrientation(),
            properties.isPreloaderFinished || (this.finishedWidth = this.elPreloaderBarBackground.getBoundingClientRect().width - 6)
        }
    }, {
        key: "animeOut",
        value: function() {
            this.elContainerContent.classList.add("is-anime-out")
        }
    }, {
        key: "_createClouds",
        value: function() {
            for (var e = browser.isSupportWebP ? "webp" : "png", t = 0; t < 5; t++) {
                var i = document.createElement("div");
                i.classList.add("img-container");
                var r = document.createElement("img");
                r.src = "./assets/images/clouds/day/cloud-".concat(t, ".").concat(e),
                i.appendChild(r),
                this.elPreloaderClouds.appendChild(i)
            }
        }
    }, {
        key: "hasPreloaderFinished",
        value: function() {
            properties.isPreloaderFinished = !0,
            this.callBack(),
            settings.SKIP_ANIMATION ? (this.hide(),
            home.show(),
            cameraMode.cameraAnimation()) : (this.elPreloaderBar.classList.add("scale-out"),
            this.elPreloaderStart.classList.add("is-active"),
            this.elPreloaderLottie.classList.add("wiggle-logo"),
            this.elPreloaderClouds.classList.add("move"),
            this.elPreloaderClouds.style.background = "none")
        }
    }, {
        key: "onStartBtnClick",
        value: function() {
            var e = this;
            this.animeOut(),
            setTimeout((function() {
                e.updateSprite = !1,
                e.hide(),
                cameraMode.cameraAnimation()
            }
            ), 800)
        }
    }, {
        key: "update",
        value: function(e) {
            !0 === properties.isPreloaderFinished && !0 === properties.isPreloaderAnimationFinished || (!0 === settings.SKIP_ANIMATION ? this.percent = this.targetPercent : this.percent = Math.min(this.targetPercent, math.clamp(this.percent + .5 * e * (this.targetPercent > this.percent ? 1 : 0), 0, 1)),
            this.elPreloaderBarLoader && (this.elPreloaderBarLoader.style.width = "".concat(this.percent * this.finishedWidth, "px")),
            this.percent >= .99 && !0 === properties.isPreloaderAnimationFinished && this.hasPreloaderFinished())
        }
    }]),
    e
}()
  , preloader = new Preloader
  , infoPopup = function() {
    function e() {
        _classCallCheck2(this, e),
        this.elContainer = null,
        this.elInfoPopup = null,
        this.elButtons = null,
        this.elSpan = null,
        this.lastEnter = null,
        this.lastOver = null,
        this.tooFast = !1,
        this.hover = !1
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            this.elContainer = document.getElementById("component--info-popup"),
            this.elInfoPopup = this.elContainer.querySelector(".info-popup"),
            this.mainButtons = document.querySelectorAll("[data-info='true']"),
            this.elText = this.elContainer.querySelector("p"),
            this.onPointerEnter = this.onPointerEnter.bind(this),
            this.onPointerLeave = this.onPointerLeave.bind(this),
            this.show()
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            this.mainButtons.forEach((function(t) {
                t.addEventListener("pointerenter", (function(t) {
                    return e.onPointerEnter(t)
                }
                )),
                t.addEventListener("pointerleave", (function(t) {
                    return e.onPointerLeave(t)
                }
                ))
            }
            ))
        }
    }, {
        key: "show",
        value: function() {
            this.elContainer.classList.add("is-active"),
            this.elContainer.classList.add("hidden")
        }
    }, {
        key: "hide",
        value: function() {}
    }, {
        key: "onPointerEnter",
        value: function(e) {
            var t = this;
            if ("touch" !== e.pointerType) {
                var i = e.target;
                this.lastEnter = Date.now(),
                this.hover = !0,
                Date.now() - this.lastOver > 300 || !this.tooFast ? setTimeout((function() {
                    if (t.hover) {
                        var e = i
                          , r = e.dataset.infoText
                          , n = e.dataset.infoType;
                        t.placeInfoButton(e, r, n)
                    }
                }
                ), 400) : this.elContainer.classList.add("hidden")
            }
        }
    }, {
        key: "onPointerLeave",
        value: function(e) {
            "touch" !== e.pointerType && (this.lastOver = Date.now(),
            this.hover = !1,
            Date.now() - this.lastEnter < 500 ? this.tooFast = !0 : this.tooFast = !1,
            this.elContainer.classList.add("hidden"))
        }
    }, {
        key: "placeInfoButton",
        value: function(e, t, i) {
            var r = this;
            this.elText.innerHTML = t,
            ["down", "right"].forEach((function(e) {
                return r.elInfoPopup.classList.remove(e)
            }
            )),
            this.elInfoPopup.classList.add(i);
            var n, a, o = e.getBoundingClientRect(), s = this.elContainer.getBoundingClientRect();
            "right" === i ? (n = o.x - s.width / 2 - o.width - 32,
            a = o.y + o.height - s.height) : (n = o.x - s.width / 2 + o.width / 2,
            a = o.y - s.height / 2 - o.height / 2 - 16),
            this.elInfoPopup.style.backgroundImage = 'url("./assets/images/others/infoPopup-'.concat(i, '.png"'),
            this.elContainer.style.transform = "translate(".concat(n, "px, ").concat(a, "px)"),
            this.elContainer.classList.remove("hidden")
        }
    }, {
        key: "onAudioBtnClick",
        value: function() {}
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "update",
        value: function(e) {}
    }]),
    e
}()
  , infoPopup$1 = new infoPopup
  , UI = function() {
    function e() {
        _classCallCheck2(this, e)
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function(e) {
            settings.SHOW_UI || (document.getElementById("ui").style.display = "none"),
            home.preInit(),
            about.preInit(),
            infoPopup$1.preInit(),
            termsOfUse.preInit(),
            privacyAndCookie.preInit(),
            browser.isMobile || mouse.preInit(),
            preloader.preInit((function() {
                e()
            }
            ))
        }
    }, {
        key: "init",
        value: function() {
            home.init(),
            about.init(),
            termsOfUse.init(),
            privacyAndCookie.init(),
            browser.isMobile || mouse.init(),
            infoPopup$1.init()
        }
    }, {
        key: "resize",
        value: function(e, t) {
            home.resize(e, t),
            about.resize(e, t),
            preloader.resize(e, t)
        }
    }, {
        key: "update",
        value: function(e) {
            home.update(e),
            about.update(e),
            browser.isMobile || mouse.update(e),
            preloader.update(e)
        }
    }]),
    e
}()
  , ui = new UI
  , Visuals = function() {
    function e() {
        _classCallCheck2(this, e),
        this.container = new Object3D,
        this.raycaster = new Raycaster,
        this.lookDevGuiFolder = null
    }
    return _createClass2(e, [{
        key: "preInit",
        value: function() {
            lightning.preInit(),
            this.container.add(lightning.container),
            groundShadow.init(),
            landscape.preInit(),
            this.container.add(landscape.container),
            UberMaterial.preload(),
            railway.preInit(),
            this.container.add(railway.container)
        }
    }, {
        key: "init",
        value: function() {
            settings.LOOK_DEV_MODE && window.dat && (this.lookDevGuiFolder = (new dat.GUI).addFolder("World"),
            this.lookDevGuiFolder.width = 260,
            this.lookDevGuiFolder.open()),
            lightning.init(),
            landscape.init(this.lookDevGuiFolder),
            landscape.container.updateMatrixWorld(!0),
            railway.init(),
            cameraControls$1.init(),
            this.container.updateMatrixWorld()
        }
    }, {
        key: "resize",
        value: function(e, t) {}
    }, {
        key: "update",
        value: function(e) {
            landscape.update(e),
            UberMaterial.update(e),
            railway.isInitialized && railway.update(e),
            this.raycaster.setFromCamera(input.mouseXY, properties.camera),
            railway.container.position.set(0, 0, 0)
        }
    }]),
    e
}()
  , visuals = new Visuals
  , _v1 = new Vector3
  , _v2 = new Vector3
  , App = function() {
    function e(t) {
        var i = t.canvas;
        _classCallCheck2(this, e),
        _defineProperty2(this, "statsEnabled", !1),
        properties.canvas = i instanceof HTMLCanvasElement ? i : null,
        this.raf = null,
        this.statsEnabled && (this.stats = new Stats,
        this.stats.showPanel(0),
        this.stats.domElement.style.cssText = "position:absolute;top:0px;right:0px;z-index:70;user-select:none",
        document.body.appendChild(this.stats.dom)),
        this.prePreInit(),
        console.log("%c Created by Lusion: https://lusion.co", "border:2px solid gray; padding:5px; font-family:monospace; font-size:11px;")
    }
    return _createClass2(e, [{
        key: "prePreInit",
        value: function() {
            document.querySelector("body").style.display = "block",
            support.prePreInit(),
            !0 === properties._isSupported ? this.preInit() : support.notSupported()
        }
    }, {
        key: "preInit",
        value: function() {
            for (var e = this, t = 0, i = Object.entries(settings.CROSS_ORIGINS); t < i.length; t++) {
                var r = _slicedToArray(i[t], 2)
                  , n = r[0]
                  , a = r[1];
                properties.loader.setCrossOrigin(n, a)
            }
            properties.loader.register(BufItem),
            properties.loader.register(GLTFItem),
            properties.loader.register(RGBEItem),
            properties.loader.register(TextureItem),
            properties.loader.register(ThreeLoaderItem),
            this.preInitStage(),
            cameraControls$1.preInit(),
            input.preInit(),
            soundAudio.preInit(),
            musicAudio.preInit(),
            urlManager.preInit(),
            visuals.preInit(),
            ui.preInit((function() {
                e.init(),
                landscape.testCollisionAgainstAllTrackPieces()
            }
            )),
            properties.lastDateTime = performance.now() / 1e3,
            (window.visualViewport || window).addEventListener("resize", (function(t) {
                return e._onResize(t)
            }
            )),
            this._onResize(),
            window.addEventListener("contextmenu", (function(e) {
                return e.preventDefault()
            }
            )),
            this._loop()
        }
    }, {
        key: "preInitStage",
        value: function() {
            properties.width = window.innerWidth,
            properties.height = window.innerHeight,
            properties.renderer = new WebGLRenderer({
                canvas: properties.canvas,
                context: properties.gl
            }),
            properties.renderer.shadowMap.enabled = !0,
            properties.renderer.shadowMap.type = PCFShadowMap,
            properties.scene = new Scene,
            properties.scene.background = new Color("#CADEFF"),
            properties.camera = new PerspectiveCamera(60,1,.01,60),
            properties.camera.position.z = 5,
            properties.scene.add(properties.camera),
            properties.sharedUniforms.u_resolution.value = properties.resolution = new Vector2,
            properties.sharedUniforms.u_bgColor.value = properties.bgColor = new Color,
            fboHelper.init(properties.renderer, settings.RENDER_TARGET_FLOAT_TYPE),
            textureHelper.init(),
            properties.postprocessing = new Postprocessing,
            properties.postprocessing.init({
                scene: properties.scene,
                camera: properties.camera
            }),
            blueNoise.preInit(),
            glPositionOffset.init(),
            settings.USE_WEBGL2 || (properties.smaa = new Smaa,
            properties.smaa.init(),
            properties.smaa.setTextures(properties.loader.add(settings.TEXTURE_PATH + "smaa-area.png", {
                weight: 32
            }).content, properties.loader.add(settings.TEXTURE_PATH + "smaa-search.png", {
                weight: .1
            }).content),
            properties.postprocessing.queue.push(properties.smaa)),
            properties.bokeh = new Bokeh,
            properties.postprocessing.useDepthTexture && (properties.bokeh.init(),
            properties.postprocessing.queue.push(properties.bokeh)),
            properties.bloom = new Bloom,
            properties.bloom.init(),
            properties.postprocessing.queue.push(properties.bloom),
            properties.cameraMotionBlur = new Final,
            properties.postprocessing.useDepthTexture && (properties.cameraMotionBlur.init(),
            properties.postprocessing.queue.push(properties.cameraMotionBlur)),
            properties.final = new Final$1,
            properties.final.init(),
            properties.postprocessing.queue.push(properties.final),
            properties.isStageReady = !0
        }
    }, {
        key: "init",
        value: function() {
            var e = this;
            properties.smaa && properties.smaa.updateTextures(),
            document.documentElement.classList.add("is-ready"),
            document.documentElement.classList.add("is-".concat(browser.device)),
            document.documentElement.classList.add("is-support-webxr", properties._isSupportedWebXR),
            settings.LOOK_DEV_MODE && gui.init(),
            input.init(),
            soundAudio.init(),
            musicAudio.init(),
            visuals.init(),
            ui.init(),
            properties.scene.add(visuals.container),
            this.resize(properties.rawWidth, properties.rawHeight),
            properties.hasInitialized = !0,
            exporter.init(),
            exporter.onStarted.add((function() {
                e.resize()
            }
            ), null, 100),
            exporter.onCompleted.add((function() {
                e.resize()
            }
            ), null, 100)
        }
    }, {
        key: "_onResize",
        value: function(e) {
            var t = window.innerWidth
              , i = window.innerHeight
              , r = t * settings.DPR
              , n = i * settings.DPR;
            if (r * n > settings.MAX_PIXEL_COUNT && !0 === settings.USE_PIXEL_LIMIT) {
                var a = r / n;
                n = Math.sqrt(settings.MAX_PIXEL_COUNT / a),
                r = Math.ceil(n * a),
                n = Math.ceil(n)
            }
            properties.rawWidth = t,
            properties.rawHeight = i,
            properties.width = r,
            properties.height = n,
            this.resize()
        }
    }, {
        key: "resize",
        value: function() {
            document.documentElement.style.setProperty("--vh", .01 * properties.rawHeight + "px"),
            ui.resize(properties.rawWidth, properties.rawHeight);
            var e = exporter.isExporting ? exporter._width : properties.width
              , t = exporter.isExporting ? exporter._height : properties.height;
            properties.resolution.set(e, t),
            properties.postprocessing.setSize(e, t),
            properties.camera.aspect = e / t,
            properties.camera.updateProjectionMatrix(),
            exporter.isExporting || properties.renderer.setSize(e, t),
            properties.canvas.style.width = "".concat(properties.rawWidth, "px"),
            properties.canvas.style.height = "".concat(properties.rawHeight, "px"),
            visuals.resize(e, t)
        }
    }, {
        key: "_loop",
        value: function() {
            var e = this;
            this.render(),
            this.raf = window.requestAnimationFrame((function() {
                return e._loop()
            }
            ))
        }
    }, {
        key: "render",
        value: function(e, t) {
            this.statsEnabled && this.stats.begin();
            var i = performance.now() / 1e3;
            properties.realTime += i - properties.lastDateTime;
            var r = Math.min(.05, i - properties.lastDateTime);
            if (properties.lastDateTime = i,
            properties.deltaTime = r,
            properties.time += r,
            ui.update(r),
            soundAudio.groups.sfx.volume = math.saturate(soundAudio.groups.sfx.volume + (properties.pauseStage ? -r : r)),
            !properties.pauseStage) {
                r = exporter.isExporting || settings.CAMERA_360 ? 0 : r,
                properties.visualTime += r,
                properties.sharedUniforms.u_time.value = properties.visualTime,
                visuals.update(r),
                input.update(r),
                cameraControls$1.update(r),
                blueNoise.update(r),
                properties.renderer.setClearColor(properties.bgColor, 1),
                properties.bgColor.setStyle(properties.bgColorHex),
                properties.bloom.amount = properties.bloomAmount,
                properties.bloom.radius = properties.bloomRadius,
                properties.bloom.threshold = properties.bloomThreshold,
                properties.bloom.smoothWidth = properties.bloomSmoothWidth,
                properties.bloom.haloWidth = properties.haloWidth,
                properties.bloom.haloRGBShift = properties.haloRGBShift,
                properties.bloom.haloStrength = properties.haloStrength,
                properties.final.vignetteFrom = properties.vignetteFrom,
                properties.final.vignetteTo = properties.vignetteTo,
                properties.final.vignetteColor.setStyle(properties.vignetteColorHex),
                properties.final.saturation = properties.saturation,
                properties.final.contrast = properties.contrast,
                properties.final.brightness = properties.brightness,
                properties.final.tintColor.setStyle(properties.tintColorHex),
                properties.final.tintOpacity = properties.tintOpacity,
                properties.final.bgColor.setStyle(properties.bgColorHex),
                properties.final.opacity = properties.opacity,
                properties.bokeh.amount = settings.CAMERA_360 ? 0 : math.saturate(properties.bokeh.amount + (properties.isBokehActive ? r : -r)),
                properties.bokeh.fNumber = properties.bokehFNumber,
                _v2.set(0, 0, -1).applyQuaternion(properties.camera.quaternion);
                var n = Math.max(.1, _v1.copy(properties.trainPosition).sub(properties.camera.position).dot(_v2));
                properties.bokeh.focusDistance = n,
                properties.bokeh.focalLength = math.fit(n, .3, 1.8, .2, .5),
                properties.bokeh.kFilmHeight = properties.bokehKFilmHeight,
                properties.cameraMotionBlur && (properties.cameraMotionBlur.amount = exporter.isExporting ? 0 : properties.cameraMotionBlurAmount * properties.cameraMotionBlurMultiplier),
                properties.camera.matrixAutoUpdate = !0,
                exporter.isExporting ? (properties.postprocessing.render(properties.scene, properties.camera),
                exporter.update()) : properties.postprocessing.render(properties.scene, properties.camera, !0),
                window.__debugTexture && fboHelper.debugTo(window.__debugTexture)
            }
            soundAudio.update(r),
            musicAudio.update(r),
            properties.frameIndex++
        }
    }]),
    e
}();
new App({
    canvas: document.getElementById("canvas")
});
